!function(t){function e(n){if(o[n])return o[n].exports;var i=o[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var o={};e.m=t,e.c=o,e.i=function(t){return t},e.d=function(t,o,n){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=82)}([function(t,e,o){var n,i;/*! jQuery v2.1.1 | (c) 2005, 2014 jQuery Foundation, Inc. | jquery.org/license */
!function(e,o){"object"==typeof t&&"object"==typeof t.exports?t.exports=e.document?o(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return o(t)}:o(e)}("undefined"!=typeof window?window:this,function(r,s){function a(t){var e=t.length,o=it.type(t);return"function"!==o&&!it.isWindow(t)&&(!(1!==t.nodeType||!e)||("array"===o||0===e||"number"==typeof e&&e>0&&e-1 in t))}function l(t,e,o){if(it.isFunction(e))return it.grep(t,function(t,n){return!!e.call(t,n,t)!==o});if(e.nodeType)return it.grep(t,function(t){return t===e!==o});if("string"==typeof e){if(gt.test(e))return it.filter(e,t,o);e=it.filter(e,t)}return it.grep(t,function(t){return Q.call(e,t)>=0!==o})}function c(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function u(t){var e=vt[t]={};return it.each(t.match(yt)||[],function(t,o){e[o]=!0}),e}function h(){ot.removeEventListener("DOMContentLoaded",h,!1),r.removeEventListener("load",h,!1),it.ready()}function g(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=it.expando+Math.random()}function p(t,e,o){var n;if(void 0===o&&1===t.nodeType)if(n="data-"+e.replace(Tt,"-$1").toLowerCase(),"string"==typeof(o=t.getAttribute(n))){try{o="true"===o||"false"!==o&&("null"===o?null:+o+""===o?+o:St.test(o)?it.parseJSON(o):o)}catch(t){}xt.set(t,e,o)}else o=void 0;return o}function d(){return!0}function f(){return!1}function m(){try{return ot.activeElement}catch(t){}}function y(t,e){return it.nodeName(t,"table")&&it.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function v(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function _(t){var e=Ht.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function b(t,e){for(var o=0,n=t.length;n>o;o++)Et.set(t[o],"globalEval",!e||Et.get(e[o],"globalEval"))}function E(t,e){var o,n,i,r,s,a,l,c;if(1===e.nodeType){if(Et.hasData(t)&&(r=Et.access(t),s=Et.set(e,r),c=r.events)){delete s.handle,s.events={};for(i in c)for(o=0,n=c[i].length;n>o;o++)it.event.add(e,i,c[i][o])}xt.hasData(t)&&(a=xt.access(t),l=it.extend({},a),xt.set(e,l))}}function x(t,e){var o=t.getElementsByTagName?t.getElementsByTagName(e||"*"):t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&it.nodeName(t,e)?it.merge([t],o):o}function S(t,e){var o=e.nodeName.toLowerCase();"input"===o&&At.test(t.type)?e.checked=t.checked:("input"===o||"textarea"===o)&&(e.defaultValue=t.defaultValue)}function T(t,e){var o,n=it(e.createElement(t)).appendTo(e.body),i=r.getDefaultComputedStyle&&(o=r.getDefaultComputedStyle(n[0]))?o.display:it.css(n[0],"display");return n.detach(),i}function w(t){var e=ot,o=Wt[t];return o||(o=T(t,e),"none"!==o&&o||(Vt=(Vt||it("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement),e=Vt[0].contentDocument,e.write(),e.close(),o=T(t,e),Vt.detach()),Wt[t]=o),o}function C(t,e,o){var n,i,r,s,a=t.style;return o=o||Xt(t),o&&(s=o.getPropertyValue(e)||o[e]),o&&(""!==s||it.contains(t.ownerDocument,t)||(s=it.style(t,e)),qt.test(s)&&zt.test(e)&&(n=a.width,i=a.minWidth,r=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=o.width,a.width=n,a.minWidth=i,a.maxWidth=r)),void 0!==s?s+"":s}function k(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}function A(t,e){if(e in t)return e;for(var o=e[0].toUpperCase()+e.slice(1),n=e,i=Zt.length;i--;)if((e=Zt[i]+o)in t)return e;return n}function I(t,e,o){var n=Kt.exec(e);return n?Math.max(0,n[1]-(o||0))+(n[2]||"px"):e}function B(t,e,o,n,i){for(var r=o===(n?"border":"content")?4:"width"===e?1:0,s=0;4>r;r+=2)"margin"===o&&(s+=it.css(t,o+Ct[r],!0,i)),n?("content"===o&&(s-=it.css(t,"padding"+Ct[r],!0,i)),"margin"!==o&&(s-=it.css(t,"border"+Ct[r]+"Width",!0,i))):(s+=it.css(t,"padding"+Ct[r],!0,i),"padding"!==o&&(s+=it.css(t,"border"+Ct[r]+"Width",!0,i)));return s}function M(t,e,o){var n=!0,i="width"===e?t.offsetWidth:t.offsetHeight,r=Xt(t),s="border-box"===it.css(t,"boxSizing",!1,r);if(0>=i||null==i){if(i=C(t,e,r),(0>i||null==i)&&(i=t.style[e]),qt.test(i))return i;n=s&&(et.boxSizingReliable()||i===t.style[e]),i=parseFloat(i)||0}return i+B(t,e,o||(s?"border":"content"),n,r)+"px"}function L(t,e){for(var o,n,i,r=[],s=0,a=t.length;a>s;s++)n=t[s],n.style&&(r[s]=Et.get(n,"olddisplay"),o=n.style.display,e?(r[s]||"none"!==o||(n.style.display=""),""===n.style.display&&kt(n)&&(r[s]=Et.access(n,"olddisplay",w(n.nodeName)))):(i=kt(n),"none"===o&&i||Et.set(n,"olddisplay",i?o:it.css(n,"display"))));for(s=0;a>s;s++)n=t[s],n.style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?r[s]||"":"none"));return t}function N(t,e,o,n,i){return new N.prototype.init(t,e,o,n,i)}function R(){return setTimeout(function(){te=void 0}),te=it.now()}function D(t,e){var o,n=0,i={height:t};for(e=e?1:0;4>n;n+=2-e)o=Ct[n],i["margin"+o]=i["padding"+o]=t;return e&&(i.opacity=i.width=t),i}function O(t,e,o){for(var n,i=(se[e]||[]).concat(se["*"]),r=0,s=i.length;s>r;r++)if(n=i[r].call(o,e,t))return n}function P(t,e,o){var n,i,r,s,a,l,c,u=this,h={},g=t.style,p=t.nodeType&&kt(t),d=Et.get(t,"fxshow");o.queue||(a=it._queueHooks(t,"fx"),null==a.unqueued&&(a.unqueued=0,l=a.empty.fire,a.empty.fire=function(){a.unqueued||l()}),a.unqueued++,u.always(function(){u.always(function(){a.unqueued--,it.queue(t,"fx").length||a.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(o.overflow=[g.overflow,g.overflowX,g.overflowY],c=it.css(t,"display"),"inline"===("none"===c?Et.get(t,"olddisplay")||w(t.nodeName):c)&&"none"===it.css(t,"float")&&(g.display="inline-block")),o.overflow&&(g.overflow="hidden",u.always(function(){g.overflow=o.overflow[0],g.overflowX=o.overflow[1],g.overflowY=o.overflow[2]}));for(n in e)if(i=e[n],oe.exec(i)){if(delete e[n],r=r||"toggle"===i,i===(p?"hide":"show")){if("show"!==i||!d||void 0===d[n])continue;p=!0}h[n]=d&&d[n]||it.style(t,n)}else c=void 0;if(it.isEmptyObject(h))"inline"===("none"===c?w(t.nodeName):c)&&(g.display=c);else{d?"hidden"in d&&(p=d.hidden):d=Et.access(t,"fxshow",{}),r&&(d.hidden=!p),p?it(t).show():u.done(function(){it(t).hide()}),u.done(function(){var e;Et.remove(t,"fxshow");for(e in h)it.style(t,e,h[e])});for(n in h)s=O(p?d[n]:0,n,u),n in d||(d[n]=s.start,p&&(s.end=s.start,s.start="width"===n||"height"===n?1:0))}}function j(t,e){var o,n,i,r,s;for(o in t)if(n=it.camelCase(o),i=e[n],r=t[o],it.isArray(r)&&(i=r[1],r=t[o]=r[0]),o!==n&&(t[n]=r,delete t[o]),(s=it.cssHooks[n])&&"expand"in s){r=s.expand(r),delete t[n];for(o in r)o in t||(t[o]=r[o],e[o]=i)}else e[n]=i}function F(t,e,o){var n,i,r=0,s=re.length,a=it.Deferred().always(function(){delete l.elem}),l=function(){if(i)return!1;for(var e=te||R(),o=Math.max(0,c.startTime+c.duration-e),n=o/c.duration||0,r=1-n,s=0,l=c.tweens.length;l>s;s++)c.tweens[s].run(r);return a.notifyWith(t,[c,r,o]),1>r&&l?o:(a.resolveWith(t,[c]),!1)},c=a.promise({elem:t,props:it.extend({},e),opts:it.extend(!0,{specialEasing:{}},o),originalProperties:e,originalOptions:o,startTime:te||R(),duration:o.duration,tweens:[],createTween:function(e,o){var n=it.Tween(t,c.opts,e,o,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(n),n},stop:function(e){var o=0,n=e?c.tweens.length:0;if(i)return this;for(i=!0;n>o;o++)c.tweens[o].run(1);return e?a.resolveWith(t,[c,e]):a.rejectWith(t,[c,e]),this}}),u=c.props;for(j(u,c.opts.specialEasing);s>r;r++)if(n=re[r].call(c,t,u,c.opts))return n;return it.map(u,O,c),it.isFunction(c.opts.start)&&c.opts.start.call(t,c),it.fx.timer(it.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function H(t){return function(e,o){"string"!=typeof e&&(o=e,e="*");var n,i=0,r=e.toLowerCase().match(yt)||[];if(it.isFunction(o))for(;n=r[i++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(o)):(t[n]=t[n]||[]).push(o)}}function U(t,e,o,n){function i(a){var l;return r[a]=!0,it.each(t[a]||[],function(t,a){var c=a(e,o,n);return"string"!=typeof c||s||r[c]?s?!(l=c):void 0:(e.dataTypes.unshift(c),i(c),!1)}),l}var r={},s=t===Te;return i(e.dataTypes[0])||!r["*"]&&i("*")}function G(t,e){var o,n,i=it.ajaxSettings.flatOptions||{};for(o in e)void 0!==e[o]&&((i[o]?t:n||(n={}))[o]=e[o]);return n&&it.extend(!0,t,n),t}function V(t,e,o){for(var n,i,r,s,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(i in a)if(a[i]&&a[i].test(n)){l.unshift(i);break}if(l[0]in o)r=l[0];else{for(i in o){if(!l[0]||t.converters[i+" "+l[0]]){r=i;break}s||(s=i)}r=r||s}return r?(r!==l[0]&&l.unshift(r),o[r]):void 0}function W(t,e,o,n){var i,r,s,a,l,c={},u=t.dataTypes.slice();if(u[1])for(s in t.converters)c[s.toLowerCase()]=t.converters[s];for(r=u.shift();r;)if(t.responseFields[r]&&(o[t.responseFields[r]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=r,r=u.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(!(s=c[l+" "+r]||c["* "+r]))for(i in c)if(a=i.split(" "),a[1]===r&&(s=c[l+" "+a[0]]||c["* "+a[0]])){!0===s?s=c[i]:!0!==c[i]&&(r=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(t){return{state:"parsererror",error:s?t:"No conversion from "+l+" to "+r}}}return{state:"success",data:e}}function z(t,e,o,n){var i;if(it.isArray(e))it.each(e,function(e,i){o||ke.test(t)?n(t,i):z(t+"["+("object"==typeof i?e:"")+"]",i,o,n)});else if(o||"object"!==it.type(e))n(t,e);else for(i in e)z(t+"["+i+"]",e[i],o,n)}function q(t){return it.isWindow(t)?t:9===t.nodeType&&t.defaultView}var X=[],Y=X.slice,K=X.concat,$=X.push,Q=X.indexOf,J={},Z=J.toString,tt=J.hasOwnProperty,et={},ot=r.document,nt="2.1.1",it=function(t,e){return new it.fn.init(t,e)},rt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,st=/^-ms-/,at=/-([\da-z])/gi,lt=function(t,e){return e.toUpperCase()};it.fn=it.prototype={jquery:nt,constructor:it,selector:"",length:0,toArray:function(){return Y.call(this)},get:function(t){return null!=t?0>t?this[t+this.length]:this[t]:Y.call(this)},pushStack:function(t){var e=it.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return it.each(this,t,e)},map:function(t){return this.pushStack(it.map(this,function(e,o){return t.call(e,o,e)}))},slice:function(){return this.pushStack(Y.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,o=+t+(0>t?e:0);return this.pushStack(o>=0&&e>o?[this[o]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:$,sort:X.sort,splice:X.splice},it.extend=it.fn.extend=function(){var t,e,o,n,i,r,s=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[a]||{},a++),"object"==typeof s||it.isFunction(s)||(s={}),a===l&&(s=this,a--);l>a;a++)if(null!=(t=arguments[a]))for(e in t)o=s[e],n=t[e],s!==n&&(c&&n&&(it.isPlainObject(n)||(i=it.isArray(n)))?(i?(i=!1,r=o&&it.isArray(o)?o:[]):r=o&&it.isPlainObject(o)?o:{},s[e]=it.extend(c,r,n)):void 0!==n&&(s[e]=n));return s},it.extend({expando:"jQuery"+(nt+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===it.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){return!it.isArray(t)&&t-parseFloat(t)>=0},isPlainObject:function(t){return"object"===it.type(t)&&!t.nodeType&&!it.isWindow(t)&&!(t.constructor&&!tt.call(t.constructor.prototype,"isPrototypeOf"))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?J[Z.call(t)]||"object":typeof t},globalEval:function(t){var e,o=eval;(t=it.trim(t))&&(1===t.indexOf("use strict")?(e=ot.createElement("script"),e.text=t,ot.head.appendChild(e).parentNode.removeChild(e)):o(t))},camelCase:function(t){return t.replace(st,"ms-").replace(at,lt)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,o){var n=0,i=t.length,r=a(t);if(o){if(r)for(;i>n&&!1!==e.apply(t[n],o);n++);else for(n in t)if(!1===e.apply(t[n],o))break}else if(r)for(;i>n&&!1!==e.call(t[n],n,t[n]);n++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},trim:function(t){return null==t?"":(t+"").replace(rt,"")},makeArray:function(t,e){var o=e||[];return null!=t&&(a(Object(t))?it.merge(o,"string"==typeof t?[t]:t):$.call(o,t)),o},inArray:function(t,e,o){return null==e?-1:Q.call(e,t,o)},merge:function(t,e){for(var o=+e.length,n=0,i=t.length;o>n;n++)t[i++]=e[n];return t.length=i,t},grep:function(t,e,o){for(var n=[],i=0,r=t.length,s=!o;r>i;i++)!e(t[i],i)!==s&&n.push(t[i]);return n},map:function(t,e,o){var n,i=0,r=t.length,s=a(t),l=[];if(s)for(;r>i;i++)null!=(n=e(t[i],i,o))&&l.push(n);else for(i in t)null!=(n=e(t[i],i,o))&&l.push(n);return K.apply([],l)},guid:1,proxy:function(t,e){var o,n,i;return"string"==typeof e&&(o=t[e],e=t,t=o),it.isFunction(t)?(n=Y.call(arguments,2),i=function(){return t.apply(e||this,n.concat(Y.call(arguments)))},i.guid=t.guid=t.guid||it.guid++,i):void 0},now:Date.now,support:et}),it.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){J["[object "+e+"]"]=e.toLowerCase()});var ct=function(t){function e(t,e,o,n){var i,r,s,a,c,h,g,p,d,f;if((e?e.ownerDocument||e:j)!==B&&I(e),e=e||B,o=o||[],!t||"string"!=typeof t)return o;if(1!==(a=e.nodeType)&&9!==a)return[];if(L&&!n){if(i=mt.exec(t))if(s=i[1]){if(9===a){if(!(r=e.getElementById(s))||!r.parentNode)return o;if(r.id===s)return o.push(r),o}else if(e.ownerDocument&&(r=e.ownerDocument.getElementById(s))&&O(e,r)&&r.id===s)return o.push(r),o}else{if(i[2])return Q.apply(o,e.getElementsByTagName(t)),o;if((s=i[3])&&_.getElementsByClassName&&e.getElementsByClassName)return Q.apply(o,e.getElementsByClassName(s)),o}if(_.qsa&&(!N||!N.test(t))){if(p=g=P,d=e,f=9===a&&t,1===a&&"object"!==e.nodeName.toLowerCase()){for(h=S(t),(g=e.getAttribute("id"))?p=g.replace(vt,"\\$&"):e.setAttribute("id",p),p="[id='"+p+"'] ",c=h.length;c--;)h[c]=p+u(h[c]);d=yt.test(t)&&l(e.parentNode)||e,f=h.join(",")}if(f)try{return Q.apply(o,d.querySelectorAll(f)),o}catch(t){}finally{g||e.removeAttribute("id")}}}return w(t.replace(st,"$1"),e,o,n)}function o(){function t(o,n){return e.push(o+" ")>b.cacheLength&&delete t[e.shift()],t[o+" "]=n}var e=[];return t}function n(t){return t[P]=!0,t}function i(t){var e=B.createElement("div");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function r(t,e){for(var o=t.split("|"),n=t.length;n--;)b.attrHandle[o[n]]=e}function s(t,e){var o=e&&t,n=o&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||q)-(~t.sourceIndex||q);if(n)return n;if(o)for(;o=o.nextSibling;)if(o===e)return-1;return t?1:-1}function a(t){return n(function(e){return e=+e,n(function(o,n){for(var i,r=t([],o.length,e),s=r.length;s--;)o[i=r[s]]&&(o[i]=!(n[i]=o[i]))})})}function l(t){return t&&typeof t.getElementsByTagName!==z&&t}function c(){}function u(t){for(var e=0,o=t.length,n="";o>e;e++)n+=t[e].value;return n}function h(t,e,o){var n=e.dir,i=o&&"parentNode"===n,r=H++;return e.first?function(e,o,r){for(;e=e[n];)if(1===e.nodeType||i)return t(e,o,r)}:function(e,o,s){var a,l,c=[F,r];if(s){for(;e=e[n];)if((1===e.nodeType||i)&&t(e,o,s))return!0}else for(;e=e[n];)if(1===e.nodeType||i){if(l=e[P]||(e[P]={}),(a=l[n])&&a[0]===F&&a[1]===r)return c[2]=a[2];if(l[n]=c,c[2]=t(e,o,s))return!0}}}function g(t){return t.length>1?function(e,o,n){for(var i=t.length;i--;)if(!t[i](e,o,n))return!1;return!0}:t[0]}function p(t,o,n){for(var i=0,r=o.length;r>i;i++)e(t,o[i],n);return n}function d(t,e,o,n,i){for(var r,s=[],a=0,l=t.length,c=null!=e;l>a;a++)(r=t[a])&&(!o||o(r,n,i))&&(s.push(r),c&&e.push(a));return s}function f(t,e,o,i,r,s){return i&&!i[P]&&(i=f(i)),r&&!r[P]&&(r=f(r,s)),n(function(n,s,a,l){var c,u,h,g=[],f=[],m=s.length,y=n||p(e||"*",a.nodeType?[a]:a,[]),v=!t||!n&&e?y:d(y,g,t,a,l),_=o?r||(n?t:m||i)?[]:s:v;if(o&&o(v,_,a,l),i)for(c=d(_,f),i(c,[],a,l),u=c.length;u--;)(h=c[u])&&(_[f[u]]=!(v[f[u]]=h));if(n){if(r||t){if(r){for(c=[],u=_.length;u--;)(h=_[u])&&c.push(v[u]=h);r(null,_=[],c,l)}for(u=_.length;u--;)(h=_[u])&&(c=r?Z.call(n,h):g[u])>-1&&(n[c]=!(s[c]=h))}}else _=d(_===s?_.splice(m,_.length):_),r?r(null,s,_,l):Q.apply(s,_)})}function m(t){for(var e,o,n,i=t.length,r=b.relative[t[0].type],s=r||b.relative[" "],a=r?1:0,l=h(function(t){return t===e},s,!0),c=h(function(t){return Z.call(e,t)>-1},s,!0),p=[function(t,o,n){return!r&&(n||o!==C)||((e=o).nodeType?l(t,o,n):c(t,o,n))}];i>a;a++)if(o=b.relative[t[a].type])p=[h(g(p),o)];else{if(o=b.filter[t[a].type].apply(null,t[a].matches),o[P]){for(n=++a;i>n&&!b.relative[t[n].type];n++);return f(a>1&&g(p),a>1&&u(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(st,"$1"),o,n>a&&m(t.slice(a,n)),i>n&&m(t=t.slice(n)),i>n&&u(t))}p.push(o)}return g(p)}function y(t,o){var i=o.length>0,r=t.length>0,s=function(n,s,a,l,c){var u,h,g,p=0,f="0",m=n&&[],y=[],v=C,_=n||r&&b.find.TAG("*",c),E=F+=null==v?1:Math.random()||.1,x=_.length;for(c&&(C=s!==B&&s);f!==x&&null!=(u=_[f]);f++){if(r&&u){for(h=0;g=t[h++];)if(g(u,s,a)){l.push(u);break}c&&(F=E)}i&&((u=!g&&u)&&p--,n&&m.push(u))}if(p+=f,i&&f!==p){for(h=0;g=o[h++];)g(m,y,s,a);if(n){if(p>0)for(;f--;)m[f]||y[f]||(y[f]=K.call(l));y=d(y)}Q.apply(l,y),c&&!n&&y.length>0&&p+o.length>1&&e.uniqueSort(l)}return c&&(F=E,C=v),m};return i?n(s):s}var v,_,b,E,x,S,T,w,C,k,A,I,B,M,L,N,R,D,O,P="sizzle"+-new Date,j=t.document,F=0,H=0,U=o(),G=o(),V=o(),W=function(t,e){return t===e&&(A=!0),0},z="undefined",q=1<<31,X={}.hasOwnProperty,Y=[],K=Y.pop,$=Y.push,Q=Y.push,J=Y.slice,Z=Y.indexOf||function(t){for(var e=0,o=this.length;o>e;e++)if(this[e]===t)return e;return-1},tt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",et="[\\x20\\t\\r\\n\\f]",ot="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",nt=ot.replace("w","w#"),it="\\["+et+"*("+ot+")(?:"+et+"*([*^$|!~]?=)"+et+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+nt+"))|)"+et+"*\\]",rt=":("+ot+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+it+")*)|.*)\\)|)",st=new RegExp("^"+et+"+|((?:^|[^\\\\])(?:\\\\.)*)"+et+"+$","g"),at=new RegExp("^"+et+"*,"+et+"*"),lt=new RegExp("^"+et+"*([>+~]|"+et+")"+et+"*"),ct=new RegExp("="+et+"*([^\\]'\"]*?)"+et+"*\\]","g"),ut=new RegExp(rt),ht=new RegExp("^"+nt+"$"),gt={ID:new RegExp("^#("+ot+")"),CLASS:new RegExp("^\\.("+ot+")"),TAG:new RegExp("^("+ot.replace("w","w*")+")"),ATTR:new RegExp("^"+it),PSEUDO:new RegExp("^"+rt),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+et+"*(even|odd|(([+-]|)(\\d*)n|)"+et+"*(?:([+-]|)"+et+"*(\\d+)|))"+et+"*\\)|)","i"),bool:new RegExp("^(?:"+tt+")$","i"),needsContext:new RegExp("^"+et+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+et+"*((?:-\\d)?\\d*)"+et+"*\\)|)(?=[^-]|$)","i")},pt=/^(?:input|select|textarea|button)$/i,dt=/^h\d$/i,ft=/^[^{]+\{\s*\[native \w/,mt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,yt=/[+~]/,vt=/'|\\/g,_t=new RegExp("\\\\([\\da-f]{1,6}"+et+"?|("+et+")|.)","ig"),bt=function(t,e,o){var n="0x"+e-65536;return n!==n||o?e:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)};try{Q.apply(Y=J.call(j.childNodes),j.childNodes),Y[j.childNodes.length].nodeType}catch(t){Q={apply:Y.length?function(t,e){$.apply(t,J.call(e))}:function(t,e){for(var o=t.length,n=0;t[o++]=e[n++];);t.length=o-1}}}_=e.support={},x=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},I=e.setDocument=function(t){var e,o=t?t.ownerDocument||t:j,n=o.defaultView;return o!==B&&9===o.nodeType&&o.documentElement?(B=o,M=o.documentElement,L=!x(o),n&&n!==n.top&&(n.addEventListener?n.addEventListener("unload",function(){I()},!1):n.attachEvent&&n.attachEvent("onunload",function(){I()})),_.attributes=i(function(t){return t.className="i",!t.getAttribute("className")}),_.getElementsByTagName=i(function(t){return t.appendChild(o.createComment("")),!t.getElementsByTagName("*").length}),_.getElementsByClassName=ft.test(o.getElementsByClassName)&&i(function(t){return t.innerHTML="<div class='a'></div><div class='a i'></div>",t.firstChild.className="i",2===t.getElementsByClassName("i").length}),_.getById=i(function(t){return M.appendChild(t).id=P,!o.getElementsByName||!o.getElementsByName(P).length}),_.getById?(b.find.ID=function(t,e){if(typeof e.getElementById!==z&&L){var o=e.getElementById(t);return o&&o.parentNode?[o]:[]}},b.filter.ID=function(t){var e=t.replace(_t,bt);return function(t){return t.getAttribute("id")===e}}):(delete b.find.ID,b.filter.ID=function(t){var e=t.replace(_t,bt);return function(t){var o=typeof t.getAttributeNode!==z&&t.getAttributeNode("id");return o&&o.value===e}}),b.find.TAG=_.getElementsByTagName?function(t,e){return typeof e.getElementsByTagName!==z?e.getElementsByTagName(t):void 0}:function(t,e){var o,n=[],i=0,r=e.getElementsByTagName(t);if("*"===t){for(;o=r[i++];)1===o.nodeType&&n.push(o);return n}return r},b.find.CLASS=_.getElementsByClassName&&function(t,e){return typeof e.getElementsByClassName!==z&&L?e.getElementsByClassName(t):void 0},R=[],N=[],(_.qsa=ft.test(o.querySelectorAll))&&(i(function(t){t.innerHTML="<select msallowclip=''><option selected=''></option></select>",t.querySelectorAll("[msallowclip^='']").length&&N.push("[*^$]="+et+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||N.push("\\["+et+"*(?:value|"+tt+")"),t.querySelectorAll(":checked").length||N.push(":checked")}),i(function(t){var e=o.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&N.push("name"+et+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||N.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),N.push(",.*:")})),(_.matchesSelector=ft.test(D=M.matches||M.webkitMatchesSelector||M.mozMatchesSelector||M.oMatchesSelector||M.msMatchesSelector))&&i(function(t){_.disconnectedMatch=D.call(t,"div"),D.call(t,"[s!='']:x"),R.push("!=",rt)}),N=N.length&&new RegExp(N.join("|")),R=R.length&&new RegExp(R.join("|")),e=ft.test(M.compareDocumentPosition),O=e||ft.test(M.contains)?function(t,e){var o=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(o.contains?o.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},W=e?function(t,e){if(t===e)return A=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n||(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&n||!_.sortDetached&&e.compareDocumentPosition(t)===n?t===o||t.ownerDocument===j&&O(j,t)?-1:e===o||e.ownerDocument===j&&O(j,e)?1:k?Z.call(k,t)-Z.call(k,e):0:4&n?-1:1)}:function(t,e){if(t===e)return A=!0,0;var n,i=0,r=t.parentNode,a=e.parentNode,l=[t],c=[e];if(!r||!a)return t===o?-1:e===o?1:r?-1:a?1:k?Z.call(k,t)-Z.call(k,e):0;if(r===a)return s(t,e);for(n=t;n=n.parentNode;)l.unshift(n);for(n=e;n=n.parentNode;)c.unshift(n);for(;l[i]===c[i];)i++;return i?s(l[i],c[i]):l[i]===j?-1:c[i]===j?1:0},o):B},e.matches=function(t,o){return e(t,null,null,o)},e.matchesSelector=function(t,o){if((t.ownerDocument||t)!==B&&I(t),o=o.replace(ct,"='$1']"),!(!_.matchesSelector||!L||R&&R.test(o)||N&&N.test(o)))try{var n=D.call(t,o);if(n||_.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(t){}return e(o,B,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==B&&I(t),O(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==B&&I(t);var o=b.attrHandle[e.toLowerCase()],n=o&&X.call(b.attrHandle,e.toLowerCase())?o(t,e,!L):void 0;return void 0!==n?n:_.attributes||!L?t.getAttribute(e):(n=t.getAttributeNode(e))&&n.specified?n.value:null},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,o=[],n=0,i=0;if(A=!_.detectDuplicates,k=!_.sortStable&&t.slice(0),t.sort(W),A){for(;e=t[i++];)e===t[i]&&(n=o.push(i));for(;n--;)t.splice(o[n],1)}return k=null,t},E=e.getText=function(t){var e,o="",n=0,i=t.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)o+=E(t)}else if(3===i||4===i)return t.nodeValue}else for(;e=t[n++];)o+=E(e);return o},b=e.selectors={cacheLength:50,createPseudo:n,match:gt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(_t,bt),t[3]=(t[3]||t[4]||t[5]||"").replace(_t,bt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,o=!t[6]&&t[2];return gt.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":o&&ut.test(o)&&(e=S(o,!0))&&(e=o.indexOf(")",o.length-e)-o.length)&&(t[0]=t[0].slice(0,e),t[2]=o.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(_t,bt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=U[t+" "];return e||(e=new RegExp("(^|"+et+")"+t+"("+et+"|$)"))&&U(t,function(t){return e.test("string"==typeof t.className&&t.className||typeof t.getAttribute!==z&&t.getAttribute("class")||"")})},ATTR:function(t,o,n){return function(i){var r=e.attr(i,t);return null==r?"!="===o:!o||(r+="","="===o?r===n:"!="===o?r!==n:"^="===o?n&&0===r.indexOf(n):"*="===o?n&&r.indexOf(n)>-1:"$="===o?n&&r.slice(-n.length)===n:"~="===o?(" "+r+" ").indexOf(n)>-1:"|="===o&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,o,n,i){var r="nth"!==t.slice(0,3),s="last"!==t.slice(-4),a="of-type"===e;return 1===n&&0===i?function(t){return!!t.parentNode}:function(e,o,l){var c,u,h,g,p,d,f=r!==s?"nextSibling":"previousSibling",m=e.parentNode,y=a&&e.nodeName.toLowerCase(),v=!l&&!a;if(m){if(r){for(;f;){for(h=e;h=h[f];)if(a?h.nodeName.toLowerCase()===y:1===h.nodeType)return!1;d=f="only"===t&&!d&&"nextSibling"}return!0}if(d=[s?m.firstChild:m.lastChild],s&&v){for(u=m[P]||(m[P]={}),c=u[t]||[],p=c[0]===F&&c[1],g=c[0]===F&&c[2],h=p&&m.childNodes[p];h=++p&&h&&h[f]||(g=p=0)||d.pop();)if(1===h.nodeType&&++g&&h===e){u[t]=[F,p,g];break}}else if(v&&(c=(e[P]||(e[P]={}))[t])&&c[0]===F)g=c[1];else for(;(h=++p&&h&&h[f]||(g=p=0)||d.pop())&&((a?h.nodeName.toLowerCase()!==y:1!==h.nodeType)||!++g||(v&&((h[P]||(h[P]={}))[t]=[F,g]),h!==e)););return(g-=i)===n||g%n==0&&g/n>=0}}},PSEUDO:function(t,o){var i,r=b.pseudos[t]||b.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return r[P]?r(o):r.length>1?(i=[t,t,"",o],b.setFilters.hasOwnProperty(t.toLowerCase())?n(function(t,e){for(var n,i=r(t,o),s=i.length;s--;)n=Z.call(t,i[s]),t[n]=!(e[n]=i[s])}):function(t){return r(t,0,i)}):r}},pseudos:{not:n(function(t){var e=[],o=[],i=T(t.replace(st,"$1"));return i[P]?n(function(t,e,o,n){for(var r,s=i(t,null,n,[]),a=t.length;a--;)(r=s[a])&&(t[a]=!(e[a]=r))}):function(t,n,r){return e[0]=t,i(e,null,r,o),!o.pop()}}),has:n(function(t){return function(o){return e(t,o).length>0}}),contains:n(function(t){return function(e){return(e.textContent||e.innerText||E(e)).indexOf(t)>-1}}),lang:n(function(t){return ht.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(_t,bt).toLowerCase(),function(e){var o;do{if(o=L?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(o=o.toLowerCase())===t||0===o.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var o=t.location&&t.location.hash;return o&&o.slice(1)===e.id},root:function(t){return t===M},focus:function(t){return t===B.activeElement&&(!B.hasFocus||B.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!b.pseudos.empty(t)},header:function(t){return dt.test(t.nodeName)},input:function(t){return pt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:a(function(){return[0]}),last:a(function(t,e){return[e-1]}),eq:a(function(t,e,o){return[0>o?o+e:o]}),even:a(function(t,e){for(var o=0;e>o;o+=2)t.push(o);return t}),odd:a(function(t,e){for(var o=1;e>o;o+=2)t.push(o);return t}),lt:a(function(t,e,o){for(var n=0>o?o+e:o;--n>=0;)t.push(n);return t}),gt:a(function(t,e,o){for(var n=0>o?o+e:o;++n<e;)t.push(n);return t})}},b.pseudos.nth=b.pseudos.eq;for(v in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[v]=function(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}(v);for(v in{submit:!0,reset:!0})b.pseudos[v]=function(t){return function(e){var o=e.nodeName.toLowerCase();return("input"===o||"button"===o)&&e.type===t}}(v);return c.prototype=b.filters=b.pseudos,b.setFilters=new c,S=e.tokenize=function(t,o){var n,i,r,s,a,l,c,u=G[t+" "];if(u)return o?0:u.slice(0);for(a=t,l=[],c=b.preFilter;a;){(!n||(i=at.exec(a)))&&(i&&(a=a.slice(i[0].length)||a),l.push(r=[])),n=!1,(i=lt.exec(a))&&(n=i.shift(),r.push({value:n,type:i[0].replace(st," ")}),a=a.slice(n.length));for(s in b.filter)!(i=gt[s].exec(a))||c[s]&&!(i=c[s](i))||(n=i.shift(),r.push({value:n,type:s,matches:i}),a=a.slice(n.length));if(!n)break}return o?a.length:a?e.error(t):G(t,l).slice(0)},T=e.compile=function(t,e){var o,n=[],i=[],r=V[t+" "];if(!r){for(e||(e=S(t)),o=e.length;o--;)r=m(e[o]),r[P]?n.push(r):i.push(r);r=V(t,y(i,n)),r.selector=t}return r},w=e.select=function(t,e,o,n){var i,r,s,a,c,h="function"==typeof t&&t,g=!n&&S(t=h.selector||t);if(o=o||[],1===g.length){if(r=g[0]=g[0].slice(0),r.length>2&&"ID"===(s=r[0]).type&&_.getById&&9===e.nodeType&&L&&b.relative[r[1].type]){if(!(e=(b.find.ID(s.matches[0].replace(_t,bt),e)||[])[0]))return o;h&&(e=e.parentNode),t=t.slice(r.shift().value.length)}for(i=gt.needsContext.test(t)?0:r.length;i--&&(s=r[i],!b.relative[a=s.type]);)if((c=b.find[a])&&(n=c(s.matches[0].replace(_t,bt),yt.test(r[0].type)&&l(e.parentNode)||e))){if(r.splice(i,1),!(t=n.length&&u(r)))return Q.apply(o,n),o;break}}return(h||T(t,g))(n,e,!L,o,yt.test(t)&&l(e.parentNode)||e),o},_.sortStable=P.split("").sort(W).join("")===P,_.detectDuplicates=!!A,I(),_.sortDetached=i(function(t){return 1&t.compareDocumentPosition(B.createElement("div"))}),i(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||r("type|href|height|width",function(t,e,o){return o?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),_.attributes&&i(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||r("value",function(t,e,o){return o||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue}),i(function(t){return null==t.getAttribute("disabled")})||r(tt,function(t,e,o){var n;return o?void 0:!0===t[e]?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null}),e}(r);it.find=ct,it.expr=ct.selectors,it.expr[":"]=it.expr.pseudos,it.unique=ct.uniqueSort,it.text=ct.getText,it.isXMLDoc=ct.isXML,it.contains=ct.contains;var ut=it.expr.match.needsContext,ht=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,gt=/^.[^:#\[\.,]*$/;it.filter=function(t,e,o){var n=e[0];return o&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?it.find.matchesSelector(n,t)?[n]:[]:it.find.matches(t,it.grep(e,function(t){return 1===t.nodeType}))},it.fn.extend({find:function(t){var e,o=this.length,n=[],i=this;if("string"!=typeof t)return this.pushStack(it(t).filter(function(){for(e=0;o>e;e++)if(it.contains(i[e],this))return!0}));for(e=0;o>e;e++)it.find(t,i[e],n);return n=this.pushStack(o>1?it.unique(n):n),n.selector=this.selector?this.selector+" "+t:t,n},filter:function(t){return this.pushStack(l(this,t||[],!1))},not:function(t){return this.pushStack(l(this,t||[],!0))},is:function(t){return!!l(this,"string"==typeof t&&ut.test(t)?it(t):t||[],!1).length}});var pt,dt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(it.fn.init=function(t,e){var o,n;if(!t)return this;if("string"==typeof t){if(!(o="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:dt.exec(t))||!o[1]&&e)return!e||e.jquery?(e||pt).find(t):this.constructor(e).find(t);if(o[1]){if(e=e instanceof it?e[0]:e,it.merge(this,it.parseHTML(o[1],e&&e.nodeType?e.ownerDocument||e:ot,!0)),ht.test(o[1])&&it.isPlainObject(e))for(o in e)it.isFunction(this[o])?this[o](e[o]):this.attr(o,e[o]);return this}return n=ot.getElementById(o[2]),n&&n.parentNode&&(this.length=1,this[0]=n),this.context=ot,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):it.isFunction(t)?void 0!==pt.ready?pt.ready(t):t(it):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),it.makeArray(t,this))}).prototype=it.fn,pt=it(ot);var ft=/^(?:parents|prev(?:Until|All))/,mt={children:!0,contents:!0,next:!0,prev:!0};it.extend({dir:function(t,e,o){for(var n=[],i=void 0!==o;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(i&&it(t).is(o))break;n.push(t)}return n},sibling:function(t,e){for(var o=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&o.push(t);return o}}),it.fn.extend({has:function(t){var e=it(t,this),o=e.length;return this.filter(function(){for(var t=0;o>t;t++)if(it.contains(this,e[t]))return!0})},closest:function(t,e){for(var o,n=0,i=this.length,r=[],s=ut.test(t)||"string"!=typeof t?it(t,e||this.context):0;i>n;n++)for(o=this[n];o&&o!==e;o=o.parentNode)if(o.nodeType<11&&(s?s.index(o)>-1:1===o.nodeType&&it.find.matchesSelector(o,t))){r.push(o);break}return this.pushStack(r.length>1?it.unique(r):r)},index:function(t){return t?"string"==typeof t?Q.call(it(t),this[0]):Q.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(it.unique(it.merge(this.get(),it(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),it.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return it.dir(t,"parentNode")},parentsUntil:function(t,e,o){return it.dir(t,"parentNode",o)},next:function(t){return c(t,"nextSibling")},prev:function(t){return c(t,"previousSibling")},nextAll:function(t){return it.dir(t,"nextSibling")},prevAll:function(t){return it.dir(t,"previousSibling")},nextUntil:function(t,e,o){return it.dir(t,"nextSibling",o)},prevUntil:function(t,e,o){return it.dir(t,"previousSibling",o)},siblings:function(t){return it.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return it.sibling(t.firstChild)},contents:function(t){return t.contentDocument||it.merge([],t.childNodes)}},function(t,e){it.fn[t]=function(o,n){var i=it.map(this,e,o);return"Until"!==t.slice(-5)&&(n=o),n&&"string"==typeof n&&(i=it.filter(n,i)),this.length>1&&(mt[t]||it.unique(i),ft.test(t)&&i.reverse()),this.pushStack(i)}});var yt=/\S+/g,vt={};it.Callbacks=function(t){t="string"==typeof t?vt[t]||u(t):it.extend({},t);var e,o,n,i,r,s,a=[],l=!t.once&&[],c=function(u){for(e=t.memory&&u,o=!0,s=i||0,i=0,r=a.length,n=!0;a&&r>s;s++)if(!1===a[s].apply(u[0],u[1])&&t.stopOnFalse){e=!1;break}n=!1,a&&(l?l.length&&c(l.shift()):e?a=[]:h.disable())},h={add:function(){if(a){var o=a.length;!function e(o){it.each(o,function(o,n){var i=it.type(n);"function"===i?t.unique&&h.has(n)||a.push(n):n&&n.length&&"string"!==i&&e(n)})}(arguments),n?r=a.length:e&&(i=o,c(e))}return this},remove:function(){return a&&it.each(arguments,function(t,e){for(var o;(o=it.inArray(e,a,o))>-1;)a.splice(o,1),n&&(r>=o&&r--,s>=o&&s--)}),this},has:function(t){return t?it.inArray(t,a)>-1:!(!a||!a.length)},empty:function(){return a=[],r=0,this},disable:function(){return a=l=e=void 0,this},disabled:function(){return!a},lock:function(){return l=void 0,e||h.disable(),this},locked:function(){return!l},fireWith:function(t,e){return!a||o&&!l||(e=e||[],e=[t,e.slice?e.slice():e],n?l.push(e):c(e)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!o}};return h},it.extend({Deferred:function(t){var e=[["resolve","done",it.Callbacks("once memory"),"resolved"],["reject","fail",it.Callbacks("once memory"),"rejected"],["notify","progress",it.Callbacks("memory")]],o="pending",n={state:function(){return o},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var t=arguments;return it.Deferred(function(o){it.each(e,function(e,r){var s=it.isFunction(t[e])&&t[e];i[r[1]](function(){var t=s&&s.apply(this,arguments);t&&it.isFunction(t.promise)?t.promise().done(o.resolve).fail(o.reject).progress(o.notify):o[r[0]+"With"](this===n?o.promise():this,s?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?it.extend(t,n):n}},i={};return n.pipe=n.then,it.each(e,function(t,r){var s=r[2],a=r[3];n[r[1]]=s.add,a&&s.add(function(){o=a},e[1^t][2].disable,e[2][2].lock),i[r[0]]=function(){return i[r[0]+"With"](this===i?n:this,arguments),this},i[r[0]+"With"]=s.fireWith}),n.promise(i),t&&t.call(i,i),i},when:function(t){var e,o,n,i=0,r=Y.call(arguments),s=r.length,a=1!==s||t&&it.isFunction(t.promise)?s:0,l=1===a?t:it.Deferred(),c=function(t,o,n){return function(i){o[t]=this,n[t]=arguments.length>1?Y.call(arguments):i,n===e?l.notifyWith(o,n):--a||l.resolveWith(o,n)}};if(s>1)for(e=new Array(s),o=new Array(s),n=new Array(s);s>i;i++)r[i]&&it.isFunction(r[i].promise)?r[i].promise().done(c(i,n,r)).fail(l.reject).progress(c(i,o,e)):--a;return a||l.resolveWith(n,r),l.promise()}});var _t;it.fn.ready=function(t){return it.ready.promise().done(t),this},it.extend({isReady:!1,readyWait:1,holdReady:function(t){t?it.readyWait++:it.ready(!0)},ready:function(t){(!0===t?--it.readyWait:it.isReady)||(it.isReady=!0,!0!==t&&--it.readyWait>0||(_t.resolveWith(ot,[it]),it.fn.triggerHandler&&(it(ot).triggerHandler("ready"),it(ot).off("ready"))))}}),it.ready.promise=function(t){return _t||(_t=it.Deferred(),"complete"===ot.readyState?setTimeout(it.ready):(ot.addEventListener("DOMContentLoaded",h,!1),r.addEventListener("load",h,!1))),_t.promise(t)},it.ready.promise();var bt=it.access=function(t,e,o,n,i,r,s){var a=0,l=t.length,c=null==o;if("object"===it.type(o)){i=!0;for(a in o)it.access(t,e,a,o[a],!0,r,s)}else if(void 0!==n&&(i=!0,it.isFunction(n)||(s=!0),c&&(s?(e.call(t,n),e=null):(c=e,e=function(t,e,o){return c.call(it(t),o)})),e))for(;l>a;a++)e(t[a],o,s?n:n.call(t[a],a,e(t[a],o)));return i?t:c?e.call(t):l?e(t[0],o):r};it.acceptData=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType},g.uid=1,g.accepts=it.acceptData,g.prototype={key:function(t){if(!g.accepts(t))return 0;var e={},o=t[this.expando];if(!o){o=g.uid++;try{e[this.expando]={value:o},Object.defineProperties(t,e)}catch(n){e[this.expando]=o,it.extend(t,e)}}return this.cache[o]||(this.cache[o]={}),o},set:function(t,e,o){var n,i=this.key(t),r=this.cache[i];if("string"==typeof e)r[e]=o;else if(it.isEmptyObject(r))it.extend(this.cache[i],e);else for(n in e)r[n]=e[n];return r},get:function(t,e){var o=this.cache[this.key(t)];return void 0===e?o:o[e]},access:function(t,e,o){var n;return void 0===e||e&&"string"==typeof e&&void 0===o?(n=this.get(t,e),void 0!==n?n:this.get(t,it.camelCase(e))):(this.set(t,e,o),void 0!==o?o:e)},remove:function(t,e){var o,n,i,r=this.key(t),s=this.cache[r];if(void 0===e)this.cache[r]={};else{it.isArray(e)?n=e.concat(e.map(it.camelCase)):(i=it.camelCase(e),e in s?n=[e,i]:(n=i,n=n in s?[n]:n.match(yt)||[])),o=n.length;for(;o--;)delete s[n[o]]}},hasData:function(t){return!it.isEmptyObject(this.cache[t[this.expando]]||{})},discard:function(t){t[this.expando]&&delete this.cache[t[this.expando]]}};var Et=new g,xt=new g,St=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Tt=/([A-Z])/g;it.extend({hasData:function(t){return xt.hasData(t)||Et.hasData(t)},data:function(t,e,o){return xt.access(t,e,o)},removeData:function(t,e){xt.remove(t,e)},_data:function(t,e,o){return Et.access(t,e,o)},_removeData:function(t,e){Et.remove(t,e)}}),it.fn.extend({data:function(t,e){var o,n,i,r=this[0],s=r&&r.attributes;if(void 0===t){if(this.length&&(i=xt.get(r),1===r.nodeType&&!Et.get(r,"hasDataAttrs"))){for(o=s.length;o--;)s[o]&&(n=s[o].name,0===n.indexOf("data-")&&(n=it.camelCase(n.slice(5)),p(r,n,i[n])));Et.set(r,"hasDataAttrs",!0)}return i}return"object"==typeof t?this.each(function(){xt.set(this,t)}):bt(this,function(e){var o,n=it.camelCase(t);if(r&&void 0===e){if(void 0!==(o=xt.get(r,t)))return o;if(void 0!==(o=xt.get(r,n)))return o;if(void 0!==(o=p(r,n,void 0)))return o}else this.each(function(){var o=xt.get(this,n);xt.set(this,n,e),-1!==t.indexOf("-")&&void 0!==o&&xt.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){xt.remove(this,t)})}}),it.extend({queue:function(t,e,o){var n;return t?(e=(e||"fx")+"queue",n=Et.get(t,e),o&&(!n||it.isArray(o)?n=Et.access(t,e,it.makeArray(o)):n.push(o)),n||[]):void 0},dequeue:function(t,e){e=e||"fx";var o=it.queue(t,e),n=o.length,i=o.shift(),r=it._queueHooks(t,e),s=function(){it.dequeue(t,e)};"inprogress"===i&&(i=o.shift(),n--),i&&("fx"===e&&o.unshift("inprogress"),delete r.stop,i.call(t,s,r)),!n&&r&&r.empty.fire()},_queueHooks:function(t,e){var o=e+"queueHooks";return Et.get(t,o)||Et.access(t,o,{empty:it.Callbacks("once memory").add(function(){Et.remove(t,[e+"queue",o])})})}}),it.fn.extend({queue:function(t,e){var o=2;return"string"!=typeof t&&(e=t,t="fx",o--),arguments.length<o?it.queue(this[0],t):void 0===e?this:this.each(function(){var o=it.queue(this,t,e);it._queueHooks(this,t),"fx"===t&&"inprogress"!==o[0]&&it.dequeue(this,t)})},dequeue:function(t){return this.each(function(){it.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var o,n=1,i=it.Deferred(),r=this,s=this.length,a=function(){--n||i.resolveWith(r,[r])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)(o=Et.get(r[s],t+"queueHooks"))&&o.empty&&(n++,o.empty.add(a));return a(),i.promise(e)}});var wt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ct=["Top","Right","Bottom","Left"],kt=function(t,e){return t=e||t,"none"===it.css(t,"display")||!it.contains(t.ownerDocument,t)},At=/^(?:checkbox|radio)$/i;!function(){var t=ot.createDocumentFragment(),e=t.appendChild(ot.createElement("div")),o=ot.createElement("input");o.setAttribute("type","radio"),o.setAttribute("checked","checked"),o.setAttribute("name","t"),e.appendChild(o),et.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",et.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var It="undefined";et.focusinBubbles="onfocusin"in r;var Bt=/^key/,Mt=/^(?:mouse|pointer|contextmenu)|click/,Lt=/^(?:focusinfocus|focusoutblur)$/,Nt=/^([^.]*)(?:\.(.+)|)$/;it.event={global:{},add:function(t,e,o,n,i){var r,s,a,l,c,u,h,g,p,d,f,m=Et.get(t);if(m)for(o.handler&&(r=o,o=r.handler,i=r.selector),o.guid||(o.guid=it.guid++),(l=m.events)||(l=m.events={}),(s=m.handle)||(s=m.handle=function(e){return typeof it!==It&&it.event.triggered!==e.type?it.event.dispatch.apply(t,arguments):void 0}),e=(e||"").match(yt)||[""],c=e.length;c--;)a=Nt.exec(e[c])||[],p=f=a[1],d=(a[2]||"").split(".").sort(),p&&(h=it.event.special[p]||{},p=(i?h.delegateType:h.bindType)||p,h=it.event.special[p]||{},u=it.extend({type:p,origType:f,data:n,handler:o,guid:o.guid,selector:i,needsContext:i&&it.expr.match.needsContext.test(i),namespace:d.join(".")},r),(g=l[p])||(g=l[p]=[],g.delegateCount=0,h.setup&&!1!==h.setup.call(t,n,d,s)||t.addEventListener&&t.addEventListener(p,s,!1)),h.add&&(h.add.call(t,u),u.handler.guid||(u.handler.guid=o.guid)),i?g.splice(g.delegateCount++,0,u):g.push(u),it.event.global[p]=!0)},remove:function(t,e,o,n,i){var r,s,a,l,c,u,h,g,p,d,f,m=Et.hasData(t)&&Et.get(t);if(m&&(l=m.events)){for(e=(e||"").match(yt)||[""],c=e.length;c--;)if(a=Nt.exec(e[c])||[],p=f=a[1],d=(a[2]||"").split(".").sort(),p){for(h=it.event.special[p]||{},p=(n?h.delegateType:h.bindType)||p,g=l[p]||[],a=a[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=r=g.length;r--;)u=g[r],!i&&f!==u.origType||o&&o.guid!==u.guid||a&&!a.test(u.namespace)||n&&n!==u.selector&&("**"!==n||!u.selector)||(g.splice(r,1),u.selector&&g.delegateCount--,h.remove&&h.remove.call(t,u));s&&!g.length&&(h.teardown&&!1!==h.teardown.call(t,d,m.handle)||it.removeEvent(t,p,m.handle),delete l[p])}else for(p in l)it.event.remove(t,p+e[c],o,n,!0);it.isEmptyObject(l)&&(delete m.handle,Et.remove(t,"events"))}},trigger:function(t,e,o,n){var i,s,a,l,c,u,h,g=[o||ot],p=tt.call(t,"type")?t.type:t,d=tt.call(t,"namespace")?t.namespace.split("."):[];if(s=a=o=o||ot,3!==o.nodeType&&8!==o.nodeType&&!Lt.test(p+it.event.triggered)&&(p.indexOf(".")>=0&&(d=p.split("."),p=d.shift(),d.sort()),c=p.indexOf(":")<0&&"on"+p,t=t[it.expando]?t:new it.Event(p,"object"==typeof t&&t),t.isTrigger=n?2:3,t.namespace=d.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=o),e=null==e?[t]:it.makeArray(e,[t]),h=it.event.special[p]||{},n||!h.trigger||!1!==h.trigger.apply(o,e))){if(!n&&!h.noBubble&&!it.isWindow(o)){for(l=h.delegateType||p,Lt.test(l+p)||(s=s.parentNode);s;s=s.parentNode)g.push(s),a=s;a===(o.ownerDocument||ot)&&g.push(a.defaultView||a.parentWindow||r)}for(i=0;(s=g[i++])&&!t.isPropagationStopped();)t.type=i>1?l:h.bindType||p,u=(Et.get(s,"events")||{})[t.type]&&Et.get(s,"handle"),u&&u.apply(s,e),(u=c&&s[c])&&u.apply&&it.acceptData(s)&&(t.result=u.apply(s,e),!1===t.result&&t.preventDefault());return t.type=p,n||t.isDefaultPrevented()||h._default&&!1!==h._default.apply(g.pop(),e)||!it.acceptData(o)||c&&it.isFunction(o[p])&&!it.isWindow(o)&&(a=o[c],a&&(o[c]=null),it.event.triggered=p,o[p](),it.event.triggered=void 0,a&&(o[c]=a)),t.result}},dispatch:function(t){t=it.event.fix(t);var e,o,n,i,r,s=[],a=Y.call(arguments),l=(Et.get(this,"events")||{})[t.type]||[],c=it.event.special[t.type]||{};if(a[0]=t,t.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,t)){for(s=it.event.handlers.call(this,t,l),e=0;(i=s[e++])&&!t.isPropagationStopped();)for(t.currentTarget=i.elem,o=0;(r=i.handlers[o++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(r.namespace))&&(t.handleObj=r,t.data=r.data,void 0!==(n=((it.event.special[r.origType]||{}).handle||r.handler).apply(i.elem,a))&&!1===(t.result=n)&&(t.preventDefault(),t.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,t),t.result}},handlers:function(t,e){var o,n,i,r,s=[],a=e.delegateCount,l=t.target;if(a&&l.nodeType&&(!t.button||"click"!==t.type))for(;l!==this;l=l.parentNode||this)if(!0!==l.disabled||"click"!==t.type){for(n=[],o=0;a>o;o++)r=e[o],i=r.selector+" ",void 0===n[i]&&(n[i]=r.needsContext?it(i,this).index(l)>=0:it.find(i,this,null,[l]).length),n[i]&&n.push(r);n.length&&s.push({elem:l,handlers:n})}return a<e.length&&s.push({elem:this,handlers:e.slice(a)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var o,n,i,r=e.button;return null==t.pageX&&null!=e.clientX&&(o=t.target.ownerDocument||ot,n=o.documentElement,i=o.body,t.pageX=e.clientX+(n&&n.scrollLeft||i&&i.scrollLeft||0)-(n&&n.clientLeft||i&&i.clientLeft||0),t.pageY=e.clientY+(n&&n.scrollTop||i&&i.scrollTop||0)-(n&&n.clientTop||i&&i.clientTop||0)),t.which||void 0===r||(t.which=1&r?1:2&r?3:4&r?2:0),t}},fix:function(t){if(t[it.expando])return t;var e,o,n,i=t.type,r=t,s=this.fixHooks[i];for(s||(this.fixHooks[i]=s=Mt.test(i)?this.mouseHooks:Bt.test(i)?this.keyHooks:{}),n=s.props?this.props.concat(s.props):this.props,t=new it.Event(r),e=n.length;e--;)o=n[e],t[o]=r[o];return t.target||(t.target=ot),3===t.target.nodeType&&(t.target=t.target.parentNode),s.filter?s.filter(t,r):t},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==m()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===m()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&it.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(t){return it.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,o,n){var i=it.extend(new it.Event,o,{type:t,isSimulated:!0,originalEvent:{}});n?it.event.trigger(i,null,e):it.event.dispatch.call(e,i),i.isDefaultPrevented()&&o.preventDefault()}},it.removeEvent=function(t,e,o){t.removeEventListener&&t.removeEventListener(e,o,!1)},it.Event=function(t,e){return this instanceof it.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?d:f):this.type=t,e&&it.extend(this,e),this.timeStamp=t&&t.timeStamp||it.now(),void(this[it.expando]=!0)):new it.Event(t,e)},it.Event.prototype={isDefaultPrevented:f,isPropagationStopped:f,isImmediatePropagationStopped:f,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=d,t&&t.preventDefault&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=d,t&&t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=d,t&&t.stopImmediatePropagation&&t.stopImmediatePropagation(),this.stopPropagation()}},it.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){it.event.special[t]={delegateType:e,bindType:e,handle:function(t){var o,n=this,i=t.relatedTarget,r=t.handleObj;return(!i||i!==n&&!it.contains(n,i))&&(t.type=r.origType,o=r.handler.apply(this,arguments),t.type=e),o}}}),et.focusinBubbles||it.each({focus:"focusin",blur:"focusout"},function(t,e){var o=function(t){it.event.simulate(e,t.target,it.event.fix(t),!0)};it.event.special[e]={setup:function(){var n=this.ownerDocument||this,i=Et.access(n,e);i||n.addEventListener(t,o,!0),Et.access(n,e,(i||0)+1)},teardown:function(){var n=this.ownerDocument||this,i=Et.access(n,e)-1;i?Et.access(n,e,i):(n.removeEventListener(t,o,!0),Et.remove(n,e))}}}),it.fn.extend({on:function(t,e,o,n,i){var r,s;if("object"==typeof t){"string"!=typeof e&&(o=o||e,e=void 0);for(s in t)this.on(s,e,o,t[s],i);return this}if(null==o&&null==n?(n=e,o=e=void 0):null==n&&("string"==typeof e?(n=o,o=void 0):(n=o,o=e,e=void 0)),!1===n)n=f;else if(!n)return this;return 1===i&&(r=n,n=function(t){return it().off(t),r.apply(this,arguments)},n.guid=r.guid||(r.guid=it.guid++)),this.each(function(){it.event.add(this,t,n,o,e)})},one:function(t,e,o,n){return this.on(t,e,o,n,1)},off:function(t,e,o){var n,i;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,it(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(i in t)this.off(i,e,t[i]);return this}return(!1===e||"function"==typeof e)&&(o=e,e=void 0),!1===o&&(o=f),this.each(function(){it.event.remove(this,t,o,e)})},trigger:function(t,e){return this.each(function(){it.event.trigger(t,e,this)})},triggerHandler:function(t,e){var o=this[0];return o?it.event.trigger(t,e,o,!0):void 0}});var Rt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Dt=/<([\w:]+)/,Ot=/<|&#?\w+;/,Pt=/<(?:script|style|link)/i,jt=/checked\s*(?:[^=]|=\s*.checked.)/i,Ft=/^$|\/(?:java|ecma)script/i,Ht=/^true\/(.*)/,Ut=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Gt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Gt.optgroup=Gt.option,Gt.tbody=Gt.tfoot=Gt.colgroup=Gt.caption=Gt.thead,Gt.th=Gt.td,it.extend({clone:function(t,e,o){var n,i,r,s,a=t.cloneNode(!0),l=it.contains(t.ownerDocument,t);if(!(et.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||it.isXMLDoc(t)))for(s=x(a),r=x(t),n=0,i=r.length;i>n;n++)S(r[n],s[n]);if(e)if(o)for(r=r||x(t),s=s||x(a),n=0,i=r.length;i>n;n++)E(r[n],s[n]);else E(t,a);return s=x(a,"script"),s.length>0&&b(s,!l&&x(t,"script")),a},buildFragment:function(t,e,o,n){for(var i,r,s,a,l,c,u=e.createDocumentFragment(),h=[],g=0,p=t.length;p>g;g++)if((i=t[g])||0===i)if("object"===it.type(i))it.merge(h,i.nodeType?[i]:i);else if(Ot.test(i)){for(r=r||u.appendChild(e.createElement("div")),s=(Dt.exec(i)||["",""])[1].toLowerCase(),a=Gt[s]||Gt._default,r.innerHTML=a[1]+i.replace(Rt,"<$1></$2>")+a[2],c=a[0];c--;)r=r.lastChild;it.merge(h,r.childNodes),r=u.firstChild,r.textContent=""}else h.push(e.createTextNode(i));for(u.textContent="",g=0;i=h[g++];)if((!n||-1===it.inArray(i,n))&&(l=it.contains(i.ownerDocument,i),r=x(u.appendChild(i),"script"),l&&b(r),o))for(c=0;i=r[c++];)Ft.test(i.type||"")&&o.push(i);return u},cleanData:function(t){for(var e,o,n,i,r=it.event.special,s=0;void 0!==(o=t[s]);s++){if(it.acceptData(o)&&(i=o[Et.expando])&&(e=Et.cache[i])){if(e.events)for(n in e.events)r[n]?it.event.remove(o,n):it.removeEvent(o,n,e.handle);Et.cache[i]&&delete Et.cache[i]}delete xt.cache[o[xt.expando]]}}}),it.fn.extend({text:function(t){return bt(this,function(t){return void 0===t?it.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=t)})},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){y(this,t).appendChild(t)}})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=y(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var o,n=t?it.filter(t,this):this,i=0;null!=(o=n[i]);i++)e||1!==o.nodeType||it.cleanData(x(o)),o.parentNode&&(e&&it.contains(o.ownerDocument,o)&&b(x(o,"script")),o.parentNode.removeChild(o));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(it.cleanData(x(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return it.clone(this,t,e)})},html:function(t){return bt(this,function(t){var e=this[0]||{},o=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Pt.test(t)&&!Gt[(Dt.exec(t)||["",""])[1].toLowerCase()]){t=t.replace(Rt,"<$1></$2>");try{for(;n>o;o++)e=this[o]||{},1===e.nodeType&&(it.cleanData(x(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=arguments[0];return this.domManip(arguments,function(e){t=this.parentNode,it.cleanData(x(this)),t&&t.replaceChild(e,this)}),t&&(t.length||t.nodeType)?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e){t=K.apply([],t);var o,n,i,r,s,a,l=0,c=this.length,u=this,h=c-1,g=t[0],p=it.isFunction(g);if(p||c>1&&"string"==typeof g&&!et.checkClone&&jt.test(g))return this.each(function(o){var n=u.eq(o);p&&(t[0]=g.call(this,o,n.html())),n.domManip(t,e)});if(c&&(o=it.buildFragment(t,this[0].ownerDocument,!1,this),n=o.firstChild,1===o.childNodes.length&&(o=n),n)){for(i=it.map(x(o,"script"),v),r=i.length;c>l;l++)s=o,l!==h&&(s=it.clone(s,!0,!0),r&&it.merge(i,x(s,"script"))),e.call(this[l],s,l);if(r)for(a=i[i.length-1].ownerDocument,it.map(i,_),l=0;r>l;l++)s=i[l],Ft.test(s.type||"")&&!Et.access(s,"globalEval")&&it.contains(a,s)&&(s.src?it._evalUrl&&it._evalUrl(s.src):it.globalEval(s.textContent.replace(Ut,"")))}return this}}),it.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){it.fn[t]=function(t){for(var o,n=[],i=it(t),r=i.length-1,s=0;r>=s;s++)o=s===r?this:this.clone(!0),it(i[s])[e](o),$.apply(n,o.get());return this.pushStack(n)}});var Vt,Wt={},zt=/^margin/,qt=new RegExp("^("+wt+")(?!px)[a-z%]+$","i"),Xt=function(t){return t.ownerDocument.defaultView.getComputedStyle(t,null)};!function(){function t(){s.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",s.innerHTML="",n.appendChild(i);var t=r.getComputedStyle(s,null);e="1%"!==t.top,o="4px"===t.width,n.removeChild(i)}var e,o,n=ot.documentElement,i=ot.createElement("div"),s=ot.createElement("div");s.style&&(s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",et.clearCloneStyle="content-box"===s.style.backgroundClip,i.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",i.appendChild(s),r.getComputedStyle&&it.extend(et,{pixelPosition:function(){return t(),e},boxSizingReliable:function(){return null==o&&t(),o},reliableMarginRight:function(){var t,e=s.appendChild(ot.createElement("div"));return e.style.cssText=s.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",s.style.width="1px",n.appendChild(i),t=!parseFloat(r.getComputedStyle(e,null).marginRight),n.removeChild(i),t}}))}(),it.swap=function(t,e,o,n){var i,r,s={};for(r in e)s[r]=t.style[r],t.style[r]=e[r];i=o.apply(t,n||[]);for(r in e)t.style[r]=s[r];return i};var Yt=/^(none|table(?!-c[ea]).+)/,Kt=new RegExp("^("+wt+")(.*)$","i"),$t=new RegExp("^([+-])=("+wt+")","i"),Qt={position:"absolute",visibility:"hidden",display:"block"},Jt={letterSpacing:"0",fontWeight:"400"},Zt=["Webkit","O","Moz","ms"];it.extend({cssHooks:{opacity:{get:function(t,e){if(e){var o=C(t,"opacity");return""===o?"1":o}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,o,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var i,r,s,a=it.camelCase(e),l=t.style;return e=it.cssProps[a]||(it.cssProps[a]=A(l,a)),s=it.cssHooks[e]||it.cssHooks[a],void 0===o?s&&"get"in s&&void 0!==(i=s.get(t,!1,n))?i:l[e]:(r=typeof o,"string"===r&&(i=$t.exec(o))&&(o=(i[1]+1)*i[2]+parseFloat(it.css(t,e)),r="number"),void(null!=o&&o===o&&("number"!==r||it.cssNumber[a]||(o+="px"),et.clearCloneStyle||""!==o||0!==e.indexOf("background")||(l[e]="inherit"),s&&"set"in s&&void 0===(o=s.set(t,o,n))||(l[e]=o))))}},css:function(t,e,o,n){var i,r,s,a=it.camelCase(e);return e=it.cssProps[a]||(it.cssProps[a]=A(t.style,a)),s=it.cssHooks[e]||it.cssHooks[a],s&&"get"in s&&(i=s.get(t,!0,o)),void 0===i&&(i=C(t,e,n)),"normal"===i&&e in Jt&&(i=Jt[e]),""===o||o?(r=parseFloat(i),!0===o||it.isNumeric(r)?r||0:i):i}}),it.each(["height","width"],function(t,e){it.cssHooks[e]={get:function(t,o,n){return o?Yt.test(it.css(t,"display"))&&0===t.offsetWidth?it.swap(t,Qt,function(){return M(t,e,n)}):M(t,e,n):void 0},set:function(t,o,n){var i=n&&Xt(t);return I(t,o,n?B(t,e,n,"border-box"===it.css(t,"boxSizing",!1,i),i):0)}}}),it.cssHooks.marginRight=k(et.reliableMarginRight,function(t,e){return e?it.swap(t,{display:"inline-block"},C,[t,"marginRight"]):void 0}),it.each({margin:"",padding:"",border:"Width"},function(t,e){it.cssHooks[t+e]={expand:function(o){for(var n=0,i={},r="string"==typeof o?o.split(" "):[o];4>n;n++)i[t+Ct[n]+e]=r[n]||r[n-2]||r[0];return i}},zt.test(t)||(it.cssHooks[t+e].set=I)}),it.fn.extend({css:function(t,e){return bt(this,function(t,e,o){var n,i,r={},s=0;if(it.isArray(e)){for(n=Xt(t),i=e.length;i>s;s++)r[e[s]]=it.css(t,e[s],!1,n);return r}return void 0!==o?it.style(t,e,o):it.css(t,e)},t,e,arguments.length>1)},show:function(){return L(this,!0)},hide:function(){return L(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){kt(this)?it(this).show():it(this).hide()})}}),it.Tween=N,N.prototype={constructor:N,init:function(t,e,o,n,i,r){this.elem=t,this.prop=o,this.easing=i||"swing",this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=r||(it.cssNumber[o]?"":"px")},cur:function(){var t=N.propHooks[this.prop];return t&&t.get?t.get(this):N.propHooks._default.get(this)},run:function(t){var e,o=N.propHooks[this.prop];return this.pos=e=this.options.duration?it.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),o&&o.set?o.set(this):N.propHooks._default.set(this),this}},N.prototype.init.prototype=N.prototype,N.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=it.css(t.elem,t.prop,""),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){it.fx.step[t.prop]?it.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[it.cssProps[t.prop]]||it.cssHooks[t.prop])?it.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},N.propHooks.scrollTop=N.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},it.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},it.fx=N.prototype.init,it.fx.step={};var te,ee,oe=/^(?:toggle|show|hide)$/,ne=new RegExp("^(?:([+-])=|)("+wt+")([a-z%]*)$","i"),ie=/queueHooks$/,re=[P],se={"*":[function(t,e){var o=this.createTween(t,e),n=o.cur(),i=ne.exec(e),r=i&&i[3]||(it.cssNumber[t]?"":"px"),s=(it.cssNumber[t]||"px"!==r&&+n)&&ne.exec(it.css(o.elem,t)),a=1,l=20;if(s&&s[3]!==r){r=r||s[3],i=i||[],s=+n||1;do{a=a||".5",s/=a,it.style(o.elem,t,s+r)}while(a!==(a=o.cur()/n)&&1!==a&&--l)}return i&&(s=o.start=+s||+n||0,o.unit=r,o.end=i[1]?s+(i[1]+1)*i[2]:+i[2]),o}]};it.Animation=it.extend(F,{tweener:function(t,e){it.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var o,n=0,i=t.length;i>n;n++)o=t[n],se[o]=se[o]||[],se[o].unshift(e)},prefilter:function(t,e){e?re.unshift(t):re.push(t)}}),it.speed=function(t,e,o){var n=t&&"object"==typeof t?it.extend({},t):{complete:o||!o&&e||it.isFunction(t)&&t,duration:t,easing:o&&e||e&&!it.isFunction(e)&&e};return n.duration=it.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in it.fx.speeds?it.fx.speeds[n.duration]:it.fx.speeds._default,(null==n.queue||!0===n.queue)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){it.isFunction(n.old)&&n.old.call(this),n.queue&&it.dequeue(this,n.queue)},n},it.fn.extend({fadeTo:function(t,e,o,n){return this.filter(kt).css("opacity",0).show().end().animate({opacity:e},t,o,n)},animate:function(t,e,o,n){var i=it.isEmptyObject(t),r=it.speed(e,o,n),s=function(){var e=F(this,it.extend({},t),r);(i||Et.get(this,"finish"))&&e.stop(!0)};return s.finish=s,i||!1===r.queue?this.each(s):this.queue(r.queue,s)},stop:function(t,e,o){var n=function(t){var e=t.stop;delete t.stop,e(o)};return"string"!=typeof t&&(o=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each(function(){var e=!0,i=null!=t&&t+"queueHooks",r=it.timers,s=Et.get(this);if(i)s[i]&&s[i].stop&&n(s[i]);else for(i in s)s[i]&&s[i].stop&&ie.test(i)&&n(s[i]);for(i=r.length;i--;)r[i].elem!==this||null!=t&&r[i].queue!==t||(r[i].anim.stop(o),e=!1,r.splice(i,1));(e||!o)&&it.dequeue(this,t)})},finish:function(t){return!1!==t&&(t=t||"fx"),this.each(function(){var e,o=Et.get(this),n=o[t+"queue"],i=o[t+"queueHooks"],r=it.timers,s=n?n.length:0;for(o.finish=!0,it.queue(this,t,[]),i&&i.stop&&i.stop.call(this,!0),e=r.length;e--;)r[e].elem===this&&r[e].queue===t&&(r[e].anim.stop(!0),r.splice(e,1));for(e=0;s>e;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete o.finish})}}),it.each(["toggle","show","hide"],function(t,e){var o=it.fn[e];it.fn[e]=function(t,n,i){return null==t||"boolean"==typeof t?o.apply(this,arguments):this.animate(D(e,!0),t,n,i)}}),it.each({slideDown:D("show"),slideUp:D("hide"),slideToggle:D("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){it.fn[t]=function(t,o,n){return this.animate(e,t,o,n)}}),it.timers=[],it.fx.tick=function(){var t,e=0,o=it.timers;for(te=it.now();e<o.length;e++)(t=o[e])()||o[e]!==t||o.splice(e--,1);o.length||it.fx.stop(),te=void 0},it.fx.timer=function(t){it.timers.push(t),t()?it.fx.start():it.timers.pop()},it.fx.interval=13,it.fx.start=function(){ee||(ee=setInterval(it.fx.tick,it.fx.interval))},it.fx.stop=function(){clearInterval(ee),ee=null},it.fx.speeds={slow:600,fast:200,_default:400},it.fn.delay=function(t,e){return t=it.fx?it.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,o){var n=setTimeout(e,t);o.stop=function(){clearTimeout(n)}})},function(){var t=ot.createElement("input"),e=ot.createElement("select"),o=e.appendChild(ot.createElement("option"));t.type="checkbox",et.checkOn=""!==t.value,et.optSelected=o.selected,e.disabled=!0,et.optDisabled=!o.disabled,t=ot.createElement("input"),t.value="t",t.type="radio",et.radioValue="t"===t.value}();var ae,le=it.expr.attrHandle;it.fn.extend({attr:function(t,e){return bt(this,it.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){it.removeAttr(this,t)})}}),it.extend({attr:function(t,e,o){var n,i,r=t.nodeType;if(t&&3!==r&&8!==r&&2!==r)return typeof t.getAttribute===It?it.prop(t,e,o):(1===r&&it.isXMLDoc(t)||(e=e.toLowerCase(),n=it.attrHooks[e]||(it.expr.match.bool.test(e)?ae:void 0)),void 0===o?n&&"get"in n&&null!==(i=n.get(t,e))?i:(i=it.find.attr(t,e),null==i?void 0:i):null!==o?n&&"set"in n&&void 0!==(i=n.set(t,o,e))?i:(t.setAttribute(e,o+""),o):void it.removeAttr(t,e))},removeAttr:function(t,e){var o,n,i=0,r=e&&e.match(yt);if(r&&1===t.nodeType)for(;o=r[i++];)n=it.propFix[o]||o,it.expr.match.bool.test(o)&&(t[n]=!1),t.removeAttribute(o)},attrHooks:{type:{set:function(t,e){if(!et.radioValue&&"radio"===e&&it.nodeName(t,"input")){var o=t.value;return t.setAttribute("type",e),o&&(t.value=o),e}}}}}),ae={set:function(t,e,o){return!1===e?it.removeAttr(t,o):t.setAttribute(o,o),o}},it.each(it.expr.match.bool.source.match(/\w+/g),function(t,e){var o=le[e]||it.find.attr;le[e]=function(t,e,n){var i,r;return n||(r=le[e],le[e]=i,i=null!=o(t,e,n)?e.toLowerCase():null,le[e]=r),i}});var ce=/^(?:input|select|textarea|button)$/i;it.fn.extend({prop:function(t,e){return bt(this,it.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[it.propFix[t]||t]})}}),it.extend({propFix:{for:"htmlFor",class:"className"},prop:function(t,e,o){var n,i,r,s=t.nodeType;if(t&&3!==s&&8!==s&&2!==s)return r=1!==s||!it.isXMLDoc(t),r&&(e=it.propFix[e]||e,i=it.propHooks[e]),void 0!==o?i&&"set"in i&&void 0!==(n=i.set(t,o,e))?n:t[e]=o:i&&"get"in i&&null!==(n=i.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){return t.hasAttribute("tabindex")||ce.test(t.nodeName)||t.href?t.tabIndex:-1}}}}),et.optSelected||(it.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null}}),it.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){it.propFix[this.toLowerCase()]=this});var ue=/[\t\r\n\f]/g;it.fn.extend({addClass:function(t){var e,o,n,i,r,s,a="string"==typeof t&&t,l=0,c=this.length;if(it.isFunction(t))return this.each(function(e){it(this).addClass(t.call(this,e,this.className))});if(a)for(e=(t||"").match(yt)||[];c>l;l++)if(o=this[l],n=1===o.nodeType&&(o.className?(" "+o.className+" ").replace(ue," "):" ")){for(r=0;i=e[r++];)n.indexOf(" "+i+" ")<0&&(n+=i+" ");s=it.trim(n),o.className!==s&&(o.className=s)}return this},removeClass:function(t){var e,o,n,i,r,s,a=0===arguments.length||"string"==typeof t&&t,l=0,c=this.length;if(it.isFunction(t))return this.each(function(e){it(this).removeClass(t.call(this,e,this.className))});if(a)for(e=(t||"").match(yt)||[];c>l;l++)if(o=this[l],n=1===o.nodeType&&(o.className?(" "+o.className+" ").replace(ue," "):"")){for(r=0;i=e[r++];)for(;n.indexOf(" "+i+" ")>=0;)n=n.replace(" "+i+" "," ");s=t?it.trim(n):"",o.className!==s&&(o.className=s)}return this},toggleClass:function(t,e){var o=typeof t;return"boolean"==typeof e&&"string"===o?e?this.addClass(t):this.removeClass(t):this.each(it.isFunction(t)?function(o){it(this).toggleClass(t.call(this,o,this.className,e),e)}:function(){if("string"===o)for(var e,n=0,i=it(this),r=t.match(yt)||[];e=r[n++];)i.hasClass(e)?i.removeClass(e):i.addClass(e);else(o===It||"boolean"===o)&&(this.className&&Et.set(this,"__className__",this.className),this.className=this.className||!1===t?"":Et.get(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",o=0,n=this.length;n>o;o++)if(1===this[o].nodeType&&(" "+this[o].className+" ").replace(ue," ").indexOf(e)>=0)return!0;return!1}});var he=/\r/g;it.fn.extend({val:function(t){var e,o,n,i=this[0];return arguments.length?(n=it.isFunction(t),this.each(function(o){var i;1===this.nodeType&&(i=n?t.call(this,o,it(this).val()):t,null==i?i="":"number"==typeof i?i+="":it.isArray(i)&&(i=it.map(i,function(t){return null==t?"":t+""})),(e=it.valHooks[this.type]||it.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,i,"value")||(this.value=i))})):i?(e=it.valHooks[i.type]||it.valHooks[i.nodeName.toLowerCase()],e&&"get"in e&&void 0!==(o=e.get(i,"value"))?o:(o=i.value,"string"==typeof o?o.replace(he,""):null==o?"":o)):void 0}}),it.extend({valHooks:{option:{get:function(t){var e=it.find.attr(t,"value");return null!=e?e:it.trim(it.text(t))}},select:{get:function(t){for(var e,o,n=t.options,i=t.selectedIndex,r="select-one"===t.type||0>i,s=r?null:[],a=r?i+1:n.length,l=0>i?a:r?i:0;a>l;l++)if(o=n[l],!(!o.selected&&l!==i||(et.optDisabled?o.disabled:null!==o.getAttribute("disabled"))||o.parentNode.disabled&&it.nodeName(o.parentNode,"optgroup"))){if(e=it(o).val(),r)return e;s.push(e)}return s},set:function(t,e){for(var o,n,i=t.options,r=it.makeArray(e),s=i.length;s--;)n=i[s],(n.selected=it.inArray(n.value,r)>=0)&&(o=!0);return o||(t.selectedIndex=-1),r}}}}),it.each(["radio","checkbox"],function(){it.valHooks[this]={set:function(t,e){return it.isArray(e)?t.checked=it.inArray(it(t).val(),e)>=0:void 0}},et.checkOn||(it.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),it.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){it.fn[e]=function(t,o){return arguments.length>0?this.on(e,null,t,o):this.trigger(e)}}),it.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,o){return this.on(t,null,e,o)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,o,n){return this.on(e,t,o,n)},undelegate:function(t,e,o){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",o)}});var ge=it.now(),pe=/\?/;it.parseJSON=function(t){return JSON.parse(t+"")},it.parseXML=function(t){var e,o;if(!t||"string"!=typeof t)return null;try{o=new DOMParser,e=o.parseFromString(t,"text/xml")}catch(t){e=void 0}return(!e||e.getElementsByTagName("parsererror").length)&&it.error("Invalid XML: "+t),e};var de,fe,me=/#.*$/,ye=/([?&])_=[^&]*/,ve=/^(.*?):[ \t]*([^\r\n]*)$/gm,_e=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,be=/^(?:GET|HEAD)$/,Ee=/^\/\//,xe=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Se={},Te={},we="*/".concat("*");try{fe=location.href}catch(t){fe=ot.createElement("a"),fe.href="",fe=fe.href}de=xe.exec(fe.toLowerCase())||[],it.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:fe,type:"GET",isLocal:_e.test(de[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":we,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":it.parseJSON,"text xml":it.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?G(G(t,it.ajaxSettings),e):G(it.ajaxSettings,t)},ajaxPrefilter:H(Se),ajaxTransport:H(Te),ajax:function(t,e){function o(t,e,o,s){var l,u,y,v,b,x=e;2!==_&&(_=2,a&&clearTimeout(a),n=void 0,r=s||"",E.readyState=t>0?4:0,l=t>=200&&300>t||304===t,o&&(v=V(h,E,o)),v=W(h,v,E,l),l?(h.ifModified&&(b=E.getResponseHeader("Last-Modified"),b&&(it.lastModified[i]=b),(b=E.getResponseHeader("etag"))&&(it.etag[i]=b)),204===t||"HEAD"===h.type?x="nocontent":304===t?x="notmodified":(x=v.state,u=v.data,y=v.error,l=!y)):(y=x,(t||!x)&&(x="error",0>t&&(t=0))),E.status=t,E.statusText=(e||x)+"",l?d.resolveWith(g,[u,x,E]):d.rejectWith(g,[E,x,y]),E.statusCode(m),m=void 0,c&&p.trigger(l?"ajaxSuccess":"ajaxError",[E,h,l?u:y]),f.fireWith(g,[E,x]),c&&(p.trigger("ajaxComplete",[E,h]),--it.active||it.event.trigger("ajaxStop")))}"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,i,r,s,a,l,c,u,h=it.ajaxSetup({},e),g=h.context||h,p=h.context&&(g.nodeType||g.jquery)?it(g):it.event,d=it.Deferred(),f=it.Callbacks("once memory"),m=h.statusCode||{},y={},v={},_=0,b="canceled",E={readyState:0,getResponseHeader:function(t){var e;if(2===_){if(!s)for(s={};e=ve.exec(r);)s[e[1].toLowerCase()]=e[2];e=s[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===_?r:null},setRequestHeader:function(t,e){var o=t.toLowerCase();return _||(t=v[o]=v[o]||t,y[t]=e),this},overrideMimeType:function(t){return _||(h.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>_)for(e in t)m[e]=[m[e],t[e]];else E.always(t[E.status]);return this},abort:function(t){var e=t||b;return n&&n.abort(e),o(0,e),this}};if(d.promise(E).complete=f.add,E.success=E.done,E.error=E.fail,h.url=((t||h.url||fe)+"").replace(me,"").replace(Ee,de[1]+"//"),h.type=e.method||e.type||h.method||h.type,h.dataTypes=it.trim(h.dataType||"*").toLowerCase().match(yt)||[""],null==h.crossDomain&&(l=xe.exec(h.url.toLowerCase()),h.crossDomain=!(!l||l[1]===de[1]&&l[2]===de[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(de[3]||("http:"===de[1]?"80":"443")))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=it.param(h.data,h.traditional)),U(Se,h,e,E),2===_)return E;c=h.global,c&&0==it.active++&&it.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!be.test(h.type),i=h.url,h.hasContent||(h.data&&(i=h.url+=(pe.test(i)?"&":"?")+h.data,delete h.data),!1===h.cache&&(h.url=ye.test(i)?i.replace(ye,"$1_="+ge++):i+(pe.test(i)?"&":"?")+"_="+ge++)),h.ifModified&&(it.lastModified[i]&&E.setRequestHeader("If-Modified-Since",it.lastModified[i]),it.etag[i]&&E.setRequestHeader("If-None-Match",it.etag[i])),(h.data&&h.hasContent&&!1!==h.contentType||e.contentType)&&E.setRequestHeader("Content-Type",h.contentType),E.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+we+"; q=0.01":""):h.accepts["*"]);for(u in h.headers)E.setRequestHeader(u,h.headers[u]);if(h.beforeSend&&(!1===h.beforeSend.call(g,E,h)||2===_))return E.abort();b="abort";for(u in{success:1,error:1,complete:1})E[u](h[u]);if(n=U(Te,h,e,E)){E.readyState=1,c&&p.trigger("ajaxSend",[E,h]),h.async&&h.timeout>0&&(a=setTimeout(function(){E.abort("timeout")},h.timeout));try{_=1,n.send(y,o)}catch(t){if(!(2>_))throw t;o(-1,t)}}else o(-1,"No Transport");return E},getJSON:function(t,e,o){return it.get(t,e,o,"json")},getScript:function(t,e){return it.get(t,void 0,e,"script")}}),it.each(["get","post"],function(t,e){it[e]=function(t,o,n,i){return it.isFunction(o)&&(i=i||n,n=o,o=void 0),it.ajax({url:t,type:e,dataType:i,data:o,success:n})}}),it.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){it.fn[e]=function(t){return this.on(e,t)}}),it._evalUrl=function(t){return it.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},it.fn.extend({wrapAll:function(t){var e;return it.isFunction(t)?this.each(function(e){it(this).wrapAll(t.call(this,e))}):(this[0]&&(e=it(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this)},wrapInner:function(t){return this.each(it.isFunction(t)?function(e){it(this).wrapInner(t.call(this,e))}:function(){var e=it(this),o=e.contents();o.length?o.wrapAll(t):e.append(t)})},wrap:function(t){var e=it.isFunction(t);return this.each(function(o){it(this).wrapAll(e?t.call(this,o):t)})},unwrap:function(){return this.parent().each(function(){it.nodeName(this,"body")||it(this).replaceWith(this.childNodes)}).end()}}),it.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0},it.expr.filters.visible=function(t){return!it.expr.filters.hidden(t)};var Ce=/%20/g,ke=/\[\]$/,Ae=/\r?\n/g,Ie=/^(?:submit|button|image|reset|file)$/i,Be=/^(?:input|select|textarea|keygen)/i;it.param=function(t,e){var o,n=[],i=function(t,e){e=it.isFunction(e)?e():null==e?"":e,n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=it.ajaxSettings&&it.ajaxSettings.traditional),it.isArray(t)||t.jquery&&!it.isPlainObject(t))it.each(t,function(){i(this.name,this.value)});else for(o in t)z(o,t[o],e,i);return n.join("&").replace(Ce,"+")},it.fn.extend({serialize:function(){return it.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=it.prop(this,"elements");return t?it.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!it(this).is(":disabled")&&Be.test(this.nodeName)&&!Ie.test(t)&&(this.checked||!At.test(t))}).map(function(t,e){var o=it(this).val();return null==o?null:it.isArray(o)?it.map(o,function(t){return{name:e.name,value:t.replace(Ae,"\r\n")}}):{name:e.name,value:o.replace(Ae,"\r\n")}}).get()}}),it.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(t){}};var Me=0,Le={},Ne={0:200,1223:204},Re=it.ajaxSettings.xhr();r.ActiveXObject&&it(r).on("unload",function(){for(var t in Le)Le[t]()}),et.cors=!!Re&&"withCredentials"in Re,et.ajax=Re=!!Re,it.ajaxTransport(function(t){var e;return et.cors||Re&&!t.crossDomain?{send:function(o,n){var i,r=t.xhr(),s=++Me;if(r.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(i in t.xhrFields)r[i]=t.xhrFields[i];t.mimeType&&r.overrideMimeType&&r.overrideMimeType(t.mimeType),t.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest");for(i in o)r.setRequestHeader(i,o[i]);e=function(t){return function(){e&&(delete Le[s],e=r.onload=r.onerror=null,"abort"===t?r.abort():"error"===t?n(r.status,r.statusText):n(Ne[r.status]||r.status,r.statusText,"string"==typeof r.responseText?{text:r.responseText}:void 0,r.getAllResponseHeaders()))}},r.onload=e(),r.onerror=e("error"),e=Le[s]=e("abort");try{r.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}:void 0}),it.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return it.globalEval(t),t}}}),it.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),it.ajaxTransport("script",function(t){if(t.crossDomain){var e,o;return{send:function(n,i){e=it("<script>").prop({async:!0,charset:t.scriptCharset,src:t.url}).on("load error",o=function(t){e.remove(),o=null,t&&i("error"===t.type?404:200,t.type)}),ot.head.appendChild(e[0])},abort:function(){o&&o()}}}});var De=[],Oe=/(=)\?(?=&|$)|\?\?/;it.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=De.pop()||it.expando+"_"+ge++;return this[t]=!0,t}}),it.ajaxPrefilter("json jsonp",function(t,e,o){var n,i,s,a=!1!==t.jsonp&&(Oe.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Oe.test(t.data)&&"data");return a||"jsonp"===t.dataTypes[0]?(n=t.jsonpCallback=it.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Oe,"$1"+n):!1!==t.jsonp&&(t.url+=(pe.test(t.url)?"&":"?")+t.jsonp+"="+n),t.converters["script json"]=function(){return s||it.error(n+" was not called"),s[0]},t.dataTypes[0]="json",i=r[n],r[n]=function(){s=arguments},o.always(function(){r[n]=i,t[n]&&(t.jsonpCallback=e.jsonpCallback,De.push(n)),s&&it.isFunction(i)&&i(s[0]),s=i=void 0}),"script"):void 0}),it.parseHTML=function(t,e,o){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(o=e,e=!1),e=e||ot;var n=ht.exec(t),i=!o&&[];return n?[e.createElement(n[1])]:(n=it.buildFragment([t],e,i),i&&i.length&&it(i).remove(),it.merge([],n.childNodes))};var Pe=it.fn.load;it.fn.load=function(t,e,o){if("string"!=typeof t&&Pe)return Pe.apply(this,arguments);var n,i,r,s=this,a=t.indexOf(" ");return a>=0&&(n=it.trim(t.slice(a)),t=t.slice(0,a)),it.isFunction(e)?(o=e,e=void 0):e&&"object"==typeof e&&(i="POST"),s.length>0&&it.ajax({url:t,type:i,dataType:"html",data:e}).done(function(t){r=arguments,s.html(n?it("<div>").append(it.parseHTML(t)).find(n):t)}).complete(o&&function(t,e){s.each(o,r||[t.responseText,e,t])}),this},it.expr.filters.animated=function(t){return it.grep(it.timers,function(e){return t===e.elem}).length};var je=r.document.documentElement;it.offset={setOffset:function(t,e,o){var n,i,r,s,a,l,c,u=it.css(t,"position"),h=it(t),g={};"static"===u&&(t.style.position="relative"),a=h.offset(),r=it.css(t,"top"),l=it.css(t,"left"),c=("absolute"===u||"fixed"===u)&&(r+l).indexOf("auto")>-1,c?(n=h.position(),s=n.top,i=n.left):(s=parseFloat(r)||0,i=parseFloat(l)||0),it.isFunction(e)&&(e=e.call(t,o,a)),null!=e.top&&(g.top=e.top-a.top+s),null!=e.left&&(g.left=e.left-a.left+i),"using"in e?e.using.call(t,g):h.css(g)}},it.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){it.offset.setOffset(this,t,e)});var e,o,n=this[0],i={top:0,left:0},r=n&&n.ownerDocument;return r?(e=r.documentElement,it.contains(e,n)?(typeof n.getBoundingClientRect!==It&&(i=n.getBoundingClientRect()),o=q(r),{top:i.top+o.pageYOffset-e.clientTop,left:i.left+o.pageXOffset-e.clientLeft}):i):void 0},position:function(){if(this[0]){var t,e,o=this[0],n={top:0,left:0};return"fixed"===it.css(o,"position")?e=o.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),it.nodeName(t[0],"html")||(n=t.offset()),n.top+=it.css(t[0],"borderTopWidth",!0),n.left+=it.css(t[0],"borderLeftWidth",!0)),{top:e.top-n.top-it.css(o,"marginTop",!0),left:e.left-n.left-it.css(o,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||je;t&&!it.nodeName(t,"html")&&"static"===it.css(t,"position");)t=t.offsetParent;return t||je})}}),it.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var o="pageYOffset"===e;it.fn[t]=function(n){return bt(this,function(t,n,i){var s=q(t);return void 0===i?s?s[e]:t[n]:void(s?s.scrollTo(o?r.pageXOffset:i,o?i:r.pageYOffset):t[n]=i)},t,n,arguments.length,null)}}),it.each(["top","left"],function(t,e){it.cssHooks[e]=k(et.pixelPosition,function(t,o){return o?(o=C(t,e),qt.test(o)?it(t).position()[e]+"px":o):void 0})}),it.each({Height:"height",Width:"width"},function(t,e){it.each({padding:"inner"+t,content:e,"":"outer"+t},function(o,n){it.fn[n]=function(n,i){var r=arguments.length&&(o||"boolean"!=typeof n),s=o||(!0===n||!0===i?"margin":"border");return bt(this,function(e,o,n){var i;return it.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(i=e.documentElement,Math.max(e.body["scroll"+t],i["scroll"+t],e.body["offset"+t],i["offset"+t],i["client"+t])):void 0===n?it.css(e,o,s):it.style(e,o,n,s)},e,r?n:void 0,r,null)}})}),it.fn.size=function(){return this.length},it.fn.andSelf=it.fn.addBack,o(1)&&(n=[],void 0!==(i=function(){return it}.apply(e,n))&&(t.exports=i));var Fe=r.jQuery,He=r.$;return it.noConflict=function(t){return r.$===it&&(r.$=He),t&&r.jQuery===it&&(r.jQuery=Fe),it},typeof s===It&&(r.jQuery=r.$=it),it})},function(t,e){(function(e){t.exports=e}).call(e,{})},function(t,e){var o;o=function(){return this}();try{o=o||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(o=window)}t.exports=o},function(t,e){function o(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function i(t){if(u===setTimeout)return setTimeout(t,0);if((u===o||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}function r(t){if(h===clearTimeout)return clearTimeout(t);if((h===n||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}function s(){f&&p&&(f=!1,p.length?d=p.concat(d):m=-1,d.length&&a())}function a(){if(!f){var t=i(s);f=!0;for(var e=d.length;e;){for(p=d,d=[];++m<e;)p&&p[m].run();m=-1,e=d.length}p=null,f=!1,r(t)}}function l(t,e){this.fun=t,this.array=e}function c(){}var u,h,g=t.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:o}catch(t){u=o}try{h="function"==typeof clearTimeout?clearTimeout:n}catch(t){h=n}}();var p,d=[],f=!1,m=-1;g.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)e[o-1]=arguments[o];d.push(new l(t,e)),1!==d.length||f||i(a)},l.prototype.run=function(){this.fun.apply(null,this.array)},g.title="browser",g.browser=!0,g.env={},g.argv=[],g.version="",g.versions={},g.on=c,g.addListener=c,g.once=c,g.off=c,g.removeListener=c,g.removeAllListeners=c,g.emit=c,g.prependListener=c,g.prependOnceListener=c,g.listeners=function(t){return[]},g.binding=function(t){throw new Error("process.binding is not supported")},g.cwd=function(){return"/"},g.chdir=function(t){throw new Error("process.chdir is not supported")},g.umask=function(){return 0}},function(t,e,o){(function(e){!function(e){t.exports=e()}(function(){"use strict";function t(o,n){if(!(this instanceof t))return new t(o,n);this.options=n=n?mi(n):{},mi(Nr,n,!1),d(n);var i=n.value;"string"==typeof i&&(i=new ns(i,n.mode)),this.doc=i;var r=this.display=new e(o,i);r.wrapper.CodeMirror=this,u(this),l(this),n.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),n.autofocus&&!ur&&we(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,draggingText:!1,highlight:new ci},Zi&&11>tr&&setTimeout(yi(Te,this,!0),20),Ae(this),Mi(),Zt(this),this.curOp.forceUpdate=!0,Bn(this,i),n.autofocus&&!ur||wi()==r.input?setTimeout(yi(Qe,this),20):Je(this);for(var s in Rr)Rr.hasOwnProperty(s)&&Rr[s](this,n[s],Dr);b(this);for(var a=0;a<Fr.length;++a)Fr[a](this);ee(this)}function e(t,e){var o=this,n=o.input=Ei("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none");er?n.style.width="1000px":n.setAttribute("wrap","off"),cr&&(n.style.border="1px solid black"),n.setAttribute("autocorrect","off"),n.setAttribute("autocapitalize","off"),n.setAttribute("spellcheck","false"),o.inputDiv=Ei("div",[n],null,"overflow: hidden; position: relative; width: 3px; height: 0px;"),o.scrollbarH=Ei("div",[Ei("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar"),o.scrollbarV=Ei("div",[Ei("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),o.scrollbarFiller=Ei("div",null,"CodeMirror-scrollbar-filler"),o.gutterFiller=Ei("div",null,"CodeMirror-gutter-filler"),o.lineDiv=Ei("div",null,"CodeMirror-code"),o.selectionDiv=Ei("div",null,null,"position: relative; z-index: 1"),o.cursorDiv=Ei("div",null,"CodeMirror-cursors"),o.measure=Ei("div",null,"CodeMirror-measure"),o.lineMeasure=Ei("div",null,"CodeMirror-measure"),o.lineSpace=Ei("div",[o.measure,o.lineMeasure,o.selectionDiv,o.cursorDiv,o.lineDiv],null,"position: relative; outline: none"),o.mover=Ei("div",[Ei("div",[o.lineSpace],"CodeMirror-lines")],null,"position: relative"),o.sizer=Ei("div",[o.mover],"CodeMirror-sizer"),o.heightForcer=Ei("div",null,null,"position: absolute; height: "+ps+"px; width: 1px;"),o.gutters=Ei("div",null,"CodeMirror-gutters"),o.lineGutter=null,o.scroller=Ei("div",[o.sizer,o.heightForcer,o.gutters],"CodeMirror-scroll"),o.scroller.setAttribute("tabIndex","-1"),o.wrapper=Ei("div",[o.inputDiv,o.scrollbarH,o.scrollbarV,o.scrollbarFiller,o.gutterFiller,o.scroller],"CodeMirror"),Zi&&8>tr&&(o.gutters.style.zIndex=-1,o.scroller.style.paddingRight=0),cr&&(n.style.width="0px"),er||(o.scroller.draggable=!0),sr&&(o.inputDiv.style.height="1px",o.inputDiv.style.position="absolute"),Zi&&8>tr&&(o.scrollbarH.style.minHeight=o.scrollbarV.style.minWidth="18px"),t.appendChild?t.appendChild(o.wrapper):t(o.wrapper),o.viewFrom=o.viewTo=e.first,o.view=[],o.externalMeasured=null,o.viewOffset=0,o.lastSizeC=0,o.updateLineNumbers=null,o.lineNumWidth=o.lineNumInnerWidth=o.lineNumChars=null,o.prevInput="",o.alignWidgets=!1,o.pollingFast=!1,o.poll=new ci,o.cachedCharWidth=o.cachedTextHeight=o.cachedPaddingH=null,o.inaccurateSelection=!1,o.maxLine=null,o.maxLineLength=0,o.maxLineChanged=!1,o.wheelDX=o.wheelDY=o.wheelStartX=o.wheelStartY=null,o.shift=!1,o.selForContextMenu=null}function o(e){e.doc.mode=t.getMode(e.options,e.doc.modeOption),n(e)}function n(t){t.doc.iter(function(t){t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null)}),t.doc.frontier=t.doc.first,xt(t,100),t.state.modeGen++,t.curOp&&de(t)}function i(t){t.options.lineWrapping?(Ai(t.display.wrapper,"CodeMirror-wrap"),t.display.sizer.style.minWidth=""):(ki(t.display.wrapper,"CodeMirror-wrap"),p(t)),s(t),de(t),Ht(t),setTimeout(function(){y(t)},100)}function r(t){var e=Qt(t.display),o=t.options.lineWrapping,n=o&&Math.max(5,t.display.scroller.clientWidth/Jt(t.display)-3);return function(i){if(on(t.doc,i))return 0;var r=0;if(i.widgets)for(var s=0;s<i.widgets.length;s++)i.widgets[s].height&&(r+=i.widgets[s].height);return o?r+(Math.ceil(i.text.length/n)||1)*e:r+e}}function s(t){var e=t.doc,o=r(t);e.iter(function(t){var e=o(t);e!=t.height&&Rn(t,e)})}function a(t){var e=Wr[t.options.keyMap],o=e.style;t.display.wrapper.className=t.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(o?" cm-keymap-"+o:"")}function l(t){t.display.wrapper.className=t.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+t.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Ht(t)}function c(t){u(t),de(t),setTimeout(function(){_(t)},20)}function u(t){var e=t.display.gutters,o=t.options.gutters;xi(e);for(var n=0;n<o.length;++n){var i=o[n],r=e.appendChild(Ei("div",null,"CodeMirror-gutter "+i));"CodeMirror-linenumbers"==i&&(t.display.lineGutter=r,r.style.width=(t.display.lineNumWidth||1)+"px")}e.style.display=n?"":"none",h(t)}function h(t){var e=t.display.gutters.offsetWidth;t.display.sizer.style.marginLeft=e+"px",t.display.scrollbarH.style.left=t.options.fixedGutter?e+"px":0}function g(t){if(0==t.height)return 0;for(var e,o=t.text.length,n=t;e=Ko(n);){var i=e.find(0,!0);n=i.from.line,o+=i.from.ch-i.to.ch}for(n=t;e=$o(n);){var i=e.find(0,!0);o-=n.text.length-i.from.ch,n=i.to.line,o+=n.text.length-i.to.ch}return o}function p(t){var e=t.display,o=t.doc;e.maxLine=Mn(o,o.first),e.maxLineLength=g(e.maxLine),e.maxLineChanged=!0,o.iter(function(t){var o=g(t);o>e.maxLineLength&&(e.maxLineLength=o,e.maxLine=t)})}function d(t){var e=pi(t.gutters,"CodeMirror-linenumbers");-1==e&&t.lineNumbers?t.gutters=t.gutters.concat(["CodeMirror-linenumbers"]):e>-1&&!t.lineNumbers&&(t.gutters=t.gutters.slice(0),t.gutters.splice(e,1))}function f(t){return t.display.scroller.clientHeight-t.display.wrapper.clientHeight<ps-3}function m(t){var e=t.display.scroller;return{clientHeight:e.clientHeight,barHeight:t.display.scrollbarV.clientHeight,scrollWidth:e.scrollWidth,clientWidth:e.clientWidth,hScrollbarTakesSpace:f(t),barWidth:t.display.scrollbarH.clientWidth,docHeight:Math.round(t.doc.height+kt(t.display))}}function y(t,e){e||(e=m(t));var o=t.display,n=Ni(o.measure),i=e.docHeight+ps,r=e.scrollWidth>e.clientWidth;r&&e.scrollWidth<=e.clientWidth+1&&n>0&&!e.hScrollbarTakesSpace&&(r=!1);var s=i>e.clientHeight;if(s?(o.scrollbarV.style.display="block",o.scrollbarV.style.bottom=r?n+"px":"0",o.scrollbarV.firstChild.style.height=Math.max(0,i-e.clientHeight+(e.barHeight||o.scrollbarV.clientHeight))+"px"):(o.scrollbarV.style.display="",o.scrollbarV.firstChild.style.height="0"),r?(o.scrollbarH.style.display="block",o.scrollbarH.style.right=s?n+"px":"0",o.scrollbarH.firstChild.style.width=e.scrollWidth-e.clientWidth+(e.barWidth||o.scrollbarH.clientWidth)+"px"):(o.scrollbarH.style.display="",o.scrollbarH.firstChild.style.width="0"),r&&s?(o.scrollbarFiller.style.display="block",o.scrollbarFiller.style.height=o.scrollbarFiller.style.width=n+"px"):o.scrollbarFiller.style.display="",r&&t.options.coverGutterNextToScrollbar&&t.options.fixedGutter?(o.gutterFiller.style.display="block",o.gutterFiller.style.height=n+"px",o.gutterFiller.style.width=o.gutters.offsetWidth+"px"):o.gutterFiller.style.display="",!t.state.checkedOverlayScrollbar&&e.clientHeight>0){if(0===n){var a=hr&&!ar?"12px":"18px";o.scrollbarV.style.minWidth=o.scrollbarH.style.minHeight=a;var l=function(e){ei(e)!=o.scrollbarV&&ei(e)!=o.scrollbarH&&ce(t,Le)(e)};cs(o.scrollbarV,"mousedown",l),cs(o.scrollbarH,"mousedown",l)}t.state.checkedOverlayScrollbar=!0}}function v(t,e,o){var n=o&&null!=o.top?Math.max(0,o.top):t.scroller.scrollTop;n=Math.floor(n-Ct(t));var i=o&&null!=o.bottom?o.bottom:n+t.wrapper.clientHeight,r=On(e,n),s=On(e,i);if(o&&o.ensure){var a=o.ensure.from.line,l=o.ensure.to.line;if(r>a)return{from:a,to:On(e,Pn(Mn(e,a))+t.wrapper.clientHeight)};if(Math.min(l,e.lastLine())>=s)return{from:On(e,Pn(Mn(e,l))-t.wrapper.clientHeight),to:l}}return{from:r,to:Math.max(s,r+1)}}function _(t){var e=t.display,o=e.view;if(e.alignWidgets||e.gutters.firstChild&&t.options.fixedGutter){for(var n=x(e)-e.scroller.scrollLeft+t.doc.scrollLeft,i=e.gutters.offsetWidth,r=n+"px",s=0;s<o.length;s++)if(!o[s].hidden){t.options.fixedGutter&&o[s].gutter&&(o[s].gutter.style.left=r);var a=o[s].alignable;if(a)for(var l=0;l<a.length;l++)a[l].style.left=r}t.options.fixedGutter&&(e.gutters.style.left=n+i+"px")}}function b(t){if(!t.options.lineNumbers)return!1;var e=t.doc,o=E(t.options,e.first+e.size-1),n=t.display;if(o.length!=n.lineNumChars){var i=n.measure.appendChild(Ei("div",[Ei("div",o)],"CodeMirror-linenumber CodeMirror-gutter-elt")),r=i.firstChild.offsetWidth,s=i.offsetWidth-r;return n.lineGutter.style.width="",n.lineNumInnerWidth=Math.max(r,n.lineGutter.offsetWidth-s),n.lineNumWidth=n.lineNumInnerWidth+s,n.lineNumChars=n.lineNumInnerWidth?o.length:-1,n.lineGutter.style.width=n.lineNumWidth+"px",h(t),!0}return!1}function E(t,e){return String(t.lineNumberFormatter(e+t.firstLineNumber))}function x(t){return t.scroller.getBoundingClientRect().left-t.sizer.getBoundingClientRect().left}function S(t,e,o){var n=t.display;this.viewport=e,this.visible=v(n,t.doc,e),this.editorIsHidden=!n.wrapper.offsetWidth,this.wrapperHeight=n.wrapper.clientHeight,this.oldViewFrom=n.viewFrom,this.oldViewTo=n.viewTo,this.oldScrollerWidth=n.scroller.clientWidth,this.force=o,this.dims=M(t)}function T(t,e){var o=t.display,n=t.doc;if(e.editorIsHidden)return me(t),!1;if(!e.force&&e.visible.from>=o.viewFrom&&e.visible.to<=o.viewTo&&(null==o.updateLineNumbers||o.updateLineNumbers>=o.viewTo)&&0==be(t))return!1;b(t)&&(me(t),e.dims=M(t));var i=n.first+n.size,r=Math.max(e.visible.from-t.options.viewportMargin,n.first),s=Math.min(i,e.visible.to+t.options.viewportMargin);o.viewFrom<r&&r-o.viewFrom<20&&(r=Math.max(n.first,o.viewFrom)),o.viewTo>s&&o.viewTo-s<20&&(s=Math.min(i,o.viewTo)),yr&&(r=tn(t.doc,r),s=en(t.doc,s));var a=r!=o.viewFrom||s!=o.viewTo||o.lastSizeC!=e.wrapperHeight;_e(t,r,s),o.viewOffset=Pn(Mn(t.doc,o.viewFrom)),t.display.mover.style.top=o.viewOffset+"px";var l=be(t);if(!a&&0==l&&!e.force&&(null==o.updateLineNumbers||o.updateLineNumbers>=o.viewTo))return!1;var c=wi();return l>4&&(o.lineDiv.style.display="none"),L(t,o.updateLineNumbers,e.dims),l>4&&(o.lineDiv.style.display=""),c&&wi()!=c&&c.offsetHeight&&c.focus(),xi(o.cursorDiv),xi(o.selectionDiv),a&&(o.lastSizeC=e.wrapperHeight,xt(t,400)),o.updateLineNumbers=null,!0}function w(t,e){for(var o=(e.force,e.viewport),n=!0;;n=!1){if(n&&t.options.lineWrapping&&e.oldScrollerWidth!=t.display.scroller.clientWidth)!0;else if(!1,o&&null!=o.top&&(o={top:Math.min(t.doc.height+kt(t.display)-ps-t.display.scroller.clientHeight,o.top)}),e.visible=v(t.display,t.doc,o),e.visible.from>=t.display.viewFrom&&e.visible.to<=t.display.viewTo)break;if(!T(t,e))break;I(t);var i=m(t);vt(t),k(t,i),y(t,i)}ni(t,"update",t),(t.display.viewFrom!=e.oldViewFrom||t.display.viewTo!=e.oldViewTo)&&ni(t,"viewportChange",t,t.display.viewFrom,t.display.viewTo)}function C(t,e){var o=new S(t,e);if(T(t,o)){I(t),w(t,o);var n=m(t);vt(t),k(t,n),y(t,n)}}function k(t,e){t.display.sizer.style.minHeight=t.display.heightForcer.style.top=e.docHeight+"px",t.display.gutters.style.height=Math.max(e.docHeight,e.clientHeight-ps)+"px"}function A(t,e){t.display.sizer.offsetWidth+t.display.gutters.offsetWidth<t.display.scroller.clientWidth-1&&(t.display.sizer.style.minHeight=t.display.heightForcer.style.top="0px",t.display.gutters.style.height=e.docHeight+"px")}function I(t){for(var e=t.display,o=e.lineDiv.offsetTop,n=0;n<e.view.length;n++){var i,r=e.view[n];if(!r.hidden){if(Zi&&8>tr){var s=r.node.offsetTop+r.node.offsetHeight;i=s-o,o=s}else{var a=r.node.getBoundingClientRect();i=a.bottom-a.top}var l=r.line.height-i;if(2>i&&(i=Qt(e)),(l>.001||-.001>l)&&(Rn(r.line,i),B(r.line),r.rest))for(var c=0;c<r.rest.length;c++)B(r.rest[c])}}}function B(t){if(t.widgets)for(var e=0;e<t.widgets.length;++e)t.widgets[e].height=t.widgets[e].node.offsetHeight}function M(t){for(var e=t.display,o={},n={},i=e.gutters.clientLeft,r=e.gutters.firstChild,s=0;r;r=r.nextSibling,++s)o[t.options.gutters[s]]=r.offsetLeft+r.clientLeft+i,n[t.options.gutters[s]]=r.clientWidth;return{fixedPos:x(e),gutterTotalWidth:e.gutters.offsetWidth,gutterLeft:o,gutterWidth:n,wrapperWidth:e.wrapper.clientWidth}}function L(t,e,o){function n(e){var o=e.nextSibling;return er&&hr&&t.display.currentWheelTarget==e?e.style.display="none":e.parentNode.removeChild(e),o}for(var i=t.display,r=t.options.lineNumbers,s=i.lineDiv,a=s.firstChild,l=i.view,c=i.viewFrom,u=0;u<l.length;u++){var h=l[u];if(h.hidden);else if(h.node){for(;a!=h.node;)a=n(a);var g=r&&null!=e&&c>=e&&h.lineNumber;h.changes&&(pi(h.changes,"gutter")>-1&&(g=!1),N(t,h,c,o)),g&&(xi(h.lineNumber),h.lineNumber.appendChild(document.createTextNode(E(t.options,c)))),a=h.node.nextSibling}else{var p=U(t,h,c,o);s.insertBefore(p,a)}c+=h.size}for(;a;)a=n(a)}function N(t,e,o,n){for(var i=0;i<e.changes.length;i++){var r=e.changes[i];"text"==r?P(t,e):"gutter"==r?F(t,e,o,n):"class"==r?j(e):"widget"==r&&H(e,n)}e.changes=null}function R(t){return t.node==t.text&&(t.node=Ei("div",null,null,"position: relative"),t.text.parentNode&&t.text.parentNode.replaceChild(t.node,t.text),t.node.appendChild(t.text),Zi&&8>tr&&(t.node.style.zIndex=2)),t.node}function D(t){var e=t.bgClass?t.bgClass+" "+(t.line.bgClass||""):t.line.bgClass;if(e&&(e+=" CodeMirror-linebackground"),t.background)e?t.background.className=e:(t.background.parentNode.removeChild(t.background),t.background=null);else if(e){var o=R(t);t.background=o.insertBefore(Ei("div",null,e),o.firstChild)}}function O(t,e){var o=t.display.externalMeasured;return o&&o.line==e.line?(t.display.externalMeasured=null,e.measure=o.measure,o.built):vn(t,e)}function P(t,e){var o=e.text.className,n=O(t,e);e.text==e.node&&(e.node=n.pre),e.text.parentNode.replaceChild(n.pre,e.text),e.text=n.pre,n.bgClass!=e.bgClass||n.textClass!=e.textClass?(e.bgClass=n.bgClass,e.textClass=n.textClass,j(e)):o&&(e.text.className=o)}function j(t){D(t),t.line.wrapClass?R(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var e=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=e||""}function F(t,e,o,n){e.gutter&&(e.node.removeChild(e.gutter),e.gutter=null);var i=e.line.gutterMarkers;if(t.options.lineNumbers||i){var r=R(e),s=e.gutter=r.insertBefore(Ei("div",null,"CodeMirror-gutter-wrapper","position: absolute; left: "+(t.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px"),e.text);if(!t.options.lineNumbers||i&&i["CodeMirror-linenumbers"]||(e.lineNumber=s.appendChild(Ei("div",E(t.options,o),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+n.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+t.display.lineNumInnerWidth+"px"))),i)for(var a=0;a<t.options.gutters.length;++a){var l=t.options.gutters[a],c=i.hasOwnProperty(l)&&i[l];c&&s.appendChild(Ei("div",[c],"CodeMirror-gutter-elt","left: "+n.gutterLeft[l]+"px; width: "+n.gutterWidth[l]+"px"))}}}function H(t,e){t.alignable&&(t.alignable=null);for(var o,n=t.node.firstChild;n;n=o){var o=n.nextSibling;"CodeMirror-linewidget"==n.className&&t.node.removeChild(n)}G(t,e)}function U(t,e,o,n){var i=O(t,e);return e.text=e.node=i.pre,i.bgClass&&(e.bgClass=i.bgClass),i.textClass&&(e.textClass=i.textClass),j(e),F(t,e,o,n),G(e,n),e.node}function G(t,e){if(V(t.line,t,e,!0),t.rest)for(var o=0;o<t.rest.length;o++)V(t.rest[o],t,e,!1)}function V(t,e,o,n){if(t.widgets)for(var i=R(e),r=0,s=t.widgets;r<s.length;++r){var a=s[r],l=Ei("div",[a.node],"CodeMirror-linewidget");a.handleMouseEvents||(l.ignoreEvents=!0),W(a,l,e,o),n&&a.above?i.insertBefore(l,e.gutter||e.text):i.appendChild(l),ni(a,"redraw")}}function W(t,e,o,n){if(t.noHScroll){(o.alignable||(o.alignable=[])).push(e);var i=n.wrapperWidth;e.style.left=n.fixedPos+"px",t.coverGutter||(i-=n.gutterTotalWidth,e.style.paddingLeft=n.gutterTotalWidth+"px"),e.style.width=i+"px"}t.coverGutter&&(e.style.zIndex=5,e.style.position="relative",t.noHScroll||(e.style.marginLeft=-n.gutterTotalWidth+"px"))}function z(t){return vr(t.line,t.ch)}function q(t,e){return _r(t,e)<0?e:t}function X(t,e){return _r(t,e)<0?t:e}function Y(t,e){this.ranges=t,this.primIndex=e}function K(t,e){this.anchor=t,this.head=e}function $(t,e){var o=t[e];t.sort(function(t,e){return _r(t.from(),e.from())}),e=pi(t,o);for(var n=1;n<t.length;n++){var i=t[n],r=t[n-1];if(_r(r.to(),i.from())>=0){var s=X(r.from(),i.from()),a=q(r.to(),i.to()),l=r.empty()?i.from()==i.head:r.from()==r.head;e>=n&&--e,t.splice(--n,2,new K(l?a:s,l?s:a))}}return new Y(t,e)}function Q(t,e){return new Y([new K(t,e||t)],0)}function J(t,e){return Math.max(t.first,Math.min(e,t.first+t.size-1))}function Z(t,e){if(e.line<t.first)return vr(t.first,0);var o=t.first+t.size-1;return e.line>o?vr(o,Mn(t,o).text.length):tt(e,Mn(t,e.line).text.length)}function tt(t,e){var o=t.ch;return null==o||o>e?vr(t.line,e):0>o?vr(t.line,0):t}function et(t,e){return e>=t.first&&e<t.first+t.size}function ot(t,e){for(var o=[],n=0;n<e.length;n++)o[n]=Z(t,e[n]);return o}function nt(t,e,o,n){if(t.cm&&t.cm.display.shift||t.extend){var i=e.anchor;if(n){var r=_r(o,i)<0;r!=_r(n,i)<0?(i=o,o=n):r!=_r(o,n)<0&&(o=n)}return new K(i,o)}return new K(n||o,o)}function it(t,e,o,n){ut(t,new Y([nt(t,t.sel.primary(),e,o)],0),n)}function rt(t,e,o){for(var n=[],i=0;i<t.sel.ranges.length;i++)n[i]=nt(t,t.sel.ranges[i],e[i],null);ut(t,$(n,t.sel.primIndex),o)}function st(t,e,o,n){var i=t.sel.ranges.slice(0);i[e]=o,ut(t,$(i,t.sel.primIndex),n)}function at(t,e,o,n){ut(t,Q(e,o),n)}function lt(t,e){var o={ranges:e.ranges,update:function(e){this.ranges=[];for(var o=0;o<e.length;o++)this.ranges[o]=new K(Z(t,e[o].anchor),Z(t,e[o].head))}};return hs(t,"beforeSelectionChange",t,o),t.cm&&hs(t.cm,"beforeSelectionChange",t.cm,o),o.ranges!=e.ranges?$(o.ranges,o.ranges.length-1):e}function ct(t,e,o){var n=t.history.done,i=gi(n);i&&i.ranges?(n[n.length-1]=e,ht(t,e,o)):ut(t,e,o)}function ut(t,e,o){ht(t,e,o),zn(t,t.sel,t.cm?t.cm.curOp.id:NaN,o)}function ht(t,e,o){(ai(t,"beforeSelectionChange")||t.cm&&ai(t.cm,"beforeSelectionChange"))&&(e=lt(t,e)),gt(t,dt(t,e,o&&o.bias||(_r(e.primary().head,t.sel.primary().head)<0?-1:1),!0)),o&&!1===o.scroll||!t.cm||_o(t.cm)}function gt(t,e){e.equals(t.sel)||(t.sel=e,t.cm&&(t.cm.curOp.updateInput=t.cm.curOp.selectionChanged=!0,si(t.cm)),ni(t,"cursorActivity",t))}function pt(t){gt(t,dt(t,t.sel,null,!1),fs)}function dt(t,e,o,n){for(var i,r=0;r<e.ranges.length;r++){var s=e.ranges[r],a=ft(t,s.anchor,o,n),l=ft(t,s.head,o,n);(i||a!=s.anchor||l!=s.head)&&(i||(i=e.ranges.slice(0,r)),i[r]=new K(a,l))}return i?$(i,e.primIndex):e}function ft(t,e,o,n){var i=!1,r=e,s=o||1;t.cantEdit=!1;t:for(;;){var a=Mn(t,r.line);if(a.markedSpans)for(var l=0;l<a.markedSpans.length;++l){var c=a.markedSpans[l],u=c.marker;if((null==c.from||(u.inclusiveLeft?c.from<=r.ch:c.from<r.ch))&&(null==c.to||(u.inclusiveRight?c.to>=r.ch:c.to>r.ch))){if(n&&(hs(u,"beforeCursorEnter"),u.explicitlyCleared)){if(a.markedSpans){--l;continue}break}if(!u.atomic)continue;var h=u.find(0>s?-1:1);if(0==_r(h,r)&&(h.ch+=s,h.ch<0?h=h.line>t.first?Z(t,vr(h.line-1)):null:h.ch>a.text.length&&(h=h.line<t.first+t.size-1?vr(h.line+1,0):null),!h)){if(i)return n?(t.cantEdit=!0,vr(t.first,0)):ft(t,e,o,!0);i=!0,h=e,s=-s}r=h;continue t}}return r}}function mt(t){for(var e=t.display,o=t.doc,n={},i=n.cursors=document.createDocumentFragment(),r=n.selection=document.createDocumentFragment(),s=0;s<o.sel.ranges.length;s++){var a=o.sel.ranges[s],l=a.empty();(l||t.options.showCursorWhenSelecting)&&_t(t,a,i),l||bt(t,a,r)}if(t.options.moveInputWithCursor){var c=qt(t,o.sel.primary().head,"div"),u=e.wrapper.getBoundingClientRect(),h=e.lineDiv.getBoundingClientRect();n.teTop=Math.max(0,Math.min(e.wrapper.clientHeight-10,c.top+h.top-u.top)),n.teLeft=Math.max(0,Math.min(e.wrapper.clientWidth-10,c.left+h.left-u.left))}return n}function yt(t,e){Si(t.display.cursorDiv,e.cursors),Si(t.display.selectionDiv,e.selection),null!=e.teTop&&(t.display.inputDiv.style.top=e.teTop+"px",t.display.inputDiv.style.left=e.teLeft+"px")}function vt(t){yt(t,mt(t))}function _t(t,e,o){var n=qt(t,e.head,"div",null,null,!t.options.singleCursorHeightPerLine),i=o.appendChild(Ei("div","","CodeMirror-cursor"));if(i.style.left=n.left+"px",i.style.top=n.top+"px",i.style.height=Math.max(0,n.bottom-n.top)*t.options.cursorHeight+"px",n.other){var r=o.appendChild(Ei("div","","CodeMirror-cursor CodeMirror-secondarycursor"));r.style.display="",r.style.left=n.other.left+"px",r.style.top=n.other.top+"px",r.style.height=.85*(n.other.bottom-n.other.top)+"px"}}function bt(t,e,o){function n(t,e,o,n){0>e&&(e=0),e=Math.round(e),n=Math.round(n),a.appendChild(Ei("div",null,"CodeMirror-selected","position: absolute; left: "+t+"px; top: "+e+"px; width: "+(null==o?u-t:o)+"px; height: "+(n-e)+"px"))}function i(e,o,i){function r(o,n){return zt(t,vr(e,o),"div",h,n)}var a,l,h=Mn(s,e),g=h.text.length;return Pi(jn(h),o||0,null==i?g:i,function(t,e,s){var h,p,d,f=r(t,"left");if(t==e)h=f,p=d=f.left;else{if(h=r(e-1,"right"),"rtl"==s){var m=f;f=h,h=m}p=f.left,d=h.right}null==o&&0==t&&(p=c),h.top-f.top>3&&(n(p,f.top,null,f.bottom),p=c,f.bottom<h.top&&n(p,f.bottom,null,h.top)),null==i&&e==g&&(d=u),(!a||f.top<a.top||f.top==a.top&&f.left<a.left)&&(a=f),(!l||h.bottom>l.bottom||h.bottom==l.bottom&&h.right>l.right)&&(l=h),c+1>p&&(p=c),n(p,h.top,d-p,h.bottom)}),{start:a,end:l}}var r=t.display,s=t.doc,a=document.createDocumentFragment(),l=At(t.display),c=l.left,u=r.lineSpace.offsetWidth-l.right,h=e.from(),g=e.to();if(h.line==g.line)i(h.line,h.ch,g.ch);else{var p=Mn(s,h.line),d=Mn(s,g.line),f=Jo(p)==Jo(d),m=i(h.line,h.ch,f?p.text.length+1:null).end,y=i(g.line,f?0:null,g.ch).start;f&&(m.top<y.top-2?(n(m.right,m.top,null,m.bottom),n(c,y.top,y.left,y.bottom)):n(m.right,m.top,y.left-m.right,m.bottom)),m.bottom<y.top&&n(c,m.bottom,null,y.top)}o.appendChild(a)}function Et(t){if(t.state.focused){var e=t.display;clearInterval(e.blinker);var o=!0;e.cursorDiv.style.visibility="",t.options.cursorBlinkRate>0?e.blinker=setInterval(function(){e.cursorDiv.style.visibility=(o=!o)?"":"hidden"},t.options.cursorBlinkRate):t.options.cursorBlinkRate<0&&(e.cursorDiv.style.visibility="hidden")}}function xt(t,e){t.doc.mode.startState&&t.doc.frontier<t.display.viewTo&&t.state.highlight.set(e,yi(St,t))}function St(t){var e=t.doc;if(e.frontier<e.first&&(e.frontier=e.first),!(e.frontier>=t.display.viewTo)){var o=+new Date+t.options.workTime,n=Ur(e.mode,wt(t,e.frontier)),i=[];e.iter(e.frontier,Math.min(e.first+e.size,t.display.viewTo+500),function(r){if(e.frontier>=t.display.viewFrom){var s=r.styles,a=dn(t,r,n,!0);r.styles=a.styles;var l=r.styleClasses,c=a.classes;c?r.styleClasses=c:l&&(r.styleClasses=null);for(var u=!s||s.length!=r.styles.length||l!=c&&(!l||!c||l.bgClass!=c.bgClass||l.textClass!=c.textClass),h=0;!u&&h<s.length;++h)u=s[h]!=r.styles[h];u&&i.push(e.frontier),r.stateAfter=Ur(e.mode,n)}else mn(t,r.text,n),r.stateAfter=0==e.frontier%5?Ur(e.mode,n):null;return++e.frontier,+new Date>o?(xt(t,t.options.workDelay),!0):void 0}),i.length&&le(t,function(){for(var e=0;e<i.length;e++)fe(t,i[e],"text")})}}function Tt(t,e,o){for(var n,i,r=t.doc,s=o?-1:e-(t.doc.mode.innerMode?1e3:100),a=e;a>s;--a){if(a<=r.first)return r.first;var l=Mn(r,a-1);if(l.stateAfter&&(!o||a<=r.frontier))return a;var c=vs(l.text,null,t.options.tabSize);(null==i||n>c)&&(i=a-1,n=c)}return i}function wt(t,e,o){var n=t.doc,i=t.display;if(!n.mode.startState)return!0;var r=Tt(t,e,o),s=r>n.first&&Mn(n,r-1).stateAfter;return s=s?Ur(n.mode,s):Gr(n.mode),n.iter(r,e,function(o){mn(t,o.text,s);var a=r==e-1||0==r%5||r>=i.viewFrom&&r<i.viewTo;o.stateAfter=a?Ur(n.mode,s):null,++r}),o&&(n.frontier=r),s}function Ct(t){return t.lineSpace.offsetTop}function kt(t){return t.mover.offsetHeight-t.lineSpace.offsetHeight}function At(t){if(t.cachedPaddingH)return t.cachedPaddingH;var e=Si(t.measure,Ei("pre","x")),o=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,n={left:parseInt(o.paddingLeft),right:parseInt(o.paddingRight)};return isNaN(n.left)||isNaN(n.right)||(t.cachedPaddingH=n),n}function It(t,e,o){var n=t.options.lineWrapping,i=n&&t.display.scroller.clientWidth;if(!e.measure.heights||n&&e.measure.width!=i){var r=e.measure.heights=[];if(n){e.measure.width=i;for(var s=e.text.firstChild.getClientRects(),a=0;a<s.length-1;a++){var l=s[a],c=s[a+1];Math.abs(l.bottom-c.bottom)>2&&r.push((l.bottom+c.top)/2-o.top)}}r.push(o.bottom-o.top)}}function Bt(t,e,o){if(t.line==e)return{map:t.measure.map,cache:t.measure.cache};for(var n=0;n<t.rest.length;n++)if(t.rest[n]==e)return{map:t.measure.maps[n],cache:t.measure.caches[n]};for(var n=0;n<t.rest.length;n++)if(Dn(t.rest[n])>o)return{map:t.measure.maps[n],cache:t.measure.caches[n],before:!0}}function Mt(t,e){e=Jo(e);var o=Dn(e),n=t.display.externalMeasured=new ge(t.doc,e,o);n.lineN=o;var i=n.built=vn(t,n);return n.text=i.pre,Si(t.display.lineMeasure,i.pre),n}function Lt(t,e,o,n){return Dt(t,Rt(t,e),o,n)}function Nt(t,e){if(e>=t.display.viewFrom&&e<t.display.viewTo)return t.display.view[ye(t,e)];var o=t.display.externalMeasured;return o&&e>=o.lineN&&e<o.lineN+o.size?o:void 0}function Rt(t,e){var o=Dn(e),n=Nt(t,o);n&&!n.text?n=null:n&&n.changes&&N(t,n,o,M(t)),n||(n=Mt(t,e));var i=Bt(n,e,o);return{line:e,view:n,rect:null,map:i.map,cache:i.cache,before:i.before,hasHeights:!1}}function Dt(t,e,o,n,i){e.before&&(o=-1);var r,s=o+(n||"");return e.cache.hasOwnProperty(s)?r=e.cache[s]:(e.rect||(e.rect=e.view.text.getBoundingClientRect()),e.hasHeights||(It(t,e.view,e.rect),e.hasHeights=!0),r=Ot(t,e,o,n),r.bogus||(e.cache[s]=r)),{left:r.left,right:r.right,top:i?r.rtop:r.top,bottom:i?r.rbottom:r.bottom}}function Ot(t,e,o,n){for(var i,r,s,a,l=e.map,c=0;c<l.length;c+=3){var u=l[c],h=l[c+1];if(u>o?(r=0,s=1,a="left"):h>o?(r=o-u,s=r+1):(c==l.length-3||o==h&&l[c+3]>o)&&(s=h-u,r=s-1,o>=h&&(a="right")),null!=r){if(i=l[c+2],u==h&&n==(i.insertLeft?"left":"right")&&(a=n),"left"==n&&0==r)for(;c&&l[c-2]==l[c-3]&&l[c-1].insertLeft;)i=l[2+(c-=3)],a="left";if("right"==n&&r==h-u)for(;c<l.length-3&&l[c+3]==l[c+4]&&!l[c+5].insertLeft;)i=l[(c+=3)+2],a="right";break}}var g;if(3==i.nodeType){for(var c=0;4>c;c++){for(;r&&bi(e.line.text.charAt(u+r));)--r;for(;h>u+s&&bi(e.line.text.charAt(u+s));)++s;if(Zi&&9>tr&&0==r&&s==h-u)g=i.parentNode.getBoundingClientRect();else if(Zi&&t.options.lineWrapping){var p=Es(i,r,s).getClientRects();g=p.length?p["right"==n?p.length-1:0]:Sr}else g=Es(i,r,s).getBoundingClientRect()||Sr;if(g.left||g.right||0==r)break;s=r,r-=1,a="right"}Zi&&11>tr&&(g=Pt(t.display.measure,g))}else{r>0&&(a=n="right");var p;g=t.options.lineWrapping&&(p=i.getClientRects()).length>1?p["right"==n?p.length-1:0]:i.getBoundingClientRect()}if(Zi&&9>tr&&!r&&(!g||!g.left&&!g.right)){var d=i.parentNode.getClientRects()[0];g=d?{left:d.left,right:d.left+Jt(t.display),top:d.top,bottom:d.bottom}:Sr}for(var f=g.top-e.rect.top,m=g.bottom-e.rect.top,y=(f+m)/2,v=e.view.measure.heights,c=0;c<v.length-1&&!(y<v[c]);c++);var _=c?v[c-1]:0,b=v[c],E={left:("right"==a?g.right:g.left)-e.rect.left,right:("left"==a?g.left:g.right)-e.rect.left,top:_,bottom:b};return g.left||g.right||(E.bogus=!0),t.options.singleCursorHeightPerLine||(E.rtop=f,E.rbottom=m),E}function Pt(t,e){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!Oi(t))return e;var o=screen.logicalXDPI/screen.deviceXDPI,n=screen.logicalYDPI/screen.deviceYDPI;return{left:e.left*o,right:e.right*o,top:e.top*n,bottom:e.bottom*n}}function jt(t){if(t.measure&&(t.measure.cache={},t.measure.heights=null,t.rest))for(var e=0;e<t.rest.length;e++)t.measure.caches[e]={}}function Ft(t){t.display.externalMeasure=null,xi(t.display.lineMeasure);for(var e=0;e<t.display.view.length;e++)jt(t.display.view[e])}function Ht(t){Ft(t),t.display.cachedCharWidth=t.display.cachedTextHeight=t.display.cachedPaddingH=null,t.options.lineWrapping||(t.display.maxLineChanged=!0),t.display.lineNumChars=null}function Ut(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function Gt(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function Vt(t,e,o,n){if(e.widgets)for(var i=0;i<e.widgets.length;++i)if(e.widgets[i].above){var r=sn(e.widgets[i]);o.top+=r,o.bottom+=r}if("line"==n)return o;n||(n="local");var s=Pn(e);if("local"==n?s+=Ct(t.display):s-=t.display.viewOffset,"page"==n||"window"==n){var a=t.display.lineSpace.getBoundingClientRect();s+=a.top+("window"==n?0:Gt());var l=a.left+("window"==n?0:Ut());o.left+=l,o.right+=l}return o.top+=s,o.bottom+=s,o}function Wt(t,e,o){if("div"==o)return e;var n=e.left,i=e.top;if("page"==o)n-=Ut(),i-=Gt();else if("local"==o||!o){var r=t.display.sizer.getBoundingClientRect();n+=r.left,i+=r.top}var s=t.display.lineSpace.getBoundingClientRect();return{left:n-s.left,top:i-s.top}}function zt(t,e,o,n,i){return n||(n=Mn(t.doc,e.line)),Vt(t,n,Lt(t,n,e.ch,i),o)}function qt(t,e,o,n,i,r){function s(e,s){var a=Dt(t,i,e,s?"right":"left",r);return s?a.left=a.right:a.right=a.left,Vt(t,n,a,o)}function a(t,e){var o=l[e],n=o.level%2;return t==ji(o)&&e&&o.level<l[e-1].level?(o=l[--e],t=Fi(o)-(o.level%2?0:1),n=!0):t==Fi(o)&&e<l.length-1&&o.level<l[e+1].level&&(o=l[++e],t=ji(o)-o.level%2,n=!1),n&&t==o.to&&t>o.from?s(t-1):s(t,n)}n=n||Mn(t.doc,e.line),i||(i=Rt(t,n));var l=jn(n),c=e.ch;if(!l)return s(c);var u=qi(l,c),h=a(c,u);return null!=Ds&&(h.other=a(c,Ds)),h}function Xt(t,e){var o=0,e=Z(t.doc,e);t.options.lineWrapping||(o=Jt(t.display)*e.ch);var n=Mn(t.doc,e.line),i=Pn(n)+Ct(t.display);return{left:o,right:o,top:i,bottom:i+n.height}}function Yt(t,e,o,n){var i=vr(t,e);return i.xRel=n,o&&(i.outside=!0),i}function Kt(t,e,o){var n=t.doc;if(0>(o+=t.display.viewOffset))return Yt(n.first,0,!0,-1);var i=On(n,o),r=n.first+n.size-1;if(i>r)return Yt(n.first+n.size-1,Mn(n,r).text.length,!0,1);0>e&&(e=0);for(var s=Mn(n,i);;){var a=$t(t,s,i,e,o),l=$o(s),c=l&&l.find(0,!0);if(!l||!(a.ch>c.from.ch||a.ch==c.from.ch&&a.xRel>0))return a;i=Dn(s=c.to.line)}}function $t(t,e,o,n,i){function r(n){var i=qt(t,vr(o,n),"line",e,c);return a=!0,s>i.bottom?i.left-l:s<i.top?i.left+l:(a=!1,i.left)}var s=i-Pn(e),a=!1,l=2*t.display.wrapper.clientWidth,c=Rt(t,e),u=jn(e),h=e.text.length,g=Hi(e),p=Ui(e),d=r(g),f=a,m=r(p),y=a;if(n>m)return Yt(o,p,y,1);for(;;){if(u?p==g||p==Yi(e,g,1):1>=p-g){for(var v=d>n||m-n>=n-d?g:p,_=n-(v==g?d:m);bi(e.text.charAt(v));)++v;return Yt(o,v,v==g?f:y,-1>_?-1:_>1?1:0)}var b=Math.ceil(h/2),E=g+b;if(u){E=g;for(var x=0;b>x;++x)E=Yi(e,E,1)}var S=r(E);S>n?(p=E,m=S,(y=a)&&(m+=1e3),h=b):(g=E,d=S,f=a,h-=b)}}function Qt(t){if(null!=t.cachedTextHeight)return t.cachedTextHeight;if(null==br){br=Ei("pre");for(var e=0;49>e;++e)br.appendChild(document.createTextNode("x")),br.appendChild(Ei("br"));br.appendChild(document.createTextNode("x"))}Si(t.measure,br);var o=br.offsetHeight/50;return o>3&&(t.cachedTextHeight=o),xi(t.measure),o||1}function Jt(t){if(null!=t.cachedCharWidth)return t.cachedCharWidth;var e=Ei("span","xxxxxxxxxx"),o=Ei("pre",[e]);Si(t.measure,o);var n=e.getBoundingClientRect(),i=(n.right-n.left)/10;return i>2&&(t.cachedCharWidth=i),i||10}function Zt(t){t.curOp={cm:t,viewChanged:!1,startHeight:t.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,id:++wr},Tr?Tr.ops.push(t.curOp):t.curOp.ownsGroup=Tr={ops:[t.curOp],delayedCallbacks:[]}}function te(t){var e=t.delayedCallbacks,o=0;do{for(;o<e.length;o++)e[o]();for(var n=0;n<t.ops.length;n++){var i=t.ops[n];if(i.cursorActivityHandlers)for(;i.cursorActivityCalled<i.cursorActivityHandlers.length;)i.cursorActivityHandlers[i.cursorActivityCalled++](i.cm)}}while(o<e.length)}function ee(t){var e=t.curOp,o=e.ownsGroup;if(o)try{te(o)}finally{Tr=null;for(var n=0;n<o.ops.length;n++)o.ops[n].cm.curOp=null;oe(o)}}function oe(t){for(var e=t.ops,o=0;o<e.length;o++)ne(e[o]);for(var o=0;o<e.length;o++)ie(e[o]);for(var o=0;o<e.length;o++)re(e[o]);for(var o=0;o<e.length;o++)se(e[o]);for(var o=0;o<e.length;o++)ae(e[o])}function ne(t){var e=t.cm,o=e.display;t.updateMaxLine&&p(e),t.mustUpdate=t.viewChanged||t.forceUpdate||null!=t.scrollTop||t.scrollToPos&&(t.scrollToPos.from.line<o.viewFrom||t.scrollToPos.to.line>=o.viewTo)||o.maxLineChanged&&e.options.lineWrapping,t.update=t.mustUpdate&&new S(e,t.mustUpdate&&{top:t.scrollTop,ensure:t.scrollToPos},t.forceUpdate)}function ie(t){t.updatedDisplay=t.mustUpdate&&T(t.cm,t.update)}function re(t){var e=t.cm,o=e.display;t.updatedDisplay&&I(e),t.barMeasure=m(e),o.maxLineChanged&&!e.options.lineWrapping&&(t.adjustWidthTo=Lt(e,o.maxLine,o.maxLine.text.length).left+3,t.maxScrollLeft=Math.max(0,o.sizer.offsetLeft+t.adjustWidthTo+ps-o.scroller.clientWidth)),(t.updatedDisplay||t.selectionChanged)&&(t.newSelectionNodes=mt(e))}function se(t){var e=t.cm;null!=t.adjustWidthTo&&(e.display.sizer.style.minWidth=t.adjustWidthTo+"px",t.maxScrollLeft<e.doc.scrollLeft&&Ue(e,Math.min(e.display.scroller.scrollLeft,t.maxScrollLeft),!0),e.display.maxLineChanged=!1),t.newSelectionNodes&&yt(e,t.newSelectionNodes),t.updatedDisplay&&k(e,t.barMeasure),(t.updatedDisplay||t.startHeight!=e.doc.height)&&y(e,t.barMeasure),t.selectionChanged&&Et(e),e.state.focused&&t.updateInput&&Te(e,t.typing)}function ae(t){var e=t.cm,o=e.display,n=e.doc;if(null!=t.adjustWidthTo&&Math.abs(t.barMeasure.scrollWidth-e.display.scroller.scrollWidth)>1&&y(e),t.updatedDisplay&&w(e,t.update),null==o.wheelStartX||null==t.scrollTop&&null==t.scrollLeft&&!t.scrollToPos||(o.wheelStartX=o.wheelStartY=null),null!=t.scrollTop&&(o.scroller.scrollTop!=t.scrollTop||t.forceScroll)){var i=Math.max(0,Math.min(o.scroller.scrollHeight-o.scroller.clientHeight,t.scrollTop));o.scroller.scrollTop=o.scrollbarV.scrollTop=n.scrollTop=i}if(null!=t.scrollLeft&&(o.scroller.scrollLeft!=t.scrollLeft||t.forceScroll)){var r=Math.max(0,Math.min(o.scroller.scrollWidth-o.scroller.clientWidth,t.scrollLeft));o.scroller.scrollLeft=o.scrollbarH.scrollLeft=n.scrollLeft=r,_(e)}if(t.scrollToPos){var s=fo(e,Z(n,t.scrollToPos.from),Z(n,t.scrollToPos.to),t.scrollToPos.margin);t.scrollToPos.isCursor&&e.state.focused&&po(e,s)}var a=t.maybeHiddenMarkers,l=t.maybeUnhiddenMarkers;if(a)for(var c=0;c<a.length;++c)a[c].lines.length||hs(a[c],"hide");if(l)for(var c=0;c<l.length;++c)l[c].lines.length&&hs(l[c],"unhide");o.wrapper.offsetHeight&&(n.scrollTop=e.display.scroller.scrollTop),t.updatedDisplay&&er&&(e.options.lineWrapping&&A(e,t.barMeasure),t.barMeasure.scrollWidth>t.barMeasure.clientWidth&&t.barMeasure.scrollWidth<t.barMeasure.clientWidth+1&&!f(e)&&y(e)),t.changeObjs&&hs(e,"changes",e,t.changeObjs)}function le(t,e){if(t.curOp)return e();Zt(t);try{return e()}finally{ee(t)}}function ce(t,e){return function(){if(t.curOp)return e.apply(t,arguments);Zt(t);try{return e.apply(t,arguments)}finally{ee(t)}}}function ue(t){return function(){if(this.curOp)return t.apply(this,arguments);Zt(this);try{return t.apply(this,arguments)}finally{ee(this)}}}function he(t){return function(){var e=this.cm;if(!e||e.curOp)return t.apply(this,arguments);Zt(e);try{return t.apply(this,arguments)}finally{ee(e)}}}function ge(t,e,o){this.line=e,this.rest=Zo(e),this.size=this.rest?Dn(gi(this.rest))-o+1:1,this.node=this.text=null,this.hidden=on(t,e)}function pe(t,e,o){for(var n,i=[],r=e;o>r;r=n){var s=new ge(t.doc,Mn(t.doc,r),r);n=r+s.size,i.push(s)}return i}function de(t,e,o,n){null==e&&(e=t.doc.first),null==o&&(o=t.doc.first+t.doc.size),n||(n=0);var i=t.display;if(n&&o<i.viewTo&&(null==i.updateLineNumbers||i.updateLineNumbers>e)&&(i.updateLineNumbers=e),t.curOp.viewChanged=!0,e>=i.viewTo)yr&&tn(t.doc,e)<i.viewTo&&me(t);else if(o<=i.viewFrom)yr&&en(t.doc,o+n)>i.viewFrom?me(t):(i.viewFrom+=n,i.viewTo+=n);else if(e<=i.viewFrom&&o>=i.viewTo)me(t);else if(e<=i.viewFrom){var r=ve(t,o,o+n,1);r?(i.view=i.view.slice(r.index),i.viewFrom=r.lineN,i.viewTo+=n):me(t)}else if(o>=i.viewTo){var r=ve(t,e,e,-1);r?(i.view=i.view.slice(0,r.index),i.viewTo=r.lineN):me(t)}else{var s=ve(t,e,e,-1),a=ve(t,o,o+n,1);s&&a?(i.view=i.view.slice(0,s.index).concat(pe(t,s.lineN,a.lineN)).concat(i.view.slice(a.index)),i.viewTo+=n):me(t)}var l=i.externalMeasured;l&&(o<l.lineN?l.lineN+=n:e<l.lineN+l.size&&(i.externalMeasured=null))}function fe(t,e,o){t.curOp.viewChanged=!0;var n=t.display,i=t.display.externalMeasured;if(i&&e>=i.lineN&&e<i.lineN+i.size&&(n.externalMeasured=null),!(e<n.viewFrom||e>=n.viewTo)){var r=n.view[ye(t,e)];if(null!=r.node){var s=r.changes||(r.changes=[]);-1==pi(s,o)&&s.push(o)}}}function me(t){t.display.viewFrom=t.display.viewTo=t.doc.first,t.display.view=[],t.display.viewOffset=0}function ye(t,e){if(e>=t.display.viewTo)return null;if(0>(e-=t.display.viewFrom))return null;for(var o=t.display.view,n=0;n<o.length;n++)if(0>(e-=o[n].size))return n}function ve(t,e,o,n){var i,r=ye(t,e),s=t.display.view;if(!yr||o==t.doc.first+t.doc.size)return{index:r,lineN:o};for(var a=0,l=t.display.viewFrom;r>a;a++)l+=s[a].size;if(l!=e){if(n>0){if(r==s.length-1)return null;i=l+s[r].size-e,r++}else i=l-e;e+=i,o+=i}for(;tn(t.doc,o)!=o;){if(r==(0>n?0:s.length-1))return null;o+=n*s[r-(0>n?1:0)].size,r+=n}return{index:r,lineN:o}}function _e(t,e,o){var n=t.display;0==n.view.length||e>=n.viewTo||o<=n.viewFrom?(n.view=pe(t,e,o),n.viewFrom=e):(n.viewFrom>e?n.view=pe(t,e,n.viewFrom).concat(n.view):n.viewFrom<e&&(n.view=n.view.slice(ye(t,e))),n.viewFrom=e,n.viewTo<o?n.view=n.view.concat(pe(t,n.viewTo,o)):n.viewTo>o&&(n.view=n.view.slice(0,ye(t,o)))),n.viewTo=o}function be(t){for(var e=t.display.view,o=0,n=0;n<e.length;n++){var i=e[n];i.hidden||i.node&&!i.changes||++o}return o}function Ee(t){t.display.pollingFast||t.display.poll.set(t.options.pollInterval,function(){Se(t),t.state.focused&&Ee(t)})}function xe(t){function e(){Se(t)||o?(t.display.pollingFast=!1,Ee(t)):(o=!0,t.display.poll.set(60,e))}var o=!1;t.display.pollingFast=!0,t.display.poll.set(20,e)}function Se(t){var e=t.display.input,o=t.display.prevInput,n=t.doc;if(!t.state.focused||Ms(e)&&!o||ke(t)||t.options.disableInput)return!1;t.state.pasteIncoming&&t.state.fakedLastChar&&(e.value=e.value.substring(0,e.value.length-1),t.state.fakedLastChar=!1);var i=e.value;if(i==o&&!t.somethingSelected())return!1;if(Zi&&tr>=9&&t.display.inputHasSelection===i||hr&&/[\uf700-\uf7ff]/.test(i))return Te(t),!1;var r=!t.curOp;r&&Zt(t),t.display.shift=!1,8203!=i.charCodeAt(0)||n.sel!=t.display.selForContextMenu||o||(o="");for(var s=0,a=Math.min(o.length,i.length);a>s&&o.charCodeAt(s)==i.charCodeAt(s);)++s;var l=i.slice(s),c=Bs(l),u=null;t.state.pasteIncoming&&n.sel.ranges.length>1&&(Cr&&Cr.join("\n")==l?u=0==n.sel.ranges.length%Cr.length&&di(Cr,Bs):c.length==n.sel.ranges.length&&(u=di(c,function(t){return[t]})));for(var h=n.sel.ranges.length-1;h>=0;h--){var g=n.sel.ranges[h],p=g.from(),d=g.to();s<o.length?p=vr(p.line,p.ch-(o.length-s)):t.state.overwrite&&g.empty()&&!t.state.pasteIncoming&&(d=vr(d.line,Math.min(Mn(n,d.line).text.length,d.ch+gi(c).length)));var f=t.curOp.updateInput,m={from:p,to:d,text:u?u[h%u.length]:c,origin:t.state.pasteIncoming?"paste":t.state.cutIncoming?"cut":"+input"};if(so(t.doc,m),ni(t,"inputRead",t,m),l&&!t.state.pasteIncoming&&t.options.electricChars&&t.options.smartIndent&&g.head.ch<100&&(!h||n.sel.ranges[h-1].head.line!=g.head.line)){var y=t.getModeAt(g.head),v=Lr(m);if(y.electricChars){for(var _=0;_<y.electricChars.length;_++)if(l.indexOf(y.electricChars.charAt(_))>-1){Eo(t,v.line,"smart");break}}else y.electricInput&&y.electricInput.test(Mn(n,v.line).text.slice(0,v.ch))&&Eo(t,v.line,"smart")}}return _o(t),t.curOp.updateInput=f,t.curOp.typing=!0,i.length>1e3||i.indexOf("\n")>-1?e.value=t.display.prevInput="":t.display.prevInput=i,r&&ee(t),t.state.pasteIncoming=t.state.cutIncoming=!1,!0}function Te(t,e){var o,n,i=t.doc;if(t.somethingSelected()){t.display.prevInput="";var r=i.sel.primary();o=Ls&&(r.to().line-r.from().line>100||(n=t.getSelection()).length>1e3);var s=o?"-":n||t.getSelection();t.display.input.value=s,t.state.focused&&bs(t.display.input),Zi&&tr>=9&&(t.display.inputHasSelection=s)}else e||(t.display.prevInput=t.display.input.value="",Zi&&tr>=9&&(t.display.inputHasSelection=null));t.display.inaccurateSelection=o}function we(t){"nocursor"==t.options.readOnly||ur&&wi()==t.display.input||t.display.input.focus()}function Ce(t){t.state.focused||(we(t),Qe(t))}function ke(t){return t.options.readOnly||t.doc.cantEdit}function Ae(t){function e(){t.state.focused&&setTimeout(yi(we,t),0)}function o(e){ri(t,e)||ls(e)}function n(e){if(t.somethingSelected())Cr=t.getSelections(),i.inaccurateSelection&&(i.prevInput="",i.inaccurateSelection=!1,i.input.value=Cr.join("\n"),bs(i.input));else{for(var o=[],n=[],r=0;r<t.doc.sel.ranges.length;r++){var s=t.doc.sel.ranges[r].head.line,a={anchor:vr(s,0),head:vr(s+1,0)};n.push(a),o.push(t.getRange(a.anchor,a.head))}"cut"==e.type?t.setSelections(n,null,fs):(i.prevInput="",i.input.value=o.join("\n"),bs(i.input)),Cr=o}"cut"==e.type&&(t.state.cutIncoming=!0)}var i=t.display;cs(i.scroller,"mousedown",ce(t,Le)),Zi&&11>tr?cs(i.scroller,"dblclick",ce(t,function(e){if(!ri(t,e)){var o=Me(t,e);if(o&&!Pe(t,e)&&!Be(t.display,e)){ss(e);var n=t.findWordAt(o);it(t.doc,n.anchor,n.head)}}})):cs(i.scroller,"dblclick",function(e){ri(t,e)||ss(e)}),cs(i.lineSpace,"selectstart",function(t){Be(i,t)||ss(t)}),fr||cs(i.scroller,"contextmenu",function(e){Ze(t,e)}),cs(i.scroller,"scroll",function(){i.scroller.clientHeight&&(He(t,i.scroller.scrollTop),Ue(t,i.scroller.scrollLeft,!0),hs(t,"scroll",t))}),cs(i.scrollbarV,"scroll",function(){i.scroller.clientHeight&&He(t,i.scrollbarV.scrollTop)}),cs(i.scrollbarH,"scroll",function(){i.scroller.clientHeight&&Ue(t,i.scrollbarH.scrollLeft)}),cs(i.scroller,"mousewheel",function(e){Ge(t,e)}),cs(i.scroller,"DOMMouseScroll",function(e){Ge(t,e)}),cs(i.scrollbarH,"mousedown",e),cs(i.scrollbarV,"mousedown",e),cs(i.wrapper,"scroll",function(){i.wrapper.scrollTop=i.wrapper.scrollLeft=0}),cs(i.input,"keyup",function(e){Ke.call(t,e)}),cs(i.input,"input",function(){Zi&&tr>=9&&t.display.inputHasSelection&&(t.display.inputHasSelection=null),xe(t)}),cs(i.input,"keydown",ce(t,Xe)),cs(i.input,"keypress",ce(t,$e)),cs(i.input,"focus",yi(Qe,t)),cs(i.input,"blur",yi(Je,t)),t.options.dragDrop&&(cs(i.scroller,"dragstart",function(e){Fe(t,e)}),cs(i.scroller,"dragenter",o),cs(i.scroller,"dragover",o),cs(i.scroller,"drop",ce(t,je))),cs(i.scroller,"paste",function(e){Be(i,e)||(t.state.pasteIncoming=!0,we(t),xe(t))}),cs(i.input,"paste",function(){if(er&&!t.state.fakedLastChar&&!(new Date-t.state.lastMiddleDown<200)){var e=i.input.selectionStart,o=i.input.selectionEnd;i.input.value+="$",i.input.selectionEnd=o,i.input.selectionStart=e,t.state.fakedLastChar=!0}t.state.pasteIncoming=!0,xe(t)}),cs(i.input,"cut",n),cs(i.input,"copy",n),sr&&cs(i.sizer,"mouseup",function(){wi()==i.input&&i.input.blur(),we(t)})}function Ie(t){var e=t.display;e.cachedCharWidth=e.cachedTextHeight=e.cachedPaddingH=null,t.setSize()}function Be(t,e){for(var o=ei(e);o!=t.wrapper;o=o.parentNode)if(!o||o.ignoreEvents||o.parentNode==t.sizer&&o!=t.mover)return!0}function Me(t,e,o,n){var i=t.display;if(!o){var r=ei(e);if(r==i.scrollbarH||r==i.scrollbarV||r==i.scrollbarFiller||r==i.gutterFiller)return null}var s,a,l=i.lineSpace.getBoundingClientRect();try{s=e.clientX-l.left,a=e.clientY-l.top}catch(e){return null}var c,u=Kt(t,s,a);if(n&&1==u.xRel&&(c=Mn(t.doc,u.line).text).length==u.ch){var h=vs(c,c.length,t.options.tabSize)-c.length;u=vr(u.line,Math.max(0,Math.round((s-At(t.display).left)/Jt(t.display))-h))}return u}function Le(t){if(!ri(this,t)){var e=this,o=e.display;if(o.shift=t.shiftKey,Be(o,t))return void(er||(o.scroller.draggable=!1,setTimeout(function(){o.scroller.draggable=!0},100)));if(!Pe(e,t)){var n=Me(e,t);switch(window.focus(),oi(t)){case 1:n?Ne(e,t,n):ei(t)==o.scroller&&ss(t);break;case 2:er&&(e.state.lastMiddleDown=+new Date),n&&it(e.doc,n),setTimeout(yi(we,e),20),ss(t);break;case 3:fr&&Ze(e,t)}}}}function Ne(t,e,o){setTimeout(yi(Ce,t),0);var n,i=+new Date;xr&&xr.time>i-400&&0==_r(xr.pos,o)?n="triple":Er&&Er.time>i-400&&0==_r(Er.pos,o)?(n="double",xr={time:i,pos:o}):(n="single",Er={time:i,pos:o});var r=t.doc.sel,s=hr?e.metaKey:e.ctrlKey;t.options.dragDrop&&Is&&!ke(t)&&"single"==n&&r.contains(o)>-1&&r.somethingSelected()?Re(t,e,o,s):De(t,e,o,n,s)}function Re(t,e,o,n){var i=t.display,r=ce(t,function(s){er&&(i.scroller.draggable=!1),t.state.draggingText=!1,us(document,"mouseup",r),us(i.scroller,"drop",r),Math.abs(e.clientX-s.clientX)+Math.abs(e.clientY-s.clientY)<10&&(ss(s),n||it(t.doc,o),we(t),Zi&&9==tr&&setTimeout(function(){document.body.focus(),we(t)},20))});er&&(i.scroller.draggable=!0),t.state.draggingText=r,i.scroller.dragDrop&&i.scroller.dragDrop(),cs(document,"mouseup",r),cs(i.scroller,"drop",r)}function De(t,e,o,n,i){function r(e){if(0!=_r(f,e))if(f=e,"rect"==n){for(var i=[],r=t.options.tabSize,s=vs(Mn(c,o.line).text,o.ch,r),a=vs(Mn(c,e.line).text,e.ch,r),l=Math.min(s,a),p=Math.max(s,a),d=Math.min(o.line,e.line),m=Math.min(t.lastLine(),Math.max(o.line,e.line));m>=d;d++){var y=Mn(c,d).text,v=ui(y,l,r);l==p?i.push(new K(vr(d,v),vr(d,v))):y.length>v&&i.push(new K(vr(d,v),vr(d,ui(y,p,r))))}i.length||i.push(new K(o,o)),ut(c,$(g.ranges.slice(0,h).concat(i),h),{origin:"*mouse",scroll:!1}),t.scrollIntoView(e)}else{var _=u,b=_.anchor,E=e;if("single"!=n){if("double"==n)var x=t.findWordAt(e);else var x=new K(vr(e.line,0),Z(c,vr(e.line+1,0)));_r(x.anchor,b)>0?(E=x.head,b=X(_.from(),x.anchor)):(E=x.anchor,b=q(_.to(),x.head))}var i=g.ranges.slice(0);i[h]=new K(Z(c,b),E),ut(c,$(i,h),ms)}}function s(e){var o=++y,i=Me(t,e,!0,"rect"==n);if(i)if(0!=_r(i,f)){Ce(t),r(i);var a=v(l,c);(i.line>=a.to||i.line<a.from)&&setTimeout(ce(t,function(){y==o&&s(e)}),150)}else{var u=e.clientY<m.top?-20:e.clientY>m.bottom?20:0;u&&setTimeout(ce(t,function(){y==o&&(l.scroller.scrollTop+=u,s(e))}),50)}}function a(e){y=1/0,ss(e),we(t),us(document,"mousemove",_),us(document,"mouseup",b),c.history.lastSelOrigin=null}var l=t.display,c=t.doc;ss(e);var u,h,g=c.sel;if(i&&!e.shiftKey?(h=c.sel.contains(o),u=h>-1?c.sel.ranges[h]:new K(o,o)):u=c.sel.primary(),e.altKey)n="rect",i||(u=new K(o,o)),o=Me(t,e,!0,!0),h=-1;else if("double"==n){var p=t.findWordAt(o);u=t.display.shift||c.extend?nt(c,u,p.anchor,p.head):p}else if("triple"==n){var d=new K(vr(o.line,0),Z(c,vr(o.line+1,0)));u=t.display.shift||c.extend?nt(c,u,d.anchor,d.head):d}else u=nt(c,u,o);i?h>-1?st(c,h,u,ms):(h=c.sel.ranges.length,ut(c,$(c.sel.ranges.concat([u]),h),{scroll:!1,origin:"*mouse"})):(h=0,ut(c,new Y([u],0),ms),g=c.sel);var f=o,m=l.wrapper.getBoundingClientRect(),y=0,_=ce(t,function(t){oi(t)?s(t):a(t)}),b=ce(t,a);cs(document,"mousemove",_),cs(document,"mouseup",b)}function Oe(t,e,o,n,i){try{var r=e.clientX,s=e.clientY}catch(e){return!1}if(r>=Math.floor(t.display.gutters.getBoundingClientRect().right))return!1;n&&ss(e);var a=t.display,l=a.lineDiv.getBoundingClientRect();if(s>l.bottom||!ai(t,o))return ti(e);s-=l.top-a.viewOffset;for(var c=0;c<t.options.gutters.length;++c){var u=a.gutters.childNodes[c];if(u&&u.getBoundingClientRect().right>=r){return i(t,o,t,On(t.doc,s),t.options.gutters[c],e),ti(e)}}}function Pe(t,e){return Oe(t,e,"gutterClick",!0,ni)}function je(t){var e=this;if(!ri(e,t)&&!Be(e.display,t)){ss(t),Zi&&(kr=+new Date);var o=Me(e,t,!0),n=t.dataTransfer.files;if(o&&!ke(e))if(n&&n.length&&window.FileReader&&window.File)for(var i=n.length,r=Array(i),s=0,a=0;i>a;++a)!function(t,n){var a=new FileReader;a.onload=ce(e,function(){if(r[n]=a.result,++s==i){o=Z(e.doc,o);var t={from:o,to:o,text:Bs(r.join("\n")),origin:"paste"};so(e.doc,t),ct(e.doc,Q(o,Lr(t)))}}),a.readAsText(t)}(n[a],a);else{if(e.state.draggingText&&e.doc.sel.contains(o)>-1)return e.state.draggingText(t),void setTimeout(yi(we,e),20);try{var r=t.dataTransfer.getData("Text");if(r){if(e.state.draggingText&&!(hr?t.metaKey:t.ctrlKey))var l=e.listSelections();if(ht(e.doc,Q(o,o)),l)for(var a=0;a<l.length;++a)go(e.doc,"",l[a].anchor,l[a].head,"drag");e.replaceSelection(r,"around","paste"),we(e)}}catch(t){}}}}function Fe(t,e){if(Zi&&(!t.state.draggingText||+new Date-kr<100))return void ls(e);if(!ri(t,e)&&!Be(t.display,e)&&(e.dataTransfer.setData("Text",t.getSelection()),e.dataTransfer.setDragImage&&!rr)){var o=Ei("img",null,null,"position: fixed; left: 0; top: 0;");o.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",ir&&(o.width=o.height=1,t.display.wrapper.appendChild(o),o._top=o.offsetTop),e.dataTransfer.setDragImage(o,0,0),ir&&o.parentNode.removeChild(o)}}function He(t,e){Math.abs(t.doc.scrollTop-e)<2||(t.doc.scrollTop=e,$i||C(t,{top:e}),t.display.scroller.scrollTop!=e&&(t.display.scroller.scrollTop=e),t.display.scrollbarV.scrollTop!=e&&(t.display.scrollbarV.scrollTop=e),$i&&C(t),xt(t,100))}function Ue(t,e,o){(o?e==t.doc.scrollLeft:Math.abs(t.doc.scrollLeft-e)<2)||(e=Math.min(e,t.display.scroller.scrollWidth-t.display.scroller.clientWidth),t.doc.scrollLeft=e,_(t),t.display.scroller.scrollLeft!=e&&(t.display.scroller.scrollLeft=e),t.display.scrollbarH.scrollLeft!=e&&(t.display.scrollbarH.scrollLeft=e))}function Ge(t,e){var o=e.wheelDeltaX,n=e.wheelDeltaY;null==o&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(o=e.detail),null==n&&e.detail&&e.axis==e.VERTICAL_AXIS?n=e.detail:null==n&&(n=e.wheelDelta);var i=t.display,r=i.scroller;if(o&&r.scrollWidth>r.clientWidth||n&&r.scrollHeight>r.clientHeight){if(n&&hr&&er)t:for(var s=e.target,a=i.view;s!=r;s=s.parentNode)for(var l=0;l<a.length;l++)if(a[l].node==s){t.display.currentWheelTarget=s;break t}if(o&&!$i&&!ir&&null!=Ir)return n&&He(t,Math.max(0,Math.min(r.scrollTop+n*Ir,r.scrollHeight-r.clientHeight))),Ue(t,Math.max(0,Math.min(r.scrollLeft+o*Ir,r.scrollWidth-r.clientWidth))),ss(e),void(i.wheelStartX=null);if(n&&null!=Ir){var c=n*Ir,u=t.doc.scrollTop,h=u+i.wrapper.clientHeight;0>c?u=Math.max(0,u+c-50):h=Math.min(t.doc.height,h+c+50),C(t,{top:u,bottom:h})}20>Ar&&(null==i.wheelStartX?(i.wheelStartX=r.scrollLeft,i.wheelStartY=r.scrollTop,i.wheelDX=o,i.wheelDY=n,setTimeout(function(){if(null!=i.wheelStartX){var t=r.scrollLeft-i.wheelStartX,e=r.scrollTop-i.wheelStartY,o=e&&i.wheelDY&&e/i.wheelDY||t&&i.wheelDX&&t/i.wheelDX;i.wheelStartX=i.wheelStartY=null,o&&(Ir=(Ir*Ar+o)/(Ar+1),++Ar)}},200)):(i.wheelDX+=o,i.wheelDY+=n))}}function Ve(t,e,o){if("string"==typeof e&&!(e=Vr[e]))return!1;t.display.pollingFast&&Se(t)&&(t.display.pollingFast=!1);var n=t.display.shift,i=!1;try{ke(t)&&(t.state.suppressEdits=!0),o&&(t.display.shift=!1),i=e(t)!=ds}finally{t.display.shift=n,t.state.suppressEdits=!1}return i}function We(t){var e=t.state.keyMaps.slice(0);return t.options.extraKeys&&e.push(t.options.extraKeys),e.push(t.options.keyMap),e}function ze(t,e){var o=ko(t.options.keyMap),n=o.auto;clearTimeout(Br),n&&!qr(e)&&(Br=setTimeout(function(){ko(t.options.keyMap)==o&&(t.options.keyMap=n.call?n.call(null,t):n,a(t))},50));var i=Xr(e,!0),r=!1;if(!i)return!1;var s=We(t);return r=e.shiftKey?zr("Shift-"+i,s,function(e){return Ve(t,e,!0)})||zr(i,s,function(e){return("string"==typeof e?/^go[A-Z]/.test(e):e.motion)?Ve(t,e):void 0}):zr(i,s,function(e){return Ve(t,e)}),r&&(ss(e),Et(t),ni(t,"keyHandled",t,i,e)),r}function qe(t,e,o){var n=zr("'"+o+"'",We(t),function(e){return Ve(t,e,!0)});return n&&(ss(e),Et(t),ni(t,"keyHandled",t,"'"+o+"'",e)),n}function Xe(t){var e=this;if(Ce(e),!ri(e,t)){Zi&&11>tr&&27==t.keyCode&&(t.returnValue=!1);var o=t.keyCode;e.display.shift=16==o||t.shiftKey;var n=ze(e,t);ir&&(Mr=n?o:null,!n&&88==o&&!Ls&&(hr?t.metaKey:t.ctrlKey)&&e.replaceSelection("",null,"cut")),18!=o||/\bCodeMirror-crosshair\b/.test(e.display.lineDiv.className)||Ye(e)}}function Ye(t){function e(t){18!=t.keyCode&&t.altKey||(ki(o,"CodeMirror-crosshair"),us(document,"keyup",e),us(document,"mouseover",e))}var o=t.display.lineDiv;Ai(o,"CodeMirror-crosshair"),cs(document,"keyup",e),cs(document,"mouseover",e)}function Ke(t){16==t.keyCode&&(this.doc.sel.shift=!1),ri(this,t)}function $e(t){var e=this;if(!(ri(e,t)||t.ctrlKey&&!t.altKey||hr&&t.metaKey)){var o=t.keyCode,n=t.charCode;if(ir&&o==Mr)return Mr=null,void ss(t);if(!(ir&&(!t.which||t.which<10)||sr)||!ze(e,t)){qe(e,t,String.fromCharCode(null==n?o:n))||(Zi&&tr>=9&&(e.display.inputHasSelection=null),xe(e))}}}function Qe(t){"nocursor"!=t.options.readOnly&&(t.state.focused||(hs(t,"focus",t),t.state.focused=!0,Ai(t.display.wrapper,"CodeMirror-focused"),t.curOp||t.display.selForContextMenu==t.doc.sel||(Te(t),er&&setTimeout(yi(Te,t,!0),0))),Ee(t),Et(t))}function Je(t){t.state.focused&&(hs(t,"blur",t),t.state.focused=!1,ki(t.display.wrapper,"CodeMirror-focused")),clearInterval(t.display.blinker),setTimeout(function(){t.state.focused||(t.display.shift=!1)},150)}function Ze(t,e){function o(){if(null!=i.input.selectionStart){var e=t.somethingSelected(),o=i.input.value=""+(e?i.input.value:"");i.prevInput=e?"":"",i.input.selectionStart=1,i.input.selectionEnd=o.length,i.selForContextMenu=t.doc.sel}}function n(){if(i.inputDiv.style.position="relative",i.input.style.cssText=a,Zi&&9>tr&&(i.scrollbarV.scrollTop=i.scroller.scrollTop=s),Ee(t),null!=i.input.selectionStart){(!Zi||Zi&&9>tr)&&o();var e=0,n=function(){i.selForContextMenu==t.doc.sel&&0==i.input.selectionStart?ce(t,Vr.selectAll)(t):e++<10?i.detectingSelectAll=setTimeout(n,500):Te(t)};i.detectingSelectAll=setTimeout(n,200)}}if(!ri(t,e,"contextmenu")){var i=t.display;if(!Be(i,e)&&!to(t,e)){var r=Me(t,e),s=i.scroller.scrollTop;if(r&&!ir){t.options.resetSelectionOnContextMenu&&-1==t.doc.sel.contains(r)&&ce(t,ut)(t.doc,Q(r),fs);var a=i.input.style.cssText;if(i.inputDiv.style.position="absolute",i.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(e.clientY-5)+"px; left: "+(e.clientX-5)+"px; z-index: 1000; background: "+(Zi?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",er)var l=window.scrollY;if(we(t),er&&window.scrollTo(null,l),Te(t),t.somethingSelected()||(i.input.value=i.prevInput=" "),i.selForContextMenu=t.doc.sel,clearTimeout(i.detectingSelectAll),Zi&&tr>=9&&o(),fr){ls(e);var c=function(){us(window,"mouseup",c),setTimeout(n,20)};cs(window,"mouseup",c)}else setTimeout(n,50)}}}}function to(t,e){return!!ai(t,"gutterContextMenu")&&Oe(t,e,"gutterContextMenu",!1,hs)}function eo(t,e){if(_r(t,e.from)<0)return t;if(_r(t,e.to)<=0)return Lr(e);var o=t.line+e.text.length-(e.to.line-e.from.line)-1,n=t.ch;return t.line==e.to.line&&(n+=Lr(e).ch-e.to.ch),vr(o,n)}function oo(t,e){for(var o=[],n=0;n<t.sel.ranges.length;n++){var i=t.sel.ranges[n];o.push(new K(eo(i.anchor,e),eo(i.head,e)))}return $(o,t.sel.primIndex)}function no(t,e,o){return t.line==e.line?vr(o.line,t.ch-e.ch+o.ch):vr(o.line+(t.line-e.line),t.ch)}function io(t,e,o){for(var n=[],i=vr(t.first,0),r=i,s=0;s<e.length;s++){var a=e[s],l=no(a.from,i,r),c=no(Lr(a),i,r);if(i=a.to,r=c,"around"==o){var u=t.sel.ranges[s],h=_r(u.head,u.anchor)<0;n[s]=new K(h?c:l,h?l:c)}else n[s]=new K(l,l)}return new Y(n,t.sel.primIndex)}function ro(t,e,o){var n={canceled:!1,from:e.from,to:e.to,text:e.text,origin:e.origin,cancel:function(){this.canceled=!0}};return o&&(n.update=function(e,o,n,i){e&&(this.from=Z(t,e)),o&&(this.to=Z(t,o)),n&&(this.text=n),void 0!==i&&(this.origin=i)}),hs(t,"beforeChange",t,n),t.cm&&hs(t.cm,"beforeChange",t.cm,n),n.canceled?null:{from:n.from,to:n.to,text:n.text,origin:n.origin}}function so(t,e,o){if(t.cm){if(!t.cm.curOp)return ce(t.cm,so)(t,e,o);if(t.cm.state.suppressEdits)return}if(!(ai(t,"beforeChange")||t.cm&&ai(t.cm,"beforeChange"))||(e=ro(t,e,!0))){var n=mr&&!o&&Go(t,e.from,e.to);if(n)for(var i=n.length-1;i>=0;--i)ao(t,{from:n[i].from,to:n[i].to,text:i?[""]:e.text});else ao(t,e)}}function ao(t,e){if(1!=e.text.length||""!=e.text[0]||0!=_r(e.from,e.to)){var o=oo(t,e);Vn(t,e,o,t.cm?t.cm.curOp.id:NaN),uo(t,e,o,Fo(t,e));var n=[];In(t,function(t,o){o||-1!=pi(n,t.history)||(Zn(t.history,e),n.push(t.history)),uo(t,e,null,Fo(t,e))})}}function lo(t,e,o){if(!t.cm||!t.cm.state.suppressEdits){for(var n,i=t.history,r=t.sel,s="undo"==e?i.done:i.undone,a="undo"==e?i.undone:i.done,l=0;l<s.length&&(n=s[l],o?!n.ranges||n.equals(t.sel):n.ranges);l++);if(l!=s.length){for(i.lastOrigin=i.lastSelOrigin=null;n=s.pop(),n.ranges;){if(qn(n,a),o&&!n.equals(t.sel))return void ut(t,n,{clearRedo:!1});r=n}var c=[];qn(r,a),a.push({changes:c,generation:i.generation}),i.generation=n.generation||++i.maxGeneration;for(var u=ai(t,"beforeChange")||t.cm&&ai(t.cm,"beforeChange"),l=n.changes.length-1;l>=0;--l){var h=n.changes[l];if(h.origin=e,u&&!ro(t,h,!1))return void(s.length=0);c.push(Hn(t,h));var g=l?oo(t,h):gi(s);uo(t,h,g,Uo(t,h)),!l&&t.cm&&t.cm.scrollIntoView({from:h.from,to:Lr(h)});var p=[];In(t,function(t,e){e||-1!=pi(p,t.history)||(Zn(t.history,h),p.push(t.history)),uo(t,h,null,Uo(t,h))})}}}}function co(t,e){if(0!=e&&(t.first+=e,t.sel=new Y(di(t.sel.ranges,function(t){return new K(vr(t.anchor.line+e,t.anchor.ch),vr(t.head.line+e,t.head.ch))}),t.sel.primIndex),t.cm)){de(t.cm,t.first,t.first-e,e);for(var o=t.cm.display,n=o.viewFrom;n<o.viewTo;n++)fe(t.cm,n,"gutter")}}function uo(t,e,o,n){if(t.cm&&!t.cm.curOp)return ce(t.cm,uo)(t,e,o,n);if(e.to.line<t.first)return void co(t,e.text.length-1-(e.to.line-e.from.line));if(!(e.from.line>t.lastLine())){if(e.from.line<t.first){var i=e.text.length-1-(t.first-e.from.line);co(t,i),e={from:vr(t.first,0),to:vr(e.to.line+i,e.to.ch),text:[gi(e.text)],origin:e.origin}}var r=t.lastLine();e.to.line>r&&(e={from:e.from,to:vr(r,Mn(t,r).text.length),text:[e.text[0]],origin:e.origin}),e.removed=Ln(t,e.from,e.to),o||(o=oo(t,e)),t.cm?ho(t.cm,e,n):Cn(t,e,n),ht(t,o,fs)}}function ho(t,e,o){var n=t.doc,i=t.display,s=e.from,a=e.to,l=!1,c=s.line;t.options.lineWrapping||(c=Dn(Jo(Mn(n,s.line))),n.iter(c,a.line+1,function(t){return t==i.maxLine?(l=!0,!0):void 0})),n.sel.contains(e.from,e.to)>-1&&si(t),Cn(n,e,o,r(t)),t.options.lineWrapping||(n.iter(c,s.line+e.text.length,function(t){var e=g(t);e>i.maxLineLength&&(i.maxLine=t,i.maxLineLength=e,i.maxLineChanged=!0,l=!1)}),l&&(t.curOp.updateMaxLine=!0)),n.frontier=Math.min(n.frontier,s.line),xt(t,400);var u=e.text.length-(a.line-s.line)-1;s.line!=a.line||1!=e.text.length||wn(t.doc,e)?de(t,s.line,a.line+1,u):fe(t,s.line,"text");var h=ai(t,"changes"),p=ai(t,"change");if(p||h){var d={from:s,to:a,text:e.text,removed:e.removed,origin:e.origin};p&&ni(t,"change",t,d),h&&(t.curOp.changeObjs||(t.curOp.changeObjs=[])).push(d)}t.display.selForContextMenu=null}function go(t,e,o,n,i){if(n||(n=o),_r(n,o)<0){var r=n;n=o,o=r}"string"==typeof e&&(e=Bs(e)),so(t,{from:o,to:n,text:e,origin:i})}function po(t,e){var o=t.display,n=o.sizer.getBoundingClientRect(),i=null;if(e.top+n.top<0?i=!0:e.bottom+n.top>(window.innerHeight||document.documentElement.clientHeight)&&(i=!1),null!=i&&!lr){var r=Ei("div","",null,"position: absolute; top: "+(e.top-o.viewOffset-Ct(t.display))+"px; height: "+(e.bottom-e.top+ps)+"px; left: "+e.left+"px; width: 2px;");t.display.lineSpace.appendChild(r),r.scrollIntoView(i),t.display.lineSpace.removeChild(r)}}function fo(t,e,o,n){null==n&&(n=0);for(var i=0;5>i;i++){var r=!1,s=qt(t,e),a=o&&o!=e?qt(t,o):s,l=yo(t,Math.min(s.left,a.left),Math.min(s.top,a.top)-n,Math.max(s.left,a.left),Math.max(s.bottom,a.bottom)+n),c=t.doc.scrollTop,u=t.doc.scrollLeft;if(null!=l.scrollTop&&(He(t,l.scrollTop),Math.abs(t.doc.scrollTop-c)>1&&(r=!0)),null!=l.scrollLeft&&(Ue(t,l.scrollLeft),Math.abs(t.doc.scrollLeft-u)>1&&(r=!0)),!r)return s}}function mo(t,e,o,n,i){var r=yo(t,e,o,n,i);null!=r.scrollTop&&He(t,r.scrollTop),null!=r.scrollLeft&&Ue(t,r.scrollLeft)}function yo(t,e,o,n,i){var r=t.display,s=Qt(t.display);0>o&&(o=0);var a=t.curOp&&null!=t.curOp.scrollTop?t.curOp.scrollTop:r.scroller.scrollTop,l=r.scroller.clientHeight-ps,c={};i-o>l&&(i=o+l);var u=t.doc.height+kt(r),h=s>o,g=i>u-s;if(a>o)c.scrollTop=h?0:o;else if(i>a+l){var p=Math.min(o,(g?u:i)-l);p!=a&&(c.scrollTop=p)}var d=t.curOp&&null!=t.curOp.scrollLeft?t.curOp.scrollLeft:r.scroller.scrollLeft,f=r.scroller.clientWidth-ps-r.gutters.offsetWidth,m=n-e>f;return m&&(n=e+f),10>e?c.scrollLeft=0:d>e?c.scrollLeft=Math.max(0,e-(m?0:10)):n>f+d-3&&(c.scrollLeft=n+(m?0:10)-f),c}function vo(t,e,o){(null!=e||null!=o)&&bo(t),null!=e&&(t.curOp.scrollLeft=(null==t.curOp.scrollLeft?t.doc.scrollLeft:t.curOp.scrollLeft)+e),null!=o&&(t.curOp.scrollTop=(null==t.curOp.scrollTop?t.doc.scrollTop:t.curOp.scrollTop)+o)}function _o(t){bo(t);var e=t.getCursor(),o=e,n=e;t.options.lineWrapping||(o=e.ch?vr(e.line,e.ch-1):e,n=vr(e.line,e.ch+1)),t.curOp.scrollToPos={from:o,to:n,margin:t.options.cursorScrollMargin,isCursor:!0}}function bo(t){var e=t.curOp.scrollToPos;if(e){t.curOp.scrollToPos=null;var o=Xt(t,e.from),n=Xt(t,e.to),i=yo(t,Math.min(o.left,n.left),Math.min(o.top,n.top)-e.margin,Math.max(o.right,n.right),Math.max(o.bottom,n.bottom)+e.margin);t.scrollTo(i.scrollLeft,i.scrollTop)}}function Eo(t,e,o,n){var i,r=t.doc;null==o&&(o="add"),"smart"==o&&(r.mode.indent?i=wt(t,e):o="prev");var s=t.options.tabSize,a=Mn(r,e),l=vs(a.text,null,s);a.stateAfter&&(a.stateAfter=null);var c,u=a.text.match(/^\s*/)[0];if(n||/\S/.test(a.text)){if("smart"==o&&((c=r.mode.indent(i,a.text.slice(u.length),a.text))==ds||c>150)){if(!n)return;o="prev"}}else c=0,o="not";"prev"==o?c=e>r.first?vs(Mn(r,e-1).text,null,s):0:"add"==o?c=l+t.options.indentUnit:"subtract"==o?c=l-t.options.indentUnit:"number"==typeof o&&(c=l+o),c=Math.max(0,c);var h="",g=0;if(t.options.indentWithTabs)for(var p=Math.floor(c/s);p;--p)g+=s,h+="\t";if(c>g&&(h+=hi(c-g)),h!=u)go(r,h,vr(e,0),vr(e,u.length),"+input");else for(var p=0;p<r.sel.ranges.length;p++){var d=r.sel.ranges[p];if(d.head.line==e&&d.head.ch<u.length){var g=vr(e,u.length);st(r,p,new K(g,g));break}}a.stateAfter=null}function xo(t,e,o,n){var i=e,r=e;return"number"==typeof e?r=Mn(t,J(t,e)):i=Dn(e),null==i?null:(n(r,i)&&t.cm&&fe(t.cm,i,o),r)}function So(t,e){for(var o=t.doc.sel.ranges,n=[],i=0;i<o.length;i++){for(var r=e(o[i]);n.length&&_r(r.from,gi(n).to)<=0;){var s=n.pop();if(_r(s.from,r.from)<0){r.from=s.from;break}}n.push(r)}le(t,function(){for(var e=n.length-1;e>=0;e--)go(t.doc,"",n[e].from,n[e].to,"+delete");_o(t)})}function To(t,e,o,n,i){function r(){var e=a+o;return e<t.first||e>=t.first+t.size?h=!1:(a=e,u=Mn(t,e))}function s(t){var e=(i?Yi:Ki)(u,l,o,!0);if(null==e){if(t||!r())return h=!1;l=i?(0>o?Ui:Hi)(u):0>o?u.text.length:0}else l=e;return!0}var a=e.line,l=e.ch,c=o,u=Mn(t,a),h=!0;if("char"==n)s();else if("column"==n)s(!0);else if("word"==n||"group"==n)for(var g=null,p="group"==n,d=t.cm&&t.cm.getHelper(e,"wordChars"),f=!0;!(0>o)||s(!f);f=!1){var m=u.text.charAt(l)||"\n",y=vi(m,d)?"w":p&&"\n"==m?"n":!p||/\s/.test(m)?null:"p";if(!p||f||y||(y="s"),g&&g!=y){0>o&&(o=1,s());break}if(y&&(g=y),o>0&&!s(!f))break}var v=ft(t,vr(a,l),c,!0);return h||(v.hitSide=!0),v}function wo(t,e,o,n){var i,r=t.doc,s=e.left;if("page"==n){var a=Math.min(t.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);i=e.top+o*(a-(0>o?1.5:.5)*Qt(t.display))}else"line"==n&&(i=o>0?e.bottom+3:e.top-3);for(;;){var l=Kt(t,s,i);if(!l.outside)break;if(0>o?0>=i:i>=r.height){l.hitSide=!0;break}i+=5*o}return l}function Co(e,o,n,i){t.defaults[e]=o,n&&(Rr[e]=i?function(t,e,o){o!=Dr&&n(t,e,o)}:n)}function ko(t){return"string"==typeof t?Wr[t]:t}function Ao(t,e,o,n,i){if(n&&n.shared)return Io(t,e,o,n,i);if(t.cm&&!t.cm.curOp)return ce(t.cm,Ao)(t,e,o,n,i);var r=new Kr(t,i),s=_r(e,o);if(n&&mi(n,r,!1),s>0||0==s&&!1!==r.clearWhenEmpty)return r;if(r.replacedWith&&(r.collapsed=!0,r.widgetNode=Ei("span",[r.replacedWith],"CodeMirror-widget"),n.handleMouseEvents||(r.widgetNode.ignoreEvents=!0),n.insertLeft&&(r.widgetNode.insertLeft=!0)),r.collapsed){if(Qo(t,e.line,e,o,r)||e.line!=o.line&&Qo(t,o.line,e,o,r))throw new Error("Inserting collapsed marker partially overlapping an existing one");yr=!0}r.addToHistory&&Vn(t,{from:e,to:o,origin:"markText"},t.sel,NaN);var a,l=e.line,c=t.cm;if(t.iter(l,o.line+1,function(t){c&&r.collapsed&&!c.options.lineWrapping&&Jo(t)==c.display.maxLine&&(a=!0),r.collapsed&&l!=e.line&&Rn(t,0),Oo(t,new No(r,l==e.line?e.ch:null,l==o.line?o.ch:null)),++l}),r.collapsed&&t.iter(e.line,o.line+1,function(e){on(t,e)&&Rn(e,0)}),r.clearOnEnter&&cs(r,"beforeCursorEnter",function(){r.clear()}),r.readOnly&&(mr=!0,(t.history.done.length||t.history.undone.length)&&t.clearHistory()),r.collapsed&&(r.id=++$r,r.atomic=!0),c){if(a&&(c.curOp.updateMaxLine=!0),r.collapsed)de(c,e.line,o.line+1);else if(r.className||r.title||r.startStyle||r.endStyle)for(var u=e.line;u<=o.line;u++)fe(c,u,"text");r.atomic&&pt(c.doc),ni(c,"markerAdded",c,r)}return r}function Io(t,e,o,n,i){n=mi(n),n.shared=!1;var r=[Ao(t,e,o,n,i)],s=r[0],a=n.widgetNode;return In(t,function(t){a&&(n.widgetNode=a.cloneNode(!0)),r.push(Ao(t,Z(t,e),Z(t,o),n,i));for(var l=0;l<t.linked.length;++l)if(t.linked[l].isParent)return;s=gi(r)}),new Qr(r,s)}function Bo(t){return t.findMarks(vr(t.first,0),t.clipPos(vr(t.lastLine())),function(t){return t.parent})}function Mo(t,e){for(var o=0;o<e.length;o++){var n=e[o],i=n.find(),r=t.clipPos(i.from),s=t.clipPos(i.to);if(_r(r,s)){var a=Ao(t,r,s,n.primary,n.primary.type);n.markers.push(a),a.parent=n}}}function Lo(t){for(var e=0;e<t.length;e++){var o=t[e],n=[o.primary.doc];In(o.primary.doc,function(t){n.push(t)});for(var i=0;i<o.markers.length;i++){var r=o.markers[i];-1==pi(n,r.doc)&&(r.parent=null,o.markers.splice(i--,1))}}}function No(t,e,o){this.marker=t,this.from=e,this.to=o}function Ro(t,e){if(t)for(var o=0;o<t.length;++o){var n=t[o];if(n.marker==e)return n}}function Do(t,e){for(var o,n=0;n<t.length;++n)t[n]!=e&&(o||(o=[])).push(t[n]);return o}function Oo(t,e){t.markedSpans=t.markedSpans?t.markedSpans.concat([e]):[e],e.marker.attachLine(t)}function Po(t,e,o){if(t)for(var n,i=0;i<t.length;++i){var r=t[i],s=r.marker,a=null==r.from||(s.inclusiveLeft?r.from<=e:r.from<e);if(a||r.from==e&&"bookmark"==s.type&&(!o||!r.marker.insertLeft)){var l=null==r.to||(s.inclusiveRight?r.to>=e:r.to>e);(n||(n=[])).push(new No(s,r.from,l?null:r.to))}}return n}function jo(t,e,o){if(t)for(var n,i=0;i<t.length;++i){var r=t[i],s=r.marker,a=null==r.to||(s.inclusiveRight?r.to>=e:r.to>e);if(a||r.from==e&&"bookmark"==s.type&&(!o||r.marker.insertLeft)){var l=null==r.from||(s.inclusiveLeft?r.from<=e:r.from<e);(n||(n=[])).push(new No(s,l?null:r.from-e,null==r.to?null:r.to-e))}}return n}function Fo(t,e){var o=et(t,e.from.line)&&Mn(t,e.from.line).markedSpans,n=et(t,e.to.line)&&Mn(t,e.to.line).markedSpans;if(!o&&!n)return null;var i=e.from.ch,r=e.to.ch,s=0==_r(e.from,e.to),a=Po(o,i,s),l=jo(n,r,s),c=1==e.text.length,u=gi(e.text).length+(c?i:0);if(a)for(var h=0;h<a.length;++h){var g=a[h];if(null==g.to){var p=Ro(l,g.marker);p?c&&(g.to=null==p.to?null:p.to+u):g.to=i}}if(l)for(var h=0;h<l.length;++h){var g=l[h];if(null!=g.to&&(g.to+=u),null==g.from){var p=Ro(a,g.marker);p||(g.from=u,c&&(a||(a=[])).push(g))}else g.from+=u,c&&(a||(a=[])).push(g)}a&&(a=Ho(a)),l&&l!=a&&(l=Ho(l));var d=[a];if(!c){var f,m=e.text.length-2;if(m>0&&a)for(var h=0;h<a.length;++h)null==a[h].to&&(f||(f=[])).push(new No(a[h].marker,null,null));for(var h=0;m>h;++h)d.push(f);d.push(l)}return d}function Ho(t){for(var e=0;e<t.length;++e){var o=t[e];null!=o.from&&o.from==o.to&&!1!==o.marker.clearWhenEmpty&&t.splice(e--,1)}return t.length?t:null}function Uo(t,e){var o=Kn(t,e),n=Fo(t,e);if(!o)return n;if(!n)return o;for(var i=0;i<o.length;++i){var r=o[i],s=n[i];if(r&&s)t:for(var a=0;a<s.length;++a){for(var l=s[a],c=0;c<r.length;++c)if(r[c].marker==l.marker)continue t;r.push(l)}else s&&(o[i]=s)}return o}function Go(t,e,o){var n=null;if(t.iter(e.line,o.line+1,function(t){if(t.markedSpans)for(var e=0;e<t.markedSpans.length;++e){var o=t.markedSpans[e].marker;!o.readOnly||n&&-1!=pi(n,o)||(n||(n=[])).push(o)}}),!n)return null;for(var i=[{from:e,to:o}],r=0;r<n.length;++r)for(var s=n[r],a=s.find(0),l=0;l<i.length;++l){var c=i[l];if(!(_r(c.to,a.from)<0||_r(c.from,a.to)>0)){var u=[l,1],h=_r(c.from,a.from),g=_r(c.to,a.to);(0>h||!s.inclusiveLeft&&!h)&&u.push({from:c.from,to:a.from}),(g>0||!s.inclusiveRight&&!g)&&u.push({from:a.to,to:c.to}),i.splice.apply(i,u),l+=u.length-1}}return i}function Vo(t){var e=t.markedSpans;if(e){for(var o=0;o<e.length;++o)e[o].marker.detachLine(t);t.markedSpans=null}}function Wo(t,e){if(e){for(var o=0;o<e.length;++o)e[o].marker.attachLine(t);t.markedSpans=e}}function zo(t){return t.inclusiveLeft?-1:0}function qo(t){return t.inclusiveRight?1:0}function Xo(t,e){var o=t.lines.length-e.lines.length;if(0!=o)return o;var n=t.find(),i=e.find(),r=_r(n.from,i.from)||zo(t)-zo(e);if(r)return-r;var s=_r(n.to,i.to)||qo(t)-qo(e);return s||e.id-t.id}function Yo(t,e){var o,n=yr&&t.markedSpans;if(n)for(var i,r=0;r<n.length;++r)i=n[r],i.marker.collapsed&&null==(e?i.from:i.to)&&(!o||Xo(o,i.marker)<0)&&(o=i.marker);return o}function Ko(t){return Yo(t,!0)}function $o(t){return Yo(t,!1)}function Qo(t,e,o,n,i){var r=Mn(t,e),s=yr&&r.markedSpans;if(s)for(var a=0;a<s.length;++a){var l=s[a];if(l.marker.collapsed){var c=l.marker.find(0),u=_r(c.from,o)||zo(l.marker)-zo(i),h=_r(c.to,n)||qo(l.marker)-qo(i);if(!(u>=0&&0>=h||0>=u&&h>=0)&&(0>=u&&(_r(c.to,o)>0||l.marker.inclusiveRight&&i.inclusiveLeft)||u>=0&&(_r(c.from,n)<0||l.marker.inclusiveLeft&&i.inclusiveRight)))return!0}}}function Jo(t){for(var e;e=Ko(t);)t=e.find(-1,!0).line;return t}function Zo(t){for(var e,o;e=$o(t);)t=e.find(1,!0).line,(o||(o=[])).push(t);return o}function tn(t,e){var o=Mn(t,e),n=Jo(o);return o==n?e:Dn(n)}function en(t,e){if(e>t.lastLine())return e;var o,n=Mn(t,e);if(!on(t,n))return e;for(;o=$o(n);)n=o.find(1,!0).line;return Dn(n)+1}function on(t,e){var o=yr&&e.markedSpans;if(o)for(var n,i=0;i<o.length;++i)if(n=o[i],n.marker.collapsed){if(null==n.from)return!0;if(!n.marker.widgetNode&&0==n.from&&n.marker.inclusiveLeft&&nn(t,e,n))return!0}}function nn(t,e,o){if(null==o.to){var n=o.marker.find(1,!0);return nn(t,n.line,Ro(n.line.markedSpans,o.marker))}if(o.marker.inclusiveRight&&o.to==e.text.length)return!0;for(var i,r=0;r<e.markedSpans.length;++r)if(i=e.markedSpans[r],i.marker.collapsed&&!i.marker.widgetNode&&i.from==o.to&&(null==i.to||i.to!=o.from)&&(i.marker.inclusiveLeft||o.marker.inclusiveRight)&&nn(t,e,i))return!0}function rn(t,e,o){Pn(e)<(t.curOp&&t.curOp.scrollTop||t.doc.scrollTop)&&vo(t,null,o)}function sn(t){if(null!=t.height)return t.height;if(!Ti(document.body,t.node)){var e="position: relative;";t.coverGutter&&(e+="margin-left: -"+t.cm.getGutterElement().offsetWidth+"px;"),Si(t.cm.display.measure,Ei("div",[t.node],null,e))}return t.height=t.node.offsetHeight}function an(t,e,o,n){var i=new Jr(t,o,n);return i.noHScroll&&(t.display.alignWidgets=!0),xo(t.doc,e,"widget",function(e){var o=e.widgets||(e.widgets=[]);if(null==i.insertAt?o.push(i):o.splice(Math.min(o.length-1,Math.max(0,i.insertAt)),0,i),i.line=e,!on(t.doc,e)){var n=Pn(e)<t.doc.scrollTop;Rn(e,e.height+sn(i)),n&&vo(t,null,i.height),t.curOp.forceUpdate=!0}return!0}),i}function ln(t,e,o,n){t.text=e,t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null),null!=t.order&&(t.order=null),Vo(t),Wo(t,o);var i=n?n(t):1;i!=t.height&&Rn(t,i)}function cn(t){t.parent=null,Vo(t)}function un(t,e){if(t)for(;;){var o=t.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!o)break;t=t.slice(0,o.index)+t.slice(o.index+o[0].length);var n=o[1]?"bgClass":"textClass";null==e[n]?e[n]=o[2]:new RegExp("(?:^|s)"+o[2]+"(?:$|s)").test(e[n])||(e[n]+=" "+o[2])}return t}function hn(e,o){if(e.blankLine)return e.blankLine(o);if(e.innerMode){var n=t.innerMode(e,o);return n.mode.blankLine?n.mode.blankLine(n.state):void 0}}function gn(t,e,o){for(var n=0;10>n;n++){var i=t.token(e,o);if(e.pos>e.start)return i}throw new Error("Mode "+t.name+" failed to advance stream.")}function pn(e,o,n,i,r,s,a){var l=n.flattenSpans;null==l&&(l=e.options.flattenSpans);var c,u=0,h=null,g=new Yr(o,e.options.tabSize);for(""==o&&un(hn(n,i),s);!g.eol();){if(g.pos>e.options.maxHighlightLength?(l=!1,a&&mn(e,o,i,g.pos),g.pos=o.length,c=null):c=un(gn(n,g,i),s),e.options.addModeClass){var p=t.innerMode(n,i).mode.name;p&&(c="m-"+(c?p+" "+c:p))}l&&h==c||(u<g.start&&r(g.start,h),u=g.start,h=c),g.start=g.pos}for(;u<g.pos;){var d=Math.min(g.pos,u+5e4);r(d,h),u=d}}function dn(t,e,o,n){var i=[t.state.modeGen],r={};pn(t,e.text,t.doc.mode,o,function(t,e){i.push(t,e)},r,n);for(var s=0;s<t.state.overlays.length;++s){var a=t.state.overlays[s],l=1,c=0;pn(t,e.text,a.mode,!0,function(t,e){for(var o=l;t>c;){var n=i[l];n>t&&i.splice(l,1,t,i[l+1],n),l+=2,c=Math.min(t,n)}if(e)if(a.opaque)i.splice(o,l-o,t,"cm-overlay "+e),l=o+2;else for(;l>o;o+=2){var r=i[o+1];i[o+1]=(r?r+" ":"")+"cm-overlay "+e}},r)}return{styles:i,classes:r.bgClass||r.textClass?r:null}}function fn(t,e){if(!e.styles||e.styles[0]!=t.state.modeGen){var o=dn(t,e,e.stateAfter=wt(t,Dn(e)));e.styles=o.styles,o.classes?e.styleClasses=o.classes:e.styleClasses&&(e.styleClasses=null)}return e.styles}function mn(t,e,o,n){var i=t.doc.mode,r=new Yr(e,t.options.tabSize);for(r.start=r.pos=n||0,""==e&&hn(i,o);!r.eol()&&r.pos<=t.options.maxHighlightLength;)gn(i,r,o),r.start=r.pos}function yn(t,e){if(!t||/^\s*$/.test(t))return null;var o=e.addModeClass?es:ts;return o[t]||(o[t]=t.replace(/\S+/g,"cm-$&"))}function vn(t,e){var o=Ei("span",null,null,er?"padding-right: .1px":null),n={pre:Ei("pre",[o]),content:o,col:0,pos:0,cm:t};e.measure={};for(var i=0;i<=(e.rest?e.rest.length:0);i++){var r,s=i?e.rest[i-1]:e.line;n.pos=0,n.addToken=bn,(Zi||er)&&t.getOption("lineWrapping")&&(n.addToken=En(n.addToken)),Di(t.display.measure)&&(r=jn(s))&&(n.addToken=xn(n.addToken,r)),n.map=[],Tn(s,n,fn(t,s)),s.styleClasses&&(s.styleClasses.bgClass&&(n.bgClass=Ii(s.styleClasses.bgClass,n.bgClass||"")),s.styleClasses.textClass&&(n.textClass=Ii(s.styleClasses.textClass,n.textClass||""))),0==n.map.length&&n.map.push(0,0,n.content.appendChild(Ri(t.display.measure))),0==i?(e.measure.map=n.map,e.measure.cache={}):((e.measure.maps||(e.measure.maps=[])).push(n.map),(e.measure.caches||(e.measure.caches=[])).push({}))}return hs(t,"renderLine",t,e.line,n.pre),n.pre.className&&(n.textClass=Ii(n.pre.className,n.textClass||"")),n}function _n(t){var e=Ei("span","","cm-invalidchar");return e.title="\\u"+t.charCodeAt(0).toString(16),e}function bn(t,e,o,n,i,r){if(e){var s=t.cm.options.specialChars,a=!1;if(s.test(e))for(var l=document.createDocumentFragment(),c=0;;){s.lastIndex=c;var u=s.exec(e),h=u?u.index-c:e.length-c;if(h){var g=document.createTextNode(e.slice(c,c+h));Zi&&9>tr?l.appendChild(Ei("span",[g])):l.appendChild(g),t.map.push(t.pos,t.pos+h,g),t.col+=h,t.pos+=h}if(!u)break;if(c+=h+1,"\t"==u[0]){var p=t.cm.options.tabSize,d=p-t.col%p,g=l.appendChild(Ei("span",hi(d),"cm-tab"));t.col+=d}else{var g=t.cm.options.specialCharPlaceholder(u[0]);Zi&&9>tr?l.appendChild(Ei("span",[g])):l.appendChild(g),t.col+=1}t.map.push(t.pos,t.pos+1,g),t.pos++}else{t.col+=e.length;var l=document.createTextNode(e);t.map.push(t.pos,t.pos+e.length,l),Zi&&9>tr&&(a=!0),t.pos+=e.length}if(o||n||i||a){var f=o||"";n&&(f+=n),i&&(f+=i);var m=Ei("span",[l],f);return r&&(m.title=r),t.content.appendChild(m)}t.content.appendChild(l)}}function En(t){function e(t){for(var e=" ",o=0;o<t.length-2;++o)e+=o%2?" ":"";return e+=" "}return function(o,n,i,r,s,a){t(o,n.replace(/ {3,}/g,e),i,r,s,a)}}function xn(t,e){return function(o,n,i,r,s,a){i=i?i+" cm-force-border":"cm-force-border";for(var l=o.pos,c=l+n.length;;){for(var u=0;u<e.length;u++){var h=e[u];if(h.to>l&&h.from<=l)break}if(h.to>=c)return t(o,n,i,r,s,a);t(o,n.slice(0,h.to-l),i,r,null,a),r=null,n=n.slice(h.to-l),l=h.to}}}function Sn(t,e,o,n){var i=!n&&o.widgetNode;i&&(t.map.push(t.pos,t.pos+e,i),t.content.appendChild(i)),t.pos+=e}function Tn(t,e,o){var n=t.markedSpans,i=t.text,r=0;if(n)for(var s,a,l,c,u,h,g=i.length,p=0,d=1,f="",m=0;;){if(m==p){a=l=c=u="",h=null,m=1/0;for(var y=[],v=0;v<n.length;++v){var _=n[v],b=_.marker;_.from<=p&&(null==_.to||_.to>p)?(null!=_.to&&m>_.to&&(m=_.to,l=""),b.className&&(a+=" "+b.className),b.startStyle&&_.from==p&&(c+=" "+b.startStyle),b.endStyle&&_.to==m&&(l+=" "+b.endStyle),b.title&&!u&&(u=b.title),b.collapsed&&(!h||Xo(h.marker,b)<0)&&(h=_)):_.from>p&&m>_.from&&(m=_.from),"bookmark"==b.type&&_.from==p&&b.widgetNode&&y.push(b)}if(h&&(h.from||0)==p&&(Sn(e,(null==h.to?g+1:h.to)-p,h.marker,null==h.from),null==h.to))return;if(!h&&y.length)for(var v=0;v<y.length;++v)Sn(e,0,y[v])}if(p>=g)break;for(var E=Math.min(g,m);;){if(f){var x=p+f.length;if(!h){var S=x>E?f.slice(0,E-p):f;e.addToken(e,S,s?s+a:a,c,p+S.length==m?l:"",u)}if(x>=E){f=f.slice(E-p),p=E;break}p=x,c=""}f=i.slice(r,r=o[d++]),s=yn(o[d++],e.cm.options)}}else for(var d=1;d<o.length;d+=2)e.addToken(e,i.slice(r,r=o[d]),yn(o[d+1],e.cm.options))}function wn(t,e){return 0==e.from.ch&&0==e.to.ch&&""==gi(e.text)&&(!t.cm||t.cm.options.wholeLineUpdateBefore)}function Cn(t,e,o,n){function i(t){return o?o[t]:null}function r(t,o,i){ln(t,o,i,n),ni(t,"change",t,e)}var s=e.from,a=e.to,l=e.text,c=Mn(t,s.line),u=Mn(t,a.line),h=gi(l),g=i(l.length-1),p=a.line-s.line;if(wn(t,e)){for(var d=0,f=[];d<l.length-1;++d)f.push(new Zr(l[d],i(d),n));r(u,u.text,g),p&&t.remove(s.line,p),f.length&&t.insert(s.line,f)}else if(c==u)if(1==l.length)r(c,c.text.slice(0,s.ch)+h+c.text.slice(a.ch),g);else{for(var f=[],d=1;d<l.length-1;++d)f.push(new Zr(l[d],i(d),n));f.push(new Zr(h+c.text.slice(a.ch),g,n)),r(c,c.text.slice(0,s.ch)+l[0],i(0)),t.insert(s.line+1,f)}else if(1==l.length)r(c,c.text.slice(0,s.ch)+l[0]+u.text.slice(a.ch),i(0)),t.remove(s.line+1,p);else{r(c,c.text.slice(0,s.ch)+l[0],i(0)),r(u,h+u.text.slice(a.ch),g);for(var d=1,f=[];d<l.length-1;++d)f.push(new Zr(l[d],i(d),n));p>1&&t.remove(s.line+1,p-1),t.insert(s.line+1,f)}ni(t,"change",t,e)}function kn(t){this.lines=t,this.parent=null;for(var e=0,o=0;e<t.length;++e)t[e].parent=this,o+=t[e].height;this.height=o}function An(t){this.children=t;for(var e=0,o=0,n=0;n<t.length;++n){var i=t[n];e+=i.chunkSize(),o+=i.height,i.parent=this}this.size=e,this.height=o,this.parent=null}function In(t,e,o){function n(t,i,r){if(t.linked)for(var s=0;s<t.linked.length;++s){var a=t.linked[s];if(a.doc!=i){var l=r&&a.sharedHist;(!o||l)&&(e(a.doc,l),n(a.doc,t,l))}}}n(t,null,!0)}function Bn(t,e){if(e.cm)throw new Error("This document is already in use.");t.doc=e,e.cm=t,s(t),o(t),t.options.lineWrapping||p(t),t.options.mode=e.modeOption,de(t)}function Mn(t,e){if(0>(e-=t.first)||e>=t.size)throw new Error("There is no line "+(e+t.first)+" in the document.");for(var o=t;!o.lines;)for(var n=0;;++n){var i=o.children[n],r=i.chunkSize();if(r>e){o=i;break}e-=r}return o.lines[e]}function Ln(t,e,o){var n=[],i=e.line;return t.iter(e.line,o.line+1,function(t){var r=t.text;i==o.line&&(r=r.slice(0,o.ch)),i==e.line&&(r=r.slice(e.ch)),n.push(r),++i}),n}function Nn(t,e,o){var n=[];return t.iter(e,o,function(t){n.push(t.text)}),n}function Rn(t,e){var o=e-t.height;if(o)for(var n=t;n;n=n.parent)n.height+=o}function Dn(t){if(null==t.parent)return null;for(var e=t.parent,o=pi(e.lines,t),n=e.parent;n;e=n,n=n.parent)for(var i=0;n.children[i]!=e;++i)o+=n.children[i].chunkSize();return o+e.first}function On(t,e){var o=t.first;t:do{for(var n=0;n<t.children.length;++n){var i=t.children[n],r=i.height;if(r>e){t=i;continue t}e-=r,o+=i.chunkSize()}return o}while(!t.lines);for(var n=0;n<t.lines.length;++n){var s=t.lines[n],a=s.height;if(a>e)break;e-=a}return o+n}function Pn(t){t=Jo(t);for(var e=0,o=t.parent,n=0;n<o.lines.length;++n){var i=o.lines[n];if(i==t)break;e+=i.height}for(var r=o.parent;r;o=r,r=o.parent)for(var n=0;n<r.children.length;++n){var s=r.children[n];if(s==o)break;e+=s.height}return e}function jn(t){var e=t.order;return null==e&&(e=t.order=Os(t.text)),e}function Fn(t){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=t||1}function Hn(t,e){var o={from:z(e.from),to:Lr(e),text:Ln(t,e.from,e.to)};return Xn(t,o,e.from.line,e.to.line+1),In(t,function(t){Xn(t,o,e.from.line,e.to.line+1)},!0),o}function Un(t){for(;t.length;){if(!gi(t).ranges)break;t.pop()}}function Gn(t,e){return e?(Un(t.done),gi(t.done)):t.done.length&&!gi(t.done).ranges?gi(t.done):t.done.length>1&&!t.done[t.done.length-2].ranges?(t.done.pop(),gi(t.done)):void 0}function Vn(t,e,o,n){var i=t.history;i.undone.length=0;var r,s=+new Date;if((i.lastOp==n||i.lastOrigin==e.origin&&e.origin&&("+"==e.origin.charAt(0)&&t.cm&&i.lastModTime>s-t.cm.options.historyEventDelay||"*"==e.origin.charAt(0)))&&(r=Gn(i,i.lastOp==n))){var a=gi(r.changes);0==_r(e.from,e.to)&&0==_r(e.from,a.to)?a.to=Lr(e):r.changes.push(Hn(t,e))}else{var l=gi(i.done);for(l&&l.ranges||qn(t.sel,i.done),r={changes:[Hn(t,e)],generation:i.generation},i.done.push(r);i.done.length>i.undoDepth;)i.done.shift(),i.done[0].ranges||i.done.shift()}i.done.push(o),i.generation=++i.maxGeneration,i.lastModTime=i.lastSelTime=s,i.lastOp=i.lastSelOp=n,i.lastOrigin=i.lastSelOrigin=e.origin,a||hs(t,"historyAdded")}function Wn(t,e,o,n){var i=e.charAt(0);return"*"==i||"+"==i&&o.ranges.length==n.ranges.length&&o.somethingSelected()==n.somethingSelected()&&new Date-t.history.lastSelTime<=(t.cm?t.cm.options.historyEventDelay:500)}function zn(t,e,o,n){var i=t.history,r=n&&n.origin;o==i.lastSelOp||r&&i.lastSelOrigin==r&&(i.lastModTime==i.lastSelTime&&i.lastOrigin==r||Wn(t,r,gi(i.done),e))?i.done[i.done.length-1]=e:qn(e,i.done),i.lastSelTime=+new Date,i.lastSelOrigin=r,i.lastSelOp=o,n&&!1!==n.clearRedo&&Un(i.undone)}function qn(t,e){var o=gi(e);o&&o.ranges&&o.equals(t)||e.push(t)}function Xn(t,e,o,n){var i=e["spans_"+t.id],r=0;t.iter(Math.max(t.first,o),Math.min(t.first+t.size,n),function(o){o.markedSpans&&((i||(i=e["spans_"+t.id]={}))[r]=o.markedSpans),++r})}function Yn(t){if(!t)return null;for(var e,o=0;o<t.length;++o)t[o].marker.explicitlyCleared?e||(e=t.slice(0,o)):e&&e.push(t[o]);return e?e.length?e:null:t}function Kn(t,e){var o=e["spans_"+t.id];if(!o)return null;for(var n=0,i=[];n<e.text.length;++n)i.push(Yn(o[n]));return i}function $n(t,e,o){for(var n=0,i=[];n<t.length;++n){var r=t[n];if(r.ranges)i.push(o?Y.prototype.deepCopy.call(r):r);else{var s=r.changes,a=[];i.push({changes:a});for(var l=0;l<s.length;++l){var c,u=s[l];if(a.push({from:u.from,to:u.to,text:u.text}),e)for(var h in u)(c=h.match(/^spans_(\d+)$/))&&pi(e,Number(c[1]))>-1&&(gi(a)[h]=u[h],delete u[h])}}}return i}function Qn(t,e,o,n){o<t.line?t.line+=n:e<t.line&&(t.line=e,t.ch=0)}function Jn(t,e,o,n){for(var i=0;i<t.length;++i){var r=t[i],s=!0;if(r.ranges){r.copied||(r=t[i]=r.deepCopy(),r.copied=!0);for(var a=0;a<r.ranges.length;a++)Qn(r.ranges[a].anchor,e,o,n),Qn(r.ranges[a].head,e,o,n)}else{for(var a=0;a<r.changes.length;++a){var l=r.changes[a];if(o<l.from.line)l.from=vr(l.from.line+n,l.from.ch),l.to=vr(l.to.line+n,l.to.ch);else if(e<=l.to.line){s=!1;break}}s||(t.splice(0,i+1),i=0)}}}function Zn(t,e){var o=e.from.line,n=e.to.line,i=e.text.length-(n-o)-1;Jn(t.done,o,n,i),Jn(t.undone,o,n,i)}function ti(t){return null!=t.defaultPrevented?t.defaultPrevented:0==t.returnValue}function ei(t){return t.target||t.srcElement}function oi(t){var e=t.which;return null==e&&(1&t.button?e=1:2&t.button?e=3:4&t.button&&(e=2)),hr&&t.ctrlKey&&1==e&&(e=3),e}function ni(t,e){var o=t._handlers&&t._handlers[e];if(o){var n,i=Array.prototype.slice.call(arguments,2);Tr?n=Tr.delayedCallbacks:gs?n=gs:(n=gs=[],setTimeout(ii,0));for(var r=0;r<o.length;++r)n.push(function(t){return function(){t.apply(null,i)}}(o[r]))}}function ii(){var t=gs;gs=null;for(var e=0;e<t.length;++e)t[e]()}function ri(t,e,o){return hs(t,o||e.type,t,e),ti(e)||e.codemirrorIgnore}function si(t){var e=t._handlers&&t._handlers.cursorActivity;if(e)for(var o=t.curOp.cursorActivityHandlers||(t.curOp.cursorActivityHandlers=[]),n=0;n<e.length;++n)-1==pi(o,e[n])&&o.push(e[n])}function ai(t,e){var o=t._handlers&&t._handlers[e];return o&&o.length>0}function li(t){t.prototype.on=function(t,e){cs(this,t,e)},t.prototype.off=function(t,e){us(this,t,e)}}function ci(){this.id=null}function ui(t,e,o){for(var n=0,i=0;;){var r=t.indexOf("\t",n);-1==r&&(r=t.length);var s=r-n;if(r==t.length||i+s>=e)return n+Math.min(s,e-i);if(i+=r-n,i+=o-i%o,n=r+1,i>=e)return n}}function hi(t){for(;_s.length<=t;)_s.push(gi(_s)+" ");return _s[t]}function gi(t){return t[t.length-1]}function pi(t,e){for(var o=0;o<t.length;++o)if(t[o]==e)return o;return-1}function di(t,e){for(var o=[],n=0;n<t.length;n++)o[n]=e(t[n],n);return o}function fi(t,e){var o;if(Object.create)o=Object.create(t);else{var n=function(){};n.prototype=t,o=new n}return e&&mi(e,o),o}function mi(t,e,o){e||(e={});for(var n in t)!t.hasOwnProperty(n)||!1===o&&e.hasOwnProperty(n)||(e[n]=t[n]);return e}function yi(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e)}}function vi(t,e){return e?!!(e.source.indexOf("\\w")>-1&&Ss(t))||e.test(t):Ss(t)}function _i(t){for(var e in t)if(t.hasOwnProperty(e)&&t[e])return!1;return!0}function bi(t){return t.charCodeAt(0)>=768&&Ts.test(t)}function Ei(t,e,o,n){var i=document.createElement(t);if(o&&(i.className=o),n&&(i.style.cssText=n),"string"==typeof e)i.appendChild(document.createTextNode(e));else if(e)for(var r=0;r<e.length;++r)i.appendChild(e[r]);return i}function xi(t){for(var e=t.childNodes.length;e>0;--e)t.removeChild(t.firstChild);return t}function Si(t,e){return xi(t).appendChild(e)}function Ti(t,e){if(t.contains)return t.contains(e);for(;e=e.parentNode;)if(e==t)return!0}function wi(){return document.activeElement}function Ci(t){return new RegExp("\\b"+t+"\\b\\s*")}function ki(t,e){var o=Ci(e);o.test(t.className)&&(t.className=t.className.replace(o,""))}function Ai(t,e){Ci(e).test(t.className)||(t.className+=" "+e)}function Ii(t,e){for(var o=t.split(" "),n=0;n<o.length;n++)o[n]&&!Ci(o[n]).test(e)&&(e+=" "+o[n]);return e}function Bi(t){if(document.body.getElementsByClassName)for(var e=document.body.getElementsByClassName("CodeMirror"),o=0;o<e.length;o++){var n=e[o].CodeMirror;n&&t(n)}}function Mi(){As||(Li(),As=!0)}function Li(){var t;cs(window,"resize",function(){null==t&&(t=setTimeout(function(){t=null,ws=null,Bi(Ie)},100))}),cs(window,"blur",function(){Bi(Je)})}function Ni(t){if(null!=ws)return ws;var e=Ei("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");return Si(t,e),e.offsetWidth&&(ws=e.offsetHeight-e.clientHeight),ws||0}function Ri(t){if(null==Cs){var e=Ei("span","");Si(t,Ei("span",[e,document.createTextNode("x")])),0!=t.firstChild.offsetHeight&&(Cs=e.offsetWidth<=1&&e.offsetHeight>2&&!(Zi&&8>tr))}return Cs?Ei("span",""):Ei("span","",null,"display: inline-block; width: 1px; margin-right: -1px")}function Di(t){if(null!=ks)return ks;var e=Si(t,document.createTextNode("AA")),o=Es(e,0,1).getBoundingClientRect();if(!o||o.left==o.right)return!1;var n=Es(e,1,2).getBoundingClientRect();return ks=n.right-o.right<3}function Oi(t){if(null!=Ns)return Ns;var e=Si(t,Ei("span","x")),o=e.getBoundingClientRect(),n=Es(e,0,1).getBoundingClientRect();return Ns=Math.abs(o.left-n.left)>1}function Pi(t,e,o,n){if(!t)return n(e,o,"ltr");for(var i=!1,r=0;r<t.length;++r){var s=t[r];(s.from<o&&s.to>e||e==o&&s.to==e)&&(n(Math.max(s.from,e),Math.min(s.to,o),1==s.level?"rtl":"ltr"),i=!0)}i||n(e,o,"ltr")}function ji(t){return t.level%2?t.to:t.from}function Fi(t){return t.level%2?t.from:t.to}function Hi(t){var e=jn(t);return e?ji(e[0]):0}function Ui(t){var e=jn(t);return e?Fi(gi(e)):t.text.length}function Gi(t,e){var o=Mn(t.doc,e),n=Jo(o);n!=o&&(e=Dn(n));var i=jn(n),r=i?i[0].level%2?Ui(n):Hi(n):0;return vr(e,r)}function Vi(t,e){for(var o,n=Mn(t.doc,e);o=$o(n);)n=o.find(1,!0).line,e=null;var i=jn(n),r=i?i[0].level%2?Hi(n):Ui(n):n.text.length;return vr(null==e?Dn(n):e,r)}function Wi(t,e){var o=Gi(t,e.line),n=Mn(t.doc,o.line),i=jn(n);if(!i||0==i[0].level){var r=Math.max(0,n.text.search(/\S/)),s=e.line==o.line&&e.ch<=r&&e.ch;return vr(o.line,s?0:r)}return o}function zi(t,e,o){var n=t[0].level;return e==n||o!=n&&o>e}function qi(t,e){Ds=null;for(var o,n=0;n<t.length;++n){var i=t[n];if(i.from<e&&i.to>e)return n;if(i.from==e||i.to==e){if(null!=o)return zi(t,i.level,t[o].level)?(i.from!=i.to&&(Ds=o),n):(i.from!=i.to&&(Ds=n),o);o=n}}return o}function Xi(t,e,o,n){if(!n)return e+o;do{e+=o}while(e>0&&bi(t.text.charAt(e)));return e}function Yi(t,e,o,n){var i=jn(t);if(!i)return Ki(t,e,o,n);for(var r=qi(i,e),s=i[r],a=Xi(t,e,s.level%2?-o:o,n);;){if(a>s.from&&a<s.to)return a;if(a==s.from||a==s.to)return qi(i,a)==r?a:(s=i[r+=o],o>0==s.level%2?s.to:s.from);if(!(s=i[r+=o]))return null;a=o>0==s.level%2?Xi(t,s.to,-1,n):Xi(t,s.from,1,n)}}function Ki(t,e,o,n){var i=e+o;if(n)for(;i>0&&bi(t.text.charAt(i));)i+=o;return 0>i||i>t.text.length?null:i}var $i=/gecko\/\d/i.test(navigator.userAgent),Qi=/MSIE \d/.test(navigator.userAgent),Ji=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Zi=Qi||Ji,tr=Zi&&(Qi?document.documentMode||6:Ji[1]),er=/WebKit\//.test(navigator.userAgent),or=er&&/Qt\/\d+\.\d+/.test(navigator.userAgent),nr=/Chrome\//.test(navigator.userAgent),ir=/Opera\//.test(navigator.userAgent),rr=/Apple Computer/.test(navigator.vendor),sr=/KHTML\//.test(navigator.userAgent),ar=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),lr=/PhantomJS/.test(navigator.userAgent),cr=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),ur=cr||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),hr=cr||/Mac/.test(navigator.platform),gr=/win/i.test(navigator.platform),pr=ir&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);pr&&(pr=Number(pr[1])),pr&&pr>=15&&(ir=!1,er=!0);var dr=hr&&(or||ir&&(null==pr||12.11>pr)),fr=$i||Zi&&tr>=9,mr=!1,yr=!1,vr=t.Pos=function(t,e){return this instanceof vr?(this.line=t,void(this.ch=e)):new vr(t,e)},_r=t.cmpPos=function(t,e){return t.line-e.line||t.ch-e.ch};Y.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(t){if(t==this)return!0;if(t.primIndex!=this.primIndex||t.ranges.length!=this.ranges.length)return!1;for(var e=0;e<this.ranges.length;e++){var o=this.ranges[e],n=t.ranges[e];if(0!=_r(o.anchor,n.anchor)||0!=_r(o.head,n.head))return!1}return!0},deepCopy:function(){for(var t=[],e=0;e<this.ranges.length;e++)t[e]=new K(z(this.ranges[e].anchor),z(this.ranges[e].head));return new Y(t,this.primIndex)},somethingSelected:function(){for(var t=0;t<this.ranges.length;t++)if(!this.ranges[t].empty())return!0;return!1},contains:function(t,e){e||(e=t);for(var o=0;o<this.ranges.length;o++){var n=this.ranges[o];if(_r(e,n.from())>=0&&_r(t,n.to())<=0)return o}return-1}},K.prototype={from:function(){return X(this.anchor,this.head)},to:function(){return q(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};var br,Er,xr,Sr={left:0,right:0,top:0,bottom:0},Tr=null,wr=0,Cr=null,kr=0,Ar=0,Ir=null;Zi?Ir=-.53:$i?Ir=15:nr?Ir=-.7:rr&&(Ir=-1/3);var Br,Mr=null,Lr=t.changeEnd=function(t){return t.text?vr(t.from.line+t.text.length-1,gi(t.text).length+(1==t.text.length?t.from.ch:0)):t.to};t.prototype={constructor:t,focus:function(){window.focus(),we(this),xe(this)},setOption:function(t,e){var o=this.options,n=o[t];(o[t]!=e||"mode"==t)&&(o[t]=e,Rr.hasOwnProperty(t)&&ce(this,Rr[t])(this,e,n))},getOption:function(t){return this.options[t]},getDoc:function(){return this.doc},addKeyMap:function(t,e){this.state.keyMaps[e?"push":"unshift"](t)},removeKeyMap:function(t){for(var e=this.state.keyMaps,o=0;o<e.length;++o)if(e[o]==t||"string"!=typeof e[o]&&e[o].name==t)return e.splice(o,1),!0},addOverlay:ue(function(e,o){var n=e.token?e:t.getMode(this.options,e);if(n.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:n,modeSpec:e,opaque:o&&o.opaque}),this.state.modeGen++,de(this)}),removeOverlay:ue(function(t){for(var e=this.state.overlays,o=0;o<e.length;++o){var n=e[o].modeSpec;if(n==t||"string"==typeof t&&n.name==t)return e.splice(o,1),this.state.modeGen++,void de(this)}}),indentLine:ue(function(t,e,o){"string"!=typeof e&&"number"!=typeof e&&(e=null==e?this.options.smartIndent?"smart":"prev":e?"add":"subtract"),et(this.doc,t)&&Eo(this,t,e,o)}),indentSelection:ue(function(t){for(var e=this.doc.sel.ranges,o=-1,n=0;n<e.length;n++){var i=e[n];if(i.empty())i.head.line>o&&(Eo(this,i.head.line,t,!0),o=i.head.line,n==this.doc.sel.primIndex&&_o(this));else{var r=i.from(),s=i.to(),a=Math.max(o,r.line);o=Math.min(this.lastLine(),s.line-(s.ch?0:1))+1;for(var l=a;o>l;++l)Eo(this,l,t);var c=this.doc.sel.ranges;0==r.ch&&e.length==c.length&&c[n].from().ch>0&&st(this.doc,n,new K(r,c[n].to()),fs)}}}),getTokenAt:function(t,e){var o=this.doc;t=Z(o,t);for(var n=wt(this,t.line,e),i=this.doc.mode,r=Mn(o,t.line),s=new Yr(r.text,this.options.tabSize);s.pos<t.ch&&!s.eol();){s.start=s.pos;var a=gn(i,s,n)}return{start:s.start,end:s.pos,string:s.current(),type:a||null,state:n}},getTokenTypeAt:function(t){t=Z(this.doc,t);var e,o=fn(this,Mn(this.doc,t.line)),n=0,i=(o.length-1)/2,r=t.ch;if(0==r)e=o[2];else for(;;){var s=n+i>>1;if((s?o[2*s-1]:0)>=r)i=s;else{if(!(o[2*s+1]<r)){e=o[2*s+2];break}n=s+1}}var a=e?e.indexOf("cm-overlay "):-1;return 0>a?e:0==a?null:e.slice(0,a-1)},getModeAt:function(e){var o=this.doc.mode;return o.innerMode?t.innerMode(o,this.getTokenAt(e).state).mode:o},getHelper:function(t,e){return this.getHelpers(t,e)[0]},getHelpers:function(t,e){var o=[];if(!Hr.hasOwnProperty(e))return Hr;var n=Hr[e],i=this.getModeAt(t);if("string"==typeof i[e])n[i[e]]&&o.push(n[i[e]]);else if(i[e])for(var r=0;r<i[e].length;r++){var s=n[i[e][r]];s&&o.push(s)}else i.helperType&&n[i.helperType]?o.push(n[i.helperType]):n[i.name]&&o.push(n[i.name]);for(var r=0;r<n._global.length;r++){var a=n._global[r];a.pred(i,this)&&-1==pi(o,a.val)&&o.push(a.val)}return o},getStateAfter:function(t,e){var o=this.doc;return t=J(o,null==t?o.first+o.size-1:t),wt(this,t+1,e)},cursorCoords:function(t,e){var o,n=this.doc.sel.primary();return o=null==t?n.head:"object"==typeof t?Z(this.doc,t):t?n.from():n.to(),qt(this,o,e||"page")},charCoords:function(t,e){return zt(this,Z(this.doc,t),e||"page")},coordsChar:function(t,e){return t=Wt(this,t,e||"page"),Kt(this,t.left,t.top)},lineAtHeight:function(t,e){return t=Wt(this,{top:t,left:0},e||"page").top,On(this.doc,t+this.display.viewOffset)},heightAtLine:function(t,e){var o=!1,n=this.doc.first+this.doc.size-1;t<this.doc.first?t=this.doc.first:t>n&&(t=n,o=!0);var i=Mn(this.doc,t);return Vt(this,i,{top:0,left:0},e||"page").top+(o?this.doc.height-Pn(i):0)},defaultTextHeight:function(){return Qt(this.display)},defaultCharWidth:function(){return Jt(this.display)},setGutterMarker:ue(function(t,e,o){return xo(this.doc,t,"gutter",function(t){var n=t.gutterMarkers||(t.gutterMarkers={});return n[e]=o,!o&&_i(n)&&(t.gutterMarkers=null),!0})}),clearGutter:ue(function(t){var e=this,o=e.doc,n=o.first;o.iter(function(o){o.gutterMarkers&&o.gutterMarkers[t]&&(o.gutterMarkers[t]=null,fe(e,n,"gutter"),_i(o.gutterMarkers)&&(o.gutterMarkers=null)),++n})}),addLineWidget:ue(function(t,e,o){return an(this,t,e,o)}),removeLineWidget:function(t){t.clear()},lineInfo:function(t){if("number"==typeof t){if(!et(this.doc,t))return null;var e=t;if(!(t=Mn(this.doc,t)))return null}else{var e=Dn(t);if(null==e)return null}return{line:e,handle:t,text:t.text,gutterMarkers:t.gutterMarkers,textClass:t.textClass,bgClass:t.bgClass,wrapClass:t.wrapClass,widgets:t.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(t,e,o,n,i){var r=this.display;t=qt(this,Z(this.doc,t));var s=t.bottom,a=t.left;if(e.style.position="absolute",r.sizer.appendChild(e),"over"==n)s=t.top;else if("above"==n||"near"==n){var l=Math.max(r.wrapper.clientHeight,this.doc.height),c=Math.max(r.sizer.clientWidth,r.lineSpace.clientWidth);("above"==n||t.bottom+e.offsetHeight>l)&&t.top>e.offsetHeight?s=t.top-e.offsetHeight:t.bottom+e.offsetHeight<=l&&(s=t.bottom),a+e.offsetWidth>c&&(a=c-e.offsetWidth)}e.style.top=s+"px",e.style.left=e.style.right="","right"==i?(a=r.sizer.clientWidth-e.offsetWidth,e.style.right="0px"):("left"==i?a=0:"middle"==i&&(a=(r.sizer.clientWidth-e.offsetWidth)/2),e.style.left=a+"px"),o&&mo(this,a,s,a+e.offsetWidth,s+e.offsetHeight)},triggerOnKeyDown:ue(Xe),triggerOnKeyPress:ue($e),triggerOnKeyUp:Ke,execCommand:function(t){return Vr.hasOwnProperty(t)?Vr[t](this):void 0},findPosH:function(t,e,o,n){var i=1;0>e&&(i=-1,e=-e);for(var r=0,s=Z(this.doc,t);e>r&&(s=To(this.doc,s,i,o,n),!s.hitSide);++r);return s},moveH:ue(function(t,e){var o=this;o.extendSelectionsBy(function(n){return o.display.shift||o.doc.extend||n.empty()?To(o.doc,n.head,t,e,o.options.rtlMoveVisually):0>t?n.from():n.to()},ys)}),deleteH:ue(function(t,e){var o=this.doc.sel,n=this.doc;o.somethingSelected()?n.replaceSelection("",null,"+delete"):So(this,function(o){var i=To(n,o.head,t,e,!1);return 0>t?{from:i,to:o.head}:{from:o.head,to:i}})}),findPosV:function(t,e,o,n){var i=1,r=n;0>e&&(i=-1,e=-e);for(var s=0,a=Z(this.doc,t);e>s;++s){var l=qt(this,a,"div");if(null==r?r=l.left:l.left=r,a=wo(this,l,i,o),a.hitSide)break}return a},moveV:ue(function(t,e){var o=this,n=this.doc,i=[],r=!o.display.shift&&!n.extend&&n.sel.somethingSelected();if(n.extendSelectionsBy(function(s){if(r)return 0>t?s.from():s.to();var a=qt(o,s.head,"div");null!=s.goalColumn&&(a.left=s.goalColumn),i.push(a.left);var l=wo(o,a,t,e);return"page"==e&&s==n.sel.primary()&&vo(o,null,zt(o,l,"div").top-a.top),l},ys),i.length)for(var s=0;s<n.sel.ranges.length;s++)n.sel.ranges[s].goalColumn=i[s]}),findWordAt:function(t){var e=this.doc,o=Mn(e,t.line).text,n=t.ch,i=t.ch;if(o){var r=this.getHelper(t,"wordChars");(t.xRel<0||i==o.length)&&n?--n:++i;for(var s=o.charAt(n),a=vi(s,r)?function(t){return vi(t,r)}:/\s/.test(s)?function(t){return/\s/.test(t)}:function(t){return!/\s/.test(t)&&!vi(t)};n>0&&a(o.charAt(n-1));)--n;for(;i<o.length&&a(o.charAt(i));)++i}return new K(vr(t.line,n),vr(t.line,i))},toggleOverwrite:function(t){(null==t||t!=this.state.overwrite)&&((this.state.overwrite=!this.state.overwrite)?Ai(this.display.cursorDiv,"CodeMirror-overwrite"):ki(this.display.cursorDiv,"CodeMirror-overwrite"),hs(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return wi()==this.display.input},scrollTo:ue(function(t,e){(null!=t||null!=e)&&bo(this),null!=t&&(this.curOp.scrollLeft=t),null!=e&&(this.curOp.scrollTop=e)}),getScrollInfo:function(){var t=this.display.scroller,e=ps;return{left:t.scrollLeft,top:t.scrollTop,height:t.scrollHeight-e,width:t.scrollWidth-e,clientHeight:t.clientHeight-e,clientWidth:t.clientWidth-e}},scrollIntoView:ue(function(t,e){if(null==t?(t={from:this.doc.sel.primary().head,to:null},null==e&&(e=this.options.cursorScrollMargin)):"number"==typeof t?t={from:vr(t,0),to:null}:null==t.from&&(t={from:t,to:null}),t.to||(t.to=t.from),t.margin=e||0,null!=t.from.line)bo(this),this.curOp.scrollToPos=t;else{var o=yo(this,Math.min(t.from.left,t.to.left),Math.min(t.from.top,t.to.top)-t.margin,Math.max(t.from.right,t.to.right),Math.max(t.from.bottom,t.to.bottom)+t.margin);this.scrollTo(o.scrollLeft,o.scrollTop)}}),setSize:ue(function(t,e){function o(t){return"number"==typeof t||/^\d+$/.test(String(t))?t+"px":t}var n=this;null!=t&&(n.display.wrapper.style.width=o(t)),null!=e&&(n.display.wrapper.style.height=o(e)),n.options.lineWrapping&&Ft(this);var i=n.display.viewFrom;n.doc.iter(i,n.display.viewTo,function(t){if(t.widgets)for(var e=0;e<t.widgets.length;e++)if(t.widgets[e].noHScroll){fe(n,i,"widget");break}++i}),n.curOp.forceUpdate=!0,hs(n,"refresh",this)}),operation:function(t){return le(this,t)},refresh:ue(function(){var t=this.display.cachedTextHeight;de(this),this.curOp.forceUpdate=!0,Ht(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),h(this),(null==t||Math.abs(t-Qt(this.display))>.5)&&s(this),hs(this,"refresh",this)}),swapDoc:ue(function(t){var e=this.doc;return e.cm=null,Bn(this,t),Ht(this),Te(this),this.scrollTo(t.scrollLeft,t.scrollTop),this.curOp.forceScroll=!0,ni(this,"swapDoc",this,e),e}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},li(t);var Nr=t.defaults={},Rr=t.optionHandlers={},Dr=t.Init={toString:function(){return"CodeMirror.Init"}};Co("value","",function(t,e){t.setValue(e)},!0),Co("mode",null,function(t,e){t.doc.modeOption=e,o(t)},!0),Co("indentUnit",2,o,!0),Co("indentWithTabs",!1),Co("smartIndent",!0),Co("tabSize",4,function(t){n(t),Ht(t),de(t)},!0),Co("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(t,e){t.options.specialChars=new RegExp(e.source+(e.test("\t")?"":"|\t"),"g"),t.refresh()},!0),Co("specialCharPlaceholder",_n,function(t){t.refresh()},!0),Co("electricChars",!0),Co("rtlMoveVisually",!gr),Co("wholeLineUpdateBefore",!0),Co("theme","default",function(t){l(t),c(t)},!0),Co("keyMap","default",a),Co("extraKeys",null),Co("lineWrapping",!1,i,!0),Co("gutters",[],function(t){d(t.options),c(t)},!0),Co("fixedGutter",!0,function(t,e){t.display.gutters.style.left=e?x(t.display)+"px":"0",t.refresh()},!0),Co("coverGutterNextToScrollbar",!1,y,!0),Co("lineNumbers",!1,function(t){d(t.options),c(t)},!0),Co("firstLineNumber",1,c,!0),Co("lineNumberFormatter",function(t){return t},c,!0),Co("showCursorWhenSelecting",!1,vt,!0),Co("resetSelectionOnContextMenu",!0),Co("readOnly",!1,function(t,e){"nocursor"==e?(Je(t),t.display.input.blur(),t.display.disabled=!0):(t.display.disabled=!1,e||Te(t))}),Co("disableInput",!1,function(t,e){e||Te(t)},!0),Co("dragDrop",!0),Co("cursorBlinkRate",530),Co("cursorScrollMargin",0),Co("cursorHeight",1,vt,!0),Co("singleCursorHeightPerLine",!0,vt,!0),Co("workTime",100),Co("workDelay",100),Co("flattenSpans",!0,n,!0),Co("addModeClass",!1,n,!0),Co("pollInterval",100),Co("undoDepth",200,function(t,e){t.doc.history.undoDepth=e}),Co("historyEventDelay",1250),Co("viewportMargin",10,function(t){t.refresh()},!0),Co("maxHighlightLength",1e4,n,!0),Co("moveInputWithCursor",!0,function(t,e){e||(t.display.inputDiv.style.top=t.display.inputDiv.style.left=0)}),Co("tabindex",null,function(t,e){t.display.input.tabIndex=e||""}),Co("autofocus",null);var Or=t.modes={},Pr=t.mimeModes={};t.defineMode=function(e,o){t.defaults.mode||"null"==e||(t.defaults.mode=e),arguments.length>2&&(o.dependencies=Array.prototype.slice.call(arguments,2)),Or[e]=o},t.defineMIME=function(t,e){Pr[t]=e},t.resolveMode=function(e){if("string"==typeof e&&Pr.hasOwnProperty(e))e=Pr[e];else if(e&&"string"==typeof e.name&&Pr.hasOwnProperty(e.name)){var o=Pr[e.name];"string"==typeof o&&(o={name:o}),e=fi(o,e),e.name=o.name}else if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return t.resolveMode("application/xml");return"string"==typeof e?{name:e}:e||{name:"null"}},t.getMode=function(e,o){var o=t.resolveMode(o),n=Or[o.name];if(!n)return t.getMode(e,"text/plain");var i=n(e,o);if(jr.hasOwnProperty(o.name)){var r=jr[o.name];for(var s in r)r.hasOwnProperty(s)&&(i.hasOwnProperty(s)&&(i["_"+s]=i[s]),i[s]=r[s])}if(i.name=o.name,o.helperType&&(i.helperType=o.helperType),o.modeProps)for(var s in o.modeProps)i[s]=o.modeProps[s];return i},t.defineMode("null",function(){return{token:function(t){t.skipToEnd()}}}),t.defineMIME("text/plain","null");var jr=t.modeExtensions={};t.extendMode=function(t,e){mi(e,jr.hasOwnProperty(t)?jr[t]:jr[t]={})},t.defineExtension=function(e,o){t.prototype[e]=o},t.defineDocExtension=function(t,e){ns.prototype[t]=e},t.defineOption=Co;var Fr=[];t.defineInitHook=function(t){Fr.push(t)};var Hr=t.helpers={};t.registerHelper=function(e,o,n){Hr.hasOwnProperty(e)||(Hr[e]=t[e]={_global:[]}),Hr[e][o]=n},t.registerGlobalHelper=function(e,o,n,i){t.registerHelper(e,o,i),Hr[e]._global.push({pred:n,val:i})};var Ur=t.copyState=function(t,e){if(!0===e)return e;if(t.copyState)return t.copyState(e);var o={};for(var n in e){var i=e[n];i instanceof Array&&(i=i.concat([])),o[n]=i}return o},Gr=t.startState=function(t,e,o){return!t.startState||t.startState(e,o)};t.innerMode=function(t,e){for(;t.innerMode;){var o=t.innerMode(e);if(!o||o.mode==t)break;e=o.state,t=o.mode}return o||{mode:t,state:e}};var Vr=t.commands={selectAll:function(t){t.setSelection(vr(t.firstLine(),0),vr(t.lastLine()),fs)},singleSelection:function(t){t.setSelection(t.getCursor("anchor"),t.getCursor("head"),fs)},killLine:function(t){So(t,function(e){if(e.empty()){var o=Mn(t.doc,e.head.line).text.length;return e.head.ch==o&&e.head.line<t.lastLine()?{from:e.head,to:vr(e.head.line+1,0)}:{from:e.head,to:vr(e.head.line,o)}}return{from:e.from(),to:e.to()}})},deleteLine:function(t){So(t,function(e){return{from:vr(e.from().line,0),to:Z(t.doc,vr(e.to().line+1,0))}})},delLineLeft:function(t){So(t,function(t){return{from:vr(t.from().line,0),to:t.from()}})},delWrappedLineLeft:function(t){So(t,function(e){var o=t.charCoords(e.head,"div").top+5;return{from:t.coordsChar({left:0,top:o},"div"),to:e.from()}})},delWrappedLineRight:function(t){So(t,function(e){var o=t.charCoords(e.head,"div").top+5,n=t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:o},"div");return{from:e.from(),to:n}})},undo:function(t){t.undo()},redo:function(t){t.redo()},undoSelection:function(t){t.undoSelection()},redoSelection:function(t){t.redoSelection()},goDocStart:function(t){t.extendSelection(vr(t.firstLine(),0))},goDocEnd:function(t){t.extendSelection(vr(t.lastLine()))},goLineStart:function(t){t.extendSelectionsBy(function(e){return Gi(t,e.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(t){t.extendSelectionsBy(function(e){return Wi(t,e.head)},{origin:"+move",bias:1})},goLineEnd:function(t){t.extendSelectionsBy(function(e){return Vi(t,e.head.line)},{origin:"+move",bias:-1})},goLineRight:function(t){t.extendSelectionsBy(function(e){var o=t.charCoords(e.head,"div").top+5;return t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:o},"div")},ys)},goLineLeft:function(t){t.extendSelectionsBy(function(e){var o=t.charCoords(e.head,"div").top+5;return t.coordsChar({left:0,top:o},"div")},ys)},goLineLeftSmart:function(t){t.extendSelectionsBy(function(e){var o=t.charCoords(e.head,"div").top+5,n=t.coordsChar({left:0,top:o},"div");return n.ch<t.getLine(n.line).search(/\S/)?Wi(t,e.head):n},ys)},goLineUp:function(t){t.moveV(-1,"line")},goLineDown:function(t){t.moveV(1,"line")},goPageUp:function(t){t.moveV(-1,"page")},goPageDown:function(t){t.moveV(1,"page")},goCharLeft:function(t){t.moveH(-1,"char")},goCharRight:function(t){t.moveH(1,"char")},goColumnLeft:function(t){t.moveH(-1,"column")},goColumnRight:function(t){t.moveH(1,"column")},goWordLeft:function(t){t.moveH(-1,"word")},goGroupRight:function(t){t.moveH(1,"group")},goGroupLeft:function(t){t.moveH(-1,"group")},goWordRight:function(t){t.moveH(1,"word")},delCharBefore:function(t){t.deleteH(-1,"char")},delCharAfter:function(t){t.deleteH(1,"char")},delWordBefore:function(t){t.deleteH(-1,"word")},delWordAfter:function(t){t.deleteH(1,"word")},delGroupBefore:function(t){t.deleteH(-1,"group")},delGroupAfter:function(t){t.deleteH(1,"group")},indentAuto:function(t){t.indentSelection("smart")},indentMore:function(t){t.indentSelection("add")},indentLess:function(t){t.indentSelection("subtract")},insertTab:function(t){t.replaceSelection("\t")},insertSoftTab:function(t){for(var e=[],o=t.listSelections(),n=t.options.tabSize,i=0;i<o.length;i++){var r=o[i].from(),s=vs(t.getLine(r.line),r.ch,n);e.push(new Array(n-s%n+1).join(" "))}t.replaceSelections(e)},defaultTab:function(t){t.somethingSelected()?t.indentSelection("add"):t.execCommand("insertTab")},transposeChars:function(t){le(t,function(){for(var e=t.listSelections(),o=[],n=0;n<e.length;n++){var i=e[n].head,r=Mn(t.doc,i.line).text;if(r)if(i.ch==r.length&&(i=new vr(i.line,i.ch-1)),i.ch>0)i=new vr(i.line,i.ch+1),t.replaceRange(r.charAt(i.ch-1)+r.charAt(i.ch-2),vr(i.line,i.ch-2),i,"+transpose");else if(i.line>t.doc.first){var s=Mn(t.doc,i.line-1).text;s&&t.replaceRange(r.charAt(0)+"\n"+s.charAt(s.length-1),vr(i.line-1,s.length-1),vr(i.line,1),"+transpose")}o.push(new K(i,i))}t.setSelections(o)})},newlineAndIndent:function(t){le(t,function(){for(var e=t.listSelections().length,o=0;e>o;o++){var n=t.listSelections()[o];t.replaceRange("\n",n.anchor,n.head,"+input"),t.indentLine(n.from().line+1,null,!0),_o(t)}})},toggleOverwrite:function(t){t.toggleOverwrite()}},Wr=t.keyMap={};Wr.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},Wr.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},Wr.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},Wr.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},Wr.default=hr?Wr.macDefault:Wr.pcDefault;var zr=t.lookupKey=function(t,e,o){function n(e){e=ko(e);var i=e[t];if(!1===i)return"stop";if(null!=i&&o(i))return!0;if(e.nofallthrough)return"stop";var r=e.fallthrough;if(null==r)return!1;if("[object Array]"!=Object.prototype.toString.call(r))return n(r);for(var s=0;s<r.length;++s){var a=n(r[s]);if(a)return a}return!1}for(var i=0;i<e.length;++i){var r=n(e[i]);if(r)return"stop"!=r}},qr=t.isModifierKey=function(t){var e=Rs[t.keyCode];return"Ctrl"==e||"Alt"==e||"Shift"==e||"Mod"==e},Xr=t.keyName=function(t,e){if(ir&&34==t.keyCode&&t.char)return!1;var o=Rs[t.keyCode];return null!=o&&!t.altGraphKey&&(t.altKey&&(o="Alt-"+o),(dr?t.metaKey:t.ctrlKey)&&(o="Ctrl-"+o),(dr?t.ctrlKey:t.metaKey)&&(o="Cmd-"+o),!e&&t.shiftKey&&(o="Shift-"+o),o)};t.fromTextArea=function(e,o){function n(){e.value=l.getValue()}if(o||(o={}),o.value=e.value,!o.tabindex&&e.tabindex&&(o.tabindex=e.tabindex),!o.placeholder&&e.placeholder&&(o.placeholder=e.placeholder),null==o.autofocus){var i=wi();o.autofocus=i==e||null!=e.getAttribute("autofocus")&&i==document.body}if(e.form&&(cs(e.form,"submit",n),!o.leaveSubmitMethodAlone)){var r=e.form,s=r.submit;try{var a=r.submit=function(){n(),r.submit=s,r.submit(),r.submit=a}}catch(t){}}e.style.display="none";var l=t(function(t){e.parentNode.insertBefore(t,e.nextSibling)},o);return l.save=n,l.getTextArea=function(){return e},l.toTextArea=function(){l.toTextArea=isNaN,n(),e.parentNode.removeChild(l.getWrapperElement()),e.style.display="",e.form&&(us(e.form,"submit",n),"function"==typeof e.form.submit&&(e.form.submit=s))},l};var Yr=t.StringStream=function(t,e){this.pos=this.start=0,this.string=t,this.tabSize=e||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};Yr.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(t){var e=this.string.charAt(this.pos);if("string"==typeof t)var o=e==t;else var o=e&&(t.test?t.test(e):t(e));return o?(++this.pos,e):void 0},eatWhile:function(t){for(var e=this.pos;this.eat(t););return this.pos>e},eatSpace:function(){for(var t=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>t},skipToEnd:function(){this.pos=this.string.length},skipTo:function(t){var e=this.string.indexOf(t,this.pos);return e>-1?(this.pos=e,!0):void 0},backUp:function(t){this.pos-=t},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=vs(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?vs(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return vs(this.string,null,this.tabSize)-(this.lineStart?vs(this.string,this.lineStart,this.tabSize):0)},match:function(t,e,o){if("string"!=typeof t){var n=this.string.slice(this.pos).match(t);return n&&n.index>0?null:(n&&!1!==e&&(this.pos+=n[0].length),n)}var i=function(t){return o?t.toLowerCase():t};return i(this.string.substr(this.pos,t.length))==i(t)?(!1!==e&&(this.pos+=t.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(t,e){this.lineStart+=t;try{return e()}finally{this.lineStart-=t}}};var Kr=t.TextMarker=function(t,e){this.lines=[],this.type=e,this.doc=t};li(Kr),Kr.prototype.clear=function(){if(!this.explicitlyCleared){var t=this.doc.cm,e=t&&!t.curOp;if(e&&Zt(t),ai(this,"clear")){var o=this.find();o&&ni(this,"clear",o.from,o.to)}for(var n=null,i=null,r=0;r<this.lines.length;++r){var s=this.lines[r],a=Ro(s.markedSpans,this);t&&!this.collapsed?fe(t,Dn(s),"text"):t&&(null!=a.to&&(i=Dn(s)),null!=a.from&&(n=Dn(s))),s.markedSpans=Do(s.markedSpans,a),null==a.from&&this.collapsed&&!on(this.doc,s)&&t&&Rn(s,Qt(t.display))}if(t&&this.collapsed&&!t.options.lineWrapping)for(var r=0;r<this.lines.length;++r){var l=Jo(this.lines[r]),c=g(l);c>t.display.maxLineLength&&(t.display.maxLine=l,t.display.maxLineLength=c,t.display.maxLineChanged=!0)}null!=n&&t&&this.collapsed&&de(t,n,i+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,t&&pt(t.doc)),t&&ni(t,"markerCleared",t,this),e&&ee(t),this.parent&&this.parent.clear()}},Kr.prototype.find=function(t,e){null==t&&"bookmark"==this.type&&(t=1);for(var o,n,i=0;i<this.lines.length;++i){var r=this.lines[i],s=Ro(r.markedSpans,this);if(null!=s.from&&(o=vr(e?r:Dn(r),s.from),-1==t))return o;if(null!=s.to&&(n=vr(e?r:Dn(r),s.to),1==t))return n}return o&&{from:o,to:n}},Kr.prototype.changed=function(){var t=this.find(-1,!0),e=this,o=this.doc.cm;t&&o&&le(o,function(){var n=t.line,i=Dn(t.line),r=Nt(o,i);if(r&&(jt(r),o.curOp.selectionChanged=o.curOp.forceUpdate=!0),o.curOp.updateMaxLine=!0,!on(e.doc,n)&&null!=e.height){var s=e.height;e.height=null;var a=sn(e)-s;a&&Rn(n,n.height+a)}})},Kr.prototype.attachLine=function(t){if(!this.lines.length&&this.doc.cm){var e=this.doc.cm.curOp;e.maybeHiddenMarkers&&-1!=pi(e.maybeHiddenMarkers,this)||(e.maybeUnhiddenMarkers||(e.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(t)},Kr.prototype.detachLine=function(t){if(this.lines.splice(pi(this.lines,t),1),!this.lines.length&&this.doc.cm){var e=this.doc.cm.curOp;(e.maybeHiddenMarkers||(e.maybeHiddenMarkers=[])).push(this)}};var $r=0,Qr=t.SharedTextMarker=function(t,e){this.markers=t,this.primary=e;for(var o=0;o<t.length;++o)t[o].parent=this};li(Qr),Qr.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var t=0;t<this.markers.length;++t)this.markers[t].clear();ni(this,"clear")}},Qr.prototype.find=function(t,e){return this.primary.find(t,e)};var Jr=t.LineWidget=function(t,e,o){if(o)for(var n in o)o.hasOwnProperty(n)&&(this[n]=o[n]);this.cm=t,this.node=e};li(Jr),Jr.prototype.clear=function(){var t=this.cm,e=this.line.widgets,o=this.line,n=Dn(o);if(null!=n&&e){for(var i=0;i<e.length;++i)e[i]==this&&e.splice(i--,1);e.length||(o.widgets=null);var r=sn(this);le(t,function(){rn(t,o,-r),fe(t,n,"widget"),Rn(o,Math.max(0,o.height-r))})}},Jr.prototype.changed=function(){var t=this.height,e=this.cm,o=this.line;this.height=null;var n=sn(this)-t;n&&le(e,function(){e.curOp.forceUpdate=!0,rn(e,o,n),Rn(o,o.height+n)})};var Zr=t.Line=function(t,e,o){this.text=t,Wo(this,e),this.height=o?o(this):1};li(Zr),Zr.prototype.lineNo=function(){return Dn(this)};var ts={},es={};kn.prototype={chunkSize:function(){return this.lines.length},removeInner:function(t,e){for(var o=t,n=t+e;n>o;++o){var i=this.lines[o];this.height-=i.height,cn(i),ni(i,"delete")}this.lines.splice(t,e)},collapse:function(t){t.push.apply(t,this.lines)},insertInner:function(t,e,o){this.height+=o,this.lines=this.lines.slice(0,t).concat(e).concat(this.lines.slice(t));for(var n=0;n<e.length;++n)e[n].parent=this},iterN:function(t,e,o){for(var n=t+e;n>t;++t)if(o(this.lines[t]))return!0}},An.prototype={chunkSize:function(){return this.size},removeInner:function(t,e){this.size-=e;for(var o=0;o<this.children.length;++o){var n=this.children[o],i=n.chunkSize();if(i>t){var r=Math.min(e,i-t),s=n.height;if(n.removeInner(t,r),this.height-=s-n.height,i==r&&(this.children.splice(o--,1),n.parent=null),0==(e-=r))break;t=0}else t-=i}if(this.size-e<25&&(this.children.length>1||!(this.children[0]instanceof kn))){var a=[];this.collapse(a),this.children=[new kn(a)],this.children[0].parent=this}},collapse:function(t){for(var e=0;e<this.children.length;++e)this.children[e].collapse(t)},insertInner:function(t,e,o){this.size+=e.length,this.height+=o;for(var n=0;n<this.children.length;++n){var i=this.children[n],r=i.chunkSize();if(r>=t){if(i.insertInner(t,e,o),i.lines&&i.lines.length>50){for(;i.lines.length>50;){var s=i.lines.splice(i.lines.length-25,25),a=new kn(s);i.height-=a.height,this.children.splice(n+1,0,a),a.parent=this}this.maybeSpill()}break}t-=r}},maybeSpill:function(){if(!(this.children.length<=10)){var t=this;do{var e=t.children.splice(t.children.length-5,5),o=new An(e);if(t.parent){t.size-=o.size,t.height-=o.height;var n=pi(t.parent.children,t);t.parent.children.splice(n+1,0,o)}else{var i=new An(t.children);i.parent=t,t.children=[i,o],t=i}o.parent=t.parent}while(t.children.length>10);t.parent.maybeSpill()}},iterN:function(t,e,o){for(var n=0;n<this.children.length;++n){var i=this.children[n],r=i.chunkSize();if(r>t){var s=Math.min(e,r-t);if(i.iterN(t,s,o))return!0;if(0==(e-=s))break;t=0}else t-=r}}};var os=0,ns=t.Doc=function(t,e,o){if(!(this instanceof ns))return new ns(t,e,o);null==o&&(o=0),An.call(this,[new kn([new Zr("",null)])]),this.first=o,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=o;var n=vr(o,0);this.sel=Q(n),this.history=new Fn(null),this.id=++os,this.modeOption=e,"string"==typeof t&&(t=Bs(t)),Cn(this,{from:n,to:n,text:t}),ut(this,Q(n),fs)};ns.prototype=fi(An.prototype,{constructor:ns,iter:function(t,e,o){o?this.iterN(t-this.first,e-t,o):this.iterN(this.first,this.first+this.size,t)},insert:function(t,e){for(var o=0,n=0;n<e.length;++n)o+=e[n].height;this.insertInner(t-this.first,e,o)},remove:function(t,e){this.removeInner(t-this.first,e)},getValue:function(t){var e=Nn(this,this.first,this.first+this.size);return!1===t?e:e.join(t||"\n")},setValue:he(function(t){var e=vr(this.first,0),o=this.first+this.size-1;so(this,{from:e,to:vr(o,Mn(this,o).text.length),text:Bs(t),origin:"setValue"},!0),ut(this,Q(e))}),replaceRange:function(t,e,o,n){e=Z(this,e),o=o?Z(this,o):e,go(this,t,e,o,n)},getRange:function(t,e,o){var n=Ln(this,Z(this,t),Z(this,e));return!1===o?n:n.join(o||"\n")},getLine:function(t){var e=this.getLineHandle(t);return e&&e.text},getLineHandle:function(t){return et(this,t)?Mn(this,t):void 0},getLineNumber:function(t){return Dn(t)},getLineHandleVisualStart:function(t){return"number"==typeof t&&(t=Mn(this,t)),Jo(t)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(t){return Z(this,t)},getCursor:function(t){var e=this.sel.primary();return null==t||"head"==t?e.head:"anchor"==t?e.anchor:"end"==t||"to"==t||!1===t?e.to():e.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:he(function(t,e,o){at(this,Z(this,"number"==typeof t?vr(t,e||0):t),null,o)}),setSelection:he(function(t,e,o){at(this,Z(this,t),Z(this,e||t),o)}),extendSelection:he(function(t,e,o){it(this,Z(this,t),e&&Z(this,e),o)}),extendSelections:he(function(t,e){rt(this,ot(this,t))}),extendSelectionsBy:he(function(t,e){rt(this,di(this.sel.ranges,t),e)}),setSelections:he(function(t,e,o){if(t.length){for(var n=0,i=[];n<t.length;n++)i[n]=new K(Z(this,t[n].anchor),Z(this,t[n].head));null==e&&(e=Math.min(t.length-1,this.sel.primIndex)),ut(this,$(i,e),o)}}),addSelection:he(function(t,e,o){var n=this.sel.ranges.slice(0);n.push(new K(Z(this,t),Z(this,e||t))),ut(this,$(n,n.length-1),o)}),getSelection:function(t){for(var e,o=this.sel.ranges,n=0;n<o.length;n++){var i=Ln(this,o[n].from(),o[n].to());e=e?e.concat(i):i}return!1===t?e:e.join(t||"\n")},getSelections:function(t){for(var e=[],o=this.sel.ranges,n=0;n<o.length;n++){var i=Ln(this,o[n].from(),o[n].to());!1!==t&&(i=i.join(t||"\n")),e[n]=i}return e},replaceSelection:function(t,e,o){for(var n=[],i=0;i<this.sel.ranges.length;i++)n[i]=t;this.replaceSelections(n,e,o||"+input")},replaceSelections:he(function(t,e,o){for(var n=[],i=this.sel,r=0;r<i.ranges.length;r++){var s=i.ranges[r];n[r]={from:s.from(),to:s.to(),text:Bs(t[r]),origin:o}}for(var a=e&&"end"!=e&&io(this,n,e),r=n.length-1;r>=0;r--)so(this,n[r]);a?ct(this,a):this.cm&&_o(this.cm)}),undo:he(function(){lo(this,"undo")}),redo:he(function(){lo(this,"redo")}),undoSelection:he(function(){lo(this,"undo",!0)}),redoSelection:he(function(){lo(this,"redo",!0)}),setExtending:function(t){this.extend=t},getExtending:function(){return this.extend},historySize:function(){for(var t=this.history,e=0,o=0,n=0;n<t.done.length;n++)t.done[n].ranges||++e;for(var n=0;n<t.undone.length;n++)t.undone[n].ranges||++o;return{undo:e,redo:o}},clearHistory:function(){this.history=new Fn(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(t){return t&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(t){return this.history.generation==(t||this.cleanGeneration)},getHistory:function(){return{done:$n(this.history.done),undone:$n(this.history.undone)}},setHistory:function(t){var e=this.history=new Fn(this.history.maxGeneration);e.done=$n(t.done.slice(0),null,!0),e.undone=$n(t.undone.slice(0),null,!0)},addLineClass:he(function(t,e,o){return xo(this,t,"class",function(t){var n="text"==e?"textClass":"background"==e?"bgClass":"wrapClass";if(t[n]){if(new RegExp("(?:^|\\s)"+o+"(?:$|\\s)").test(t[n]))return!1;t[n]+=" "+o}else t[n]=o;return!0})}),removeLineClass:he(function(t,e,o){return xo(this,t,"class",function(t){var n="text"==e?"textClass":"background"==e?"bgClass":"wrapClass",i=t[n];if(!i)return!1;if(null==o)t[n]=null;else{var r=i.match(new RegExp("(?:^|\\s+)"+o+"(?:$|\\s+)"));if(!r)return!1;var s=r.index+r[0].length;t[n]=i.slice(0,r.index)+(r.index&&s!=i.length?" ":"")+i.slice(s)||null}return!0})}),markText:function(t,e,o){return Ao(this,Z(this,t),Z(this,e),o,"range")},setBookmark:function(t,e){var o={replacedWith:e&&(null==e.nodeType?e.widget:e),insertLeft:e&&e.insertLeft,clearWhenEmpty:!1,shared:e&&e.shared};return t=Z(this,t),Ao(this,t,t,o,"bookmark")},findMarksAt:function(t){t=Z(this,t);var e=[],o=Mn(this,t.line).markedSpans;if(o)for(var n=0;n<o.length;++n){var i=o[n];(null==i.from||i.from<=t.ch)&&(null==i.to||i.to>=t.ch)&&e.push(i.marker.parent||i.marker)}return e},findMarks:function(t,e,o){t=Z(this,t),e=Z(this,e);var n=[],i=t.line;return this.iter(t.line,e.line+1,function(r){var s=r.markedSpans;if(s)for(var a=0;a<s.length;a++){var l=s[a];i==t.line&&t.ch>l.to||null==l.from&&i!=t.line||i==e.line&&l.from>e.ch||o&&!o(l.marker)||n.push(l.marker.parent||l.marker)}++i}),n},getAllMarks:function(){var t=[];return this.iter(function(e){var o=e.markedSpans;if(o)for(var n=0;n<o.length;++n)null!=o[n].from&&t.push(o[n].marker)}),t},posFromIndex:function(t){var e,o=this.first;return this.iter(function(n){var i=n.text.length+1;return i>t?(e=t,!0):(t-=i,void++o)}),Z(this,vr(o,e))},indexFromPos:function(t){t=Z(this,t);var e=t.ch;return t.line<this.first||t.ch<0?0:(this.iter(this.first,t.line,function(t){e+=t.text.length+1}),e)},copy:function(t){var e=new ns(Nn(this,this.first,this.first+this.size),this.modeOption,this.first);return e.scrollTop=this.scrollTop,e.scrollLeft=this.scrollLeft,e.sel=this.sel,e.extend=!1,t&&(e.history.undoDepth=this.history.undoDepth,e.setHistory(this.getHistory())),e},linkedDoc:function(t){t||(t={});var e=this.first,o=this.first+this.size;null!=t.from&&t.from>e&&(e=t.from),null!=t.to&&t.to<o&&(o=t.to);var n=new ns(Nn(this,e,o),t.mode||this.modeOption,e);return t.sharedHist&&(n.history=this.history),(this.linked||(this.linked=[])).push({doc:n,sharedHist:t.sharedHist}),n.linked=[{doc:this,isParent:!0,sharedHist:t.sharedHist}],Mo(n,Bo(this)),n},unlinkDoc:function(e){if(e instanceof t&&(e=e.doc),this.linked)for(var o=0;o<this.linked.length;++o){var n=this.linked[o];if(n.doc==e){this.linked.splice(o,1),e.unlinkDoc(this),Lo(Bo(this));break}}if(e.history==this.history){var i=[e.id];In(e,function(t){i.push(t.id)},!0),e.history=new Fn(null),e.history.done=$n(this.history.done,i),e.history.undone=$n(this.history.undone,i)}},iterLinkedDocs:function(t){In(this,t)},getMode:function(){return this.mode},getEditor:function(){return this.cm}}),ns.prototype.eachLine=ns.prototype.iter;var is="iter insert remove copy getEditor".split(" ");for(var rs in ns.prototype)ns.prototype.hasOwnProperty(rs)&&pi(is,rs)<0&&(t.prototype[rs]=function(t){return function(){return t.apply(this.doc,arguments)}}(ns.prototype[rs]));li(ns);var ss=t.e_preventDefault=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},as=t.e_stopPropagation=function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},ls=t.e_stop=function(t){ss(t),as(t)},cs=t.on=function(t,e,o){if(t.addEventListener)t.addEventListener(e,o,!1);else if(t.attachEvent)t.attachEvent("on"+e,o);else{var n=t._handlers||(t._handlers={}),i=n[e]||(n[e]=[]);i.push(o)}},us=t.off=function(t,e,o){if(t.removeEventListener)t.removeEventListener(e,o,!1);else if(t.detachEvent)t.detachEvent("on"+e,o);else{var n=t._handlers&&t._handlers[e];if(!n)return;for(var i=0;i<n.length;++i)if(n[i]==o){n.splice(i,1);break}}},hs=t.signal=function(t,e){var o=t._handlers&&t._handlers[e];if(o)for(var n=Array.prototype.slice.call(arguments,2),i=0;i<o.length;++i)o[i].apply(null,n)},gs=null,ps=30,ds=t.Pass={toString:function(){return"CodeMirror.Pass"}},fs={scroll:!1},ms={origin:"*mouse"},ys={origin:"+move"};ci.prototype.set=function(t,e){clearTimeout(this.id),this.id=setTimeout(e,t)};var vs=t.countColumn=function(t,e,o,n,i){null==e&&-1==(e=t.search(/[^\s\u00a0]/))&&(e=t.length);for(var r=n||0,s=i||0;;){var a=t.indexOf("\t",r);if(0>a||a>=e)return s+(e-r);s+=a-r,s+=o-s%o,r=a+1}},_s=[""],bs=function(t){t.select()};cr?bs=function(t){t.selectionStart=0,t.selectionEnd=t.value.length}:Zi&&(bs=function(t){try{t.select()}catch(t){}}),[].indexOf&&(pi=function(t,e){return t.indexOf(e)}),[].map&&(di=function(t,e){return t.map(e)});var Es,xs=/[\u00df\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,Ss=t.isWordChar=function(t){return/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||xs.test(t))},Ts=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;Es=document.createRange?function(t,e,o){var n=document.createRange();return n.setEnd(t,o),n.setStart(t,e),n}:function(t,e,o){var n=document.body.createTextRange();return n.moveToElementText(t.parentNode),n.collapse(!0),n.moveEnd("character",o),n.moveStart("character",e),n},Zi&&11>tr&&(wi=function(){try{return document.activeElement}catch(t){return document.body}});var ws,Cs,ks,As=!1,Is=function(){if(Zi&&9>tr)return!1;var t=Ei("div");return"draggable"in t||"dragDrop"in t}(),Bs=t.splitLines=3!="\n\nb".split(/\n/).length?function(t){for(var e=0,o=[],n=t.length;n>=e;){var i=t.indexOf("\n",e);-1==i&&(i=t.length);var r=t.slice(e,"\r"==t.charAt(i-1)?i-1:i),s=r.indexOf("\r");-1!=s?(o.push(r.slice(0,s)),e+=s+1):(o.push(r),e=i+1)}return o}:function(t){return t.split(/\r\n?|\n/)},Ms=window.getSelection?function(t){try{return t.selectionStart!=t.selectionEnd}catch(t){return!1}}:function(t){try{var e=t.ownerDocument.selection.createRange()}catch(t){}return!(!e||e.parentElement()!=t)&&0!=e.compareEndPoints("StartToEnd",e)},Ls=function(){var t=Ei("div");return"oncopy"in t||(t.setAttribute("oncopy","return;"),"function"==typeof t.oncopy)}(),Ns=null,Rs={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",107:"=",109:"-",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};t.keyNames=Rs,function(){for(var t=0;10>t;t++)Rs[t+48]=Rs[t+96]=String(t);for(var t=65;90>=t;t++)Rs[t]=String.fromCharCode(t);for(var t=1;12>=t;t++)Rs[t+111]=Rs[t+63235]="F"+t}();var Ds,Os=function(){function t(t){return 247>=t?o.charAt(t):t>=1424&&1524>=t?"R":t>=1536&&1773>=t?n.charAt(t-1536):t>=1774&&2220>=t?"r":t>=8192&&8203>=t?"w":8204==t?"b":"L"}function e(t,e,o){this.level=t,this.from=e,this.to=o}var o="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",n="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm",i=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,r=/[stwN]/,s=/[LRr]/,a=/[Lb1n]/,l=/[1n]/,c="L";return function(o){if(!i.test(o))return!1;for(var n,u=o.length,h=[],g=0;u>g;++g)h.push(n=t(o.charCodeAt(g)));for(var g=0,p=c;u>g;++g){var n=h[g];"m"==n?h[g]=p:p=n}for(var g=0,d=c;u>g;++g){var n=h[g];"1"==n&&"r"==d?h[g]="n":s.test(n)&&(d=n,"r"==n&&(h[g]="R"))}for(var g=1,p=h[0];u-1>g;++g){var n=h[g];"+"==n&&"1"==p&&"1"==h[g+1]?h[g]="1":","!=n||p!=h[g+1]||"1"!=p&&"n"!=p||(h[g]=p),p=n}for(var g=0;u>g;++g){var n=h[g];if(","==n)h[g]="N";else if("%"==n){for(var f=g+1;u>f&&"%"==h[f];++f);for(var m=g&&"!"==h[g-1]||u>f&&"1"==h[f]?"1":"N",y=g;f>y;++y)h[y]=m;g=f-1}}for(var g=0,d=c;u>g;++g){var n=h[g];"L"==d&&"1"==n?h[g]="L":s.test(n)&&(d=n)}for(var g=0;u>g;++g)if(r.test(h[g])){for(var f=g+1;u>f&&r.test(h[f]);++f);for(var v="L"==(g?h[g-1]:c),_="L"==(u>f?h[f]:c),m=v||_?"L":"R",y=g;f>y;++y)h[y]=m;g=f-1}for(var b,E=[],g=0;u>g;)if(a.test(h[g])){var x=g;for(++g;u>g&&a.test(h[g]);++g);E.push(new e(0,x,g))}else{var S=g,T=E.length;for(++g;u>g&&"L"!=h[g];++g);for(var y=S;g>y;)if(l.test(h[y])){y>S&&E.splice(T,0,new e(1,S,y));var w=y;for(++y;g>y&&l.test(h[y]);++y);E.splice(T,0,new e(2,w,y)),S=y}else++y;g>S&&E.splice(T,0,new e(1,S,g))}return 1==E[0].level&&(b=o.match(/^\s+/))&&(E[0].from=b[0].length,E.unshift(new e(0,0,b[0].length))),1==gi(E).level&&(b=o.match(/\s+$/))&&(gi(E).to-=b[0].length,E.push(new e(0,u-b[0].length,u))),E[0].level!=gi(E).level&&E.push(new e(E[0].level,u,u)),E}}();return t.version="4.7.0",t}),function(t){t(o(4))}(function(t){"use strict";function e(t){for(var e={},o=t.split(" "),n=0;n<o.length;++n)e[o[n]]=!0;return e}function o(t,e){if(!e.startOfLine)return!1;for(;;){if(!t.skipTo("\\")){t.skipToEnd(),e.tokenize=null;break}if(t.next(),t.eol()){e.tokenize=o;break}}return"meta"}function n(t,e){if(t.backUp(1),t.match(/(R|u8R|uR|UR|LR)/)){var o=t.match(/"([^\s\\()]{0,16})\(/);return!!o&&(e.cpp11RawStringDelim=o[1],e.tokenize=r,r(t,e))}return t.match(/(u8|u|U|L)/)?!!t.match(/["']/,!1)&&"string":(t.next(),!1)}function i(t,e){for(var o;null!=(o=t.next());)if('"'==o&&!t.eat('"')){e.tokenize=null;break}return"string"}function r(t,e){var o=e.cpp11RawStringDelim.replace(/[^\w\s]/g,"\\$&");return t.match(new RegExp(".*?\\)"+o+'"'))?e.tokenize=null:t.skipToEnd(),"string"}function s(e,o){function n(t){if(t)for(var e in t)t.hasOwnProperty(e)&&i.push(e)}"string"==typeof e&&(e=[e]);var i=[];n(o.keywords),n(o.builtin),n(o.atoms),i.length&&(o.helperType=e[0],t.registerHelper("hintWords",e[0],i));for(var r=0;r<e.length;++r)t.defineMIME(e[r],o)}function a(t,e){for(var o=!1;!t.eol();){if(!o&&t.match('"""')){e.tokenize=null;break}o="\\"!=t.next()&&!o}return"string"}t.defineMode("clike",function(e,o){function n(t,e){var o=t.next();if(y[o]){var n=y[o](t,e);if(!1!==n)return n}if('"'==o||"'"==o)return e.tokenize=i(o),e.tokenize(t,e);if(/[\[\]{}\(\),;\:\.]/.test(o))return c=o,null;if(/\d/.test(o))return t.eatWhile(/[\w\.]/),"number";if("/"==o){if(t.eat("*"))return e.tokenize=r,r(t,e);if(t.eat("/"))return t.skipToEnd(),"comment"}if(b.test(o))return t.eatWhile(b),"operator";t.eatWhile(/[\w\$_\xa1-\uffff]/);var s=t.current();return p.propertyIsEnumerable(s)?(f.propertyIsEnumerable(s)&&(c="newstatement"),"keyword"):d.propertyIsEnumerable(s)?(f.propertyIsEnumerable(s)&&(c="newstatement"),"builtin"):m.propertyIsEnumerable(s)?"atom":"variable"}function i(t){return function(e,o){for(var n,i=!1,r=!1;null!=(n=e.next());){if(n==t&&!i){r=!0;break}i=!i&&"\\"==n}return(r||!i&&!v)&&(o.tokenize=null),"string"}}function r(t,e){for(var o,n=!1;o=t.next();){if("/"==o&&n){e.tokenize=null;break}n="*"==o}return"comment"}function s(t,e,o,n,i){this.indented=t,this.column=e,this.type=o,this.align=n,this.prev=i}function a(t,e,o){var n=t.indented;return t.context&&"statement"==t.context.type&&(n=t.context.indented),t.context=new s(n,e,o,null,t.context)}function l(t){var e=t.context.type;return(")"==e||"]"==e||"}"==e)&&(t.indented=t.context.indented),t.context=t.context.prev}var c,u=e.indentUnit,h=o.statementIndentUnit||u,g=o.dontAlignCalls,p=o.keywords||{},d=o.builtin||{},f=o.blockKeywords||{},m=o.atoms||{},y=o.hooks||{},v=o.multiLineStrings,_=!1!==o.indentStatements,b=/[+\-*&%=<>!?|\/]/;return{startState:function(t){return{tokenize:null,context:new s((t||0)-u,0,"top",!1),indented:0,startOfLine:!0}},token:function(t,e){var o=e.context;if(t.sol()&&(null==o.align&&(o.align=!1),e.indented=t.indentation(),e.startOfLine=!0),t.eatSpace())return null;c=null;var i=(e.tokenize||n)(t,e);if("comment"==i||"meta"==i)return i;if(null==o.align&&(o.align=!0),";"!=c&&":"!=c&&","!=c||"statement"!=o.type)if("{"==c)a(e,t.column(),"}");else if("["==c)a(e,t.column(),"]");else if("("==c)a(e,t.column(),")");else if("}"==c){for(;"statement"==o.type;)o=l(e);for("}"==o.type&&(o=l(e));"statement"==o.type;)o=l(e)}else c==o.type?l(e):_&&(("}"==o.type||"top"==o.type)&&";"!=c||"statement"==o.type&&"newstatement"==c)&&a(e,t.column(),"statement");else l(e);return e.startOfLine=!1,i},indent:function(e,o){if(e.tokenize!=n&&null!=e.tokenize)return t.Pass;var i=e.context,r=o&&o.charAt(0);"statement"==i.type&&"}"==r&&(i=i.prev);var s=r==i.type;return"statement"==i.type?i.indented+("{"==r?0:h):!i.align||g&&")"==i.type?")"!=i.type||s?i.indented+(s?0:u):i.indented+h:i.column+(s?0:1)},electricChars:"{}",blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:"//",fold:"brace"}});var l="auto if break int case long char register continue return default short do sizeof double static else struct entry switch extern typedef float union for unsigned goto while enum void const signed volatile";s(["text/x-csrc","text/x-c","text/x-chdr"],{name:"clike",keywords:e(l),blockKeywords:e("case do else for if switch while struct"),atoms:e("null"),hooks:{"#":o},modeProps:{fold:["brace","include"]}}),s(["text/x-c++src","text/x-c++hdr"],{name:"clike",keywords:e(l+" asm dynamic_cast namespace reinterpret_cast try bool explicit new static_cast typeid catch operator template typename class friend private this using const_cast inline public throw virtual delete mutable protected wchar_t alignas alignof constexpr decltype nullptr noexcept thread_local final static_assert override"),blockKeywords:e("catch class do else finally for if struct switch try while"),atoms:e("true false null"),hooks:{"#":o,u:n,U:n,L:n,R:n},modeProps:{fold:["brace","include"]}}),s("text/x-java",{name:"clike",keywords:e("abstract assert boolean break byte case catch char class const continue default do double else enum extends final finally float for goto if implements import instanceof int interface long native new package private protected public return short static strictfp super switch synchronized this throw throws transient try void volatile while"),blockKeywords:e("catch class do else finally for if switch try while"),atoms:e("true false null"),hooks:{"@":function(t){return t.eatWhile(/[\w\$_]/),"meta"}},modeProps:{fold:["brace","import"]}}),s("text/x-csharp",{name:"clike",keywords:e("abstract as base break case catch checked class const continue default delegate do else enum event explicit extern finally fixed for foreach goto if implicit in interface internal is lock namespace new operator out override params private protected public readonly ref return sealed sizeof stackalloc static struct switch this throw try typeof unchecked unsafe using virtual void volatile while add alias ascending descending dynamic from get global group into join let orderby partial remove select set value var yield"),blockKeywords:e("catch class do else finally for foreach if struct switch try while"),builtin:e("Boolean Byte Char DateTime DateTimeOffset Decimal Double Guid Int16 Int32 Int64 Object SByte Single String TimeSpan UInt16 UInt32 UInt64 bool byte char decimal double short int long object sbyte float string ushort uint ulong"),atoms:e("true false null"),hooks:{"@":function(t,e){return t.eat('"')?(e.tokenize=i,i(t,e)):(t.eatWhile(/[\w\$_]/),"meta")}}}),s("text/x-scala",{name:"clike",keywords:e("abstract case catch class def do else extends false final finally for forSome if implicit import lazy match new null object override package private protected return sealed super this throw trait try trye type val var while with yield _ : = => <- <: <% >: # @ assert assume require print println printf readLine readBoolean readByte readShort readChar readInt readLong readFloat readDouble AnyVal App Application Array BufferedIterator BigDecimal BigInt Char Console Either Enumeration Equiv Error Exception Fractional Function IndexedSeq Integral Iterable Iterator List Map Numeric Nil NotNull Option Ordered Ordering PartialFunction PartialOrdering Product Proxy Range Responder Seq Serializable Set Specializable Stream StringBuilder StringContext Symbol Throwable Traversable TraversableOnce Tuple Unit Vector :: #:: Boolean Byte Character CharSequence Class ClassLoader Cloneable Comparable Compiler Double Exception Float Integer Long Math Number Object Package Pair Process Runtime Runnable SecurityManager Short StackTraceElement StrictMath String StringBuffer System Thread ThreadGroup ThreadLocal Throwable Triple Void"),multiLineStrings:!0,blockKeywords:e("catch class do else finally for forSome if match switch try while"),atoms:e("true false null"),indentStatements:!1,hooks:{"@":function(t){return t.eatWhile(/[\w\$_]/),"meta"},'"':function(t,e){return!!t.match('""')&&(e.tokenize=a,e.tokenize(t,e))}}}),s(["x-shader/x-vertex","x-shader/x-fragment"],{name:"clike",keywords:e("float int bool void vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 mat2 mat3 mat4 sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadowconst attribute uniform varying break continue discard return for while do if else struct in out inout"),blockKeywords:e("for while do if else struct"),builtin:e("radians degrees sin cos tan asin acos atan pow exp log exp2 sqrt inversesqrt abs sign floor ceil fract mod min max clamp mix step smootstep length distance dot cross normalize ftransform faceforward reflect refract matrixCompMult lessThan lessThanEqual greaterThan greaterThanEqual equal notEqual any all not texture1D texture1DProj texture1DLod texture1DProjLod texture2D texture2DProj texture2DLod texture2DProjLod texture3D texture3DProj texture3DLod texture3DProjLod textureCube textureCubeLod shadow1D shadow2D shadow1DProj shadow2DProj shadow1DLod shadow2DLod shadow1DProjLod shadow2DProjLod dFdx dFdy fwidth noise1 noise2 noise3 noise4"),atoms:e("true false gl_FragColor gl_SecondaryColor gl_Normal gl_Vertex gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 gl_FogCoord gl_Position gl_PointSize gl_ClipVertex gl_FrontColor gl_BackColor gl_FrontSecondaryColor gl_BackSecondaryColor gl_TexCoord gl_FogFragCoord gl_FragCoord gl_FrontFacing gl_FragColor gl_FragData gl_FragDepth gl_ModelViewMatrix gl_ProjectionMatrix gl_ModelViewProjectionMatrix gl_TextureMatrix gl_NormalMatrix gl_ModelViewMatrixInverse gl_ProjectionMatrixInverse gl_ModelViewProjectionMatrixInverse gl_TexureMatrixTranspose gl_ModelViewMatrixInverseTranspose gl_ProjectionMatrixInverseTranspose gl_ModelViewProjectionMatrixInverseTranspose gl_TextureMatrixInverseTranspose gl_NormalScale gl_DepthRange gl_ClipPlane gl_Point gl_FrontMaterial gl_BackMaterial gl_LightSource gl_LightModel gl_FrontLightModelProduct gl_BackLightModelProduct gl_TextureColor gl_EyePlaneS gl_EyePlaneT gl_EyePlaneR gl_EyePlaneQ gl_FogParameters gl_MaxLights gl_MaxClipPlanes gl_MaxTextureUnits gl_MaxTextureCoords gl_MaxVertexAttribs gl_MaxVertexUniformComponents gl_MaxVaryingFloats gl_MaxVertexTextureImageUnits gl_MaxTextureImageUnits gl_MaxFragmentUniformComponents gl_MaxCombineTextureImageUnits gl_MaxDrawBuffers"),hooks:{"#":o},modeProps:{fold:["brace","include"]}}),s("text/x-nesc",{name:"clike",keywords:e(l+"as atomic async call command component components configuration event generic implementation includes interface module new norace nx_struct nx_union post provides signal task uses abstract extends"),blockKeywords:e("case do else for if switch while struct"),atoms:e("null"),hooks:{"#":o},modeProps:{fold:["brace","include"]}})})}).call(e,o(0))},function(t,e,o){var n,i,r;/*! jQuery UI - v1.11.1+CommonJS - 2014-09-17
* http://jqueryui.com
* Includes: widget.js
* Copyright 2014 jQuery Foundation and other contributors; Licensed MIT */
!function(s){i=[o(0)],n=s,void 0!==(r="function"==typeof n?n.apply(e,i):n)&&(t.exports=r)}(function(t){/*!
 * jQuery UI Widget 1.11.1
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */
var e=0,o=Array.prototype.slice;t.cleanData=function(e){return function(o){var n,i,r;for(r=0;null!=(i=o[r]);r++)try{n=t._data(i,"events"),n&&n.remove&&t(i).triggerHandler("remove")}catch(t){}e(o)}}(t.cleanData),t.widget=function(e,o,n){var i,r,s,a,l={},c=e.split(".")[0];return e=e.split(".")[1],i=c+"-"+e,n||(n=o,o=t.Widget),t.expr[":"][i.toLowerCase()]=function(e){return!!t.data(e,i)},t[c]=t[c]||{},r=t[c][e],s=t[c][e]=function(t,e){if(!this._createWidget)return new s(t,e);arguments.length&&this._createWidget(t,e)},t.extend(s,r,{version:n.version,_proto:t.extend({},n),_childConstructors:[]}),a=new o,a.options=t.widget.extend({},a.options),t.each(n,function(e,n){if(!t.isFunction(n))return void(l[e]=n);l[e]=function(){var t=function(){return o.prototype[e].apply(this,arguments)},i=function(t){return o.prototype[e].apply(this,t)};return function(){var e,o=this._super,r=this._superApply;return this._super=t,this._superApply=i,e=n.apply(this,arguments),this._super=o,this._superApply=r,e}}()}),s.prototype=t.widget.extend(a,{widgetEventPrefix:r?a.widgetEventPrefix||e:e},l,{constructor:s,namespace:c,widgetName:e,widgetFullName:i}),r?(t.each(r._childConstructors,function(e,o){var n=o.prototype;t.widget(n.namespace+"."+n.widgetName,s,o._proto)}),delete r._childConstructors):o._childConstructors.push(s),t.widget.bridge(e,s),s},t.widget.extend=function(e){for(var n,i,r=o.call(arguments,1),s=0,a=r.length;s<a;s++)for(n in r[s])i=r[s][n],r[s].hasOwnProperty(n)&&void 0!==i&&(t.isPlainObject(i)?e[n]=t.isPlainObject(e[n])?t.widget.extend({},e[n],i):t.widget.extend({},i):e[n]=i);return e},t.widget.bridge=function(e,n){var i=n.prototype.widgetFullName||e;t.fn[e]=function(r){var s="string"==typeof r,a=o.call(arguments,1),l=this;return r=!s&&a.length?t.widget.extend.apply(null,[r].concat(a)):r,s?this.each(function(){var o,n=t.data(this,i);return"instance"===r?(l=n,!1):n?t.isFunction(n[r])&&"_"!==r.charAt(0)?(o=n[r].apply(n,a),o!==n&&void 0!==o?(l=o&&o.jquery?l.pushStack(o.get()):o,!1):void 0):t.error("no such method '"+r+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+r+"'")}):this.each(function(){var e=t.data(this,i);e?(e.option(r||{}),e._init&&e._init()):t.data(this,i,new n(r,this))}),l}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(o,n){n=t(n||this.defaultElement||this)[0],this.element=t(n),this.uuid=e++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=t.widget.extend({},this.options,this._getCreateOptions(),o),this.bindings=t(),this.hoverable=t(),this.focusable=t(),n!==this&&(t.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===n&&this.destroy()}}),this.document=t(n.style?n.ownerDocument:n.document||n),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(e,o){var n,i,r,s=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(s={},n=e.split("."),e=n.shift(),n.length){for(i=s[e]=t.widget.extend({},this.options[e]),r=0;r<n.length-1;r++)i[n[r]]=i[n[r]]||{},i=i[n[r]];if(e=n.pop(),1===arguments.length)return void 0===i[e]?null:i[e];i[e]=o}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];s[e]=o}return this._setOptions(s),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!e),e&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(e,o,n){var i,r=this;"boolean"!=typeof e&&(n=o,o=e,e=!1),n?(o=i=t(o),this.bindings=this.bindings.add(o)):(n=o,o=this.element,i=this.widget()),t.each(n,function(n,s){function a(){if(e||!0!==r.options.disabled&&!t(this).hasClass("ui-state-disabled"))return("string"==typeof s?r[s]:s).apply(r,arguments)}"string"!=typeof s&&(a.guid=s.guid=s.guid||a.guid||t.guid++);var l=n.match(/^([\w:-]*)\s*(.*)$/),c=l[1]+r.eventNamespace,u=l[2];u?i.delegate(u,c,a):o.bind(c,a)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e)},_delay:function(t,e){function o(){return("string"==typeof t?n[t]:t).apply(n,arguments)}var n=this;return setTimeout(o,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,o,n){var i,r,s=this.options[e];if(n=n||{},o=t.Event(o),o.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),o.target=this.element[0],r=o.originalEvent)for(i in r)i in o||(o[i]=r[i]);return this.element.trigger(o,n),!(t.isFunction(s)&&!1===s.apply(this.element[0],[o].concat(n))||o.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,o){t.Widget.prototype["_"+e]=function(n,i,r){"string"==typeof i&&(i={effect:i});var s,a=i?!0===i||"number"==typeof i?o:i.effect||o:e;i=i||{},"number"==typeof i&&(i={duration:i}),s=!t.isEmptyObject(i),i.complete=r,i.delay&&n.delay(i.delay),s&&t.effects&&t.effects.effect[a]?n[e](i):a!==e&&n[a]?n[a](i.duration,i.easing,r):n.queue(function(o){t(this)[e](),r&&r.call(n[0]),o()})}});t.widget})},function(t,e,o){var n=o(8);window.$=n,window.jQuery=n;o(36);var i=o(9);window.jQuerySvg=i,o(35),o(32),o(37),o(39),o(38),o(30),o(34),o(5),o(31),o(29),o(33),o(24),o(12),o(25),o(26),o(22),o(28),o(11),o(40);var r=o(14);window.Raphael=r,o(27);var s=o(4);window.CodeMirror=s,o(42),o(41);var a=o(15);window._=a;var l=o(13);window.jsondiffpatch=l,window.goog=window.goog||{provide:function(t){console.log('goog.provide("'+t+'")')},require:function(t){console.log('goog.provide("'+t+'")')}};var c=o(17);window.Blockly=c;var u=o(23);window.Promise=u;var h=o(43);window.THREE=h,o(19),o(18)},function(t,e,o){o(47),o(45),o(46),o(67),o(66),o(79),o(75),o(72),o(73),o(74),o(77),o(76),o(70),o(63),o(60),o(61),o(81),o(80),o(50),o(62),o(69),o(64),o(65),o(78),o(16);var n=o(10);window.Spinner=n,o(59),o(51),o(54),o(53),o(52),o(55),o(57),o(58),o(56),o(48),o(49),o(71),o(68)},function(t,e,o){(function(n){var i,r;/*! jQuery v2.1.1 | (c) 2005, 2014 jQuery Foundation, Inc. | jquery.org/license */
!function(e,o){"object"==typeof t&&"object"==typeof t.exports?t.exports=e.document?o(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return o(t)}:o(e)}("undefined"!=typeof window?window:this,function(n,s){function a(t){var e=t.length,o=it.type(t);return"function"!==o&&!it.isWindow(t)&&(!(1!==t.nodeType||!e)||("array"===o||0===e||"number"==typeof e&&e>0&&e-1 in t))}function l(t,e,o){if(it.isFunction(e))return it.grep(t,function(t,n){return!!e.call(t,n,t)!==o});if(e.nodeType)return it.grep(t,function(t){return t===e!==o});if("string"==typeof e){if(gt.test(e))return it.filter(e,t,o);e=it.filter(e,t)}return it.grep(t,function(t){return Q.call(e,t)>=0!==o})}function c(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function u(t){var e=vt[t]={};return it.each(t.match(yt)||[],function(t,o){e[o]=!0}),e}function h(){ot.removeEventListener("DOMContentLoaded",h,!1),n.removeEventListener("load",h,!1),it.ready()}function g(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=it.expando+Math.random()}function p(t,e,o){var n;if(void 0===o&&1===t.nodeType)if(n="data-"+e.replace(Tt,"-$1").toLowerCase(),"string"==typeof(o=t.getAttribute(n))){try{o="true"===o||"false"!==o&&("null"===o?null:+o+""===o?+o:St.test(o)?it.parseJSON(o):o)}catch(t){}xt.set(t,e,o)}else o=void 0;return o}function d(){return!0}function f(){return!1}function m(){try{return ot.activeElement}catch(t){}}function y(t,e){return it.nodeName(t,"table")&&it.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function v(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function _(t){var e=Ht.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function b(t,e){for(var o=0,n=t.length;n>o;o++)Et.set(t[o],"globalEval",!e||Et.get(e[o],"globalEval"))}function E(t,e){var o,n,i,r,s,a,l,c;if(1===e.nodeType){if(Et.hasData(t)&&(r=Et.access(t),s=Et.set(e,r),c=r.events)){delete s.handle,s.events={};for(i in c)for(o=0,n=c[i].length;n>o;o++)it.event.add(e,i,c[i][o])}xt.hasData(t)&&(a=xt.access(t),l=it.extend({},a),xt.set(e,l))}}function x(t,e){var o=t.getElementsByTagName?t.getElementsByTagName(e||"*"):t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&it.nodeName(t,e)?it.merge([t],o):o}function S(t,e){var o=e.nodeName.toLowerCase();"input"===o&&At.test(t.type)?e.checked=t.checked:("input"===o||"textarea"===o)&&(e.defaultValue=t.defaultValue)}function T(t,e){var o,i=it(e.createElement(t)).appendTo(e.body),r=n.getDefaultComputedStyle&&(o=n.getDefaultComputedStyle(i[0]))?o.display:it.css(i[0],"display");return i.detach(),r}function w(t){var e=ot,o=Wt[t];return o||(o=T(t,e),"none"!==o&&o||(Vt=(Vt||it("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement),e=Vt[0].contentDocument,e.write(),e.close(),o=T(t,e),Vt.detach()),Wt[t]=o),o}function C(t,e,o){var n,i,r,s,a=t.style;return o=o||Xt(t),o&&(s=o.getPropertyValue(e)||o[e]),o&&(""!==s||it.contains(t.ownerDocument,t)||(s=it.style(t,e)),qt.test(s)&&zt.test(e)&&(n=a.width,i=a.minWidth,r=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=o.width,a.width=n,a.minWidth=i,a.maxWidth=r)),void 0!==s?s+"":s}function k(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}function A(t,e){if(e in t)return e;for(var o=e[0].toUpperCase()+e.slice(1),n=e,i=Zt.length;i--;)if((e=Zt[i]+o)in t)return e;return n}function I(t,e,o){var n=Kt.exec(e);return n?Math.max(0,n[1]-(o||0))+(n[2]||"px"):e}function B(t,e,o,n,i){for(var r=o===(n?"border":"content")?4:"width"===e?1:0,s=0;4>r;r+=2)"margin"===o&&(s+=it.css(t,o+Ct[r],!0,i)),n?("content"===o&&(s-=it.css(t,"padding"+Ct[r],!0,i)),"margin"!==o&&(s-=it.css(t,"border"+Ct[r]+"Width",!0,i))):(s+=it.css(t,"padding"+Ct[r],!0,i),"padding"!==o&&(s+=it.css(t,"border"+Ct[r]+"Width",!0,i)));return s}function M(t,e,o){var n=!0,i="width"===e?t.offsetWidth:t.offsetHeight,r=Xt(t),s="border-box"===it.css(t,"boxSizing",!1,r);if(0>=i||null==i){if(i=C(t,e,r),(0>i||null==i)&&(i=t.style[e]),qt.test(i))return i;n=s&&(et.boxSizingReliable()||i===t.style[e]),i=parseFloat(i)||0}return i+B(t,e,o||(s?"border":"content"),n,r)+"px"}function L(t,e){for(var o,n,i,r=[],s=0,a=t.length;a>s;s++)n=t[s],n.style&&(r[s]=Et.get(n,"olddisplay"),o=n.style.display,e?(r[s]||"none"!==o||(n.style.display=""),""===n.style.display&&kt(n)&&(r[s]=Et.access(n,"olddisplay",w(n.nodeName)))):(i=kt(n),"none"===o&&i||Et.set(n,"olddisplay",i?o:it.css(n,"display"))));for(s=0;a>s;s++)n=t[s],n.style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?r[s]||"":"none"));return t}function N(t,e,o,n,i){return new N.prototype.init(t,e,o,n,i)}function R(){return setTimeout(function(){te=void 0}),te=it.now()}function D(t,e){var o,n=0,i={height:t};for(e=e?1:0;4>n;n+=2-e)o=Ct[n],i["margin"+o]=i["padding"+o]=t;return e&&(i.opacity=i.width=t),i}function O(t,e,o){for(var n,i=(se[e]||[]).concat(se["*"]),r=0,s=i.length;s>r;r++)if(n=i[r].call(o,e,t))return n}function P(t,e,o){var n,i,r,s,a,l,c,u=this,h={},g=t.style,p=t.nodeType&&kt(t),d=Et.get(t,"fxshow");o.queue||(a=it._queueHooks(t,"fx"),null==a.unqueued&&(a.unqueued=0,l=a.empty.fire,a.empty.fire=function(){a.unqueued||l()}),a.unqueued++,u.always(function(){u.always(function(){a.unqueued--,it.queue(t,"fx").length||a.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(o.overflow=[g.overflow,g.overflowX,g.overflowY],c=it.css(t,"display"),"inline"===("none"===c?Et.get(t,"olddisplay")||w(t.nodeName):c)&&"none"===it.css(t,"float")&&(g.display="inline-block")),o.overflow&&(g.overflow="hidden",u.always(function(){g.overflow=o.overflow[0],g.overflowX=o.overflow[1],g.overflowY=o.overflow[2]}));for(n in e)if(i=e[n],oe.exec(i)){if(delete e[n],r=r||"toggle"===i,i===(p?"hide":"show")){if("show"!==i||!d||void 0===d[n])continue;p=!0}h[n]=d&&d[n]||it.style(t,n)}else c=void 0;if(it.isEmptyObject(h))"inline"===("none"===c?w(t.nodeName):c)&&(g.display=c);else{d?"hidden"in d&&(p=d.hidden):d=Et.access(t,"fxshow",{}),r&&(d.hidden=!p),p?it(t).show():u.done(function(){it(t).hide()}),u.done(function(){var e;Et.remove(t,"fxshow");for(e in h)it.style(t,e,h[e])});for(n in h)s=O(p?d[n]:0,n,u),n in d||(d[n]=s.start,p&&(s.end=s.start,s.start="width"===n||"height"===n?1:0))}}function j(t,e){var o,n,i,r,s;for(o in t)if(n=it.camelCase(o),i=e[n],r=t[o],it.isArray(r)&&(i=r[1],r=t[o]=r[0]),o!==n&&(t[n]=r,delete t[o]),(s=it.cssHooks[n])&&"expand"in s){r=s.expand(r),delete t[n];for(o in r)o in t||(t[o]=r[o],e[o]=i)}else e[n]=i}function F(t,e,o){var n,i,r=0,s=re.length,a=it.Deferred().always(function(){delete l.elem}),l=function(){if(i)return!1;for(var e=te||R(),o=Math.max(0,c.startTime+c.duration-e),n=o/c.duration||0,r=1-n,s=0,l=c.tweens.length;l>s;s++)c.tweens[s].run(r);return a.notifyWith(t,[c,r,o]),1>r&&l?o:(a.resolveWith(t,[c]),!1)},c=a.promise({elem:t,props:it.extend({},e),opts:it.extend(!0,{specialEasing:{}},o),originalProperties:e,originalOptions:o,startTime:te||R(),duration:o.duration,tweens:[],createTween:function(e,o){var n=it.Tween(t,c.opts,e,o,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(n),n},stop:function(e){var o=0,n=e?c.tweens.length:0;if(i)return this;for(i=!0;n>o;o++)c.tweens[o].run(1);return e?a.resolveWith(t,[c,e]):a.rejectWith(t,[c,e]),this}}),u=c.props;for(j(u,c.opts.specialEasing);s>r;r++)if(n=re[r].call(c,t,u,c.opts))return n;return it.map(u,O,c),it.isFunction(c.opts.start)&&c.opts.start.call(t,c),it.fx.timer(it.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function H(t){return function(e,o){"string"!=typeof e&&(o=e,e="*");var n,i=0,r=e.toLowerCase().match(yt)||[];if(it.isFunction(o))for(;n=r[i++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(o)):(t[n]=t[n]||[]).push(o)}}function U(t,e,o,n){function i(a){var l;return r[a]=!0,it.each(t[a]||[],function(t,a){var c=a(e,o,n);return"string"!=typeof c||s||r[c]?s?!(l=c):void 0:(e.dataTypes.unshift(c),i(c),!1)}),l}var r={},s=t===Te;return i(e.dataTypes[0])||!r["*"]&&i("*")}function G(t,e){var o,n,i=it.ajaxSettings.flatOptions||{};for(o in e)void 0!==e[o]&&((i[o]?t:n||(n={}))[o]=e[o]);return n&&it.extend(!0,t,n),t}function V(t,e,o){for(var n,i,r,s,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(i in a)if(a[i]&&a[i].test(n)){l.unshift(i);break}if(l[0]in o)r=l[0];else{for(i in o){if(!l[0]||t.converters[i+" "+l[0]]){r=i;break}s||(s=i)}r=r||s}return r?(r!==l[0]&&l.unshift(r),o[r]):void 0}function W(t,e,o,n){var i,r,s,a,l,c={},u=t.dataTypes.slice();if(u[1])for(s in t.converters)c[s.toLowerCase()]=t.converters[s];for(r=u.shift();r;)if(t.responseFields[r]&&(o[t.responseFields[r]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=r,r=u.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(!(s=c[l+" "+r]||c["* "+r]))for(i in c)if(a=i.split(" "),a[1]===r&&(s=c[l+" "+a[0]]||c["* "+a[0]])){!0===s?s=c[i]:!0!==c[i]&&(r=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(t){return{state:"parsererror",error:s?t:"No conversion from "+l+" to "+r}}}return{state:"success",data:e}}function z(t,e,o,n){var i;if(it.isArray(e))it.each(e,function(e,i){o||ke.test(t)?n(t,i):z(t+"["+("object"==typeof i?e:"")+"]",i,o,n)});else if(o||"object"!==it.type(e))n(t,e);else for(i in e)z(t+"["+i+"]",e[i],o,n)}function q(t){return it.isWindow(t)?t:9===t.nodeType&&t.defaultView}var X=[],Y=X.slice,K=X.concat,$=X.push,Q=X.indexOf,J={},Z=J.toString,tt=J.hasOwnProperty,et={},ot=n.document,nt="2.1.1",it=function(t,e){return new it.fn.init(t,e)},rt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,st=/^-ms-/,at=/-([\da-z])/gi,lt=function(t,e){return e.toUpperCase()};it.fn=it.prototype={jquery:nt,constructor:it,selector:"",length:0,toArray:function(){return Y.call(this)},get:function(t){return null!=t?0>t?this[t+this.length]:this[t]:Y.call(this)},pushStack:function(t){var e=it.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return it.each(this,t,e)},map:function(t){return this.pushStack(it.map(this,function(e,o){return t.call(e,o,e)}))},slice:function(){return this.pushStack(Y.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,o=+t+(0>t?e:0);return this.pushStack(o>=0&&e>o?[this[o]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:$,sort:X.sort,splice:X.splice},it.extend=it.fn.extend=function(){var t,e,o,n,i,r,s=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[a]||{},a++),"object"==typeof s||it.isFunction(s)||(s={}),a===l&&(s=this,a--);l>a;a++)if(null!=(t=arguments[a]))for(e in t)o=s[e],n=t[e],s!==n&&(c&&n&&(it.isPlainObject(n)||(i=it.isArray(n)))?(i?(i=!1,r=o&&it.isArray(o)?o:[]):r=o&&it.isPlainObject(o)?o:{},s[e]=it.extend(c,r,n)):void 0!==n&&(s[e]=n));return s},it.extend({expando:"jQuery"+(nt+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===it.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){return!it.isArray(t)&&t-parseFloat(t)>=0},isPlainObject:function(t){return"object"===it.type(t)&&!t.nodeType&&!it.isWindow(t)&&!(t.constructor&&!tt.call(t.constructor.prototype,"isPrototypeOf"))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?J[Z.call(t)]||"object":typeof t},globalEval:function(t){var e,o=eval;(t=it.trim(t))&&(1===t.indexOf("use strict")?(e=ot.createElement("script"),e.text=t,ot.head.appendChild(e).parentNode.removeChild(e)):o(t))},camelCase:function(t){return t.replace(st,"ms-").replace(at,lt)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,o){var n=0,i=t.length,r=a(t);if(o){if(r)for(;i>n&&!1!==e.apply(t[n],o);n++);else for(n in t)if(!1===e.apply(t[n],o))break}else if(r)for(;i>n&&!1!==e.call(t[n],n,t[n]);n++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},trim:function(t){return null==t?"":(t+"").replace(rt,"")},makeArray:function(t,e){var o=e||[];return null!=t&&(a(Object(t))?it.merge(o,"string"==typeof t?[t]:t):$.call(o,t)),o},inArray:function(t,e,o){return null==e?-1:Q.call(e,t,o)},merge:function(t,e){for(var o=+e.length,n=0,i=t.length;o>n;n++)t[i++]=e[n];return t.length=i,t},grep:function(t,e,o){for(var n=[],i=0,r=t.length,s=!o;r>i;i++)!e(t[i],i)!==s&&n.push(t[i]);return n},map:function(t,e,o){var n,i=0,r=t.length,s=a(t),l=[];if(s)for(;r>i;i++)null!=(n=e(t[i],i,o))&&l.push(n);else for(i in t)null!=(n=e(t[i],i,o))&&l.push(n);return K.apply([],l)},guid:1,proxy:function(t,e){var o,n,i;return"string"==typeof e&&(o=t[e],e=t,t=o),it.isFunction(t)?(n=Y.call(arguments,2),i=function(){return t.apply(e||this,n.concat(Y.call(arguments)))},i.guid=t.guid=t.guid||it.guid++,i):void 0},now:Date.now,support:et}),it.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){J["[object "+e+"]"]=e.toLowerCase()});var ct=function(t){function e(t,e,o,n){var i,r,s,a,c,h,g,p,d,f;if((e?e.ownerDocument||e:j)!==B&&I(e),e=e||B,o=o||[],!t||"string"!=typeof t)return o;if(1!==(a=e.nodeType)&&9!==a)return[];if(L&&!n){if(i=mt.exec(t))if(s=i[1]){if(9===a){if(!(r=e.getElementById(s))||!r.parentNode)return o;if(r.id===s)return o.push(r),o}else if(e.ownerDocument&&(r=e.ownerDocument.getElementById(s))&&O(e,r)&&r.id===s)return o.push(r),o}else{if(i[2])return Q.apply(o,e.getElementsByTagName(t)),o;if((s=i[3])&&_.getElementsByClassName&&e.getElementsByClassName)return Q.apply(o,e.getElementsByClassName(s)),o}if(_.qsa&&(!N||!N.test(t))){if(p=g=P,d=e,f=9===a&&t,1===a&&"object"!==e.nodeName.toLowerCase()){for(h=S(t),(g=e.getAttribute("id"))?p=g.replace(vt,"\\$&"):e.setAttribute("id",p),p="[id='"+p+"'] ",c=h.length;c--;)h[c]=p+u(h[c]);d=yt.test(t)&&l(e.parentNode)||e,f=h.join(",")}if(f)try{return Q.apply(o,d.querySelectorAll(f)),o}catch(t){}finally{g||e.removeAttribute("id")}}}return w(t.replace(st,"$1"),e,o,n)}function o(){function t(o,n){return e.push(o+" ")>b.cacheLength&&delete t[e.shift()],t[o+" "]=n}var e=[];return t}function n(t){return t[P]=!0,t}function i(t){var e=B.createElement("div");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function r(t,e){for(var o=t.split("|"),n=t.length;n--;)b.attrHandle[o[n]]=e}function s(t,e){var o=e&&t,n=o&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||q)-(~t.sourceIndex||q);if(n)return n;if(o)for(;o=o.nextSibling;)if(o===e)return-1;return t?1:-1}function a(t){return n(function(e){return e=+e,n(function(o,n){for(var i,r=t([],o.length,e),s=r.length;s--;)o[i=r[s]]&&(o[i]=!(n[i]=o[i]))})})}function l(t){return t&&typeof t.getElementsByTagName!==z&&t}function c(){}function u(t){for(var e=0,o=t.length,n="";o>e;e++)n+=t[e].value;return n}function h(t,e,o){var n=e.dir,i=o&&"parentNode"===n,r=H++;return e.first?function(e,o,r){for(;e=e[n];)if(1===e.nodeType||i)return t(e,o,r)}:function(e,o,s){var a,l,c=[F,r];if(s){for(;e=e[n];)if((1===e.nodeType||i)&&t(e,o,s))return!0}else for(;e=e[n];)if(1===e.nodeType||i){if(l=e[P]||(e[P]={}),(a=l[n])&&a[0]===F&&a[1]===r)return c[2]=a[2];if(l[n]=c,c[2]=t(e,o,s))return!0}}}function g(t){return t.length>1?function(e,o,n){for(var i=t.length;i--;)if(!t[i](e,o,n))return!1;return!0}:t[0]}function p(t,o,n){for(var i=0,r=o.length;r>i;i++)e(t,o[i],n);return n}function d(t,e,o,n,i){for(var r,s=[],a=0,l=t.length,c=null!=e;l>a;a++)(r=t[a])&&(!o||o(r,n,i))&&(s.push(r),c&&e.push(a));return s}function f(t,e,o,i,r,s){return i&&!i[P]&&(i=f(i)),r&&!r[P]&&(r=f(r,s)),n(function(n,s,a,l){var c,u,h,g=[],f=[],m=s.length,y=n||p(e||"*",a.nodeType?[a]:a,[]),v=!t||!n&&e?y:d(y,g,t,a,l),_=o?r||(n?t:m||i)?[]:s:v;if(o&&o(v,_,a,l),i)for(c=d(_,f),i(c,[],a,l),u=c.length;u--;)(h=c[u])&&(_[f[u]]=!(v[f[u]]=h));if(n){if(r||t){if(r){for(c=[],u=_.length;u--;)(h=_[u])&&c.push(v[u]=h);r(null,_=[],c,l)}for(u=_.length;u--;)(h=_[u])&&(c=r?Z.call(n,h):g[u])>-1&&(n[c]=!(s[c]=h))}}else _=d(_===s?_.splice(m,_.length):_),r?r(null,s,_,l):Q.apply(s,_)})}function m(t){for(var e,o,n,i=t.length,r=b.relative[t[0].type],s=r||b.relative[" "],a=r?1:0,l=h(function(t){return t===e},s,!0),c=h(function(t){return Z.call(e,t)>-1},s,!0),p=[function(t,o,n){return!r&&(n||o!==C)||((e=o).nodeType?l(t,o,n):c(t,o,n))}];i>a;a++)if(o=b.relative[t[a].type])p=[h(g(p),o)];else{if(o=b.filter[t[a].type].apply(null,t[a].matches),o[P]){for(n=++a;i>n&&!b.relative[t[n].type];n++);return f(a>1&&g(p),a>1&&u(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(st,"$1"),o,n>a&&m(t.slice(a,n)),i>n&&m(t=t.slice(n)),i>n&&u(t))}p.push(o)}return g(p)}function y(t,o){var i=o.length>0,r=t.length>0,s=function(n,s,a,l,c){var u,h,g,p=0,f="0",m=n&&[],y=[],v=C,_=n||r&&b.find.TAG("*",c),E=F+=null==v?1:Math.random()||.1,x=_.length;for(c&&(C=s!==B&&s);f!==x&&null!=(u=_[f]);f++){if(r&&u){for(h=0;g=t[h++];)if(g(u,s,a)){l.push(u);break}c&&(F=E)}i&&((u=!g&&u)&&p--,n&&m.push(u))}if(p+=f,i&&f!==p){for(h=0;g=o[h++];)g(m,y,s,a);if(n){if(p>0)for(;f--;)m[f]||y[f]||(y[f]=K.call(l));y=d(y)}Q.apply(l,y),c&&!n&&y.length>0&&p+o.length>1&&e.uniqueSort(l)}return c&&(F=E,C=v),m};return i?n(s):s}var v,_,b,E,x,S,T,w,C,k,A,I,B,M,L,N,R,D,O,P="sizzle"+-new Date,j=t.document,F=0,H=0,U=o(),G=o(),V=o(),W=function(t,e){return t===e&&(A=!0),0},z="undefined",q=1<<31,X={}.hasOwnProperty,Y=[],K=Y.pop,$=Y.push,Q=Y.push,J=Y.slice,Z=Y.indexOf||function(t){for(var e=0,o=this.length;o>e;e++)if(this[e]===t)return e;return-1},tt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",et="[\\x20\\t\\r\\n\\f]",ot="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",nt=ot.replace("w","w#"),it="\\["+et+"*("+ot+")(?:"+et+"*([*^$|!~]?=)"+et+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+nt+"))|)"+et+"*\\]",rt=":("+ot+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+it+")*)|.*)\\)|)",st=new RegExp("^"+et+"+|((?:^|[^\\\\])(?:\\\\.)*)"+et+"+$","g"),at=new RegExp("^"+et+"*,"+et+"*"),lt=new RegExp("^"+et+"*([>+~]|"+et+")"+et+"*"),ct=new RegExp("="+et+"*([^\\]'\"]*?)"+et+"*\\]","g"),ut=new RegExp(rt),ht=new RegExp("^"+nt+"$"),gt={ID:new RegExp("^#("+ot+")"),CLASS:new RegExp("^\\.("+ot+")"),TAG:new RegExp("^("+ot.replace("w","w*")+")"),ATTR:new RegExp("^"+it),PSEUDO:new RegExp("^"+rt),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+et+"*(even|odd|(([+-]|)(\\d*)n|)"+et+"*(?:([+-]|)"+et+"*(\\d+)|))"+et+"*\\)|)","i"),bool:new RegExp("^(?:"+tt+")$","i"),needsContext:new RegExp("^"+et+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+et+"*((?:-\\d)?\\d*)"+et+"*\\)|)(?=[^-]|$)","i")},pt=/^(?:input|select|textarea|button)$/i,dt=/^h\d$/i,ft=/^[^{]+\{\s*\[native \w/,mt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,yt=/[+~]/,vt=/'|\\/g,_t=new RegExp("\\\\([\\da-f]{1,6}"+et+"?|("+et+")|.)","ig"),bt=function(t,e,o){var n="0x"+e-65536;return n!==n||o?e:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)};try{Q.apply(Y=J.call(j.childNodes),j.childNodes),Y[j.childNodes.length].nodeType}catch(t){Q={apply:Y.length?function(t,e){$.apply(t,J.call(e))}:function(t,e){for(var o=t.length,n=0;t[o++]=e[n++];);t.length=o-1}}}_=e.support={},x=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},I=e.setDocument=function(t){var e,o=t?t.ownerDocument||t:j,n=o.defaultView;return o!==B&&9===o.nodeType&&o.documentElement?(B=o,M=o.documentElement,L=!x(o),n&&n!==n.top&&(n.addEventListener?n.addEventListener("unload",function(){I()},!1):n.attachEvent&&n.attachEvent("onunload",function(){I()})),_.attributes=i(function(t){return t.className="i",!t.getAttribute("className")}),_.getElementsByTagName=i(function(t){return t.appendChild(o.createComment("")),!t.getElementsByTagName("*").length}),_.getElementsByClassName=ft.test(o.getElementsByClassName)&&i(function(t){return t.innerHTML="<div class='a'></div><div class='a i'></div>",t.firstChild.className="i",2===t.getElementsByClassName("i").length}),_.getById=i(function(t){return M.appendChild(t).id=P,!o.getElementsByName||!o.getElementsByName(P).length}),_.getById?(b.find.ID=function(t,e){if(typeof e.getElementById!==z&&L){var o=e.getElementById(t);return o&&o.parentNode?[o]:[]}},b.filter.ID=function(t){var e=t.replace(_t,bt);return function(t){return t.getAttribute("id")===e}}):(delete b.find.ID,b.filter.ID=function(t){var e=t.replace(_t,bt);return function(t){var o=typeof t.getAttributeNode!==z&&t.getAttributeNode("id");return o&&o.value===e}}),b.find.TAG=_.getElementsByTagName?function(t,e){return typeof e.getElementsByTagName!==z?e.getElementsByTagName(t):void 0}:function(t,e){var o,n=[],i=0,r=e.getElementsByTagName(t);if("*"===t){for(;o=r[i++];)1===o.nodeType&&n.push(o);return n}return r},b.find.CLASS=_.getElementsByClassName&&function(t,e){return typeof e.getElementsByClassName!==z&&L?e.getElementsByClassName(t):void 0},R=[],N=[],(_.qsa=ft.test(o.querySelectorAll))&&(i(function(t){t.innerHTML="<select msallowclip=''><option selected=''></option></select>",t.querySelectorAll("[msallowclip^='']").length&&N.push("[*^$]="+et+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||N.push("\\["+et+"*(?:value|"+tt+")"),t.querySelectorAll(":checked").length||N.push(":checked")}),i(function(t){var e=o.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&N.push("name"+et+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||N.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),N.push(",.*:")})),(_.matchesSelector=ft.test(D=M.matches||M.webkitMatchesSelector||M.mozMatchesSelector||M.oMatchesSelector||M.msMatchesSelector))&&i(function(t){_.disconnectedMatch=D.call(t,"div"),D.call(t,"[s!='']:x"),R.push("!=",rt)}),N=N.length&&new RegExp(N.join("|")),R=R.length&&new RegExp(R.join("|")),e=ft.test(M.compareDocumentPosition),O=e||ft.test(M.contains)?function(t,e){var o=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(o.contains?o.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},W=e?function(t,e){if(t===e)return A=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n||(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&n||!_.sortDetached&&e.compareDocumentPosition(t)===n?t===o||t.ownerDocument===j&&O(j,t)?-1:e===o||e.ownerDocument===j&&O(j,e)?1:k?Z.call(k,t)-Z.call(k,e):0:4&n?-1:1)}:function(t,e){if(t===e)return A=!0,0;var n,i=0,r=t.parentNode,a=e.parentNode,l=[t],c=[e];if(!r||!a)return t===o?-1:e===o?1:r?-1:a?1:k?Z.call(k,t)-Z.call(k,e):0;if(r===a)return s(t,e);for(n=t;n=n.parentNode;)l.unshift(n);for(n=e;n=n.parentNode;)c.unshift(n);for(;l[i]===c[i];)i++;return i?s(l[i],c[i]):l[i]===j?-1:c[i]===j?1:0},o):B},e.matches=function(t,o){return e(t,null,null,o)},e.matchesSelector=function(t,o){if((t.ownerDocument||t)!==B&&I(t),o=o.replace(ct,"='$1']"),!(!_.matchesSelector||!L||R&&R.test(o)||N&&N.test(o)))try{var n=D.call(t,o);if(n||_.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(t){}return e(o,B,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==B&&I(t),O(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==B&&I(t);var o=b.attrHandle[e.toLowerCase()],n=o&&X.call(b.attrHandle,e.toLowerCase())?o(t,e,!L):void 0;return void 0!==n?n:_.attributes||!L?t.getAttribute(e):(n=t.getAttributeNode(e))&&n.specified?n.value:null},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,o=[],n=0,i=0;if(A=!_.detectDuplicates,k=!_.sortStable&&t.slice(0),t.sort(W),A){for(;e=t[i++];)e===t[i]&&(n=o.push(i));for(;n--;)t.splice(o[n],1)}return k=null,t},E=e.getText=function(t){var e,o="",n=0,i=t.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)o+=E(t)}else if(3===i||4===i)return t.nodeValue}else for(;e=t[n++];)o+=E(e);return o},b=e.selectors={cacheLength:50,createPseudo:n,match:gt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(_t,bt),t[3]=(t[3]||t[4]||t[5]||"").replace(_t,bt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,o=!t[6]&&t[2];return gt.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":o&&ut.test(o)&&(e=S(o,!0))&&(e=o.indexOf(")",o.length-e)-o.length)&&(t[0]=t[0].slice(0,e),t[2]=o.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(_t,bt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=U[t+" "];return e||(e=new RegExp("(^|"+et+")"+t+"("+et+"|$)"))&&U(t,function(t){return e.test("string"==typeof t.className&&t.className||typeof t.getAttribute!==z&&t.getAttribute("class")||"")})},ATTR:function(t,o,n){return function(i){var r=e.attr(i,t);return null==r?"!="===o:!o||(r+="","="===o?r===n:"!="===o?r!==n:"^="===o?n&&0===r.indexOf(n):"*="===o?n&&r.indexOf(n)>-1:"$="===o?n&&r.slice(-n.length)===n:"~="===o?(" "+r+" ").indexOf(n)>-1:"|="===o&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,o,n,i){var r="nth"!==t.slice(0,3),s="last"!==t.slice(-4),a="of-type"===e;return 1===n&&0===i?function(t){return!!t.parentNode}:function(e,o,l){var c,u,h,g,p,d,f=r!==s?"nextSibling":"previousSibling",m=e.parentNode,y=a&&e.nodeName.toLowerCase(),v=!l&&!a;if(m){if(r){for(;f;){for(h=e;h=h[f];)if(a?h.nodeName.toLowerCase()===y:1===h.nodeType)return!1;d=f="only"===t&&!d&&"nextSibling"}return!0}if(d=[s?m.firstChild:m.lastChild],s&&v){for(u=m[P]||(m[P]={}),c=u[t]||[],p=c[0]===F&&c[1],g=c[0]===F&&c[2],h=p&&m.childNodes[p];h=++p&&h&&h[f]||(g=p=0)||d.pop();)if(1===h.nodeType&&++g&&h===e){u[t]=[F,p,g];break}}else if(v&&(c=(e[P]||(e[P]={}))[t])&&c[0]===F)g=c[1];else for(;(h=++p&&h&&h[f]||(g=p=0)||d.pop())&&((a?h.nodeName.toLowerCase()!==y:1!==h.nodeType)||!++g||(v&&((h[P]||(h[P]={}))[t]=[F,g]),h!==e)););return(g-=i)===n||g%n==0&&g/n>=0}}},PSEUDO:function(t,o){var i,r=b.pseudos[t]||b.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return r[P]?r(o):r.length>1?(i=[t,t,"",o],b.setFilters.hasOwnProperty(t.toLowerCase())?n(function(t,e){for(var n,i=r(t,o),s=i.length;s--;)n=Z.call(t,i[s]),t[n]=!(e[n]=i[s])}):function(t){return r(t,0,i)}):r}},pseudos:{not:n(function(t){var e=[],o=[],i=T(t.replace(st,"$1"));return i[P]?n(function(t,e,o,n){for(var r,s=i(t,null,n,[]),a=t.length;a--;)(r=s[a])&&(t[a]=!(e[a]=r))}):function(t,n,r){return e[0]=t,i(e,null,r,o),!o.pop()}}),has:n(function(t){return function(o){return e(t,o).length>0}}),contains:n(function(t){return function(e){return(e.textContent||e.innerText||E(e)).indexOf(t)>-1}}),lang:n(function(t){return ht.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(_t,bt).toLowerCase(),function(e){var o;do{if(o=L?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(o=o.toLowerCase())===t||0===o.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var o=t.location&&t.location.hash;return o&&o.slice(1)===e.id},root:function(t){return t===M},focus:function(t){return t===B.activeElement&&(!B.hasFocus||B.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!b.pseudos.empty(t)},header:function(t){return dt.test(t.nodeName)},input:function(t){return pt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:a(function(){return[0]}),last:a(function(t,e){return[e-1]}),eq:a(function(t,e,o){return[0>o?o+e:o]}),even:a(function(t,e){for(var o=0;e>o;o+=2)t.push(o);return t}),odd:a(function(t,e){for(var o=1;e>o;o+=2)t.push(o);return t}),lt:a(function(t,e,o){for(var n=0>o?o+e:o;--n>=0;)t.push(n);return t}),gt:a(function(t,e,o){for(var n=0>o?o+e:o;++n<e;)t.push(n);return t})}},b.pseudos.nth=b.pseudos.eq;for(v in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[v]=function(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}(v);for(v in{submit:!0,reset:!0})b.pseudos[v]=function(t){return function(e){var o=e.nodeName.toLowerCase();return("input"===o||"button"===o)&&e.type===t}}(v);return c.prototype=b.filters=b.pseudos,b.setFilters=new c,S=e.tokenize=function(t,o){var n,i,r,s,a,l,c,u=G[t+" "];if(u)return o?0:u.slice(0);for(a=t,l=[],c=b.preFilter;a;){(!n||(i=at.exec(a)))&&(i&&(a=a.slice(i[0].length)||a),l.push(r=[])),n=!1,(i=lt.exec(a))&&(n=i.shift(),r.push({value:n,type:i[0].replace(st," ")}),a=a.slice(n.length));for(s in b.filter)!(i=gt[s].exec(a))||c[s]&&!(i=c[s](i))||(n=i.shift(),r.push({value:n,type:s,matches:i}),a=a.slice(n.length));if(!n)break}return o?a.length:a?e.error(t):G(t,l).slice(0)},T=e.compile=function(t,e){var o,n=[],i=[],r=V[t+" "];if(!r){for(e||(e=S(t)),o=e.length;o--;)r=m(e[o]),r[P]?n.push(r):i.push(r);r=V(t,y(i,n)),r.selector=t}return r},w=e.select=function(t,e,o,n){var i,r,s,a,c,h="function"==typeof t&&t,g=!n&&S(t=h.selector||t);if(o=o||[],1===g.length){if(r=g[0]=g[0].slice(0),r.length>2&&"ID"===(s=r[0]).type&&_.getById&&9===e.nodeType&&L&&b.relative[r[1].type]){if(!(e=(b.find.ID(s.matches[0].replace(_t,bt),e)||[])[0]))return o;h&&(e=e.parentNode),t=t.slice(r.shift().value.length)}for(i=gt.needsContext.test(t)?0:r.length;i--&&(s=r[i],!b.relative[a=s.type]);)if((c=b.find[a])&&(n=c(s.matches[0].replace(_t,bt),yt.test(r[0].type)&&l(e.parentNode)||e))){if(r.splice(i,1),!(t=n.length&&u(r)))return Q.apply(o,n),o;break}}return(h||T(t,g))(n,e,!L,o,yt.test(t)&&l(e.parentNode)||e),o},_.sortStable=P.split("").sort(W).join("")===P,_.detectDuplicates=!!A,I(),_.sortDetached=i(function(t){return 1&t.compareDocumentPosition(B.createElement("div"))}),i(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||r("type|href|height|width",function(t,e,o){return o?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),_.attributes&&i(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||r("value",function(t,e,o){return o||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue}),i(function(t){return null==t.getAttribute("disabled")})||r(tt,function(t,e,o){var n;return o?void 0:!0===t[e]?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null}),e}(n);it.find=ct,it.expr=ct.selectors,it.expr[":"]=it.expr.pseudos,it.unique=ct.uniqueSort,it.text=ct.getText,it.isXMLDoc=ct.isXML,it.contains=ct.contains;var ut=it.expr.match.needsContext,ht=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,gt=/^.[^:#\[\.,]*$/;it.filter=function(t,e,o){var n=e[0];return o&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?it.find.matchesSelector(n,t)?[n]:[]:it.find.matches(t,it.grep(e,function(t){return 1===t.nodeType}))},it.fn.extend({find:function(t){var e,o=this.length,n=[],i=this;if("string"!=typeof t)return this.pushStack(it(t).filter(function(){for(e=0;o>e;e++)if(it.contains(i[e],this))return!0}));for(e=0;o>e;e++)it.find(t,i[e],n);return n=this.pushStack(o>1?it.unique(n):n),n.selector=this.selector?this.selector+" "+t:t,n},filter:function(t){return this.pushStack(l(this,t||[],!1))},not:function(t){return this.pushStack(l(this,t||[],!0))},is:function(t){return!!l(this,"string"==typeof t&&ut.test(t)?it(t):t||[],!1).length}});var pt,dt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(it.fn.init=function(t,e){var o,n;if(!t)return this;if("string"==typeof t){if(!(o="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:dt.exec(t))||!o[1]&&e)return!e||e.jquery?(e||pt).find(t):this.constructor(e).find(t);if(o[1]){if(e=e instanceof it?e[0]:e,it.merge(this,it.parseHTML(o[1],e&&e.nodeType?e.ownerDocument||e:ot,!0)),ht.test(o[1])&&it.isPlainObject(e))for(o in e)it.isFunction(this[o])?this[o](e[o]):this.attr(o,e[o]);return this}return n=ot.getElementById(o[2]),n&&n.parentNode&&(this.length=1,this[0]=n),this.context=ot,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):it.isFunction(t)?void 0!==pt.ready?pt.ready(t):t(it):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),it.makeArray(t,this))}).prototype=it.fn,pt=it(ot);var ft=/^(?:parents|prev(?:Until|All))/,mt={children:!0,contents:!0,next:!0,prev:!0};it.extend({dir:function(t,e,o){for(var n=[],i=void 0!==o;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(i&&it(t).is(o))break;n.push(t)}return n},sibling:function(t,e){for(var o=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&o.push(t);return o}}),it.fn.extend({has:function(t){var e=it(t,this),o=e.length;return this.filter(function(){for(var t=0;o>t;t++)if(it.contains(this,e[t]))return!0})},closest:function(t,e){for(var o,n=0,i=this.length,r=[],s=ut.test(t)||"string"!=typeof t?it(t,e||this.context):0;i>n;n++)for(o=this[n];o&&o!==e;o=o.parentNode)if(o.nodeType<11&&(s?s.index(o)>-1:1===o.nodeType&&it.find.matchesSelector(o,t))){r.push(o);break}return this.pushStack(r.length>1?it.unique(r):r)},index:function(t){return t?"string"==typeof t?Q.call(it(t),this[0]):Q.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(it.unique(it.merge(this.get(),it(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),it.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return it.dir(t,"parentNode")},parentsUntil:function(t,e,o){return it.dir(t,"parentNode",o)},next:function(t){return c(t,"nextSibling")},prev:function(t){return c(t,"previousSibling")},nextAll:function(t){return it.dir(t,"nextSibling")},prevAll:function(t){return it.dir(t,"previousSibling")},nextUntil:function(t,e,o){return it.dir(t,"nextSibling",o)},prevUntil:function(t,e,o){return it.dir(t,"previousSibling",o)},siblings:function(t){return it.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return it.sibling(t.firstChild)},contents:function(t){return t.contentDocument||it.merge([],t.childNodes)}},function(t,e){it.fn[t]=function(o,n){var i=it.map(this,e,o);return"Until"!==t.slice(-5)&&(n=o),n&&"string"==typeof n&&(i=it.filter(n,i)),this.length>1&&(mt[t]||it.unique(i),ft.test(t)&&i.reverse()),this.pushStack(i)}});var yt=/\S+/g,vt={};it.Callbacks=function(t){t="string"==typeof t?vt[t]||u(t):it.extend({},t);var e,o,n,i,r,s,a=[],l=!t.once&&[],c=function(u){for(e=t.memory&&u,o=!0,s=i||0,i=0,r=a.length,n=!0;a&&r>s;s++)if(!1===a[s].apply(u[0],u[1])&&t.stopOnFalse){e=!1;break}n=!1,a&&(l?l.length&&c(l.shift()):e?a=[]:h.disable())},h={add:function(){if(a){var o=a.length;!function e(o){it.each(o,function(o,n){var i=it.type(n);"function"===i?t.unique&&h.has(n)||a.push(n):n&&n.length&&"string"!==i&&e(n)})}(arguments),n?r=a.length:e&&(i=o,c(e))}return this},remove:function(){return a&&it.each(arguments,function(t,e){for(var o;(o=it.inArray(e,a,o))>-1;)a.splice(o,1),n&&(r>=o&&r--,s>=o&&s--)}),this},has:function(t){return t?it.inArray(t,a)>-1:!(!a||!a.length)},empty:function(){return a=[],r=0,this},disable:function(){return a=l=e=void 0,this},disabled:function(){return!a},lock:function(){return l=void 0,e||h.disable(),this},locked:function(){return!l},fireWith:function(t,e){return!a||o&&!l||(e=e||[],e=[t,e.slice?e.slice():e],n?l.push(e):c(e)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!o}};return h},it.extend({Deferred:function(t){var e=[["resolve","done",it.Callbacks("once memory"),"resolved"],["reject","fail",it.Callbacks("once memory"),"rejected"],["notify","progress",it.Callbacks("memory")]],o="pending",n={state:function(){return o},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var t=arguments;return it.Deferred(function(o){it.each(e,function(e,r){var s=it.isFunction(t[e])&&t[e];i[r[1]](function(){var t=s&&s.apply(this,arguments);t&&it.isFunction(t.promise)?t.promise().done(o.resolve).fail(o.reject).progress(o.notify):o[r[0]+"With"](this===n?o.promise():this,s?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?it.extend(t,n):n}},i={};return n.pipe=n.then,it.each(e,function(t,r){var s=r[2],a=r[3];n[r[1]]=s.add,a&&s.add(function(){o=a},e[1^t][2].disable,e[2][2].lock),i[r[0]]=function(){return i[r[0]+"With"](this===i?n:this,arguments),this},i[r[0]+"With"]=s.fireWith}),n.promise(i),t&&t.call(i,i),i},when:function(t){var e,o,n,i=0,r=Y.call(arguments),s=r.length,a=1!==s||t&&it.isFunction(t.promise)?s:0,l=1===a?t:it.Deferred(),c=function(t,o,n){return function(i){o[t]=this,n[t]=arguments.length>1?Y.call(arguments):i,n===e?l.notifyWith(o,n):--a||l.resolveWith(o,n)}};if(s>1)for(e=new Array(s),o=new Array(s),n=new Array(s);s>i;i++)r[i]&&it.isFunction(r[i].promise)?r[i].promise().done(c(i,n,r)).fail(l.reject).progress(c(i,o,e)):--a;return a||l.resolveWith(n,r),l.promise()}});var _t;it.fn.ready=function(t){return it.ready.promise().done(t),this},it.extend({isReady:!1,readyWait:1,holdReady:function(t){t?it.readyWait++:it.ready(!0)},ready:function(t){(!0===t?--it.readyWait:it.isReady)||(it.isReady=!0,!0!==t&&--it.readyWait>0||(_t.resolveWith(ot,[it]),it.fn.triggerHandler&&(it(ot).triggerHandler("ready"),it(ot).off("ready"))))}}),it.ready.promise=function(t){return _t||(_t=it.Deferred(),"complete"===ot.readyState?setTimeout(it.ready):(ot.addEventListener("DOMContentLoaded",h,!1),n.addEventListener("load",h,!1))),_t.promise(t)},it.ready.promise();var bt=it.access=function(t,e,o,n,i,r,s){var a=0,l=t.length,c=null==o;if("object"===it.type(o)){i=!0;for(a in o)it.access(t,e,a,o[a],!0,r,s)}else if(void 0!==n&&(i=!0,it.isFunction(n)||(s=!0),c&&(s?(e.call(t,n),e=null):(c=e,e=function(t,e,o){return c.call(it(t),o)})),e))for(;l>a;a++)e(t[a],o,s?n:n.call(t[a],a,e(t[a],o)));return i?t:c?e.call(t):l?e(t[0],o):r};it.acceptData=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType},g.uid=1,g.accepts=it.acceptData,g.prototype={key:function(t){if(!g.accepts(t))return 0;var e={},o=t[this.expando];if(!o){o=g.uid++;try{e[this.expando]={value:o},Object.defineProperties(t,e)}catch(n){e[this.expando]=o,it.extend(t,e)}}return this.cache[o]||(this.cache[o]={}),o},set:function(t,e,o){var n,i=this.key(t),r=this.cache[i];if("string"==typeof e)r[e]=o;else if(it.isEmptyObject(r))it.extend(this.cache[i],e);else for(n in e)r[n]=e[n];return r},get:function(t,e){var o=this.cache[this.key(t)];return void 0===e?o:o[e]},access:function(t,e,o){var n;return void 0===e||e&&"string"==typeof e&&void 0===o?(n=this.get(t,e),void 0!==n?n:this.get(t,it.camelCase(e))):(this.set(t,e,o),void 0!==o?o:e)},remove:function(t,e){var o,n,i,r=this.key(t),s=this.cache[r];if(void 0===e)this.cache[r]={};else{it.isArray(e)?n=e.concat(e.map(it.camelCase)):(i=it.camelCase(e),e in s?n=[e,i]:(n=i,n=n in s?[n]:n.match(yt)||[])),o=n.length;for(;o--;)delete s[n[o]]}},hasData:function(t){return!it.isEmptyObject(this.cache[t[this.expando]]||{})},discard:function(t){t[this.expando]&&delete this.cache[t[this.expando]]}};var Et=new g,xt=new g,St=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Tt=/([A-Z])/g;it.extend({hasData:function(t){return xt.hasData(t)||Et.hasData(t)},data:function(t,e,o){return xt.access(t,e,o)},removeData:function(t,e){xt.remove(t,e)},_data:function(t,e,o){return Et.access(t,e,o)},_removeData:function(t,e){Et.remove(t,e)}}),it.fn.extend({data:function(t,e){var o,n,i,r=this[0],s=r&&r.attributes;if(void 0===t){if(this.length&&(i=xt.get(r),1===r.nodeType&&!Et.get(r,"hasDataAttrs"))){for(o=s.length;o--;)s[o]&&(n=s[o].name,0===n.indexOf("data-")&&(n=it.camelCase(n.slice(5)),p(r,n,i[n])));Et.set(r,"hasDataAttrs",!0)}return i}return"object"==typeof t?this.each(function(){xt.set(this,t)}):bt(this,function(e){var o,n=it.camelCase(t);if(r&&void 0===e){if(void 0!==(o=xt.get(r,t)))return o;if(void 0!==(o=xt.get(r,n)))return o;if(void 0!==(o=p(r,n,void 0)))return o}else this.each(function(){var o=xt.get(this,n);xt.set(this,n,e),-1!==t.indexOf("-")&&void 0!==o&&xt.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){xt.remove(this,t)})}}),it.extend({queue:function(t,e,o){var n;return t?(e=(e||"fx")+"queue",n=Et.get(t,e),o&&(!n||it.isArray(o)?n=Et.access(t,e,it.makeArray(o)):n.push(o)),n||[]):void 0},dequeue:function(t,e){e=e||"fx";var o=it.queue(t,e),n=o.length,i=o.shift(),r=it._queueHooks(t,e),s=function(){it.dequeue(t,e)};"inprogress"===i&&(i=o.shift(),n--),i&&("fx"===e&&o.unshift("inprogress"),delete r.stop,i.call(t,s,r)),!n&&r&&r.empty.fire()},_queueHooks:function(t,e){var o=e+"queueHooks";return Et.get(t,o)||Et.access(t,o,{empty:it.Callbacks("once memory").add(function(){Et.remove(t,[e+"queue",o])})})}}),it.fn.extend({queue:function(t,e){var o=2;return"string"!=typeof t&&(e=t,t="fx",o--),arguments.length<o?it.queue(this[0],t):void 0===e?this:this.each(function(){var o=it.queue(this,t,e);it._queueHooks(this,t),"fx"===t&&"inprogress"!==o[0]&&it.dequeue(this,t)})},dequeue:function(t){return this.each(function(){it.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var o,n=1,i=it.Deferred(),r=this,s=this.length,a=function(){--n||i.resolveWith(r,[r])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)(o=Et.get(r[s],t+"queueHooks"))&&o.empty&&(n++,o.empty.add(a));return a(),i.promise(e)}});var wt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ct=["Top","Right","Bottom","Left"],kt=function(t,e){return t=e||t,"none"===it.css(t,"display")||!it.contains(t.ownerDocument,t)},At=/^(?:checkbox|radio)$/i;!function(){var t=ot.createDocumentFragment(),e=t.appendChild(ot.createElement("div")),o=ot.createElement("input");o.setAttribute("type","radio"),o.setAttribute("checked","checked"),o.setAttribute("name","t"),e.appendChild(o),et.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",et.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var It="undefined";et.focusinBubbles="onfocusin"in n;var Bt=/^key/,Mt=/^(?:mouse|pointer|contextmenu)|click/,Lt=/^(?:focusinfocus|focusoutblur)$/,Nt=/^([^.]*)(?:\.(.+)|)$/;it.event={global:{},add:function(t,e,o,n,i){var r,s,a,l,c,u,h,g,p,d,f,m=Et.get(t);if(m)for(o.handler&&(r=o,o=r.handler,i=r.selector),o.guid||(o.guid=it.guid++),(l=m.events)||(l=m.events={}),(s=m.handle)||(s=m.handle=function(e){return typeof it!==It&&it.event.triggered!==e.type?it.event.dispatch.apply(t,arguments):void 0}),e=(e||"").match(yt)||[""],c=e.length;c--;)a=Nt.exec(e[c])||[],p=f=a[1],d=(a[2]||"").split(".").sort(),p&&(h=it.event.special[p]||{},p=(i?h.delegateType:h.bindType)||p,h=it.event.special[p]||{},u=it.extend({type:p,origType:f,data:n,handler:o,guid:o.guid,selector:i,needsContext:i&&it.expr.match.needsContext.test(i),namespace:d.join(".")},r),(g=l[p])||(g=l[p]=[],g.delegateCount=0,h.setup&&!1!==h.setup.call(t,n,d,s)||t.addEventListener&&t.addEventListener(p,s,!1)),h.add&&(h.add.call(t,u),u.handler.guid||(u.handler.guid=o.guid)),i?g.splice(g.delegateCount++,0,u):g.push(u),it.event.global[p]=!0)},remove:function(t,e,o,n,i){var r,s,a,l,c,u,h,g,p,d,f,m=Et.hasData(t)&&Et.get(t);if(m&&(l=m.events)){for(e=(e||"").match(yt)||[""],c=e.length;c--;)if(a=Nt.exec(e[c])||[],p=f=a[1],d=(a[2]||"").split(".").sort(),p){for(h=it.event.special[p]||{},p=(n?h.delegateType:h.bindType)||p,g=l[p]||[],a=a[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=r=g.length;r--;)u=g[r],!i&&f!==u.origType||o&&o.guid!==u.guid||a&&!a.test(u.namespace)||n&&n!==u.selector&&("**"!==n||!u.selector)||(g.splice(r,1),u.selector&&g.delegateCount--,h.remove&&h.remove.call(t,u));s&&!g.length&&(h.teardown&&!1!==h.teardown.call(t,d,m.handle)||it.removeEvent(t,p,m.handle),delete l[p])}else for(p in l)it.event.remove(t,p+e[c],o,n,!0);it.isEmptyObject(l)&&(delete m.handle,Et.remove(t,"events"))}},trigger:function(t,e,o,i){var r,s,a,l,c,u,h,g=[o||ot],p=tt.call(t,"type")?t.type:t,d=tt.call(t,"namespace")?t.namespace.split("."):[];if(s=a=o=o||ot,3!==o.nodeType&&8!==o.nodeType&&!Lt.test(p+it.event.triggered)&&(p.indexOf(".")>=0&&(d=p.split("."),p=d.shift(),d.sort()),c=p.indexOf(":")<0&&"on"+p,t=t[it.expando]?t:new it.Event(p,"object"==typeof t&&t),t.isTrigger=i?2:3,t.namespace=d.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=o),e=null==e?[t]:it.makeArray(e,[t]),h=it.event.special[p]||{},i||!h.trigger||!1!==h.trigger.apply(o,e))){if(!i&&!h.noBubble&&!it.isWindow(o)){for(l=h.delegateType||p,Lt.test(l+p)||(s=s.parentNode);s;s=s.parentNode)g.push(s),a=s;a===(o.ownerDocument||ot)&&g.push(a.defaultView||a.parentWindow||n)}for(r=0;(s=g[r++])&&!t.isPropagationStopped();)t.type=r>1?l:h.bindType||p,u=(Et.get(s,"events")||{})[t.type]&&Et.get(s,"handle"),u&&u.apply(s,e),(u=c&&s[c])&&u.apply&&it.acceptData(s)&&(t.result=u.apply(s,e),!1===t.result&&t.preventDefault());return t.type=p,i||t.isDefaultPrevented()||h._default&&!1!==h._default.apply(g.pop(),e)||!it.acceptData(o)||c&&it.isFunction(o[p])&&!it.isWindow(o)&&(a=o[c],a&&(o[c]=null),it.event.triggered=p,o[p](),it.event.triggered=void 0,a&&(o[c]=a)),t.result}},dispatch:function(t){t=it.event.fix(t);var e,o,n,i,r,s=[],a=Y.call(arguments),l=(Et.get(this,"events")||{})[t.type]||[],c=it.event.special[t.type]||{};if(a[0]=t,t.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,t)){for(s=it.event.handlers.call(this,t,l),e=0;(i=s[e++])&&!t.isPropagationStopped();)for(t.currentTarget=i.elem,o=0;(r=i.handlers[o++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(r.namespace))&&(t.handleObj=r,t.data=r.data,void 0!==(n=((it.event.special[r.origType]||{}).handle||r.handler).apply(i.elem,a))&&!1===(t.result=n)&&(t.preventDefault(),t.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,t),t.result}},handlers:function(t,e){var o,n,i,r,s=[],a=e.delegateCount,l=t.target;if(a&&l.nodeType&&(!t.button||"click"!==t.type))for(;l!==this;l=l.parentNode||this)if(!0!==l.disabled||"click"!==t.type){for(n=[],o=0;a>o;o++)r=e[o],i=r.selector+" ",void 0===n[i]&&(n[i]=r.needsContext?it(i,this).index(l)>=0:it.find(i,this,null,[l]).length),n[i]&&n.push(r);n.length&&s.push({elem:l,handlers:n})}return a<e.length&&s.push({elem:this,handlers:e.slice(a)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var o,n,i,r=e.button;return null==t.pageX&&null!=e.clientX&&(o=t.target.ownerDocument||ot,n=o.documentElement,i=o.body,t.pageX=e.clientX+(n&&n.scrollLeft||i&&i.scrollLeft||0)-(n&&n.clientLeft||i&&i.clientLeft||0),t.pageY=e.clientY+(n&&n.scrollTop||i&&i.scrollTop||0)-(n&&n.clientTop||i&&i.clientTop||0)),t.which||void 0===r||(t.which=1&r?1:2&r?3:4&r?2:0),t}},fix:function(t){if(t[it.expando])return t;var e,o,n,i=t.type,r=t,s=this.fixHooks[i];for(s||(this.fixHooks[i]=s=Mt.test(i)?this.mouseHooks:Bt.test(i)?this.keyHooks:{}),n=s.props?this.props.concat(s.props):this.props,t=new it.Event(r),e=n.length;e--;)o=n[e],t[o]=r[o];return t.target||(t.target=ot),3===t.target.nodeType&&(t.target=t.target.parentNode),s.filter?s.filter(t,r):t},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==m()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===m()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&it.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(t){return it.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,o,n){var i=it.extend(new it.Event,o,{type:t,isSimulated:!0,originalEvent:{}});n?it.event.trigger(i,null,e):it.event.dispatch.call(e,i),i.isDefaultPrevented()&&o.preventDefault()}},it.removeEvent=function(t,e,o){t.removeEventListener&&t.removeEventListener(e,o,!1)},it.Event=function(t,e){return this instanceof it.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?d:f):this.type=t,e&&it.extend(this,e),this.timeStamp=t&&t.timeStamp||it.now(),void(this[it.expando]=!0)):new it.Event(t,e)},it.Event.prototype={isDefaultPrevented:f,isPropagationStopped:f,isImmediatePropagationStopped:f,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=d,t&&t.preventDefault&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=d,t&&t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=d,t&&t.stopImmediatePropagation&&t.stopImmediatePropagation(),this.stopPropagation()}},it.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){it.event.special[t]={delegateType:e,bindType:e,handle:function(t){var o,n=this,i=t.relatedTarget,r=t.handleObj;return(!i||i!==n&&!it.contains(n,i))&&(t.type=r.origType,o=r.handler.apply(this,arguments),t.type=e),o}}}),et.focusinBubbles||it.each({focus:"focusin",blur:"focusout"},function(t,e){var o=function(t){it.event.simulate(e,t.target,it.event.fix(t),!0)};it.event.special[e]={setup:function(){var n=this.ownerDocument||this,i=Et.access(n,e);i||n.addEventListener(t,o,!0),Et.access(n,e,(i||0)+1)},teardown:function(){var n=this.ownerDocument||this,i=Et.access(n,e)-1;i?Et.access(n,e,i):(n.removeEventListener(t,o,!0),Et.remove(n,e))}}}),it.fn.extend({on:function(t,e,o,n,i){var r,s;if("object"==typeof t){"string"!=typeof e&&(o=o||e,e=void 0);for(s in t)this.on(s,e,o,t[s],i);return this}if(null==o&&null==n?(n=e,o=e=void 0):null==n&&("string"==typeof e?(n=o,o=void 0):(n=o,o=e,e=void 0)),!1===n)n=f;else if(!n)return this;return 1===i&&(r=n,n=function(t){return it().off(t),r.apply(this,arguments)},n.guid=r.guid||(r.guid=it.guid++)),this.each(function(){it.event.add(this,t,n,o,e)})},one:function(t,e,o,n){return this.on(t,e,o,n,1)},off:function(t,e,o){var n,i;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,it(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(i in t)this.off(i,e,t[i]);return this}return(!1===e||"function"==typeof e)&&(o=e,e=void 0),!1===o&&(o=f),this.each(function(){it.event.remove(this,t,o,e)})},trigger:function(t,e){return this.each(function(){it.event.trigger(t,e,this)})},triggerHandler:function(t,e){var o=this[0];return o?it.event.trigger(t,e,o,!0):void 0}});var Rt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Dt=/<([\w:]+)/,Ot=/<|&#?\w+;/,Pt=/<(?:script|style|link)/i,jt=/checked\s*(?:[^=]|=\s*.checked.)/i,Ft=/^$|\/(?:java|ecma)script/i,Ht=/^true\/(.*)/,Ut=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Gt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Gt.optgroup=Gt.option,Gt.tbody=Gt.tfoot=Gt.colgroup=Gt.caption=Gt.thead,Gt.th=Gt.td,it.extend({clone:function(t,e,o){var n,i,r,s,a=t.cloneNode(!0),l=it.contains(t.ownerDocument,t);if(!(et.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||it.isXMLDoc(t)))for(s=x(a),r=x(t),n=0,i=r.length;i>n;n++)S(r[n],s[n]);if(e)if(o)for(r=r||x(t),s=s||x(a),n=0,i=r.length;i>n;n++)E(r[n],s[n]);else E(t,a);return s=x(a,"script"),s.length>0&&b(s,!l&&x(t,"script")),a},buildFragment:function(t,e,o,n){for(var i,r,s,a,l,c,u=e.createDocumentFragment(),h=[],g=0,p=t.length;p>g;g++)if((i=t[g])||0===i)if("object"===it.type(i))it.merge(h,i.nodeType?[i]:i);else if(Ot.test(i)){for(r=r||u.appendChild(e.createElement("div")),s=(Dt.exec(i)||["",""])[1].toLowerCase(),a=Gt[s]||Gt._default,r.innerHTML=a[1]+i.replace(Rt,"<$1></$2>")+a[2],c=a[0];c--;)r=r.lastChild;it.merge(h,r.childNodes),r=u.firstChild,r.textContent=""}else h.push(e.createTextNode(i));for(u.textContent="",g=0;i=h[g++];)if((!n||-1===it.inArray(i,n))&&(l=it.contains(i.ownerDocument,i),r=x(u.appendChild(i),"script"),l&&b(r),o))for(c=0;i=r[c++];)Ft.test(i.type||"")&&o.push(i);return u},cleanData:function(t){for(var e,o,n,i,r=it.event.special,s=0;void 0!==(o=t[s]);s++){if(it.acceptData(o)&&(i=o[Et.expando])&&(e=Et.cache[i])){if(e.events)for(n in e.events)r[n]?it.event.remove(o,n):it.removeEvent(o,n,e.handle);Et.cache[i]&&delete Et.cache[i]}delete xt.cache[o[xt.expando]]}}}),it.fn.extend({text:function(t){return bt(this,function(t){return void 0===t?it.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=t)})},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){y(this,t).appendChild(t)}})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=y(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var o,n=t?it.filter(t,this):this,i=0;null!=(o=n[i]);i++)e||1!==o.nodeType||it.cleanData(x(o)),o.parentNode&&(e&&it.contains(o.ownerDocument,o)&&b(x(o,"script")),o.parentNode.removeChild(o));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(it.cleanData(x(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return it.clone(this,t,e)})},html:function(t){return bt(this,function(t){var e=this[0]||{},o=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Pt.test(t)&&!Gt[(Dt.exec(t)||["",""])[1].toLowerCase()]){t=t.replace(Rt,"<$1></$2>");try{for(;n>o;o++)e=this[o]||{},1===e.nodeType&&(it.cleanData(x(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=arguments[0];return this.domManip(arguments,function(e){t=this.parentNode,it.cleanData(x(this)),t&&t.replaceChild(e,this)}),t&&(t.length||t.nodeType)?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e){t=K.apply([],t);var o,n,i,r,s,a,l=0,c=this.length,u=this,h=c-1,g=t[0],p=it.isFunction(g);if(p||c>1&&"string"==typeof g&&!et.checkClone&&jt.test(g))return this.each(function(o){var n=u.eq(o);p&&(t[0]=g.call(this,o,n.html())),n.domManip(t,e)});if(c&&(o=it.buildFragment(t,this[0].ownerDocument,!1,this),n=o.firstChild,1===o.childNodes.length&&(o=n),n)){for(i=it.map(x(o,"script"),v),r=i.length;c>l;l++)s=o,l!==h&&(s=it.clone(s,!0,!0),r&&it.merge(i,x(s,"script"))),e.call(this[l],s,l);if(r)for(a=i[i.length-1].ownerDocument,it.map(i,_),l=0;r>l;l++)s=i[l],Ft.test(s.type||"")&&!Et.access(s,"globalEval")&&it.contains(a,s)&&(s.src?it._evalUrl&&it._evalUrl(s.src):it.globalEval(s.textContent.replace(Ut,"")))}return this}}),it.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){it.fn[t]=function(t){for(var o,n=[],i=it(t),r=i.length-1,s=0;r>=s;s++)o=s===r?this:this.clone(!0),it(i[s])[e](o),$.apply(n,o.get());return this.pushStack(n)}});var Vt,Wt={},zt=/^margin/,qt=new RegExp("^("+wt+")(?!px)[a-z%]+$","i"),Xt=function(t){return t.ownerDocument.defaultView.getComputedStyle(t,null)};!function(){function t(){s.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",s.innerHTML="",i.appendChild(r);var t=n.getComputedStyle(s,null);e="1%"!==t.top,o="4px"===t.width,i.removeChild(r)}var e,o,i=ot.documentElement,r=ot.createElement("div"),s=ot.createElement("div");s.style&&(s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",et.clearCloneStyle="content-box"===s.style.backgroundClip,r.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",r.appendChild(s),n.getComputedStyle&&it.extend(et,{pixelPosition:function(){return t(),e},boxSizingReliable:function(){return null==o&&t(),o},reliableMarginRight:function(){var t,e=s.appendChild(ot.createElement("div"));return e.style.cssText=s.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",s.style.width="1px",i.appendChild(r),t=!parseFloat(n.getComputedStyle(e,null).marginRight),i.removeChild(r),t}}))}(),it.swap=function(t,e,o,n){var i,r,s={};for(r in e)s[r]=t.style[r],t.style[r]=e[r];i=o.apply(t,n||[]);for(r in e)t.style[r]=s[r];return i};var Yt=/^(none|table(?!-c[ea]).+)/,Kt=new RegExp("^("+wt+")(.*)$","i"),$t=new RegExp("^([+-])=("+wt+")","i"),Qt={position:"absolute",visibility:"hidden",display:"block"},Jt={letterSpacing:"0",fontWeight:"400"},Zt=["Webkit","O","Moz","ms"];it.extend({cssHooks:{opacity:{get:function(t,e){if(e){var o=C(t,"opacity");return""===o?"1":o}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,o,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var i,r,s,a=it.camelCase(e),l=t.style;return e=it.cssProps[a]||(it.cssProps[a]=A(l,a)),s=it.cssHooks[e]||it.cssHooks[a],void 0===o?s&&"get"in s&&void 0!==(i=s.get(t,!1,n))?i:l[e]:(r=typeof o,"string"===r&&(i=$t.exec(o))&&(o=(i[1]+1)*i[2]+parseFloat(it.css(t,e)),r="number"),void(null!=o&&o===o&&("number"!==r||it.cssNumber[a]||(o+="px"),et.clearCloneStyle||""!==o||0!==e.indexOf("background")||(l[e]="inherit"),s&&"set"in s&&void 0===(o=s.set(t,o,n))||(l[e]=o))))}},css:function(t,e,o,n){var i,r,s,a=it.camelCase(e);return e=it.cssProps[a]||(it.cssProps[a]=A(t.style,a)),s=it.cssHooks[e]||it.cssHooks[a],s&&"get"in s&&(i=s.get(t,!0,o)),void 0===i&&(i=C(t,e,n)),"normal"===i&&e in Jt&&(i=Jt[e]),""===o||o?(r=parseFloat(i),!0===o||it.isNumeric(r)?r||0:i):i}}),it.each(["height","width"],function(t,e){it.cssHooks[e]={get:function(t,o,n){return o?Yt.test(it.css(t,"display"))&&0===t.offsetWidth?it.swap(t,Qt,function(){return M(t,e,n)}):M(t,e,n):void 0},set:function(t,o,n){var i=n&&Xt(t);return I(t,o,n?B(t,e,n,"border-box"===it.css(t,"boxSizing",!1,i),i):0)}}}),it.cssHooks.marginRight=k(et.reliableMarginRight,function(t,e){return e?it.swap(t,{display:"inline-block"},C,[t,"marginRight"]):void 0}),it.each({margin:"",padding:"",border:"Width"},function(t,e){it.cssHooks[t+e]={expand:function(o){for(var n=0,i={},r="string"==typeof o?o.split(" "):[o];4>n;n++)i[t+Ct[n]+e]=r[n]||r[n-2]||r[0];return i}},zt.test(t)||(it.cssHooks[t+e].set=I)}),it.fn.extend({css:function(t,e){return bt(this,function(t,e,o){var n,i,r={},s=0;if(it.isArray(e)){for(n=Xt(t),i=e.length;i>s;s++)r[e[s]]=it.css(t,e[s],!1,n);return r}return void 0!==o?it.style(t,e,o):it.css(t,e)},t,e,arguments.length>1)},show:function(){return L(this,!0)},hide:function(){return L(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){kt(this)?it(this).show():it(this).hide()})}}),it.Tween=N,N.prototype={constructor:N,init:function(t,e,o,n,i,r){this.elem=t,this.prop=o,this.easing=i||"swing",this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=r||(it.cssNumber[o]?"":"px")},cur:function(){var t=N.propHooks[this.prop];return t&&t.get?t.get(this):N.propHooks._default.get(this)},run:function(t){var e,o=N.propHooks[this.prop];return this.pos=e=this.options.duration?it.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),o&&o.set?o.set(this):N.propHooks._default.set(this),this}},N.prototype.init.prototype=N.prototype,N.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=it.css(t.elem,t.prop,""),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){it.fx.step[t.prop]?it.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[it.cssProps[t.prop]]||it.cssHooks[t.prop])?it.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},N.propHooks.scrollTop=N.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},it.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},it.fx=N.prototype.init,it.fx.step={};var te,ee,oe=/^(?:toggle|show|hide)$/,ne=new RegExp("^(?:([+-])=|)("+wt+")([a-z%]*)$","i"),ie=/queueHooks$/,re=[P],se={"*":[function(t,e){var o=this.createTween(t,e),n=o.cur(),i=ne.exec(e),r=i&&i[3]||(it.cssNumber[t]?"":"px"),s=(it.cssNumber[t]||"px"!==r&&+n)&&ne.exec(it.css(o.elem,t)),a=1,l=20;if(s&&s[3]!==r){r=r||s[3],i=i||[],s=+n||1;do{a=a||".5",s/=a,it.style(o.elem,t,s+r)}while(a!==(a=o.cur()/n)&&1!==a&&--l)}return i&&(s=o.start=+s||+n||0,o.unit=r,o.end=i[1]?s+(i[1]+1)*i[2]:+i[2]),o}]};it.Animation=it.extend(F,{tweener:function(t,e){it.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var o,n=0,i=t.length;i>n;n++)o=t[n],se[o]=se[o]||[],se[o].unshift(e)},prefilter:function(t,e){e?re.unshift(t):re.push(t)}}),it.speed=function(t,e,o){var n=t&&"object"==typeof t?it.extend({},t):{complete:o||!o&&e||it.isFunction(t)&&t,duration:t,easing:o&&e||e&&!it.isFunction(e)&&e};return n.duration=it.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in it.fx.speeds?it.fx.speeds[n.duration]:it.fx.speeds._default,(null==n.queue||!0===n.queue)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){it.isFunction(n.old)&&n.old.call(this),n.queue&&it.dequeue(this,n.queue)},n},it.fn.extend({fadeTo:function(t,e,o,n){return this.filter(kt).css("opacity",0).show().end().animate({opacity:e},t,o,n)},animate:function(t,e,o,n){var i=it.isEmptyObject(t),r=it.speed(e,o,n),s=function(){var e=F(this,it.extend({},t),r);(i||Et.get(this,"finish"))&&e.stop(!0)};return s.finish=s,i||!1===r.queue?this.each(s):this.queue(r.queue,s)},stop:function(t,e,o){var n=function(t){var e=t.stop;delete t.stop,e(o)};return"string"!=typeof t&&(o=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each(function(){var e=!0,i=null!=t&&t+"queueHooks",r=it.timers,s=Et.get(this);if(i)s[i]&&s[i].stop&&n(s[i]);else for(i in s)s[i]&&s[i].stop&&ie.test(i)&&n(s[i]);for(i=r.length;i--;)r[i].elem!==this||null!=t&&r[i].queue!==t||(r[i].anim.stop(o),e=!1,r.splice(i,1));(e||!o)&&it.dequeue(this,t)})},finish:function(t){return!1!==t&&(t=t||"fx"),this.each(function(){var e,o=Et.get(this),n=o[t+"queue"],i=o[t+"queueHooks"],r=it.timers,s=n?n.length:0;for(o.finish=!0,it.queue(this,t,[]),i&&i.stop&&i.stop.call(this,!0),e=r.length;e--;)r[e].elem===this&&r[e].queue===t&&(r[e].anim.stop(!0),r.splice(e,1));for(e=0;s>e;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete o.finish})}}),it.each(["toggle","show","hide"],function(t,e){var o=it.fn[e];it.fn[e]=function(t,n,i){return null==t||"boolean"==typeof t?o.apply(this,arguments):this.animate(D(e,!0),t,n,i)}}),it.each({slideDown:D("show"),slideUp:D("hide"),slideToggle:D("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){it.fn[t]=function(t,o,n){return this.animate(e,t,o,n)}}),it.timers=[],it.fx.tick=function(){var t,e=0,o=it.timers;for(te=it.now();e<o.length;e++)(t=o[e])()||o[e]!==t||o.splice(e--,1);o.length||it.fx.stop(),te=void 0},it.fx.timer=function(t){it.timers.push(t),t()?it.fx.start():it.timers.pop()},it.fx.interval=13,it.fx.start=function(){ee||(ee=setInterval(it.fx.tick,it.fx.interval))},it.fx.stop=function(){clearInterval(ee),ee=null},it.fx.speeds={slow:600,fast:200,_default:400},it.fn.delay=function(t,e){return t=it.fx?it.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,o){var n=setTimeout(e,t);o.stop=function(){clearTimeout(n)}})},function(){var t=ot.createElement("input"),e=ot.createElement("select"),o=e.appendChild(ot.createElement("option"));t.type="checkbox",et.checkOn=""!==t.value,et.optSelected=o.selected,e.disabled=!0,et.optDisabled=!o.disabled,t=ot.createElement("input"),t.value="t",t.type="radio",et.radioValue="t"===t.value}();var ae,le=it.expr.attrHandle;it.fn.extend({attr:function(t,e){return bt(this,it.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){it.removeAttr(this,t)})}}),it.extend({attr:function(t,e,o){var n,i,r=t.nodeType;if(t&&3!==r&&8!==r&&2!==r)return typeof t.getAttribute===It?it.prop(t,e,o):(1===r&&it.isXMLDoc(t)||(e=e.toLowerCase(),n=it.attrHooks[e]||(it.expr.match.bool.test(e)?ae:void 0)),void 0===o?n&&"get"in n&&null!==(i=n.get(t,e))?i:(i=it.find.attr(t,e),null==i?void 0:i):null!==o?n&&"set"in n&&void 0!==(i=n.set(t,o,e))?i:(t.setAttribute(e,o+""),o):void it.removeAttr(t,e))},removeAttr:function(t,e){var o,n,i=0,r=e&&e.match(yt);if(r&&1===t.nodeType)for(;o=r[i++];)n=it.propFix[o]||o,it.expr.match.bool.test(o)&&(t[n]=!1),t.removeAttribute(o)},attrHooks:{type:{set:function(t,e){if(!et.radioValue&&"radio"===e&&it.nodeName(t,"input")){var o=t.value;return t.setAttribute("type",e),o&&(t.value=o),e}}}}}),ae={set:function(t,e,o){return!1===e?it.removeAttr(t,o):t.setAttribute(o,o),o}},it.each(it.expr.match.bool.source.match(/\w+/g),function(t,e){var o=le[e]||it.find.attr;le[e]=function(t,e,n){var i,r;return n||(r=le[e],le[e]=i,i=null!=o(t,e,n)?e.toLowerCase():null,le[e]=r),i}});var ce=/^(?:input|select|textarea|button)$/i;it.fn.extend({prop:function(t,e){return bt(this,it.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[it.propFix[t]||t]})}}),it.extend({propFix:{for:"htmlFor",class:"className"},prop:function(t,e,o){var n,i,r,s=t.nodeType;if(t&&3!==s&&8!==s&&2!==s)return r=1!==s||!it.isXMLDoc(t),r&&(e=it.propFix[e]||e,i=it.propHooks[e]),void 0!==o?i&&"set"in i&&void 0!==(n=i.set(t,o,e))?n:t[e]=o:i&&"get"in i&&null!==(n=i.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){return t.hasAttribute("tabindex")||ce.test(t.nodeName)||t.href?t.tabIndex:-1}}}}),et.optSelected||(it.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null}}),it.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){it.propFix[this.toLowerCase()]=this});var ue=/[\t\r\n\f]/g;it.fn.extend({addClass:function(t){var e,o,n,i,r,s,a="string"==typeof t&&t,l=0,c=this.length;if(it.isFunction(t))return this.each(function(e){it(this).addClass(t.call(this,e,this.className))});if(a)for(e=(t||"").match(yt)||[];c>l;l++)if(o=this[l],n=1===o.nodeType&&(o.className?(" "+o.className+" ").replace(ue," "):" ")){for(r=0;i=e[r++];)n.indexOf(" "+i+" ")<0&&(n+=i+" ");s=it.trim(n),o.className!==s&&(o.className=s)}return this},removeClass:function(t){var e,o,n,i,r,s,a=0===arguments.length||"string"==typeof t&&t,l=0,c=this.length;if(it.isFunction(t))return this.each(function(e){it(this).removeClass(t.call(this,e,this.className))});if(a)for(e=(t||"").match(yt)||[];c>l;l++)if(o=this[l],n=1===o.nodeType&&(o.className?(" "+o.className+" ").replace(ue," "):"")){for(r=0;i=e[r++];)for(;n.indexOf(" "+i+" ")>=0;)n=n.replace(" "+i+" "," ");s=t?it.trim(n):"",o.className!==s&&(o.className=s)}return this},toggleClass:function(t,e){var o=typeof t;return"boolean"==typeof e&&"string"===o?e?this.addClass(t):this.removeClass(t):this.each(it.isFunction(t)?function(o){it(this).toggleClass(t.call(this,o,this.className,e),e)}:function(){if("string"===o)for(var e,n=0,i=it(this),r=t.match(yt)||[];e=r[n++];)i.hasClass(e)?i.removeClass(e):i.addClass(e);else(o===It||"boolean"===o)&&(this.className&&Et.set(this,"__className__",this.className),this.className=this.className||!1===t?"":Et.get(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",o=0,n=this.length;n>o;o++)if(1===this[o].nodeType&&(" "+this[o].className+" ").replace(ue," ").indexOf(e)>=0)return!0;return!1}});var he=/\r/g;it.fn.extend({val:function(t){var e,o,n,i=this[0];return arguments.length?(n=it.isFunction(t),this.each(function(o){var i;1===this.nodeType&&(i=n?t.call(this,o,it(this).val()):t,null==i?i="":"number"==typeof i?i+="":it.isArray(i)&&(i=it.map(i,function(t){return null==t?"":t+""})),(e=it.valHooks[this.type]||it.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,i,"value")||(this.value=i))})):i?(e=it.valHooks[i.type]||it.valHooks[i.nodeName.toLowerCase()],e&&"get"in e&&void 0!==(o=e.get(i,"value"))?o:(o=i.value,"string"==typeof o?o.replace(he,""):null==o?"":o)):void 0}}),it.extend({valHooks:{option:{get:function(t){var e=it.find.attr(t,"value");return null!=e?e:it.trim(it.text(t))}},select:{get:function(t){for(var e,o,n=t.options,i=t.selectedIndex,r="select-one"===t.type||0>i,s=r?null:[],a=r?i+1:n.length,l=0>i?a:r?i:0;a>l;l++)if(o=n[l],!(!o.selected&&l!==i||(et.optDisabled?o.disabled:null!==o.getAttribute("disabled"))||o.parentNode.disabled&&it.nodeName(o.parentNode,"optgroup"))){if(e=it(o).val(),r)return e;s.push(e)}return s},set:function(t,e){for(var o,n,i=t.options,r=it.makeArray(e),s=i.length;s--;)n=i[s],(n.selected=it.inArray(n.value,r)>=0)&&(o=!0);return o||(t.selectedIndex=-1),r}}}}),it.each(["radio","checkbox"],function(){it.valHooks[this]={set:function(t,e){return it.isArray(e)?t.checked=it.inArray(it(t).val(),e)>=0:void 0}},et.checkOn||(it.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),it.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){it.fn[e]=function(t,o){return arguments.length>0?this.on(e,null,t,o):this.trigger(e)}}),it.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,o){return this.on(t,null,e,o)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,o,n){return this.on(e,t,o,n)},undelegate:function(t,e,o){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",o)}});var ge=it.now(),pe=/\?/;it.parseJSON=function(t){return JSON.parse(t+"")},it.parseXML=function(t){var e,o;if(!t||"string"!=typeof t)return null;try{o=new DOMParser,e=o.parseFromString(t,"text/xml")}catch(t){e=void 0}return(!e||e.getElementsByTagName("parsererror").length)&&it.error("Invalid XML: "+t),e};var de,fe,me=/#.*$/,ye=/([?&])_=[^&]*/,ve=/^(.*?):[ \t]*([^\r\n]*)$/gm,_e=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,be=/^(?:GET|HEAD)$/,Ee=/^\/\//,xe=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Se={},Te={},we="*/".concat("*");try{fe=location.href}catch(t){fe=ot.createElement("a"),fe.href="",fe=fe.href}de=xe.exec(fe.toLowerCase())||[],it.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:fe,type:"GET",isLocal:_e.test(de[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":we,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":it.parseJSON,"text xml":it.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?G(G(t,it.ajaxSettings),e):G(it.ajaxSettings,t)},ajaxPrefilter:H(Se),ajaxTransport:H(Te),ajax:function(t,e){function o(t,e,o,s){var l,u,y,v,b,x=e;2!==_&&(_=2,a&&clearTimeout(a),n=void 0,r=s||"",E.readyState=t>0?4:0,l=t>=200&&300>t||304===t,o&&(v=V(h,E,o)),v=W(h,v,E,l),l?(h.ifModified&&(b=E.getResponseHeader("Last-Modified"),b&&(it.lastModified[i]=b),(b=E.getResponseHeader("etag"))&&(it.etag[i]=b)),204===t||"HEAD"===h.type?x="nocontent":304===t?x="notmodified":(x=v.state,u=v.data,y=v.error,l=!y)):(y=x,(t||!x)&&(x="error",0>t&&(t=0))),E.status=t,E.statusText=(e||x)+"",l?d.resolveWith(g,[u,x,E]):d.rejectWith(g,[E,x,y]),E.statusCode(m),m=void 0,c&&p.trigger(l?"ajaxSuccess":"ajaxError",[E,h,l?u:y]),f.fireWith(g,[E,x]),c&&(p.trigger("ajaxComplete",[E,h]),--it.active||it.event.trigger("ajaxStop")))}"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,i,r,s,a,l,c,u,h=it.ajaxSetup({},e),g=h.context||h,p=h.context&&(g.nodeType||g.jquery)?it(g):it.event,d=it.Deferred(),f=it.Callbacks("once memory"),m=h.statusCode||{},y={},v={},_=0,b="canceled",E={readyState:0,getResponseHeader:function(t){var e;if(2===_){if(!s)for(s={};e=ve.exec(r);)s[e[1].toLowerCase()]=e[2];e=s[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===_?r:null},setRequestHeader:function(t,e){var o=t.toLowerCase();return _||(t=v[o]=v[o]||t,y[t]=e),this},overrideMimeType:function(t){return _||(h.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>_)for(e in t)m[e]=[m[e],t[e]];else E.always(t[E.status]);return this},abort:function(t){var e=t||b;return n&&n.abort(e),o(0,e),this}};if(d.promise(E).complete=f.add,E.success=E.done,E.error=E.fail,h.url=((t||h.url||fe)+"").replace(me,"").replace(Ee,de[1]+"//"),h.type=e.method||e.type||h.method||h.type,h.dataTypes=it.trim(h.dataType||"*").toLowerCase().match(yt)||[""],null==h.crossDomain&&(l=xe.exec(h.url.toLowerCase()),h.crossDomain=!(!l||l[1]===de[1]&&l[2]===de[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(de[3]||("http:"===de[1]?"80":"443")))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=it.param(h.data,h.traditional)),U(Se,h,e,E),2===_)return E;c=h.global,c&&0==it.active++&&it.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!be.test(h.type),i=h.url,h.hasContent||(h.data&&(i=h.url+=(pe.test(i)?"&":"?")+h.data,delete h.data),!1===h.cache&&(h.url=ye.test(i)?i.replace(ye,"$1_="+ge++):i+(pe.test(i)?"&":"?")+"_="+ge++)),h.ifModified&&(it.lastModified[i]&&E.setRequestHeader("If-Modified-Since",it.lastModified[i]),it.etag[i]&&E.setRequestHeader("If-None-Match",it.etag[i])),(h.data&&h.hasContent&&!1!==h.contentType||e.contentType)&&E.setRequestHeader("Content-Type",h.contentType),E.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+we+"; q=0.01":""):h.accepts["*"]);for(u in h.headers)E.setRequestHeader(u,h.headers[u]);if(h.beforeSend&&(!1===h.beforeSend.call(g,E,h)||2===_))return E.abort();b="abort";for(u in{success:1,error:1,complete:1})E[u](h[u]);if(n=U(Te,h,e,E)){E.readyState=1,c&&p.trigger("ajaxSend",[E,h]),h.async&&h.timeout>0&&(a=setTimeout(function(){E.abort("timeout")},h.timeout));try{_=1,n.send(y,o)}catch(t){if(!(2>_))throw t;o(-1,t)}}else o(-1,"No Transport");return E},getJSON:function(t,e,o){return it.get(t,e,o,"json")},getScript:function(t,e){return it.get(t,void 0,e,"script")}}),it.each(["get","post"],function(t,e){it[e]=function(t,o,n,i){return it.isFunction(o)&&(i=i||n,n=o,o=void 0),it.ajax({url:t,type:e,dataType:i,data:o,success:n})}}),it.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){it.fn[e]=function(t){return this.on(e,t)}}),it._evalUrl=function(t){return it.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},it.fn.extend({wrapAll:function(t){var e;return it.isFunction(t)?this.each(function(e){it(this).wrapAll(t.call(this,e))}):(this[0]&&(e=it(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this)},wrapInner:function(t){return this.each(it.isFunction(t)?function(e){it(this).wrapInner(t.call(this,e))}:function(){var e=it(this),o=e.contents();o.length?o.wrapAll(t):e.append(t)})},wrap:function(t){var e=it.isFunction(t);return this.each(function(o){it(this).wrapAll(e?t.call(this,o):t)})},unwrap:function(){return this.parent().each(function(){it.nodeName(this,"body")||it(this).replaceWith(this.childNodes)}).end()}}),it.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0},it.expr.filters.visible=function(t){return!it.expr.filters.hidden(t)};var Ce=/%20/g,ke=/\[\]$/,Ae=/\r?\n/g,Ie=/^(?:submit|button|image|reset|file)$/i,Be=/^(?:input|select|textarea|keygen)/i;it.param=function(t,e){var o,n=[],i=function(t,e){e=it.isFunction(e)?e():null==e?"":e,n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=it.ajaxSettings&&it.ajaxSettings.traditional),it.isArray(t)||t.jquery&&!it.isPlainObject(t))it.each(t,function(){i(this.name,this.value)});else for(o in t)z(o,t[o],e,i);return n.join("&").replace(Ce,"+")},it.fn.extend({serialize:function(){return it.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=it.prop(this,"elements");return t?it.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!it(this).is(":disabled")&&Be.test(this.nodeName)&&!Ie.test(t)&&(this.checked||!At.test(t))}).map(function(t,e){var o=it(this).val();return null==o?null:it.isArray(o)?it.map(o,function(t){return{name:e.name,value:t.replace(Ae,"\r\n")}}):{name:e.name,value:o.replace(Ae,"\r\n")}}).get()}}),it.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(t){}};var Me=0,Le={},Ne={0:200,1223:204},Re=it.ajaxSettings.xhr();n.ActiveXObject&&it(n).on("unload",function(){for(var t in Le)Le[t]()}),et.cors=!!Re&&"withCredentials"in Re,et.ajax=Re=!!Re,it.ajaxTransport(function(t){var e;return et.cors||Re&&!t.crossDomain?{send:function(o,n){var i,r=t.xhr(),s=++Me;if(r.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(i in t.xhrFields)r[i]=t.xhrFields[i];t.mimeType&&r.overrideMimeType&&r.overrideMimeType(t.mimeType),t.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest");for(i in o)r.setRequestHeader(i,o[i]);e=function(t){return function(){e&&(delete Le[s],e=r.onload=r.onerror=null,"abort"===t?r.abort():"error"===t?n(r.status,r.statusText):n(Ne[r.status]||r.status,r.statusText,"string"==typeof r.responseText?{text:r.responseText}:void 0,r.getAllResponseHeaders()))}},r.onload=e(),r.onerror=e("error"),e=Le[s]=e("abort");try{r.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}:void 0}),it.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return it.globalEval(t),t}}}),it.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),it.ajaxTransport("script",function(t){if(t.crossDomain){var e,o;return{send:function(n,i){e=it("<script>").prop({async:!0,charset:t.scriptCharset,src:t.url}).on("load error",o=function(t){e.remove(),o=null,t&&i("error"===t.type?404:200,t.type)}),ot.head.appendChild(e[0])},abort:function(){o&&o()}}}});var De=[],Oe=/(=)\?(?=&|$)|\?\?/;it.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=De.pop()||it.expando+"_"+ge++;return this[t]=!0,t}}),it.ajaxPrefilter("json jsonp",function(t,e,o){var i,r,s,a=!1!==t.jsonp&&(Oe.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Oe.test(t.data)&&"data");return a||"jsonp"===t.dataTypes[0]?(i=t.jsonpCallback=it.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Oe,"$1"+i):!1!==t.jsonp&&(t.url+=(pe.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return s||it.error(i+" was not called"),s[0]},t.dataTypes[0]="json",r=n[i],n[i]=function(){s=arguments},o.always(function(){n[i]=r,t[i]&&(t.jsonpCallback=e.jsonpCallback,De.push(i)),s&&it.isFunction(r)&&r(s[0]),s=r=void 0}),"script"):void 0}),it.parseHTML=function(t,e,o){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(o=e,e=!1),e=e||ot;var n=ht.exec(t),i=!o&&[];return n?[e.createElement(n[1])]:(n=it.buildFragment([t],e,i),i&&i.length&&it(i).remove(),it.merge([],n.childNodes))};var Pe=it.fn.load;it.fn.load=function(t,e,o){if("string"!=typeof t&&Pe)return Pe.apply(this,arguments);var n,i,r,s=this,a=t.indexOf(" ");return a>=0&&(n=it.trim(t.slice(a)),t=t.slice(0,a)),it.isFunction(e)?(o=e,e=void 0):e&&"object"==typeof e&&(i="POST"),s.length>0&&it.ajax({url:t,type:i,dataType:"html",data:e}).done(function(t){r=arguments,s.html(n?it("<div>").append(it.parseHTML(t)).find(n):t)}).complete(o&&function(t,e){s.each(o,r||[t.responseText,e,t])}),this},it.expr.filters.animated=function(t){return it.grep(it.timers,function(e){return t===e.elem}).length};var je=n.document.documentElement;it.offset={setOffset:function(t,e,o){var n,i,r,s,a,l,c,u=it.css(t,"position"),h=it(t),g={};"static"===u&&(t.style.position="relative"),a=h.offset(),r=it.css(t,"top"),l=it.css(t,"left"),c=("absolute"===u||"fixed"===u)&&(r+l).indexOf("auto")>-1,c?(n=h.position(),s=n.top,i=n.left):(s=parseFloat(r)||0,i=parseFloat(l)||0),it.isFunction(e)&&(e=e.call(t,o,a)),null!=e.top&&(g.top=e.top-a.top+s),null!=e.left&&(g.left=e.left-a.left+i),"using"in e?e.using.call(t,g):h.css(g)}},it.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){it.offset.setOffset(this,t,e)});var e,o,n=this[0],i={top:0,left:0},r=n&&n.ownerDocument;return r?(e=r.documentElement,it.contains(e,n)?(typeof n.getBoundingClientRect!==It&&(i=n.getBoundingClientRect()),o=q(r),{top:i.top+o.pageYOffset-e.clientTop,left:i.left+o.pageXOffset-e.clientLeft}):i):void 0},position:function(){if(this[0]){var t,e,o=this[0],n={top:0,left:0};return"fixed"===it.css(o,"position")?e=o.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),it.nodeName(t[0],"html")||(n=t.offset()),n.top+=it.css(t[0],"borderTopWidth",!0),n.left+=it.css(t[0],"borderLeftWidth",!0)),{top:e.top-n.top-it.css(o,"marginTop",!0),left:e.left-n.left-it.css(o,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||je;t&&!it.nodeName(t,"html")&&"static"===it.css(t,"position");)t=t.offsetParent;return t||je})}}),it.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var o="pageYOffset"===e;it.fn[t]=function(i){return bt(this,function(t,i,r){var s=q(t);return void 0===r?s?s[e]:t[i]:void(s?s.scrollTo(o?n.pageXOffset:r,o?r:n.pageYOffset):t[i]=r)},t,i,arguments.length,null)}}),it.each(["top","left"],function(t,e){it.cssHooks[e]=k(et.pixelPosition,function(t,o){return o?(o=C(t,e),qt.test(o)?it(t).position()[e]+"px":o):void 0})}),it.each({Height:"height",Width:"width"},function(t,e){it.each({padding:"inner"+t,content:e,"":"outer"+t},function(o,n){it.fn[n]=function(n,i){var r=arguments.length&&(o||"boolean"!=typeof n),s=o||(!0===n||!0===i?"margin":"border");return bt(this,function(e,o,n){var i;return it.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(i=e.documentElement,Math.max(e.body["scroll"+t],i["scroll"+t],e.body["offset"+t],i["offset"+t],i["client"+t])):void 0===n?it.css(e,o,s):it.style(e,o,n,s)},e,r?n:void 0,r,null)}})}),it.fn.size=function(){return this.length},it.fn.andSelf=it.fn.addBack,o(1)&&(i=[],void 0!==(r=function(){return it}.apply(e,i))&&(t.exports=r));var Fe=n.jQuery,He=n.$;return it.noConflict=function(t){return n.$===it&&(n.$=He),t&&n.jQuery===it&&(n.jQuery=Fe),it},typeof s===It&&(n.jQuery=n.$=it),it}),t.exports=n}).call(e,o(0))},function(t,e,o){(function(e){var o={};!function(t){function e(){this._settings=[],this._extensions=[],this.regional=[],this.regional[""]={errorLoadingText:"Error loading",notSupportedText:"This browser does not support SVG"},this.local=this.regional[""],this._uuid=(new Date).getTime(),this._renesis=n("RenesisX.RenesisCtrl")}function n(t){try{return!(!window.ActiveXObject||!new ActiveXObject(t))}catch(t){return!1}}function i(e,o){this._svg=e,this._container=o;for(var n=0;n<t.svg._extensions.length;n++){var i=t.svg._extensions[n];this[i[0]]=new i[1](this)}}function r(){this._path=""}function s(){this._parts=[]}function a(t){return t&&t.constructor==Array}t.extend(e.prototype,{markerClassName:"hasSVG",svgNS:"http://www.w3.org/2000/svg",xlinkNS:"http://www.w3.org/1999/xlink",_wrapperClass:i,_attrNames:{class_:"class",in_:"in",alignmentBaseline:"alignment-baseline",baselineShift:"baseline-shift",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorRendering:"color-rendering",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",underlinePosition:"underline-position",underlineThickness:"underline-thickness",vertAdvY:"vert-adv-y",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode"},_attachSVG:function(e,o){var n=e.namespaceURI==this.svgNS?e:null,e=n?null:e;if(!t(e||n).hasClass(this.markerClassName)){"string"==typeof o?o={loadURL:o}:"function"==typeof o&&(o={onLoad:o}),t(e||n).addClass(this.markerClassName);try{n||(n=document.createElementNS(this.svgNS,"svg"),n.setAttribute("version","1.1"),e.clientWidth>0&&n.setAttribute("width",e.clientWidth),e.clientHeight>0&&n.setAttribute("height",e.clientHeight),e.appendChild(n)),this._afterLoad(e,n,o||{})}catch(n){t.browser.msie?(e.id||(e.id="svg"+this._uuid++),this._settings[e.id]=o,e.innerHTML='<embed type="image/svg+xml" width="100%" height="100%" src="'+(o.initPath||"")+'blank.svg" pluginspage="http://www.adobe.com/svg/viewer/install/main.html"/>'):e.innerHTML='<p class="svg_error">'+this.local.notSupportedText+"</p>"}}},_registerSVG:function(){for(var e=0;e<document.embeds.length;e++){var o=document.embeds[e].parentNode;if(t(o).hasClass(t.svg.markerClassName)&&!t.data(o,"svgwrapper")){var n=null;try{n=document.embeds[e].getSVGDocument()}catch(e){return void setTimeout(t.svg._registerSVG,250)}n=n?n.documentElement:null,n&&t.svg._afterLoad(o,n)}}},_afterLoad:function(e,o,n){var n=n||this._settings[e.id];this._settings[e?e.id:""]=null;var i=new this._wrapperClass(o,e);t.data(e||o,"svgwrapper",i);try{n.loadURL&&i.load(n.loadURL,n),n.settings&&i.configure(n.settings),n.onLoad&&!n.loadURL&&n.onLoad.apply(e||o,[i])}catch(t){alert(t)}},_getSVG:function(e){return e="string"==typeof e?t(e)[0]:e.jquery?e[0]:e,t.data(e,"svgwrapper")},_destroySVG:function(e){var o=t(e);o.hasClass(this.markerClassName)&&(o.removeClass(this.markerClassName),e.namespaceURI!=this.svgNS&&o.empty(),t.removeData(e,"svgwrapper"))},addExtension:function(t,e){this._extensions.push([t,e])},isSVGElem:function(e){return 1==e.nodeType&&e.namespaceURI==t.svg.svgNS}}),t.extend(i.prototype,{_width:function(){return this._container?this._container.clientWidth:this._svg.width},_height:function(){return this._container?this._container.clientHeight:this._svg.height},root:function(){return this._svg},configure:function(e,o,n){if(e.nodeName||(n=o,o=e,e=this._svg),n)for(var i=e.attributes.length-1;i>=0;i--){var r=e.attributes.item(i);"onload"!=r.nodeName&&"version"!=r.nodeName&&"xmlns"!=r.nodeName.substring(0,5)&&e.attributes.removeNamedItem(r.nodeName)}for(var s in o)e.setAttribute(t.svg._attrNames[s]||s,o[s]);return this},getElementById:function(t){return this._svg.ownerDocument.getElementById(t)},change:function(e,o){if(e)for(var n in o)null==o[n]?e.removeAttribute(t.svg._attrNames[n]||n):e.setAttribute(t.svg._attrNames[n]||n,o[n]);return this},_args:function(e,o,n){o.splice(0,0,"parent"),o.splice(o.length,0,"settings");var i={},r=0;null!=e[0]&&e[0].jquery&&(e[0]=e[0][0]),null==e[0]||"object"==typeof e[0]&&e[0].nodeName||(i.parent=null,r=1);for(var s=0;s<e.length;s++)i[o[s+r]]=e[s];return n&&t.each(n,function(t,e){"object"==typeof i[e]&&(i.settings=i[e],i[e]=null)}),i},title:function(t,e,o){var n=this._args(arguments,["text"]),i=this._makeNode(n.parent,"title",n.settings||{});return i.appendChild(this._svg.ownerDocument.createTextNode(n.text)),i},describe:function(t,e,o){var n=this._args(arguments,["text"]),i=this._makeNode(n.parent,"desc",n.settings||{});return i.appendChild(this._svg.ownerDocument.createTextNode(n.text)),i},defs:function(e,o,n){var i=this._args(arguments,["id"],["id"]);return this._makeNode(i.parent,"defs",t.extend(i.id?{id:i.id}:{},i.settings||{}))},symbol:function(e,o,n,i,r,s,a){var l=this._args(arguments,["id","x1","y1","width","height"]);return this._makeNode(l.parent,"symbol",t.extend({id:l.id,viewBox:l.x1+" "+l.y1+" "+l.width+" "+l.height},l.settings||{}))},marker:function(e,o,n,i,r,s,a,l){var c=this._args(arguments,["id","refX","refY","mWidth","mHeight","orient"],["orient"]);return this._makeNode(c.parent,"marker",t.extend({id:c.id,refX:c.refX,refY:c.refY,markerWidth:c.mWidth,markerHeight:c.mHeight,orient:c.orient||"auto"},c.settings||{}))},style:function(e,o,n){var i=this._args(arguments,["styles"]),r=this._makeNode(i.parent,"style",t.extend({type:"text/css"},i.settings||{}));return r.appendChild(this._svg.ownerDocument.createTextNode(i.styles)),t.browser.opera&&t("head").append('<style type="text/css">'+i.styles+"</style>"),r},script:function(e,o,n,i){var r=this._args(arguments,["script","type"],["type"]),s=this._makeNode(r.parent,"script",t.extend({type:r.type||"text/javascript"},r.settings||{}));return s.appendChild(this._svg.ownerDocument.createTextNode(r.script)),t.browser.mozilla||t.globalEval(r.script),s},linearGradient:function(e,o,n,i,r,s,a,l){var c=this._args(arguments,["id","stops","x1","y1","x2","y2"],["x1"]),u=t.extend({id:c.id},null!=c.x1?{x1:c.x1,y1:c.y1,x2:c.x2,y2:c.y2}:{});return this._gradient(c.parent,"linearGradient",t.extend(u,c.settings||{}),c.stops)},radialGradient:function(e,o,n,i,r,s,a,l,c){var u=this._args(arguments,["id","stops","cx","cy","r","fx","fy"],["cx"]),h=t.extend({id:u.id},null!=u.cx?{cx:u.cx,cy:u.cy,r:u.r,fx:u.fx,fy:u.fy}:{});return this._gradient(u.parent,"radialGradient",t.extend(h,u.settings||{}),u.stops)},_gradient:function(e,o,n,i){for(var r=this._makeNode(e,o,n),s=0;s<i.length;s++){var a=i[s];this._makeNode(r,"stop",t.extend({offset:a[0],stopColor:a[1]},null!=a[2]?{stopOpacity:a[2]}:{}))}return r},pattern:function(e,o,n,i,r,s,a,l,c,u,h){var g=this._args(arguments,["id","x","y","width","height","vx","vy","vwidth","vheight"],["vx"]),p=t.extend({id:g.id,x:g.x,y:g.y,width:g.width,height:g.height},null!=g.vx?{viewBox:g.vx+" "+g.vy+" "+g.vwidth+" "+g.vheight}:{});return this._makeNode(g.parent,"pattern",t.extend(p,g.settings||{}))},clipPath:function(e,o,n,i){var r=this._args(arguments,["id","units"]);return r.units=r.units||"userSpaceOnUse",this._makeNode(r.parent,"clipPath",t.extend({id:r.id,clipPathUnits:r.units},r.settings||{}))},mask:function(e,o,n,i,r,s,a){var l=this._args(arguments,["id","x","y","width","height"]);return this._makeNode(l.parent,"mask",t.extend({id:l.id,x:l.x,y:l.y,width:l.width,height:l.height},l.settings||{}))},createPath:function(){return new r},createText:function(){return new s},svg:function(e,o,n,i,r,s,a,l,c,u){var h=this._args(arguments,["x","y","width","height","vx","vy","vwidth","vheight"],["vx"]),g=t.extend({x:h.x,y:h.y,width:h.width,height:h.height},null!=h.vx?{viewBox:h.vx+" "+h.vy+" "+h.vwidth+" "+h.vheight}:{});return this._makeNode(h.parent,"svg",t.extend(g,h.settings||{}))},group:function(e,o,n){var i=this._args(arguments,["id"],["id"]);return this._makeNode(i.parent,"g",t.extend({id:i.id},i.settings||{}))},use:function(e,o,n,i,r,s,a){var l=this._args(arguments,["x","y","width","height","ref"]);"string"==typeof l.x&&(l.ref=l.x,l.settings=l.y,l.x=l.y=l.width=l.height=null);var c=this._makeNode(l.parent,"use",t.extend({x:l.x,y:l.y,width:l.width,height:l.height},l.settings||{}));return c.setAttributeNS(t.svg.xlinkNS,"href",l.ref),c},link:function(e,o,n){var i=this._args(arguments,["ref"]),r=this._makeNode(i.parent,"a",i.settings);return r.setAttributeNS(t.svg.xlinkNS,"href",i.ref),r},image:function(e,o,n,i,r,s,a){var l=this._args(arguments,["x","y","width","height","ref"]),c=this._makeNode(l.parent,"image",t.extend({x:l.x,y:l.y,width:l.width,height:l.height},l.settings||{}));return c.setAttributeNS(t.svg.xlinkNS,"href",l.ref),c},path:function(e,o,n){var i=this._args(arguments,["path"]);return this._makeNode(i.parent,"path",t.extend({d:i.path.path?i.path.path():i.path},i.settings||{}))},rect:function(e,o,n,i,r,s,a,l){var c=this._args(arguments,["x","y","width","height","rx","ry"],["rx"]);return this._makeNode(c.parent,"rect",t.extend({x:c.x,y:c.y,width:c.width,height:c.height},c.rx?{rx:c.rx,ry:c.ry}:{},c.settings||{}))},circle:function(e,o,n,i,r){var s=this._args(arguments,["cx","cy","r"]);return this._makeNode(s.parent,"circle",t.extend({cx:s.cx,cy:s.cy,r:s.r},s.settings||{}))},ellipse:function(e,o,n,i,r,s){var a=this._args(arguments,["cx","cy","rx","ry"]);return this._makeNode(a.parent,"ellipse",t.extend({cx:a.cx,cy:a.cy,rx:a.rx,ry:a.ry},a.settings||{}))},line:function(e,o,n,i,r,s){var a=this._args(arguments,["x1","y1","x2","y2"]);return this._makeNode(a.parent,"line",t.extend({x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2},a.settings||{}))},polyline:function(t,e,o){var n=this._args(arguments,["points"]);return this._poly(n.parent,"polyline",n.points,n.settings)},polygon:function(t,e,o){var n=this._args(arguments,["points"]);return this._poly(n.parent,"polygon",n.points,n.settings)},_poly:function(e,o,n,i){for(var r="",s=0;s<n.length;s++)r+=n[s].join()+" ";return this._makeNode(e,o,t.extend({points:t.trim(r)},i||{}))},text:function(e,o,n,i,r){var s=this._args(arguments,["x","y","value"]);return"string"==typeof s.x&&arguments.length<4&&(s.value=s.x,s.settings=s.y,s.x=s.y=null),this._text(s.parent,"text",s.value,t.extend({x:s.x&&a(s.x)?s.x.join(" "):s.x,y:s.y&&a(s.y)?s.y.join(" "):s.y},s.settings||{}))},textpath:function(e,o,n,i){var r=this._args(arguments,["path","value"]),s=this._text(r.parent,"textPath",r.value,r.settings||{});return s.setAttributeNS(t.svg.xlinkNS,"href",r.path),s},_text:function(e,o,n,i){var r=this._makeNode(e,o,i);if("string"==typeof n)r.appendChild(r.ownerDocument.createTextNode(n));else for(var s=0;s<n._parts.length;s++){var a=n._parts[s];if("tspan"==a[0]){var l=this._makeNode(r,a[0],a[2]);l.appendChild(r.ownerDocument.createTextNode(a[1])),r.appendChild(l)}else if("tref"==a[0]){var l=this._makeNode(r,a[0],a[2]);l.setAttributeNS(t.svg.xlinkNS,"href",a[1]),r.appendChild(l)}else if("textpath"==a[0]){var c=t.extend({},a[2]);c.href=null;var l=this._makeNode(r,a[0],c);l.setAttributeNS(t.svg.xlinkNS,"href",a[2].href),l.appendChild(r.ownerDocument.createTextNode(a[1])),r.appendChild(l)}else r.appendChild(r.ownerDocument.createTextNode(a[1]))}return r},other:function(t,e,o){var n=this._args(arguments,["name"]);return this._makeNode(n.parent,n.name,n.settings||{})},_makeNode:function(e,o,n){e=e||this._svg;var i=this._svg.ownerDocument.createElementNS(t.svg.svgNS,o);for(var o in n){var r=n[o];null==r||null==r||"string"==typeof r&&""==r||i.setAttribute(t.svg._attrNames[o]||o,r)}return e.appendChild(i),i},add:function(e,o){var n=this._args(1==arguments.length?[null,e]:arguments,["node"]),i=this;n.parent=n.parent||this._svg,n.node=n.node.jquery?n.node:t(n.node);try{if(t.svg._renesis)throw"Force traversal";n.parent.appendChild(n.node.cloneNode(!0))}catch(t){n.node.each(function(){var t=i._cloneAsSVG(this);t&&n.parent.appendChild(t)})}return this},clone:function(e,o){var n=this,i=this._args(1==arguments.length?[null,e]:arguments,["node"]);i.parent=i.parent||this._svg,i.node=i.node.jquery?i.node:t(i.node);var r=[];return i.node.each(function(){var t=n._cloneAsSVG(this);t&&(t.id="",i.parent.appendChild(t),r.push(t))}),r},_cloneAsSVG:function(e){var o=null;if(1==e.nodeType){o=this._svg.ownerDocument.createElementNS(t.svg.svgNS,this._checkName(e.nodeName));for(var n=0;n<e.attributes.length;n++){var i=e.attributes.item(n);"xmlns"!=i.nodeName&&i.nodeValue&&("xlink"==i.prefix?o.setAttributeNS(t.svg.xlinkNS,i.localName||i.baseName,i.nodeValue):o.setAttribute(this._checkName(i.nodeName),i.nodeValue))}for(var n=0;n<e.childNodes.length;n++){var r=this._cloneAsSVG(e.childNodes[n]);r&&o.appendChild(r)}}else if(3==e.nodeType)t.trim(e.nodeValue)&&(o=this._svg.ownerDocument.createTextNode(e.nodeValue));else if(4==e.nodeType&&t.trim(e.nodeValue))try{o=this._svg.ownerDocument.createCDATASection(e.nodeValue)}catch(t){o=this._svg.ownerDocument.createTextNode(e.nodeValue.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"))}return o},_checkName:function(t){return t=t.substring(0,1)>="A"&&t.substring(0,1)<="Z"?t.toLowerCase():t,"svg:"==t.substring(0,4)?t.substring(4):t},load:function(e,o){o="boolean"==typeof o?{addTo:o}:"function"==typeof o?{onLoad:o}:"string"==typeof o?{parent:o}:"object"==typeof o&&o.nodeName?{parent:o}:"object"==typeof o&&o.jquery?{parent:o}:o||{},o.parent||o.addTo||this.clear(!1);var n=[this._svg.getAttribute("width"),this._svg.getAttribute("height")],i=this,r=function(e){e=t.svg.local.errorLoadingText+": "+e,o.onLoad?o.onLoad.apply(i._container||i._svg,[i,e]):i.text(null,10,20,e)},s=function(t){var e=new ActiveXObject("Microsoft.XMLDOM");return e.validateOnParse=!1,e.resolveExternals=!1,e.async=!1,e.loadXML(t),0!=e.parseError.errorCode?(r(e.parseError.reason),null):e},a=function(e){if(e){if("svg"!=e.documentElement.nodeName){var s=e.getElementsByTagName("parsererror"),a=s.length?s[0].getElementsByTagName("div"):[];return void r(s.length?(a.length?a[0]:s[0]).firstChild.nodeValue:"???")}for(var l=o.parent?t(o.parent)[0]:i._svg,c={},u=0;u<e.documentElement.attributes.length;u++){var h=e.documentElement.attributes.item(u);"version"!=h.nodeName&&"xmlns"!=h.nodeName.substring(0,5)&&(c[h.nodeName]=h.nodeValue)}i.configure(l,c,!o.parent);for(var g=e.documentElement.childNodes,u=0;u<g.length;u++)try{if(t.svg._renesis)throw"Force traversal";l.appendChild(i._svg.ownerDocument.importNode(g[u],!0)),"script"==g[u].nodeName&&t.globalEval(g[u].textContent)}catch(t){i.add(l,g[u])}o.changeSize||i.configure(l,{width:n[0],height:n[1]}),o.onLoad&&o.onLoad.apply(i._container||i._svg,[i])}};return e.match("<svg")?a(t.browser.msie?s(e):(new DOMParser).parseFromString(e,"text/xml")):t.ajax({url:e,dataType:t.browser.msie?"text":"xml",success:function(e){a(t.browser.msie?s(e):e)},error:function(t,e,o){r(e+(o?" "+o.message:""))}}),this},remove:function(t){return t=t.jquery?t[0]:t,t.parentNode.removeChild(t),this},clear:function(t){for(t&&this.configure({},!0);this._svg.firstChild;)this._svg.removeChild(this._svg.firstChild);return this},toSVG:function(t){return t=t||this._svg,"undefined"==typeof XMLSerializer?this._toSVG(t):(new XMLSerializer).serializeToString(t)},_toSVG:function(e){var o="";if(!e)return o;if(3==e.nodeType)o=e.nodeValue;else if(4==e.nodeType)o="<![CDATA["+e.nodeValue+"]]>";else{if(o="<"+e.nodeName,e.attributes)for(var n=0;n<e.attributes.length;n++){var i=e.attributes.item(n);""==t.trim(i.nodeValue)||i.nodeValue.match(/^\[object/)||i.nodeValue.match(/^function/)||(o+=" "+(i.namespaceURI==t.svg.xlinkNS?"xlink:":"")+i.nodeName+'="'+i.nodeValue+'"')}if(e.firstChild){o+=">";for(var r=e.firstChild;r;)o+=this._toSVG(r),r=r.nextSibling;o+="</"+e.nodeName+">"}else o+="/>"}return o}}),o.SVGPath=r,t.extend(r.prototype,{reset:function(){return this._path="",this},move:function(t,e,o){return o=a(t)?e:o,this._coords(o?"m":"M",t,e)},line:function(t,e,o){return o=a(t)?e:o,this._coords(o?"l":"L",t,e)},horiz:function(t,e){return this._path+=(e?"h":"H")+(a(t)?t.join(" "):t),this},vert:function(t,e){return this._path+=(e?"v":"V")+(a(t)?t.join(" "):t),this},curveC:function(t,e,o,n,i,r,s){return s=a(t)?e:s,this._coords(s?"c":"C",t,e,o,n,i,r)},smoothC:function(t,e,o,n,i){return i=a(t)?e:i,this._coords(i?"s":"S",t,e,o,n)},curveQ:function(t,e,o,n,i){return i=a(t)?e:i,this._coords(i?"q":"Q",t,e,o,n)},smoothQ:function(t,e,o){return o=a(t)?e:o,this._coords(o?"t":"T",t,e)},_coords:function(t,e,o,n,i,r,s){if(a(e))for(var l=0;l<e.length;l++){var c=e[l];this._path+=(0==l?t:" ")+c[0]+","+c[1]+(c.length<4?"":" "+c[2]+","+c[3]+(c.length<6?"":" "+c[4]+","+c[5]))}else this._path+=t+e+","+o+(null==n?"":" "+n+","+i+(null==r?"":" "+r+","+s));return this},arc:function(t,e,o,n,i,r,s,l){if(l=a(t)?e:l,this._path+=l?"a":"A",a(t))for(var c=0;c<t.length;c++){var u=t[c];this._path+=(0==c?"":" ")+u[0]+","+u[1]+" "+u[2]+" "+(u[3]?"1":"0")+","+(u[4]?"1":"0")+" "+u[5]+","+u[6]}else this._path+=t+","+e+" "+o+" "+(n?"1":"0")+","+(i?"1":"0")+" "+r+","+s;return this},close:function(){return this._path+="z",this},path:function(){return this._path}}),r.prototype.moveTo=r.prototype.move,r.prototype.lineTo=r.prototype.line,r.prototype.horizTo=r.prototype.horiz,r.prototype.vertTo=r.prototype.vert,r.prototype.curveCTo=r.prototype.curveC,r.prototype.smoothCTo=r.prototype.smoothC,r.prototype.curveQTo=r.prototype.curveQ,r.prototype.smoothQTo=r.prototype.smoothQ,r.prototype.arcTo=r.prototype.arc,t.extend(s.prototype,{reset:function(){return this._parts=[],this},string:function(t){return this._parts[this._parts.length]=["text",t],this},span:function(t,e){return this._parts[this._parts.length]=["tspan",t,e],this},ref:function(t,e){return this._parts[this._parts.length]=["tref",t,e],this},path:function(e,o,n){return this._parts[this._parts.length]=["textpath",o,t.extend({href:e},n||{})],this}}),t.fn.svg=function(e){var o=Array.prototype.slice.call(arguments,1);return"string"==typeof e&&"get"==e?t.svg["_"+e+"SVG"].apply(t.svg,[this[0]].concat(o)):this.each(function(){"string"==typeof e?t.svg["_"+e+"SVG"].apply(t.svg,[this].concat(o)):t.svg._attachSVG(this,e||{})})},t.svg=new e}(e),t.exports=o}).call(e,o(0))},function(t,e,o){(function(e){(function(){!function(t,e,o){t.spinner_options={options:{lines:7,length:0,width:5,radius:7,corners:1,rotate:0,direction:1,color:"#3b8ed7",speed:1.2,trail:100,shadow:!1,hwaccel:!0,className:"spinner",zIndex:2e9,top:"50%",left:"50%"}}}(window.circuitsGui=window.circuitsGui||{});var e=function(){"use strict";function t(t,e){var o,n=document.createElement(t||"div");for(o in e)n[o]=e[o];return n}function e(t){for(var e=1,o=arguments.length;e<o;e++)t.appendChild(arguments[e]);return t}function o(t,e,o,n){var i=["opacity",e,~~(100*t),o,n].join("-"),r=.01+o/n*100,s=Math.max(1-(1-t)/e*(100-r),t),a=l.substring(0,l.indexOf("Animation")).toLowerCase(),c=a&&"-"+a+"-"||"";return u[i]||(h.insertRule("@"+c+"keyframes "+i+"{0%{opacity:"+s+"}"+r+"%{opacity:"+t+"}"+(r+.01)+"%{opacity:1}"+(r+e)%100+"%{opacity:"+t+"}100%{opacity:"+s+"}}",h.cssRules.length),u[i]=1),i}function n(t,e){var o,n,i=t.style;for(e=e.charAt(0).toUpperCase()+e.slice(1),n=0;n<c.length;n++)if(o=c[n]+e,void 0!==i[o])return o;if(void 0!==i[e])return e}function i(t,e){for(var o in e)t.style[n(t,o)||o]=e[o];return t}function r(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)void 0===t[n]&&(t[n]=o[n])}return t}function s(t,e){return"string"==typeof t?t:t[e%t.length]}function a(t){this.opts=r(t||{},a.defaults,g)}var l,c=["webkit","Moz","ms","O"],u={},h=function(){var o=t("style",{type:"text/css"});return e(document.getElementsByTagName("head")[0],o),o.sheet||o.styleSheet}(),g={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",position:"absolute"};a.defaults={},r(a.prototype,{spin:function(e){this.stop();var o=this,n=o.opts,r=o.el=i(t(0,{className:n.className}),{position:n.position,width:0,zIndex:n.zIndex});n.radius,n.length,n.width;if(i(r,{left:n.left,top:n.top}),e&&e.insertBefore(r,e.firstChild||null),r.setAttribute("role","progressbar"),o.lines(r,o.opts),!l){var s,a=0,c=(n.lines-1)*(1-n.direction)/2,u=n.fps,h=u/n.speed,g=(1-n.opacity)/(h*n.trail/100),p=h/n.lines;!function t(){a++;for(var e=0;e<n.lines;e++)s=Math.max(1-(a+(n.lines-e)*p)%h*g,n.opacity),o.opacity(r,e*n.direction+c,s,n);o.timeout=o.el&&setTimeout(t,~~(1e3/u))}()}return o},stop:function(){var t=this.el;return t&&(clearTimeout(this.timeout),t.parentNode&&t.parentNode.removeChild(t),this.el=void 0),this},lines:function(n,r){function a(e,o){return i(t(),{position:"absolute",width:r.length+r.width+"px",height:r.width+"px",background:e,boxShadow:o,transformOrigin:"left",transform:"rotate("+~~(360/r.lines*u+r.rotate)+"deg) translate("+r.radius+"px,0)",borderRadius:(r.corners*r.width>>1)+"px"})}for(var c,u=0,h=(r.lines-1)*(1-r.direction)/2;u<r.lines;u++)c=i(t(),{position:"absolute",top:1+~(r.width/2)+"px",transform:r.hwaccel?"translate3d(0,0,0)":"",opacity:r.opacity,animation:l&&o(r.opacity,r.trail,h+u*r.direction,r.lines)+" "+1/r.speed+"s linear infinite"}),r.shadow&&e(c,i(a("#000","0 0 4px #000"),{top:"2px"})),e(n,e(c,a(s(r.color,u),"0 0 1px rgba(0,0,0,.1)")));return n},opacity:function(t,e,o){e<t.childNodes.length&&(t.childNodes[e].style.opacity=o)}});var p=i(t("group"),{behavior:"url(#default#VML)"});return!n(p,"transform")&&p.adj?function(){function o(e,o){return t("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',o)}h.addRule(".spin-vml","behavior:url(#default#VML)"),a.prototype.lines=function(t,n){function r(){return i(o("group",{coordsize:u+" "+u,coordorigin:-c+" "+-c}),{width:u,height:u})}function a(t,a,l){e(g,e(i(r(),{rotation:360/n.lines*t+"deg",left:~~a}),e(i(o("roundrect",{arcsize:n.corners}),{width:c,height:n.width,left:n.radius,top:-n.width>>1,filter:l}),o("fill",{color:s(n.color,t),opacity:n.opacity}),o("stroke",{opacity:0}))))}var l,c=n.length+n.width,u=2*c,h=2*-(n.width+n.length)+"px",g=i(r(),{position:"absolute",top:h,left:h});if(n.shadow)for(l=1;l<=n.lines;l++)a(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=n.lines;l++)a(l);return e(t,g)},a.prototype.opacity=function(t,e,o,n){var i=t.firstChild;n=n.shadow&&n.lines||0,i&&e+n<i.childNodes.length&&(i=i.childNodes[e+n],i=i&&i.firstChild,(i=i&&i.firstChild)&&(i.opacity=o))}}():l=n(p,"animation"),a}();t.exports=e}).call(window)}).call(e,o(0))},function(t,e){(function(){window.Modernizr=function(t,e,o){function n(t){d.cssText=t}function i(t,e){return typeof t===e}function r(t,e){return!!~(""+t).indexOf(e)}function s(t,e){for(var n in t){var i=t[n];if(!r(i,"-")&&d[i]!==o)return"pfx"!=e||i}return!1}function a(t,e,n){for(var r in t){var s=e[t[r]];if(s!==o)return!1===n?t[r]:i(s,"function")?s.bind(n||e):s}return!1}function l(t,e,o){var n=t.charAt(0).toUpperCase()+t.slice(1),r=(t+" "+y.join(n+" ")+n).split(" ");return i(e,"string")||i(e,"undefined")?s(r,e):(r=(t+" "+v.join(n+" ")+n).split(" "),a(r,e,o))}var c,u,h={},g=e.documentElement,p=e.createElement("modernizr"),d=p.style,f={}.toString,m="Webkit Moz O ms",y=m.split(" "),v=m.toLowerCase().split(" "),_={svg:"http://www.w3.org/2000/svg"},b={},E=[],x=E.slice,S=function(){function t(t,r){r=r||e.createElement(n[t]||"div"),t="on"+t;var s=t in r;return s||(r.setAttribute||(r=e.createElement("div")),r.setAttribute&&r.removeAttribute&&(r.setAttribute(t,""),s=i(r[t],"function"),i(r[t],"undefined")||(r[t]=o),r.removeAttribute(t))),r=null,s}var n={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return t}(),T={}.hasOwnProperty;u=i(T,"undefined")||i(T.call,"undefined")?function(t,e){return e in t&&i(t.constructor.prototype[e],"undefined")}:function(t,e){return T.call(t,e)},Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if("function"!=typeof e)throw new TypeError;var o=x.call(arguments,1),n=function(){if(this instanceof n){var i=function(){};i.prototype=e.prototype;var r=new i,s=e.apply(r,o.concat(x.call(arguments)));return Object(s)===s?s:r}return e.apply(t,o.concat(x.call(arguments)))};return n}),b.hashchange=function(){return S("hashchange",t)&&(e.documentMode===o||e.documentMode>7)},b.cssanimations=function(){return l("animationName")},b.webworkers=function(){return!!t.Worker},b.svg=function(){return!!e.createElementNS&&!!e.createElementNS(_.svg,"svg").createSVGRect},b.svgclippaths=function(){return!!e.createElementNS&&/SVGClipPath/.test(f.call(e.createElementNS(_.svg,"clipPath")))};for(var w in b)u(b,w)&&(c=w.toLowerCase(),h[c]=b[w](),E.push((h[c]?"":"no-")+c));return h.addTest=function(t,e){if("object"==typeof t)for(var n in t)u(t,n)&&h.addTest(n,t[n]);else{if(t=t.toLowerCase(),h[t]!==o)return h;e="function"==typeof e?e():e,"undefined"!=typeof enableClasses&&enableClasses&&(g.className+=" "+(e?"":"no-")+t),h[t]=e}return h},n(""),p=null,function(t,e){function o(t,e){var o=t.createElement("p"),n=t.getElementsByTagName("head")[0]||t.documentElement;return o.innerHTML="x<style>"+e+"</style>",n.insertBefore(o.lastChild,n.firstChild)}function n(){var t=y.elements;return"string"==typeof t?t.split(" "):t}function i(t){var e=m[t[d]];return e||(e={},f++,t[d]=f,m[f]=e),e}function r(t,o,n){if(o||(o=e),u)return o.createElement(t);n||(n=i(o));var r;return r=n.cache[t]?n.cache[t].cloneNode():p.test(t)?(n.cache[t]=n.createElem(t)).cloneNode():n.createElem(t),!r.canHaveChildren||g.test(t)||r.tagUrn?r:n.frag.appendChild(r)}function s(t,o){if(t||(t=e),u)return t.createDocumentFragment();o=o||i(t);for(var r=o.frag.cloneNode(),s=0,a=n(),l=a.length;s<l;s++)r.createElement(a[s]);return r}function a(t,e){e.cache||(e.cache={},e.createElem=t.createElement,e.createFrag=t.createDocumentFragment,e.frag=e.createFrag()),t.createElement=function(o){return y.shivMethods?r(o,t,e):e.createElem(o)},t.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+n().join().replace(/[\w\-]+/g,function(t){return e.createElem(t),e.frag.createElement(t),'c("'+t+'")'})+");return n}")(y,e.frag)}function l(t){t||(t=e);var n=i(t);return y.shivCSS&&!c&&!n.hasCSS&&(n.hasCSS=!!o(t,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),u||a(t,n),t}var c,u,h=t.html5||{},g=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,p=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,d="_html5shiv",f=0,m={};!function(){try{var t=e.createElement("a");t.innerHTML="<xyz></xyz>",c="hidden"in t,u=1==t.childNodes.length||function(){e.createElement("a");var t=e.createDocumentFragment();return void 0===t.cloneNode||void 0===t.createDocumentFragment||void 0===t.createElement}()}catch(t){c=!0,u=!0}}();var y={elements:h.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:"3.7.0",shivCSS:!1!==h.shivCSS,supportsUnknownElements:u,shivMethods:!1!==h.shivMethods,type:"default",shivDocument:l,createElement:r,createDocumentFragment:s};t.html5=y,l(e)}(this,e),h._version="2.7.1",h._domPrefixes=v,h._cssomPrefixes=y,h.hasEvent=S,h.testProp=function(t){return s([t])},h.testAllProps=l,h}(this,this.document),function(t,e,o){function n(t){return"[object Function]"==m.call(t)}function i(t){return"string"==typeof t}function r(){}function s(t){return!t||"loaded"==t||"complete"==t||"uninitialized"==t}function a(){var t=y.shift();v=1,t?t.t?d(function(){("c"==t.t?g.injectCss:g.injectJs)(t.s,0,t.a,t.x,t.e,1)},0):(t(),a()):v=0}function l(t,o,n,i,r,l,c){function u(e){if(!p&&s(h.readyState)&&(_.r=p=1,!v&&a(),h.onload=h.onreadystatechange=null,e)){"img"!=t&&d(function(){E.removeChild(h)},50);for(var n in C[o])C[o].hasOwnProperty(n)&&C[o][n].onload()}}var c=c||g.errorTimeout,h=e.createElement(t),p=0,m=0,_={t:n,s:o,e:r,a:l,x:c};1===C[o]&&(m=1,C[o]=[]),"object"==t?h.data=o:(h.src=o,h.type=t),h.width=h.height="0",h.onerror=h.onload=h.onreadystatechange=function(){u.call(this,m)},y.splice(i,0,_),"img"!=t&&(m||2===C[o]?(E.insertBefore(h,b?null:f),d(u,c)):C[o].push(h))}function c(t,e,o,n,r){return v=0,e=e||"j",i(t)?l("c"==e?S:x,t,e,this.i++,o,n,r):(y.splice(this.i++,0,t),1==y.length&&a()),this}function u(){var t=g;return t.loader={load:c,i:0},t}var h,g,p=e.documentElement,d=t.setTimeout,f=e.getElementsByTagName("script")[0],m={}.toString,y=[],v=0,_="MozAppearance"in p.style,b=_&&!!e.createRange().compareNode,E=b?p:f.parentNode,p=t.opera&&"[object Opera]"==m.call(t.opera),p=!!e.attachEvent&&!p,x=_?"object":p?"script":"img",S=p?"script":x,T=Array.isArray||function(t){return"[object Array]"==m.call(t)},w=[],C={},k={timeout:function(t,e){return e.length&&(t.timeout=e[0]),t}};g=function(t){function e(t){var e,o,n,t=t.split("!"),i=w.length,r=t.pop(),s=t.length,r={url:r,origUrl:r,prefixes:t};for(o=0;o<s;o++)n=t[o].split("="),(e=k[n.shift()])&&(r=e(r,n));for(o=0;o<i;o++)r=w[o](r);return r}function s(t,i,r,s,a){var l=e(t),c=l.autoCallback;l.url.split(".").pop().split("?").shift(),l.bypass||(i&&(i=n(i)?i:i[t]||i[s]||i[t.split("/").pop().split("?")[0]]),l.instead?l.instead(t,i,r,s,a):(C[l.url]?l.noexec=!0:C[l.url]=1,r.load(l.url,l.forceCSS||!l.forceJS&&"css"==l.url.split(".").pop().split("?").shift()?"c":o,l.noexec,l.attrs,l.timeout),(n(i)||n(c))&&r.load(function(){u(),i&&i(l.origUrl,a,s),c&&c(l.origUrl,a,s),C[l.url]=2})))}function a(t,e){function o(t,o){if(t){if(i(t))o||(h=function(){var t=[].slice.call(arguments);g.apply(this,t),p()}),s(t,h,e,0,c);else if(Object(t)===t)for(l in a=function(){var e,o=0;for(e in t)t.hasOwnProperty(e)&&o++;return o}(),t)t.hasOwnProperty(l)&&(!o&&!--a&&(n(h)?h=function(){var t=[].slice.call(arguments);g.apply(this,t),p()}:h[l]=function(t){return function(){var e=[].slice.call(arguments);t&&t.apply(this,e),p()}}(g[l])),s(t[l],h,e,l,c))}else!o&&p()}var a,l,c=!!t.test,u=t.load||t.both,h=t.callback||r,g=h,p=t.complete||r;o(c?t.yep:t.nope,!!u),u&&o(u)}var l,c,h=this.yepnope.loader;if(i(t))s(t,0,h,0);else if(T(t))for(l=0;l<t.length;l++)c=t[l],i(c)?s(c,0,h,0):T(c)?g(c):Object(c)===c&&a(c,h);else Object(t)===t&&a(t,h)},g.addPrefix=function(t,e){k[t]=e},g.addFilter=function(t){w.push(t)},g.errorTimeout=1e4,null==e.readyState&&e.addEventListener&&(e.readyState="loading",e.addEventListener("DOMContentLoaded",h=function(){e.removeEventListener("DOMContentLoaded",h,0),e.readyState="complete"},0)),t.yepnope=u(),t.yepnope.executeStack=a,t.yepnope.injectJs=function(t,o,n,i,l,c){var u,h,p=e.createElement("script"),i=i||g.errorTimeout;p.src=t;for(h in n)p.setAttribute(h,n[h]);o=c?a:o||r,p.onreadystatechange=p.onload=function(){!u&&s(p.readyState)&&(u=1,o(),p.onload=p.onreadystatechange=null)},d(function(){u||(u=1,o(1))},i),l?p.onload():f.parentNode.insertBefore(p,f)},t.yepnope.injectCss=function(t,o,n,i,s,l){var c,i=e.createElement("link"),o=l?a:o||r;i.href=t,i.rel="stylesheet",i.type="text/css";for(c in n)i.setAttribute(c,n[c]);s||(f.parentNode.insertBefore(i,f),d(o,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},t.exports=window.Modernizr}).call(window)},function(module,exports,__webpack_require__){(function(jQuery){(function(){/*! seamless.js 2015-04-30 */
var NO_JQUERY={};!function(t,e,o){if(!("console"in t)){var n=t.console={};n.log=n.warn=n.error=n.debug=function(){}}e===NO_JQUERY&&(e={fn:{},extend:function(){for(var t=arguments[0],e=1,o=arguments.length;o>e;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t}}),e.fn.pm=function(){return console.log("usage: \nto send:    $.pm(options)\nto receive: $.pm.bind(type, fn, [origin])"),this},e.pm=t.pm=function(t){i.send(t)},e.pm.bind=t.pm.bind=function(t,e,o,n,r){i.bind(t,e,o,n,!0===r)},e.pm.unbind=t.pm.unbind=function(t,e){i.unbind(t,e)},e.pm.origin=t.pm.origin=null,e.pm.poll=t.pm.poll=200;var i={send:function(t){var o=e.extend({},i.defaults,t),n=o.target;if(!o.target)return void console.warn("postmessage target window required");if(!o.type)return void console.warn("postmessage type required");var r={data:o.data,type:o.type};o.success&&(r.callback=i._callback(o.success)),o.error&&(r.errback=i._callback(o.error)),"postMessage"in n&&!o.hash?(i._bind(),n.postMessage(JSON.stringify(r),o.origin||"*")):(i.hash._bind(),i.hash.send(o,r))},bind:function(t,e,o,n,r){i._replyBind(t,e,o,n,r)},_replyBind:function(o,n,r,s,a){"postMessage"in t&&!s?i._bind():i.hash._bind();var l=i.data("listeners.postmessage");l||(l={},i.data("listeners.postmessage",l));var c=l[o];c||(c=[],l[o]=c),c.push({fn:n,callback:a,origin:r||e.pm.origin})},unbind:function(t,e){var o=i.data("listeners.postmessage");if(o)if(t)if(e){var n=o[t];if(n){for(var r=[],s=0,a=n.length;a>s;s++){var l=n[s];l.fn!==e&&r.push(l)}o[t]=r}}else delete o[t];else for(var s in o)delete o[s]},data:function(t,e){return void 0===e?i._data[t]:(i._data[t]=e,e)},_data:{},_CHARS:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),_random:function(){for(var t=[],e=0;32>e;e++)t[e]=i._CHARS[0|32*Math.random()];return t.join("")},_callback:function(t){var e=i.data("callbacks.postmessage");e||(e={},i.data("callbacks.postmessage",e));var o=i._random();return e[o]=t,o},_bind:function(){i.data("listening.postmessage")||(t.addEventListener?t.addEventListener("message",i._dispatch,!1):t.attachEvent&&t.attachEvent("onmessage",i._dispatch),i.data("listening.postmessage",1))},_dispatch:function(t){function e(e){o.callback&&i.send({target:t.source,data:e,type:o.callback})}try{var o=JSON.parse(t.data)}catch(t){return void console.warn("postmessage data invalid json: ",t)}if(!o.type)return void console.warn("postmessage message type required");var n=i.data("callbacks.postmessage")||{},r=n[o.type];if(r)r(o.data);else for(var s=i.data("listeners.postmessage")||{},a=s[o.type]||[],l=0,c=a.length;c>l;l++){var u=a[l];if(u.origin&&"*"!==u.origin&&t.origin!==u.origin){if(console.warn("postmessage message origin mismatch",t.origin,u.origin),o.errback){var h={message:"postmessage origin mismatch",origin:[t.origin,u.origin]};i.send({target:t.source,data:h,type:o.errback})}}else try{u.callback?u.fn(o.data,e,t):e(u.fn(o.data,t))}catch(e){if(!o.errback)throw e;i.send({target:t.source,data:e,type:o.errback})}}}};i.hash={send:function(e,o){var n=e.target,r=e.url;if(!r)return void console.warn("postmessage target window url is required");r=i.hash._url(r);var s,a=i.hash._url(t.location.href);if(t==n.parent)s="parent";else try{for(var l=0,c=parent.frames.length;c>l;l++){if(parent.frames[l]==t){s=l;break}}}catch(e){s=t.name}if(null==s)return void console.warn("postmessage windows must be direct parent/child windows and the child must be available through the parent window.frames list");var u={"x-requested-with":"postmessage",source:{name:s,url:a},postmessage:o},h="#x-postmessage-id="+i._random();n.location=r+h+encodeURIComponent(JSON.stringify(u))},_regex:/^\#x\-postmessage\-id\=(\w{32})/,_regex_len:"#x-postmessage-id=".length+32,_bind:function(){i.data("polling.postmessage")||(setInterval(function(){var e=""+t.location.hash,o=i.hash._regex.exec(e);if(o){var n=o[1];i.hash._last!==n&&(i.hash._last=n,i.hash._dispatch(e.substring(i.hash._regex_len)))}},e.pm.poll||200),i.data("polling.postmessage",1))},_dispatch:function(e){function o(t){n.callback&&i.send({target:a,data:t,type:n.callback,hash:!0,url:e.source.url})}if(e){try{if(e=JSON.parse(decodeURIComponent(e)),!("postmessage"===e["x-requested-with"]&&e.source&&null!=e.source.name&&e.source.url&&e.postmessage))return}catch(t){return}var n=e.postmessage,r=i.data("callbacks.postmessage")||{},s=r[n.type];if(s)s(n.data);else{var a;a="parent"===e.source.name?t.parent:t.frames[e.source.name];for(var l=i.data("listeners.postmessage")||{},c=l[n.type]||[],u=0,h=c.length;h>u;u++){var g=c[u];if(g.origin){var p=/https?\:\/\/[^\/]*/.exec(e.source.url)[0];if("*"!==g.origin&&p!==g.origin){if(console.warn("postmessage message origin mismatch",p,g.origin),n.errback){var d={message:"postmessage origin mismatch",origin:[p,g.origin]};i.send({target:a,data:d,type:n.errback,hash:!0,url:e.source.url})}continue}}try{g.callback?g.fn(n.data,o):o(g.fn(n.data))}catch(t){if(!n.errback)throw t;i.send({target:a,data:t,type:n.errback,hash:!0,url:e.source.url})}}}}},_url:function(t){return(""+t).replace(/#.*$/,"")}},e.extend(i,{defaults:{target:null,url:null,type:null,data:null,success:null,error:null,origin:"*",hash:!1}})}(this,void 0===jQuery?NO_JQUERY:jQuery),"JSON"in window&&window.JSON||(JSON={}),function(){function f(t){return 10>t?"0"+t:t}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var o,n,i,r,s,a=gap,l=e[t];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(t)),"function"==typeof rep&&(l=rep.call(e,t,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(l)){for(r=l.length,o=0;r>o;o+=1)s[o]=str(o,l)||"null";return i=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+a+"]":"["+s.join(",")+"]",gap=a,i}if(rep&&"object"==typeof rep)for(r=rep.length,o=0;r>o;o+=1)"string"==typeof(n=rep[o])&&(i=str(n,l))&&s.push(quote(n)+(gap?": ":":")+i);else for(n in l)Object.hasOwnProperty.call(l,n)&&(i=str(n,l))&&s.push(quote(n)+(gap?": ":":")+i);return i=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+a+"}":"{"+s.join(",")+"}",gap=a,i}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(t){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(t){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,e,o){var n;if(gap="",indent="","number"==typeof o)for(n=0;o>n;n+=1)indent+=" ";else"string"==typeof o&&(indent=o);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(t,e){var o,n,i=t[e];if(i&&"object"==typeof i)for(o in i)Object.hasOwnProperty.call(i,o)&&(n=walk(i,o),void 0!==n?i[o]=n:delete i[o]);return reviver.call(t,e,i)}var j;if(cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(t,e,o,n){o.SeamlessBase={getParam:function(e,o){o=o||t.location.search;var n="[?&]"+e+"=([^&#]*)",i=new RegExp(n),r=i.exec(o);return null===r?"":decodeURIComponent(r[1].replace(/\+/g," "))},filterText:function(t){return t.replace(/[<>]/g,"")},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},setStyle:function(t,e){e.length>0&&(e="string"==typeof e?e:e.join(" "),e=o.SeamlessBase.filterText(e),t.styleSheet?t.styleSheet.cssText=e:o(t).html(e))},injectStyles:function(t){var n=o("style#injected-styles");if(n.length>0)o.SeamlessBase.setStyle(n[0],t);else{var i=o(e.createElement("style")).attr({type:"text/css",id:"injected-styles"});o.SeamlessBase.setStyle(i[0],t),o("head").append(i)}},injectAppendedStyles:function(t){var n=o(e.createElement("style")).attr({type:"text/css",id:"injected-styles"});o.SeamlessBase.setStyle(n[0],t),o("head").append(n)}}}(window,document,jQuery),function(t,e,o,n){o.SeamlessConnection=function(t,e){this.id=0,this.target=t,this.url=e,this.active=!1,this.queue=[]},o.SeamlessConnection.prototype.send=function(t){this.active&&this.target?(t=t||{},t.hasOwnProperty("data")||(t={data:t}),t.target=this.target,t.url=this.url,t.type=t.type||"seamless_data",t.data=t.data||{},t.data.__id=this.id,o.pm(t)):this.queue.push(t)},o.SeamlessConnection.prototype.receive=function(t,e){"function"==typeof t&&(e=t,t="seamless_data");var n=this;o.pm.bind(t,function(t,o){return!(!t.__id||t.__id!==n.id)&&e(t,o)})},o.SeamlessConnection.prototype.setActive=function(t){if(this.active=t,this.queue.length>0){for(var e in this.queue)this.send(this.queue[e]);this.queue=[],this.queue.length=0}}}(window,document,jQuery),function(t,e,o,n){if(!o.hasOwnProperty("pm"))return void console.log("You must install the jQuery.pm module to use seamless.js.");o.pm.bind("seamless_noiframe",function(e){e.href=e.href.replace(/noiframe\=[^&?#]+/,""),t.location.replace(e.href)}),t.seamlessOpenFallback=function(e,o,n,i){i.preventDefault?(i.preventDefault(),i.stopPropagation()):i.returnValue=!1,t.open(e,"",["width="+o,"height="+n,"menubar=no","titlebar=no","toolbar=no","status=no","scrollbars=yes","chrome=yes"].join(","))};var i=[],r=!1,s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),a=function(){for(var t=[],e=0;32>e;e++)t[e]=s[0|32*Math.random()];return t.join("")};o.pm.bind("seamless_ready",function(t,e){if(!r){r=!0;for(var o in i)i.hasOwnProperty(o)&&i[o].seamless_ready(t,e);r=!1}}),o.pm.bind("seamless_update",function(t,e){for(var o in i)if(i.hasOwnProperty(o)){var n=i[o];if(n.connection.id===t.__id)return n.seamless_update(t,e)}return t.height=0,t}),o.pm.bind("seamless_error",function(t,e){for(var o in i)i.hasOwnProperty(o)&&i[o].seamless_error(t,e)}),o.fn.seamless=function(n){var r={showLoadingIndicator:!0,loading:"Loading ...",spinner:"http://www.travistidwell.com/seamless.js/src/loader.gif",onConnect:null,styles:[],fallback:!0,fallbackParams:"",fallbackText:"",fallbackLinkText:"Click here",fallbackLinkAfter:" to open in a separate window.",fallbackStyles:["padding: 15px","border: 1px solid transparent","border-radius: 4px","color: #3a87ad","background-color: #d9edf7","border-color: #bce8f1"],fallbackLinkStyles:["display: inline-block","color: #333","border: 1px solid #ccc","background-color: #fff","padding: 5px 10px","text-decoration: none","font-size: 12px","line-height: 1.5","border-radius: 6px","font-weight: 400","cursor: pointer","-webkit-user-select: none","-moz-user-select: none","-ms-user-select: none","user-select: none"],fallbackLinkHoverStyles:["background-color:#ebebeb","border-color:#adadad"],fallbackWindowWidth:960,fallbackWindowHeight:800};n=n||{};for(var s in r)n.hasOwnProperty(s)||(n[s]=r[s]);var l=o(this).eq(0);l.seamless_options=n,i.push(l);var c=(l.attr("name")||l.attr("id"),l.attr("src"));if(l.connection=new o.SeamlessConnection(l[0].contentWindow,c),l.send=function(t){l.connection.send.call(l.connection,t)},l.receive=function(t,e){l.connection.receive.call(l.connection,t,e)},l.attr({scrolling:"no",seamless:"seamless",width:"100%",height:"0px",marginheight:"0",marginwidth:"0",frameborder:"0",horizontalscrolling:"no",verticalscrolling:"no"}).css({border:"none",overflowY:"hidden"}),n.showLoadingIndicator){var u=o(e.createElement("div"));u.css({background:"url("+n.spinner+") no-repeat 10px 13px",padding:"10px 10px 10px 60px",width:"100%"}),u.append(n.loading),l.before(u)}var h=!0,g=function(){h=!1,void 0!==u&&u.remove()};if(n.fallback){n.fallbackParams&&(c+=-1===c.search(/\?/)?"?":"&",c+=n.fallbackParams);var p=o("#seamless-fallback-styles");if(!p.length){var d=function(t){return o.SeamlessBase.filterText(t.join(";"))};p=o(e.createElement("style")).attr({id:"seamless-fallback-styles",type:"text/css"}),o.SeamlessBase.setStyle(p[0],".seamless-fallback.seamless-styles {"+d(n.fallbackStyles)+"}.seamless-fallback em { padding: 5px; }.seamless-fallback-link.seamless-styles {"+d(n.fallbackLinkStyles)+"}.seamless-fallback-link.seamless-styles:hover {"+d(n.fallbackLinkHoverStyles)+"}"),l.before(p)}var f=['"'+c+'"',n.fallbackWindowWidth,n.fallbackWindowHeight],m=o(e.createElement("a")).attr({class:"seamless-fallback-link",href:"#",onclick:"seamlessOpenFallback("+f.join(",")+", event)"}),y=o(e.createElement("div")).attr({class:"seamless-fallback"});y.append(o(e.createElement("em"))),l.after(y);var v=function(t,e,n,i){i?(y.addClass("seamless-styles"),m.addClass("seamless-styles")):(y.removeClass("seamless-styles"),m.removeClass("seamless-styles")),y.find("em").text(o.SeamlessBase.filterText(t)+" ").append(m.text(o.SeamlessBase.filterText(e))).append(o.SeamlessBase.filterText(n))};n.fallbackText&&v(n.fallbackText,n.fallbackLinkText,n.fallbackLinkAfter,!1),o(t).error(function(){var t="An error has been detected on this page, ";t+="which may cause problems with the operation of this application.",v(t,n.fallbackLinkText,n.fallbackLinkAfter,!0)}),setTimeout(function(){h&&(g(),v("An error has been detected on this page.",n.fallbackLinkText,n.fallbackLinkAfter,!0))},3e4)}return l.seamless_ready=function(t,e){l.connection.id||(l.connection.id=a());var n={id:l.connection.id,styles:l.seamless_options.styles};l.connection.target||(l.connection.target=l[0].contentWindow),o.pm({type:"seamless_connect",target:l.connection.target,url:l.connection.url,data:n,success:function(t){l.seamless_options.onConnect&&l.seamless_options.onConnect(t)}}),l.trigger("connected")},l.seamless_update=function(t,e){return h&&(g(),l.connection.setActive(!0)),t.height>=0&&l.height(t.height).attr("height",t.height+"px"),t},l.seamless_error=function(t,e){g(),l.hide(),v(t.msg,t.linkText,t.afterText,!0)},l}}(window,document,jQuery)}).call(window)}).call(exports,__webpack_require__(0))},function(t,e,o){(function(){!function(){"use strict";var e={};void 0!==o&&(e=o);var o=e;e.version="0.0.7",e.config={textDiffMinLength:60,detectArrayMove:!0,includeValueOnArrayMove:!1};var n={diff:function(t,o,n,i){for(var r,s,a,l=0,c=0,u=t.length,h=o.length,g=[],p=[],d="function"==typeof n?function(t,e,o,i){if(t===e)return!0;if("object"!=typeof t||"object"!=typeof e)return!1;var r,s;return"number"==typeof o?void 0===(r=g[o])&&(g[o]=r=n(t)):r=n(t),"number"==typeof i?void 0===(s=p[i])&&(p[i]=s=n(e)):s=n(e),r===s}:function(t,e){return t===e},f=function(e,n){return d(t[e],o[n],e,n)},m=function(e,n){if(i&&"object"==typeof t[e]&&"object"==typeof o[n]){var r=i(t[e],o[n]);void 0!==r&&(a||(a={_t:"a"}),a[n]=r)}};l<u&&l<h&&f(l,l);)m(l,l),l++;for(;c+l<u&&c+l<h&&f(u-1-c,h-1-c);)m(u-1-c,h-1-c),c++;if(l+c===u){if(u===h)return a;for(a=a||{_t:"a"},r=l;r<h-c;r++)a[r]=[o[r]];return a}if(l+c===h){for(a=a||{_t:"a"},r=l;r<u-c;r++)a["_"+r]=[t[r],0,0];return a}var y=this.lcs(t.slice(l,u-c),o.slice(l,h-c),{areTheSameByIndex:function(t,e){return f(t+l,e+l)}});a=a||{_t:"a"};var v=[];for(r=l;r<u-c;r++)y.indices1.indexOf(r-l)<0&&(a["_"+r]=[t[r],0,0],v.push(r));var _=v.length;for(r=l;r<h-c;r++){var b=y.indices2.indexOf(r-l);if(b<0){var E=!1;if(e.config.detectArrayMove&&_>0)for(s=0;s<_;s++)if(f(v[s],r)){a["_"+v[s]].splice(1,2,r,3),e.config.includeValueOnArrayMove||(a["_"+v[s]][0]=""),m(v[s],r),v.splice(s,1),E=!0;break}E||(a[r]=[o[r]])}else m(y.indices1[b]+l,y.indices2[b]+l)}return a},getArrayIndexBefore:function(t,e){var o,n=e;for(var i in t)if(t.hasOwnProperty(i)&&r(t[i]))if(o="_"===i.slice(0,1)?parseInt(i.slice(1),10):parseInt(i,10),1===t[i].length){if(o<e)n--;else if(o===e)return-1}else if(3===t[i].length)if(0===t[i][2])o<=e&&n++;else if(3===t[i][2])if(o<=e&&n++,t[i][1]>e)n--;else if(t[i][1]===e)return o;return n},patch:function(t,e,o,n){var i,r,s=function(t,e){return t-e},a=[],l=[],c=[];for(i in e)if("_t"!==i)if("_"==i[0]){if(0!==e[i][2]&&3!==e[i][2])throw new Error("only removal or move can be applied at original array indices, invalid diff type: "+e[i][2]);a.push(parseInt(i.slice(1),10))}else 1===e[i].length?l.push({index:parseInt(i,10),value:e[i][0]}):c.push({index:parseInt(i,10),diff:e[i]});for(a=a.sort(s),i=a.length-1;i>=0;i--){r=a[i];var u=e["_"+r],h=t.splice(r,1)[0];3===u[2]&&l.push({index:u[1],value:h})}l=l.sort(function(t){return function(e,o){return e[t]-o[t]}}("index"));var g=l.length;for(i=0;i<g;i++){var p=l[i];t.splice(p.index,0,p.value)}var d=c.length;if(d>0){if("function"!=typeof o)throw new Error("to patch items in the array an objectInnerPatch function must be provided");for(i=0;i<d;i++){var f=c[i];o(t,f.index.toString(),f.diff,n)}}return t},lcs:function(t,e,o){o.areTheSameByIndex=o.areTheSameByIndex||function(o,n){return t[o]===e[n]};var n=this.lengthMatrix(t,e,o),i=this.backtrack(n,t,e,t.length,e.length);return"string"==typeof t&&"string"==typeof e&&(i.sequence=i.sequence.join("")),i},lengthMatrix:function(t,e,o){var n,i,r=t.length,s=e.length,a=[r+1];for(n=0;n<r+1;n++)for(a[n]=[s+1],i=0;i<s+1;i++)a[n][i]=0;for(a.options=o,n=1;n<r+1;n++)for(i=1;i<s+1;i++)o.areTheSameByIndex(n-1,i-1)?a[n][i]=a[n-1][i-1]+1:a[n][i]=Math.max(a[n-1][i],a[n][i-1]);return a},backtrack:function(t,e,o,n,i){if(0===n||0===i)return{sequence:[],indices1:[],indices2:[]};if(t.options.areTheSameByIndex(n-1,i-1)){var r=this.backtrack(t,e,o,n-1,i-1);return r.sequence.push(e[n-1]),r.indices1.push(n-1),r.indices2.push(i-1),r}return t[n][i-1]>t[n-1][i]?this.backtrack(t,e,o,n,i-1):this.backtrack(t,e,o,n-1,i)}};e.sequenceDiffer=n,e.dateReviver=function(t,e){var o;return"string"==typeof e&&(o=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)(Z|([+\-])(\d{2}):(\d{2}))$/.exec(e))?new Date(Date.UTC(+o[1],+o[2]-1,+o[3],+o[4],+o[5],+o[6])):e};var i=function(){var t;if(e.config.diff_match_patch&&(t=new e.config.diff_match_patch.diff_match_patch),"undefined"!=typeof diff_match_patch&&("function"==typeof diff_match_patch?t=new diff_match_patch:"object"==typeof diff_match_patch&&"function"==typeof diff_match_patch.diff_match_patch&&(t=new diff_match_patch.diff_match_patch)),t)return e.config.textDiff=function(e,o){return t.patch_toText(t.patch_make(e,o))},e.config.textPatch=function(e,o){for(var n=t.patch_apply(t.patch_fromText(o),e),i=0;i<n[1].length;i++)if(!n[1][i])throw new Error("text patch failed");return n[0]},!0},r=e.isArray="function"==typeof Array.isArray?Array.isArray:function(t){return"object"==typeof t&&t instanceof Array},s=e.isDate=function(t){return t instanceof Date||"[object Date]"===Object.prototype.toString.call(t)},a=function(t,o){return n.diff(t,o,e.config.objectHash,e.diff)},l=function(t,e){var o,n,i,r;r=function(i){void 0!==(n=c(t[i],e[i]))&&(void 0===o&&(o={}),o[i]=n)};for(i in e)e.hasOwnProperty(i)&&r(i);for(i in t)t.hasOwnProperty(i)&&void 0===e[i]&&r(i);return o},c=e.diff=function(t,o){var n,c,u,h,g;if(t!==o&&(t===t||o===o)&&(n=typeof o,c=typeof t,u=null===o,h=null===t,"object"==c&&s(t)&&(c="date"),"object"!=n||!s(o)||(n="date","date"!=c||t.getTime()!==o.getTime()))){if(u||h||"undefined"==n||n!=c||"number"==n||"number"==c||"boolean"==n||"boolean"==c||"string"==n||"string"==c||"date"==n||"date"==c||"object"===n&&r(o)!=r(t)){if(g=[],void 0!==t)if(void 0!==o){var p="string"==n&&"string"==c&&Math.min(t.length,o.length)>e.config.textDiffMinLength;p&&!e.config.textDiff&&i(),p&&e.config.textDiff?g.push(e.config.textDiff(t,o),0,2):(g.push(t),g.push(o))}else g.push(t),g.push(0,0);else g.push(o);return g}return r(o)?a(t,o):l(t,o)}},u=function(t,e){return r(t)?t[parseInt(e,10)]:t[e]};e.getByKey=u;var h=function(t,e,o){if(r(t)&&t._key){var n=t._key;"function"!=typeof t._key&&(n=function(e){return e[t._key]});for(var i=0;i<t.length;i++)if(n(t[i])===e)return void(void 0===o?(t.splice(i,1),i--):t[i]=o);return void(void 0!==o&&t.push(o))}void 0===o?r(t)?t.splice(e,1):delete t[e]:t[e]=o},g=function(t){return e.config.textDiffReverse||(e.config.textDiffReverse=function(t){var e,o,n,i,r,s=null,a=/^@@ +\-(\d+),(\d+) +\+(\d+),(\d+) +@@$/;for(n=t.split("\n"),e=0,o=n.length;e<o;e++){i=n[e];var l=i.slice(0,1);"@"===l?(s=a.exec(i),r=e,null,null,n[r]="@@ -"+s[3]+","+s[4]+" +"+s[1]+","+s[2]+" @@"):"+"==l?(e,n[e]="-"+n[e].slice(1)):"-"==l&&(e,n[e]="+"+n[e].slice(1))}return n.join("\n")}),e.config.textDiffReverse(t)},p=e.reverse=function(t){var e,o;if(void 0!==t){if(null===t)return null;if("object"==typeof t&&!s(t)){if(r(t)){if(t.length<3)return 1===t.length?[t[0],0,0]:[t[1],t[0]];if(0===t[2])return[t[0]];if(2===t[2])return[g(t[0]),0,2];throw new Error("invalid diff type")}if(o={},"a"===t._t){for(e in t)if(t.hasOwnProperty(e)&&"_t"!==e){var i,a=e;if(i="_"===e.slice(0,1)?parseInt(e.slice(1),10):parseInt(e,10),r(t[e]))if(1===t[e].length)a="_"+i;else if(2===t[e].length)a=n.getArrayIndexBefore(t,i);else if(0===t[e][2])a=i.toString();else{if(3===t[e][2]){a="_"+t[e][1],o[a]=[t[e][0],i,3];continue}a=n.getArrayIndexBefore(t,i)}else a=n.getArrayIndexBefore(t,i);o[a]=p(t[e])}o._t="a"}else for(e in t)t.hasOwnProperty(e)&&(o[e]=p(t[e]));return o}return"string"==typeof t&&"@@"===t.slice(0,2)?g(t):t}},d=e.patch=function(t,s,a,l){var c,g,p,f="";if("string"!=typeof s?(l=a,a=s,s=null):"object"!=typeof t&&(s=null),l&&(f+=l),f+="/",null!==s&&(f+=s),"object"==typeof a)if(r(a)){if(a.length<3)return g=a[a.length-1],null!==s&&h(t,s,g),g;if(0!==a[2]){if(2===a[2]){if(e.config.textPatch||i(),!e.config.textPatch)throw new Error("textPatch function not found");try{g=e.config.textPatch(u(t,s),a[0])}catch(t){throw new Error('cannot apply patch at "'+f+'": '+t)}return null!==s&&h(t,s,g),g}throw 3===a[2]?new Error("Not implemented diff type: "+a[2]):new Error("invalid diff type: "+a[2])}if(null===s)return;h(t,s)}else if("a"==a._t){if("object"!=typeof(p=null===s?t:u(t,s))||!r(p))throw new Error('cannot apply patch at "'+f+'": array expected');n.patch(p,a,o.patch,f)}else{if("object"!=typeof(p=null===s?t:u(t,s))||r(p))throw new Error('cannot apply patch at "'+f+'": object expected');for(c in a)a.hasOwnProperty(c)&&d(p,c,a[c],f)}return t};e.unpatch=function(t,e,o,n){return"string"!=typeof e?d(t,p(e),o):d(t,e,p(o),n)};t.exports=e}()}).call(window)},function(t,e,o){(function(e){(function(){!function(e,o){t.exports=o()}(0,function(){return function(t){function e(n){if(o[n])return o[n].exports;var i=o[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var o={};return e.m=t,e.c=o,e.p="",e(0)}([function(t,e,o){var n,i;n=[o(1),o(3),o(4)],void 0!==(i=function(t){return t}.apply(e,n))&&(t.exports=i)},function(t,e,o){var n,i;n=[o(2)],void 0!==(i=function(t){function e(o){if(e.is(o,"function"))return _?o():t.on("raphael.DOMload",o);if(e.is(o,q))return e._engine.create[A](e,o.splice(0,3+e.is(o[0],W))).add(o);var n=Array.prototype.slice.call(arguments,0);if(e.is(n[n.length-1],"function")){var i=n.pop();return _?i.call(e._engine.create[A](e,n)):t.on("raphael.DOMload",function(){i.call(e._engine.create[A](e,n))})}return e._engine.create[A](e,arguments)}function o(t){if("function"==typeof t||Object(t)!==t)return t;var e=new t.constructor;for(var n in t)t[T](n)&&(e[n]=o(t[n]));return e}function n(t,e){for(var o=0,n=t.length;o<n;o++)if(t[o]===e)return t.push(t.splice(o,1)[0])}function i(t,e,o){function i(){var r=Array.prototype.slice.call(arguments,0),s=r.join(""),a=i.cache=i.cache||{},l=i.count=i.count||[];return a[T](s)?(n(l,s),o?o(a[s]):a[s]):(l.length>=1e3&&delete a[l.shift()],l.push(s),a[s]=t[A](e,r),o?o(a[s]):a[s])}return i}function r(){return this.hex}function s(t,e){for(var o=[],n=0,i=t.length;i-2*!e>n;n+=2){var r=[{x:+t[n-2],y:+t[n-1]},{x:+t[n],y:+t[n+1]},{x:+t[n+2],y:+t[n+3]},{x:+t[n+4],y:+t[n+5]}];e?n?i-4==n?r[3]={x:+t[0],y:+t[1]}:i-2==n&&(r[2]={x:+t[0],y:+t[1]},r[3]={x:+t[2],y:+t[3]}):r[0]={x:+t[i-2],y:+t[i-1]}:i-4==n?r[3]=r[2]:n||(r[0]={x:+t[n],y:+t[n+1]}),o.push(["C",(-r[0].x+6*r[1].x+r[2].x)/6,(-r[0].y+6*r[1].y+r[2].y)/6,(r[1].x+6*r[2].x-r[3].x)/6,(r[1].y+6*r[2].y-r[3].y)/6,r[2].x,r[2].y])}return o}function a(t,e,o,n,i){return t*(t*(-3*e+9*o-9*n+3*i)+6*e-12*o+6*n)-3*e+3*o}function l(t,e,o,n,i,r,s,l,c){null==c&&(c=1),c=c>1?1:c<0?0:c;for(var u=c/2,h=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],g=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],p=0,d=0;d<12;d++){var f=u*h[d]+u,m=a(f,t,o,i,s),y=a(f,e,n,r,l),v=m*m+y*y;p+=g[d]*j.sqrt(v)}return u*p}function c(t,e,o,n,i,r,s,a,c){if(!(c<0||l(t,e,o,n,i,r,s,a)<c)){var u,h=.5,g=1-h;for(u=l(t,e,o,n,i,r,s,a,g);U(u-c)>.01;)h/=2,g+=(u<c?1:-1)*h,u=l(t,e,o,n,i,r,s,a,g);return g}}function u(t,e,o,n,i,r,s,a){if(!(F(t,o)<H(i,s)||H(t,o)>F(i,s)||F(e,n)<H(r,a)||H(e,n)>F(r,a))){var l=(t*n-e*o)*(i-s)-(t-o)*(i*a-r*s),c=(t*n-e*o)*(r-a)-(e-n)*(i*a-r*s),u=(t-o)*(r-a)-(e-n)*(i-s);if(u){var h=l/u,g=c/u,p=+h.toFixed(2),d=+g.toFixed(2);if(!(p<+H(t,o).toFixed(2)||p>+F(t,o).toFixed(2)||p<+H(i,s).toFixed(2)||p>+F(i,s).toFixed(2)||d<+H(e,n).toFixed(2)||d>+F(e,n).toFixed(2)||d<+H(r,a).toFixed(2)||d>+F(r,a).toFixed(2)))return{x:h,y:g}}}}function h(t,o,n){var i=e.bezierBBox(t),r=e.bezierBBox(o);if(!e.isBBoxIntersect(i,r))return n?0:[];for(var s=l.apply(0,t),a=l.apply(0,o),c=F(~~(s/5),1),h=F(~~(a/5),1),g=[],p=[],d={},f=n?0:[],m=0;m<c+1;m++){var y=e.findDotsAtSegment.apply(e,t.concat(m/c));g.push({x:y.x,y:y.y,t:m/c})}for(m=0;m<h+1;m++)y=e.findDotsAtSegment.apply(e,o.concat(m/h)),p.push({x:y.x,y:y.y,t:m/h});for(m=0;m<c;m++)for(var v=0;v<h;v++){var _=g[m],b=g[m+1],E=p[v],x=p[v+1],S=U(b.x-_.x)<.001?"y":"x",T=U(x.x-E.x)<.001?"y":"x",w=u(_.x,_.y,b.x,b.y,E.x,E.y,x.x,x.y);if(w){if(d[w.x.toFixed(4)]==w.y.toFixed(4))continue;d[w.x.toFixed(4)]=w.y.toFixed(4);var C=_.t+U((w[S]-_[S])/(b[S]-_[S]))*(b.t-_.t),k=E.t+U((w[T]-E[T])/(x[T]-E[T]))*(x.t-E.t);C>=0&&C<=1.001&&k>=0&&k<=1.001&&(n?f++:f.push({x:w.x,y:w.y,t1:H(C,1),t2:H(k,1)}))}}return f}function g(t,o,n){t=e._path2curve(t),o=e._path2curve(o);for(var i,r,s,a,l,c,u,g,p,d,f=n?0:[],m=0,y=t.length;m<y;m++){var v=t[m];if("M"==v[0])i=l=v[1],r=c=v[2];else{"C"==v[0]?(p=[i,r].concat(v.slice(1)),i=p[6],r=p[7]):(p=[i,r,i,r,l,c,l,c],i=l,r=c);for(var _=0,b=o.length;_<b;_++){var E=o[_];if("M"==E[0])s=u=E[1],a=g=E[2];else{"C"==E[0]?(d=[s,a].concat(E.slice(1)),s=d[6],a=d[7]):(d=[s,a,s,a,u,g,u,g],s=u,a=g);var x=h(p,d,n);if(n)f+=x;else{for(var S=0,T=x.length;S<T;S++)x[S].segment1=m,x[S].segment2=_,x[S].bez1=p,x[S].bez2=d;f=f.concat(x)}}}}}return f}function p(t,e,o,n,i,r){null!=t?(this.a=+t,this.b=+e,this.c=+o,this.d=+n,this.e=+i,this.f=+r):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function d(){return this.x+L+this.y+L+this.width+"  "+this.height}function f(t,e,o,n,i,r){function s(t){return((u*t+c)*t+l)*t}function a(t,e){var o,n,i,r,a,h;for(i=t,h=0;h<8;h++){if(r=s(i)-t,U(r)<e)return i;if(a=(3*u*i+2*c)*i+l,U(a)<1e-6)break;i-=r/a}if(o=0,n=1,(i=t)<o)return o;if(i>n)return n;for(;o<n;){if(r=s(i),U(r-t)<e)return i;t>r?o=i:n=i,i=(n-o)/2+o}return i}var l=3*e,c=3*(n-e)-l,u=1-l-c,h=3*o,g=3*(i-o)-h,p=1-h-g;return function(t,e){var o=a(t,e);return((p*o+g)*o+h)*o}(t,1/(200*r))}function m(t,e){var o=[],n={};if(this.ms=e,this.times=1,t){for(var i in t)t[T](i)&&(n[J(i)]=t[i],o.push(J(i)));o.sort(ut)}this.anim=n,this.top=o[o.length-1],this.percents=o}function y(o,n,i,r,s,a){i=J(i);var l,c,u,h,g,d,m=o.ms,y={},v={},_={};if(r)for(x=0,S=re.length;x<S;x++){var b=re[x];if(b.el.id==n.id&&b.anim==o){b.percent!=i?(re.splice(x,1),u=1):c=b,n.attr(b.totalOrigin);break}}else r=+v;for(var x=0,S=o.percents.length;x<S;x++){if(o.percents[x]==i||o.percents[x]>r*o.top){i=o.percents[x],g=o.percents[x-1]||0,m=m/o.top*(i-g),h=o.percents[x+1],l=o.anim[i];break}r&&n.attr(o.anim[o.percents[x]])}if(l){if(c)c.initstatus=r,c.start=new Date-c.ms*r;else{for(var w in l)if(l[T](w)&&(ot[T](w)||n.paper.customAttributes[T](w)))switch(y[w]=n.attr(w),null==y[w]&&(y[w]=et[w]),v[w]=l[w],ot[w]){case W:_[w]=(v[w]-y[w])/m;break;case"colour":y[w]=e.getRGB(y[w]);var C=e.getRGB(v[w]);_[w]={r:(C.r-y[w].r)/m,g:(C.g-y[w].g)/m,b:(C.b-y[w].b)/m};break;case"path":var k=Rt(y[w],v[w]),A=k[1];for(y[w]=k[0],_[w]=[],x=0,S=y[w].length;x<S;x++){_[w][x]=[0];for(var B=1,M=y[w][x].length;B<M;B++)_[w][x][B]=(A[x][B]-y[w][x][B])/m}break;case"transform":var L=n._,D=Ft(L[w],v[w]);if(D)for(y[w]=D.from,v[w]=D.to,_[w]=[],_[w].real=!0,x=0,S=y[w].length;x<S;x++)for(_[w][x]=[y[w][x][0]],B=1,M=y[w][x].length;B<M;B++)_[w][x][B]=(v[w][x][B]-y[w][x][B])/m;else{var O=n.matrix||new p,P={_:{transform:L.transform},getBBox:function(){return n.getBBox(1)}};y[w]=[O.a,O.b,O.c,O.d,O.e,O.f],Pt(P,v[w]),v[w]=P._.transform,_[w]=[(P.matrix.a-O.a)/m,(P.matrix.b-O.b)/m,(P.matrix.c-O.c)/m,(P.matrix.d-O.d)/m,(P.matrix.e-O.e)/m,(P.matrix.f-O.f)/m]}break;case"csv":var j=N(l[w])[R](E),F=N(y[w])[R](E);if("clip-rect"==w)for(y[w]=F,_[w]=[],x=F.length;x--;)_[w][x]=(j[x]-y[w][x])/m;v[w]=j;break;default:for(j=[][I](l[w]),F=[][I](y[w]),_[w]=[],x=n.paper.customAttributes[w].length;x--;)_[w][x]=((j[x]||0)-(F[x]||0))/m}var H=l.easing,U=e.easing_formulas[H];if(!U)if((U=N(H).match($))&&5==U.length){var G=U;U=function(t){return f(t,+G[1],+G[2],+G[3],+G[4],m)}}else U=ht;if(d=l.start||o.start||+new Date,b={anim:o,percent:i,timestamp:d,start:d+(o.del||0),status:0,initstatus:r||0,stop:!1,ms:m,easing:U,from:y,diff:_,to:v,el:n,callback:l.callback,prev:g,next:h,repeat:a||o.times,origin:n.attr(),totalOrigin:s},re.push(b),r&&!c&&!u&&(b.stop=!0,b.start=new Date-m*r,1==re.length))return ae();u&&(b.start=new Date-b.ms*r),1==re.length&&se(ae)}t("raphael.anim.start."+n.id,n,o)}}function v(t){for(var e=0;e<re.length;e++)re[e].el.paper==t&&re.splice(e--,1)}e.version="2.2.0",e.eve=t;var _,b,E=/[, ]+/,x={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},S=/\{(\d+)\}/g,T="hasOwnProperty",w={doc:document,win:window},C={was:Object.prototype[T].call(w.win,"Raphael"),is:w.win.Raphael},k=function(){this.ca=this.customAttributes={}},A="apply",I="concat",B="ontouchstart"in w.win||w.win.DocumentTouch&&w.doc instanceof DocumentTouch,M="",L=" ",N=String,R="split",D="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[R](L),O={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},P=N.prototype.toLowerCase,j=Math,F=j.max,H=j.min,U=j.abs,G=j.pow,V=j.PI,W="number",z="string",q="array",X=Object.prototype.toString,Y=(e._ISURL=/^url\(['"]?(.+?)['"]?\)$/i,/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i),K={NaN:1,Infinity:1,"-Infinity":1},$=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,Q=j.round,J=parseFloat,Z=parseInt,tt=N.prototype.toUpperCase,et=e._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0,class:""},ot=e._availableAnimAttrs={blur:W,"clip-rect":"csv",cx:W,cy:W,fill:"colour","fill-opacity":W,"font-size":W,height:W,opacity:W,path:"path",r:W,rx:W,ry:W,stroke:"colour","stroke-opacity":W,"stroke-width":W,transform:"transform",width:W,x:W,y:W},nt=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,it={hs:1,rg:1},rt=/,?([achlmqrstvxz]),?/gi,st=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,at=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,lt=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/gi,ct=(e._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,{}),ut=function(t,e){return J(t)-J(e)},ht=function(t){return t},gt=e._rectPath=function(t,e,o,n,i){return i?[["M",t+i,e],["l",o-2*i,0],["a",i,i,0,0,1,i,i],["l",0,n-2*i],["a",i,i,0,0,1,-i,i],["l",2*i-o,0],["a",i,i,0,0,1,-i,-i],["l",0,2*i-n],["a",i,i,0,0,1,i,-i],["z"]]:[["M",t,e],["l",o,0],["l",0,n],["l",-o,0],["z"]]},pt=function(t,e,o,n){return null==n&&(n=o),[["M",t,e],["m",0,-n],["a",o,n,0,1,1,0,2*n],["a",o,n,0,1,1,0,-2*n],["z"]]},dt=e._getPath={path:function(t){return t.attr("path")},circle:function(t){var e=t.attrs;return pt(e.cx,e.cy,e.r)},ellipse:function(t){var e=t.attrs;return pt(e.cx,e.cy,e.rx,e.ry)},rect:function(t){var e=t.attrs;return gt(e.x,e.y,e.width,e.height,e.r)},image:function(t){var e=t.attrs;return gt(e.x,e.y,e.width,e.height)},text:function(t){var e=t._getBBox();return gt(e.x,e.y,e.width,e.height)},set:function(t){var e=t._getBBox();return gt(e.x,e.y,e.width,e.height)}},ft=e.mapPath=function(t,e){if(!e)return t;var o,n,i,r,s,a,l;for(t=Rt(t),i=0,s=t.length;i<s;i++)for(l=t[i],r=1,a=l.length;r<a;r+=2)o=e.x(l[r],l[r+1]),n=e.y(l[r],l[r+1]),l[r]=o,l[r+1]=n;return t};if(e._g=w,e.type=w.win.SVGAngle||w.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML","VML"==e.type){var mt,yt=w.doc.createElement("div");if(yt.innerHTML='<v:shape adj="1"/>',mt=yt.firstChild,mt.style.behavior="url(#default#VML)",!mt||"object"!=typeof mt.adj)return e.type=M;yt=null}e.svg=!(e.vml="VML"==e.type),e._Paper=k,e.fn=b=k.prototype=e.prototype,e._id=0,e.is=function(t,e){return e=P.call(e),"finite"==e?!K[T](+t):"array"==e?t instanceof Array:"null"==e&&null===t||e==typeof t&&null!==t||"object"==e&&t===Object(t)||"array"==e&&Array.isArray&&Array.isArray(t)||X.call(t).slice(8,-1).toLowerCase()==e},e.angle=function(t,o,n,i,r,s){if(null==r){var a=t-n,l=o-i;return a||l?(180+180*j.atan2(-l,-a)/V+360)%360:0}return e.angle(t,o,r,s)-e.angle(n,i,r,s)},e.rad=function(t){return t%360*V/180},e.deg=function(t){return Math.round(180*t/V%360*1e3)/1e3},e.snapTo=function(t,o,n){if(n=e.is(n,"finite")?n:10,e.is(t,q)){for(var i=t.length;i--;)if(U(t[i]-o)<=n)return t[i]}else{t=+t;var r=o%t;if(r<n)return o-r;if(r>t-n)return o-r+t}return o};e.createUUID=function(t,e){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(t,e).toUpperCase()}}(/[xy]/g,function(t){var e=16*j.random()|0;return("x"==t?e:3&e|8).toString(16)});e.setWindow=function(o){t("raphael.setWindow",e,w.win,o),w.win=o,w.doc=w.win.document,e._engine.initWin&&e._engine.initWin(w.win)};var vt=function(t){if(e.vml){var o,n=/^\s+|\s+$/g;try{var r=new ActiveXObject("htmlfile");r.write("<body>"),r.close(),o=r.body}catch(t){o=createPopup().document.body}var s=o.createTextRange();vt=i(function(t){try{o.style.color=N(t).replace(n,M);var e=s.queryCommandValue("ForeColor");return e=(255&e)<<16|65280&e|(16711680&e)>>>16,"#"+("000000"+e.toString(16)).slice(-6)}catch(t){return"none"}})}else{var a=w.doc.createElement("i");a.title="Raphal Colour Picker",a.style.display="none",w.doc.body.appendChild(a),vt=i(function(t){return a.style.color=t,w.doc.defaultView.getComputedStyle(a,M).getPropertyValue("color")})}return vt(t)},_t=function(){return"hsb("+[this.h,this.s,this.b]+")"},bt=function(){return"hsl("+[this.h,this.s,this.l]+")"},Et=function(){return this.hex},xt=function(t,o,n){if(null==o&&e.is(t,"object")&&"r"in t&&"g"in t&&"b"in t&&(n=t.b,o=t.g,t=t.r),null==o&&e.is(t,z)){var i=e.getRGB(t);t=i.r,o=i.g,n=i.b}return(t>1||o>1||n>1)&&(t/=255,o/=255,n/=255),[t,o,n]},St=function(t,o,n,i){t*=255,o*=255,n*=255;var r={r:t,g:o,b:n,hex:e.rgb(t,o,n),toString:Et};return e.is(i,"finite")&&(r.opacity=i),r};e.color=function(t){var o;return e.is(t,"object")&&"h"in t&&"s"in t&&"b"in t?(o=e.hsb2rgb(t),t.r=o.r,t.g=o.g,t.b=o.b,t.hex=o.hex):e.is(t,"object")&&"h"in t&&"s"in t&&"l"in t?(o=e.hsl2rgb(t),t.r=o.r,t.g=o.g,t.b=o.b,t.hex=o.hex):(e.is(t,"string")&&(t=e.getRGB(t)),e.is(t,"object")&&"r"in t&&"g"in t&&"b"in t?(o=e.rgb2hsl(t),t.h=o.h,t.s=o.s,t.l=o.l,o=e.rgb2hsb(t),t.v=o.b):(t={hex:"none"},t.r=t.g=t.b=t.h=t.s=t.v=t.l=-1)),t.toString=Et,t},e.hsb2rgb=function(t,e,o,n){this.is(t,"object")&&"h"in t&&"s"in t&&"b"in t&&(o=t.b,e=t.s,n=t.o,t=t.h),t*=360;var i,r,s,a,l;return t=t%360/60,l=o*e,a=l*(1-U(t%2-1)),i=r=s=o-l,t=~~t,i+=[l,a,0,0,a,l][t],r+=[a,l,l,a,0,0][t],s+=[0,0,a,l,l,a][t],St(i,r,s,n)},e.hsl2rgb=function(t,e,o,n){this.is(t,"object")&&"h"in t&&"s"in t&&"l"in t&&(o=t.l,e=t.s,t=t.h),(t>1||e>1||o>1)&&(t/=360,e/=100,o/=100),t*=360;var i,r,s,a,l;return t=t%360/60,l=2*e*(o<.5?o:1-o),a=l*(1-U(t%2-1)),i=r=s=o-l/2,t=~~t,i+=[l,a,0,0,a,l][t],r+=[a,l,l,a,0,0][t],s+=[0,0,a,l,l,a][t],St(i,r,s,n)},e.rgb2hsb=function(t,e,o){o=xt(t,e,o),t=o[0],e=o[1],o=o[2];var n,i,r,s;return r=F(t,e,o),s=r-H(t,e,o),n=0==s?null:r==t?(e-o)/s:r==e?(o-t)/s+2:(t-e)/s+4,n=(n+360)%6*60/360,i=0==s?0:s/r,{h:n,s:i,b:r,toString:_t}},e.rgb2hsl=function(t,e,o){o=xt(t,e,o),t=o[0],e=o[1],o=o[2];var n,i,r,s,a,l;return s=F(t,e,o),a=H(t,e,o),l=s-a,n=0==l?null:s==t?(e-o)/l:s==e?(o-t)/l+2:(t-e)/l+4,n=(n+360)%6*60/360,r=(s+a)/2,i=0==l?0:r<.5?l/(2*r):l/(2-2*r),{h:n,s:i,l:r,toString:bt}},e._path2string=function(){return this.join(",").replace(rt,"$1")};e._preload=function(t,e){var o=w.doc.createElement("img");o.style.cssText="position:absolute;left:-9999em;top:-9999em",o.onload=function(){e.call(this),this.onload=null,w.doc.body.removeChild(this)},o.onerror=function(){w.doc.body.removeChild(this)},w.doc.body.appendChild(o),o.src=t};e.getRGB=i(function(t){if(!t||(t=N(t)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:r};if("none"==t)return{r:-1,g:-1,b:-1,hex:"none",toString:r};!(it[T](t.toLowerCase().substring(0,2))||"#"==t.charAt())&&(t=vt(t));var o,n,i,s,a,l,c=t.match(Y);return c?(c[2]&&(i=Z(c[2].substring(5),16),n=Z(c[2].substring(3,5),16),o=Z(c[2].substring(1,3),16)),c[3]&&(i=Z((a=c[3].charAt(3))+a,16),n=Z((a=c[3].charAt(2))+a,16),o=Z((a=c[3].charAt(1))+a,16)),c[4]&&(l=c[4][R](nt),o=J(l[0]),"%"==l[0].slice(-1)&&(o*=2.55),n=J(l[1]),"%"==l[1].slice(-1)&&(n*=2.55),i=J(l[2]),"%"==l[2].slice(-1)&&(i*=2.55),"rgba"==c[1].toLowerCase().slice(0,4)&&(s=J(l[3])),l[3]&&"%"==l[3].slice(-1)&&(s/=100)),c[5]?(l=c[5][R](nt),o=J(l[0]),"%"==l[0].slice(-1)&&(o*=2.55),n=J(l[1]),"%"==l[1].slice(-1)&&(n*=2.55),i=J(l[2]),"%"==l[2].slice(-1)&&(i*=2.55),("deg"==l[0].slice(-3)||""==l[0].slice(-1))&&(o/=360),"hsba"==c[1].toLowerCase().slice(0,4)&&(s=J(l[3])),l[3]&&"%"==l[3].slice(-1)&&(s/=100),e.hsb2rgb(o,n,i,s)):c[6]?(l=c[6][R](nt),o=J(l[0]),"%"==l[0].slice(-1)&&(o*=2.55),n=J(l[1]),"%"==l[1].slice(-1)&&(n*=2.55),i=J(l[2]),"%"==l[2].slice(-1)&&(i*=2.55),("deg"==l[0].slice(-3)||""==l[0].slice(-1))&&(o/=360),"hsla"==c[1].toLowerCase().slice(0,4)&&(s=J(l[3])),l[3]&&"%"==l[3].slice(-1)&&(s/=100),e.hsl2rgb(o,n,i,s)):(c={r:o,g:n,b:i,toString:r},c.hex="#"+(16777216|i|n<<8|o<<16).toString(16).slice(1),e.is(s,"finite")&&(c.opacity=s),c)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:r}},e),e.hsb=i(function(t,o,n){return e.hsb2rgb(t,o,n).hex}),e.hsl=i(function(t,o,n){return e.hsl2rgb(t,o,n).hex}),e.rgb=i(function(t,e,o){function n(t){return t+.5|0}return"#"+(16777216|n(o)|n(e)<<8|n(t)<<16).toString(16).slice(1)}),e.getColor=function(t){var e=this.getColor.start=this.getColor.start||{h:0,s:1,b:t||.75},o=this.hsb2rgb(e.h,e.s,e.b);return e.h+=.075,e.h>1&&(e.h=0,e.s-=.2,e.s<=0&&(this.getColor.start={h:0,s:1,b:e.b})),o.hex},e.getColor.reset=function(){delete this.start},e.parsePathString=function(t){if(!t)return null;var o=Tt(t);if(o.arr)return Ct(o.arr);var n={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},i=[];return e.is(t,q)&&e.is(t[0],q)&&(i=Ct(t)),i.length||N(t).replace(st,function(t,e,o){var r=[],s=e.toLowerCase();if(o.replace(lt,function(t,e){e&&r.push(+e)}),"m"==s&&r.length>2&&(i.push([e][I](r.splice(0,2))),s="l",e="m"==e?"l":"L"),"r"==s)i.push([e][I](r));else for(;r.length>=n[s]&&(i.push([e][I](r.splice(0,n[s]))),n[s]););}),i.toString=e._path2string,o.arr=Ct(i),i},e.parseTransformString=i(function(t){if(!t)return null;var o=[];return e.is(t,q)&&e.is(t[0],q)&&(o=Ct(t)),o.length||N(t).replace(at,function(t,e,n){var i=[];P.call(e);n.replace(lt,function(t,e){e&&i.push(+e)}),o.push([e][I](i))}),o.toString=e._path2string,o});var Tt=function(t){var e=Tt.ps=Tt.ps||{};return e[t]?e[t].sleep=100:e[t]={sleep:100},setTimeout(function(){for(var o in e)e[T](o)&&o!=t&&!--e[o].sleep&&delete e[o]}),e[t]};e.findDotsAtSegment=function(t,e,o,n,i,r,s,a,l){var c=1-l,u=G(c,3),h=G(c,2),g=l*l,p=g*l,d=u*t+3*h*l*o+3*c*l*l*i+p*s,f=u*e+3*h*l*n+3*c*l*l*r+p*a,m=t+2*l*(o-t)+g*(i-2*o+t),y=e+2*l*(n-e)+g*(r-2*n+e),v=o+2*l*(i-o)+g*(s-2*i+o),_=n+2*l*(r-n)+g*(a-2*r+n),b=c*t+l*o,E=c*e+l*n,x=c*i+l*s,S=c*r+l*a,T=90-180*j.atan2(m-v,y-_)/V;return(m>v||y<_)&&(T+=180),{x:d,y:f,m:{x:m,y:y},n:{x:v,y:_},start:{x:b,y:E},end:{x:x,y:S},alpha:T}},e.bezierBBox=function(t,o,n,i,r,s,a,l){e.is(t,"array")||(t=[t,o,n,i,r,s,a,l]);var c=Nt.apply(null,t);return{x:c.min.x,y:c.min.y,x2:c.max.x,y2:c.max.y,width:c.max.x-c.min.x,height:c.max.y-c.min.y}},e.isPointInsideBBox=function(t,e,o){return e>=t.x&&e<=t.x2&&o>=t.y&&o<=t.y2},e.isBBoxIntersect=function(t,o){var n=e.isPointInsideBBox;return n(o,t.x,t.y)||n(o,t.x2,t.y)||n(o,t.x,t.y2)||n(o,t.x2,t.y2)||n(t,o.x,o.y)||n(t,o.x2,o.y)||n(t,o.x,o.y2)||n(t,o.x2,o.y2)||(t.x<o.x2&&t.x>o.x||o.x<t.x2&&o.x>t.x)&&(t.y<o.y2&&t.y>o.y||o.y<t.y2&&o.y>t.y)},e.pathIntersection=function(t,e){return g(t,e)},e.pathIntersectionNumber=function(t,e){return g(t,e,1)},e.isPointInsidePath=function(t,o,n){var i=e.pathBBox(t);return e.isPointInsideBBox(i,o,n)&&g(t,[["M",o,n],["H",i.x2+10]],1)%2==1},e._removedFactory=function(e){return function(){t("raphael.log",null,"Raphal: you are calling to method "+e+" of removed object",e)}};var wt=e.pathBBox=function(t){var e=Tt(t);if(e.bbox)return o(e.bbox);if(!t)return{x:0,y:0,width:0,height:0,x2:0,y2:0};t=Rt(t);for(var n,i=0,r=0,s=[],a=[],l=0,c=t.length;l<c;l++)if(n=t[l],"M"==n[0])i=n[1],r=n[2],s.push(i),a.push(r);else{var u=Nt(i,r,n[1],n[2],n[3],n[4],n[5],n[6]);s=s[I](u.min.x,u.max.x),a=a[I](u.min.y,u.max.y),i=n[5],r=n[6]}var h=H[A](0,s),g=H[A](0,a),p=F[A](0,s),d=F[A](0,a),f=p-h,m=d-g,y={x:h,y:g,x2:p,y2:d,width:f,height:m,cx:h+f/2,cy:g+m/2};return e.bbox=o(y),y},Ct=function(t){var n=o(t);return n.toString=e._path2string,n},kt=e._pathToRelative=function(t){var o=Tt(t);if(o.rel)return Ct(o.rel);e.is(t,q)&&e.is(t&&t[0],q)||(t=e.parsePathString(t));var n=[],i=0,r=0,s=0,a=0,l=0;"M"==t[0][0]&&(i=t[0][1],r=t[0][2],s=i,a=r,l++,n.push(["M",i,r]));for(var c=l,u=t.length;c<u;c++){var h=n[c]=[],g=t[c];if(g[0]!=P.call(g[0]))switch(h[0]=P.call(g[0]),h[0]){case"a":h[1]=g[1],h[2]=g[2],h[3]=g[3],h[4]=g[4],h[5]=g[5],h[6]=+(g[6]-i).toFixed(3),h[7]=+(g[7]-r).toFixed(3);break;case"v":h[1]=+(g[1]-r).toFixed(3);break;case"m":s=g[1],a=g[2];default:for(var p=1,d=g.length;p<d;p++)h[p]=+(g[p]-(p%2?i:r)).toFixed(3)}else{h=n[c]=[],"m"==g[0]&&(s=g[1]+i,a=g[2]+r);for(var f=0,m=g.length;f<m;f++)n[c][f]=g[f]}var y=n[c].length;switch(n[c][0]){case"z":i=s,r=a;break;case"h":i+=+n[c][y-1];break;case"v":r+=+n[c][y-1];break;default:i+=+n[c][y-2],r+=+n[c][y-1]}}return n.toString=e._path2string,o.rel=Ct(n),n},At=e._pathToAbsolute=function(t){var o=Tt(t);if(o.abs)return Ct(o.abs);if(e.is(t,q)&&e.is(t&&t[0],q)||(t=e.parsePathString(t)),!t||!t.length)return[["M",0,0]];var n=[],i=0,r=0,a=0,l=0,c=0;"M"==t[0][0]&&(i=+t[0][1],r=+t[0][2],a=i,l=r,c++,n[0]=["M",i,r]);for(var u,h,g=3==t.length&&"M"==t[0][0]&&"R"==t[1][0].toUpperCase()&&"Z"==t[2][0].toUpperCase(),p=c,d=t.length;p<d;p++){if(n.push(u=[]),h=t[p],h[0]!=tt.call(h[0]))switch(u[0]=tt.call(h[0]),u[0]){case"A":u[1]=h[1],u[2]=h[2],u[3]=h[3],u[4]=h[4],u[5]=h[5],u[6]=+(h[6]+i),u[7]=+(h[7]+r);break;case"V":u[1]=+h[1]+r;break;case"H":u[1]=+h[1]+i;break;case"R":for(var f=[i,r][I](h.slice(1)),m=2,y=f.length;m<y;m++)f[m]=+f[m]+i,f[++m]=+f[m]+r;n.pop(),n=n[I](s(f,g));break;case"M":a=+h[1]+i,l=+h[2]+r;default:for(m=1,y=h.length;m<y;m++)u[m]=+h[m]+(m%2?i:r)}else if("R"==h[0])f=[i,r][I](h.slice(1)),n.pop(),n=n[I](s(f,g)),u=["R"][I](h.slice(-2));else for(var v=0,_=h.length;v<_;v++)u[v]=h[v];switch(u[0]){case"Z":i=a,r=l;break;case"H":i=u[1];break;case"V":r=u[1];break;case"M":a=u[u.length-2],l=u[u.length-1];default:i=u[u.length-2],r=u[u.length-1]}}return n.toString=e._path2string,o.abs=Ct(n),n},It=function(t,e,o,n){return[t,e,o,n,o,n]},Bt=function(t,e,o,n,i,r){var s=1/3,a=2/3;return[s*t+a*o,s*e+a*n,s*i+a*o,s*r+a*n,i,r]},Mt=function(t,e,o,n,r,s,a,l,c,u){var h,g=120*V/180,p=V/180*(+r||0),d=[],f=i(function(t,e,o){return{x:t*j.cos(o)-e*j.sin(o),y:t*j.sin(o)+e*j.cos(o)}});if(u)T=u[0],w=u[1],x=u[2],S=u[3];else{h=f(t,e,-p),t=h.x,e=h.y,h=f(l,c,-p),l=h.x,c=h.y;var m=(j.cos(V/180*r),j.sin(V/180*r),(t-l)/2),y=(e-c)/2,v=m*m/(o*o)+y*y/(n*n);v>1&&(v=j.sqrt(v),o*=v,n*=v);var _=o*o,b=n*n,E=(s==a?-1:1)*j.sqrt(U((_*b-_*y*y-b*m*m)/(_*y*y+b*m*m))),x=E*o*y/n+(t+l)/2,S=E*-n*m/o+(e+c)/2,T=j.asin(((e-S)/n).toFixed(9)),w=j.asin(((c-S)/n).toFixed(9));T=t<x?V-T:T,w=l<x?V-w:w,T<0&&(T=2*V+T),w<0&&(w=2*V+w),a&&T>w&&(T-=2*V),!a&&w>T&&(w-=2*V)}var C=w-T;if(U(C)>g){var k=w,A=l,B=c;w=T+g*(a&&w>T?1:-1),l=x+o*j.cos(w),c=S+n*j.sin(w),d=Mt(l,c,o,n,r,0,a,A,B,[w,k,x,S])}C=w-T;var M=j.cos(T),L=j.sin(T),N=j.cos(w),D=j.sin(w),O=j.tan(C/4),P=4/3*o*O,F=4/3*n*O,H=[t,e],G=[t+P*L,e-F*M],W=[l+P*D,c-F*N],z=[l,c];if(G[0]=2*H[0]-G[0],G[1]=2*H[1]-G[1],u)return[G,W,z][I](d);d=[G,W,z][I](d).join()[R](",");for(var q=[],X=0,Y=d.length;X<Y;X++)q[X]=X%2?f(d[X-1],d[X],p).y:f(d[X],d[X+1],p).x;return q},Lt=function(t,e,o,n,i,r,s,a,l){var c=1-l;return{x:G(c,3)*t+3*G(c,2)*l*o+3*c*l*l*i+G(l,3)*s,y:G(c,3)*e+3*G(c,2)*l*n+3*c*l*l*r+G(l,3)*a}},Nt=i(function(t,e,o,n,i,r,s,a){var l,c=i-2*o+t-(s-2*i+o),u=2*(o-t)-2*(i-o),h=t-o,g=(-u+j.sqrt(u*u-4*c*h))/2/c,p=(-u-j.sqrt(u*u-4*c*h))/2/c,d=[e,a],f=[t,s];return U(g)>"1e12"&&(g=.5),U(p)>"1e12"&&(p=.5),g>0&&g<1&&(l=Lt(t,e,o,n,i,r,s,a,g),f.push(l.x),d.push(l.y)),p>0&&p<1&&(l=Lt(t,e,o,n,i,r,s,a,p),f.push(l.x),d.push(l.y)),c=r-2*n+e-(a-2*r+n),u=2*(n-e)-2*(r-n),h=e-n,g=(-u+j.sqrt(u*u-4*c*h))/2/c,p=(-u-j.sqrt(u*u-4*c*h))/2/c,U(g)>"1e12"&&(g=.5),U(p)>"1e12"&&(p=.5),g>0&&g<1&&(l=Lt(t,e,o,n,i,r,s,a,g),f.push(l.x),d.push(l.y)),p>0&&p<1&&(l=Lt(t,e,o,n,i,r,s,a,p),f.push(l.x),d.push(l.y)),{min:{x:H[A](0,f),y:H[A](0,d)},max:{x:F[A](0,f),y:F[A](0,d)}}}),Rt=e._path2curve=i(function(t,e){var o=!e&&Tt(t);if(!e&&o.curve)return Ct(o.curve);for(var n=At(t),i=e&&At(e),r={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a=(function(t,e,o){var n,i,r={T:1,Q:1};if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in r)&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"][I](Mt[A](0,[e.x,e.y][I](t.slice(1))));break;case"S":"C"==o||"S"==o?(n=2*e.x-e.bx,i=2*e.y-e.by):(n=e.x,i=e.y),t=["C",n,i][I](t.slice(1));break;case"T":"Q"==o||"T"==o?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),t=["C"][I](Bt(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"][I](Bt(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"][I](It(e.x,e.y,t[1],t[2]));break;case"H":t=["C"][I](It(e.x,e.y,t[1],e.y));break;case"V":t=["C"][I](It(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"][I](It(e.x,e.y,e.X,e.Y))}return t}),l=function(t,e){if(t[e].length>7){t[e].shift();for(var o=t[e];o.length;)u[e]="A",i&&(h[e]="A"),t.splice(e++,0,["C"][I](o.splice(0,6)));t.splice(e,1),f=F(n.length,i&&i.length||0)}},c=function(t,e,o,r,s){t&&e&&"M"==t[s][0]&&"M"!=e[s][0]&&(e.splice(s,0,["M",r.x,r.y]),o.bx=0,o.by=0,o.x=t[s][1],o.y=t[s][2],f=F(n.length,i&&i.length||0))},u=[],h=[],g="",p="",d=0,f=F(n.length,i&&i.length||0);d<f;d++){n[d]&&(g=n[d][0]),"C"!=g&&(u[d]=g,d&&(p=u[d-1])),n[d]=a(n[d],r,p),"A"!=u[d]&&"C"==g&&(u[d]="C"),l(n,d),i&&(i[d]&&(g=i[d][0]),"C"!=g&&(h[d]=g,d&&(p=h[d-1])),i[d]=a(i[d],s,p),"A"!=h[d]&&"C"==g&&(h[d]="C"),l(i,d)),c(n,i,r,s,d),c(i,n,s,r,d);var m=n[d],y=i&&i[d],v=m.length,_=i&&y.length;r.x=m[v-2],r.y=m[v-1],r.bx=J(m[v-4])||r.x,r.by=J(m[v-3])||r.y,s.bx=i&&(J(y[_-4])||s.x),s.by=i&&(J(y[_-3])||s.y),s.x=i&&y[_-2],s.y=i&&y[_-1]}return i||(o.curve=Ct(n)),i?[n,i]:n},null,Ct),Dt=(e._parseDots=i(function(t){for(var o=[],n=0,i=t.length;n<i;n++){var r={},s=t[n].match(/^([^:]*):?([\d\.]*)/);if(r.color=e.getRGB(s[1]),r.color.error)return null;r.opacity=r.color.opacity,r.color=r.color.hex,s[2]&&(r.offset=s[2]+"%"),o.push(r)}for(n=1,i=o.length-1;n<i;n++)if(!o[n].offset){for(var a=J(o[n-1].offset||0),l=0,c=n+1;c<i;c++)if(o[c].offset){l=o[c].offset;break}l||(l=100,c=i),l=J(l);for(var u=(l-a)/(c-n+1);n<c;n++)a+=u,o[n].offset=a+"%"}return o}),e._tear=function(t,e){t==e.top&&(e.top=t.prev),t==e.bottom&&(e.bottom=t.next),t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next)}),Ot=(e._tofront=function(t,e){e.top!==t&&(Dt(t,e),t.next=null,t.prev=e.top,e.top.next=t,e.top=t)},e._toback=function(t,e){e.bottom!==t&&(Dt(t,e),t.next=e.bottom,t.prev=null,e.bottom.prev=t,e.bottom=t)},e._insertafter=function(t,e,o){Dt(t,o),e==o.top&&(o.top=t),e.next&&(e.next.prev=t),t.next=e.next,t.prev=e,e.next=t},e._insertbefore=function(t,e,o){Dt(t,o),e==o.bottom&&(o.bottom=t),e.prev&&(e.prev.next=t),t.prev=e.prev,e.prev=t,t.next=e},e.toMatrix=function(t,e){var o=wt(t),n={_:{transform:M},getBBox:function(){return o}};return Pt(n,e),n.matrix}),Pt=(e.transformPath=function(t,e){return ft(t,Ot(t,e))},e._extractTransform=function(t,o){if(null==o)return t._.transform;o=N(o).replace(/\.{3}|\u2026/g,t._.transform||M);var n=e.parseTransformString(o),i=0,r=0,s=0,a=1,l=1,c=t._,u=new p;if(c.transform=n||[],n)for(var h=0,g=n.length;h<g;h++){var d,f,m,y,v,_=n[h],b=_.length,E=N(_[0]).toLowerCase(),x=_[0]!=E,S=x?u.invert():0;"t"==E&&3==b?x?(d=S.x(0,0),f=S.y(0,0),m=S.x(_[1],_[2]),y=S.y(_[1],_[2]),u.translate(m-d,y-f)):u.translate(_[1],_[2]):"r"==E?2==b?(v=v||t.getBBox(1),u.rotate(_[1],v.x+v.width/2,v.y+v.height/2),i+=_[1]):4==b&&(x?(m=S.x(_[2],_[3]),y=S.y(_[2],_[3]),u.rotate(_[1],m,y)):u.rotate(_[1],_[2],_[3]),i+=_[1]):"s"==E?2==b||3==b?(v=v||t.getBBox(1),u.scale(_[1],_[b-1],v.x+v.width/2,v.y+v.height/2),a*=_[1],l*=_[b-1]):5==b&&(x?(m=S.x(_[3],_[4]),y=S.y(_[3],_[4]),u.scale(_[1],_[2],m,y)):u.scale(_[1],_[2],_[3],_[4]),a*=_[1],l*=_[2]):"m"==E&&7==b&&u.add(_[1],_[2],_[3],_[4],_[5],_[6]),c.dirtyT=1,t.matrix=u}t.matrix=u,c.sx=a,c.sy=l,c.deg=i,c.dx=r=u.e,c.dy=s=u.f,1==a&&1==l&&!i&&c.bbox?(c.bbox.x+=+r,c.bbox.y+=+s):c.dirtyT=1}),jt=function(t){var e=t[0];switch(e.toLowerCase()){case"t":return[e,0,0];case"m":return[e,1,0,0,1,0,0];case"r":return 4==t.length?[e,0,t[2],t[3]]:[e,0];case"s":return 5==t.length?[e,1,1,t[3],t[4]]:3==t.length?[e,1,1]:[e,1]}},Ft=e._equaliseTransform=function(t,o){o=N(o).replace(/\.{3}|\u2026/g,t),t=e.parseTransformString(t)||[],o=e.parseTransformString(o)||[];for(var n,i,r,s,a=F(t.length,o.length),l=[],c=[],u=0;u<a;u++){if(r=t[u]||jt(o[u]),s=o[u]||jt(r),r[0]!=s[0]||"r"==r[0].toLowerCase()&&(r[2]!=s[2]||r[3]!=s[3])||"s"==r[0].toLowerCase()&&(r[3]!=s[3]||r[4]!=s[4]))return;for(l[u]=[],c[u]=[],n=0,i=F(r.length,s.length);n<i;n++)n in r&&(l[u][n]=r[n]),n in s&&(c[u][n]=s[n])}return{from:l,to:c}};e._getContainer=function(t,o,n,i){var r;if(null!=(r=null!=i||e.is(t,"object")?t:w.doc.getElementById(t)))return r.tagName?null==o?{container:r,width:r.style.pixelWidth||r.offsetWidth,height:r.style.pixelHeight||r.offsetHeight}:{container:r,width:o,height:n}:{container:1,x:t,y:o,width:n,height:i}},e.pathToRelative=kt,e._engine={},e.path2curve=Rt,e.matrix=function(t,e,o,n,i,r){return new p(t,e,o,n,i,r)},function(t){function o(t){return t[0]*t[0]+t[1]*t[1]}function n(t){var e=j.sqrt(o(t));t[0]&&(t[0]/=e),t[1]&&(t[1]/=e)}t.add=function(t,e,o,n,i,r){var s,a,l,c,u=[[],[],[]],h=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],g=[[t,o,i],[e,n,r],[0,0,1]];for(t&&t instanceof p&&(g=[[t.a,t.c,t.e],[t.b,t.d,t.f],[0,0,1]]),s=0;s<3;s++)for(a=0;a<3;a++){for(c=0,l=0;l<3;l++)c+=h[s][l]*g[l][a];u[s][a]=c}this.a=u[0][0],this.b=u[1][0],this.c=u[0][1],this.d=u[1][1],this.e=u[0][2],this.f=u[1][2]},t.invert=function(){var t=this,e=t.a*t.d-t.b*t.c;return new p(t.d/e,-t.b/e,-t.c/e,t.a/e,(t.c*t.f-t.d*t.e)/e,(t.b*t.e-t.a*t.f)/e)},t.clone=function(){return new p(this.a,this.b,this.c,this.d,this.e,this.f)},t.translate=function(t,e){this.add(1,0,0,1,t,e)},t.scale=function(t,e,o,n){null==e&&(e=t),(o||n)&&this.add(1,0,0,1,o,n),this.add(t,0,0,e,0,0),(o||n)&&this.add(1,0,0,1,-o,-n)},t.rotate=function(t,o,n){t=e.rad(t),o=o||0,n=n||0;var i=+j.cos(t).toFixed(9),r=+j.sin(t).toFixed(9);this.add(i,r,-r,i,o,n),this.add(1,0,0,1,-o,-n)},t.x=function(t,e){return t*this.a+e*this.c+this.e},t.y=function(t,e){return t*this.b+e*this.d+this.f},t.get=function(t){return+this[N.fromCharCode(97+t)].toFixed(4)},t.toString=function(){return e.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},t.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},t.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},t.split=function(){var t={};t.dx=this.e,t.dy=this.f;var i=[[this.a,this.c],[this.b,this.d]];t.scalex=j.sqrt(o(i[0])),n(i[0]),t.shear=i[0][0]*i[1][0]+i[0][1]*i[1][1],i[1]=[i[1][0]-i[0][0]*t.shear,i[1][1]-i[0][1]*t.shear],t.scaley=j.sqrt(o(i[1])),n(i[1]),t.shear/=t.scaley;var r=-i[0][1],s=i[1][1];return s<0?(t.rotate=e.deg(j.acos(s)),r<0&&(t.rotate=360-t.rotate)):t.rotate=e.deg(j.asin(r)),t.isSimple=!(+t.shear.toFixed(9)||t.scalex.toFixed(9)!=t.scaley.toFixed(9)&&t.rotate),t.isSuperSimple=!+t.shear.toFixed(9)&&t.scalex.toFixed(9)==t.scaley.toFixed(9)&&!t.rotate,t.noRotation=!+t.shear.toFixed(9)&&!t.rotate,t},t.toTransformString=function(t){var e=t||this[R]();return e.isSimple?(e.scalex=+e.scalex.toFixed(4),e.scaley=+e.scaley.toFixed(4),e.rotate=+e.rotate.toFixed(4),(e.dx||e.dy?"t"+[e.dx,e.dy]:M)+(1!=e.scalex||1!=e.scaley?"s"+[e.scalex,e.scaley,0,0]:M)+(e.rotate?"r"+[e.rotate,0,0]:M)):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(p.prototype);for(var Ht=function(){this.returnValue=!1},Ut=function(){return this.originalEvent.preventDefault()},Gt=function(){this.cancelBubble=!0},Vt=function(){return this.originalEvent.stopPropagation()},Wt=function(t){var e=w.doc.documentElement.scrollTop||w.doc.body.scrollTop,o=w.doc.documentElement.scrollLeft||w.doc.body.scrollLeft;return{x:t.clientX+o,y:t.clientY+e}},zt=function(){return w.doc.addEventListener?function(t,e,o,n){var i=function(t){var e=Wt(t);return o.call(n,t,e.x,e.y)};if(t.addEventListener(e,i,!1),B&&O[e]){var r=function(e){for(var i=Wt(e),r=e,s=0,a=e.targetTouches&&e.targetTouches.length;s<a;s++)if(e.targetTouches[s].target==t){e=e.targetTouches[s],e.originalEvent=r,e.preventDefault=Ut,e.stopPropagation=Vt;break}return o.call(n,e,i.x,i.y)};t.addEventListener(O[e],r,!1)}return function(){return t.removeEventListener(e,i,!1),B&&O[e]&&t.removeEventListener(O[e],r,!1),!0}}:w.doc.attachEvent?function(t,e,o,n){var i=function(t){t=t||w.win.event;var e=w.doc.documentElement.scrollTop||w.doc.body.scrollTop,i=w.doc.documentElement.scrollLeft||w.doc.body.scrollLeft,r=t.clientX+i,s=t.clientY+e;return t.preventDefault=t.preventDefault||Ht,t.stopPropagation=t.stopPropagation||Gt,o.call(n,t,r,s)};return t.attachEvent("on"+e,i),function(){return t.detachEvent("on"+e,i),!0}}:void 0}(),qt=[],Xt=function(e){for(var o,n=e.clientX,i=e.clientY,r=w.doc.documentElement.scrollTop||w.doc.body.scrollTop,s=w.doc.documentElement.scrollLeft||w.doc.body.scrollLeft,a=qt.length;a--;){if(o=qt[a],B&&e.touches){for(var l,c=e.touches.length;c--;)if(l=e.touches[c],l.identifier==o.el._drag.id){n=l.clientX,i=l.clientY,(e.originalEvent?e.originalEvent:e).preventDefault();break}}else e.preventDefault();var u,h=o.el.node,g=h.nextSibling,p=h.parentNode,d=h.style.display;w.win.opera&&p.removeChild(h),h.style.display="none",u=o.el.paper.getElementByPoint(n,i),h.style.display=d,w.win.opera&&(g?p.insertBefore(h,g):p.appendChild(h)),u&&t("raphael.drag.over."+o.el.id,o.el,u),n+=s,i+=r,t("raphael.drag.move."+o.el.id,o.move_scope||o.el,n-o.el._drag.x,i-o.el._drag.y,n,i,e)}},Yt=function(o){e.unmousemove(Xt).unmouseup(Yt);for(var n,i=qt.length;i--;)n=qt[i],n.el._drag={},t("raphael.drag.end."+n.el.id,n.end_scope||n.start_scope||n.move_scope||n.el,o);qt=[]},Kt=e.el={},$t=D.length;$t--;)!function(t){e[t]=Kt[t]=function(o,n){return e.is(o,"function")&&(this.events=this.events||[],this.events.push({name:t,f:o,unbind:zt(this.shape||this.node||w.doc,t,o,n||this)})),this},e["un"+t]=Kt["un"+t]=function(o){for(var n=this.events||[],i=n.length;i--;)n[i].name!=t||!e.is(o,"undefined")&&n[i].f!=o||(n[i].unbind(),n.splice(i,1),!n.length&&delete this.events);return this}}(D[$t]);Kt.data=function(o,n){var i=ct[this.id]=ct[this.id]||{};if(0==arguments.length)return i;if(1==arguments.length){if(e.is(o,"object")){for(var r in o)o[T](r)&&this.data(r,o[r]);return this}return t("raphael.data.get."+this.id,this,i[o],o),i[o]}return i[o]=n,t("raphael.data.set."+this.id,this,n,o),this},Kt.removeData=function(t){return null==t?ct[this.id]={}:ct[this.id]&&delete ct[this.id][t],this},Kt.getData=function(){return o(ct[this.id]||{})},Kt.hover=function(t,e,o,n){return this.mouseover(t,o).mouseout(e,n||o)},Kt.unhover=function(t,e){return this.unmouseover(t).unmouseout(e)};var Qt=[];Kt.drag=function(o,n,i,r,s,a){function l(l){(l.originalEvent||l).preventDefault();var c=l.clientX,u=l.clientY,h=w.doc.documentElement.scrollTop||w.doc.body.scrollTop,g=w.doc.documentElement.scrollLeft||w.doc.body.scrollLeft;if(this._drag.id=l.identifier,B&&l.touches)for(var p,d=l.touches.length;d--;)if(p=l.touches[d],this._drag.id=p.identifier,p.identifier==this._drag.id){c=p.clientX,u=p.clientY;break}this._drag.x=c+g,this._drag.y=u+h,!qt.length&&e.mousemove(Xt).mouseup(Yt),qt.push({el:this,move_scope:r,start_scope:s,end_scope:a}),n&&t.on("raphael.drag.start."+this.id,n),o&&t.on("raphael.drag.move."+this.id,o),i&&t.on("raphael.drag.end."+this.id,i),t("raphael.drag.start."+this.id,s||r||this,l.clientX+g,l.clientY+h,l)}return this._drag={},Qt.push({el:this,start:l}),this.mousedown(l),this},Kt.onDragOver=function(e){e?t.on("raphael.drag.over."+this.id,e):t.unbind("raphael.drag.over."+this.id)},Kt.undrag=function(){for(var o=Qt.length;o--;)Qt[o].el==this&&(this.unmousedown(Qt[o].start),Qt.splice(o,1),t.unbind("raphael.drag.*."+this.id));!Qt.length&&e.unmousemove(Xt).unmouseup(Yt),qt=[]},b.circle=function(t,o,n){var i=e._engine.circle(this,t||0,o||0,n||0);return this.__set__&&this.__set__.push(i),i},b.rect=function(t,o,n,i,r){var s=e._engine.rect(this,t||0,o||0,n||0,i||0,r||0);return this.__set__&&this.__set__.push(s),s},b.ellipse=function(t,o,n,i){var r=e._engine.ellipse(this,t||0,o||0,n||0,i||0);return this.__set__&&this.__set__.push(r),r},b.path=function(t){t&&!e.is(t,z)&&!e.is(t[0],q)&&(t+=M);var o=e._engine.path(e.format[A](e,arguments),this);return this.__set__&&this.__set__.push(o),o},b.image=function(t,o,n,i,r){var s=e._engine.image(this,t||"about:blank",o||0,n||0,i||0,r||0);return this.__set__&&this.__set__.push(s),s},b.text=function(t,o,n){var i=e._engine.text(this,t||0,o||0,N(n));return this.__set__&&this.__set__.push(i),i},b.set=function(t){!e.is(t,"array")&&(t=Array.prototype.splice.call(arguments,0,arguments.length));var o=new ce(t);return this.__set__&&this.__set__.push(o),o.paper=this,o.type="set",o},b.setStart=function(t){this.__set__=t||this.set()},b.setFinish=function(t){var e=this.__set__;return delete this.__set__,e},b.getSize=function(){var t=this.canvas.parentNode;return{width:t.offsetWidth,height:t.offsetHeight}},b.setSize=function(t,o){return e._engine.setSize.call(this,t,o)},b.setViewBox=function(t,o,n,i,r){return e._engine.setViewBox.call(this,t,o,n,i,r)},b.top=b.bottom=null,b.raphael=e;var Jt=function(t){var e=t.getBoundingClientRect(),o=t.ownerDocument,n=o.body,i=o.documentElement,r=i.clientTop||n.clientTop||0,s=i.clientLeft||n.clientLeft||0;return{y:e.top+(w.win.pageYOffset||i.scrollTop||n.scrollTop)-r,x:e.left+(w.win.pageXOffset||i.scrollLeft||n.scrollLeft)-s}};b.getElementByPoint=function(t,e){var o=this,n=o.canvas,i=w.doc.elementFromPoint(t,e);if(w.win.opera&&"svg"==i.tagName){var r=Jt(n),s=n.createSVGRect();s.x=t-r.x,s.y=e-r.y,s.width=s.height=1;var a=n.getIntersectionList(s,null);a.length&&(i=a[a.length-1])}if(!i)return null;for(;i.parentNode&&i!=n.parentNode&&!i.raphael;)i=i.parentNode;return i==o.canvas.parentNode&&(i=n),i=i&&i.raphael?o.getById(i.raphaelid):null},b.getElementsByBBox=function(t){var o=this.set();return this.forEach(function(n){e.isBBoxIntersect(n.getBBox(),t)&&o.push(n)}),o},b.getById=function(t){for(var e=this.bottom;e;){if(e.id==t)return e;e=e.next}return null},b.forEach=function(t,e){for(var o=this.bottom;o;){if(!1===t.call(e,o))return this;o=o.next}return this},b.getElementsByPoint=function(t,e){var o=this.set();return this.forEach(function(n){n.isPointInside(t,e)&&o.push(n)}),o},Kt.isPointInside=function(t,o){var n=this.realPath=dt[this.type](this);return this.attr("transform")&&this.attr("transform").length&&(n=e.transformPath(n,this.attr("transform"))),e.isPointInsidePath(n,t,o)},Kt.getBBox=function(t){if(this.removed)return{};var e=this._;return t?(!e.dirty&&e.bboxwt||(this.realPath=dt[this.type](this),e.bboxwt=wt(this.realPath),e.bboxwt.toString=d,e.dirty=0),e.bboxwt):((e.dirty||e.dirtyT||!e.bbox)&&(!e.dirty&&this.realPath||(e.bboxwt=0,this.realPath=dt[this.type](this)),e.bbox=wt(ft(this.realPath,this.matrix)),e.bbox.toString=d,e.dirty=e.dirtyT=0),e.bbox)},Kt.clone=function(){if(this.removed)return null;var t=this.paper[this.type]().attr(this.attr());return this.__set__&&this.__set__.push(t),t},Kt.glow=function(t){if("text"==this.type)return null;t=t||{};var e={width:(t.width||10)+(+this.attr("stroke-width")||1),fill:t.fill||!1,opacity:null==t.opacity?.5:t.opacity,offsetx:t.offsetx||0,offsety:t.offsety||0,color:t.color||"#000"},o=e.width/2,n=this.paper,i=n.set(),r=this.realPath||dt[this.type](this);r=this.matrix?ft(r,this.matrix):r;for(var s=1;s<o+1;s++)i.push(n.path(r).attr({stroke:e.color,fill:e.fill?e.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(e.width/o*s).toFixed(3),opacity:+(e.opacity/o).toFixed(3)}));return i.insertBefore(this).translate(e.offsetx,e.offsety)};var Zt=function(t,o,n,i,r,s,a,u,h){return null==h?l(t,o,n,i,r,s,a,u):e.findDotsAtSegment(t,o,n,i,r,s,a,u,c(t,o,n,i,r,s,a,u,h))},te=function(t,o){return function(n,i,r){n=Rt(n);for(var s,a,l,c,u,h="",g={},p=0,d=0,f=n.length;d<f;d++){if(l=n[d],"M"==l[0])s=+l[1],a=+l[2];else{if(c=Zt(s,a,l[1],l[2],l[3],l[4],l[5],l[6]),p+c>i){if(o&&!g.start){if(u=Zt(s,a,l[1],l[2],l[3],l[4],l[5],l[6],i-p),h+=["C"+u.start.x,u.start.y,u.m.x,u.m.y,u.x,u.y],r)return h;g.start=h,h=["M"+u.x,u.y+"C"+u.n.x,u.n.y,u.end.x,u.end.y,l[5],l[6]].join(),p+=c,s=+l[5],a=+l[6];continue}if(!t&&!o)return u=Zt(s,a,l[1],l[2],l[3],l[4],l[5],l[6],i-p),{x:u.x,y:u.y,alpha:u.alpha}}p+=c,s=+l[5],a=+l[6]}h+=l.shift()+l}return g.end=h,u=t?p:o?g:e.findDotsAtSegment(s,a,l[0],l[1],l[2],l[3],l[4],l[5],1),u.alpha&&(u={x:u.x,y:u.y,alpha:u.alpha}),u}},ee=te(1),oe=te(),ne=te(0,1);e.getTotalLength=ee,e.getPointAtLength=oe,e.getSubpath=function(t,e,o){if(this.getTotalLength(t)-o<1e-6)return ne(t,e).end;var n=ne(t,o,1);return e?ne(n,e).end:n},Kt.getTotalLength=function(){var t=this.getPath();if(t)return this.node.getTotalLength?this.node.getTotalLength():ee(t)},Kt.getPointAtLength=function(t){var e=this.getPath();if(e)return oe(e,t)},Kt.getPath=function(){var t,o=e._getPath[this.type];if("text"!=this.type&&"set"!=this.type)return o&&(t=o(this)),t},Kt.getSubpath=function(t,o){var n=this.getPath();if(n)return e.getSubpath(n,t,o)};var ie=e.easing_formulas={linear:function(t){return t},"<":function(t){return G(t,1.7)},">":function(t){return G(t,.48)},"<>":function(t){var e=.48-t/1.04,o=j.sqrt(.1734+e*e),n=o-e,i=G(U(n),1/3)*(n<0?-1:1),r=-o-e,s=G(U(r),1/3)*(r<0?-1:1),a=i+s+.5;return 3*(1-a)*a*a+a*a*a},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){t-=1;var e=1.70158;return t*t*((e+1)*t+e)+1},elastic:function(t){return t==!!t?t:G(2,-10*t)*j.sin(2*V*(t-.075)/.3)+1},bounce:function(t){var e,o=7.5625,n=2.75;return t<1/n?e=o*t*t:t<2/n?(t-=1.5/n,e=o*t*t+.75):t<2.5/n?(t-=2.25/n,e=o*t*t+.9375):(t-=2.625/n,e=o*t*t+.984375),e}};ie.easeIn=ie["ease-in"]=ie["<"],ie.easeOut=ie["ease-out"]=ie[">"],ie.easeInOut=ie["ease-in-out"]=ie["<>"],ie["back-in"]=ie.backIn,ie["back-out"]=ie.backOut;var re=[],se=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,16)},ae=function(){for(var o=+new Date,n=0;n<re.length;n++){var i=re[n];if(!i.el.removed&&!i.paused){var r,s,a=o-i.start,l=i.ms,c=i.easing,u=i.from,h=i.diff,g=i.to,p=(i.t,i.el),d={},f={};if(i.initstatus?(a=(i.initstatus*i.anim.top-i.prev)/(i.percent-i.prev)*l,i.status=i.initstatus,delete i.initstatus,i.stop&&re.splice(n--,1)):i.status=(i.prev+(i.percent-i.prev)*(a/l))/i.anim.top,!(a<0))if(a<l){var m=c(a/l);for(var v in u)if(u[T](v)){switch(ot[v]){case W:r=+u[v]+m*l*h[v];break;case"colour":r="rgb("+[le(Q(u[v].r+m*l*h[v].r)),le(Q(u[v].g+m*l*h[v].g)),le(Q(u[v].b+m*l*h[v].b))].join(",")+")";break;case"path":r=[];for(var _=0,b=u[v].length;_<b;_++){r[_]=[u[v][_][0]];for(var E=1,x=u[v][_].length;E<x;E++)r[_][E]=+u[v][_][E]+m*l*h[v][_][E];r[_]=r[_].join(L)}r=r.join(L);break;case"transform":if(h[v].real)for(r=[],_=0,b=u[v].length;_<b;_++)for(r[_]=[u[v][_][0]],E=1,x=u[v][_].length;E<x;E++)r[_][E]=u[v][_][E]+m*l*h[v][_][E];else{var S=function(t){return+u[v][t]+m*l*h[v][t]};r=[["m",S(0),S(1),S(2),S(3),S(4),S(5)]]}break;case"csv":if("clip-rect"==v)for(r=[],_=4;_--;)r[_]=+u[v][_]+m*l*h[v][_];break;default:var w=[][I](u[v]);for(r=[],_=p.paper.customAttributes[v].length;_--;)r[_]=+w[_]+m*l*h[v][_]}d[v]=r}p.attr(d),function(e,o,n){setTimeout(function(){t("raphael.anim.frame."+e,o,n)})}(p.id,p,i.anim)}else{if(function(o,n,i){setTimeout(function(){t("raphael.anim.frame."+n.id,n,i),t("raphael.anim.finish."+n.id,n,i),e.is(o,"function")&&o.call(n)})}(i.callback,p,i.anim),p.attr(g),re.splice(n--,1),i.repeat>1&&!i.next){for(s in g)g[T](s)&&(f[s]=i.totalOrigin[s]);i.el.attr(f),y(i.anim,i.el,i.anim.percents[0],null,i.totalOrigin,i.repeat-1)}i.next&&!i.stop&&y(i.anim,i.el,i.next,null,i.totalOrigin,i.repeat)}}}re.length&&se(ae)},le=function(t){return t>255?255:t<0?0:t};Kt.animateWith=function(t,o,n,i,r,s){var a=this;if(a.removed)return s&&s.call(a),a;var l=n instanceof m?n:e.animation(n,i,r,s);y(l,a,l.percents[0],null,a.attr());for(var c=0,u=re.length;c<u;c++)if(re[c].anim==o&&re[c].el==t){re[u-1].start=re[c].start;break}return a},Kt.onAnimation=function(e){return e?t.on("raphael.anim.frame."+this.id,e):t.unbind("raphael.anim.frame."+this.id),this},m.prototype.delay=function(t){var e=new m(this.anim,this.ms);return e.times=this.times,e.del=+t||0,e},m.prototype.repeat=function(t){var e=new m(this.anim,this.ms);return e.del=this.del,e.times=j.floor(F(t,0))||1,e},e.animation=function(t,o,n,i){if(t instanceof m)return t;!e.is(n,"function")&&n||(i=i||n||null,n=null),t=Object(t),o=+o||0;var r,s,a={};for(s in t)t[T](s)&&J(s)!=s&&J(s)+"%"!=s&&(r=!0,a[s]=t[s]);if(r)return n&&(a.easing=n),i&&(a.callback=i),new m({100:a},o);if(i){var l=0;for(var c in t){var u=Z(c);t[T](c)&&u>l&&(l=u)}l+="%",!t[l].callback&&(t[l].callback=i)}return new m(t,o)},Kt.animate=function(t,o,n,i){var r=this;if(r.removed)return i&&i.call(r),r;var s=t instanceof m?t:e.animation(t,o,n,i);return y(s,r,s.percents[0],null,r.attr()),r},Kt.setTime=function(t,e){return t&&null!=e&&this.status(t,H(e,t.ms)/t.ms),this},Kt.status=function(t,e){var o,n,i=[],r=0;if(null!=e)return y(t,this,-1,H(e,1)),this;for(o=re.length;r<o;r++)if(n=re[r],n.el.id==this.id&&(!t||n.anim==t)){if(t)return n.status;i.push({anim:n.anim,status:n.status})}return t?0:i},Kt.pause=function(e){for(var o=0;o<re.length;o++)re[o].el.id!=this.id||e&&re[o].anim!=e||!1!==t("raphael.anim.pause."+this.id,this,re[o].anim)&&(re[o].paused=!0);return this},Kt.resume=function(e){for(var o=0;o<re.length;o++)if(re[o].el.id==this.id&&(!e||re[o].anim==e)){var n=re[o];!1!==t("raphael.anim.resume."+this.id,this,n.anim)&&(delete n.paused,this.status(n.anim,n.status))}return this},Kt.stop=function(e){for(var o=0;o<re.length;o++)re[o].el.id!=this.id||e&&re[o].anim!=e||!1!==t("raphael.anim.stop."+this.id,this,re[o].anim)&&re.splice(o--,1);return this},t.on("raphael.remove",v),t.on("raphael.clear",v),Kt.toString=function(){return"Raphals object"};var ce=function(t){if(this.items=[],this.length=0,this.type="set",t)for(var e=0,o=t.length;e<o;e++)!t[e]||t[e].constructor!=Kt.constructor&&t[e].constructor!=ce||(this[this.items.length]=this.items[this.items.length]=t[e],this.length++)},ue=ce.prototype;ue.push=function(){for(var t,e,o=0,n=arguments.length;o<n;o++)!(t=arguments[o])||t.constructor!=Kt.constructor&&t.constructor!=ce||(e=this.items.length,this[e]=this.items[e]=t,this.length++);return this},ue.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},ue.forEach=function(t,e){for(var o=0,n=this.items.length;o<n;o++)if(!1===t.call(e,this.items[o],o))return this;return this};for(var he in Kt)Kt[T](he)&&(ue[he]=function(t){return function(){var e=arguments;return this.forEach(function(o){o[t][A](o,e)})}}(he));return ue.attr=function(t,o){if(t&&e.is(t,q)&&e.is(t[0],"object"))for(var n=0,i=t.length;n<i;n++)this.items[n].attr(t[n]);else for(var r=0,s=this.items.length;r<s;r++)this.items[r].attr(t,o);return this},ue.clear=function(){for(;this.length;)this.pop()},ue.splice=function(t,e,o){t=t<0?F(this.length+t,0):t,e=F(0,H(this.length-t,e));var n,i=[],r=[],s=[];for(n=2;n<arguments.length;n++)s.push(arguments[n]);for(n=0;n<e;n++)r.push(this[t+n]);for(;n<this.length-t;n++)i.push(this[t+n]);var a=s.length;for(n=0;n<a+i.length;n++)this.items[t+n]=this[t+n]=n<a?s[n]:i[n-a];for(n=this.items.length=this.length-=e-a;this[n];)delete this[n++];return new ce(r)},ue.exclude=function(t){for(var e=0,o=this.length;e<o;e++)if(this[e]==t)return this.splice(e,1),!0},ue.animate=function(t,o,n,i){(e.is(n,"function")||!n)&&(i=n||null);var r,s,a=this.items.length,l=a,c=this;if(!a)return this;i&&(s=function(){!--a&&i.call(c)}),n=e.is(n,z)?n:s;var u=e.animation(t,o,n,s);for(r=this.items[--l].animate(u);l--;)this.items[l]&&!this.items[l].removed&&this.items[l].animateWith(r,u,u),this.items[l]&&!this.items[l].removed||a--;return this},ue.insertAfter=function(t){for(var e=this.items.length;e--;)this.items[e].insertAfter(t);return this},ue.getBBox=function(){for(var t=[],e=[],o=[],n=[],i=this.items.length;i--;)if(!this.items[i].removed){var r=this.items[i].getBBox();t.push(r.x),e.push(r.y),o.push(r.x+r.width),n.push(r.y+r.height)}return t=H[A](0,t),e=H[A](0,e),o=F[A](0,o),n=F[A](0,n),{x:t,y:e,x2:o,y2:n,width:o-t,height:n-e}},ue.clone=function(t){t=this.paper.set();for(var e=0,o=this.items.length;e<o;e++)t.push(this.items[e].clone());return t},ue.toString=function(){return"Raphals set"},ue.glow=function(t){var e=this.paper.set();return this.forEach(function(o,n){var i=o.glow(t);null!=i&&i.forEach(function(t,o){e.push(t)})}),e},ue.isPointInside=function(t,e){var o=!1;return this.forEach(function(n){if(n.isPointInside(t,e))return o=!0,!1}),o},e.registerFont=function(t){if(!t.face)return t;this.fonts=this.fonts||{};var e={w:t.w,face:{},glyphs:{}},o=t.face["font-family"];for(var n in t.face)t.face[T](n)&&(e.face[n]=t.face[n]);if(this.fonts[o]?this.fonts[o].push(e):this.fonts[o]=[e],!t.svg){e.face["units-per-em"]=Z(t.face["units-per-em"],10);for(var i in t.glyphs)if(t.glyphs[T](i)){var r=t.glyphs[i];if(e.glyphs[i]={w:r.w,k:{},d:r.d&&"M"+r.d.replace(/[mlcxtrv]/g,function(t){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[t]||"M"})+"z"},r.k)for(var s in r.k)r[T](s)&&(e.glyphs[i].k[s]=r.k[s])}}return t},b.getFont=function(t,o,n,i){if(i=i||"normal",n=n||"normal",o=+o||{normal:400,bold:700,lighter:300,bolder:800}[o]||400,e.fonts){var r=e.fonts[t];if(!r){var s=new RegExp("(^|\\s)"+t.replace(/[^\w\d\s+!~.:_-]/g,M)+"(\\s|$)","i");for(var a in e.fonts)if(e.fonts[T](a)&&s.test(a)){r=e.fonts[a];break}}var l;if(r)for(var c=0,u=r.length;c<u&&(l=r[c],l.face["font-weight"]!=o||l.face["font-style"]!=n&&l.face["font-style"]||l.face["font-stretch"]!=i);c++);return l}},b.print=function(t,o,n,i,r,s,a,l){s=s||"middle",a=F(H(a||0,1),-1),l=F(H(l||1,3),1);var c,u=N(n)[R](M),h=0,g=0,p=M;if(e.is(i,"string")&&(i=this.getFont(i)),i){c=(r||16)/i.face["units-per-em"];for(var d=i.face.bbox[R](E),f=+d[0],m=d[3]-d[1],y=0,v=+d[1]+("baseline"==s?m+ +i.face.descent:m/2),_=0,b=u.length;_<b;_++){if("\n"==u[_])h=0,S=0,g=0,y+=m*l;else{var x=g&&i.glyphs[u[_-1]]||{},S=i.glyphs[u[_]];h+=g?(x.w||i.w)+(x.k&&x.k[u[_]]||0)+i.w*a:0,g=1}S&&S.d&&(p+=e.transformPath(S.d,["t",h*c,y*c,"s",c,c,f,v,"t",(t-f)/c,(o-v)/c]))}}return this.path(p).attr({fill:"#000",stroke:"none"})},b.add=function(t){if(e.is(t,"array"))for(var o,n=this.set(),i=0,r=t.length;i<r;i++)o=t[i]||{},x[T](o.type)&&n.push(this[o.type]().attr(o));return n},e.format=function(t,o){var n=e.is(o,q)?[0][I](o):arguments;return t&&e.is(t,z)&&n.length-1&&(t=t.replace(S,function(t,e){return null==n[++e]?M:n[e]})),t||M},e.fullfill=function(){var t=/\{([^\}]+)\}/g,e=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,o=function(t,o,n){var i=n;return o.replace(e,function(t,e,o,n,r){e=e||n,i&&(e in i&&(i=i[e]),"function"==typeof i&&r&&(i=i()))}),i=(null==i||i==n?t:i)+""};return function(e,n){return String(e).replace(t,function(t,e){return o(t,e,n)})}}(),e.ninja=function(){if(C.was)w.win.Raphael=C.is;else{window.Raphael=void 0;try{delete window.Raphael}catch(t){}}return e},e.st=ue,t.on("raphael.DOMload",function(){_=!0}),function(t,o,n){function i(){/in/.test(t.readyState)?setTimeout(i,9):e.eve("raphael.DOMload")}null==t.readyState&&t.addEventListener&&(t.addEventListener(o,n=function(){t.removeEventListener(o,n,!1),t.readyState="complete"},!1),t.readyState="loading"),i()}(document,"DOMContentLoaded"),e}.apply(e,n))&&(t.exports=i)},function(t,e,o){var n,i;!function(o){var r,s,a="0.5.0",l="hasOwnProperty",c=/[\.\/]/,u=/\s*,\s*/,h=function(t,e){return t-e},g={n:{}},p=function(){for(var t=0,e=this.length;t<e;t++)if(void 0!==this[t])return this[t]},d=function(){for(var t=this.length;--t;)if(void 0!==this[t])return this[t]},f=Object.prototype.toString,m=String,y=Array.isArray||function(t){return t instanceof Array||"[object Array]"==f.call(t)};eve=function(t,e){var o,n=s,i=Array.prototype.slice.call(arguments,2),a=eve.listeners(t),l=0,c=[],u={},g=[],f=r;g.firstDefined=p,g.lastDefined=d,r=t,s=0;for(var m=0,y=a.length;m<y;m++)"zIndex"in a[m]&&(c.push(a[m].zIndex),a[m].zIndex<0&&(u[a[m].zIndex]=a[m]));for(c.sort(h);c[l]<0;)if(o=u[c[l++]],g.push(o.apply(e,i)),s)return s=n,g;for(m=0;m<y;m++)if("zIndex"in(o=a[m]))if(o.zIndex==c[l]){if(g.push(o.apply(e,i)),s)break;do{if(l++,o=u[c[l]],o&&g.push(o.apply(e,i)),s)break}while(o)}else u[o.zIndex]=o;else if(g.push(o.apply(e,i)),s)break;return s=n,r=f,g},eve._events=g,eve.listeners=function(t){var e,o,n,i,r,s,a,l,u=y(t)?t:t.split(c),h=g,p=[h],d=[];for(i=0,r=u.length;i<r;i++){for(l=[],s=0,a=p.length;s<a;s++)for(h=p[s].n,o=[h[u[i]],h["*"]],n=2;n--;)(e=o[n])&&(l.push(e),d=d.concat(e.f||[]));p=l}return d},eve.separator=function(t){t?(t=m(t).replace(/(?=[\.\^\]\[\-])/g,"\\"),t="["+t+"]",c=new RegExp(t)):c=/[\.\/]/},eve.on=function(t,e){if("function"!=typeof e)return function(){};for(var o=y(t)?y(t[0])?t:[t]:m(t).split(u),n=0,i=o.length;n<i;n++)!function(t){for(var o,n=y(t)?t:m(t).split(c),i=g,r=0,s=n.length;r<s;r++)i=i.n,i=i.hasOwnProperty(n[r])&&i[n[r]]||(i[n[r]]={n:{}});for(i.f=i.f||[],r=0,s=i.f.length;r<s;r++)if(i.f[r]==e){o=!0;break}!o&&i.f.push(e)}(o[n]);return function(t){+t==+t&&(e.zIndex=+t)}},eve.f=function(t){var e=[].slice.call(arguments,1);return function(){eve.apply(null,[t,null].concat(e).concat([].slice.call(arguments,0)))}},eve.stop=function(){s=1},eve.nt=function(t){var e=y(r)?r.join("."):r;return t?new RegExp("(?:\\.|\\/|^)"+t+"(?:\\.|\\/|$)").test(e):e},eve.nts=function(){return y(r)?r:r.split(c)},eve.off=eve.unbind=function(t,e){if(!t)return void(eve._events=g={n:{}});var o=y(t)?y(t[0])?t:[t]:m(t).split(u);if(o.length>1)for(var n=0,i=o.length;n<i;n++)eve.off(o[n],e);else{o=y(t)?t:m(t).split(c);var r,s,a,n,i,h,p,d=[g];for(n=0,i=o.length;n<i;n++)for(h=0;h<d.length;h+=a.length-2){if(a=[h,1],r=d[h].n,"*"!=o[n])r[o[n]]&&a.push(r[o[n]]);else for(s in r)r[l](s)&&a.push(r[s]);d.splice.apply(d,a)}for(n=0,i=d.length;n<i;n++)for(r=d[n];r.n;){if(e){if(r.f){for(h=0,p=r.f.length;h<p;h++)if(r.f[h]==e){r.f.splice(h,1);break}!r.f.length&&delete r.f}for(s in r.n)if(r.n[l](s)&&r.n[s].f){var f=r.n[s].f;for(h=0,p=f.length;h<p;h++)if(f[h]==e){f.splice(h,1);break}!f.length&&delete r.n[s].f}}else{delete r.f;for(s in r.n)r.n[l](s)&&r.n[s].f&&delete r.n[s].f}r=r.n}}},eve.once=function(t,e){var o=function(){return eve.off(t,o),e.apply(this,arguments)};return eve.on(t,o)},eve.version=a,eve.toString=function(){return"You are running Eve "+a},void 0!==t&&t.exports?t.exports=eve:(n=[],void 0!==(i=function(){return eve}.apply(e,n))&&(t.exports=i))}()},function(t,e,o){var n,i;n=[o(1)],void 0!==(i=function(t){if(!t||t.svg){var e="hasOwnProperty",o=String,n=parseFloat,i=parseInt,r=Math,s=r.max,a=r.abs,l=r.pow,c=/[, ]+/,u=t.eve,h="",g=" ",p="http://www.w3.org/1999/xlink",d={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},f={};t.toString=function(){return"Your browser supports SVG.\nYou are running Raphal "+this.version};var m=function(n,i){if(i){"string"==typeof n&&(n=m(n));for(var r in i)i[e](r)&&("xlink:"==r.substring(0,6)?n.setAttributeNS(p,r.substring(6),o(i[r])):n.setAttribute(r,o(i[r])))}else n=t._g.doc.createElementNS("http://www.w3.org/2000/svg",n),n.style&&(n.style.webkitTapHighlightColor="rgba(0,0,0,0)");return n},y=function(e,i){var c="linear",u=e.id+i,g=.5,p=.5,d=e.node,f=e.paper,y=d.style,v=t._g.doc.getElementById(u);if(!v){if(i=o(i).replace(t._radial_gradient,function(t,e,o){if(c="radial",e&&o){g=n(e),p=n(o);var i=2*(p>.5)-1;l(g-.5,2)+l(p-.5,2)>.25&&(p=r.sqrt(.25-l(g-.5,2))*i+.5)&&.5!=p&&(p=p.toFixed(5)-1e-5*i)}return h}),i=i.split(/\s*\-\s*/),"linear"==c){var b=i.shift();if(b=-n(b),isNaN(b))return null;var E=[0,0,r.cos(t.rad(b)),r.sin(t.rad(b))],x=1/(s(a(E[2]),a(E[3]))||1);E[2]*=x,E[3]*=x,E[2]<0&&(E[0]=-E[2],E[2]=0),E[3]<0&&(E[1]=-E[3],E[3]=0)}var S=t._parseDots(i);if(!S)return null;if(u=u.replace(/[\(\)\s,\xb0#]/g,"_"),e.gradient&&u!=e.gradient.id&&(f.defs.removeChild(e.gradient),delete e.gradient),!e.gradient){v=m(c+"Gradient",{id:u}),e.gradient=v,m(v,"radial"==c?{fx:g,fy:p}:{x1:E[0],y1:E[1],x2:E[2],y2:E[3],gradientTransform:e.matrix.invert()}),f.defs.appendChild(v);for(var T=0,w=S.length;T<w;T++)v.appendChild(m("stop",{offset:S[T].offset?S[T].offset:T?"100%":"0%","stop-color":S[T].color||"#fff","stop-opacity":isFinite(S[T].opacity)?S[T].opacity:1}))}}return m(d,{fill:_(u),opacity:1,"fill-opacity":1}),y.fill=h,y.opacity=1,y.fillOpacity=1,1},v=function(){var t=document.documentMode;return t&&(9===t||10===t)},_=function(t){if(v())return"url('#"+t+"')";var e=document.location;return"url('"+e.protocol+"//"+e.host+e.pathname+e.search+"#"+t+"')"},b=function(t){var e=t.getBBox(1);m(t.pattern,{patternTransform:t.matrix.invert()+" translate("+e.x+","+e.y+")"})},E=function(n,i,r){if("path"==n.type){for(var s,a,l,c,u,g=o(i).toLowerCase().split("-"),p=n.paper,y=r?"end":"start",v=n.node,_=n.attrs,b=_["stroke-width"],E=g.length,x="classic",S=3,T=3,w=5;E--;)switch(g[E]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":x=g[E];break;case"wide":T=5;break;case"narrow":T=2;break;case"long":S=5;break;case"short":S=2}if("open"==x?(S+=2,T+=2,w+=2,l=1,c=r?4:1,u={fill:"none",stroke:_.stroke}):(c=l=S/2,u={fill:_.stroke,stroke:"none"}),n._.arrows?r?(n._.arrows.endPath&&f[n._.arrows.endPath]--,n._.arrows.endMarker&&f[n._.arrows.endMarker]--):(n._.arrows.startPath&&f[n._.arrows.startPath]--,n._.arrows.startMarker&&f[n._.arrows.startMarker]--):n._.arrows={},"none"!=x){var C="raphael-marker-"+x,k="raphael-marker-"+y+x+S+T+"-obj"+n.id;t._g.doc.getElementById(C)?f[C]++:(p.defs.appendChild(m(m("path"),{"stroke-linecap":"round",d:d[x],id:C})),f[C]=1);var A,I=t._g.doc.getElementById(k);I?(f[k]++,A=I.getElementsByTagName("use")[0]):(I=m(m("marker"),{id:k,markerHeight:T,markerWidth:S,orient:"auto",refX:c,refY:T/2}),A=m(m("use"),{"xlink:href":"#"+C,transform:(r?"rotate(180 "+S/2+" "+T/2+") ":h)+"scale("+S/w+","+T/w+")","stroke-width":(1/((S/w+T/w)/2)).toFixed(4)}),I.appendChild(A),p.defs.appendChild(I),f[k]=1),m(A,u);var B=l*("diamond"!=x&&"oval"!=x);r?(s=n._.arrows.startdx*b||0,a=t.getTotalLength(_.path)-B*b):(s=B*b,a=t.getTotalLength(_.path)-(n._.arrows.enddx*b||0)),u={},u["marker-"+y]="url(#"+k+")",(a||s)&&(u.d=t.getSubpath(_.path,s,a)),m(v,u),n._.arrows[y+"Path"]=C,n._.arrows[y+"Marker"]=k,n._.arrows[y+"dx"]=B,n._.arrows[y+"Type"]=x,n._.arrows[y+"String"]=i}else r?(s=n._.arrows.startdx*b||0,a=t.getTotalLength(_.path)-s):(s=0,a=t.getTotalLength(_.path)-(n._.arrows.enddx*b||0)),n._.arrows[y+"Path"]&&m(v,{d:t.getSubpath(_.path,s,a)}),delete n._.arrows[y+"Path"],delete n._.arrows[y+"Marker"],delete n._.arrows[y+"dx"],delete n._.arrows[y+"Type"],delete n._.arrows[y+"String"];for(u in f)if(f[e](u)&&!f[u]){var M=t._g.doc.getElementById(u);M&&M.parentNode.removeChild(M)}}},x={"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},S=function(t,e,n){if(e=x[o(e).toLowerCase()]){for(var i=t.attrs["stroke-width"]||"1",r={round:i,square:i,butt:0}[t.attrs["stroke-linecap"]||n["stroke-linecap"]]||0,s=[],a=e.length;a--;)s[a]=e[a]*i+(a%2?1:-1)*r;m(t.node,{"stroke-dasharray":s.join(",")})}else m(t.node,{"stroke-dasharray":"none"})},T=function(n,r){var l=n.node,u=n.attrs,g=l.style.visibility;l.style.visibility="hidden";for(var d in r)if(r[e](d)){if(!t._availableAttrs[e](d))continue;var f=r[d];switch(u[d]=f,d){case"blur":n.blur(f);break;case"title":var v=l.getElementsByTagName("title");if(v.length&&(v=v[0]))v.firstChild.nodeValue=f;else{v=m("title");var _=t._g.doc.createTextNode(f);v.appendChild(_),l.appendChild(v)}break;case"href":case"target":var x=l.parentNode;if("a"!=x.tagName.toLowerCase()){var T=m("a");x.insertBefore(T,l),T.appendChild(l),x=T}"target"==d?x.setAttributeNS(p,"show","blank"==f?"new":f):x.setAttributeNS(p,d,f);break;case"cursor":l.style.cursor=f;break;case"transform":n.transform(f);break;case"arrow-start":E(n,f);break;case"arrow-end":E(n,f,1);break;case"clip-rect":var C=o(f).split(c);if(4==C.length){n.clip&&n.clip.parentNode.parentNode.removeChild(n.clip.parentNode);var k=m("clipPath"),A=m("rect");k.id=t.createUUID(),m(A,{x:C[0],y:C[1],width:C[2],height:C[3]}),k.appendChild(A),n.paper.defs.appendChild(k),m(l,{"clip-path":"url(#"+k.id+")"}),n.clip=A}if(!f){var I=l.getAttribute("clip-path");if(I){var B=t._g.doc.getElementById(I.replace(/(^url\(#|\)$)/g,h));B&&B.parentNode.removeChild(B),m(l,{"clip-path":h}),delete n.clip}}break;case"path":"path"==n.type&&(m(l,{d:f?u.path=t._pathToAbsolute(f):"M0,0"}),n._.dirty=1,n._.arrows&&("startString"in n._.arrows&&E(n,n._.arrows.startString),"endString"in n._.arrows&&E(n,n._.arrows.endString,1)));break;case"width":if(l.setAttribute(d,f),n._.dirty=1,!u.fx)break;d="x",f=u.x;case"x":u.fx&&(f=-u.x-(u.width||0));case"rx":if("rx"==d&&"rect"==n.type)break;case"cx":l.setAttribute(d,f),n.pattern&&b(n),n._.dirty=1;break;case"height":if(l.setAttribute(d,f),n._.dirty=1,!u.fy)break;d="y",f=u.y;case"y":u.fy&&(f=-u.y-(u.height||0));case"ry":if("ry"==d&&"rect"==n.type)break;case"cy":l.setAttribute(d,f),n.pattern&&b(n),n._.dirty=1;break;case"r":"rect"==n.type?m(l,{rx:f,ry:f}):l.setAttribute(d,f),n._.dirty=1;break;case"src":"image"==n.type&&l.setAttributeNS(p,"href",f);break;case"stroke-width":1==n._.sx&&1==n._.sy||(f/=s(a(n._.sx),a(n._.sy))||1),l.setAttribute(d,f),u["stroke-dasharray"]&&S(n,u["stroke-dasharray"],r),n._.arrows&&("startString"in n._.arrows&&E(n,n._.arrows.startString),"endString"in n._.arrows&&E(n,n._.arrows.endString,1));break;case"stroke-dasharray":S(n,f,r);break;case"fill":var M=o(f).match(t._ISURL);if(M){k=m("pattern");var L=m("image");k.id=t.createUUID(),m(k,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),m(L,{x:0,y:0,"xlink:href":M[1]}),k.appendChild(L),function(e){t._preload(M[1],function(){var t=this.offsetWidth,o=this.offsetHeight;m(e,{width:t,height:o}),m(L,{width:t,height:o})})}(k),n.paper.defs.appendChild(k),m(l,{fill:"url(#"+k.id+")"}),n.pattern=k,n.pattern&&b(n);break}var N=t.getRGB(f);if(N.error){if(("circle"==n.type||"ellipse"==n.type||"r"!=o(f).charAt())&&y(n,f)){if("opacity"in u||"fill-opacity"in u){var R=t._g.doc.getElementById(l.getAttribute("fill").replace(/^url\(#|\)$/g,h));if(R){var D=R.getElementsByTagName("stop");m(D[D.length-1],{"stop-opacity":("opacity"in u?u.opacity:1)*("fill-opacity"in u?u["fill-opacity"]:1)})}}u.gradient=f,u.fill="none";break}}else delete r.gradient,delete u.gradient,!t.is(u.opacity,"undefined")&&t.is(r.opacity,"undefined")&&m(l,{opacity:u.opacity}),!t.is(u["fill-opacity"],"undefined")&&t.is(r["fill-opacity"],"undefined")&&m(l,{"fill-opacity":u["fill-opacity"]});N[e]("opacity")&&m(l,{"fill-opacity":N.opacity>1?N.opacity/100:N.opacity});case"stroke":N=t.getRGB(f),l.setAttribute(d,N.hex),"stroke"==d&&N[e]("opacity")&&m(l,{"stroke-opacity":N.opacity>1?N.opacity/100:N.opacity}),"stroke"==d&&n._.arrows&&("startString"in n._.arrows&&E(n,n._.arrows.startString),"endString"in n._.arrows&&E(n,n._.arrows.endString,1));break;case"gradient":("circle"==n.type||"ellipse"==n.type||"r"!=o(f).charAt())&&y(n,f);break;case"opacity":u.gradient&&!u[e]("stroke-opacity")&&m(l,{"stroke-opacity":f>1?f/100:f});case"fill-opacity":if(u.gradient){(R=t._g.doc.getElementById(l.getAttribute("fill").replace(/^url\(#|\)$/g,h)))&&(D=R.getElementsByTagName("stop"),m(D[D.length-1],{"stop-opacity":f}));break}default:"font-size"==d&&(f=i(f,10)+"px");var O=d.replace(/(\-.)/g,function(t){return t.substring(1).toUpperCase()});l.style[O]=f,n._.dirty=1,l.setAttribute(d,f)}}w(n,r),l.style.visibility=g},w=function(n,r){if("text"==n.type&&(r[e]("text")||r[e]("font")||r[e]("font-size")||r[e]("x")||r[e]("y"))){var s=n.attrs,a=n.node,l=a.firstChild?i(t._g.doc.defaultView.getComputedStyle(a.firstChild,h).getPropertyValue("font-size"),10):10;if(r[e]("text")){for(s.text=r.text;a.firstChild;)a.removeChild(a.firstChild);for(var c,u=o(r.text).split("\n"),g=[],p=0,d=u.length;p<d;p++)c=m("tspan"),p&&m(c,{dy:1.2*l,x:s.x}),c.appendChild(t._g.doc.createTextNode(u[p])),a.appendChild(c),g[p]=c}else for(g=a.getElementsByTagName("tspan"),p=0,d=g.length;p<d;p++)p?m(g[p],{dy:1.2*l,x:s.x}):m(g[0],{dy:0});m(a,{x:s.x,y:s.y}),n._.dirty=1;var f=n._getBBox(),y=s.y-(f.y+f.height/2);y&&t.is(y,"finite")&&m(g[0],{dy:y})}},C=function(t){return t.parentNode&&"a"===t.parentNode.tagName.toLowerCase()?t.parentNode:t},k=function(e,o){this[0]=this.node=e,e.raphael=!0,this.id=function(){return("0000"+(Math.random()*Math.pow(36,5)<<0).toString(36)).slice(-5)}(),e.raphaelid=this.id,this.matrix=t.matrix(),this.realPath=null,this.paper=o,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!o.bottom&&(o.bottom=this),this.prev=o.top,o.top&&(o.top.next=this),o.top=this,this.next=null},A=t.el;k.prototype=A,A.constructor=k,t._engine.path=function(t,e){var o=m("path");e.canvas&&e.canvas.appendChild(o);var n=new k(o,e);return n.type="path",T(n,{fill:"none",stroke:"#000",path:t}),n},A.rotate=function(t,e,i){if(this.removed)return this;if(t=o(t).split(c),t.length-1&&(e=n(t[1]),i=n(t[2])),t=n(t[0]),null==i&&(e=i),null==e||null==i){var r=this.getBBox(1);e=r.x+r.width/2,i=r.y+r.height/2}return this.transform(this._.transform.concat([["r",t,e,i]])),this},A.scale=function(t,e,i,r){if(this.removed)return this;if(t=o(t).split(c),t.length-1&&(e=n(t[1]),i=n(t[2]),r=n(t[3])),t=n(t[0]),null==e&&(e=t),null==r&&(i=r),null==i||null==r)var s=this.getBBox(1);return i=null==i?s.x+s.width/2:i,r=null==r?s.y+s.height/2:r,this.transform(this._.transform.concat([["s",t,e,i,r]])),this},A.translate=function(t,e){return this.removed?this:(t=o(t).split(c),t.length-1&&(e=n(t[1])),t=n(t[0])||0,e=+e||0,this.transform(this._.transform.concat([["t",t,e]])),this)},A.transform=function(o){var n=this._;if(null==o)return n.transform;if(t._extractTransform(this,o),this.clip&&m(this.clip,{transform:this.matrix.invert()}),this.pattern&&b(this),this.node&&m(this.node,{transform:this.matrix}),1!=n.sx||1!=n.sy){var i=this.attrs[e]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":i})}return this},A.hide=function(){return this.removed||(this.node.style.display="none"),this},A.show=function(){return this.removed||(this.node.style.display=""),this},A.remove=function(){var e=C(this.node);if(!this.removed&&e.parentNode){var o=this.paper;o.__set__&&o.__set__.exclude(this),u.unbind("raphael.*.*."+this.id),this.gradient&&o.defs.removeChild(this.gradient),t._tear(this,o),e.parentNode.removeChild(e),this.removeData();for(var n in this)this[n]="function"==typeof this[n]?t._removedFactory(n):null;this.removed=!0}},A._getBBox=function(){if("none"==this.node.style.display){this.show();var t=!0}var e,o=!1;this.paper.canvas.parentElement?e=this.paper.canvas.parentElement.style:this.paper.canvas.parentNode&&(e=this.paper.canvas.parentNode.style),e&&"none"==e.display&&(o=!0,e.display="");var n={};try{n=this.node.getBBox()}catch(t){n={x:this.node.clientLeft,y:this.node.clientTop,width:this.node.clientWidth,height:this.node.clientHeight}}finally{n=n||{},o&&(e.display="none")}return t&&this.hide(),n},A.attr=function(o,n){if(this.removed)return this;if(null==o){var i={};for(var r in this.attrs)this.attrs[e](r)&&(i[r]=this.attrs[r]);return i.gradient&&"none"==i.fill&&(i.fill=i.gradient)&&delete i.gradient,i.transform=this._.transform,i}if(null==n&&t.is(o,"string")){if("fill"==o&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;if("transform"==o)return this._.transform;for(var s=o.split(c),a={},l=0,h=s.length;l<h;l++)o=s[l],o in this.attrs?a[o]=this.attrs[o]:t.is(this.paper.customAttributes[o],"function")?a[o]=this.paper.customAttributes[o].def:a[o]=t._availableAttrs[o];return h-1?a:a[s[0]]}if(null==n&&t.is(o,"array")){for(a={},l=0,h=o.length;l<h;l++)a[o[l]]=this.attr(o[l]);return a}if(null!=n){var g={};g[o]=n}else null!=o&&t.is(o,"object")&&(g=o);for(var p in g)u("raphael.attr."+p+"."+this.id,this,g[p]);for(p in this.paper.customAttributes)if(this.paper.customAttributes[e](p)&&g[e](p)&&t.is(this.paper.customAttributes[p],"function")){var d=this.paper.customAttributes[p].apply(this,[].concat(g[p]));this.attrs[p]=g[p];for(var f in d)d[e](f)&&(g[f]=d[f])}return T(this,g),this},A.toFront=function(){if(this.removed)return this;var e=C(this.node);e.parentNode.appendChild(e);var o=this.paper;return o.top!=this&&t._tofront(this,o),this},A.toBack=function(){if(this.removed)return this;var e=C(this.node),o=e.parentNode;o.insertBefore(e,o.firstChild),t._toback(this,this.paper);this.paper;return this},A.insertAfter=function(e){if(this.removed||!e)return this;var o=C(this.node),n=C(e.node||e[e.length-1].node);return n.nextSibling?n.parentNode.insertBefore(o,n.nextSibling):n.parentNode.appendChild(o),t._insertafter(this,e,this.paper),this},A.insertBefore=function(e){if(this.removed||!e)return this;var o=C(this.node),n=C(e.node||e[0].node);return n.parentNode.insertBefore(o,n),t._insertbefore(this,e,this.paper),this},A.blur=function(e){var o=this;if(0!=+e){var n=m("filter"),i=m("feGaussianBlur");o.attrs.blur=e,n.id=t.createUUID(),m(i,{stdDeviation:+e||1.5}),n.appendChild(i),o.paper.defs.appendChild(n),o._blur=n,m(o.node,{filter:"url(#"+n.id+")"})}else o._blur&&(o._blur.parentNode.removeChild(o._blur),delete o._blur,delete o.attrs.blur),o.node.removeAttribute("filter");return o},t._engine.circle=function(t,e,o,n){var i=m("circle");t.canvas&&t.canvas.appendChild(i);var r=new k(i,t);return r.attrs={cx:e,cy:o,r:n,fill:"none",stroke:"#000"},r.type="circle",m(i,r.attrs),r},t._engine.rect=function(t,e,o,n,i,r){var s=m("rect");t.canvas&&t.canvas.appendChild(s);var a=new k(s,t);return a.attrs={x:e,y:o,width:n,height:i,rx:r||0,ry:r||0,fill:"none",stroke:"#000"},a.type="rect",m(s,a.attrs),a},t._engine.ellipse=function(t,e,o,n,i){var r=m("ellipse");t.canvas&&t.canvas.appendChild(r);var s=new k(r,t);return s.attrs={cx:e,cy:o,rx:n,ry:i,fill:"none",stroke:"#000"},s.type="ellipse",m(r,s.attrs),s},t._engine.image=function(t,e,o,n,i,r){var s=m("image");m(s,{x:o,y:n,width:i,height:r,preserveAspectRatio:"none"}),s.setAttributeNS(p,"href",e),t.canvas&&t.canvas.appendChild(s);var a=new k(s,t);return a.attrs={x:o,y:n,width:i,height:r,src:e},a.type="image",a},t._engine.text=function(e,o,n,i){var r=m("text");e.canvas&&e.canvas.appendChild(r);var s=new k(r,e);return s.attrs={x:o,y:n,"text-anchor":"middle",text:i,"font-family":t._availableAttrs["font-family"],"font-size":t._availableAttrs["font-size"],stroke:"none",fill:"#000"},s.type="text",T(s,s.attrs),s},t._engine.setSize=function(t,e){return this.width=t||this.width,this.height=e||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox),this},t._engine.create=function(){var e=t._getContainer.apply(0,arguments),o=e&&e.container,n=e.x,i=e.y,r=e.width,s=e.height;if(!o)throw new Error("SVG container not found.");var a,l=m("svg"),c="overflow:hidden;";return n=n||0,i=i||0,r=r||512,s=s||342,m(l,{height:s,version:1.1,width:r,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}),1==o?(l.style.cssText=c+"position:absolute;left:"+n+"px;top:"+i+"px",t._g.doc.body.appendChild(l),a=1):(l.style.cssText=c+"position:relative",o.firstChild?o.insertBefore(l,o.firstChild):o.appendChild(l)),o=new t._Paper,o.width=r,o.height=s,o.canvas=l,o.clear(),o._left=o._top=0,a&&(o.renderfix=function(){}),o.renderfix(),o},t._engine.setViewBox=function(t,e,o,n,i){u("raphael.setViewBox",this,this._viewBox,[t,e,o,n,i]);var r,a,l=this.getSize(),c=s(o/l.width,n/l.height),h=this.top,p=i?"xMidYMid meet":"xMinYMin";for(null==t?(this._vbSize&&(c=1),delete this._vbSize,r="0 0 "+this.width+g+this.height):(this._vbSize=c,r=t+g+e+g+o+g+n),m(this.canvas,{viewBox:r,preserveAspectRatio:p});c&&h;)a="stroke-width"in h.attrs?h.attrs["stroke-width"]:1,h.attr({"stroke-width":a}),h._.dirty=1,h._.dirtyT=1,h=h.prev;return this._viewBox=[t,e,o,n,!!i],this},t.prototype.renderfix=function(){var t,e=this.canvas,o=e.style;try{t=e.getScreenCTM()||e.createSVGMatrix()}catch(o){t=e.createSVGMatrix()}var n=-t.e%1,i=-t.f%1;(n||i)&&(n&&(this._left=(this._left+n)%1,o.left=this._left+"px"),i&&(this._top=(this._top+i)%1,o.top=this._top+"px"))},t.prototype.clear=function(){t.eve("raphael.clear",this);for(var e=this.canvas;e.firstChild;)e.removeChild(e.firstChild);this.bottom=this.top=null,(this.desc=m("desc")).appendChild(t._g.doc.createTextNode("Created with Raphal "+t.version)),e.appendChild(this.desc),e.appendChild(this.defs=m("defs"))},t.prototype.remove=function(){u("raphael.remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var e in this)this[e]="function"==typeof this[e]?t._removedFactory(e):null};var I=t.st;for(var B in A)A[e](B)&&!I[e](B)&&(I[B]=function(t){return function(){var e=arguments;return this.forEach(function(o){o[t].apply(o,e)})}}(B))}}.apply(e,n))&&(t.exports=i)},function(t,e,o){var n,i;n=[o(1)],void 0!==(i=function(t){if(!t||t.vml){var e="hasOwnProperty",o=String,n=parseFloat,i=Math,r=i.round,s=i.max,a=i.min,l=i.abs,c="fill",u=/[, ]+/,h=t.eve,g=" ",p="",d={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},f=/([clmz]),?([^clmz]*)/gi,m=/ progid:\S+Blur\([^\)]+\)/g,y=/-?[^,\s-]+/g,v="position:absolute;left:0;top:0;width:1px;height:1px;behavior:url(#default#VML)",_=21600,b={path:1,rect:1,image:1},E={circle:1,ellipse:1},x=function(e){var n=/[ahqstv]/gi,i=t._pathToAbsolute;if(o(e).match(n)&&(i=t._path2curve),n=/[clmz]/g,i==t._pathToAbsolute&&!o(e).match(n)){var s=o(e).replace(f,function(t,e,o){var n=[],i="m"==e.toLowerCase(),s=d[e];return o.replace(y,function(t){i&&2==n.length&&(s+=n+d["m"==e?"l":"L"],n=[]),n.push(r(t*_))}),s+n});return s}var a,l,c=i(e);s=[];for(var u=0,h=c.length;u<h;u++){a=c[u],"z"==(l=c[u][0].toLowerCase())&&(l="x");for(var m=1,v=a.length;m<v;m++)l+=r(a[m]*_)+(m!=v-1?",":p);s.push(l)}return s.join(g)},S=function(e,o,n){var i=t.matrix();return i.rotate(-e,.5,.5),{dx:i.x(o,n),dy:i.y(o,n)}},T=function(t,e,o,n,i,r){var s=t._,a=t.matrix,u=s.fillpos,h=t.node,p=h.style,d=1,f="",m=_/e,y=_/o;if(p.visibility="hidden",e&&o){if(h.coordsize=l(m)+g+l(y),p.rotation=r*(e*o<0?-1:1),r){var v=S(r,n,i);n=v.dx,i=v.dy}if(e<0&&(f+="x"),o<0&&(f+=" y")&&(d=-1),p.flip=f,h.coordorigin=n*-m+g+i*-y,u||s.fillsize){var b=h.getElementsByTagName(c);b=b&&b[0],h.removeChild(b),u&&(v=S(r,a.x(u[0],u[1]),a.y(u[0],u[1])),b.position=v.dx*d+g+v.dy*d),s.fillsize&&(b.size=s.fillsize[0]*l(e)+g+s.fillsize[1]*l(o)),h.appendChild(b)}p.visibility="visible"}};t.toString=function(){return"Your browser doesnt support SVG. Falling down to VML.\nYou are running Raphal "+this.version};var w=function(t,e,n){for(var i=o(e).toLowerCase().split("-"),r=n?"end":"start",s=i.length,a="classic",l="medium",c="medium";s--;)switch(i[s]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":a=i[s];break;case"wide":case"narrow":c=i[s];break;case"long":case"short":l=i[s]}var u=t.node.getElementsByTagName("stroke")[0];u[r+"arrow"]=a,u[r+"arrowlength"]=l,u[r+"arrowwidth"]=c},C=function(i,l){i.attrs=i.attrs||{};var h=i.node,d=i.attrs,f=h.style,m=b[i.type]&&(l.x!=d.x||l.y!=d.y||l.width!=d.width||l.height!=d.height||l.cx!=d.cx||l.cy!=d.cy||l.rx!=d.rx||l.ry!=d.ry||l.r!=d.r),y=E[i.type]&&(d.cx!=l.cx||d.cy!=l.cy||d.r!=l.r||d.rx!=l.rx||d.ry!=l.ry),v=i;for(var S in l)l[e](S)&&(d[S]=l[S]);if(m&&(d.path=t._getPath[i.type](i),i._.dirty=1),l.href&&(h.href=l.href),l.title&&(h.title=l.title),l.target&&(h.target=l.target),l.cursor&&(f.cursor=l.cursor),"blur"in l&&i.blur(l.blur),(l.path&&"path"==i.type||m)&&(h.path=x(~o(d.path).toLowerCase().indexOf("r")?t._pathToAbsolute(d.path):d.path),i._.dirty=1,"image"==i.type&&(i._.fillpos=[d.x,d.y],i._.fillsize=[d.width,d.height],T(i,1,1,0,0,0))),"transform"in l&&i.transform(l.transform),y){var C=+d.cx,A=+d.cy,I=+d.rx||+d.r||0,M=+d.ry||+d.r||0;h.path=t.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",r((C-I)*_),r((A-M)*_),r((C+I)*_),r((A+M)*_),r(C*_)),i._.dirty=1}if("clip-rect"in l){var L=o(l["clip-rect"]).split(u);if(4==L.length){L[2]=+L[2]+ +L[0],L[3]=+L[3]+ +L[1];var N=h.clipRect||t._g.doc.createElement("div"),R=N.style;R.clip=t.format("rect({1}px {2}px {3}px {0}px)",L),h.clipRect||(R.position="absolute",R.top=0,R.left=0,R.width=i.paper.width+"px",R.height=i.paper.height+"px",h.parentNode.insertBefore(N,h),N.appendChild(h),h.clipRect=N)}l["clip-rect"]||h.clipRect&&(h.clipRect.style.clip="auto")}if(i.textpath){var D=i.textpath.style;l.font&&(D.font=l.font),l["font-family"]&&(D.fontFamily='"'+l["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,p)+'"'),l["font-size"]&&(D.fontSize=l["font-size"]),l["font-weight"]&&(D.fontWeight=l["font-weight"]),l["font-style"]&&(D.fontStyle=l["font-style"])}if("arrow-start"in l&&w(v,l["arrow-start"]),"arrow-end"in l&&w(v,l["arrow-end"],1),null!=l.opacity||null!=l.fill||null!=l.src||null!=l.stroke||null!=l["stroke-width"]||null!=l["stroke-opacity"]||null!=l["fill-opacity"]||null!=l["stroke-dasharray"]||null!=l["stroke-miterlimit"]||null!=l["stroke-linejoin"]||null!=l["stroke-linecap"]){var O=h.getElementsByTagName(c);if(O=O&&O[0],!O&&(O=B(c)),"image"==i.type&&l.src&&(O.src=l.src),l.fill&&(O.on=!0),null!=O.on&&"none"!=l.fill&&null!==l.fill||(O.on=!1),O.on&&l.fill){var P=o(l.fill).match(t._ISURL);if(P){O.parentNode==h&&h.removeChild(O),O.rotate=!0,O.src=P[1],O.type="tile";var j=i.getBBox(1);O.position=j.x+g+j.y,i._.fillpos=[j.x,j.y],t._preload(P[1],function(){i._.fillsize=[this.offsetWidth,this.offsetHeight]})}else O.color=t.getRGB(l.fill).hex,O.src=p,O.type="solid",t.getRGB(l.fill).error&&(v.type in{circle:1,ellipse:1}||"r"!=o(l.fill).charAt())&&k(v,l.fill,O)&&(d.fill="none",d.gradient=l.fill,O.rotate=!1)}if("fill-opacity"in l||"opacity"in l){var F=((+d["fill-opacity"]+1||2)-1)*((+d.opacity+1||2)-1)*((+t.getRGB(l.fill).o+1||2)-1);F=a(s(F,0),1),O.opacity=F,O.src&&(O.color="none")}h.appendChild(O);var H=h.getElementsByTagName("stroke")&&h.getElementsByTagName("stroke")[0],U=!1;!H&&(U=H=B("stroke")),(l.stroke&&"none"!=l.stroke||l["stroke-width"]||null!=l["stroke-opacity"]||l["stroke-dasharray"]||l["stroke-miterlimit"]||l["stroke-linejoin"]||l["stroke-linecap"])&&(H.on=!0),("none"==l.stroke||null===l.stroke||null==H.on||0==l.stroke||0==l["stroke-width"])&&(H.on=!1);var G=t.getRGB(l.stroke);H.on&&l.stroke&&(H.color=G.hex),F=((+d["stroke-opacity"]+1||2)-1)*((+d.opacity+1||2)-1)*((+G.o+1||2)-1);var V=.75*(n(l["stroke-width"])||1);if(F=a(s(F,0),1),null==l["stroke-width"]&&(V=d["stroke-width"]),l["stroke-width"]&&(H.weight=V),V&&V<1&&(F*=V)&&(H.weight=1),H.opacity=F,l["stroke-linejoin"]&&(H.joinstyle=l["stroke-linejoin"]||"miter"),H.miterlimit=l["stroke-miterlimit"]||8,l["stroke-linecap"]&&(H.endcap="butt"==l["stroke-linecap"]?"flat":"square"==l["stroke-linecap"]?"square":"round"),"stroke-dasharray"in l){var W={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};H.dashstyle=W[e](l["stroke-dasharray"])?W[l["stroke-dasharray"]]:p}U&&h.appendChild(H)}if("text"==v.type){v.paper.canvas.style.display=p;var z=v.paper.span,q=d.font&&d.font.match(/\d+(?:\.\d*)?(?=px)/);f=z.style,d.font&&(f.font=d.font),d["font-family"]&&(f.fontFamily=d["font-family"]),d["font-weight"]&&(f.fontWeight=d["font-weight"]),d["font-style"]&&(f.fontStyle=d["font-style"]),q=n(d["font-size"]||q&&q[0])||10,f.fontSize=100*q+"px",v.textpath.string&&(z.innerHTML=o(v.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var X=z.getBoundingClientRect();v.W=d.w=(X.right-X.left)/100,v.H=d.h=(X.bottom-X.top)/100,v.X=d.x,v.Y=d.y+v.H/2,("x"in l||"y"in l)&&(v.path.v=t.format("m{0},{1}l{2},{1}",r(d.x*_),r(d.y*_),r(d.x*_)+1));for(var Y=["x","y","text","font","font-family","font-weight","font-style","font-size"],K=0,$=Y.length;K<$;K++)if(Y[K]in l){v._.dirty=1;break}switch(d["text-anchor"]){case"start":v.textpath.style["v-text-align"]="left",v.bbx=v.W/2;break;case"end":v.textpath.style["v-text-align"]="right",v.bbx=-v.W/2;break;default:v.textpath.style["v-text-align"]="center",v.bbx=0}v.textpath.style["v-text-kern"]=!0}},k=function(e,r,s){e.attrs=e.attrs||{};var a=(e.attrs,Math.pow),l="linear",c=".5 .5";if(e.attrs.gradient=r,r=o(r).replace(t._radial_gradient,function(t,e,o){return l="radial",e&&o&&(e=n(e),o=n(o),a(e-.5,2)+a(o-.5,2)>.25&&(o=i.sqrt(.25-a(e-.5,2))*(2*(o>.5)-1)+.5),c=e+g+o),p}),r=r.split(/\s*\-\s*/),"linear"==l){var u=r.shift();if(u=-n(u),isNaN(u))return null}var h=t._parseDots(r);if(!h)return null;if(e=e.shape||e.node,h.length){e.removeChild(s),s.on=!0,s.method="none",s.color=h[0].color,s.color2=h[h.length-1].color;for(var d=[],f=0,m=h.length;f<m;f++)h[f].offset&&d.push(h[f].offset+g+h[f].color);s.colors=d.length?d.join():"0% "+s.color,"radial"==l?(s.type="gradientTitle",s.focus="100%",s.focussize="0 0",s.focusposition=c,s.angle=0):(s.type="gradient",s.angle=(270-u)%360),e.appendChild(s)}return 1},A=function(e,o){this[0]=this.node=e,e.raphael=!0,this.id=t._oid++,e.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=o,this.matrix=t.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!o.bottom&&(o.bottom=this),this.prev=o.top,o.top&&(o.top.next=this),o.top=this,this.next=null},I=t.el;A.prototype=I,I.constructor=A,I.transform=function(e){if(null==e)return this._.transform;var n,i=this.paper._viewBoxShift,r=i?"s"+[i.scale,i.scale]+"-1-1t"+[i.dx,i.dy]:p;i&&(n=e=o(e).replace(/\.{3}|\u2026/g,this._.transform||p)),t._extractTransform(this,r+e);var s,a=this.matrix.clone(),l=this.skew,c=this.node,u=~o(this.attrs.fill).indexOf("-"),h=!o(this.attrs.fill).indexOf("url(");if(a.translate(1,1),h||u||"image"==this.type)if(l.matrix="1 0 0 1",l.offset="0 0",s=a.split(),u&&s.noRotation||!s.isSimple){c.style.filter=a.toFilter();var d=this.getBBox(),f=this.getBBox(1),m=d.x-f.x,y=d.y-f.y;c.coordorigin=m*-_+g+y*-_,T(this,1,1,m,y,0)}else c.style.filter=p,T(this,s.scalex,s.scaley,s.dx,s.dy,s.rotate);else c.style.filter=p,l.matrix=o(a),l.offset=a.offset();return null!==n&&(this._.transform=n,t._extractTransform(this,n)),this},I.rotate=function(t,e,i){if(this.removed)return this;if(null!=t){if(t=o(t).split(u),t.length-1&&(e=n(t[1]),i=n(t[2])),t=n(t[0]),null==i&&(e=i),null==e||null==i){var r=this.getBBox(1);e=r.x+r.width/2,i=r.y+r.height/2}return this._.dirtyT=1,this.transform(this._.transform.concat([["r",t,e,i]])),this}},I.translate=function(t,e){return this.removed?this:(t=o(t).split(u),t.length-1&&(e=n(t[1])),t=n(t[0])||0,e=+e||0,this._.bbox&&(this._.bbox.x+=t,this._.bbox.y+=e),this.transform(this._.transform.concat([["t",t,e]])),this)},I.scale=function(t,e,i,r){if(this.removed)return this;if(t=o(t).split(u),t.length-1&&(e=n(t[1]),i=n(t[2]),r=n(t[3]),isNaN(i)&&(i=null),isNaN(r)&&(r=null)),t=n(t[0]),null==e&&(e=t),null==r&&(i=r),null==i||null==r)var s=this.getBBox(1);return i=null==i?s.x+s.width/2:i,r=null==r?s.y+s.height/2:r,this.transform(this._.transform.concat([["s",t,e,i,r]])),this._.dirtyT=1,this},I.hide=function(){return!this.removed&&(this.node.style.display="none"),this},I.show=function(){return!this.removed&&(this.node.style.display=p),this},I.auxGetBBox=t.el.getBBox,I.getBBox=function(){var t=this.auxGetBBox();if(this.paper&&this.paper._viewBoxShift){var e={},o=1/this.paper._viewBoxShift.scale;return e.x=t.x-this.paper._viewBoxShift.dx,e.x*=o,e.y=t.y-this.paper._viewBoxShift.dy,e.y*=o,e.width=t.width*o,e.height=t.height*o,e.x2=e.x+e.width,e.y2=e.y+e.height,e}return t},I._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},I.remove=function(){if(!this.removed&&this.node.parentNode){this.paper.__set__&&this.paper.__set__.exclude(this),t.eve.unbind("raphael.*.*."+this.id),t._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var e in this)this[e]="function"==typeof this[e]?t._removedFactory(e):null;this.removed=!0}},I.attr=function(o,n){if(this.removed)return this;if(null==o){var i={};for(var r in this.attrs)this.attrs[e](r)&&(i[r]=this.attrs[r]);return i.gradient&&"none"==i.fill&&(i.fill=i.gradient)&&delete i.gradient,i.transform=this._.transform,i}if(null==n&&t.is(o,"string")){if(o==c&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;for(var s=o.split(u),a={},l=0,g=s.length;l<g;l++)o=s[l],o in this.attrs?a[o]=this.attrs[o]:t.is(this.paper.customAttributes[o],"function")?a[o]=this.paper.customAttributes[o].def:a[o]=t._availableAttrs[o];return g-1?a:a[s[0]]}if(this.attrs&&null==n&&t.is(o,"array")){for(a={},l=0,g=o.length;l<g;l++)a[o[l]]=this.attr(o[l]);return a}var p;null!=n&&(p={},p[o]=n),null==n&&t.is(o,"object")&&(p=o);for(var d in p)h("raphael.attr."+d+"."+this.id,this,p[d]);if(p){for(d in this.paper.customAttributes)if(this.paper.customAttributes[e](d)&&p[e](d)&&t.is(this.paper.customAttributes[d],"function")){var f=this.paper.customAttributes[d].apply(this,[].concat(p[d]));this.attrs[d]=p[d];for(var m in f)f[e](m)&&(p[m]=f[m])}p.text&&"text"==this.type&&(this.textpath.string=p.text),C(this,p)}return this},I.toFront=function(){return!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&t._tofront(this,this.paper),this},I.toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),t._toback(this,this.paper)),this)},I.insertAfter=function(e){return this.removed?this:(e.constructor==t.st.constructor&&(e=e[e.length-1]),e.node.nextSibling?e.node.parentNode.insertBefore(this.node,e.node.nextSibling):e.node.parentNode.appendChild(this.node),t._insertafter(this,e,this.paper),this)},I.insertBefore=function(e){return this.removed?this:(e.constructor==t.st.constructor&&(e=e[0]),e.node.parentNode.insertBefore(this.node,e.node),t._insertbefore(this,e,this.paper),this)},I.blur=function(e){var o=this.node.runtimeStyle,n=o.filter;return n=n.replace(m,p),0!=+e?(this.attrs.blur=e,o.filter=n+g+" progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+e||1.5)+")",o.margin=t.format("-{0}px 0 0 -{0}px",r(+e||1.5))):(o.filter=n,o.margin=0,delete this.attrs.blur),this},t._engine.path=function(t,e){var o=B("shape");o.style.cssText=v,o.coordsize=_+g+_,o.coordorigin=e.coordorigin;var n=new A(o,e),i={fill:"none",stroke:"#000"};t&&(i.path=t),n.type="path",n.path=[],n.Path=p,C(n,i),e.canvas&&e.canvas.appendChild(o);var r=B("skew");return r.on=!0,o.appendChild(r),n.skew=r,n.transform(p),n},t._engine.rect=function(e,o,n,i,r,s){var a=t._rectPath(o,n,i,r,s),l=e.path(a),c=l.attrs;return l.X=c.x=o,l.Y=c.y=n,l.W=c.width=i,l.H=c.height=r,c.r=s,c.path=a,l.type="rect",l},t._engine.ellipse=function(t,e,o,n,i){var r=t.path();r.attrs;return r.X=e-n,r.Y=o-i,r.W=2*n,r.H=2*i,r.type="ellipse",C(r,{cx:e,cy:o,rx:n,ry:i}),r},t._engine.circle=function(t,e,o,n){var i=t.path();i.attrs;return i.X=e-n,i.Y=o-n,i.W=i.H=2*n,i.type="circle",C(i,{cx:e,cy:o,r:n}),i},t._engine.image=function(e,o,n,i,r,s){var a=t._rectPath(n,i,r,s),l=e.path(a).attr({stroke:"none"}),u=l.attrs,h=l.node,g=h.getElementsByTagName(c)[0];return u.src=o,l.X=u.x=n,l.Y=u.y=i,l.W=u.width=r,l.H=u.height=s,u.path=a,l.type="image",g.parentNode==h&&h.removeChild(g),g.rotate=!0,g.src=o,g.type="tile",l._.fillpos=[n,i],l._.fillsize=[r,s],h.appendChild(g),T(l,1,1,0,0,0),l},t._engine.text=function(e,n,i,s){var a=B("shape"),l=B("path"),c=B("textpath");n=n||0,i=i||0,s=s||"",l.v=t.format("m{0},{1}l{2},{1}",r(n*_),r(i*_),r(n*_)+1),l.textpathok=!0,c.string=o(s),c.on=!0,a.style.cssText=v,a.coordsize=_+g+_,a.coordorigin="0 0";var u=new A(a,e),h={fill:"#000",stroke:"none",font:t._availableAttrs.font,text:s};u.shape=a,u.path=l,u.textpath=c,u.type="text",u.attrs.text=o(s),u.attrs.x=n,u.attrs.y=i,u.attrs.w=1,u.attrs.h=1,C(u,h),a.appendChild(c),a.appendChild(l),e.canvas.appendChild(a);var d=B("skew");return d.on=!0,a.appendChild(d),u.skew=d,u.transform(p),u},t._engine.setSize=function(e,o){var n=this.canvas.style;return this.width=e,this.height=o,e==+e&&(e+="px"),o==+o&&(o+="px"),n.width=e,n.height=o,n.clip="rect(0 "+e+" "+o+" 0)",this._viewBox&&t._engine.setViewBox.apply(this,this._viewBox),this},t._engine.setViewBox=function(e,o,n,i,r){t.eve("raphael.setViewBox",this,this._viewBox,[e,o,n,i,r]);var s,a,l=this.getSize(),c=l.width,u=l.height;return r&&(s=u/i,a=c/n,n*s<c&&(e-=(c-n*s)/2/s),i*a<u&&(o-=(u-i*a)/2/a)),this._viewBox=[e,o,n,i,!!r],this._viewBoxShift={dx:-e,dy:-o,scale:l},this.forEach(function(t){t.transform("...")}),this};var B;t._engine.initWin=function(t){var e=t.document;e.styleSheets.length<31?e.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)"):e.styleSheets[0].addRule(".rvml","behavior:url(#default#VML)");try{!e.namespaces.rvml&&e.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),B=function(t){return e.createElement("<rvml:"+t+' class="rvml">')}}catch(t){B=function(t){return e.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},t._engine.initWin(t._g.win),t._engine.create=function(){var e=t._getContainer.apply(0,arguments),o=e.container,n=e.height,i=e.width,r=e.x,s=e.y;if(!o)throw new Error("VML container not found.");var a=new t._Paper,l=a.canvas=t._g.doc.createElement("div"),c=l.style;return r=r||0,s=s||0,i=i||512,n=n||342,a.width=i,a.height=n,i==+i&&(i+="px"),n==+n&&(n+="px"),a.coordsize=216e5+g+216e5,a.coordorigin="0 0",a.span=t._g.doc.createElement("span"),a.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",l.appendChild(a.span),c.cssText=t.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",i,n),1==o?(t._g.doc.body.appendChild(l),c.left=r+"px",c.top=s+"px",c.position="absolute"):o.firstChild?o.insertBefore(l,o.firstChild):o.appendChild(l),a.renderfix=function(){},a},t.prototype.clear=function(){t.eve("raphael.clear",this),this.canvas.innerHTML=p,this.span=t._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},t.prototype.remove=function(){t.eve("raphael.remove",this),this.canvas.parentNode.removeChild(this.canvas);for(var e in this)this[e]="function"==typeof this[e]?t._removedFactory(e):null;return!0};var M=t.st;for(var L in I)I[e](L)&&!M[e](L)&&(M[L]=function(t){return function(){var e=arguments;return this.forEach(function(o){o[t].apply(o,e)})}}(L))}}.apply(e,n))&&(t.exports=i)}])})}).call(window)}).call(e,o(0))},function(t,e,o){var n,i;(function(){(function(){var r=this,s=r._,a=Array.prototype,l=Object.prototype,c=Function.prototype,u=a.push,h=a.slice,g=a.concat,p=l.toString,d=l.hasOwnProperty,f=Array.isArray,m=Object.keys,y=c.bind,v=function(t){return t instanceof v?t:this instanceof v?void(this._wrapped=t):new v(t)};void 0!==t&&t.exports&&(e=t.exports=v),e._=v,v.VERSION="1.7.0";var _=function(t,e,o){if(void 0===e)return t;switch(null==o?3:o){case 1:return function(o){return t.call(e,o)};case 2:return function(o,n){return t.call(e,o,n)};case 3:return function(o,n,i){return t.call(e,o,n,i)};case 4:return function(o,n,i,r){return t.call(e,o,n,i,r)}}return function(){return t.apply(e,arguments)}};v.iteratee=function(t,e,o){return null==t?v.identity:v.isFunction(t)?_(t,e,o):v.isObject(t)?v.matches(t):v.property(t)},v.each=v.forEach=function(t,e,o){if(null==t)return t;e=_(e,o);var n,i=t.length;if(i===+i)for(n=0;i>n;n++)e(t[n],n,t);else{var r=v.keys(t);for(n=0,i=r.length;i>n;n++)e(t[r[n]],r[n],t)}return t},v.map=v.collect=function(t,e,o){if(null==t)return[];e=v.iteratee(e,o);for(var n,i=t.length!==+t.length&&v.keys(t),r=(i||t).length,s=Array(r),a=0;r>a;a++)n=i?i[a]:a,s[a]=e(t[n],n,t);return s};var b="Reduce of empty array with no initial value";v.reduce=v.foldl=v.inject=function(t,e,o,n){null==t&&(t=[]),e=_(e,n,4);var i,r=t.length!==+t.length&&v.keys(t),s=(r||t).length,a=0;if(arguments.length<3){if(!s)throw new TypeError(b);o=t[r?r[a++]:a++]}for(;s>a;a++)i=r?r[a]:a,o=e(o,t[i],i,t);return o},v.reduceRight=v.foldr=function(t,e,o,n){null==t&&(t=[]),e=_(e,n,4);var i,r=t.length!==+t.length&&v.keys(t),s=(r||t).length;if(arguments.length<3){if(!s)throw new TypeError(b);o=t[r?r[--s]:--s]}for(;s--;)i=r?r[s]:s,o=e(o,t[i],i,t);return o},v.find=v.detect=function(t,e,o){var n;return e=v.iteratee(e,o),v.some(t,function(t,o,i){return e(t,o,i)?(n=t,!0):void 0}),n},v.filter=v.select=function(t,e,o){var n=[];return null==t?n:(e=v.iteratee(e,o),v.each(t,function(t,o,i){e(t,o,i)&&n.push(t)}),n)},v.reject=function(t,e,o){return v.filter(t,v.negate(v.iteratee(e)),o)},v.every=v.all=function(t,e,o){if(null==t)return!0;e=v.iteratee(e,o);var n,i,r=t.length!==+t.length&&v.keys(t),s=(r||t).length;for(n=0;s>n;n++)if(i=r?r[n]:n,!e(t[i],i,t))return!1;return!0},v.some=v.any=function(t,e,o){if(null==t)return!1;e=v.iteratee(e,o);var n,i,r=t.length!==+t.length&&v.keys(t),s=(r||t).length;for(n=0;s>n;n++)if(i=r?r[n]:n,e(t[i],i,t))return!0;return!1},v.contains=v.include=function(t,e){return null!=t&&(t.length!==+t.length&&(t=v.values(t)),v.indexOf(t,e)>=0)},v.invoke=function(t,e){var o=h.call(arguments,2),n=v.isFunction(e);return v.map(t,function(t){return(n?e:t[e]).apply(t,o)})},v.pluck=function(t,e){return v.map(t,v.property(e))},v.where=function(t,e){return v.filter(t,v.matches(e))},v.findWhere=function(t,e){return v.find(t,v.matches(e))},v.max=function(t,e,o){var n,i,r=-1/0,s=-1/0;if(null==e&&null!=t){t=t.length===+t.length?t:v.values(t);for(var a=0,l=t.length;l>a;a++)(n=t[a])>r&&(r=n)}else e=v.iteratee(e,o),v.each(t,function(t,o,n){((i=e(t,o,n))>s||i===-1/0&&r===-1/0)&&(r=t,s=i)});return r},v.min=function(t,e,o){var n,i,r=1/0,s=1/0;if(null==e&&null!=t){t=t.length===+t.length?t:v.values(t);for(var a=0,l=t.length;l>a;a++)n=t[a],r>n&&(r=n)}else e=v.iteratee(e,o),v.each(t,function(t,o,n){i=e(t,o,n),(s>i||1/0===i&&1/0===r)&&(r=t,s=i)});return r},v.shuffle=function(t){for(var e,o=t&&t.length===+t.length?t:v.values(t),n=o.length,i=Array(n),r=0;n>r;r++)e=v.random(0,r),e!==r&&(i[r]=i[e]),i[e]=o[r];return i},v.sample=function(t,e,o){return null==e||o?(t.length!==+t.length&&(t=v.values(t)),t[v.random(t.length-1)]):v.shuffle(t).slice(0,Math.max(0,e))},v.sortBy=function(t,e,o){return e=v.iteratee(e,o),v.pluck(v.map(t,function(t,o,n){return{value:t,index:o,criteria:e(t,o,n)}}).sort(function(t,e){var o=t.criteria,n=e.criteria;if(o!==n){if(o>n||void 0===o)return 1;if(n>o||void 0===n)return-1}return t.index-e.index}),"value")};var E=function(t){return function(e,o,n){var i={};return o=v.iteratee(o,n),v.each(e,function(n,r){var s=o(n,r,e);t(i,n,s)}),i}};v.groupBy=E(function(t,e,o){v.has(t,o)?t[o].push(e):t[o]=[e]}),v.indexBy=E(function(t,e,o){t[o]=e}),v.countBy=E(function(t,e,o){v.has(t,o)?t[o]++:t[o]=1}),v.sortedIndex=function(t,e,o,n){o=v.iteratee(o,n,1);for(var i=o(e),r=0,s=t.length;s>r;){var a=r+s>>>1;o(t[a])<i?r=a+1:s=a}return r},v.toArray=function(t){return t?v.isArray(t)?h.call(t):t.length===+t.length?v.map(t,v.identity):v.values(t):[]},v.size=function(t){return null==t?0:t.length===+t.length?t.length:v.keys(t).length},v.partition=function(t,e,o){e=v.iteratee(e,o);var n=[],i=[];return v.each(t,function(t,o,r){(e(t,o,r)?n:i).push(t)}),[n,i]},v.first=v.head=v.take=function(t,e,o){return null==t?void 0:null==e||o?t[0]:0>e?[]:h.call(t,0,e)},v.initial=function(t,e,o){return h.call(t,0,Math.max(0,t.length-(null==e||o?1:e)))},v.last=function(t,e,o){return null==t?void 0:null==e||o?t[t.length-1]:h.call(t,Math.max(t.length-e,0))},v.rest=v.tail=v.drop=function(t,e,o){return h.call(t,null==e||o?1:e)},v.compact=function(t){return v.filter(t,v.identity)};var x=function(t,e,o,n){if(e&&v.every(t,v.isArray))return g.apply(n,t);for(var i=0,r=t.length;r>i;i++){var s=t[i];v.isArray(s)||v.isArguments(s)?e?u.apply(n,s):x(s,e,o,n):o||n.push(s)}return n};v.flatten=function(t,e){return x(t,e,!1,[])},v.without=function(t){return v.difference(t,h.call(arguments,1))},v.uniq=v.unique=function(t,e,o,n){if(null==t)return[];v.isBoolean(e)||(n=o,o=e,e=!1),null!=o&&(o=v.iteratee(o,n));for(var i=[],r=[],s=0,a=t.length;a>s;s++){var l=t[s];if(e)s&&r===l||i.push(l),r=l;else if(o){var c=o(l,s,t);v.indexOf(r,c)<0&&(r.push(c),i.push(l))}else v.indexOf(i,l)<0&&i.push(l)}return i},v.union=function(){return v.uniq(x(arguments,!0,!0,[]))},v.intersection=function(t){if(null==t)return[];for(var e=[],o=arguments.length,n=0,i=t.length;i>n;n++){var r=t[n];if(!v.contains(e,r)){for(var s=1;o>s&&v.contains(arguments[s],r);s++);s===o&&e.push(r)}}return e},v.difference=function(t){var e=x(h.call(arguments,1),!0,!0,[]);return v.filter(t,function(t){return!v.contains(e,t)})},v.zip=function(t){if(null==t)return[];for(var e=v.max(arguments,"length").length,o=Array(e),n=0;e>n;n++)o[n]=v.pluck(arguments,n);return o},v.object=function(t,e){if(null==t)return{};for(var o={},n=0,i=t.length;i>n;n++)e?o[t[n]]=e[n]:o[t[n][0]]=t[n][1];return o},v.indexOf=function(t,e,o){if(null==t)return-1;var n=0,i=t.length;if(o){if("number"!=typeof o)return n=v.sortedIndex(t,e),t[n]===e?n:-1;n=0>o?Math.max(0,i+o):o}for(;i>n;n++)if(t[n]===e)return n;return-1},v.lastIndexOf=function(t,e,o){if(null==t)return-1;var n=t.length;for("number"==typeof o&&(n=0>o?n+o+1:Math.min(n,o+1));--n>=0;)if(t[n]===e)return n;return-1},v.range=function(t,e,o){arguments.length<=1&&(e=t||0,t=0),o=o||1;for(var n=Math.max(Math.ceil((e-t)/o),0),i=Array(n),r=0;n>r;r++,t+=o)i[r]=t;return i};var S=function(){};v.bind=function(t,e){var o,n;if(y&&t.bind===y)return y.apply(t,h.call(arguments,1));if(!v.isFunction(t))throw new TypeError("Bind must be called on a function");return o=h.call(arguments,2),n=function(){if(!(this instanceof n))return t.apply(e,o.concat(h.call(arguments)));S.prototype=t.prototype;var i=new S;S.prototype=null;var r=t.apply(i,o.concat(h.call(arguments)));return v.isObject(r)?r:i}},v.partial=function(t){var e=h.call(arguments,1);return function(){for(var o=0,n=e.slice(),i=0,r=n.length;r>i;i++)n[i]===v&&(n[i]=arguments[o++]);for(;o<arguments.length;)n.push(arguments[o++]);return t.apply(this,n)}},v.bindAll=function(t){var e,o,n=arguments.length;if(1>=n)throw new Error("bindAll must be passed function names");for(e=1;n>e;e++)o=arguments[e],t[o]=v.bind(t[o],t);return t},v.memoize=function(t,e){var o=function(n){var i=o.cache,r=e?e.apply(this,arguments):n;return v.has(i,r)||(i[r]=t.apply(this,arguments)),i[r]};return o.cache={},o},v.delay=function(t,e){var o=h.call(arguments,2);return setTimeout(function(){return t.apply(null,o)},e)},v.defer=function(t){return v.delay.apply(v,[t,1].concat(h.call(arguments,1)))},v.throttle=function(t,e,o){var n,i,r,s=null,a=0;o||(o={});var l=function(){a=!1===o.leading?0:v.now(),s=null,r=t.apply(n,i),s||(n=i=null)};return function(){var c=v.now();a||!1!==o.leading||(a=c);var u=e-(c-a);return n=this,i=arguments,0>=u||u>e?(clearTimeout(s),s=null,a=c,r=t.apply(n,i),s||(n=i=null)):s||!1===o.trailing||(s=setTimeout(l,u)),r}},v.debounce=function(t,e,o){var n,i,r,s,a,l=function(){var c=v.now()-s;e>c&&c>0?n=setTimeout(l,e-c):(n=null,o||(a=t.apply(r,i),n||(r=i=null)))};return function(){r=this,i=arguments,s=v.now();var c=o&&!n;return n||(n=setTimeout(l,e)),c&&(a=t.apply(r,i),r=i=null),a}},v.wrap=function(t,e){return v.partial(e,t)},v.negate=function(t){return function(){return!t.apply(this,arguments)}},v.compose=function(){var t=arguments,e=t.length-1;return function(){for(var o=e,n=t[e].apply(this,arguments);o--;)n=t[o].call(this,n);return n}},v.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},v.before=function(t,e){var o;return function(){return--t>0?o=e.apply(this,arguments):e=null,o}},v.once=v.partial(v.before,2),v.keys=function(t){if(!v.isObject(t))return[];if(m)return m(t);var e=[];for(var o in t)v.has(t,o)&&e.push(o);return e},v.values=function(t){for(var e=v.keys(t),o=e.length,n=Array(o),i=0;o>i;i++)n[i]=t[e[i]];return n},v.pairs=function(t){for(var e=v.keys(t),o=e.length,n=Array(o),i=0;o>i;i++)n[i]=[e[i],t[e[i]]];return n},v.invert=function(t){for(var e={},o=v.keys(t),n=0,i=o.length;i>n;n++)e[t[o[n]]]=o[n];return e},v.functions=v.methods=function(t){var e=[];for(var o in t)v.isFunction(t[o])&&e.push(o);return e.sort()},v.extend=function(t){if(!v.isObject(t))return t;for(var e,o,n=1,i=arguments.length;i>n;n++){e=arguments[n];for(o in e)d.call(e,o)&&(t[o]=e[o])}return t},v.pick=function(t,e,o){var n,i={};if(null==t)return i;if(v.isFunction(e)){e=_(e,o);for(n in t){var r=t[n];e(r,n,t)&&(i[n]=r)}}else{var s=g.apply([],h.call(arguments,1));t=new Object(t);for(var a=0,l=s.length;l>a;a++)(n=s[a])in t&&(i[n]=t[n])}return i},v.omit=function(t,e,o){if(v.isFunction(e))e=v.negate(e);else{var n=v.map(g.apply([],h.call(arguments,1)),String);e=function(t,e){return!v.contains(n,e)}}return v.pick(t,e,o)},v.defaults=function(t){if(!v.isObject(t))return t;for(var e=1,o=arguments.length;o>e;e++){var n=arguments[e];for(var i in n)void 0===t[i]&&(t[i]=n[i])}return t},v.clone=function(t){return v.isObject(t)?v.isArray(t)?t.slice():v.extend({},t):t},v.tap=function(t,e){return e(t),t};var T=function(t,e,o,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof v&&(t=t._wrapped),e instanceof v&&(e=e._wrapped);var i=p.call(t);if(i!==p.call(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e}if("object"!=typeof t||"object"!=typeof e)return!1;for(var r=o.length;r--;)if(o[r]===t)return n[r]===e;var s=t.constructor,a=e.constructor;if(s!==a&&"constructor"in t&&"constructor"in e&&!(v.isFunction(s)&&s instanceof s&&v.isFunction(a)&&a instanceof a))return!1;o.push(t),n.push(e);var l,c;if("[object Array]"===i){if(l=t.length,c=l===e.length)for(;l--&&(c=T(t[l],e[l],o,n)););}else{var u,h=v.keys(t);if(l=h.length,c=v.keys(e).length===l)for(;l--&&(u=h[l],c=v.has(e,u)&&T(t[u],e[u],o,n)););}return o.pop(),n.pop(),c};v.isEqual=function(t,e){return T(t,e,[],[])},v.isEmpty=function(t){if(null==t)return!0;if(v.isArray(t)||v.isString(t)||v.isArguments(t))return 0===t.length;for(var e in t)if(v.has(t,e))return!1;return!0},v.isElement=function(t){return!(!t||1!==t.nodeType)},v.isArray=f||function(t){return"[object Array]"===p.call(t)},v.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},v.each(["Arguments","Function","String","Number","Date","RegExp"],function(t){v["is"+t]=function(e){return p.call(e)==="[object "+t+"]"}}),v.isArguments(arguments)||(v.isArguments=function(t){return v.has(t,"callee")}),"function"!=typeof/./&&(v.isFunction=function(t){return"function"==typeof t||!1}),v.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},v.isNaN=function(t){return v.isNumber(t)&&t!==+t},v.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===p.call(t)},v.isNull=function(t){return null===t},v.isUndefined=function(t){return void 0===t},v.has=function(t,e){return null!=t&&d.call(t,e)},v.noConflict=function(){return r._=s,this},v.identity=function(t){return t},v.constant=function(t){return function(){return t}},v.noop=function(){},v.property=function(t){return function(e){return e[t]}},v.matches=function(t){var e=v.pairs(t),o=e.length;return function(t){if(null==t)return!o;t=new Object(t);for(var n=0;o>n;n++){var i=e[n],r=i[0];if(i[1]!==t[r]||!(r in t))return!1}return!0}},v.times=function(t,e,o){var n=Array(Math.max(0,t));e=_(e,o,1);for(var i=0;t>i;i++)n[i]=e(i);return n},v.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},v.now=Date.now||function(){return(new Date).getTime()};var w={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},C=v.invert(w),k=function(t){var e=function(e){return t[e]},o="(?:"+v.keys(t).join("|")+")",n=RegExp(o),i=RegExp(o,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(i,e):t}};v.escape=k(w),v.unescape=k(C),v.result=function(t,e){if(null!=t){var o=t[e];return v.isFunction(o)?t[e]():o}};var A=0;v.uniqueId=function(t){var e=++A+"";return t?t+e:e},v.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var I=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},M=/\\|'|\r|\n|\u2028|\u2029/g,L=function(t){return"\\"+B[t]};v.template=function(t,e,o){!e&&o&&(e=o),e=v.defaults({},e,v.templateSettings);var n=RegExp([(e.escape||I).source,(e.interpolate||I).source,(e.evaluate||I).source].join("|")+"|$","g"),i=0,r="__p+='";t.replace(n,function(e,o,n,s,a){return r+=t.slice(i,a).replace(M,L),i=a+e.length,o?r+="'+\n((__t=("+o+"))==null?'':_.escape(__t))+\n'":n?r+="'+\n((__t=("+n+"))==null?'':__t)+\n'":s&&(r+="';\n"+s+"\n__p+='"),e}),r+="';\n",e.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{var s=new Function(e.variable||"obj","_",r)}catch(t){throw t.source=r,t}var a=function(t){return s.call(this,t,v)};return a.source="function("+(e.variable||"obj")+"){\n"+r+"}",a},v.chain=function(t){var e=v(t);return e._chain=!0,e};var N=function(t){return this._chain?v(t).chain():t};v.mixin=function(t){v.each(v.functions(t),function(e){var o=v[e]=t[e];v.prototype[e]=function(){var t=[this._wrapped];return u.apply(t,arguments),N.call(this,o.apply(v,t))}})},v.mixin(v),v.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=a[t];v.prototype[t]=function(){var o=this._wrapped;return e.apply(o,arguments),"shift"!==t&&"splice"!==t||0!==o.length||delete o[0],N.call(this,o)}}),v.each(["concat","join","slice"],function(t){var e=a[t];v.prototype[t]=function(){return N.call(this,e.apply(this._wrapped,arguments))}}),v.prototype.value=function(){return this._wrapped},o(1)&&(n=[],void 0!==(i=function(){return v}.apply(e,n))&&(t.exports=i))}).call(this)}).call(window)},function(t,e,o){(function(t){(function(){!function(e,o,n){e.spinner=function(e,n,i){var r='<div class="circuits_spinner"><div class="circuits_spinner__bounce1"></div><div class="circuits_spinner__bounce2"></div><div class="circuits_spinner__bounce3"></div></div>';t?(e=o(e),e.html(r),n&&o(".circuits_spinner > div",e).css("background-color",n),i&&(o(".circuits_spinner > div",e).css("width",i),o(".circuits_spinner > div",e).css("height",i))):e.innerHTML=r}}(window.cSite=window.cSite||{},t)}).call(window)}).call(e,o(0))},function(module,exports){(function(){var goog=window.goog,$jscomp=$jscomp||{};$jscomp.scope={};var COMPILED=!0,goog=goog||{};goog.global=this,goog.isDef=function(t){return void 0!==t},goog.isString=function(t){return"string"==typeof t},goog.isBoolean=function(t){return"boolean"==typeof t},goog.isNumber=function(t){return"number"==typeof t},goog.exportPath_=function(t,e,o){t=t.split("."),o=o||goog.global,t[0]in o||!o.execScript||o.execScript("var "+t[0]);for(var n;t.length&&(n=t.shift());)!t.length&&goog.isDef(e)?o[n]=e:o=o[n]&&o[n]!==Object.prototype[n]?o[n]:o[n]={}},goog.define=function(t,e){var o=e;COMPILED||(goog.global.CLOSURE_UNCOMPILED_DEFINES&&void 0===goog.global.CLOSURE_UNCOMPILED_DEFINES.nodeType&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_UNCOMPILED_DEFINES,t)?o=goog.global.CLOSURE_UNCOMPILED_DEFINES[t]:goog.global.CLOSURE_DEFINES&&void 0===goog.global.CLOSURE_DEFINES.nodeType&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES,t)&&(o=goog.global.CLOSURE_DEFINES[t])),goog.exportPath_(t,o)},goog.DEBUG=!1,goog.LOCALE="en",goog.TRUSTED_SITE=!0,goog.STRICT_MODE_COMPATIBLE=!1,goog.DISALLOW_TEST_ONLY_CODE=COMPILED&&!goog.DEBUG,goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=!1,goog.provide=function(t){if(goog.isInModuleLoader_())throw Error("goog.provide can not be used within a goog.module.");if(!COMPILED&&goog.isProvided_(t))throw Error('Namespace "'+t+'" already declared.');goog.constructNamespace_(t)},goog.constructNamespace_=function(t,e){if(!COMPILED){delete goog.implicitNamespaces_[t];for(var o=t;(o=o.substring(0,o.lastIndexOf(".")))&&!goog.getObjectByName(o);)goog.implicitNamespaces_[o]=!0}goog.exportPath_(t,e)},goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/,goog.module=function(t){if(!goog.isString(t)||!t||-1==t.search(goog.VALID_MODULE_RE_))throw Error("Invalid module identifier");if(!goog.isInModuleLoader_())throw Error("Module "+t+" has been loaded incorrectly. Note, modules cannot be loaded as normal scripts. They require some kind of pre-processing step. You're likely trying to load a module via a script tag or as a part of a concatenated bundle without rewriting the module. For more info see: https://github.com/google/closure-library/wiki/goog.module:-an-ES6-module-like-alternative-to-goog.provide.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");if(goog.moduleLoaderState_.moduleName=t,!COMPILED){if(goog.isProvided_(t))throw Error('Namespace "'+t+'" already declared.');delete goog.implicitNamespaces_[t]}},goog.module.get=function(t){return goog.module.getInternal_(t)},goog.module.getInternal_=function(t){if(!COMPILED){if(t in goog.loadedModules_)return goog.loadedModules_[t];if(!goog.implicitNamespaces_[t])return t=goog.getObjectByName(t),null!=t?t:null}return null},goog.moduleLoaderState_=null,goog.isInModuleLoader_=function(){return null!=goog.moduleLoaderState_},goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInModuleLoader_())throw Error("goog.module.declareLegacyNamespace must be called from within a goog.module");if(!COMPILED&&!goog.moduleLoaderState_.moduleName)throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.");goog.moduleLoaderState_.declareLegacyNamespace=!0},goog.setTestOnly=function(t){if(goog.DISALLOW_TEST_ONLY_CODE)throw t=t||"",Error("Importing test-only code into non-debug environment"+(t?": "+t:"."))},goog.forwardDeclare=function(t){},COMPILED||(goog.isProvided_=function(t){return t in goog.loadedModules_||!goog.implicitNamespaces_[t]&&goog.isDefAndNotNull(goog.getObjectByName(t))},goog.implicitNamespaces_={"goog.module":!0}),goog.getObjectByName=function(t,e){for(var o,n=t.split("."),i=e||goog.global;o=n.shift();){if(!goog.isDefAndNotNull(i[o]))return null;i=i[o]}return i},goog.globalize=function(t,e){var o,n=e||goog.global;for(o in t)n[o]=t[o]},goog.addDependency=function(t,e,o,n){if(goog.DEPENDENCIES_ENABLED){var i;t=t.replace(/\\/g,"/");var r=goog.dependencies_;n&&"boolean"!=typeof n||(n=n?{module:"goog"}:{});for(var s=0;i=e[s];s++)r.nameToPath[i]=t,r.loadFlags[t]=n;for(n=0;e=o[n];n++)t in r.requires||(r.requires[t]={}),r.requires[t][e]=!0}},goog.ENABLE_DEBUG_LOADER=!0,goog.logToConsole_=function(t){goog.global.console&&goog.global.console.error(t)},goog.require=function(t){if(!COMPILED){if(goog.ENABLE_DEBUG_LOADER&&goog.IS_OLD_IE_&&goog.maybeProcessDeferredDep_(t),goog.isProvided_(t)){if(goog.isInModuleLoader_())return goog.module.getInternal_(t)}else if(goog.ENABLE_DEBUG_LOADER){var e=goog.getPathFromDeps_(t);if(!e)throw t="goog.require could not find: "+t,goog.logToConsole_(t),Error(t);goog.writeScripts_(e)}return null}},goog.basePath="",goog.nullFunction=function(){},goog.abstractMethod=function(){throw Error("unimplemented abstract method")},goog.addSingletonGetter=function(t){t.instance_=void 0,t.getInstance=function(){return t.instance_?t.instance_:(goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=t),t.instance_=new t)}},goog.instantiatedSingletons_=[],goog.LOAD_MODULE_USING_EVAL=!0,goog.SEAL_MODULE_EXPORTS=goog.DEBUG,goog.loadedModules_={},goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER,goog.TRANSPILE="detect",goog.TRANSPILER="transpile.js",goog.DEPENDENCIES_ENABLED&&(goog.dependencies_={loadFlags:{},nameToPath:{},requires:{},visited:{},written:{},deferred:{}},goog.inHtmlDocument_=function(){var t=goog.global.document;return null!=t&&"write"in t},goog.findBasePath_=function(){if(goog.isDef(goog.global.CLOSURE_BASE_PATH)&&goog.isString(goog.global.CLOSURE_BASE_PATH))goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_()){var t=goog.global.document,e=t.currentScript;for(t=e?[e]:t.getElementsByTagName("SCRIPT"),e=t.length-1;0<=e;--e){var o=t[e].src,n=o.lastIndexOf("?");if(n=-1==n?o.length:n,"base.js"==o.substr(n-7,7)){goog.basePath=o.substr(0,n-7);break}}}},goog.importScript_=function(t,e){(goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_)(t,e)&&(goog.dependencies_.written[t]=!0)},goog.IS_OLD_IE_=!(goog.global.atob||!goog.global.document||!goog.global.document.all),goog.oldIeWaiting_=!1,goog.importProcessedScript_=function(t,e,o){goog.importScript_("",'goog.retrieveAndExec_("'+t+'", '+e+", "+o+");")},goog.queuedModules_=[],goog.wrapModule_=function(t,e){return goog.LOAD_MODULE_USING_EVAL&&goog.isDef(goog.global.JSON)?"goog.loadModule("+goog.global.JSON.stringify(e+"\n//# sourceURL="+t+"\n")+");":'goog.loadModule(function(exports) {"use strict";'+e+"\n;return exports});\n//# sourceURL="+t+"\n"},goog.loadQueuedModules_=function(){var t=goog.queuedModules_.length;if(0<t){var e=goog.queuedModules_;goog.queuedModules_=[];for(var o=0;o<t;o++)goog.maybeProcessDeferredPath_(e[o])}goog.oldIeWaiting_=!1},goog.maybeProcessDeferredDep_=function(t){goog.isDeferredModule_(t)&&goog.allDepsAreAvailable_(t)&&(t=goog.getPathFromDeps_(t),goog.maybeProcessDeferredPath_(goog.basePath+t))},goog.isDeferredModule_=function(t){var e=(t=goog.getPathFromDeps_(t))&&goog.dependencies_.loadFlags[t]||{},o=e.lang||"es3";return!(!t||"goog"!=e.module&&!goog.needsTranspile_(o))&&goog.basePath+t in goog.dependencies_.deferred},goog.allDepsAreAvailable_=function(t){if((t=goog.getPathFromDeps_(t))&&t in goog.dependencies_.requires)for(var e in goog.dependencies_.requires[t])if(!goog.isProvided_(e)&&!goog.isDeferredModule_(e))return!1;return!0},goog.maybeProcessDeferredPath_=function(t){if(t in goog.dependencies_.deferred){var e=goog.dependencies_.deferred[t];delete goog.dependencies_.deferred[t],goog.globalEval(e)}},goog.loadModuleFromUrl=function(t){goog.retrieveAndExec_(t,!0,!1)},goog.writeScriptSrcNode_=function(t){goog.global.document.write('<script type="text/javascript" src="'+t+'"><\/script>')},goog.appendScriptSrcNode_=function(t){var e=goog.global.document,o=e.createElement("script");o.type="text/javascript",o.src=t,o.defer=!1,o.async=!1,e.head.appendChild(o)},goog.writeScriptTag_=function(t,e){if(goog.inHtmlDocument_()){var o=goog.global.document;if(!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING&&"complete"==o.readyState){if(/\bdeps.js$/.test(t))return!1;throw Error('Cannot write "'+t+'" after document load')}if(void 0===e)if(goog.IS_OLD_IE_){goog.oldIeWaiting_=!0;var n=" onreadystatechange='goog.onScriptLoad_(this, "+ ++goog.lastNonModuleScriptIndex_+")' ";o.write('<script type="text/javascript" src="'+t+'"'+n+"><\/script>")}else goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING?goog.appendScriptSrcNode_(t):goog.writeScriptSrcNode_(t);else o.write('<script type="text/javascript">'+goog.protectScriptTag_(e)+"<\/script>");return!0}return!1},goog.protectScriptTag_=function(t){return t.replace(/<\/(SCRIPT)/gi,"\\x3c/$1")},goog.needsTranspile_=function(t){if("always"==goog.TRANSPILE)return!0;if("never"==goog.TRANSPILE)return!1;if(goog.requiresTranspilation_||(goog.requiresTranspilation_=goog.createRequiresTranspilation_()),t in goog.requiresTranspilation_)return goog.requiresTranspilation_[t];throw Error("Unknown language mode: "+t)},goog.requiresTranspilation_=null,goog.lastNonModuleScriptIndex_=0,goog.onScriptLoad_=function(t,e){return"complete"==t.readyState&&goog.lastNonModuleScriptIndex_==e&&goog.loadQueuedModules_(),!0},goog.writeScripts_=function(t){function e(t){if(!(t in i.written||t in i.visited)){if(i.visited[t]=!0,t in i.requires)for(var r in i.requires[t])if(!goog.isProvided_(r)){if(!(r in i.nameToPath))throw Error("Undefined nameToPath for "+r);e(i.nameToPath[r])}t in n||(n[t]=!0,o.push(t))}}var o=[],n={},i=goog.dependencies_;e(t);for(var r=0;r<o.length;r++)t=o[r],goog.dependencies_.written[t]=!0;var s=goog.moduleLoaderState_;for(goog.moduleLoaderState_=null,r=0;r<o.length;r++){if(!(t=o[r]))throw goog.moduleLoaderState_=s,Error("Undefined script input");var a=i.loadFlags[t]||{},l=goog.needsTranspile_(a.lang||"es3");"goog"==a.module||l?goog.importProcessedScript_(goog.basePath+t,"goog"==a.module,l):goog.importScript_(goog.basePath+t)}goog.moduleLoaderState_=s},goog.getPathFromDeps_=function(t){return t in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[t]:null},goog.findBasePath_(),goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js")),goog.hasBadLetScoping=null,goog.useSafari10Workaround=function(){if(null==goog.hasBadLetScoping){try{var a=!eval('"use strict";let x = 1; function f() { return typeof x; };f() == "number";')}catch(t){a=!1}goog.hasBadLetScoping=a}return goog.hasBadLetScoping},goog.workaroundSafari10EvalBug=function(t){return"(function(){"+t+"\n;})();\n"},goog.loadModule=function(t){var e=goog.moduleLoaderState_;try{if(goog.moduleLoaderState_={moduleName:void 0,declareLegacyNamespace:!1},goog.isFunction(t))var o=t.call(void 0,{});else{if(!goog.isString(t))throw Error("Invalid module definition");goog.useSafari10Workaround()&&(t=goog.workaroundSafari10EvalBug(t)),o=goog.loadModuleFromSource_.call(void 0,t)}var n=goog.moduleLoaderState_.moduleName;if(!goog.isString(n)||!n)throw Error('Invalid module name "'+n+'"');goog.moduleLoaderState_.declareLegacyNamespace?goog.constructNamespace_(n,o):goog.SEAL_MODULE_EXPORTS&&Object.seal&&"object"==typeof o&&null!=o&&Object.seal(o),goog.loadedModules_[n]=o}finally{goog.moduleLoaderState_=e}},goog.loadModuleFromSource_=function(a){return eval(a),{}},goog.normalizePath_=function(t){t=t.split("/");for(var e=0;e<t.length;)"."==t[e]?t.splice(e,1):e&&".."==t[e]&&t[e-1]&&".."!=t[e-1]?t.splice(--e,2):e++;return t.join("/")},goog.loadFileSync_=function(t){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(t);try{var e=new goog.global.XMLHttpRequest;return e.open("get",t,!1),e.send(),0==e.status||200==e.status?e.responseText:null}catch(t){return null}},goog.retrieveAndExec_=function(t,e,o){if(!COMPILED){var n=t;t=goog.normalizePath_(t);var i=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_,r=goog.loadFileSync_(t);if(null==r)throw Error('Load of "'+t+'" failed');o&&(r=goog.transpile_.call(goog.global,r,t)),r=e?goog.wrapModule_(t,r):r+"\n//# sourceURL="+t,goog.IS_OLD_IE_&&goog.oldIeWaiting_?(goog.dependencies_.deferred[n]=r,goog.queuedModules_.push(n)):i(t,r)}},goog.transpile_=function(a,b){var c=goog.global.$jscomp;c||(goog.global.$jscomp=c={});var d=c.transpile;if(!d){var e=goog.basePath+goog.TRANSPILER,f=goog.loadFileSync_(e);if(f){if(eval(f+"\n//# sourceURL="+e),goog.global.$gwtExport&&goog.global.$gwtExport.$jscomp&&!goog.global.$gwtExport.$jscomp.transpile)throw Error('The transpiler did not properly export the "transpile" method. $gwtExport: '+JSON.stringify(goog.global.$gwtExport));goog.global.$jscomp.transpile=goog.global.$gwtExport.$jscomp.transpile,c=goog.global.$jscomp,d=c.transpile}}return d||(d=c.transpile=function(t,e){return goog.logToConsole_(e+" requires transpilation but no transpiler was found."),t}),d(a,b)},goog.typeOf=function(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var o=Object.prototype.toString.call(t);if("[object Window]"==o)return"object";if("[object Array]"==o||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==o||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e},goog.isNull=function(t){return null===t},goog.isDefAndNotNull=function(t){return null!=t},goog.isArray=function(t){return"array"==goog.typeOf(t)},goog.isArrayLike=function(t){var e=goog.typeOf(t);return"array"==e||"object"==e&&"number"==typeof t.length},goog.isDateLike=function(t){return goog.isObject(t)&&"function"==typeof t.getFullYear},goog.isFunction=function(t){return"function"==goog.typeOf(t)},goog.isObject=function(t){var e=typeof t;return"object"==e&&null!=t||"function"==e},goog.getUid=function(t){return t[goog.UID_PROPERTY_]||(t[goog.UID_PROPERTY_]=++goog.uidCounter_)},goog.hasUid=function(t){return!!t[goog.UID_PROPERTY_]},goog.removeUid=function(t){null!==t&&"removeAttribute"in t&&t.removeAttribute(goog.UID_PROPERTY_);try{delete t[goog.UID_PROPERTY_]}catch(t){}},goog.UID_PROPERTY_="closure_uid_"+(1e9*Math.random()>>>0),goog.uidCounter_=0,goog.getHashCode=goog.getUid,goog.removeHashCode=goog.removeUid,goog.cloneObject=function(t){var e=goog.typeOf(t);if("object"==e||"array"==e){if(t.clone)return t.clone();e="array"==e?[]:{};for(var o in t)e[o]=goog.cloneObject(t[o]);return e}return t},goog.bindNative_=function(t,e,o){return t.call.apply(t.bind,arguments)},goog.bindJs_=function(t,e,o){if(!t)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var o=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(o,n),t.apply(e,o)}}return function(){return t.apply(e,arguments)}},goog.bind=function(t,e,o){return Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_,goog.bind.apply(null,arguments)},goog.partial=function(t,e){var o=Array.prototype.slice.call(arguments,1);return function(){var e=o.slice();return e.push.apply(e,arguments),t.apply(this,e)}},goog.mixin=function(t,e){for(var o in e)t[o]=e[o]},goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date},goog.globalEval=function(t){if(goog.global.execScript)goog.global.execScript(t,"JavaScript");else{if(!goog.global.eval)throw Error("goog.globalEval not available");if(null==goog.evalWorksForGlobals_)if(goog.global.eval("var _evalTest_ = 1;"),void 0!==goog.global._evalTest_){try{delete goog.global._evalTest_}catch(t){}goog.evalWorksForGlobals_=!0}else goog.evalWorksForGlobals_=!1;if(goog.evalWorksForGlobals_)goog.global.eval(t);else{var e=goog.global.document,o=e.createElement("SCRIPT");o.type="text/javascript",o.defer=!1,o.appendChild(e.createTextNode(t)),e.body.appendChild(o),e.body.removeChild(o)}}},goog.evalWorksForGlobals_=null,goog.getCssName=function(t,e){if("."==String(t).charAt(0))throw Error('className passed in goog.getCssName must not start with ".". You passed: '+t);var o=function(t){return goog.cssNameMapping_[t]||t},n=function(t){t=t.split("-");for(var e=[],n=0;n<t.length;n++)e.push(o(t[n]));return e.join("-")};return n=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?o:n:function(t){return t},n=e?t+"-"+n(e):n(t),goog.global.CLOSURE_CSS_NAME_MAP_FN?goog.global.CLOSURE_CSS_NAME_MAP_FN(n):n},goog.setCssNameMapping=function(t,e){goog.cssNameMapping_=t,goog.cssNameMappingStyle_=e},!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING),goog.getMsg=function(t,e){return e&&(t=t.replace(/\{\$([^}]+)}/g,function(t,o){return null!=e&&o in e?e[o]:t})),t},goog.getMsgWithFallback=function(t,e){return t},goog.exportSymbol=function(t,e,o){goog.exportPath_(t,e,o)},goog.exportProperty=function(t,e,o){t[e]=o},goog.inherits=function(t,e){function o(){}o.prototype=e.prototype,t.superClass_=e.prototype,t.prototype=new o,t.prototype.constructor=t,t.base=function(t,o,n){for(var i=Array(arguments.length-2),r=2;r<arguments.length;r++)i[r-2]=arguments[r];return e.prototype[o].apply(t,i)}},goog.base=function(t,e,o){var n=arguments.callee.caller;if(goog.STRICT_MODE_COMPATIBLE||goog.DEBUG&&!n)throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(n.superClass_){for(var i=Array(arguments.length-1),r=1;r<arguments.length;r++)i[r-1]=arguments[r];return n.superClass_.constructor.apply(t,i)}for(i=Array(arguments.length-2),r=2;r<arguments.length;r++)i[r-2]=arguments[r];r=!1;for(var s=t.constructor;s;s=s.superClass_&&s.superClass_.constructor)if(s.prototype[e]===n)r=!0;else if(r)return s.prototype[e].apply(t,i);if(t[e]===n)return t.constructor.prototype[e].apply(t,i);throw Error("goog.base called from a method of one name to a method of a different name")},goog.scope=function(t){if(goog.isInModuleLoader_())throw Error("goog.scope is not supported within a goog.module.");t.call(goog.global)},COMPILED||(goog.global.COMPILED=COMPILED),goog.defineClass=function(t,e){var o=e.constructor,n=e.statics;return o&&o!=Object.prototype.constructor||(o=function(){throw Error("cannot instantiate an interface (no constructor defined).")}),o=goog.defineClass.createSealingConstructor_(o,t),t&&goog.inherits(o,t),delete e.constructor,delete e.statics,goog.defineClass.applyProperties_(o.prototype,e),null!=n&&(n instanceof Function?n(o):goog.defineClass.applyProperties_(o,n)),o},goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG,goog.defineClass.createSealingConstructor_=function(t,e){if(!goog.defineClass.SEAL_CLASS_INSTANCES)return t;var o=!goog.defineClass.isUnsealable_(e),n=function(){var e=t.apply(this,arguments)||this;return e[goog.UID_PROPERTY_]=e[goog.UID_PROPERTY_],this.constructor===n&&o&&Object.seal instanceof Function&&Object.seal(e),e};return n},goog.defineClass.isUnsealable_=function(t){return t&&t.prototype&&t.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]},goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),goog.defineClass.applyProperties_=function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);for(var n=0;n<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;n++)o=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[n],Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},goog.tagUnsealableClass=function(t){!COMPILED&&goog.defineClass.SEAL_CLASS_INSTANCES&&(t.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]=!0)},goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_="goog_defineClass_legacy_unsealable",goog.createRequiresTranspilation_=function(){function a(t,e){d?c[t]=!0:e()?c[t]=!1:d=c[t]=!0}function b(a){try{return!!eval(a)}catch(t){return!1}}var c={es3:!1},d=!1,e=goog.global.navigator&&goog.global.navigator.userAgent?goog.global.navigator.userAgent:"";return a("es5",function(){return b("[1,].length==1")}),a("es6",function(){var t=e.match(/Edge\/(\d+)(\.\d)*/i);return!(t&&15>Number(t[1]))&&b('(()=>{"use strict";class X{constructor(){if(new.target!=String)throw 1;this.x=42}}let q=Reflect.construct(X,[],String);if(q.x!=42||!(q instanceof String))throw 1;for(const a of[2,3]){if(a==2)continue;function f(z={a}){let a=0;return z.a}{function f(){return 0;}}return f()==3}})()')}),a("es6-impl",function(){return!0}),a("es7",function(){return b("2 ** 2 == 4")}),a("es8",function(){return b("async () => 1, true")}),c},goog.debug={},goog.debug.Error=function(t){if(Error.captureStackTrace)Error.captureStackTrace(this,goog.debug.Error);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t)),this.reportErrorToServer=!0},goog.inherits(goog.debug.Error,Error),goog.debug.Error.prototype.name="CustomError",goog.dom={},goog.dom.NodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12},goog.string={},goog.string.DETECT_DOUBLE_ESCAPING=!1,goog.string.FORCE_NON_DOM_HTML_UNESCAPING=!1,goog.string.Unicode={NBSP:""},goog.string.startsWith=function(t,e){return 0==t.lastIndexOf(e,0)},goog.string.endsWith=function(t,e){var o=t.length-e.length;return 0<=o&&t.indexOf(e,o)==o},goog.string.caseInsensitiveStartsWith=function(t,e){return 0==goog.string.caseInsensitiveCompare(e,t.substr(0,e.length))},goog.string.caseInsensitiveEndsWith=function(t,e){return 0==goog.string.caseInsensitiveCompare(e,t.substr(t.length-e.length,e.length))},goog.string.caseInsensitiveEquals=function(t,e){return t.toLowerCase()==e.toLowerCase()},goog.string.subs=function(t,e){for(var o=t.split("%s"),n="",i=Array.prototype.slice.call(arguments,1);i.length&&1<o.length;)n+=o.shift()+i.shift();return n+o.join("%s")},goog.string.collapseWhitespace=function(t){return t.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")},goog.string.isEmptyOrWhitespace=function(t){return/^[\s\xa0]*$/.test(t)},goog.string.isEmptyString=function(t){return 0==t.length},goog.string.isEmpty=goog.string.isEmptyOrWhitespace,goog.string.isEmptyOrWhitespaceSafe=function(t){return goog.string.isEmptyOrWhitespace(goog.string.makeSafe(t))},goog.string.isEmptySafe=goog.string.isEmptyOrWhitespaceSafe,goog.string.isBreakingWhitespace=function(t){return!/[^\t\n\r ]/.test(t)},goog.string.isAlpha=function(t){return!/[^a-zA-Z]/.test(t)},goog.string.isNumeric=function(t){return!/[^0-9]/.test(t)},goog.string.isAlphaNumeric=function(t){return!/[^a-zA-Z0-9]/.test(t)},goog.string.isSpace=function(t){return" "==t},goog.string.isUnicodeChar=function(t){return 1==t.length&&" "<=t&&"~">=t||""<=t&&"">=t},goog.string.stripNewlines=function(t){return t.replace(/(\r\n|\r|\n)+/g," ")},goog.string.canonicalizeNewlines=function(t){return t.replace(/(\r\n|\r|\n)/g,"\n")},goog.string.normalizeWhitespace=function(t){return t.replace(/\xa0|\s/g," ")},goog.string.normalizeSpaces=function(t){return t.replace(/\xa0|[ \t]+/g," ")},goog.string.collapseBreakingSpaces=function(t){return t.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")},goog.string.trim=goog.TRUSTED_SITE&&String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},goog.string.trimLeft=function(t){return t.replace(/^[\s\xa0]+/,"")},goog.string.trimRight=function(t){return t.replace(/[\s\xa0]+$/,"")},goog.string.caseInsensitiveCompare=function(t,e){var o=String(t).toLowerCase(),n=String(e).toLowerCase();return o<n?-1:o==n?0:1},goog.string.numberAwareCompare_=function(t,e,o){if(t==e)return 0;if(!t)return-1;if(!e)return 1;for(var n=t.toLowerCase().match(o),i=e.toLowerCase().match(o),r=Math.min(n.length,i.length),s=0;s<r;s++){o=n[s];var a=i[s];if(o!=a)return t=parseInt(o,10),!isNaN(t)&&(e=parseInt(a,10),!isNaN(e)&&t-e)?t-e:o<a?-1:1}return n.length!=i.length?n.length-i.length:t<e?-1:1},goog.string.intAwareCompare=function(t,e){return goog.string.numberAwareCompare_(t,e,/\d+|\D+/g)},goog.string.floatAwareCompare=function(t,e){return goog.string.numberAwareCompare_(t,e,/\d+|\.\d+|\D+/g)},goog.string.numerateCompare=goog.string.floatAwareCompare,goog.string.urlEncode=function(t){return encodeURIComponent(String(t))},goog.string.urlDecode=function(t){return decodeURIComponent(t.replace(/\+/g," "))},goog.string.newLineToBr=function(t,e){return t.replace(/(\r\n|\r|\n)/g,e?"<br />":"<br>")},goog.string.htmlEscape=function(t,e){if(e)t=t.replace(goog.string.AMP_RE_,"&amp;").replace(goog.string.LT_RE_,"&lt;").replace(goog.string.GT_RE_,"&gt;").replace(goog.string.QUOT_RE_,"&quot;").replace(goog.string.SINGLE_QUOTE_RE_,"&#39;").replace(goog.string.NULL_RE_,"&#0;"),goog.string.DETECT_DOUBLE_ESCAPING&&(t=t.replace(goog.string.E_RE_,"&#101;"));else{if(!goog.string.ALL_RE_.test(t))return t;-1!=t.indexOf("&")&&(t=t.replace(goog.string.AMP_RE_,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(goog.string.LT_RE_,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(goog.string.GT_RE_,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(goog.string.QUOT_RE_,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(goog.string.SINGLE_QUOTE_RE_,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(goog.string.NULL_RE_,"&#0;")),goog.string.DETECT_DOUBLE_ESCAPING&&-1!=t.indexOf("e")&&(t=t.replace(goog.string.E_RE_,"&#101;"))}return t},goog.string.AMP_RE_=/&/g,goog.string.LT_RE_=/</g,goog.string.GT_RE_=/>/g,goog.string.QUOT_RE_=/"/g,goog.string.SINGLE_QUOTE_RE_=/'/g,goog.string.NULL_RE_=/\x00/g,goog.string.E_RE_=/e/g,goog.string.ALL_RE_=goog.string.DETECT_DOUBLE_ESCAPING?/[\x00&<>"'e]/:/[\x00&<>"']/,goog.string.unescapeEntities=function(t){return goog.string.contains(t,"&")?!goog.string.FORCE_NON_DOM_HTML_UNESCAPING&&"document"in goog.global?goog.string.unescapeEntitiesUsingDom_(t):goog.string.unescapePureXmlEntities_(t):t},goog.string.unescapeEntitiesWithDocument=function(t,e){return goog.string.contains(t,"&")?goog.string.unescapeEntitiesUsingDom_(t,e):t},goog.string.unescapeEntitiesUsingDom_=function(t,e){var o={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'},n=e?e.createElement("div"):goog.global.document.createElement("div");return t.replace(goog.string.HTML_ENTITY_PATTERN_,function(t,e){var i=o[t];if(i)return i;if("#"==e.charAt(0)){var r=Number("0"+e.substr(1));isNaN(r)||(i=String.fromCharCode(r))}return i||(n.innerHTML=t+" ",i=n.firstChild.nodeValue.slice(0,-1)),o[t]=i})},goog.string.unescapePureXmlEntities_=function(t){return t.replace(/&([^;]+);/g,function(t,e){switch(e){case"amp":return"&";case"lt":return"<";case"gt":return">";case"quot":return'"';default:if("#"==e.charAt(0)){var o=Number("0"+e.substr(1));if(!isNaN(o))return String.fromCharCode(o)}return t}})},goog.string.HTML_ENTITY_PATTERN_=/&([^;\s<&]+);?/g,goog.string.whitespaceEscape=function(t,e){return goog.string.newLineToBr(t.replace(/  /g," &#160;"),e)},goog.string.preserveSpaces=function(t){return t.replace(/(^|[\n ]) /g,"$1"+goog.string.Unicode.NBSP)},goog.string.stripQuotes=function(t,e){for(var o=e.length,n=0;n<o;n++){var i=1==o?e:e.charAt(n);if(t.charAt(0)==i&&t.charAt(t.length-1)==i)return t.substring(1,t.length-1)}return t},goog.string.truncate=function(t,e,o){return o&&(t=goog.string.unescapeEntities(t)),t.length>e&&(t=t.substring(0,e-3)+"..."),o&&(t=goog.string.htmlEscape(t)),t},goog.string.truncateMiddle=function(t,e,o,n){if(o&&(t=goog.string.unescapeEntities(t)),n&&t.length>e){n>e&&(n=e);var i=t.length-n;t=t.substring(0,e-n)+"..."+t.substring(i)}else t.length>e&&(n=Math.floor(e/2),i=t.length-n,t=t.substring(0,n+e%2)+"..."+t.substring(i));return o&&(t=goog.string.htmlEscape(t)),t},goog.string.specialEscapeChars_={"\0":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\x0B",'"':'\\"',"\\":"\\\\","<":"<"},goog.string.jsEscapeCache_={"'":"\\'"},goog.string.quote=function(t){t=String(t);for(var e=['"'],o=0;o<t.length;o++){var n=t.charAt(o),i=n.charCodeAt(0);e[o+1]=goog.string.specialEscapeChars_[n]||(31<i&&127>i?n:goog.string.escapeChar(n))}return e.push('"'),e.join("")},goog.string.escapeString=function(t){for(var e=[],o=0;o<t.length;o++)e[o]=goog.string.escapeChar(t.charAt(o));return e.join("")},goog.string.escapeChar=function(t){if(t in goog.string.jsEscapeCache_)return goog.string.jsEscapeCache_[t];if(t in goog.string.specialEscapeChars_)return goog.string.jsEscapeCache_[t]=goog.string.specialEscapeChars_[t];var e=t.charCodeAt(0);if(31<e&&127>e)var o=t;else 256>e?(o="\\x",(16>e||256<e)&&(o+="0")):(o="\\u",4096>e&&(o+="0")),o+=e.toString(16).toUpperCase();return goog.string.jsEscapeCache_[t]=o},goog.string.contains=function(t,e){return-1!=t.indexOf(e)},goog.string.caseInsensitiveContains=function(t,e){return goog.string.contains(t.toLowerCase(),e.toLowerCase())},goog.string.countOf=function(t,e){return t&&e?t.split(e).length-1:0},goog.string.removeAt=function(t,e,o){var n=t;return 0<=e&&e<t.length&&0<o&&(n=t.substr(0,e)+t.substr(e+o,t.length-e-o)),n},goog.string.remove=function(t,e){return t.replace(e,"")},goog.string.removeAll=function(t,e){var o=new RegExp(goog.string.regExpEscape(e),"g");return t.replace(o,"")},goog.string.replaceAll=function(t,e,o){return e=new RegExp(goog.string.regExpEscape(e),"g"),t.replace(e,o.replace(/\$/g,"$$$$"))},goog.string.regExpEscape=function(t){return String(t).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},goog.string.repeat=String.prototype.repeat?function(t,e){return t.repeat(e)}:function(t,e){return Array(e+1).join(t)},goog.string.padNumber=function(t,e,o){return t=goog.isDef(o)?t.toFixed(o):String(t),o=t.indexOf("."),-1==o&&(o=t.length),goog.string.repeat("0",Math.max(0,e-o))+t},goog.string.makeSafe=function(t){return null==t?"":String(t)},goog.string.buildString=function(t){return Array.prototype.join.call(arguments,"")},goog.string.getRandomString=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^goog.now()).toString(36)},goog.string.compareVersions=function(t,e){for(var o=0,n=goog.string.trim(String(t)).split("."),i=goog.string.trim(String(e)).split("."),r=Math.max(n.length,i.length),s=0;0==o&&s<r;s++){var a=n[s]||"",l=i[s]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],l=/(\d*)(\D*)(.*)/.exec(l)||["","","",""],0==a[0].length&&0==l[0].length)break;o=0==a[1].length?0:parseInt(a[1],10);var c=0==l[1].length?0:parseInt(l[1],10);o=goog.string.compareElements_(o,c)||goog.string.compareElements_(0==a[2].length,0==l[2].length)||goog.string.compareElements_(a[2],l[2]),a=a[3],l=l[3]}while(0==o)}return o},goog.string.compareElements_=function(t,e){return t<e?-1:t>e?1:0},goog.string.hashCode=function(t){for(var e=0,o=0;o<t.length;++o)e=31*e+t.charCodeAt(o)>>>0;return e},goog.string.uniqueStringCounter_=2147483648*Math.random()|0,goog.string.createUniqueString=function(){return"goog_"+goog.string.uniqueStringCounter_++},goog.string.toNumber=function(t){var e=Number(t);return 0==e&&goog.string.isEmptyOrWhitespace(t)?NaN:e},goog.string.isLowerCamelCase=function(t){return/^[a-z]+([A-Z][a-z]*)*$/.test(t)},goog.string.isUpperCamelCase=function(t){return/^([A-Z][a-z]*)+$/.test(t)},goog.string.toCamelCase=function(t){return String(t).replace(/\-([a-z])/g,function(t,e){return e.toUpperCase()})},goog.string.toSelectorCase=function(t){return String(t).replace(/([A-Z])/g,"-$1").toLowerCase()},goog.string.toTitleCase=function(t,e){var o=goog.isString(e)?goog.string.regExpEscape(e):"\\s";return t.replace(new RegExp("(^"+(o?"|["+o+"]+":"")+")([a-z])","g"),function(t,e,o){return e+o.toUpperCase()})},goog.string.capitalize=function(t){return String(t.charAt(0)).toUpperCase()+String(t.substr(1)).toLowerCase()},goog.string.parseInt=function(t){return isFinite(t)&&(t=String(t)),goog.isString(t)?/^\s*-?0x/i.test(t)?parseInt(t,16):parseInt(t,10):NaN},goog.string.splitLimit=function(t,e,o){t=t.split(e);for(var n=[];0<o&&t.length;)n.push(t.shift()),o--;return t.length&&n.push(t.join(e)),n},goog.string.lastComponent=function(t,e){if(!e)return t;"string"==typeof e&&(e=[e]);for(var o=-1,n=0;n<e.length;n++)if(""!=e[n]){var i=t.lastIndexOf(e[n]);i>o&&(o=i)}return-1==o?t:t.slice(o+1)},goog.string.editDistance=function(t,e){var o=[],n=[];if(t==e)return 0;if(!t.length||!e.length)return Math.max(t.length,e.length);for(var i=0;i<e.length+1;i++)o[i]=i;for(i=0;i<t.length;i++){n[0]=i+1;for(var r=0;r<e.length;r++)n[r+1]=Math.min(n[r]+1,o[r+1]+1,o[r]+Number(t[i]!=e[r]));for(r=0;r<o.length;r++)o[r]=n[r]}return n[e.length]},goog.asserts={},goog.asserts.ENABLE_ASSERTS=goog.DEBUG,goog.asserts.AssertionError=function(t,e){e.unshift(t),goog.debug.Error.call(this,goog.string.subs.apply(null,e)),e.shift(),this.messagePattern=t},goog.inherits(goog.asserts.AssertionError,goog.debug.Error),goog.asserts.AssertionError.prototype.name="AssertionError",goog.asserts.DEFAULT_ERROR_HANDLER=function(t){throw t},goog.asserts.errorHandler_=goog.asserts.DEFAULT_ERROR_HANDLER;goog.asserts.doAssertFailure_=function(t,e,o,n){var i="Assertion failed";if(o){i+=": "+o;var r=n}else t&&(i+=": "+t,r=e);t=new goog.asserts.AssertionError(""+i,r||[]),goog.asserts.errorHandler_(t)},goog.asserts.setErrorHandler=function(t){goog.asserts.ENABLE_ASSERTS&&(goog.asserts.errorHandler_=t)},goog.asserts.assert=function(t,e,o){return goog.asserts.ENABLE_ASSERTS&&!t&&goog.asserts.doAssertFailure_("",null,e,Array.prototype.slice.call(arguments,2)),t},goog.asserts.fail=function(t,e){goog.asserts.ENABLE_ASSERTS&&goog.asserts.errorHandler_(new goog.asserts.AssertionError("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1)))},goog.asserts.assertNumber=function(t,e,o){return goog.asserts.ENABLE_ASSERTS&&!goog.isNumber(t)&&goog.asserts.doAssertFailure_("Expected number but got %s: %s.",[goog.typeOf(t),t],e,Array.prototype.slice.call(arguments,2)),t},goog.asserts.assertString=function(t,e,o){return goog.asserts.ENABLE_ASSERTS&&!goog.isString(t)&&goog.asserts.doAssertFailure_("Expected string but got %s: %s.",[goog.typeOf(t),t],e,Array.prototype.slice.call(arguments,2)),t},goog.asserts.assertFunction=function(t,e,o){return goog.asserts.ENABLE_ASSERTS&&!goog.isFunction(t)&&goog.asserts.doAssertFailure_("Expected function but got %s: %s.",[goog.typeOf(t),t],e,Array.prototype.slice.call(arguments,2)),t},goog.asserts.assertObject=function(t,e,o){return goog.asserts.ENABLE_ASSERTS&&!goog.isObject(t)&&goog.asserts.doAssertFailure_("Expected object but got %s: %s.",[goog.typeOf(t),t],e,Array.prototype.slice.call(arguments,2)),t},goog.asserts.assertArray=function(t,e,o){return goog.asserts.ENABLE_ASSERTS&&!goog.isArray(t)&&goog.asserts.doAssertFailure_("Expected array but got %s: %s.",[goog.typeOf(t),t],e,Array.prototype.slice.call(arguments,2)),t},goog.asserts.assertBoolean=function(t,e,o){return goog.asserts.ENABLE_ASSERTS&&!goog.isBoolean(t)&&goog.asserts.doAssertFailure_("Expected boolean but got %s: %s.",[goog.typeOf(t),t],e,Array.prototype.slice.call(arguments,2)),t},goog.asserts.assertElement=function(t,e,o){return!goog.asserts.ENABLE_ASSERTS||goog.isObject(t)&&t.nodeType==goog.dom.NodeType.ELEMENT||goog.asserts.doAssertFailure_("Expected Element but got %s: %s.",[goog.typeOf(t),t],e,Array.prototype.slice.call(arguments,2)),t},goog.asserts.assertInstanceof=function(t,e,o,n){return!goog.asserts.ENABLE_ASSERTS||t instanceof e||goog.asserts.doAssertFailure_("Expected instanceof %s but got %s.",[goog.asserts.getType_(e),goog.asserts.getType_(t)],o,Array.prototype.slice.call(arguments,3)),t},goog.asserts.assertObjectPrototypeIsIntact=function(){for(var t in Object.prototype)goog.asserts.fail(t+" should not be enumerable in Object.prototype.")},goog.asserts.getType_=function(t){return t instanceof Function?t.displayName||t.name||"unknown type name":t instanceof Object?t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t):null===t?"null":typeof t},goog.array={},goog.NATIVE_ARRAY_PROTOTYPES=goog.TRUSTED_SITE,goog.array.ASSUME_NATIVE_FUNCTIONS=!1,goog.array.peek=function(t){return t[t.length-1]},goog.array.last=goog.array.peek,goog.array.indexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.indexOf)?function(t,e,o){return goog.asserts.assert(null!=t.length),Array.prototype.indexOf.call(t,e,o)}:function(t,e,o){if(o=null==o?0:0>o?Math.max(0,t.length+o):o,goog.isString(t))return goog.isString(e)&&1==e.length?t.indexOf(e,o):-1;for(;o<t.length;o++)if(o in t&&t[o]===e)return o;return-1},goog.array.lastIndexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.lastIndexOf)?function(t,e,o){return goog.asserts.assert(null!=t.length),Array.prototype.lastIndexOf.call(t,e,null==o?t.length-1:o)}:function(t,e,o){if(o=null==o?t.length-1:o,0>o&&(o=Math.max(0,t.length+o)),goog.isString(t))return goog.isString(e)&&1==e.length?t.lastIndexOf(e,o):-1;for(;0<=o;o--)if(o in t&&t[o]===e)return o;return-1},goog.array.forEach=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.forEach)?function(t,e,o){goog.asserts.assert(null!=t.length),Array.prototype.forEach.call(t,e,o)}:function(t,e,o){for(var n=t.length,i=goog.isString(t)?t.split(""):t,r=0;r<n;r++)r in i&&e.call(o,i[r],r,t)},goog.array.forEachRight=function(t,e,o){var n=t.length,i=goog.isString(t)?t.split(""):t;for(--n;0<=n;--n)n in i&&e.call(o,i[n],n,t)},goog.array.filter=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.filter)?function(t,e,o){return goog.asserts.assert(null!=t.length),Array.prototype.filter.call(t,e,o)}:function(t,e,o){for(var n=t.length,i=[],r=0,s=goog.isString(t)?t.split(""):t,a=0;a<n;a++)if(a in s){var l=s[a];e.call(o,l,a,t)&&(i[r++]=l)}return i},goog.array.map=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.map)?function(t,e,o){return goog.asserts.assert(null!=t.length),Array.prototype.map.call(t,e,o)}:function(t,e,o){for(var n=t.length,i=Array(n),r=goog.isString(t)?t.split(""):t,s=0;s<n;s++)s in r&&(i[s]=e.call(o,r[s],s,t));return i},goog.array.reduce=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.reduce)?function(t,e,o,n){return goog.asserts.assert(null!=t.length),n&&(e=goog.bind(e,n)),Array.prototype.reduce.call(t,e,o)}:function(t,e,o,n){var i=o;return goog.array.forEach(t,function(o,r){i=e.call(n,i,o,r,t)}),i},goog.array.reduceRight=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.reduceRight)?function(t,e,o,n){return goog.asserts.assert(null!=t.length),goog.asserts.assert(null!=e),n&&(e=goog.bind(e,n)),Array.prototype.reduceRight.call(t,e,o)}:function(t,e,o,n){var i=o;return goog.array.forEachRight(t,function(o,r){i=e.call(n,i,o,r,t)}),i},goog.array.some=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.some)?function(t,e,o){return goog.asserts.assert(null!=t.length),Array.prototype.some.call(t,e,o)}:function(t,e,o){for(var n=t.length,i=goog.isString(t)?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(o,i[r],r,t))return!0;return!1},goog.array.every=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.every)?function(t,e,o){return goog.asserts.assert(null!=t.length),Array.prototype.every.call(t,e,o)}:function(t,e,o){for(var n=t.length,i=goog.isString(t)?t.split(""):t,r=0;r<n;r++)if(r in i&&!e.call(o,i[r],r,t))return!1;return!0},goog.array.count=function(t,e,o){var n=0;return goog.array.forEach(t,function(t,i,r){e.call(o,t,i,r)&&++n},o),n},goog.array.find=function(t,e,o){return e=goog.array.findIndex(t,e,o),0>e?null:goog.isString(t)?t.charAt(e):t[e]},goog.array.findIndex=function(t,e,o){for(var n=t.length,i=goog.isString(t)?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(o,i[r],r,t))return r;return-1},goog.array.findRight=function(t,e,o){return e=goog.array.findIndexRight(t,e,o),0>e?null:goog.isString(t)?t.charAt(e):t[e]},goog.array.findIndexRight=function(t,e,o){var n=t.length,i=goog.isString(t)?t.split(""):t;for(--n;0<=n;n--)if(n in i&&e.call(o,i[n],n,t))return n;return-1},goog.array.contains=function(t,e){return 0<=goog.array.indexOf(t,e)},goog.array.isEmpty=function(t){return 0==t.length},goog.array.clear=function(t){if(!goog.isArray(t))for(var e=t.length-1;0<=e;e--)delete t[e];t.length=0},goog.array.insert=function(t,e){goog.array.contains(t,e)||t.push(e)},goog.array.insertAt=function(t,e,o){goog.array.splice(t,o,0,e)},goog.array.insertArrayAt=function(t,e,o){goog.partial(goog.array.splice,t,o,0).apply(null,e)},goog.array.insertBefore=function(t,e,o){var n;2==arguments.length||0>(n=goog.array.indexOf(t,o))?t.push(e):goog.array.insertAt(t,e,n)},goog.array.remove=function(t,e){var o,n=goog.array.indexOf(t,e);return(o=0<=n)&&goog.array.removeAt(t,n),o},goog.array.removeLast=function(t,e){var o=goog.array.lastIndexOf(t,e);return 0<=o&&(goog.array.removeAt(t,o),!0)},goog.array.removeAt=function(t,e){return goog.asserts.assert(null!=t.length),1==Array.prototype.splice.call(t,e,1).length},goog.array.removeIf=function(t,e,o){return 0<=(e=goog.array.findIndex(t,e,o))&&(goog.array.removeAt(t,e),!0)},goog.array.removeAllIf=function(t,e,o){var n=0;return goog.array.forEachRight(t,function(i,r){e.call(o,i,r,t)&&goog.array.removeAt(t,r)&&n++}),n},goog.array.concat=function(t){return Array.prototype.concat.apply([],arguments)},goog.array.join=function(t){return Array.prototype.concat.apply([],arguments)},goog.array.toArray=function(t){var e=t.length;if(0<e){for(var o=Array(e),n=0;n<e;n++)o[n]=t[n];return o}return[]},goog.array.clone=goog.array.toArray,goog.array.extend=function(t,e){for(var o=1;o<arguments.length;o++){var n=arguments[o];if(goog.isArrayLike(n)){var i=t.length||0,r=n.length||0;t.length=i+r;for(var s=0;s<r;s++)t[i+s]=n[s]}else t.push(n)}},goog.array.splice=function(t,e,o,n){return goog.asserts.assert(null!=t.length),Array.prototype.splice.apply(t,goog.array.slice(arguments,1))},goog.array.slice=function(t,e,o){return goog.asserts.assert(null!=t.length),2>=arguments.length?Array.prototype.slice.call(t,e):Array.prototype.slice.call(t,e,o)},goog.array.removeDuplicates=function(t,e,o){e=e||t;var n=function(t){return goog.isObject(t)?"o"+goog.getUid(t):(typeof t).charAt(0)+t};o=o||n,n={};for(var i=0,r=0;r<t.length;){var s=t[r++],a=o(s);Object.prototype.hasOwnProperty.call(n,a)||(n[a]=!0,e[i++]=s)}e.length=i},goog.array.binarySearch=function(t,e,o){return goog.array.binarySearch_(t,o||goog.array.defaultCompare,!1,e)},goog.array.binarySelect=function(t,e,o){return goog.array.binarySearch_(t,e,!0,void 0,o)},goog.array.binarySearch_=function(t,e,o,n,i){for(var r,s=0,a=t.length;s<a;){var l=s+a>>1,c=o?e.call(i,t[l],l,t):e(n,t[l]);0<c?s=l+1:(a=l,r=!c)}return r?s:~s},goog.array.sort=function(t,e){t.sort(e||goog.array.defaultCompare)},goog.array.stableSort=function(t,e){for(var o=Array(t.length),n=0;n<t.length;n++)o[n]={index:n,value:t[n]};var i=e||goog.array.defaultCompare;for(goog.array.sort(o,function(t,e){return i(t.value,e.value)||t.index-e.index}),n=0;n<t.length;n++)t[n]=o[n].value},goog.array.sortByKey=function(t,e,o){var n=o||goog.array.defaultCompare;goog.array.sort(t,function(t,o){return n(e(t),e(o))})},goog.array.sortObjectsByKey=function(t,e,o){goog.array.sortByKey(t,function(t){return t[e]},o)},goog.array.isSorted=function(t,e,o){e=e||goog.array.defaultCompare;for(var n=1;n<t.length;n++){var i=e(t[n-1],t[n]);if(0<i||0==i&&o)return!1}return!0},goog.array.equals=function(t,e,o){if(!goog.isArrayLike(t)||!goog.isArrayLike(e)||t.length!=e.length)return!1;var n=t.length;o=o||goog.array.defaultCompareEquality;for(var i=0;i<n;i++)if(!o(t[i],e[i]))return!1;return!0},goog.array.compare3=function(t,e,o){o=o||goog.array.defaultCompare;for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=o(t[i],e[i]);if(0!=r)return r}return goog.array.defaultCompare(t.length,e.length)},goog.array.defaultCompare=function(t,e){return t>e?1:t<e?-1:0},goog.array.inverseDefaultCompare=function(t,e){return-goog.array.defaultCompare(t,e)},goog.array.defaultCompareEquality=function(t,e){return t===e},goog.array.binaryInsert=function(t,e,o){return 0>(o=goog.array.binarySearch(t,e,o))&&(goog.array.insertAt(t,e,-(o+1)),!0)},goog.array.binaryRemove=function(t,e,o){return 0<=(e=goog.array.binarySearch(t,e,o))&&goog.array.removeAt(t,e)},goog.array.bucket=function(t,e,o){for(var n={},i=0;i<t.length;i++){var r=t[i],s=e.call(o,r,i,t);goog.isDef(s)&&(n[s]||(n[s]=[])).push(r)}return n},goog.array.toObject=function(t,e,o){var n={};return goog.array.forEach(t,function(i,r){n[e.call(o,i,r,t)]=i}),n},goog.array.range=function(t,e,o){var n=[],i=0,r=t;if(o=o||1,void 0!==e&&(i=t,r=e),0>o*(r-i))return[];if(0<o)for(t=i;t<r;t+=o)n.push(t);else for(t=i;t>r;t+=o)n.push(t);return n},goog.array.repeat=function(t,e){for(var o=[],n=0;n<e;n++)o[n]=t;return o},goog.array.flatten=function(t){for(var e=[],o=0;o<arguments.length;o++){var n=arguments[o];if(goog.isArray(n))for(var i=0;i<n.length;i+=8192){var r=goog.array.slice(n,i,i+8192);r=goog.array.flatten.apply(null,r);for(var s=0;s<r.length;s++)e.push(r[s])}else e.push(n)}return e},goog.array.rotate=function(t,e){return goog.asserts.assert(null!=t.length),t.length&&(e%=t.length,0<e?Array.prototype.unshift.apply(t,t.splice(-e,e)):0>e&&Array.prototype.push.apply(t,t.splice(0,-e))),t},goog.array.moveItem=function(t,e,o){goog.asserts.assert(0<=e&&e<t.length),goog.asserts.assert(0<=o&&o<t.length),e=Array.prototype.splice.call(t,e,1),Array.prototype.splice.call(t,o,0,e[0])},goog.array.zip=function(t){if(!arguments.length)return[];for(var e=[],o=arguments[0].length,n=1;n<arguments.length;n++)arguments[n].length<o&&(o=arguments[n].length);for(n=0;n<o;n++){for(var i=[],r=0;r<arguments.length;r++)i.push(arguments[r][n]);e.push(i)}return e},goog.array.shuffle=function(t,e){for(var o=e||Math.random,n=t.length-1;0<n;n--){var i=Math.floor(o()*(n+1)),r=t[n];t[n]=t[i],t[i]=r}},goog.array.copyByIndex=function(t,e){var o=[];return goog.array.forEach(e,function(e){o.push(t[e])}),o},goog.array.concatMap=function(t,e,o){return goog.array.concat.apply([],goog.array.map(t,e,o))},goog.math={},goog.math.randomInt=function(t){return Math.floor(Math.random()*t)},goog.math.uniformRandom=function(t,e){return t+Math.random()*(e-t)},goog.math.clamp=function(t,e,o){return Math.min(Math.max(t,e),o)},goog.math.modulo=function(t,e){var o=t%e;return 0>o*e?o+e:o},goog.math.lerp=function(t,e,o){return t+o*(e-t)},goog.math.nearlyEquals=function(t,e,o){return Math.abs(t-e)<=(o||1e-6)},goog.math.standardAngle=function(t){return goog.math.modulo(t,360)},goog.math.standardAngleInRadians=function(t){return goog.math.modulo(t,2*Math.PI)},goog.math.toRadians=function(t){return t*Math.PI/180},goog.math.toDegrees=function(t){return 180*t/Math.PI},goog.math.angleDx=function(t,e){return e*Math.cos(goog.math.toRadians(t))},goog.math.angleDy=function(t,e){return e*Math.sin(goog.math.toRadians(t))},goog.math.angle=function(t,e,o,n){return goog.math.standardAngle(goog.math.toDegrees(Math.atan2(n-e,o-t)))},goog.math.angleDifference=function(t,e){var o=goog.math.standardAngle(e)-goog.math.standardAngle(t);return 180<o?o-=360:-180>=o&&(o=360+o),o},goog.math.sign=function(t){return 0<t?1:0>t?-1:t},goog.math.longestCommonSubsequence=function(t,e,o,n){o=o||function(t,e){return t==e},n=n||function(e,o){return t[e]};for(var i=t.length,r=e.length,s=[],a=0;a<i+1;a++)s[a]=[],s[a][0]=0;for(var l=0;l<r+1;l++)s[0][l]=0;for(a=1;a<=i;a++)for(l=1;l<=r;l++)o(t[a-1],e[l-1])?s[a][l]=s[a-1][l-1]+1:s[a][l]=Math.max(s[a-1][l],s[a][l-1]);var c=[];for(a=i,l=r;0<a&&0<l;)o(t[a-1],e[l-1])?(c.unshift(n(a-1,l-1)),a--,l--):s[a-1][l]>s[a][l-1]?a--:l--;return c},goog.math.sum=function(t){return goog.array.reduce(arguments,function(t,e){return t+e},0)},goog.math.average=function(t){return goog.math.sum.apply(null,arguments)/arguments.length},goog.math.sampleVariance=function(t){var e=arguments.length;if(2>e)return 0;var o=goog.math.average.apply(null,arguments);return goog.math.sum.apply(null,goog.array.map(arguments,function(t){return Math.pow(t-o,2)}))/(e-1)},goog.math.standardDeviation=function(t){return Math.sqrt(goog.math.sampleVariance.apply(null,arguments))},goog.math.isInt=function(t){return isFinite(t)&&0==t%1},goog.math.isFiniteNumber=function(t){return isFinite(t)},goog.math.isNegativeZero=function(t){return 0==t&&0>1/t},goog.math.log10Floor=function(t){if(0<t){var e=Math.round(Math.log(t)*Math.LOG10E);return e-(parseFloat("1e"+e)>t?1:0)}return 0==t?-1/0:NaN},goog.math.safeFloor=function(t,e){return goog.asserts.assert(!goog.isDef(e)||0<e),Math.floor(t+(e||2e-15))},goog.math.safeCeil=function(t,e){return goog.asserts.assert(!goog.isDef(e)||0<e),Math.ceil(t-(e||2e-15))},goog.math.Coordinate=function(t,e){this.x=goog.isDef(t)?t:0,this.y=goog.isDef(e)?e:0},goog.math.Coordinate.prototype.clone=function(){return new goog.math.Coordinate(this.x,this.y)},goog.DEBUG&&(goog.math.Coordinate.prototype.toString=function(){return"("+this.x+", "+this.y+")"}),goog.math.Coordinate.prototype.equals=function(t){return t instanceof goog.math.Coordinate&&goog.math.Coordinate.equals(this,t)},goog.math.Coordinate.equals=function(t,e){return t==e||!(!t||!e)&&(t.x==e.x&&t.y==e.y)},goog.math.Coordinate.distance=function(t,e){var o=t.x-e.x,n=t.y-e.y;return Math.sqrt(o*o+n*n)},goog.math.Coordinate.magnitude=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},goog.math.Coordinate.azimuth=function(t){return goog.math.angle(0,0,t.x,t.y)},goog.math.Coordinate.squaredDistance=function(t,e){var o=t.x-e.x,n=t.y-e.y;return o*o+n*n},goog.math.Coordinate.difference=function(t,e){return new goog.math.Coordinate(t.x-e.x,t.y-e.y)},goog.math.Coordinate.sum=function(t,e){return new goog.math.Coordinate(t.x+e.x,t.y+e.y)},goog.math.Coordinate.prototype.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},goog.math.Coordinate.prototype.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},goog.math.Coordinate.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},goog.math.Coordinate.prototype.translate=function(t,e){return t instanceof goog.math.Coordinate?(this.x+=t.x,this.y+=t.y):(this.x+=Number(t),goog.isNumber(e)&&(this.y+=e)),this},goog.math.Coordinate.prototype.scale=function(t,e){var o=goog.isNumber(e)?e:t;return this.x*=t,this.y*=o,this},goog.math.Coordinate.prototype.rotateRadians=function(t,e){var o=e||new goog.math.Coordinate(0,0),n=this.x,i=this.y,r=Math.cos(t),s=Math.sin(t);this.x=(n-o.x)*r-(i-o.y)*s+o.x,this.y=(n-o.x)*s+(i-o.y)*r+o.y},goog.math.Coordinate.prototype.rotateDegrees=function(t,e){this.rotateRadians(goog.math.toRadians(t),e)},goog.Thenable=function(){},goog.Thenable.prototype.then=function(t,e,o){},goog.Thenable.IMPLEMENTED_BY_PROP="$goog_Thenable",goog.Thenable.addImplementation=function(t){t.prototype.then=t.prototype.then,COMPILED?t.prototype[goog.Thenable.IMPLEMENTED_BY_PROP]=!0:t.prototype.$goog_Thenable=!0},goog.Thenable.isImplementedBy=function(t){if(!t)return!1;try{return COMPILED?!!t[goog.Thenable.IMPLEMENTED_BY_PROP]:!!t.$goog_Thenable}catch(t){return!1}},goog.async={},goog.async.FreeList=function(t,e,o){this.limit_=o,this.create_=t,this.reset_=e,this.occupants_=0,this.head_=null},goog.async.FreeList.prototype.get=function(){if(0<this.occupants_){this.occupants_--;var t=this.head_;this.head_=t.next,t.next=null}else t=this.create_();return t},goog.async.FreeList.prototype.put=function(t){this.reset_(t),this.occupants_<this.limit_&&(this.occupants_++,t.next=this.head_,this.head_=t)},goog.async.FreeList.prototype.occupants=function(){return this.occupants_},goog.async.WorkQueue=function(){this.workTail_=this.workHead_=null},goog.async.WorkQueue.DEFAULT_MAX_UNUSED=100,goog.async.WorkQueue.freelist_=new goog.async.FreeList(function(){return new goog.async.WorkItem},function(t){t.reset()},goog.async.WorkQueue.DEFAULT_MAX_UNUSED),goog.async.WorkQueue.prototype.add=function(t,e){var o=this.getUnusedItem_();o.set(t,e),this.workTail_?this.workTail_.next=o:(goog.asserts.assert(!this.workHead_),this.workHead_=o),this.workTail_=o},goog.async.WorkQueue.prototype.remove=function(){var t=null;return this.workHead_&&(t=this.workHead_,this.workHead_=this.workHead_.next,this.workHead_||(this.workTail_=null),t.next=null),t},goog.async.WorkQueue.prototype.returnUnused=function(t){goog.async.WorkQueue.freelist_.put(t)},goog.async.WorkQueue.prototype.getUnusedItem_=function(){return goog.async.WorkQueue.freelist_.get()},goog.async.WorkItem=function(){this.next=this.scope=this.fn=null},goog.async.WorkItem.prototype.set=function(t,e){this.fn=t,this.scope=e,this.next=null},goog.async.WorkItem.prototype.reset=function(){this.next=this.scope=this.fn=null},goog.debug.entryPointRegistry={},goog.debug.EntryPointMonitor=function(){},goog.debug.entryPointRegistry.refList_=[],goog.debug.entryPointRegistry.monitors_=[],goog.debug.entryPointRegistry.monitorsMayExist_=!1,goog.debug.entryPointRegistry.register=function(t){if(goog.debug.entryPointRegistry.refList_[goog.debug.entryPointRegistry.refList_.length]=t,goog.debug.entryPointRegistry.monitorsMayExist_)for(var e=goog.debug.entryPointRegistry.monitors_,o=0;o<e.length;o++)t(goog.bind(e[o].wrap,e[o]))},goog.debug.entryPointRegistry.monitorAll=function(t){goog.debug.entryPointRegistry.monitorsMayExist_=!0;for(var e=goog.bind(t.wrap,t),o=0;o<goog.debug.entryPointRegistry.refList_.length;o++)goog.debug.entryPointRegistry.refList_[o](e);goog.debug.entryPointRegistry.monitors_.push(t)},goog.debug.entryPointRegistry.unmonitorAllIfPossible=function(t){var e=goog.debug.entryPointRegistry.monitors_;goog.asserts.assert(t==e[e.length-1],"Only the most recent monitor can be unwrapped."),t=goog.bind(t.unwrap,t);for(var o=0;o<goog.debug.entryPointRegistry.refList_.length;o++)goog.debug.entryPointRegistry.refList_[o](t);e.length--},goog.dom.HtmlElement=function(){},goog.dom.TagName=function(t){this.tagName_=t},goog.dom.TagName.prototype.toString=function(){return this.tagName_},goog.dom.TagName.A=new goog.dom.TagName("A"),goog.dom.TagName.ABBR=new goog.dom.TagName("ABBR"),goog.dom.TagName.ACRONYM=new goog.dom.TagName("ACRONYM"),goog.dom.TagName.ADDRESS=new goog.dom.TagName("ADDRESS"),goog.dom.TagName.APPLET=new goog.dom.TagName("APPLET"),goog.dom.TagName.AREA=new goog.dom.TagName("AREA"),goog.dom.TagName.ARTICLE=new goog.dom.TagName("ARTICLE"),goog.dom.TagName.ASIDE=new goog.dom.TagName("ASIDE"),goog.dom.TagName.AUDIO=new goog.dom.TagName("AUDIO"),goog.dom.TagName.B=new goog.dom.TagName("B"),goog.dom.TagName.BASE=new goog.dom.TagName("BASE"),goog.dom.TagName.BASEFONT=new goog.dom.TagName("BASEFONT"),goog.dom.TagName.BDI=new goog.dom.TagName("BDI"),goog.dom.TagName.BDO=new goog.dom.TagName("BDO"),goog.dom.TagName.BIG=new goog.dom.TagName("BIG"),goog.dom.TagName.BLOCKQUOTE=new goog.dom.TagName("BLOCKQUOTE"),goog.dom.TagName.BODY=new goog.dom.TagName("BODY"),goog.dom.TagName.BR=new goog.dom.TagName("BR"),goog.dom.TagName.BUTTON=new goog.dom.TagName("BUTTON"),goog.dom.TagName.CANVAS=new goog.dom.TagName("CANVAS"),goog.dom.TagName.CAPTION=new goog.dom.TagName("CAPTION"),goog.dom.TagName.CENTER=new goog.dom.TagName("CENTER"),goog.dom.TagName.CITE=new goog.dom.TagName("CITE"),goog.dom.TagName.CODE=new goog.dom.TagName("CODE"),goog.dom.TagName.COL=new goog.dom.TagName("COL"),goog.dom.TagName.COLGROUP=new goog.dom.TagName("COLGROUP"),goog.dom.TagName.COMMAND=new goog.dom.TagName("COMMAND"),goog.dom.TagName.DATA=new goog.dom.TagName("DATA"),goog.dom.TagName.DATALIST=new goog.dom.TagName("DATALIST"),goog.dom.TagName.DD=new goog.dom.TagName("DD"),goog.dom.TagName.DEL=new goog.dom.TagName("DEL"),goog.dom.TagName.DETAILS=new goog.dom.TagName("DETAILS"),goog.dom.TagName.DFN=new goog.dom.TagName("DFN"),goog.dom.TagName.DIALOG=new goog.dom.TagName("DIALOG"),goog.dom.TagName.DIR=new goog.dom.TagName("DIR"),goog.dom.TagName.DIV=new goog.dom.TagName("DIV"),goog.dom.TagName.DL=new goog.dom.TagName("DL"),goog.dom.TagName.DT=new goog.dom.TagName("DT"),goog.dom.TagName.EM=new goog.dom.TagName("EM"),goog.dom.TagName.EMBED=new goog.dom.TagName("EMBED"),goog.dom.TagName.FIELDSET=new goog.dom.TagName("FIELDSET"),goog.dom.TagName.FIGCAPTION=new goog.dom.TagName("FIGCAPTION"),goog.dom.TagName.FIGURE=new goog.dom.TagName("FIGURE"),goog.dom.TagName.FONT=new goog.dom.TagName("FONT");goog.dom.TagName.FOOTER=new goog.dom.TagName("FOOTER"),goog.dom.TagName.FORM=new goog.dom.TagName("FORM"),goog.dom.TagName.FRAME=new goog.dom.TagName("FRAME"),goog.dom.TagName.FRAMESET=new goog.dom.TagName("FRAMESET"),goog.dom.TagName.H1=new goog.dom.TagName("H1"),goog.dom.TagName.H2=new goog.dom.TagName("H2"),goog.dom.TagName.H3=new goog.dom.TagName("H3"),goog.dom.TagName.H4=new goog.dom.TagName("H4"),goog.dom.TagName.H5=new goog.dom.TagName("H5"),goog.dom.TagName.H6=new goog.dom.TagName("H6"),goog.dom.TagName.HEAD=new goog.dom.TagName("HEAD"),goog.dom.TagName.HEADER=new goog.dom.TagName("HEADER"),goog.dom.TagName.HGROUP=new goog.dom.TagName("HGROUP"),goog.dom.TagName.HR=new goog.dom.TagName("HR"),goog.dom.TagName.HTML=new goog.dom.TagName("HTML"),goog.dom.TagName.I=new goog.dom.TagName("I"),goog.dom.TagName.IFRAME=new goog.dom.TagName("IFRAME"),goog.dom.TagName.IMG=new goog.dom.TagName("IMG"),goog.dom.TagName.INPUT=new goog.dom.TagName("INPUT"),goog.dom.TagName.INS=new goog.dom.TagName("INS"),goog.dom.TagName.ISINDEX=new goog.dom.TagName("ISINDEX"),goog.dom.TagName.KBD=new goog.dom.TagName("KBD"),goog.dom.TagName.KEYGEN=new goog.dom.TagName("KEYGEN"),goog.dom.TagName.LABEL=new goog.dom.TagName("LABEL"),goog.dom.TagName.LEGEND=new goog.dom.TagName("LEGEND"),goog.dom.TagName.LI=new goog.dom.TagName("LI"),goog.dom.TagName.LINK=new goog.dom.TagName("LINK"),goog.dom.TagName.MAP=new goog.dom.TagName("MAP"),goog.dom.TagName.MARK=new goog.dom.TagName("MARK"),goog.dom.TagName.MATH=new goog.dom.TagName("MATH"),goog.dom.TagName.MENU=new goog.dom.TagName("MENU"),goog.dom.TagName.META=new goog.dom.TagName("META"),goog.dom.TagName.METER=new goog.dom.TagName("METER"),goog.dom.TagName.NAV=new goog.dom.TagName("NAV"),goog.dom.TagName.NOFRAMES=new goog.dom.TagName("NOFRAMES"),goog.dom.TagName.NOSCRIPT=new goog.dom.TagName("NOSCRIPT"),goog.dom.TagName.OBJECT=new goog.dom.TagName("OBJECT"),goog.dom.TagName.OL=new goog.dom.TagName("OL"),goog.dom.TagName.OPTGROUP=new goog.dom.TagName("OPTGROUP"),goog.dom.TagName.OPTION=new goog.dom.TagName("OPTION"),goog.dom.TagName.OUTPUT=new goog.dom.TagName("OUTPUT"),goog.dom.TagName.P=new goog.dom.TagName("P"),goog.dom.TagName.PARAM=new goog.dom.TagName("PARAM"),goog.dom.TagName.PRE=new goog.dom.TagName("PRE"),goog.dom.TagName.PROGRESS=new goog.dom.TagName("PROGRESS"),goog.dom.TagName.Q=new goog.dom.TagName("Q"),goog.dom.TagName.RP=new goog.dom.TagName("RP"),goog.dom.TagName.RT=new goog.dom.TagName("RT"),goog.dom.TagName.RUBY=new goog.dom.TagName("RUBY"),goog.dom.TagName.S=new goog.dom.TagName("S"),goog.dom.TagName.SAMP=new goog.dom.TagName("SAMP"),goog.dom.TagName.SCRIPT=new goog.dom.TagName("SCRIPT"),goog.dom.TagName.SECTION=new goog.dom.TagName("SECTION"),goog.dom.TagName.SELECT=new goog.dom.TagName("SELECT"),goog.dom.TagName.SMALL=new goog.dom.TagName("SMALL"),goog.dom.TagName.SOURCE=new goog.dom.TagName("SOURCE"),goog.dom.TagName.SPAN=new goog.dom.TagName("SPAN"),goog.dom.TagName.STRIKE=new goog.dom.TagName("STRIKE"),goog.dom.TagName.STRONG=new goog.dom.TagName("STRONG"),goog.dom.TagName.STYLE=new goog.dom.TagName("STYLE"),goog.dom.TagName.SUB=new goog.dom.TagName("SUB"),goog.dom.TagName.SUMMARY=new goog.dom.TagName("SUMMARY"),goog.dom.TagName.SUP=new goog.dom.TagName("SUP"),goog.dom.TagName.SVG=new goog.dom.TagName("SVG"),goog.dom.TagName.TABLE=new goog.dom.TagName("TABLE"),goog.dom.TagName.TBODY=new goog.dom.TagName("TBODY"),goog.dom.TagName.TD=new goog.dom.TagName("TD"),goog.dom.TagName.TEMPLATE=new goog.dom.TagName("TEMPLATE"),goog.dom.TagName.TEXTAREA=new goog.dom.TagName("TEXTAREA"),goog.dom.TagName.TFOOT=new goog.dom.TagName("TFOOT"),goog.dom.TagName.TH=new goog.dom.TagName("TH"),goog.dom.TagName.THEAD=new goog.dom.TagName("THEAD"),goog.dom.TagName.TIME=new goog.dom.TagName("TIME"),goog.dom.TagName.TITLE=new goog.dom.TagName("TITLE"),goog.dom.TagName.TR=new goog.dom.TagName("TR"),goog.dom.TagName.TRACK=new goog.dom.TagName("TRACK"),goog.dom.TagName.TT=new goog.dom.TagName("TT"),goog.dom.TagName.U=new goog.dom.TagName("U"),goog.dom.TagName.UL=new goog.dom.TagName("UL"),goog.dom.TagName.VAR=new goog.dom.TagName("VAR"),goog.dom.TagName.VIDEO=new goog.dom.TagName("VIDEO"),goog.dom.TagName.WBR=new goog.dom.TagName("WBR"),goog.functions={},goog.functions.constant=function(t){return function(){return t}},goog.functions.FALSE=goog.functions.constant(!1),goog.functions.TRUE=goog.functions.constant(!0),goog.functions.NULL=goog.functions.constant(null),goog.functions.identity=function(t,e){return t},goog.functions.error=function(t){return function(){throw Error(t)}},goog.functions.fail=function(t){return function(){throw t}},goog.functions.lock=function(t,e){return e=e||0,function(){return t.apply(this,Array.prototype.slice.call(arguments,0,e))}},goog.functions.nth=function(t){return function(){return arguments[t]}},goog.functions.partialRight=function(t,e){var o=Array.prototype.slice.call(arguments,1);return function(){var e=Array.prototype.slice.call(arguments);return e.push.apply(e,o),t.apply(this,e)}},goog.functions.withReturnValue=function(t,e){return goog.functions.sequence(t,goog.functions.constant(e))},goog.functions.equalTo=function(t,e){return function(o){return e?t==o:t===o}},goog.functions.compose=function(t,e){var o=arguments,n=o.length;return function(){var t;n&&(t=o[n-1].apply(this,arguments));for(var e=n-2;0<=e;e--)t=o[e].call(this,t);return t}},goog.functions.sequence=function(t){var e=arguments,o=e.length;return function(){for(var t,n=0;n<o;n++)t=e[n].apply(this,arguments);return t}},goog.functions.and=function(t){var e=arguments,o=e.length;return function(){for(var t=0;t<o;t++)if(!e[t].apply(this,arguments))return!1;return!0}},goog.functions.or=function(t){var e=arguments,o=e.length;return function(){for(var t=0;t<o;t++)if(e[t].apply(this,arguments))return!0;return!1}},goog.functions.not=function(t){return function(){return!t.apply(this,arguments)}},goog.functions.create=function(t,e){var o=function(){};return o.prototype=t.prototype,o=new o,t.apply(o,Array.prototype.slice.call(arguments,1)),o},goog.functions.CACHE_RETURN_VALUE=!0,goog.functions.cacheReturnValue=function(t){var e,o=!1;return function(){return goog.functions.CACHE_RETURN_VALUE?(o||(e=t(),o=!0),e):t()}},goog.functions.once=function(t){var e=t;return function(){if(e){var t=e;e=null,t()}}},goog.functions.debounce=function(t,e,o){var n=0;return function(i){goog.global.clearTimeout(n);var r=arguments;n=goog.global.setTimeout(function(){t.apply(o,r)},e)}},goog.functions.throttle=function(t,e,o){var n=0,i=!1,r=[],s=function(){n=0,i&&(i=!1,a())},a=function(){n=goog.global.setTimeout(s,e),t.apply(o,r)};return function(t){r=arguments,n?i=!0:a()}},goog.functions.rateLimit=function(t,e,o){var n=0,i=function(){n=0};return function(r){n||(n=goog.global.setTimeout(i,e),t.apply(o,arguments))}},goog.labs={},goog.labs.userAgent={},goog.labs.userAgent.util={},goog.labs.userAgent.util.getNativeUserAgentString_=function(){var t=goog.labs.userAgent.util.getNavigator_();return t&&(t=t.userAgent)?t:""},goog.labs.userAgent.util.getNavigator_=function(){return goog.global.navigator},goog.labs.userAgent.util.userAgent_=goog.labs.userAgent.util.getNativeUserAgentString_(),goog.labs.userAgent.util.setUserAgent=function(t){goog.labs.userAgent.util.userAgent_=t||goog.labs.userAgent.util.getNativeUserAgentString_()},goog.labs.userAgent.util.getUserAgent=function(){return goog.labs.userAgent.util.userAgent_},goog.labs.userAgent.util.matchUserAgent=function(t){var e=goog.labs.userAgent.util.getUserAgent();return goog.string.contains(e,t)},goog.labs.userAgent.util.matchUserAgentIgnoreCase=function(t){var e=goog.labs.userAgent.util.getUserAgent();return goog.string.caseInsensitiveContains(e,t)},goog.labs.userAgent.util.extractVersionTuples=function(t){for(var e,o=RegExp("(\\w[\\w ]+)/([^\\s]+)\\s*(?:\\((.*?)\\))?","g"),n=[];e=o.exec(t);)n.push([e[1],e[2],e[3]||void 0]);return n},goog.object={},goog.object.is=function(t,e){return t===e?0!==t||1/t==1/e:t!==t&&e!==e},goog.object.forEach=function(t,e,o){for(var n in t)e.call(o,t[n],n,t)},goog.object.filter=function(t,e,o){var n,i={};for(n in t)e.call(o,t[n],n,t)&&(i[n]=t[n]);return i},goog.object.map=function(t,e,o){var n,i={};for(n in t)i[n]=e.call(o,t[n],n,t);return i},goog.object.some=function(t,e,o){for(var n in t)if(e.call(o,t[n],n,t))return!0;return!1},goog.object.every=function(t,e,o){for(var n in t)if(!e.call(o,t[n],n,t))return!1;return!0},goog.object.getCount=function(t){var e,o=0;for(e in t)o++;return o},goog.object.getAnyKey=function(t){for(var e in t)return e},goog.object.getAnyValue=function(t){for(var e in t)return t[e]},goog.object.contains=function(t,e){return goog.object.containsValue(t,e)},goog.object.getValues=function(t){var e,o=[],n=0;for(e in t)o[n++]=t[e];return o},goog.object.getKeys=function(t){var e,o=[],n=0;for(e in t)o[n++]=e;return o},goog.object.getValueByKeys=function(t,e){var o=goog.isArrayLike(e),n=o?e:arguments;for(o=o?0:1;o<n.length&&(t=t[n[o]],goog.isDef(t));o++);return t},goog.object.containsKey=function(t,e){return null!==t&&e in t},goog.object.containsValue=function(t,e){for(var o in t)if(t[o]==e)return!0;return!1},goog.object.findKey=function(t,e,o){for(var n in t)if(e.call(o,t[n],n,t))return n},goog.object.findValue=function(t,e,o){return(e=goog.object.findKey(t,e,o))&&t[e]},goog.object.isEmpty=function(t){for(var e in t)return!1;return!0},goog.object.clear=function(t){for(var e in t)delete t[e]},goog.object.remove=function(t,e){var o;return(o=e in t)&&delete t[e],o},goog.object.add=function(t,e,o){if(null!==t&&e in t)throw Error('The object already contains the key "'+e+'"');goog.object.set(t,e,o)},goog.object.get=function(t,e,o){return null!==t&&e in t?t[e]:o},goog.object.set=function(t,e,o){t[e]=o},goog.object.setIfUndefined=function(t,e,o){return e in t?t[e]:t[e]=o},goog.object.setWithReturnValueIfNotSet=function(t,e,o){return e in t?t[e]:(o=o(),t[e]=o)},goog.object.equals=function(t,e){for(var o in t)if(!(o in e)||t[o]!==e[o])return!1;for(o in e)if(!(o in t))return!1;return!0},goog.object.clone=function(t){var e,o={};for(e in t)o[e]=t[e];return o},goog.object.unsafeClone=function(t){var e=goog.typeOf(t);if("object"==e||"array"==e){if(goog.isFunction(t.clone))return t.clone();e="array"==e?[]:{};for(var o in t)e[o]=goog.object.unsafeClone(t[o]);return e}return t},goog.object.transpose=function(t){var e,o={};for(e in t)o[t[e]]=e;return o},goog.object.PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),goog.object.extend=function(t,e){for(var o,n,i=1;i<arguments.length;i++){n=arguments[i];for(o in n)t[o]=n[o];for(var r=0;r<goog.object.PROTOTYPE_FIELDS_.length;r++)o=goog.object.PROTOTYPE_FIELDS_[r],Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}},goog.object.create=function(t){var e=arguments.length;if(1==e&&goog.isArray(arguments[0]))return goog.object.create.apply(null,arguments[0]);if(e%2)throw Error("Uneven number of arguments");for(var o={},n=0;n<e;n+=2)o[arguments[n]]=arguments[n+1];return o},goog.object.createSet=function(t){var e=arguments.length;if(1==e&&goog.isArray(arguments[0]))return goog.object.createSet.apply(null,arguments[0]);for(var o={},n=0;n<e;n++)o[arguments[n]]=!0;return o},goog.object.createImmutableView=function(t){var e=t;return Object.isFrozen&&!Object.isFrozen(t)&&(e=Object.create(t),Object.freeze(e)),e},goog.object.isImmutableView=function(t){return!!Object.isFrozen&&Object.isFrozen(t)},goog.object.getAllPropertyNames=function(t,e,o){if(!t)return[];if(!Object.getOwnPropertyNames||!Object.getPrototypeOf)return goog.object.getKeys(t);for(var n={};t&&(t!==Object.prototype||e)&&(t!==Function.prototype||o);){for(var i=Object.getOwnPropertyNames(t),r=0;r<i.length;r++)n[i[r]]=!0;t=Object.getPrototypeOf(t)}return goog.object.getKeys(n)},goog.labs.userAgent.browser={},goog.labs.userAgent.browser.matchOpera_=function(){return goog.labs.userAgent.util.matchUserAgent("Opera")},goog.labs.userAgent.browser.matchIE_=function(){return goog.labs.userAgent.util.matchUserAgent("Trident")||goog.labs.userAgent.util.matchUserAgent("MSIE")},goog.labs.userAgent.browser.matchEdge_=function(){return goog.labs.userAgent.util.matchUserAgent("Edge")},goog.labs.userAgent.browser.matchFirefox_=function(){return goog.labs.userAgent.util.matchUserAgent("Firefox")},goog.labs.userAgent.browser.matchSafari_=function(){return goog.labs.userAgent.util.matchUserAgent("Safari")&&!(goog.labs.userAgent.browser.matchChrome_()||goog.labs.userAgent.browser.matchCoast_()||goog.labs.userAgent.browser.matchOpera_()||goog.labs.userAgent.browser.matchEdge_()||goog.labs.userAgent.browser.isSilk()||goog.labs.userAgent.util.matchUserAgent("Android"))},goog.labs.userAgent.browser.matchCoast_=function(){return goog.labs.userAgent.util.matchUserAgent("Coast")},goog.labs.userAgent.browser.matchIosWebview_=function(){return(goog.labs.userAgent.util.matchUserAgent("iPad")||goog.labs.userAgent.util.matchUserAgent("iPhone"))&&!goog.labs.userAgent.browser.matchSafari_()&&!goog.labs.userAgent.browser.matchChrome_()&&!goog.labs.userAgent.browser.matchCoast_()&&goog.labs.userAgent.util.matchUserAgent("AppleWebKit")},goog.labs.userAgent.browser.matchChrome_=function(){return(goog.labs.userAgent.util.matchUserAgent("Chrome")||goog.labs.userAgent.util.matchUserAgent("CriOS"))&&!goog.labs.userAgent.browser.matchEdge_()},goog.labs.userAgent.browser.matchAndroidBrowser_=function(){return goog.labs.userAgent.util.matchUserAgent("Android")&&!(goog.labs.userAgent.browser.isChrome()||goog.labs.userAgent.browser.isFirefox()||goog.labs.userAgent.browser.isOpera()||goog.labs.userAgent.browser.isSilk())},goog.labs.userAgent.browser.isOpera=goog.labs.userAgent.browser.matchOpera_,goog.labs.userAgent.browser.isIE=goog.labs.userAgent.browser.matchIE_,goog.labs.userAgent.browser.isEdge=goog.labs.userAgent.browser.matchEdge_,goog.labs.userAgent.browser.isFirefox=goog.labs.userAgent.browser.matchFirefox_,goog.labs.userAgent.browser.isSafari=goog.labs.userAgent.browser.matchSafari_,goog.labs.userAgent.browser.isCoast=goog.labs.userAgent.browser.matchCoast_,goog.labs.userAgent.browser.isIosWebview=goog.labs.userAgent.browser.matchIosWebview_,goog.labs.userAgent.browser.isChrome=goog.labs.userAgent.browser.matchChrome_,goog.labs.userAgent.browser.isAndroidBrowser=goog.labs.userAgent.browser.matchAndroidBrowser_,goog.labs.userAgent.browser.isSilk=function(){return goog.labs.userAgent.util.matchUserAgent("Silk")},goog.labs.userAgent.browser.getVersion=function(){function t(t){return t=goog.array.find(t,n),o[t]||""}var e=goog.labs.userAgent.util.getUserAgent();if(goog.labs.userAgent.browser.isIE())return goog.labs.userAgent.browser.getIEVersion_(e);e=goog.labs.userAgent.util.extractVersionTuples(e);var o={};goog.array.forEach(e,function(t){o[t[0]]=t[1]});var n=goog.partial(goog.object.containsKey,o);return goog.labs.userAgent.browser.isOpera()?t(["Version","Opera"]):goog.labs.userAgent.browser.isEdge()?t(["Edge"]):goog.labs.userAgent.browser.isChrome()?t(["Chrome","CriOS"]):(e=e[2])&&e[1]||""},goog.labs.userAgent.browser.isVersionOrHigher=function(t){return 0<=goog.string.compareVersions(goog.labs.userAgent.browser.getVersion(),t)},goog.labs.userAgent.browser.getIEVersion_=function(t){var e=/rv: *([\d\.]*)/.exec(t);if(e&&e[1])return e[1];e="";var o=/MSIE +([\d\.]+)/.exec(t);if(o&&o[1])if(t=/Trident\/(\d.\d)/.exec(t),"7.0"==o[1])if(t&&t[1])switch(t[1]){case"4.0":e="8.0";break;case"5.0":e="9.0";break;case"6.0":e="10.0";break;case"7.0":e="11.0"}else e="7.0";else e=o[1];return e},goog.labs.userAgent.engine={},goog.labs.userAgent.engine.isPresto=function(){return goog.labs.userAgent.util.matchUserAgent("Presto")},goog.labs.userAgent.engine.isTrident=function(){return goog.labs.userAgent.util.matchUserAgent("Trident")||goog.labs.userAgent.util.matchUserAgent("MSIE")},goog.labs.userAgent.engine.isEdge=function(){return goog.labs.userAgent.util.matchUserAgent("Edge")},goog.labs.userAgent.engine.isWebKit=function(){return goog.labs.userAgent.util.matchUserAgentIgnoreCase("WebKit")&&!goog.labs.userAgent.engine.isEdge()},goog.labs.userAgent.engine.isGecko=function(){return goog.labs.userAgent.util.matchUserAgent("Gecko")&&!goog.labs.userAgent.engine.isWebKit()&&!goog.labs.userAgent.engine.isTrident()&&!goog.labs.userAgent.engine.isEdge()},goog.labs.userAgent.engine.getVersion=function(){var t=goog.labs.userAgent.util.getUserAgent();if(t){t=goog.labs.userAgent.util.extractVersionTuples(t);var e=goog.labs.userAgent.engine.getEngineTuple_(t);if(e)return"Gecko"==e[0]?goog.labs.userAgent.engine.getVersionForKey_(t,"Firefox"):e[1];t=t[0];var o;if(t&&(o=t[2])&&(o=/Trident\/([^\s;]+)/.exec(o)))return o[1]}return""},goog.labs.userAgent.engine.getEngineTuple_=function(t){if(!goog.labs.userAgent.engine.isEdge())return t[1];for(var e=0;e<t.length;e++){var o=t[e];if("Edge"==o[0])return o}},goog.labs.userAgent.engine.isVersionOrHigher=function(t){return 0<=goog.string.compareVersions(goog.labs.userAgent.engine.getVersion(),t)},goog.labs.userAgent.engine.getVersionForKey_=function(t,e){var o=goog.array.find(t,function(t){return e==t[0]});return o&&o[1]||""},goog.async.throwException=function(t){goog.global.setTimeout(function(){throw t},0)},goog.async.nextTick=function(t,e,o){var n=t;e&&(n=goog.bind(t,e)),n=goog.async.nextTick.wrapCallback_(n),goog.isFunction(goog.global.setImmediate)&&(o||goog.async.nextTick.useSetImmediate_())?goog.global.setImmediate(n):(goog.async.nextTick.setImmediate_||(goog.async.nextTick.setImmediate_=goog.async.nextTick.getSetImmediateEmulator_()),goog.async.nextTick.setImmediate_(n))},goog.async.nextTick.useSetImmediate_=function(){return!(goog.global.Window&&goog.global.Window.prototype&&!goog.labs.userAgent.browser.isEdge()&&goog.global.Window.prototype.setImmediate==goog.global.setImmediate)},goog.async.nextTick.getSetImmediateEmulator_=function(){var t=goog.global.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!goog.labs.userAgent.engine.isPresto()&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow;t=e.document,t.open(),t.write(""),t.close();var o="callImmediate"+Math.random(),n="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=goog.bind(function(t){"*"!=n&&t.origin!=n||t.data!=o||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(o,n)}}}),void 0!==t&&!goog.labs.userAgent.browser.isIE()){var e=new t,o={},n=o;return e.port1.onmessage=function(){if(goog.isDef(o.next)){o=o.next;var t=o.cb;o.cb=null,t()}},function(t){n.next={cb:t},n=n.next,e.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){goog.global.setTimeout(t,0)}},goog.async.nextTick.wrapCallback_=goog.functions.identity,goog.debug.entryPointRegistry.register(function(t){goog.async.nextTick.wrapCallback_=t}),goog.async.run=function(t,e){goog.async.run.schedule_||goog.async.run.initializeRunner_(),goog.async.run.workQueueScheduled_||(goog.async.run.schedule_(),goog.async.run.workQueueScheduled_=!0),goog.async.run.workQueue_.add(t,e)},goog.async.run.initializeRunner_=function(){if(-1!=String(goog.global.Promise).indexOf("[native code]")){var t=goog.global.Promise.resolve(void 0);goog.async.run.schedule_=function(){t.then(goog.async.run.processWorkQueue)}}else goog.async.run.schedule_=function(){goog.async.nextTick(goog.async.run.processWorkQueue)}},goog.async.run.forceNextTick=function(t){goog.async.run.schedule_=function(){goog.async.nextTick(goog.async.run.processWorkQueue),t&&t(goog.async.run.processWorkQueue)}},goog.async.run.workQueueScheduled_=!1,goog.async.run.workQueue_=new goog.async.WorkQueue,goog.DEBUG&&(goog.async.run.resetQueue=function(){goog.async.run.workQueueScheduled_=!1,goog.async.run.workQueue_=new goog.async.WorkQueue});goog.async.run.processWorkQueue=function(){for(var t;t=goog.async.run.workQueue_.remove();){try{t.fn.call(t.scope)}catch(t){goog.async.throwException(t)}goog.async.run.workQueue_.returnUnused(t)}goog.async.run.workQueueScheduled_=!1},goog.promise={},goog.promise.Resolver=function(){},goog.Promise=function(t,e){if(this.state_=goog.Promise.State_.PENDING,this.result_=void 0,this.callbackEntriesTail_=this.callbackEntries_=this.parent_=null,this.executing_=!1,0<goog.Promise.UNHANDLED_REJECTION_DELAY?this.unhandledRejectionId_=0:0==goog.Promise.UNHANDLED_REJECTION_DELAY&&(this.hadUnhandledRejection_=!1),goog.Promise.LONG_STACK_TRACES&&(this.stack_=[],this.addStackTrace_(Error("created")),this.currentStep_=0),t!=goog.nullFunction)try{var o=this;t.call(e,function(t){o.resolve_(goog.Promise.State_.FULFILLED,t)},function(t){if(goog.DEBUG&&!(t instanceof goog.Promise.CancellationError))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}o.resolve_(goog.Promise.State_.REJECTED,t)})}catch(t){this.resolve_(goog.Promise.State_.REJECTED,t)}},goog.Promise.LONG_STACK_TRACES=!1,goog.Promise.UNHANDLED_REJECTION_DELAY=0,goog.Promise.State_={PENDING:0,BLOCKED:1,FULFILLED:2,REJECTED:3},goog.Promise.CallbackEntry_=function(){this.next=this.context=this.onRejected=this.onFulfilled=this.child=null,this.always=!1},goog.Promise.CallbackEntry_.prototype.reset=function(){this.context=this.onRejected=this.onFulfilled=this.child=null,this.always=!1},goog.Promise.DEFAULT_MAX_UNUSED=100,goog.Promise.freelist_=new goog.async.FreeList(function(){return new goog.Promise.CallbackEntry_},function(t){t.reset()},goog.Promise.DEFAULT_MAX_UNUSED),goog.Promise.getCallbackEntry_=function(t,e,o){var n=goog.Promise.freelist_.get();return n.onFulfilled=t,n.onRejected=e,n.context=o,n},goog.Promise.returnEntry_=function(t){goog.Promise.freelist_.put(t)},goog.Promise.resolve=function(t){if(t instanceof goog.Promise)return t;var e=new goog.Promise(goog.nullFunction);return e.resolve_(goog.Promise.State_.FULFILLED,t),e},goog.Promise.reject=function(t){return new goog.Promise(function(e,o){o(t)})},goog.Promise.resolveThen_=function(t,e,o){goog.Promise.maybeThen_(t,e,o,null)||goog.async.run(goog.partial(e,t))},goog.Promise.race=function(t){return new goog.Promise(function(e,o){t.length||e(void 0);for(var n,i=0;i<t.length;i++)n=t[i],goog.Promise.resolveThen_(n,e,o)})},goog.Promise.all=function(t){return new goog.Promise(function(e,o){var n=t.length,i=[];if(n)for(var r,s=function(t,o){n--,i[t]=o,0==n&&e(i)},a=function(t){o(t)},l=0;l<t.length;l++)r=t[l],goog.Promise.resolveThen_(r,goog.partial(s,l),a);else e(i)})},goog.Promise.allSettled=function(t){return new goog.Promise(function(e,o){var n=t.length,i=[];if(n)for(var r,s=function(t,o,r){n--,i[t]=o?{fulfilled:!0,value:r}:{fulfilled:!1,reason:r},0==n&&e(i)},a=0;a<t.length;a++)r=t[a],goog.Promise.resolveThen_(r,goog.partial(s,a,!0),goog.partial(s,a,!1));else e(i)})},goog.Promise.firstFulfilled=function(t){return new goog.Promise(function(e,o){var n=t.length,i=[];if(n)for(var r,s=function(t){e(t)},a=function(t,e){n--,i[t]=e,0==n&&o(i)},l=0;l<t.length;l++)r=t[l],goog.Promise.resolveThen_(r,s,goog.partial(a,l));else e(void 0)})},goog.Promise.withResolver=function(){var t,e,o=new goog.Promise(function(o,n){t=o,e=n});return new goog.Promise.Resolver_(o,t,e)},goog.Promise.prototype.then=function(t,e,o){return null!=t&&goog.asserts.assertFunction(t,"opt_onFulfilled should be a function."),null!=e&&goog.asserts.assertFunction(e,"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?"),goog.Promise.LONG_STACK_TRACES&&this.addStackTrace_(Error("then")),this.addChildPromise_(goog.isFunction(t)?t:null,goog.isFunction(e)?e:null,o)},goog.Thenable.addImplementation(goog.Promise),goog.Promise.prototype.thenVoid=function(t,e,o){null!=t&&goog.asserts.assertFunction(t,"opt_onFulfilled should be a function."),null!=e&&goog.asserts.assertFunction(e,"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?"),goog.Promise.LONG_STACK_TRACES&&this.addStackTrace_(Error("then")),this.addCallbackEntry_(goog.Promise.getCallbackEntry_(t||goog.nullFunction,e||null,o))},goog.Promise.prototype.thenAlways=function(t,e){goog.Promise.LONG_STACK_TRACES&&this.addStackTrace_(Error("thenAlways"));var o=goog.Promise.getCallbackEntry_(t,t,e);return o.always=!0,this.addCallbackEntry_(o),this},goog.Promise.prototype.thenCatch=function(t,e){return goog.Promise.LONG_STACK_TRACES&&this.addStackTrace_(Error("thenCatch")),this.addChildPromise_(null,t,e)},goog.Promise.prototype.cancel=function(t){this.state_==goog.Promise.State_.PENDING&&goog.async.run(function(){var e=new goog.Promise.CancellationError(t);this.cancelInternal_(e)},this)},goog.Promise.prototype.cancelInternal_=function(t){this.state_==goog.Promise.State_.PENDING&&(this.parent_?(this.parent_.cancelChild_(this,t),this.parent_=null):this.resolve_(goog.Promise.State_.REJECTED,t))},goog.Promise.prototype.cancelChild_=function(t,e){if(this.callbackEntries_){for(var o=0,n=null,i=null,r=this.callbackEntries_;r&&(r.always||(o++,r.child==t&&(n=r),!(n&&1<o)));r=r.next)n||(i=r);n&&(this.state_==goog.Promise.State_.PENDING&&1==o?this.cancelInternal_(e):(i?this.removeEntryAfter_(i):this.popEntry_(),this.executeCallback_(n,goog.Promise.State_.REJECTED,e)))}},goog.Promise.prototype.addCallbackEntry_=function(t){this.hasEntry_()||this.state_!=goog.Promise.State_.FULFILLED&&this.state_!=goog.Promise.State_.REJECTED||this.scheduleCallbacks_(),this.queueEntry_(t)},goog.Promise.prototype.addChildPromise_=function(t,e,o){var n=goog.Promise.getCallbackEntry_(null,null,null);return n.child=new goog.Promise(function(i,r){n.onFulfilled=t?function(e){try{var n=t.call(o,e);i(n)}catch(t){r(t)}}:i,n.onRejected=e?function(t){try{var n=e.call(o,t);!goog.isDef(n)&&t instanceof goog.Promise.CancellationError?r(t):i(n)}catch(t){r(t)}}:r}),n.child.parent_=this,this.addCallbackEntry_(n),n.child},goog.Promise.prototype.unblockAndFulfill_=function(t){goog.asserts.assert(this.state_==goog.Promise.State_.BLOCKED),this.state_=goog.Promise.State_.PENDING,this.resolve_(goog.Promise.State_.FULFILLED,t)},goog.Promise.prototype.unblockAndReject_=function(t){goog.asserts.assert(this.state_==goog.Promise.State_.BLOCKED),this.state_=goog.Promise.State_.PENDING,this.resolve_(goog.Promise.State_.REJECTED,t)},goog.Promise.prototype.resolve_=function(t,e){this.state_==goog.Promise.State_.PENDING&&(this===e&&(t=goog.Promise.State_.REJECTED,e=new TypeError("Promise cannot resolve to itself")),this.state_=goog.Promise.State_.BLOCKED,goog.Promise.maybeThen_(e,this.unblockAndFulfill_,this.unblockAndReject_,this)||(this.result_=e,this.state_=t,this.parent_=null,this.scheduleCallbacks_(),t!=goog.Promise.State_.REJECTED||e instanceof goog.Promise.CancellationError||goog.Promise.addUnhandledRejection_(this,e)))},goog.Promise.maybeThen_=function(t,e,o,n){if(t instanceof goog.Promise)return t.thenVoid(e,o,n),!0;if(goog.Thenable.isImplementedBy(t))return t.then(e,o,n),!0;if(goog.isObject(t))try{var i=t.then;if(goog.isFunction(i))return goog.Promise.tryThen_(t,i,e,o,n),!0}catch(t){return o.call(n,t),!0}return!1},goog.Promise.tryThen_=function(t,e,o,n,i){var r=!1,s=function(t){r||(r=!0,o.call(i,t))},a=function(t){r||(r=!0,n.call(i,t))};try{e.call(t,s,a)}catch(t){a(t)}},goog.Promise.prototype.scheduleCallbacks_=function(){this.executing_||(this.executing_=!0,goog.async.run(this.executeCallbacks_,this))},goog.Promise.prototype.hasEntry_=function(){return!!this.callbackEntries_},goog.Promise.prototype.queueEntry_=function(t){goog.asserts.assert(null!=t.onFulfilled),this.callbackEntriesTail_?this.callbackEntriesTail_.next=t:this.callbackEntries_=t,this.callbackEntriesTail_=t},goog.Promise.prototype.popEntry_=function(){var t=null;return this.callbackEntries_&&(t=this.callbackEntries_,this.callbackEntries_=t.next,t.next=null),this.callbackEntries_||(this.callbackEntriesTail_=null),null!=t&&goog.asserts.assert(null!=t.onFulfilled),t},goog.Promise.prototype.removeEntryAfter_=function(t){goog.asserts.assert(this.callbackEntries_),goog.asserts.assert(null!=t),t.next==this.callbackEntriesTail_&&(this.callbackEntriesTail_=t),t.next=t.next.next},goog.Promise.prototype.executeCallbacks_=function(){for(var t;t=this.popEntry_();)goog.Promise.LONG_STACK_TRACES&&this.currentStep_++,this.executeCallback_(t,this.state_,this.result_);this.executing_=!1},goog.Promise.prototype.executeCallback_=function(t,e,o){if(e==goog.Promise.State_.REJECTED&&t.onRejected&&!t.always&&this.removeUnhandledRejection_(),t.child)t.child.parent_=null,goog.Promise.invokeCallback_(t,e,o);else try{t.always?t.onFulfilled.call(t.context):goog.Promise.invokeCallback_(t,e,o)}catch(t){goog.Promise.handleRejection_.call(null,t)}goog.Promise.returnEntry_(t)},goog.Promise.invokeCallback_=function(t,e,o){e==goog.Promise.State_.FULFILLED?t.onFulfilled.call(t.context,o):t.onRejected&&t.onRejected.call(t.context,o)},goog.Promise.prototype.addStackTrace_=function(t){if(goog.Promise.LONG_STACK_TRACES&&goog.isString(t.stack)){var e=t.stack.split("\n",4)[3];t=t.message,t+=Array(11-t.length).join(" "),this.stack_.push(t+e)}},goog.Promise.prototype.appendLongStack_=function(t){if(goog.Promise.LONG_STACK_TRACES&&t&&goog.isString(t.stack)&&this.stack_.length){for(var e=["Promise trace:"],o=this;o;o=o.parent_){for(var n=this.currentStep_;0<=n;n--)e.push(o.stack_[n]);e.push("Value: ["+(o.state_==goog.Promise.State_.REJECTED?"REJECTED":"FULFILLED")+"] <"+String(o.result_)+">")}t.stack+="\n\n"+e.join("\n")}},goog.Promise.prototype.removeUnhandledRejection_=function(){if(0<goog.Promise.UNHANDLED_REJECTION_DELAY)for(var t=this;t&&t.unhandledRejectionId_;t=t.parent_)goog.global.clearTimeout(t.unhandledRejectionId_),t.unhandledRejectionId_=0;else if(0==goog.Promise.UNHANDLED_REJECTION_DELAY)for(t=this;t&&t.hadUnhandledRejection_;t=t.parent_)t.hadUnhandledRejection_=!1},goog.Promise.addUnhandledRejection_=function(t,e){0<goog.Promise.UNHANDLED_REJECTION_DELAY?t.unhandledRejectionId_=goog.global.setTimeout(function(){t.appendLongStack_(e),goog.Promise.handleRejection_.call(null,e)},goog.Promise.UNHANDLED_REJECTION_DELAY):0==goog.Promise.UNHANDLED_REJECTION_DELAY&&(t.hadUnhandledRejection_=!0,goog.async.run(function(){t.hadUnhandledRejection_&&(t.appendLongStack_(e),goog.Promise.handleRejection_.call(null,e))}))},goog.Promise.handleRejection_=goog.async.throwException,goog.Promise.setUnhandledRejectionHandler=function(t){goog.Promise.handleRejection_=t},goog.Promise.CancellationError=function(t){goog.debug.Error.call(this,t)},goog.inherits(goog.Promise.CancellationError,goog.debug.Error),goog.Promise.CancellationError.prototype.name="cancel",goog.Promise.Resolver_=function(t,e,o){this.promise=t,this.resolve=e,this.reject=o},goog.disposable={},goog.disposable.IDisposable=function(){},goog.disposable.IDisposable.prototype.dispose=goog.abstractMethod,goog.disposable.IDisposable.prototype.isDisposed=goog.abstractMethod,goog.Disposable=function(){goog.Disposable.MONITORING_MODE!=goog.Disposable.MonitoringMode.OFF&&(goog.Disposable.INCLUDE_STACK_ON_CREATION&&(this.creationStack=Error().stack),goog.Disposable.instances_[goog.getUid(this)]=this),this.disposed_=this.disposed_,this.onDisposeCallbacks_=this.onDisposeCallbacks_},goog.Disposable.MonitoringMode={OFF:0,PERMANENT:1,INTERACTIVE:2},goog.Disposable.MONITORING_MODE=0,goog.Disposable.INCLUDE_STACK_ON_CREATION=!0,goog.Disposable.instances_={},goog.Disposable.getUndisposedObjects=function(){var t,e=[];for(t in goog.Disposable.instances_)goog.Disposable.instances_.hasOwnProperty(t)&&e.push(goog.Disposable.instances_[Number(t)]);return e},goog.Disposable.clearUndisposedObjects=function(){goog.Disposable.instances_={}},goog.Disposable.prototype.disposed_=!1,goog.Disposable.prototype.isDisposed=function(){return this.disposed_},goog.Disposable.prototype.getDisposed=goog.Disposable.prototype.isDisposed,goog.Disposable.prototype.dispose=function(){if(!this.disposed_&&(this.disposed_=!0,this.disposeInternal(),goog.Disposable.MONITORING_MODE!=goog.Disposable.MonitoringMode.OFF)){var t=goog.getUid(this);if(goog.Disposable.MONITORING_MODE==goog.Disposable.MonitoringMode.PERMANENT&&!goog.Disposable.instances_.hasOwnProperty(t))throw Error(this+" did not call the goog.Disposable base constructor or was disposed of after a clearUndisposedObjects call");delete goog.Disposable.instances_[t]}},goog.Disposable.prototype.registerDisposable=function(t){this.addOnDisposeCallback(goog.partial(goog.dispose,t))},goog.Disposable.prototype.addOnDisposeCallback=function(t,e){this.disposed_?goog.isDef(e)?t.call(e):t():(this.onDisposeCallbacks_||(this.onDisposeCallbacks_=[]),this.onDisposeCallbacks_.push(goog.isDef(e)?goog.bind(t,e):t))},goog.Disposable.prototype.disposeInternal=function(){if(this.onDisposeCallbacks_)for(;this.onDisposeCallbacks_.length;)this.onDisposeCallbacks_.shift()()},goog.Disposable.isDisposed=function(t){return!(!t||"function"!=typeof t.isDisposed)&&t.isDisposed()},goog.dispose=function(t){t&&"function"==typeof t.dispose&&t.dispose()},goog.disposeAll=function(t){for(var e=0,o=arguments.length;e<o;++e){var n=arguments[e];goog.isArrayLike(n)?goog.disposeAll.apply(null,n):goog.dispose(n)}},goog.labs.userAgent.platform={},goog.labs.userAgent.platform.isAndroid=function(){return goog.labs.userAgent.util.matchUserAgent("Android")},goog.labs.userAgent.platform.isIpod=function(){return goog.labs.userAgent.util.matchUserAgent("iPod")},goog.labs.userAgent.platform.isIphone=function(){return goog.labs.userAgent.util.matchUserAgent("iPhone")&&!goog.labs.userAgent.util.matchUserAgent("iPod")&&!goog.labs.userAgent.util.matchUserAgent("iPad")},goog.labs.userAgent.platform.isIpad=function(){return goog.labs.userAgent.util.matchUserAgent("iPad")},goog.labs.userAgent.platform.isIos=function(){return goog.labs.userAgent.platform.isIphone()||goog.labs.userAgent.platform.isIpad()||goog.labs.userAgent.platform.isIpod()},goog.labs.userAgent.platform.isMacintosh=function(){return goog.labs.userAgent.util.matchUserAgent("Macintosh")},goog.labs.userAgent.platform.isLinux=function(){return goog.labs.userAgent.util.matchUserAgent("Linux")},goog.labs.userAgent.platform.isWindows=function(){return goog.labs.userAgent.util.matchUserAgent("Windows")},goog.labs.userAgent.platform.isChromeOS=function(){return goog.labs.userAgent.util.matchUserAgent("CrOS")},goog.labs.userAgent.platform.getVersion=function(){var t=goog.labs.userAgent.util.getUserAgent(),e="";return goog.labs.userAgent.platform.isWindows()?(e=/Windows (?:NT|Phone) ([0-9.]+)/,e=(t=e.exec(t))?t[1]:"0.0"):goog.labs.userAgent.platform.isIos()?(e=/(?:iPhone|iPod|iPad|CPU)\s+OS\s+(\S+)/,e=(t=e.exec(t))&&t[1].replace(/_/g,".")):goog.labs.userAgent.platform.isMacintosh()?(e=/Mac OS X ([0-9_.]+)/,e=(t=e.exec(t))?t[1].replace(/_/g,"."):"10"):goog.labs.userAgent.platform.isAndroid()?(e=/Android\s+([^\);]+)(\)|;)/,e=(t=e.exec(t))&&t[1]):goog.labs.userAgent.platform.isChromeOS()&&(e=/(?:CrOS\s+(?:i686|x86_64)\s+([0-9.]+))/,e=(t=e.exec(t))&&t[1]),e||""},goog.labs.userAgent.platform.isVersionOrHigher=function(t){return 0<=goog.string.compareVersions(goog.labs.userAgent.platform.getVersion(),t)},goog.reflect={},goog.reflect.object=function(t,e){return e},goog.reflect.objectProperty=function(t,e){return t},goog.reflect.sinkValue=function(t){return goog.reflect.sinkValue[" "](t),t},goog.reflect.sinkValue[" "]=goog.nullFunction,goog.reflect.canAccessProperty=function(t,e){try{return goog.reflect.sinkValue(t[e]),!0}catch(t){}return!1},goog.reflect.cache=function(t,e,o,n){return n=n?n(e):e,Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=o(e)},goog.userAgent={},goog.userAgent.ASSUME_IE=!1,goog.userAgent.ASSUME_EDGE=!1,goog.userAgent.ASSUME_GECKO=!1,goog.userAgent.ASSUME_WEBKIT=!1,goog.userAgent.ASSUME_MOBILE_WEBKIT=!1,goog.userAgent.ASSUME_OPERA=!1,goog.userAgent.ASSUME_ANY_VERSION=!1,goog.userAgent.BROWSER_KNOWN_=goog.userAgent.ASSUME_IE||goog.userAgent.ASSUME_EDGE||goog.userAgent.ASSUME_GECKO||goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_OPERA,goog.userAgent.getUserAgentString=function(){return goog.labs.userAgent.util.getUserAgent()},goog.userAgent.getNavigator=function(){return goog.global.navigator||null},goog.userAgent.OPERA=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_OPERA:goog.labs.userAgent.browser.isOpera(),goog.userAgent.IE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_IE:goog.labs.userAgent.browser.isIE(),goog.userAgent.EDGE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_EDGE:goog.labs.userAgent.engine.isEdge(),goog.userAgent.EDGE_OR_IE=goog.userAgent.EDGE||goog.userAgent.IE,goog.userAgent.GECKO=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_GECKO:goog.labs.userAgent.engine.isGecko(),goog.userAgent.WEBKIT=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_MOBILE_WEBKIT:goog.labs.userAgent.engine.isWebKit(),goog.userAgent.isMobile_=function(){return goog.userAgent.WEBKIT&&goog.labs.userAgent.util.matchUserAgent("Mobile")},goog.userAgent.MOBILE=goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.isMobile_(),goog.userAgent.SAFARI=goog.userAgent.WEBKIT,goog.userAgent.determinePlatform_=function(){var t=goog.userAgent.getNavigator();return t&&t.platform||""},goog.userAgent.PLATFORM=goog.userAgent.determinePlatform_(),goog.userAgent.ASSUME_MAC=!1,goog.userAgent.ASSUME_WINDOWS=!1,goog.userAgent.ASSUME_LINUX=!1,goog.userAgent.ASSUME_X11=!1,goog.userAgent.ASSUME_ANDROID=!1,goog.userAgent.ASSUME_IPHONE=!1,goog.userAgent.ASSUME_IPAD=!1,goog.userAgent.ASSUME_IPOD=!1,goog.userAgent.PLATFORM_KNOWN_=goog.userAgent.ASSUME_MAC||goog.userAgent.ASSUME_WINDOWS||goog.userAgent.ASSUME_LINUX||goog.userAgent.ASSUME_X11||goog.userAgent.ASSUME_ANDROID||goog.userAgent.ASSUME_IPHONE||goog.userAgent.ASSUME_IPAD||goog.userAgent.ASSUME_IPOD,goog.userAgent.MAC=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_MAC:goog.labs.userAgent.platform.isMacintosh(),goog.userAgent.WINDOWS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_WINDOWS:goog.labs.userAgent.platform.isWindows(),goog.userAgent.isLegacyLinux_=function(){return goog.labs.userAgent.platform.isLinux()||goog.labs.userAgent.platform.isChromeOS()},goog.userAgent.LINUX=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_LINUX:goog.userAgent.isLegacyLinux_(),goog.userAgent.isX11_=function(){var t=goog.userAgent.getNavigator();return!!t&&goog.string.contains(t.appVersion||"","X11")},goog.userAgent.X11=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_X11:goog.userAgent.isX11_(),goog.userAgent.ANDROID=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_ANDROID:goog.labs.userAgent.platform.isAndroid(),goog.userAgent.IPHONE=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPHONE:goog.labs.userAgent.platform.isIphone(),goog.userAgent.IPAD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPAD:goog.labs.userAgent.platform.isIpad(),goog.userAgent.IPOD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPOD:goog.labs.userAgent.platform.isIpod(),goog.userAgent.IOS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPHONE||goog.userAgent.ASSUME_IPAD||goog.userAgent.ASSUME_IPOD:goog.labs.userAgent.platform.isIos(),goog.userAgent.determineVersion_=function(){var t="",e=goog.userAgent.getVersionRegexResult_();return e&&(t=e?e[1]:""),goog.userAgent.IE&&null!=(e=goog.userAgent.getDocumentMode_())&&e>parseFloat(t)?String(e):t},goog.userAgent.getVersionRegexResult_=function(){var t=goog.userAgent.getUserAgentString();return goog.userAgent.GECKO?/rv\:([^\);]+)(\)|;)/.exec(t):goog.userAgent.EDGE?/Edge\/([\d\.]+)/.exec(t):goog.userAgent.IE?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):goog.userAgent.WEBKIT?/WebKit\/(\S+)/.exec(t):goog.userAgent.OPERA?/(?:Version)[ \/]?(\S+)/.exec(t):void 0},goog.userAgent.getDocumentMode_=function(){var t=goog.global.document;return t?t.documentMode:void 0},goog.userAgent.VERSION=goog.userAgent.determineVersion_(),goog.userAgent.compare=function(t,e){return goog.string.compareVersions(t,e)},goog.userAgent.isVersionOrHigherCache_={},goog.userAgent.isVersionOrHigher=function(t){return goog.userAgent.ASSUME_ANY_VERSION||goog.reflect.cache(goog.userAgent.isVersionOrHigherCache_,t,function(){return 0<=goog.string.compareVersions(goog.userAgent.VERSION,t)})},goog.userAgent.isVersion=goog.userAgent.isVersionOrHigher,goog.userAgent.isDocumentModeOrHigher=function(t){return Number(goog.userAgent.DOCUMENT_MODE)>=t},goog.userAgent.isDocumentMode=goog.userAgent.isDocumentModeOrHigher,goog.userAgent.DOCUMENT_MODE=function(){var t=goog.global.document,e=goog.userAgent.getDocumentMode_();if(t&&goog.userAgent.IE)return e||("CSS1Compat"==t.compatMode?parseInt(goog.userAgent.VERSION,10):5)}(),goog.events={},$jscomp.scope.purify=function(t){return t()},goog.events.BrowserFeature={HAS_W3C_BUTTON:!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),HAS_W3C_EVENT_SUPPORT:!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),SET_KEY_CODE_TO_PREVENT_DEFAULT:goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),HAS_NAVIGATOR_ONLINE_PROPERTY:!goog.userAgent.WEBKIT||goog.userAgent.isVersionOrHigher("528"),HAS_HTML5_NETWORK_EVENT_SUPPORT:goog.userAgent.GECKO&&goog.userAgent.isVersionOrHigher("1.9b")||goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("8")||goog.userAgent.OPERA&&goog.userAgent.isVersionOrHigher("9.5")||goog.userAgent.WEBKIT&&goog.userAgent.isVersionOrHigher("528"),HTML5_NETWORK_EVENTS_FIRE_ON_BODY:goog.userAgent.GECKO&&!goog.userAgent.isVersionOrHigher("8")||goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),TOUCH_ENABLED:"ontouchstart"in goog.global||!!(goog.global.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!goog.global.navigator||!goog.global.navigator.msMaxTouchPoints),PASSIVE_EVENTS:(0,$jscomp.scope.purify)(function(){if(!goog.global.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});return goog.global.addEventListener("test",goog.nullFunction,e),goog.global.removeEventListener("test",goog.nullFunction,e),t})},goog.events.EventId=function(t){this.id=t},goog.events.EventId.prototype.toString=function(){return this.id},goog.events.Event=function(t,e){this.type=t instanceof goog.events.EventId?String(t):t,this.currentTarget=this.target=e,this.defaultPrevented=this.propagationStopped_=!1,this.returnValue_=!0},goog.events.Event.prototype.stopPropagation=function(){this.propagationStopped_=!0},goog.events.Event.prototype.preventDefault=function(){this.defaultPrevented=!0,this.returnValue_=!1},goog.events.Event.stopPropagation=function(t){t.stopPropagation()},goog.events.Event.preventDefault=function(t){t.preventDefault()},goog.events.getVendorPrefixedName_=function(t){return goog.userAgent.WEBKIT?"webkit"+t:goog.userAgent.OPERA?"o"+t.toLowerCase():t.toLowerCase()},goog.events.EventType={CLICK:"click",RIGHTCLICK:"rightclick",DBLCLICK:"dblclick",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEMOVE:"mousemove",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",SELECTIONCHANGE:"selectionchange",SELECTSTART:"selectstart",WHEEL:"wheel",KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup",BLUR:"blur",FOCUS:"focus",DEACTIVATE:"deactivate",FOCUSIN:goog.userAgent.IE?"focusin":"DOMFocusIn",FOCUSOUT:goog.userAgent.IE?"focusout":"DOMFocusOut",CHANGE:"change",RESET:"reset",SELECT:"select",SUBMIT:"submit",INPUT:"input",PROPERTYCHANGE:"propertychange",DRAGSTART:"dragstart",DRAG:"drag",DRAGENTER:"dragenter",DRAGOVER:"dragover",DRAGLEAVE:"dragleave",DROP:"drop",DRAGEND:"dragend",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",TOUCHCANCEL:"touchcancel",BEFOREUNLOAD:"beforeunload",CONSOLEMESSAGE:"consolemessage",CONTEXTMENU:"contextmenu",DEVICEMOTION:"devicemotion",DEVICEORIENTATION:"deviceorientation",DOMCONTENTLOADED:"DOMContentLoaded",ERROR:"error",HELP:"help",LOAD:"load",LOSECAPTURE:"losecapture",ORIENTATIONCHANGE:"orientationchange",READYSTATECHANGE:"readystatechange",RESIZE:"resize",SCROLL:"scroll",UNLOAD:"unload",CANPLAY:"canplay",CANPLAYTHROUGH:"canplaythrough",DURATIONCHANGE:"durationchange",EMPTIED:"emptied",ENDED:"ended",LOADEDDATA:"loadeddata",LOADEDMETADATA:"loadedmetadata",PAUSE:"pause",PLAY:"play",PLAYING:"playing",RATECHANGE:"ratechange",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",TIMEUPDATE:"timeupdate",VOLUMECHANGE:"volumechange",WAITING:"waiting",SOURCEOPEN:"sourceopen",SOURCEENDED:"sourceended",SOURCECLOSED:"sourceclosed",ABORT:"abort",UPDATE:"update",UPDATESTART:"updatestart",UPDATEEND:"updateend",HASHCHANGE:"hashchange",PAGEHIDE:"pagehide",PAGESHOW:"pageshow",POPSTATE:"popstate",COPY:"copy",PASTE:"paste",CUT:"cut",BEFORECOPY:"beforecopy",BEFORECUT:"beforecut",BEFOREPASTE:"beforepaste",ONLINE:"online",OFFLINE:"offline",MESSAGE:"message",CONNECT:"connect",INSTALL:"install",ACTIVATE:"activate",FETCH:"fetch",FOREIGNFETCH:"foreignfetch",MESSAGEERROR:"messageerror",STATECHANGE:"statechange",UPDATEFOUND:"updatefound",CONTROLLERCHANGE:"controllerchange",ANIMATIONSTART:goog.events.getVendorPrefixedName_("AnimationStart"),ANIMATIONEND:goog.events.getVendorPrefixedName_("AnimationEnd"),ANIMATIONITERATION:goog.events.getVendorPrefixedName_("AnimationIteration"),TRANSITIONEND:goog.events.getVendorPrefixedName_("TransitionEnd"),POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTERCANCEL:"pointercancel",POINTERMOVE:"pointermove",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",GOTPOINTERCAPTURE:"gotpointercapture",LOSTPOINTERCAPTURE:"lostpointercapture",MSGESTURECHANGE:"MSGestureChange",MSGESTUREEND:"MSGestureEnd",MSGESTUREHOLD:"MSGestureHold",MSGESTURESTART:"MSGestureStart",MSGESTURETAP:"MSGestureTap",MSGOTPOINTERCAPTURE:"MSGotPointerCapture",MSINERTIASTART:"MSInertiaStart",MSLOSTPOINTERCAPTURE:"MSLostPointerCapture",MSPOINTERCANCEL:"MSPointerCancel",MSPOINTERDOWN:"MSPointerDown",MSPOINTERENTER:"MSPointerEnter",MSPOINTERHOVER:"MSPointerHover",MSPOINTERLEAVE:"MSPointerLeave",MSPOINTERMOVE:"MSPointerMove",MSPOINTEROUT:"MSPointerOut",MSPOINTEROVER:"MSPointerOver",MSPOINTERUP:"MSPointerUp",TEXT:"text",TEXTINPUT:goog.userAgent.IE?"textinput":"textInput",COMPOSITIONSTART:"compositionstart",COMPOSITIONUPDATE:"compositionupdate",COMPOSITIONEND:"compositionend",BEFOREINPUT:"beforeinput",EXIT:"exit",LOADABORT:"loadabort",LOADCOMMIT:"loadcommit",LOADREDIRECT:"loadredirect",LOADSTART:"loadstart",LOADSTOP:"loadstop",RESPONSIVE:"responsive",SIZECHANGED:"sizechanged",UNRESPONSIVE:"unresponsive",VISIBILITYCHANGE:"visibilitychange",STORAGE:"storage",DOMSUBTREEMODIFIED:"DOMSubtreeModified",DOMNODEINSERTED:"DOMNodeInserted",DOMNODEREMOVED:"DOMNodeRemoved",DOMNODEREMOVEDFROMDOCUMENT:"DOMNodeRemovedFromDocument",DOMNODEINSERTEDINTODOCUMENT:"DOMNodeInsertedIntoDocument",DOMATTRMODIFIED:"DOMAttrModified",DOMCHARACTERDATAMODIFIED:"DOMCharacterDataModified",BEFOREPRINT:"beforeprint",AFTERPRINT:"afterprint"},goog.events.BrowserEvent=function(t,e){goog.events.Event.call(this,t?t.type:""),this.relatedTarget=this.currentTarget=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0,this.key="",this.charCode=this.keyCode=0,this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.platformModifierKey=!1,this.event_=null,t&&this.init(t,e)},goog.inherits(goog.events.BrowserEvent,goog.events.Event),goog.events.BrowserEvent.MouseButton={LEFT:0,MIDDLE:1,RIGHT:2},goog.events.BrowserEvent.IEButtonMap=[1,4,2],goog.events.BrowserEvent.prototype.init=function(t,e){var o=this.type=t.type,n=t.changedTouches?t.changedTouches[0]:null;this.target=t.target||t.srcElement,this.currentTarget=e;var i=t.relatedTarget;i?goog.userAgent.GECKO&&(goog.reflect.canAccessProperty(i,"nodeName")||(i=null)):o==goog.events.EventType.MOUSEOVER?i=t.fromElement:o==goog.events.EventType.MOUSEOUT&&(i=t.toElement),this.relatedTarget=i,goog.isNull(n)?(this.offsetX=goog.userAgent.WEBKIT||void 0!==t.offsetX?t.offsetX:t.layerX,this.offsetY=goog.userAgent.WEBKIT||void 0!==t.offsetY?t.offsetY:t.layerY,this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=t.button,this.keyCode=t.keyCode||0,this.key=t.key||"",this.charCode=t.charCode||("keypress"==o?t.keyCode:0),this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.platformModifierKey=goog.userAgent.MAC?t.metaKey:t.ctrlKey,this.state=t.state,this.event_=t,t.defaultPrevented&&this.preventDefault()},goog.events.BrowserEvent.prototype.isButton=function(t){return goog.events.BrowserFeature.HAS_W3C_BUTTON?this.event_.button==t:"click"==this.type?t==goog.events.BrowserEvent.MouseButton.LEFT:!!(this.event_.button&goog.events.BrowserEvent.IEButtonMap[t])},goog.events.BrowserEvent.prototype.isMouseActionButton=function(){return this.isButton(goog.events.BrowserEvent.MouseButton.LEFT)&&!(goog.userAgent.WEBKIT&&goog.userAgent.MAC&&this.ctrlKey)},goog.events.BrowserEvent.prototype.stopPropagation=function(){goog.events.BrowserEvent.superClass_.stopPropagation.call(this),this.event_.stopPropagation?this.event_.stopPropagation():this.event_.cancelBubble=!0},goog.events.BrowserEvent.prototype.preventDefault=function(){goog.events.BrowserEvent.superClass_.preventDefault.call(this);var t=this.event_;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,goog.events.BrowserFeature.SET_KEY_CODE_TO_PREVENT_DEFAULT)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},goog.events.BrowserEvent.prototype.getBrowserEvent=function(){return this.event_},goog.events.Listenable=function(){},goog.events.Listenable.IMPLEMENTED_BY_PROP="closure_listenable_"+(1e6*Math.random()|0),goog.events.Listenable.addImplementation=function(t){t.prototype[goog.events.Listenable.IMPLEMENTED_BY_PROP]=!0},goog.events.Listenable.isImplementedBy=function(t){return!(!t||!t[goog.events.Listenable.IMPLEMENTED_BY_PROP])},goog.events.ListenableKey=function(){},goog.events.ListenableKey.counter_=0,goog.events.ListenableKey.reserveKey=function(){return++goog.events.ListenableKey.counter_},goog.events.Listener=function(t,e,o,n,i,r){goog.events.Listener.ENABLE_MONITORING&&(this.creationStack=Error().stack),this.listener=t,this.proxy=e,this.src=o,this.type=n,this.capture=!!i,this.handler=r,this.key=goog.events.ListenableKey.reserveKey(),this.removed=this.callOnce=!1},goog.events.Listener.ENABLE_MONITORING=!1,goog.events.Listener.prototype.markAsRemoved=function(){this.removed=!0,this.handler=this.src=this.proxy=this.listener=null},goog.events.ListenerMap=function(t){this.src=t,this.listeners={},this.typeCount_=0},goog.events.ListenerMap.prototype.getTypeCount=function(){return this.typeCount_},goog.events.ListenerMap.prototype.getListenerCount=function(){var t,e=0;for(t in this.listeners)e+=this.listeners[t].length;return e},goog.events.ListenerMap.prototype.add=function(t,e,o,n,i){var r=t.toString();(t=this.listeners[r])||(t=this.listeners[r]=[],this.typeCount_++);var s=goog.events.ListenerMap.findListenerIndex_(t,e,n,i);return-1<s?(e=t[s],o||(e.callOnce=!1)):(e=new goog.events.Listener(e,null,this.src,r,!!n,i),e.callOnce=o,t.push(e)),e},goog.events.ListenerMap.prototype.remove=function(t,e,o,n){if(!((t=t.toString())in this.listeners))return!1;var i=this.listeners[t];return-1<(e=goog.events.ListenerMap.findListenerIndex_(i,e,o,n))&&(i[e].markAsRemoved(),goog.array.removeAt(i,e),0==i.length&&(delete this.listeners[t],this.typeCount_--),!0)},goog.events.ListenerMap.prototype.removeByKey=function(t){var e=t.type;if(!(e in this.listeners))return!1;var o=goog.array.remove(this.listeners[e],t);return o&&(t.markAsRemoved(),0==this.listeners[e].length&&(delete this.listeners[e],this.typeCount_--)),o},goog.events.ListenerMap.prototype.removeAll=function(t){t=t&&t.toString();var e,o=0;for(e in this.listeners)if(!t||e==t){for(var n=this.listeners[e],i=0;i<n.length;i++)++o,n[i].markAsRemoved();delete this.listeners[e],this.typeCount_--}return o},goog.events.ListenerMap.prototype.getListeners=function(t,e){var o=this.listeners[t.toString()],n=[];if(o)for(var i=0;i<o.length;++i){var r=o[i];r.capture==e&&n.push(r)}return n},goog.events.ListenerMap.prototype.getListener=function(t,e,o,n){t=this.listeners[t.toString()];var i=-1;return t&&(i=goog.events.ListenerMap.findListenerIndex_(t,e,o,n)),-1<i?t[i]:null},goog.events.ListenerMap.prototype.hasListener=function(t,e){var o=goog.isDef(t),n=o?t.toString():"",i=goog.isDef(e);return goog.object.some(this.listeners,function(t,r){for(var s=0;s<t.length;++s)if(!(o&&t[s].type!=n||i&&t[s].capture!=e))return!0;return!1})},goog.events.ListenerMap.findListenerIndex_=function(t,e,o,n){for(var i=0;i<t.length;++i){var r=t[i];if(!r.removed&&r.listener==e&&r.capture==!!o&&r.handler==n)return i}return-1},goog.events.LISTENER_MAP_PROP_="closure_lm_"+(1e6*Math.random()|0),goog.events.onString_="on",goog.events.onStringMap_={},goog.events.CaptureSimulationMode={OFF_AND_FAIL:0,OFF_AND_SILENT:1,ON:2},goog.events.CAPTURE_SIMULATION_MODE=2,goog.events.listenerCountEstimate_=0,goog.events.listen=function(t,e,o,n,i){if(n&&n.once)return goog.events.listenOnce(t,e,o,n,i);if(goog.isArray(e)){for(var r=0;r<e.length;r++)goog.events.listen(t,e[r],o,n,i);return null}return o=goog.events.wrapListener(o),goog.events.Listenable.isImplementedBy(t)?(n=goog.isObject(n)?!!n.capture:!!n,t.listen(e,o,n,i)):goog.events.listen_(t,e,o,!1,n,i)},goog.events.listen_=function(t,e,o,n,i,r){if(!e)throw Error("Invalid event type");var s=goog.isObject(i)?!!i.capture:!!i;if(s&&!goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT){if(goog.events.CAPTURE_SIMULATION_MODE==goog.events.CaptureSimulationMode.OFF_AND_FAIL)return goog.asserts.fail("Can not register capture listener in IE8-."),null;if(goog.events.CAPTURE_SIMULATION_MODE==goog.events.CaptureSimulationMode.OFF_AND_SILENT)return null}var a=goog.events.getListenerMap_(t);if(a||(t[goog.events.LISTENER_MAP_PROP_]=a=new goog.events.ListenerMap(t)),o=a.add(e,o,n,s,r),o.proxy)return o;if(n=goog.events.getProxy(),o.proxy=n,n.src=t,n.listener=o,t.addEventListener)goog.events.BrowserFeature.PASSIVE_EVENTS||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),n,i);else{if(!t.attachEvent)throw Error("addEventListener and attachEvent are unavailable.");t.attachEvent(goog.events.getOnString_(e.toString()),n)}return goog.events.listenerCountEstimate_++,o},goog.events.getProxy=function(){var t=goog.events.handleBrowserEvent_,e=goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT?function(o){return t.call(e.src,e.listener,o)}:function(o){if(!(o=t.call(e.src,e.listener,o)))return o};return e},goog.events.listenOnce=function(t,e,o,n,i){if(goog.isArray(e)){for(var r=0;r<e.length;r++)goog.events.listenOnce(t,e[r],o,n,i);return null}return o=goog.events.wrapListener(o),goog.events.Listenable.isImplementedBy(t)?(n=goog.isObject(n)?!!n.capture:!!n,t.listenOnce(e,o,n,i)):goog.events.listen_(t,e,o,!0,n,i)};goog.events.listenWithWrapper=function(t,e,o,n,i){e.listen(t,o,n,i)},goog.events.unlisten=function(t,e,o,n,i){if(goog.isArray(e)){for(var r=0;r<e.length;r++)goog.events.unlisten(t,e[r],o,n,i);return null}return n=goog.isObject(n)?!!n.capture:!!n,o=goog.events.wrapListener(o),goog.events.Listenable.isImplementedBy(t)?t.unlisten(e,o,n,i):!!t&&(!(!(t=goog.events.getListenerMap_(t))||!(e=t.getListener(e,o,n,i)))&&goog.events.unlistenByKey(e))},goog.events.unlistenByKey=function(t){if(goog.isNumber(t)||!t||t.removed)return!1;var e=t.src;if(goog.events.Listenable.isImplementedBy(e))return e.unlistenByKey(t);var o=t.type,n=t.proxy;return e.removeEventListener?e.removeEventListener(o,n,t.capture):e.detachEvent&&e.detachEvent(goog.events.getOnString_(o),n),goog.events.listenerCountEstimate_--,(o=goog.events.getListenerMap_(e))?(o.removeByKey(t),0==o.getTypeCount()&&(o.src=null,e[goog.events.LISTENER_MAP_PROP_]=null)):t.markAsRemoved(),!0},goog.events.unlistenWithWrapper=function(t,e,o,n,i){e.unlisten(t,o,n,i)},goog.events.removeAll=function(t,e){if(!t)return 0;if(goog.events.Listenable.isImplementedBy(t))return t.removeAllListeners(e);var o=goog.events.getListenerMap_(t);if(!o)return 0;var n,i=0,r=e&&e.toString();for(n in o.listeners)if(!r||n==r)for(var s=o.listeners[n].concat(),a=0;a<s.length;++a)goog.events.unlistenByKey(s[a])&&++i;return i},goog.events.getListeners=function(t,e,o){return goog.events.Listenable.isImplementedBy(t)?t.getListeners(e,o):t&&(t=goog.events.getListenerMap_(t))?t.getListeners(e,o):[]},goog.events.getListener=function(t,e,o,n,i){return o=goog.events.wrapListener(o),n=!!n,goog.events.Listenable.isImplementedBy(t)?t.getListener(e,o,n,i):t&&(t=goog.events.getListenerMap_(t))?t.getListener(e,o,n,i):null},goog.events.hasListener=function(t,e,o){return goog.events.Listenable.isImplementedBy(t)?t.hasListener(e,o):!!(t=goog.events.getListenerMap_(t))&&t.hasListener(e,o)},goog.events.expose=function(t){var e,o=[];for(e in t)t[e]&&t[e].id?o.push(e+" = "+t[e]+" ("+t[e].id+")"):o.push(e+" = "+t[e]);return o.join("\n")},goog.events.getOnString_=function(t){return t in goog.events.onStringMap_?goog.events.onStringMap_[t]:goog.events.onStringMap_[t]=goog.events.onString_+t},goog.events.fireListeners=function(t,e,o,n){return goog.events.Listenable.isImplementedBy(t)?t.fireListeners(e,o,n):goog.events.fireListeners_(t,e,o,n)},goog.events.fireListeners_=function(t,e,o,n){var i=!0;if((t=goog.events.getListenerMap_(t))&&(e=t.listeners[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var r=e[t];r&&r.capture==o&&!r.removed&&(r=goog.events.fireListener(r,n),i=i&&!1!==r)}return i},goog.events.fireListener=function(t,e){var o=t.listener,n=t.handler||t.src;return t.callOnce&&goog.events.unlistenByKey(t),o.call(n,e)},goog.events.getTotalListenerCount=function(){return goog.events.listenerCountEstimate_},goog.events.dispatchEvent=function(t,e){return goog.asserts.assert(goog.events.Listenable.isImplementedBy(t),"Can not use goog.events.dispatchEvent with non-goog.events.Listenable instance."),t.dispatchEvent(e)},goog.events.protectBrowserEventEntryPoint=function(t){goog.events.handleBrowserEvent_=t.protectEntryPoint(goog.events.handleBrowserEvent_)},goog.events.handleBrowserEvent_=function(t,e){var o;if(t.removed)return!0;if(!goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT){var n=e||goog.getObjectByName("window.event"),i=new goog.events.BrowserEvent(n,this),r=!0;if(goog.events.CAPTURE_SIMULATION_MODE==goog.events.CaptureSimulationMode.ON){if(!goog.events.isMarkedIeEvent_(n)){for(goog.events.markIeEvent_(n),n=[],o=i.currentTarget;o;o=o.parentNode)n.push(o);for(var s=t.type,a=n.length-1;!i.propagationStopped_&&0<=a;a--)i.currentTarget=n[a],o=goog.events.fireListeners_(n[a],s,!0,i),r=r&&o;for(a=0;!i.propagationStopped_&&a<n.length;a++)i.currentTarget=n[a],o=goog.events.fireListeners_(n[a],s,!1,i),r=r&&o}}else r=goog.events.fireListener(t,i);return r}return goog.events.fireListener(t,new goog.events.BrowserEvent(e,this))},goog.events.markIeEvent_=function(t){var e=!1;if(0==t.keyCode)try{return void(t.keyCode=-1)}catch(t){e=!0}(e||void 0==t.returnValue)&&(t.returnValue=!0)},goog.events.isMarkedIeEvent_=function(t){return 0>t.keyCode||void 0!=t.returnValue},goog.events.uniqueIdCounter_=0,goog.events.getUniqueId=function(t){return t+"_"+goog.events.uniqueIdCounter_++},goog.events.getListenerMap_=function(t){return t=t[goog.events.LISTENER_MAP_PROP_],t instanceof goog.events.ListenerMap?t:null},goog.events.LISTENER_WRAPPER_PROP_="__closure_events_fn_"+(1e9*Math.random()>>>0),goog.events.wrapListener=function(t){return goog.asserts.assert(t,"Listener can not be null."),goog.isFunction(t)?t:(goog.asserts.assert(t.handleEvent,"An object listener must have handleEvent method."),t[goog.events.LISTENER_WRAPPER_PROP_]||(t[goog.events.LISTENER_WRAPPER_PROP_]=function(e){return t.handleEvent(e)}),t[goog.events.LISTENER_WRAPPER_PROP_])},goog.debug.entryPointRegistry.register(function(t){goog.events.handleBrowserEvent_=t(goog.events.handleBrowserEvent_)}),goog.events.EventTarget=function(){goog.Disposable.call(this),this.eventTargetListeners_=new goog.events.ListenerMap(this),this.actualEventTarget_=this,this.parentEventTarget_=null},goog.inherits(goog.events.EventTarget,goog.Disposable),goog.events.Listenable.addImplementation(goog.events.EventTarget),goog.events.EventTarget.MAX_ANCESTORS_=1e3,goog.events.EventTarget.prototype.getParentEventTarget=function(){return this.parentEventTarget_},goog.events.EventTarget.prototype.setParentEventTarget=function(t){this.parentEventTarget_=t},goog.events.EventTarget.prototype.addEventListener=function(t,e,o,n){goog.events.listen(this,t,e,o,n)},goog.events.EventTarget.prototype.removeEventListener=function(t,e,o,n){goog.events.unlisten(this,t,e,o,n)},goog.events.EventTarget.prototype.dispatchEvent=function(t){this.assertInitialized_();var e=this.getParentEventTarget();if(e)for(var o=[],n=1;e;e=e.getParentEventTarget())o.push(e),goog.asserts.assert(++n<goog.events.EventTarget.MAX_ANCESTORS_,"infinite loop");return goog.events.EventTarget.dispatchEventInternal_(this.actualEventTarget_,t,o)},goog.events.EventTarget.prototype.disposeInternal=function(){goog.events.EventTarget.superClass_.disposeInternal.call(this),this.removeAllListeners(),this.parentEventTarget_=null},goog.events.EventTarget.prototype.listen=function(t,e,o,n){return this.assertInitialized_(),this.eventTargetListeners_.add(String(t),e,!1,o,n)},goog.events.EventTarget.prototype.listenOnce=function(t,e,o,n){return this.eventTargetListeners_.add(String(t),e,!0,o,n)},goog.events.EventTarget.prototype.unlisten=function(t,e,o,n){return this.eventTargetListeners_.remove(String(t),e,o,n)},goog.events.EventTarget.prototype.unlistenByKey=function(t){return this.eventTargetListeners_.removeByKey(t)},goog.events.EventTarget.prototype.removeAllListeners=function(t){return this.eventTargetListeners_?this.eventTargetListeners_.removeAll(t):0},goog.events.EventTarget.prototype.fireListeners=function(t,e,o){if(!(t=this.eventTargetListeners_.listeners[String(t)]))return!0;t=t.concat();for(var n=!0,i=0;i<t.length;++i){var r=t[i];if(r&&!r.removed&&r.capture==e){var s=r.listener,a=r.handler||r.src;r.callOnce&&this.unlistenByKey(r),n=!1!==s.call(a,o)&&n}}return n&&0!=o.returnValue_},goog.events.EventTarget.prototype.getListeners=function(t,e){return this.eventTargetListeners_.getListeners(String(t),e)},goog.events.EventTarget.prototype.getListener=function(t,e,o,n){return this.eventTargetListeners_.getListener(String(t),e,o,n)},goog.events.EventTarget.prototype.hasListener=function(t,e){var o=goog.isDef(t)?String(t):void 0;return this.eventTargetListeners_.hasListener(o,e)},goog.events.EventTarget.prototype.setTargetForTesting=function(t){this.actualEventTarget_=t},goog.events.EventTarget.prototype.assertInitialized_=function(){goog.asserts.assert(this.eventTargetListeners_,"Event target is not initialized. Did you call the superclass (goog.events.EventTarget) constructor?")},goog.events.EventTarget.dispatchEventInternal_=function(t,e,o){var n=e.type||e;if(goog.isString(e))e=new goog.events.Event(e,t);else if(e instanceof goog.events.Event)e.target=e.target||t;else{var i=e;e=new goog.events.Event(n,t),goog.object.extend(e,i)}if(i=!0,o)for(var r=o.length-1;!e.propagationStopped_&&0<=r;r--){var s=e.currentTarget=o[r];i=s.fireListeners(n,!0,e)&&i}if(e.propagationStopped_||(s=e.currentTarget=t,i=s.fireListeners(n,!0,e)&&i,e.propagationStopped_||(i=s.fireListeners(n,!1,e)&&i)),o)for(r=0;!e.propagationStopped_&&r<o.length;r++)s=e.currentTarget=o[r],i=s.fireListeners(n,!1,e)&&i;return i},goog.Timer=function(t,e){goog.events.EventTarget.call(this),this.interval_=t||1,this.timerObject_=e||goog.Timer.defaultTimerObject,this.boundTick_=goog.bind(this.tick_,this),this.last_=goog.now()},goog.inherits(goog.Timer,goog.events.EventTarget),goog.Timer.MAX_TIMEOUT_=2147483647,goog.Timer.INVALID_TIMEOUT_ID_=-1,goog.Timer.prototype.enabled=!1,goog.Timer.defaultTimerObject=goog.global,goog.Timer.intervalScale=.8,goog.Timer.prototype.timer_=null,goog.Timer.prototype.getInterval=function(){return this.interval_},goog.Timer.prototype.setInterval=function(t){this.interval_=t,this.timer_&&this.enabled?(this.stop(),this.start()):this.timer_&&this.stop()},goog.Timer.prototype.tick_=function(){if(this.enabled){var t=goog.now()-this.last_;0<t&&t<this.interval_*goog.Timer.intervalScale?this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_-t):(this.timer_&&(this.timerObject_.clearTimeout(this.timer_),this.timer_=null),this.dispatchTick(),this.enabled&&(this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_),this.last_=goog.now()))}},goog.Timer.prototype.dispatchTick=function(){this.dispatchEvent(goog.Timer.TICK)},goog.Timer.prototype.start=function(){this.enabled=!0,this.timer_||(this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_),this.last_=goog.now())},goog.Timer.prototype.stop=function(){this.enabled=!1,this.timer_&&(this.timerObject_.clearTimeout(this.timer_),this.timer_=null)},goog.Timer.prototype.disposeInternal=function(){goog.Timer.superClass_.disposeInternal.call(this),this.stop(),delete this.timerObject_},goog.Timer.TICK="tick",goog.Timer.callOnce=function(t,e,o){if(goog.isFunction(t))o&&(t=goog.bind(t,o));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=goog.bind(t.handleEvent,t)}return Number(e)>goog.Timer.MAX_TIMEOUT_?goog.Timer.INVALID_TIMEOUT_ID_:goog.Timer.defaultTimerObject.setTimeout(t,e||0)},goog.Timer.clear=function(t){goog.Timer.defaultTimerObject.clearTimeout(t)},goog.Timer.promise=function(t,e){var o=null;return new goog.Promise(function(n,i){(o=goog.Timer.callOnce(function(){n(e)},t))==goog.Timer.INVALID_TIMEOUT_ID_&&i(Error("Failed to schedule timer."))}).thenCatch(function(t){throw goog.Timer.clear(o),t})},goog.dom.BrowserFeature={CAN_ADD_NAME_OR_TYPE_ATTRIBUTES:!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),CAN_USE_CHILDREN_ATTRIBUTE:!goog.userAgent.GECKO&&!goog.userAgent.IE||goog.userAgent.IE&&goog.userAgent.isDocumentModeOrHigher(9)||goog.userAgent.GECKO&&goog.userAgent.isVersionOrHigher("1.9.1"),CAN_USE_INNER_TEXT:goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),CAN_USE_PARENT_ELEMENT_PROPERTY:goog.userAgent.IE||goog.userAgent.OPERA||goog.userAgent.WEBKIT,INNER_HTML_NEEDS_SCOPED_ELEMENT:goog.userAgent.IE,LEGACY_IE_RANGES:goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)},goog.dom.asserts={},goog.dom.asserts.assertIsLocation=function(t){if(goog.asserts.ENABLE_ASSERTS){var e=goog.dom.asserts.getWindow_(t);void 0!==e.Location&&void 0!==e.Element&&goog.asserts.assert(t&&(t instanceof e.Location||!(t instanceof e.Element)),"Argument is not a Location (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(t))}return t},goog.dom.asserts.assertIsHTMLAnchorElement=function(t){if(goog.asserts.ENABLE_ASSERTS){var e=goog.dom.asserts.getWindow_(t);void 0!==e.HTMLAnchorElement&&void 0!==e.Location&&void 0!==e.Element&&goog.asserts.assert(t&&(t instanceof e.HTMLAnchorElement||!(t instanceof e.Location||t instanceof e.Element)),"Argument is not a HTMLAnchorElement (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(t))}return t},goog.dom.asserts.assertIsHTMLLinkElement=function(t){if(goog.asserts.ENABLE_ASSERTS){var e=goog.dom.asserts.getWindow_(t);void 0!==e.HTMLLinkElement&&void 0!==e.Location&&void 0!==e.Element&&goog.asserts.assert(t&&(t instanceof e.HTMLLinkElement||!(t instanceof e.Location||t instanceof e.Element)),"Argument is not a HTMLLinkElement (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(t))}return t},goog.dom.asserts.assertIsHTMLImageElement=function(t){if(goog.asserts.ENABLE_ASSERTS){var e=goog.dom.asserts.getWindow_(t);void 0!==e.HTMLImageElement&&void 0!==e.Element&&goog.asserts.assert(t&&(t instanceof e.HTMLImageElement||!(t instanceof e.Element)),"Argument is not a HTMLImageElement (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(t))}return t},goog.dom.asserts.assertIsHTMLEmbedElement=function(t){if(goog.asserts.ENABLE_ASSERTS){var e=goog.dom.asserts.getWindow_(t);void 0!==e.HTMLEmbedElement&&void 0!==e.Element&&goog.asserts.assert(t&&(t instanceof e.HTMLEmbedElement||!(t instanceof e.Element)),"Argument is not a HTMLEmbedElement (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(t))}return t},goog.dom.asserts.assertIsHTMLFrameElement=function(t){if(goog.asserts.ENABLE_ASSERTS){var e=goog.dom.asserts.getWindow_(t);void 0!==e.HTMLFrameElement&&void 0!==e.Element&&goog.asserts.assert(t&&(t instanceof e.HTMLFrameElement||!(t instanceof e.Element)),"Argument is not a HTMLFrameElement (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(t))}return t},goog.dom.asserts.assertIsHTMLIFrameElement=function(t){if(goog.asserts.ENABLE_ASSERTS){var e=goog.dom.asserts.getWindow_(t);void 0!==e.HTMLIFrameElement&&void 0!==e.Element&&goog.asserts.assert(t&&(t instanceof e.HTMLIFrameElement||!(t instanceof e.Element)),"Argument is not a HTMLIFrameElement (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(t))}return t},goog.dom.asserts.assertIsHTMLObjectElement=function(t){if(goog.asserts.ENABLE_ASSERTS){var e=goog.dom.asserts.getWindow_(t);void 0!==e.HTMLObjectElement&&void 0!==e.Element&&goog.asserts.assert(t&&(t instanceof e.HTMLObjectElement||!(t instanceof e.Element)),"Argument is not a HTMLObjectElement (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(t))}return t},goog.dom.asserts.assertIsHTMLScriptElement=function(t){if(goog.asserts.ENABLE_ASSERTS){var e=goog.dom.asserts.getWindow_(t);void 0!==e.HTMLScriptElement&&void 0!==e.Element&&goog.asserts.assert(t&&(t instanceof e.HTMLScriptElement||!(t instanceof e.Element)),"Argument is not a HTMLScriptElement (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(t))}return t},goog.dom.asserts.debugStringForType_=function(t){return goog.isObject(t)?t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t):void 0===t?"undefined":null===t?"null":typeof t},goog.dom.asserts.getWindow_=function(t){return(t=t&&t.ownerDocument)&&(t.defaultView||t.parentWindow)||goog.global},goog.dom.tags={},goog.dom.tags.VOID_TAGS_={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},goog.dom.tags.isVoidTag=function(t){return!0===goog.dom.tags.VOID_TAGS_[t]},goog.string.TypedString=function(){},goog.string.Const=function(){this.stringConstValueWithSecurityContract__googStringSecurityPrivate_="",this.STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_=goog.string.Const.TYPE_MARKER_},goog.string.Const.prototype.implementsGoogStringTypedString=!0,goog.string.Const.prototype.getTypedStringValue=function(){return this.stringConstValueWithSecurityContract__googStringSecurityPrivate_},goog.string.Const.prototype.toString=function(){return"Const{"+this.stringConstValueWithSecurityContract__googStringSecurityPrivate_+"}"},goog.string.Const.unwrap=function(t){return t instanceof goog.string.Const&&t.constructor===goog.string.Const&&t.STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_===goog.string.Const.TYPE_MARKER_?t.stringConstValueWithSecurityContract__googStringSecurityPrivate_:(goog.asserts.fail("expected object of type Const, got '"+t+"'"),"type_error:Const")},goog.string.Const.from=function(t){return goog.string.Const.create__googStringSecurityPrivate_(t)},goog.string.Const.TYPE_MARKER_={},goog.string.Const.create__googStringSecurityPrivate_=function(t){var e=new goog.string.Const;return e.stringConstValueWithSecurityContract__googStringSecurityPrivate_=t,e},goog.string.Const.EMPTY=goog.string.Const.from(""),goog.html={},goog.html.SafeScript=function(){this.privateDoNotAccessOrElseSafeScriptWrappedValue_="",this.SAFE_SCRIPT_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_},goog.html.SafeScript.prototype.implementsGoogStringTypedString=!0,goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.SafeScript.fromConstant=function(t){return t=goog.string.Const.unwrap(t),0===t.length?goog.html.SafeScript.EMPTY:goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(t)},goog.html.SafeScript.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeScriptWrappedValue_},goog.DEBUG&&(goog.html.SafeScript.prototype.toString=function(){return"SafeScript{"+this.privateDoNotAccessOrElseSafeScriptWrappedValue_+"}"}),goog.html.SafeScript.unwrap=function(t){return t instanceof goog.html.SafeScript&&t.constructor===goog.html.SafeScript&&t.SAFE_SCRIPT_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?t.privateDoNotAccessOrElseSafeScriptWrappedValue_:(goog.asserts.fail("expected object of type SafeScript, got '"+t+"' of type "+goog.typeOf(t)),"type_error:SafeScript")},goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse=function(t){return(new goog.html.SafeScript).initSecurityPrivateDoNotAccessOrElse_(t)},goog.html.SafeScript.prototype.initSecurityPrivateDoNotAccessOrElse_=function(t){return this.privateDoNotAccessOrElseSafeScriptWrappedValue_=t,this},goog.html.SafeScript.EMPTY=goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(""),goog.fs={},goog.fs.url={},goog.fs.url.createObjectUrl=function(t){return goog.fs.url.getUrlObject_().createObjectURL(t)},goog.fs.url.revokeObjectUrl=function(t){goog.fs.url.getUrlObject_().revokeObjectURL(t)},goog.fs.url.getUrlObject_=function(){var t=goog.fs.url.findUrlObject_();if(null!=t)return t;throw Error("This browser doesn't seem to support blob URLs")},goog.fs.url.findUrlObject_=function(){return goog.isDef(goog.global.URL)&&goog.isDef(goog.global.URL.createObjectURL)?goog.global.URL:goog.isDef(goog.global.webkitURL)&&goog.isDef(goog.global.webkitURL.createObjectURL)?goog.global.webkitURL:goog.isDef(goog.global.createObjectURL)?goog.global:null},goog.fs.url.browserSupportsObjectUrls=function(){return null!=goog.fs.url.findUrlObject_()},goog.i18n={},goog.i18n.bidi={},goog.i18n.bidi.FORCE_RTL=!1,goog.i18n.bidi.IS_RTL=goog.i18n.bidi.FORCE_RTL||("ar"==goog.LOCALE.substring(0,2).toLowerCase()||"fa"==goog.LOCALE.substring(0,2).toLowerCase()||"he"==goog.LOCALE.substring(0,2).toLowerCase()||"iw"==goog.LOCALE.substring(0,2).toLowerCase()||"ps"==goog.LOCALE.substring(0,2).toLowerCase()||"sd"==goog.LOCALE.substring(0,2).toLowerCase()||"ug"==goog.LOCALE.substring(0,2).toLowerCase()||"ur"==goog.LOCALE.substring(0,2).toLowerCase()||"yi"==goog.LOCALE.substring(0,2).toLowerCase())&&(2==goog.LOCALE.length||"-"==goog.LOCALE.substring(2,3)||"_"==goog.LOCALE.substring(2,3))||3<=goog.LOCALE.length&&"ckb"==goog.LOCALE.substring(0,3).toLowerCase()&&(3==goog.LOCALE.length||"-"==goog.LOCALE.substring(3,4)||"_"==goog.LOCALE.substring(3,4)),goog.i18n.bidi.Format={LRE:"",RLE:"",PDF:"",LRM:"",RLM:""},goog.i18n.bidi.Dir={LTR:1,RTL:-1,NEUTRAL:0},goog.i18n.bidi.RIGHT="right",goog.i18n.bidi.LEFT="left",goog.i18n.bidi.I18N_RIGHT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.LEFT:goog.i18n.bidi.RIGHT,goog.i18n.bidi.I18N_LEFT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT,goog.i18n.bidi.toDir=function(t,e){return"number"==typeof t?0<t?goog.i18n.bidi.Dir.LTR:0>t?goog.i18n.bidi.Dir.RTL:e?null:goog.i18n.bidi.Dir.NEUTRAL:null==t?null:t?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR},goog.i18n.bidi.ltrChars_="A-Za-z--------",goog.i18n.bidi.rtlChars_="----",goog.i18n.bidi.htmlSkipReg_=/<[^>]*>|&[^;]+;/g,goog.i18n.bidi.stripHtmlIfNeeded_=function(t,e){return e?t.replace(goog.i18n.bidi.htmlSkipReg_,""):t},goog.i18n.bidi.rtlCharReg_=new RegExp("["+goog.i18n.bidi.rtlChars_+"]"),goog.i18n.bidi.ltrCharReg_=new RegExp("["+goog.i18n.bidi.ltrChars_+"]"),goog.i18n.bidi.hasAnyRtl=function(t,e){return goog.i18n.bidi.rtlCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))},goog.i18n.bidi.hasRtlChar=goog.i18n.bidi.hasAnyRtl,goog.i18n.bidi.hasAnyLtr=function(t,e){return goog.i18n.bidi.ltrCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))},goog.i18n.bidi.ltrRe_=new RegExp("^["+goog.i18n.bidi.ltrChars_+"]"),goog.i18n.bidi.rtlRe_=new RegExp("^["+goog.i18n.bidi.rtlChars_+"]"),goog.i18n.bidi.isRtlChar=function(t){return goog.i18n.bidi.rtlRe_.test(t)},goog.i18n.bidi.isLtrChar=function(t){return goog.i18n.bidi.ltrRe_.test(t)},goog.i18n.bidi.isNeutralChar=function(t){return!goog.i18n.bidi.isLtrChar(t)&&!goog.i18n.bidi.isRtlChar(t)},goog.i18n.bidi.ltrDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.rtlChars_+"]*["+goog.i18n.bidi.ltrChars_+"]"),goog.i18n.bidi.rtlDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.ltrChars_+"]*["+goog.i18n.bidi.rtlChars_+"]"),goog.i18n.bidi.startsWithRtl=function(t,e){return goog.i18n.bidi.rtlDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))},goog.i18n.bidi.isRtlText=goog.i18n.bidi.startsWithRtl,goog.i18n.bidi.startsWithLtr=function(t,e){return goog.i18n.bidi.ltrDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))},goog.i18n.bidi.isLtrText=goog.i18n.bidi.startsWithLtr,goog.i18n.bidi.isRequiredLtrRe_=/^http:\/\/.*/,goog.i18n.bidi.isNeutralText=function(t,e){return t=goog.i18n.bidi.stripHtmlIfNeeded_(t,e),goog.i18n.bidi.isRequiredLtrRe_.test(t)||!goog.i18n.bidi.hasAnyLtr(t)&&!goog.i18n.bidi.hasAnyRtl(t)},goog.i18n.bidi.ltrExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.ltrChars_+"][^"+goog.i18n.bidi.rtlChars_+"]*$"),goog.i18n.bidi.rtlExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.rtlChars_+"][^"+goog.i18n.bidi.ltrChars_+"]*$"),goog.i18n.bidi.endsWithLtr=function(t,e){return goog.i18n.bidi.ltrExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))},goog.i18n.bidi.isLtrExitText=goog.i18n.bidi.endsWithLtr,goog.i18n.bidi.endsWithRtl=function(t,e){return goog.i18n.bidi.rtlExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(t,e))},goog.i18n.bidi.isRtlExitText=goog.i18n.bidi.endsWithRtl,goog.i18n.bidi.rtlLocalesRe_=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Arab|Hebr|Thaa|Nkoo|Tfng))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i,goog.i18n.bidi.isRtlLanguage=function(t){return goog.i18n.bidi.rtlLocalesRe_.test(t)},goog.i18n.bidi.bracketGuardTextRe_=/(\(.*?\)+)|(\[.*?\]+)|(\{.*?\}+)|(<.*?>+)/g,goog.i18n.bidi.guardBracketInText=function(t,e){var o=(void 0===e?goog.i18n.bidi.hasAnyRtl(t):e)?goog.i18n.bidi.Format.RLM:goog.i18n.bidi.Format.LRM;return t.replace(goog.i18n.bidi.bracketGuardTextRe_,o+"$&"+o)},goog.i18n.bidi.enforceRtlInHtml=function(t){return"<"==t.charAt(0)?t.replace(/<\w+/,"$& dir=rtl"):"\n<span dir=rtl>"+t+"</span>"},goog.i18n.bidi.enforceRtlInText=function(t){return goog.i18n.bidi.Format.RLE+t+goog.i18n.bidi.Format.PDF},goog.i18n.bidi.enforceLtrInHtml=function(t){return"<"==t.charAt(0)?t.replace(/<\w+/,"$& dir=ltr"):"\n<span dir=ltr>"+t+"</span>"},goog.i18n.bidi.enforceLtrInText=function(t){return goog.i18n.bidi.Format.LRE+t+goog.i18n.bidi.Format.PDF},goog.i18n.bidi.dimensionsRe_=/:\s*([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)/g,goog.i18n.bidi.leftRe_=/left/gi,goog.i18n.bidi.rightRe_=/right/gi,goog.i18n.bidi.tempRe_=/%%%%/g,goog.i18n.bidi.mirrorCSS=function(t){return t.replace(goog.i18n.bidi.dimensionsRe_,":$1 $4 $3 $2").replace(goog.i18n.bidi.leftRe_,"%%%%").replace(goog.i18n.bidi.rightRe_,goog.i18n.bidi.LEFT).replace(goog.i18n.bidi.tempRe_,goog.i18n.bidi.RIGHT)},goog.i18n.bidi.doubleQuoteSubstituteRe_=/([\u0591-\u05f2])"/g,goog.i18n.bidi.singleQuoteSubstituteRe_=/([\u0591-\u05f2])'/g,goog.i18n.bidi.normalizeHebrewQuote=function(t){return t.replace(goog.i18n.bidi.doubleQuoteSubstituteRe_,"$1").replace(goog.i18n.bidi.singleQuoteSubstituteRe_,"$1")},goog.i18n.bidi.wordSeparatorRe_=/\s+/,goog.i18n.bidi.hasNumeralsRe_=/[\d\u06f0-\u06f9]/,goog.i18n.bidi.rtlDetectionThreshold_=.4,goog.i18n.bidi.estimateDirection=function(t,e){for(var o=0,n=0,i=!1,r=goog.i18n.bidi.stripHtmlIfNeeded_(t,e).split(goog.i18n.bidi.wordSeparatorRe_),s=0;s<r.length;s++){var a=r[s];goog.i18n.bidi.startsWithRtl(a)?(o++,n++):goog.i18n.bidi.isRequiredLtrRe_.test(a)?i=!0:goog.i18n.bidi.hasAnyLtr(a)?n++:goog.i18n.bidi.hasNumeralsRe_.test(a)&&(i=!0)}return 0==n?i?goog.i18n.bidi.Dir.LTR:goog.i18n.bidi.Dir.NEUTRAL:o/n>goog.i18n.bidi.rtlDetectionThreshold_?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR},goog.i18n.bidi.detectRtlDirectionality=function(t,e){return goog.i18n.bidi.estimateDirection(t,e)==goog.i18n.bidi.Dir.RTL},goog.i18n.bidi.setElementDirAndAlign=function(t,e){t&&(e=goog.i18n.bidi.toDir(e))&&(t.style.textAlign=e==goog.i18n.bidi.Dir.RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT,t.dir=e==goog.i18n.bidi.Dir.RTL?"rtl":"ltr")},goog.i18n.bidi.setElementDirByTextDirectionality=function(t,e){switch(goog.i18n.bidi.estimateDirection(e)){case goog.i18n.bidi.Dir.LTR:t.dir="ltr";break;case goog.i18n.bidi.Dir.RTL:t.dir="rtl";break;default:t.removeAttribute("dir")}},goog.i18n.bidi.DirectionalString=function(){},goog.html.TrustedResourceUrl=function(){this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_="",this.TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_},goog.html.TrustedResourceUrl.prototype.implementsGoogStringTypedString=!0,goog.html.TrustedResourceUrl.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_},goog.html.TrustedResourceUrl.prototype.implementsGoogI18nBidiDirectionalString=!0,goog.html.TrustedResourceUrl.prototype.getDirection=function(){return goog.i18n.bidi.Dir.LTR},goog.DEBUG&&(goog.html.TrustedResourceUrl.prototype.toString=function(){return"TrustedResourceUrl{"+this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_+"}"}),goog.html.TrustedResourceUrl.unwrap=function(t){return t instanceof goog.html.TrustedResourceUrl&&t.constructor===goog.html.TrustedResourceUrl&&t.TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?t.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_:(goog.asserts.fail("expected object of type TrustedResourceUrl, got '"+t+"' of type "+goog.typeOf(t)),"type_error:TrustedResourceUrl")},goog.html.TrustedResourceUrl.format=function(t,e){var o=goog.html.TrustedResourceUrl.format_(t,e);return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(o)},goog.html.TrustedResourceUrl.format_=function(t,e){var o=goog.string.Const.unwrap(t);if(!goog.html.TrustedResourceUrl.BASE_URL_.test(o))throw Error("Invalid TrustedResourceUrl format: "+o);return o.replace(goog.html.TrustedResourceUrl.FORMAT_MARKER_,function(t,n){if(!Object.prototype.hasOwnProperty.call(e,n))throw Error('Found marker, "'+n+'", in format string, "'+o+'", but no valid label mapping found in args: '+JSON.stringify(e));var i=e[n];return i instanceof goog.string.Const?goog.string.Const.unwrap(i):encodeURIComponent(String(i))})},goog.html.TrustedResourceUrl.FORMAT_MARKER_=/%{(\w+)}/g,goog.html.TrustedResourceUrl.BASE_URL_=/^(?:https:)?\/\/[0-9a-z.:[\]-]+\/|^\/[^\/\\]|^about:blank(#|$)/i,goog.html.TrustedResourceUrl.formatWithParams=function(t,e,o){t=goog.html.TrustedResourceUrl.format_(t,e),e=/\?/.test(t)?"&":"?";for(var n in o)null!=o[n]&&(t+=e+encodeURIComponent(n)+"="+encodeURIComponent(String(o[n])),e="&");return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(t)},goog.html.TrustedResourceUrl.fromConstant=function(t){return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(goog.string.Const.unwrap(t))},goog.html.TrustedResourceUrl.fromConstants=function(t){for(var e="",o=0;o<t.length;o++)e+=goog.string.Const.unwrap(t[o]);return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(e)},goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse=function(t){var e=new goog.html.TrustedResourceUrl;return e.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_=t,e},goog.html.SafeUrl=function(){this.privateDoNotAccessOrElseSafeHtmlWrappedValue_="",this.SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_},goog.html.SafeUrl.INNOCUOUS_STRING="about:invalid#zClosurez",goog.html.SafeUrl.prototype.implementsGoogStringTypedString=!0,goog.html.SafeUrl.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_},goog.html.SafeUrl.prototype.implementsGoogI18nBidiDirectionalString=!0,goog.html.SafeUrl.prototype.getDirection=function(){return goog.i18n.bidi.Dir.LTR},goog.DEBUG&&(goog.html.SafeUrl.prototype.toString=function(){return"SafeUrl{"+this.privateDoNotAccessOrElseSafeHtmlWrappedValue_+"}"}),goog.html.SafeUrl.unwrap=function(t){return t instanceof goog.html.SafeUrl&&t.constructor===goog.html.SafeUrl&&t.SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?t.privateDoNotAccessOrElseSafeHtmlWrappedValue_:(goog.asserts.fail("expected object of type SafeUrl, got '"+t+"' of type "+goog.typeOf(t)),"type_error:SafeUrl")},goog.html.SafeUrl.fromConstant=function(t){return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(goog.string.Const.unwrap(t))},goog.html.SAFE_MIME_TYPE_PATTERN_=/^(?:audio\/(?:3gpp|3gpp2|aac|midi|mp4|mpeg|ogg|x-m4a|x-wav|webm)|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|text\/csv|video\/(?:mpeg|mp4|ogg|webm))$/i,goog.html.SafeUrl.fromBlob=function(t){return t=goog.html.SAFE_MIME_TYPE_PATTERN_.test(t.type)?goog.fs.url.createObjectUrl(t):goog.html.SafeUrl.INNOCUOUS_STRING,goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(t)};goog.html.DATA_URL_PATTERN_=/^data:([^;,]*);base64,[a-z0-9+\/]+=*$/i,goog.html.SafeUrl.fromDataUrl=function(t){var e=t.match(goog.html.DATA_URL_PATTERN_);return e=e&&goog.html.SAFE_MIME_TYPE_PATTERN_.test(e[1]),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(e?t:goog.html.SafeUrl.INNOCUOUS_STRING)},goog.html.SafeUrl.fromTelUrl=function(t){return goog.string.caseInsensitiveStartsWith(t,"tel:")||(t=goog.html.SafeUrl.INNOCUOUS_STRING),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(t)},goog.html.SafeUrl.fromTrustedResourceUrl=function(t){return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(goog.html.TrustedResourceUrl.unwrap(t))},goog.html.SAFE_URL_PATTERN_=/^(?:(?:https?|mailto|ftp):|[^:\/?#]*(?:[\/?#]|$))/i,goog.html.SafeUrl.sanitize=function(t){return t instanceof goog.html.SafeUrl?t:(t=t.implementsGoogStringTypedString?t.getTypedStringValue():String(t),goog.html.SAFE_URL_PATTERN_.test(t)||(t=goog.html.SafeUrl.INNOCUOUS_STRING),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(t))},goog.html.SafeUrl.sanitizeAssertUnchanged=function(t){return t instanceof goog.html.SafeUrl?t:(t=t.implementsGoogStringTypedString?t.getTypedStringValue():String(t),goog.asserts.assert(goog.html.SAFE_URL_PATTERN_.test(t))||(t=goog.html.SafeUrl.INNOCUOUS_STRING),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(t))},goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse=function(t){var e=new goog.html.SafeUrl;return e.privateDoNotAccessOrElseSafeHtmlWrappedValue_=t,e},goog.html.SafeUrl.ABOUT_BLANK=goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse("about:blank"),goog.html.SafeStyle=function(){this.privateDoNotAccessOrElseSafeStyleWrappedValue_="",this.SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_},goog.html.SafeStyle.prototype.implementsGoogStringTypedString=!0,goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.SafeStyle.fromConstant=function(t){return t=goog.string.Const.unwrap(t),0===t.length?goog.html.SafeStyle.EMPTY:(goog.html.SafeStyle.checkStyle_(t),goog.asserts.assert(goog.string.endsWith(t,";"),"Last character of style string is not ';': "+t),goog.asserts.assert(goog.string.contains(t,":"),"Style string must contain at least one ':', to specify a \"name: value\" pair: "+t),goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(t))},goog.html.SafeStyle.checkStyle_=function(t){goog.asserts.assert(!/[<>]/.test(t),"Forbidden characters in style string: "+t)},goog.html.SafeStyle.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeStyleWrappedValue_},goog.DEBUG&&(goog.html.SafeStyle.prototype.toString=function(){return"SafeStyle{"+this.privateDoNotAccessOrElseSafeStyleWrappedValue_+"}"}),goog.html.SafeStyle.unwrap=function(t){return t instanceof goog.html.SafeStyle&&t.constructor===goog.html.SafeStyle&&t.SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?t.privateDoNotAccessOrElseSafeStyleWrappedValue_:(goog.asserts.fail("expected object of type SafeStyle, got '"+t+"' of type "+goog.typeOf(t)),"type_error:SafeStyle")},goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse=function(t){return(new goog.html.SafeStyle).initSecurityPrivateDoNotAccessOrElse_(t)},goog.html.SafeStyle.prototype.initSecurityPrivateDoNotAccessOrElse_=function(t){return this.privateDoNotAccessOrElseSafeStyleWrappedValue_=t,this},goog.html.SafeStyle.EMPTY=goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(""),goog.html.SafeStyle.INNOCUOUS_STRING="zClosurez",goog.html.SafeStyle.create=function(t){var e,o="";for(e in t){if(!/^[-_a-zA-Z0-9]+$/.test(e))throw Error("Name allows only [-_a-zA-Z0-9], got: "+e);var n=t[e];null!=n&&(n=goog.isArray(n)?goog.array.map(n,goog.html.SafeStyle.sanitizePropertyValue_).join(" "):goog.html.SafeStyle.sanitizePropertyValue_(n),o+=e+":"+n+";")}return o?(goog.html.SafeStyle.checkStyle_(o),goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(o)):goog.html.SafeStyle.EMPTY},goog.html.SafeStyle.sanitizePropertyValue_=function(t){return t instanceof goog.html.SafeUrl?'url("'+goog.html.SafeUrl.unwrap(t).replace(/</g,"%3c").replace(/[\\"]/g,"\\$&")+'")':(t=t instanceof goog.string.Const?goog.string.Const.unwrap(t):goog.html.SafeStyle.sanitizePropertyValueString_(String(t)),goog.asserts.assert(!/[{;}]/.test(t),"Value does not allow [{;}]."),t)},goog.html.SafeStyle.sanitizePropertyValueString_=function(t){var e=t.replace(goog.html.SafeUrl.FUNCTIONS_RE_,"$1").replace(goog.html.SafeUrl.URL_RE_,"url");return goog.html.SafeStyle.VALUE_RE_.test(e)?goog.html.SafeStyle.hasBalancedQuotes_(t)?goog.html.SafeStyle.sanitizeUrl_(t):(goog.asserts.fail("String value requires balanced quotes, got: "+t),goog.html.SafeStyle.INNOCUOUS_STRING):(goog.asserts.fail("String value allows only "+goog.html.SafeStyle.VALUE_ALLOWED_CHARS_+" and simple functions, got: "+t),goog.html.SafeStyle.INNOCUOUS_STRING)},goog.html.SafeStyle.hasBalancedQuotes_=function(t){for(var e=!0,o=!0,n=0;n<t.length;n++){var i=t.charAt(n);"'"==i&&o?e=!e:'"'==i&&e&&(o=!o)}return e&&o},goog.html.SafeStyle.VALUE_ALLOWED_CHARS_="[-,.\"'%_!# a-zA-Z0-9]",goog.html.SafeStyle.VALUE_RE_=new RegExp("^"+goog.html.SafeStyle.VALUE_ALLOWED_CHARS_+"+$"),goog.html.SafeUrl.URL_RE_=RegExp("\\b(url\\([ \t\n]*)('[ -&(-\\[\\]-~]*'|\"[ !#-\\[\\]-~]*\"|[!#-&*-\\[\\]-~]*)([ \t\n]*\\))","g"),goog.html.SafeUrl.FUNCTIONS_RE_=RegExp("\\b(hsl|hsla|rgb|rgba|(rotate|scale|translate)(X|Y|Z|3d)?)\\([-0-9a-z.%, ]+\\)","g"),goog.html.SafeStyle.sanitizeUrl_=function(t){return t.replace(goog.html.SafeUrl.URL_RE_,function(t,e,o,n){var i="";return o=o.replace(/^(['"])(.*)\1$/,function(t,e,o){return i=e,o}),t=goog.html.SafeUrl.sanitize(o).getTypedStringValue(),e+i+t+i+n})},goog.html.SafeStyle.concat=function(t){var e="",o=function(t){goog.isArray(t)?goog.array.forEach(t,o):e+=goog.html.SafeStyle.unwrap(t)};return goog.array.forEach(arguments,o),e?goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(e):goog.html.SafeStyle.EMPTY},goog.html.SafeStyleSheet=function(){this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_="",this.SAFE_STYLE_SHEET_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_},goog.html.SafeStyleSheet.prototype.implementsGoogStringTypedString=!0,goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.SafeStyleSheet.createRule=function(t,e){if(goog.string.contains(t,"<"))throw Error("Selector does not allow '<', got: "+t);var o=t.replace(/('|")((?!\1)[^\r\n\f\\]|\\[\s\S])*\1/g,"");if(!/^[-_a-zA-Z0-9#.:* ,>+~[\]()=^$|]+$/.test(o))throw Error("Selector allows only [-_a-zA-Z0-9#.:* ,>+~[\\]()=^$|] and strings, got: "+t);if(!goog.html.SafeStyleSheet.hasBalancedBrackets_(o))throw Error("() and [] in selector must be balanced, got: "+t);return e instanceof goog.html.SafeStyle||(e=goog.html.SafeStyle.create(e)),o=t+"{"+goog.html.SafeStyle.unwrap(e)+"}",goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(o)},goog.html.SafeStyleSheet.hasBalancedBrackets_=function(t){for(var e={"(":")","[":"]"},o=[],n=0;n<t.length;n++){var i=t[n];if(e[i])o.push(e[i]);else if(goog.object.contains(e,i)&&o.pop()!=i)return!1}return 0==o.length},goog.html.SafeStyleSheet.concat=function(t){var e="",o=function(t){goog.isArray(t)?goog.array.forEach(t,o):e+=goog.html.SafeStyleSheet.unwrap(t)};return goog.array.forEach(arguments,o),goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(e)},goog.html.SafeStyleSheet.fromConstant=function(t){return t=goog.string.Const.unwrap(t),0===t.length?goog.html.SafeStyleSheet.EMPTY:(goog.asserts.assert(!goog.string.contains(t,"<"),"Forbidden '<' character in style sheet string: "+t),goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(t))},goog.html.SafeStyleSheet.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_},goog.DEBUG&&(goog.html.SafeStyleSheet.prototype.toString=function(){return"SafeStyleSheet{"+this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_+"}"}),goog.html.SafeStyleSheet.unwrap=function(t){return t instanceof goog.html.SafeStyleSheet&&t.constructor===goog.html.SafeStyleSheet&&t.SAFE_STYLE_SHEET_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?t.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_:(goog.asserts.fail("expected object of type SafeStyleSheet, got '"+t+"' of type "+goog.typeOf(t)),"type_error:SafeStyleSheet")},goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse=function(t){return(new goog.html.SafeStyleSheet).initSecurityPrivateDoNotAccessOrElse_(t)},goog.html.SafeStyleSheet.prototype.initSecurityPrivateDoNotAccessOrElse_=function(t){return this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_=t,this},goog.html.SafeStyleSheet.EMPTY=goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(""),goog.html.SafeHtml=function(){this.privateDoNotAccessOrElseSafeHtmlWrappedValue_="",this.SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_,this.dir_=null},goog.html.SafeHtml.prototype.implementsGoogI18nBidiDirectionalString=!0,goog.html.SafeHtml.prototype.getDirection=function(){return this.dir_},goog.html.SafeHtml.prototype.implementsGoogStringTypedString=!0,goog.html.SafeHtml.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_},goog.DEBUG&&(goog.html.SafeHtml.prototype.toString=function(){return"SafeHtml{"+this.privateDoNotAccessOrElseSafeHtmlWrappedValue_+"}"}),goog.html.SafeHtml.unwrap=function(t){return t instanceof goog.html.SafeHtml&&t.constructor===goog.html.SafeHtml&&t.SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?t.privateDoNotAccessOrElseSafeHtmlWrappedValue_:(goog.asserts.fail("expected object of type SafeHtml, got '"+t+"' of type "+goog.typeOf(t)),"type_error:SafeHtml")},goog.html.SafeHtml.htmlEscape=function(t){if(t instanceof goog.html.SafeHtml)return t;var e=null;return t.implementsGoogI18nBidiDirectionalString&&(e=t.getDirection()),t=t.implementsGoogStringTypedString?t.getTypedStringValue():String(t),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.htmlEscape(t),e)},goog.html.SafeHtml.htmlEscapePreservingNewlines=function(t){return t instanceof goog.html.SafeHtml?t:(t=goog.html.SafeHtml.htmlEscape(t),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.newLineToBr(goog.html.SafeHtml.unwrap(t)),t.getDirection()))},goog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces=function(t){return t instanceof goog.html.SafeHtml?t:(t=goog.html.SafeHtml.htmlEscape(t),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.whitespaceEscape(goog.html.SafeHtml.unwrap(t)),t.getDirection()))},goog.html.SafeHtml.from=goog.html.SafeHtml.htmlEscape,goog.html.SafeHtml.VALID_NAMES_IN_TAG_=/^[a-zA-Z0-9-]+$/,goog.html.SafeHtml.URL_ATTRIBUTES_={action:!0,cite:!0,data:!0,formaction:!0,href:!0,manifest:!0,poster:!0,src:!0},goog.html.SafeHtml.NOT_ALLOWED_TAG_NAMES_={APPLET:!0,BASE:!0,EMBED:!0,IFRAME:!0,LINK:!0,MATH:!0,META:!0,OBJECT:!0,SCRIPT:!0,STYLE:!0,SVG:!0,TEMPLATE:!0},goog.html.SafeHtml.create=function(t,e,o){return goog.html.SafeHtml.verifyTagName(String(t)),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(String(t),e,o)},goog.html.SafeHtml.verifyTagName=function(t){if(!goog.html.SafeHtml.VALID_NAMES_IN_TAG_.test(t))throw Error("Invalid tag name <"+t+">.");if(t.toUpperCase()in goog.html.SafeHtml.NOT_ALLOWED_TAG_NAMES_)throw Error("Tag name <"+t+"> is not allowed for SafeHtml.")},goog.html.SafeHtml.createIframe=function(t,e,o,n){t&&goog.html.TrustedResourceUrl.unwrap(t);var i={};return i.src=t||null,i.srcdoc=e&&goog.html.SafeHtml.unwrap(e),t=goog.html.SafeHtml.combineAttributes(i,{sandbox:""},o),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("iframe",t,n)},goog.html.SafeHtml.createSandboxIframe=function(t,e,o,n){if(!goog.html.SafeHtml.canUseSandboxIframe())throw Error("The browser does not support sandboxed iframes.");var i={};return i.src=t?goog.html.SafeUrl.unwrap(goog.html.SafeUrl.sanitize(t)):null,i.srcdoc=e||null,i.sandbox="",t=goog.html.SafeHtml.combineAttributes(i,{},o),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("iframe",t,n)},goog.html.SafeHtml.canUseSandboxIframe=function(){return goog.global.HTMLIFrameElement&&"sandbox"in goog.global.HTMLIFrameElement.prototype},goog.html.SafeHtml.createScriptSrc=function(t,e){goog.html.TrustedResourceUrl.unwrap(t);var o=goog.html.SafeHtml.combineAttributes({src:t},{},e);return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("script",o)},goog.html.SafeHtml.createScript=function(t,e){for(var o in e){var n=o.toLowerCase();if("language"==n||"src"==n||"text"==n||"type"==n)throw Error('Cannot set "'+n+'" attribute')}for(o="",t=goog.array.concat(t),n=0;n<t.length;n++)o+=goog.html.SafeScript.unwrap(t[n]);return o=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(o,goog.i18n.bidi.Dir.NEUTRAL),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("script",e,o)},goog.html.SafeHtml.createStyle=function(t,e){var o=goog.html.SafeHtml.combineAttributes({type:"text/css"},{},e),n="";t=goog.array.concat(t);for(var i=0;i<t.length;i++)n+=goog.html.SafeStyleSheet.unwrap(t[i]);return n=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(n,goog.i18n.bidi.Dir.NEUTRAL),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("style",o,n)},goog.html.SafeHtml.createMetaRefresh=function(t,e){var o=goog.html.SafeUrl.unwrap(goog.html.SafeUrl.sanitize(t));return(goog.labs.userAgent.browser.isIE()||goog.labs.userAgent.browser.isEdge())&&goog.string.contains(o,";")&&(o="'"+o.replace(/'/g,"%27")+"'"),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("meta",{"http-equiv":"refresh",content:(e||0)+"; url="+o})},goog.html.SafeHtml.getAttrNameAndValue_=function(t,e,o){if(o instanceof goog.string.Const)o=goog.string.Const.unwrap(o);else if("style"==e.toLowerCase())o=goog.html.SafeHtml.getStyleValue_(o);else{if(/^on/i.test(e))throw Error('Attribute "'+e+'" requires goog.string.Const value, "'+o+'" given.');if(e.toLowerCase()in goog.html.SafeHtml.URL_ATTRIBUTES_)if(o instanceof goog.html.TrustedResourceUrl)o=goog.html.TrustedResourceUrl.unwrap(o);else if(o instanceof goog.html.SafeUrl)o=goog.html.SafeUrl.unwrap(o);else{if(!goog.isString(o))throw Error('Attribute "'+e+'" on tag "'+t+'" requires goog.html.SafeUrl, goog.string.Const, or string, value "'+o+'" given.');o=goog.html.SafeUrl.sanitize(o).getTypedStringValue()}}return o.implementsGoogStringTypedString&&(o=o.getTypedStringValue()),goog.asserts.assert(goog.isString(o)||goog.isNumber(o),"String or number value expected, got "+typeof o+" with value: "+o),e+'="'+goog.string.htmlEscape(String(o))+'"'},goog.html.SafeHtml.getStyleValue_=function(t){if(!goog.isObject(t))throw Error('The "style" attribute requires goog.html.SafeStyle or map of style properties, '+typeof t+" given: "+t);return t instanceof goog.html.SafeStyle||(t=goog.html.SafeStyle.create(t)),goog.html.SafeStyle.unwrap(t)},goog.html.SafeHtml.createWithDir=function(t,e,o,n){return e=goog.html.SafeHtml.create(e,o,n),e.dir_=t,e},goog.html.SafeHtml.concat=function(t){var e=goog.i18n.bidi.Dir.NEUTRAL,o="",n=function(t){goog.isArray(t)?goog.array.forEach(t,n):(t=goog.html.SafeHtml.htmlEscape(t),o+=goog.html.SafeHtml.unwrap(t),t=t.getDirection(),e==goog.i18n.bidi.Dir.NEUTRAL?e=t:t!=goog.i18n.bidi.Dir.NEUTRAL&&e!=t&&(e=null))};return goog.array.forEach(arguments,n),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(o,e)},goog.html.SafeHtml.concatWithDir=function(t,e){var o=goog.html.SafeHtml.concat(goog.array.slice(arguments,1));return o.dir_=t,o},goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse=function(t,e){return(new goog.html.SafeHtml).initSecurityPrivateDoNotAccessOrElse_(t,e)},goog.html.SafeHtml.prototype.initSecurityPrivateDoNotAccessOrElse_=function(t,e){return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_=t,this.dir_=e,this},goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse=function(t,e,o){var n=null,i="<"+t+goog.html.SafeHtml.stringifyAttributes(t,e);return goog.isDefAndNotNull(o)?goog.isArray(o)||(o=[o]):o=[],goog.dom.tags.isVoidTag(t.toLowerCase())?(goog.asserts.assert(!o.length,"Void tag <"+t+"> does not allow content."),i+=">"):(n=goog.html.SafeHtml.concat(o),i+=">"+goog.html.SafeHtml.unwrap(n)+"</"+t+">",n=n.getDirection()),(t=e&&e.dir)&&(n=/^(ltr|rtl|auto)$/i.test(t)?goog.i18n.bidi.Dir.NEUTRAL:null),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(i,n)},goog.html.SafeHtml.stringifyAttributes=function(t,e){var o="";if(e)for(var n in e){if(!goog.html.SafeHtml.VALID_NAMES_IN_TAG_.test(n))throw Error('Invalid attribute name "'+n+'".');var i=e[n];goog.isDefAndNotNull(i)&&(o+=" "+goog.html.SafeHtml.getAttrNameAndValue_(t,n,i))}return o},goog.html.SafeHtml.combineAttributes=function(t,e,o){var n,i={};for(n in t)goog.asserts.assert(n.toLowerCase()==n,"Must be lower case"),i[n]=t[n];for(n in e)goog.asserts.assert(n.toLowerCase()==n,"Must be lower case"),i[n]=e[n];for(n in o){var r=n.toLowerCase();if(r in t)throw Error('Cannot override "'+r+'" attribute, got "'+n+'" with value "'+o[n]+'"');r in e&&delete i[r],i[n]=o[n]}return i},goog.html.SafeHtml.DOCTYPE_HTML=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("<!DOCTYPE html>",goog.i18n.bidi.Dir.NEUTRAL),goog.html.SafeHtml.EMPTY=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("",goog.i18n.bidi.Dir.NEUTRAL),goog.html.SafeHtml.BR=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("<br>",goog.i18n.bidi.Dir.NEUTRAL),goog.dom.safe={},goog.dom.safe.InsertAdjacentHtmlPosition={AFTERBEGIN:"afterbegin",AFTEREND:"afterend",BEFOREBEGIN:"beforebegin",BEFOREEND:"beforeend"},goog.dom.safe.insertAdjacentHtml=function(t,e,o){t.insertAdjacentHTML(e,goog.html.SafeHtml.unwrap(o))},goog.dom.safe.SET_INNER_HTML_DISALLOWED_TAGS_={MATH:!0,SCRIPT:!0,STYLE:!0,SVG:!0,TEMPLATE:!0},goog.dom.safe.setInnerHtml=function(t,e){if(goog.asserts.ENABLE_ASSERTS){var o=t.tagName.toUpperCase();if(goog.dom.safe.SET_INNER_HTML_DISALLOWED_TAGS_[o])throw Error("goog.dom.safe.setInnerHtml cannot be used to set content of "+t.tagName+".")}t.innerHTML=goog.html.SafeHtml.unwrap(e)},goog.dom.safe.setOuterHtml=function(t,e){t.outerHTML=goog.html.SafeHtml.unwrap(e)},goog.dom.safe.setStyle=function(t,e){t.style.cssText=goog.html.SafeStyle.unwrap(e)},goog.dom.safe.documentWrite=function(t,e){t.write(goog.html.SafeHtml.unwrap(e))},goog.dom.safe.setAnchorHref=function(t,e){goog.dom.asserts.assertIsHTMLAnchorElement(t);var o=e instanceof goog.html.SafeUrl?e:goog.html.SafeUrl.sanitizeAssertUnchanged(e);t.href=goog.html.SafeUrl.unwrap(o)},goog.dom.safe.setImageSrc=function(t,e){goog.dom.asserts.assertIsHTMLImageElement(t);var o=e instanceof goog.html.SafeUrl?e:goog.html.SafeUrl.sanitizeAssertUnchanged(e);t.src=goog.html.SafeUrl.unwrap(o)},goog.dom.safe.setEmbedSrc=function(t,e){goog.dom.asserts.assertIsHTMLEmbedElement(t),t.src=goog.html.TrustedResourceUrl.unwrap(e)},goog.dom.safe.setFrameSrc=function(t,e){goog.dom.asserts.assertIsHTMLFrameElement(t),t.src=goog.html.TrustedResourceUrl.unwrap(e)},goog.dom.safe.setIframeSrc=function(t,e){goog.dom.asserts.assertIsHTMLIFrameElement(t),t.src=goog.html.TrustedResourceUrl.unwrap(e)},goog.dom.safe.setIframeSrcdoc=function(t,e){goog.dom.asserts.assertIsHTMLIFrameElement(t),t.srcdoc=goog.html.SafeHtml.unwrap(e)},goog.dom.safe.setLinkHrefAndRel=function(t,e,o){goog.dom.asserts.assertIsHTMLLinkElement(t),t.rel=o,goog.string.caseInsensitiveContains(o,"stylesheet")?(goog.asserts.assert(e instanceof goog.html.TrustedResourceUrl,'URL must be TrustedResourceUrl because "rel" contains "stylesheet"'),t.href=goog.html.TrustedResourceUrl.unwrap(e)):t.href=e instanceof goog.html.TrustedResourceUrl?goog.html.TrustedResourceUrl.unwrap(e):e instanceof goog.html.SafeUrl?goog.html.SafeUrl.unwrap(e):goog.html.SafeUrl.sanitizeAssertUnchanged(e).getTypedStringValue()},goog.dom.safe.setObjectData=function(t,e){goog.dom.asserts.assertIsHTMLObjectElement(t),t.data=goog.html.TrustedResourceUrl.unwrap(e)},goog.dom.safe.setScriptSrc=function(t,e){goog.dom.asserts.assertIsHTMLScriptElement(t),t.src=goog.html.TrustedResourceUrl.unwrap(e)},goog.dom.safe.setScriptContent=function(t,e){goog.dom.asserts.assertIsHTMLScriptElement(t),t.text=goog.html.SafeScript.unwrap(e)},goog.dom.safe.setLocationHref=function(t,e){goog.dom.asserts.assertIsLocation(t);var o=e instanceof goog.html.SafeUrl?e:goog.html.SafeUrl.sanitizeAssertUnchanged(e);t.href=goog.html.SafeUrl.unwrap(o)},goog.dom.safe.openInWindow=function(t,e,o,n,i){return t=t instanceof goog.html.SafeUrl?t:goog.html.SafeUrl.sanitizeAssertUnchanged(t),(e||window).open(goog.html.SafeUrl.unwrap(t),o?goog.string.Const.unwrap(o):"",n,i)},goog.html.uncheckedconversions={},goog.html.uncheckedconversions.safeHtmlFromStringKnownToSatisfyTypeContract=function(t,e,o){return goog.asserts.assertString(goog.string.Const.unwrap(t),"must provide justification"),goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(t)),"must provide non-empty justification"),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(e,o||null)},goog.html.uncheckedconversions.safeScriptFromStringKnownToSatisfyTypeContract=function(t,e){return goog.asserts.assertString(goog.string.Const.unwrap(t),"must provide justification"),goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(t)),"must provide non-empty justification"),goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(e)},goog.html.uncheckedconversions.safeStyleFromStringKnownToSatisfyTypeContract=function(t,e){return goog.asserts.assertString(goog.string.Const.unwrap(t),"must provide justification"),goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(t)),"must provide non-empty justification"),goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(e)},goog.html.uncheckedconversions.safeStyleSheetFromStringKnownToSatisfyTypeContract=function(t,e){return goog.asserts.assertString(goog.string.Const.unwrap(t),"must provide justification"),goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(t)),"must provide non-empty justification"),goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(e)},goog.html.uncheckedconversions.safeUrlFromStringKnownToSatisfyTypeContract=function(t,e){return goog.asserts.assertString(goog.string.Const.unwrap(t),"must provide justification"),goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(t)),"must provide non-empty justification"),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(e)},goog.html.uncheckedconversions.trustedResourceUrlFromStringKnownToSatisfyTypeContract=function(t,e){return goog.asserts.assertString(goog.string.Const.unwrap(t),"must provide justification"),goog.asserts.assert(!goog.string.isEmptyOrWhitespace(goog.string.Const.unwrap(t)),"must provide non-empty justification"),goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(e)},goog.math.Size=function(t,e){this.width=t,this.height=e},goog.math.Size.equals=function(t,e){return t==e||!(!t||!e)&&(t.width==e.width&&t.height==e.height)},goog.math.Size.prototype.clone=function(){return new goog.math.Size(this.width,this.height)},goog.DEBUG&&(goog.math.Size.prototype.toString=function(){return"("+this.width+" x "+this.height+")"}),goog.math.Size.prototype.getLongest=function(){return Math.max(this.width,this.height)},goog.math.Size.prototype.getShortest=function(){return Math.min(this.width,this.height)},goog.math.Size.prototype.area=function(){return this.width*this.height},goog.math.Size.prototype.perimeter=function(){return 2*(this.width+this.height)},goog.math.Size.prototype.aspectRatio=function(){return this.width/this.height},goog.math.Size.prototype.isEmpty=function(){return!this.area()},goog.math.Size.prototype.ceil=function(){return this.width=Math.ceil(this.width),this.height=Math.ceil(this.height),this},goog.math.Size.prototype.fitsInside=function(t){return this.width<=t.width&&this.height<=t.height},goog.math.Size.prototype.floor=function(){return this.width=Math.floor(this.width),this.height=Math.floor(this.height),this},goog.math.Size.prototype.round=function(){return this.width=Math.round(this.width),this.height=Math.round(this.height),this},goog.math.Size.prototype.scale=function(t,e){var o=goog.isNumber(e)?e:t;return this.width*=t,this.height*=o,this},goog.math.Size.prototype.scaleToCover=function(t){return t=this.aspectRatio()<=t.aspectRatio()?t.width/this.width:t.height/this.height,this.scale(t)},goog.math.Size.prototype.scaleToFit=function(t){return t=this.aspectRatio()>t.aspectRatio()?t.width/this.width:t.height/this.height,this.scale(t)},goog.dom.ASSUME_QUIRKS_MODE=!1,goog.dom.ASSUME_STANDARDS_MODE=!1,goog.dom.COMPAT_MODE_KNOWN_=goog.dom.ASSUME_QUIRKS_MODE||goog.dom.ASSUME_STANDARDS_MODE,goog.dom.getDomHelper=function(t){return t?new goog.dom.DomHelper(goog.dom.getOwnerDocument(t)):goog.dom.defaultDomHelper_||(goog.dom.defaultDomHelper_=new goog.dom.DomHelper)},goog.dom.getDocument=function(){return document},goog.dom.getElement=function(t){return goog.dom.getElementHelper_(document,t)},goog.dom.getElementHelper_=function(t,e){return goog.isString(e)?t.getElementById(e):e},goog.dom.getRequiredElement=function(t){return goog.dom.getRequiredElementHelper_(document,t)},goog.dom.getRequiredElementHelper_=function(t,e){goog.asserts.assertString(e);var o=goog.dom.getElementHelper_(t,e);return o=goog.asserts.assertElement(o,"No element found with id: "+e)},goog.dom.$=goog.dom.getElement,goog.dom.getElementsByTagName=function(t,e){return(e||document).getElementsByTagName(String(t))},goog.dom.getElementsByTagNameAndClass=function(t,e,o){return goog.dom.getElementsByTagNameAndClass_(document,t,e,o)},goog.dom.getElementByTagNameAndClass=function(t,e,o){return goog.dom.getElementByTagNameAndClass_(document,t,e,o)},goog.dom.getElementsByClass=function(t,e){var o=e||document;return goog.dom.canUseQuerySelector_(o)?o.querySelectorAll("."+t):goog.dom.getElementsByTagNameAndClass_(document,"*",t,e)},goog.dom.getElementByClass=function(t,e){var o=e||document;return(o.getElementsByClassName?o.getElementsByClassName(t)[0]:goog.dom.getElementByTagNameAndClass_(document,"*",t,e))||null},goog.dom.getRequiredElementByClass=function(t,e){var o=goog.dom.getElementByClass(t,e);return goog.asserts.assert(o,"No element found with className: "+t)},goog.dom.canUseQuerySelector_=function(t){return!(!t.querySelectorAll||!t.querySelector)},goog.dom.getElementsByTagNameAndClass_=function(t,e,o,n){t=n||t;var i=e&&"*"!=e?String(e).toUpperCase():"";if(goog.dom.canUseQuerySelector_(t)&&(i||o))return t.querySelectorAll(i+(o?"."+o:""));if(o&&t.getElementsByClassName){if(n=t.getElementsByClassName(o),i){t={};for(var r,s=e=0;r=n[s];s++)i==r.nodeName&&(t[e++]=r);return t.length=e,t}return n}if(n=t.getElementsByTagName(i||"*"),o){for(t={},s=e=0;r=n[s];s++)i=r.className,"function"==typeof i.split&&goog.array.contains(i.split(/\s+/),o)&&(t[e++]=r);return t.length=e,t}return n},goog.dom.getElementByTagNameAndClass_=function(t,e,o,n){var i=n||t,r=e&&"*"!=e?String(e).toUpperCase():"";return goog.dom.canUseQuerySelector_(i)&&(r||o)?i.querySelector(r+(o?"."+o:"")):goog.dom.getElementsByTagNameAndClass_(t,e,o,n)[0]||null},goog.dom.$$=goog.dom.getElementsByTagNameAndClass,goog.dom.setProperties=function(t,e){goog.object.forEach(e,function(e,o){e&&e.implementsGoogStringTypedString&&(e=e.getTypedStringValue()),"style"==o?t.style.cssText=e:"class"==o?t.className=e:"for"==o?t.htmlFor=e:goog.dom.DIRECT_ATTRIBUTE_MAP_.hasOwnProperty(o)?t.setAttribute(goog.dom.DIRECT_ATTRIBUTE_MAP_[o],e):goog.string.startsWith(o,"aria-")||goog.string.startsWith(o,"data-")?t.setAttribute(o,e):t[o]=e})},goog.dom.DIRECT_ATTRIBUTE_MAP_={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"},goog.dom.getViewportSize=function(t){return goog.dom.getViewportSize_(t||window)},goog.dom.getViewportSize_=function(t){return t=t.document,t=goog.dom.isCss1CompatMode_(t)?t.documentElement:t.body,new goog.math.Size(t.clientWidth,t.clientHeight)},goog.dom.getDocumentHeight=function(){return goog.dom.getDocumentHeight_(window)},goog.dom.getDocumentHeightForWindow=function(t){return goog.dom.getDocumentHeight_(t)},goog.dom.getDocumentHeight_=function(t){var e=t.document,o=0;if(e){o=e.body;var n=e.documentElement;if(!n||!o)return 0;if(t=goog.dom.getViewportSize_(t).height,goog.dom.isCss1CompatMode_(e)&&n.scrollHeight)o=n.scrollHeight!=t?n.scrollHeight:n.offsetHeight;else{e=n.scrollHeight;var i=n.offsetHeight;n.clientHeight!=i&&(e=o.scrollHeight,i=o.offsetHeight),o=e>t?e>i?e:i:e<i?e:i}}return o},goog.dom.getPageScroll=function(t){return goog.dom.getDomHelper((t||goog.global||window).document).getDocumentScroll()},goog.dom.getDocumentScroll=function(){return goog.dom.getDocumentScroll_(document)},goog.dom.getDocumentScroll_=function(t){var e=goog.dom.getDocumentScrollElement_(t);return t=goog.dom.getWindow_(t),goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("10")&&t.pageYOffset!=e.scrollTop?new goog.math.Coordinate(e.scrollLeft,e.scrollTop):new goog.math.Coordinate(t.pageXOffset||e.scrollLeft,t.pageYOffset||e.scrollTop)},goog.dom.getDocumentScrollElement=function(){return goog.dom.getDocumentScrollElement_(document)},goog.dom.getDocumentScrollElement_=function(t){return t.scrollingElement?t.scrollingElement:!goog.userAgent.WEBKIT&&goog.dom.isCss1CompatMode_(t)?t.documentElement:t.body||t.documentElement},goog.dom.getWindow=function(t){return t?goog.dom.getWindow_(t):window},goog.dom.getWindow_=function(t){return t.parentWindow||t.defaultView},goog.dom.createDom=function(t,e,o){return goog.dom.createDom_(document,arguments)},goog.dom.createDom_=function(t,e){var o=String(e[0]),n=e[1];if(!goog.dom.BrowserFeature.CAN_ADD_NAME_OR_TYPE_ATTRIBUTES&&n&&(n.name||n.type)){if(o=["<",o],n.name&&o.push(' name="',goog.string.htmlEscape(n.name),'"'),n.type){o.push(' type="',goog.string.htmlEscape(n.type),'"');var i={};goog.object.extend(i,n),delete i.type,n=i}o.push(">"),o=o.join("")}return o=t.createElement(o),n&&(goog.isString(n)?o.className=n:goog.isArray(n)?o.className=n.join(" "):goog.dom.setProperties(o,n)),2<e.length&&goog.dom.append_(t,o,e,2),o},goog.dom.append_=function(t,e,o,n){function i(o){o&&e.appendChild(goog.isString(o)?t.createTextNode(o):o)}for(;n<o.length;n++){var r=o[n];goog.isArrayLike(r)&&!goog.dom.isNodeLike(r)?goog.array.forEach(goog.dom.isNodeList(r)?goog.array.toArray(r):r,i):i(r)}},goog.dom.$dom=goog.dom.createDom,goog.dom.createElement=function(t){return goog.dom.createElement_(document,t)},goog.dom.createElement_=function(t,e){return t.createElement(String(e))},goog.dom.createTextNode=function(t){return document.createTextNode(String(t))},goog.dom.createTable=function(t,e,o){return goog.dom.createTable_(document,t,e,!!o)},goog.dom.createTable_=function(t,e,o,n){for(var i=goog.dom.createElement_(t,"TABLE"),r=i.appendChild(goog.dom.createElement_(t,"TBODY")),s=0;s<e;s++){for(var a=goog.dom.createElement_(t,"TR"),l=0;l<o;l++){var c=goog.dom.createElement_(t,"TD");n&&goog.dom.setTextContent(c,goog.string.Unicode.NBSP),a.appendChild(c)}r.appendChild(a)}return i},goog.dom.constHtmlToNode=function(t){var e=goog.array.map(arguments,goog.string.Const.unwrap);return e=goog.html.uncheckedconversions.safeHtmlFromStringKnownToSatisfyTypeContract(goog.string.Const.from("Constant HTML string, that gets turned into a Node later, so it will be automatically balanced."),e.join("")),goog.dom.safeHtmlToNode(e)},goog.dom.safeHtmlToNode=function(t){return goog.dom.safeHtmlToNode_(document,t)},goog.dom.safeHtmlToNode_=function(t,e){var o=goog.dom.createElement_(t,"DIV");return goog.dom.BrowserFeature.INNER_HTML_NEEDS_SCOPED_ELEMENT?(goog.dom.safe.setInnerHtml(o,goog.html.SafeHtml.concat(goog.html.SafeHtml.BR,e)),o.removeChild(o.firstChild)):goog.dom.safe.setInnerHtml(o,e),goog.dom.childrenToNode_(t,o)},goog.dom.childrenToNode_=function(t,e){if(1==e.childNodes.length)return e.removeChild(e.firstChild);for(var o=t.createDocumentFragment();e.firstChild;)o.appendChild(e.firstChild);return o},goog.dom.isCss1CompatMode=function(){return goog.dom.isCss1CompatMode_(document)},goog.dom.isCss1CompatMode_=function(t){return goog.dom.COMPAT_MODE_KNOWN_?goog.dom.ASSUME_STANDARDS_MODE:"CSS1Compat"==t.compatMode},goog.dom.canHaveChildren=function(t){if(t.nodeType!=goog.dom.NodeType.ELEMENT)return!1;switch(t.tagName){case"APPLET":case"AREA":case"BASE":case"BR":case"COL":case"COMMAND":case"EMBED":case"FRAME":case"HR":case"IMG":case"INPUT":case"IFRAME":case"ISINDEX":case"KEYGEN":case"LINK":case"NOFRAMES":case"NOSCRIPT":case"META":case"OBJECT":case"PARAM":case"SCRIPT":case"SOURCE":case"STYLE":case"TRACK":case"WBR":return!1}return!0},goog.dom.appendChild=function(t,e){t.appendChild(e)},goog.dom.append=function(t,e){goog.dom.append_(goog.dom.getOwnerDocument(t),t,arguments,1)},goog.dom.removeChildren=function(t){for(var e;e=t.firstChild;)t.removeChild(e)},goog.dom.insertSiblingBefore=function(t,e){e.parentNode&&e.parentNode.insertBefore(t,e)},goog.dom.insertSiblingAfter=function(t,e){e.parentNode&&e.parentNode.insertBefore(t,e.nextSibling)},goog.dom.insertChildAt=function(t,e,o){t.insertBefore(e,t.childNodes[o]||null)},goog.dom.removeNode=function(t){return t&&t.parentNode?t.parentNode.removeChild(t):null},goog.dom.replaceNode=function(t,e){var o=e.parentNode;o&&o.replaceChild(t,e)},goog.dom.flattenElement=function(t){var e,o=t.parentNode;if(o&&o.nodeType!=goog.dom.NodeType.DOCUMENT_FRAGMENT){if(t.removeNode)return t.removeNode(!1);for(;e=t.firstChild;)o.insertBefore(e,t);return goog.dom.removeNode(t)}},goog.dom.getChildren=function(t){return goog.dom.BrowserFeature.CAN_USE_CHILDREN_ATTRIBUTE&&void 0!=t.children?t.children:goog.array.filter(t.childNodes,function(t){return t.nodeType==goog.dom.NodeType.ELEMENT})},goog.dom.getFirstElementChild=function(t){return goog.isDef(t.firstElementChild)?t.firstElementChild:goog.dom.getNextElementNode_(t.firstChild,!0)},goog.dom.getLastElementChild=function(t){return goog.isDef(t.lastElementChild)?t.lastElementChild:goog.dom.getNextElementNode_(t.lastChild,!1)},goog.dom.getNextElementSibling=function(t){return goog.isDef(t.nextElementSibling)?t.nextElementSibling:goog.dom.getNextElementNode_(t.nextSibling,!0)},goog.dom.getPreviousElementSibling=function(t){return goog.isDef(t.previousElementSibling)?t.previousElementSibling:goog.dom.getNextElementNode_(t.previousSibling,!1)},goog.dom.getNextElementNode_=function(t,e){for(;t&&t.nodeType!=goog.dom.NodeType.ELEMENT;)t=e?t.nextSibling:t.previousSibling;return t},goog.dom.getNextNode=function(t){if(!t)return null;if(t.firstChild)return t.firstChild;for(;t&&!t.nextSibling;)t=t.parentNode;return t?t.nextSibling:null},goog.dom.getPreviousNode=function(t){if(!t)return null;if(!t.previousSibling)return t.parentNode;for(t=t.previousSibling;t&&t.lastChild;)t=t.lastChild;return t},goog.dom.isNodeLike=function(t){return goog.isObject(t)&&0<t.nodeType},goog.dom.isElement=function(t){return goog.isObject(t)&&t.nodeType==goog.dom.NodeType.ELEMENT},goog.dom.isWindow=function(t){return goog.isObject(t)&&t.window==t},goog.dom.getParentElement=function(t){var e;return!goog.dom.BrowserFeature.CAN_USE_PARENT_ELEMENT_PROPERTY||goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("9")&&!goog.userAgent.isVersionOrHigher("10")&&goog.global.SVGElement&&t instanceof goog.global.SVGElement||!(e=t.parentElement)?(e=t.parentNode,goog.dom.isElement(e)?e:null):e},goog.dom.contains=function(t,e){if(!t||!e)return!1;if(t.contains&&e.nodeType==goog.dom.NodeType.ELEMENT)return t==e||t.contains(e);if(void 0!==t.compareDocumentPosition)return t==e||!!(16&t.compareDocumentPosition(e));for(;e&&t!=e;)e=e.parentNode;return e==t},goog.dom.compareNodeOrder=function(t,e){if(t==e)return 0;if(t.compareDocumentPosition)return 2&t.compareDocumentPosition(e)?1:-1;if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)){if(t.nodeType==goog.dom.NodeType.DOCUMENT)return-1;if(e.nodeType==goog.dom.NodeType.DOCUMENT)return 1}if("sourceIndex"in t||t.parentNode&&"sourceIndex"in t.parentNode){var o=t.nodeType==goog.dom.NodeType.ELEMENT,n=e.nodeType==goog.dom.NodeType.ELEMENT;if(o&&n)return t.sourceIndex-e.sourceIndex;var i=t.parentNode,r=e.parentNode;return i==r?goog.dom.compareSiblingOrder_(t,e):!o&&goog.dom.contains(i,e)?-1*goog.dom.compareParentsDescendantNodeIe_(t,e):!n&&goog.dom.contains(r,t)?goog.dom.compareParentsDescendantNodeIe_(e,t):(o?t.sourceIndex:i.sourceIndex)-(n?e.sourceIndex:r.sourceIndex)}return n=goog.dom.getOwnerDocument(t),o=n.createRange(),o.selectNode(t),o.collapse(!0),n=n.createRange(),n.selectNode(e),n.collapse(!0),o.compareBoundaryPoints(goog.global.Range.START_TO_END,n)},goog.dom.compareParentsDescendantNodeIe_=function(t,e){var o=t.parentNode;if(o==e)return-1;for(var n=e;n.parentNode!=o;)n=n.parentNode;return goog.dom.compareSiblingOrder_(n,t)};goog.dom.compareSiblingOrder_=function(t,e){for(var o=e;o=o.previousSibling;)if(o==t)return-1;return 1},goog.dom.findCommonAncestor=function(t){var e,o=arguments.length;if(!o)return null;if(1==o)return arguments[0];var n=[],i=1/0;for(e=0;e<o;e++){for(var r=[],s=arguments[e];s;)r.unshift(s),s=s.parentNode;n.push(r),i=Math.min(i,r.length)}for(r=null,e=0;e<i;e++){s=n[0][e];for(var a=1;a<o;a++)if(s!=n[a][e])return r;r=s}return r},goog.dom.getOwnerDocument=function(t){return goog.asserts.assert(t,"Node cannot be null or undefined."),t.nodeType==goog.dom.NodeType.DOCUMENT?t:t.ownerDocument||t.document},goog.dom.getFrameContentDocument=function(t){return t.contentDocument||t.contentWindow.document},goog.dom.getFrameContentWindow=function(t){try{return t.contentWindow||(t.contentDocument?goog.dom.getWindow(t.contentDocument):null)}catch(t){}return null},goog.dom.setTextContent=function(t,e){if(goog.asserts.assert(null!=t,"goog.dom.setTextContent expects a non-null value for node"),"textContent"in t)t.textContent=e;else if(t.nodeType==goog.dom.NodeType.TEXT)t.data=String(e);else if(t.firstChild&&t.firstChild.nodeType==goog.dom.NodeType.TEXT){for(;t.lastChild!=t.firstChild;)t.removeChild(t.lastChild);t.firstChild.data=String(e)}else{goog.dom.removeChildren(t);var o=goog.dom.getOwnerDocument(t);t.appendChild(o.createTextNode(String(e)))}},goog.dom.getOuterHtml=function(t){if(goog.asserts.assert(null!==t,"goog.dom.getOuterHtml expects a non-null value for element"),"outerHTML"in t)return t.outerHTML;var e=goog.dom.getOwnerDocument(t);return e=goog.dom.createElement_(e,"DIV"),e.appendChild(t.cloneNode(!0)),e.innerHTML},goog.dom.findNode=function(t,e){var o=[];return goog.dom.findNodes_(t,e,o,!0)?o[0]:void 0},goog.dom.findNodes=function(t,e){var o=[];return goog.dom.findNodes_(t,e,o,!1),o},goog.dom.findNodes_=function(t,e,o,n){if(null!=t)for(t=t.firstChild;t;){if(e(t)&&(o.push(t),n)||goog.dom.findNodes_(t,e,o,n))return!0;t=t.nextSibling}return!1},goog.dom.TAGS_TO_IGNORE_={SCRIPT:1,STYLE:1,HEAD:1,IFRAME:1,OBJECT:1},goog.dom.PREDEFINED_TAG_VALUES_={IMG:" ",BR:"\n"},goog.dom.isFocusableTabIndex=function(t){return goog.dom.hasSpecifiedTabIndex_(t)&&goog.dom.isTabIndexFocusable_(t)},goog.dom.setFocusableTabIndex=function(t,e){e?t.tabIndex=0:(t.tabIndex=-1,t.removeAttribute("tabIndex"))},goog.dom.isFocusable=function(t){var e;return(e=goog.dom.nativelySupportsFocus_(t)?!t.disabled&&(!goog.dom.hasSpecifiedTabIndex_(t)||goog.dom.isTabIndexFocusable_(t)):goog.dom.isFocusableTabIndex(t))&&goog.userAgent.IE?goog.dom.hasNonZeroBoundingRect_(t):e},goog.dom.hasSpecifiedTabIndex_=function(t){return goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9")?(t=t.getAttributeNode("tabindex"),goog.isDefAndNotNull(t)&&t.specified):t.hasAttribute("tabindex")},goog.dom.isTabIndexFocusable_=function(t){return t=t.tabIndex,goog.isNumber(t)&&0<=t&&32768>t},goog.dom.nativelySupportsFocus_=function(t){return"A"==t.tagName||"INPUT"==t.tagName||"TEXTAREA"==t.tagName||"SELECT"==t.tagName||"BUTTON"==t.tagName},goog.dom.hasNonZeroBoundingRect_=function(t){return t=!goog.isFunction(t.getBoundingClientRect)||goog.userAgent.IE&&null==t.parentElement?{height:t.offsetHeight,width:t.offsetWidth}:t.getBoundingClientRect(),goog.isDefAndNotNull(t)&&0<t.height&&0<t.width},goog.dom.getTextContent=function(t){if(goog.dom.BrowserFeature.CAN_USE_INNER_TEXT&&null!==t&&"innerText"in t)t=goog.string.canonicalizeNewlines(t.innerText);else{var e=[];goog.dom.getTextContent_(t,e,!0),t=e.join("")}return t=t.replace(/ \xAD /g," ").replace(/\xAD/g,""),t=t.replace(/\u200B/g,""),goog.dom.BrowserFeature.CAN_USE_INNER_TEXT||(t=t.replace(/ +/g," "))," "!=t&&(t=t.replace(/^\s*/,"")),t},goog.dom.getRawTextContent=function(t){var e=[];return goog.dom.getTextContent_(t,e,!1),e.join("")},goog.dom.getTextContent_=function(t,e,o){if(!(t.nodeName in goog.dom.TAGS_TO_IGNORE_))if(t.nodeType==goog.dom.NodeType.TEXT)o?e.push(String(t.nodeValue).replace(/(\r\n|\r|\n)/g,"")):e.push(t.nodeValue);else if(t.nodeName in goog.dom.PREDEFINED_TAG_VALUES_)e.push(goog.dom.PREDEFINED_TAG_VALUES_[t.nodeName]);else for(t=t.firstChild;t;)goog.dom.getTextContent_(t,e,o),t=t.nextSibling},goog.dom.getNodeTextLength=function(t){return goog.dom.getTextContent(t).length},goog.dom.getNodeTextOffset=function(t,e){for(var o=e||goog.dom.getOwnerDocument(t).body,n=[];t&&t!=o;){for(var i=t;i=i.previousSibling;)n.unshift(goog.dom.getTextContent(i));t=t.parentNode}return goog.string.trimLeft(n.join("")).replace(/ +/g," ").length},goog.dom.getNodeAtOffset=function(t,e,o){t=[t];for(var n=0,i=null;0<t.length&&n<e;)if(i=t.pop(),!(i.nodeName in goog.dom.TAGS_TO_IGNORE_))if(i.nodeType==goog.dom.NodeType.TEXT){var r=i.nodeValue.replace(/(\r\n|\r|\n)/g,"").replace(/ +/g," ");n+=r.length}else if(i.nodeName in goog.dom.PREDEFINED_TAG_VALUES_)n+=goog.dom.PREDEFINED_TAG_VALUES_[i.nodeName].length;else for(r=i.childNodes.length-1;0<=r;r--)t.push(i.childNodes[r]);return goog.isObject(o)&&(o.remainder=i?i.nodeValue.length+e-n-1:0,o.node=i),i},goog.dom.isNodeList=function(t){if(t&&"number"==typeof t.length){if(goog.isObject(t))return"function"==typeof t.item||"string"==typeof t.item;if(goog.isFunction(t))return"function"==typeof t.item}return!1},goog.dom.getAncestorByTagNameAndClass=function(t,e,o,n){if(!e&&!o)return null;var i=e?String(e).toUpperCase():null;return goog.dom.getAncestor(t,function(t){return(!i||t.nodeName==i)&&(!o||goog.isString(t.className)&&goog.array.contains(t.className.split(/\s+/),o))},!0,n)},goog.dom.getAncestorByClass=function(t,e,o){return goog.dom.getAncestorByTagNameAndClass(t,null,e,o)},goog.dom.getAncestor=function(t,e,o,n){for(t&&!o&&(t=t.parentNode),o=0;t&&(null==n||o<=n);){if(goog.asserts.assert("parentNode"!=t.name),e(t))return t;t=t.parentNode,o++}return null},goog.dom.getActiveElement=function(t){try{return t&&t.activeElement}catch(t){}return null},goog.dom.getPixelRatio=function(){var t=goog.dom.getWindow();return goog.isDef(t.devicePixelRatio)?t.devicePixelRatio:t.matchMedia?goog.dom.matchesPixelRatio_(3)||goog.dom.matchesPixelRatio_(2)||goog.dom.matchesPixelRatio_(1.5)||goog.dom.matchesPixelRatio_(1)||.75:1},goog.dom.matchesPixelRatio_=function(t){return goog.dom.getWindow().matchMedia("(min-resolution: "+t+"dppx),(min--moz-device-pixel-ratio: "+t+"),(min-resolution: "+96*t+"dpi)").matches?t:0},goog.dom.getCanvasContext2D=function(t){return t.getContext("2d")},goog.dom.DomHelper=function(t){this.document_=t||goog.global.document||document},goog.dom.DomHelper.prototype.getDomHelper=goog.dom.getDomHelper,goog.dom.DomHelper.prototype.setDocument=function(t){this.document_=t},goog.dom.DomHelper.prototype.getDocument=function(){return this.document_},goog.dom.DomHelper.prototype.getElement=function(t){return goog.dom.getElementHelper_(this.document_,t)},goog.dom.DomHelper.prototype.getRequiredElement=function(t){return goog.dom.getRequiredElementHelper_(this.document_,t)},goog.dom.DomHelper.prototype.$=goog.dom.DomHelper.prototype.getElement,goog.dom.DomHelper.prototype.getElementsByTagName=function(t,e){return(e||this.document_).getElementsByTagName(String(t))},goog.dom.DomHelper.prototype.getElementsByTagNameAndClass=function(t,e,o){return goog.dom.getElementsByTagNameAndClass_(this.document_,t,e,o)},goog.dom.DomHelper.prototype.getElementByTagNameAndClass=function(t,e,o){return goog.dom.getElementByTagNameAndClass_(this.document_,t,e,o)},goog.dom.DomHelper.prototype.getElementsByClass=function(t,e){return goog.dom.getElementsByClass(t,e||this.document_)},goog.dom.DomHelper.prototype.getElementByClass=function(t,e){return goog.dom.getElementByClass(t,e||this.document_)},goog.dom.DomHelper.prototype.getRequiredElementByClass=function(t,e){return goog.dom.getRequiredElementByClass(t,e||this.document_)},goog.dom.DomHelper.prototype.$$=goog.dom.DomHelper.prototype.getElementsByTagNameAndClass,goog.dom.DomHelper.prototype.setProperties=goog.dom.setProperties,goog.dom.DomHelper.prototype.getViewportSize=function(t){return goog.dom.getViewportSize(t||this.getWindow())},goog.dom.DomHelper.prototype.getDocumentHeight=function(){return goog.dom.getDocumentHeight_(this.getWindow())},goog.dom.DomHelper.prototype.createDom=function(t,e,o){return goog.dom.createDom_(this.document_,arguments)},goog.dom.DomHelper.prototype.$dom=goog.dom.DomHelper.prototype.createDom,goog.dom.DomHelper.prototype.createElement=function(t){return goog.dom.createElement_(this.document_,t)},goog.dom.DomHelper.prototype.createTextNode=function(t){return this.document_.createTextNode(String(t))},goog.dom.DomHelper.prototype.createTable=function(t,e,o){return goog.dom.createTable_(this.document_,t,e,!!o)},goog.dom.DomHelper.prototype.safeHtmlToNode=function(t){return goog.dom.safeHtmlToNode_(this.document_,t)},goog.dom.DomHelper.prototype.isCss1CompatMode=function(){return goog.dom.isCss1CompatMode_(this.document_)},goog.dom.DomHelper.prototype.getWindow=function(){return goog.dom.getWindow_(this.document_)},goog.dom.DomHelper.prototype.getDocumentScrollElement=function(){return goog.dom.getDocumentScrollElement_(this.document_)},goog.dom.DomHelper.prototype.getDocumentScroll=function(){return goog.dom.getDocumentScroll_(this.document_)},goog.dom.DomHelper.prototype.getActiveElement=function(t){return goog.dom.getActiveElement(t||this.document_)},goog.dom.DomHelper.prototype.appendChild=goog.dom.appendChild,goog.dom.DomHelper.prototype.append=goog.dom.append,goog.dom.DomHelper.prototype.canHaveChildren=goog.dom.canHaveChildren,goog.dom.DomHelper.prototype.removeChildren=goog.dom.removeChildren,goog.dom.DomHelper.prototype.insertSiblingBefore=goog.dom.insertSiblingBefore,goog.dom.DomHelper.prototype.insertSiblingAfter=goog.dom.insertSiblingAfter,goog.dom.DomHelper.prototype.insertChildAt=goog.dom.insertChildAt,goog.dom.DomHelper.prototype.removeNode=goog.dom.removeNode,goog.dom.DomHelper.prototype.replaceNode=goog.dom.replaceNode,goog.dom.DomHelper.prototype.flattenElement=goog.dom.flattenElement,goog.dom.DomHelper.prototype.getChildren=goog.dom.getChildren,goog.dom.DomHelper.prototype.getFirstElementChild=goog.dom.getFirstElementChild,goog.dom.DomHelper.prototype.getLastElementChild=goog.dom.getLastElementChild,goog.dom.DomHelper.prototype.getNextElementSibling=goog.dom.getNextElementSibling,goog.dom.DomHelper.prototype.getPreviousElementSibling=goog.dom.getPreviousElementSibling,goog.dom.DomHelper.prototype.getNextNode=goog.dom.getNextNode,goog.dom.DomHelper.prototype.getPreviousNode=goog.dom.getPreviousNode,goog.dom.DomHelper.prototype.isNodeLike=goog.dom.isNodeLike,goog.dom.DomHelper.prototype.isElement=goog.dom.isElement,goog.dom.DomHelper.prototype.isWindow=goog.dom.isWindow,goog.dom.DomHelper.prototype.getParentElement=goog.dom.getParentElement,goog.dom.DomHelper.prototype.contains=goog.dom.contains,goog.dom.DomHelper.prototype.compareNodeOrder=goog.dom.compareNodeOrder,goog.dom.DomHelper.prototype.findCommonAncestor=goog.dom.findCommonAncestor,goog.dom.DomHelper.prototype.getOwnerDocument=goog.dom.getOwnerDocument,goog.dom.DomHelper.prototype.getFrameContentDocument=goog.dom.getFrameContentDocument,goog.dom.DomHelper.prototype.getFrameContentWindow=goog.dom.getFrameContentWindow,goog.dom.DomHelper.prototype.setTextContent=goog.dom.setTextContent,goog.dom.DomHelper.prototype.getOuterHtml=goog.dom.getOuterHtml,goog.dom.DomHelper.prototype.findNode=goog.dom.findNode,goog.dom.DomHelper.prototype.findNodes=goog.dom.findNodes,goog.dom.DomHelper.prototype.isFocusableTabIndex=goog.dom.isFocusableTabIndex,goog.dom.DomHelper.prototype.setFocusableTabIndex=goog.dom.setFocusableTabIndex,goog.dom.DomHelper.prototype.isFocusable=goog.dom.isFocusable,goog.dom.DomHelper.prototype.getTextContent=goog.dom.getTextContent,goog.dom.DomHelper.prototype.getNodeTextLength=goog.dom.getNodeTextLength,goog.dom.DomHelper.prototype.getNodeTextOffset=goog.dom.getNodeTextOffset,goog.dom.DomHelper.prototype.getNodeAtOffset=goog.dom.getNodeAtOffset,goog.dom.DomHelper.prototype.isNodeList=goog.dom.isNodeList,goog.dom.DomHelper.prototype.getAncestorByTagNameAndClass=goog.dom.getAncestorByTagNameAndClass,goog.dom.DomHelper.prototype.getAncestorByClass=goog.dom.getAncestorByClass,goog.dom.DomHelper.prototype.getAncestor=goog.dom.getAncestor,goog.dom.DomHelper.prototype.getCanvasContext2D=goog.dom.getCanvasContext2D,goog.color={},goog.color.names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},goog.color.parse=function(t){var e={};t=String(t);var o=goog.color.prependHashIfNecessaryHelper(t);if(goog.color.isValidHexColor_(o))return e.hex=goog.color.normalizeHex(o),e.type="hex",e;if(o=goog.color.isValidRgbColor_(t),o.length)return e.hex=goog.color.rgbArrayToHex(o),e.type="rgb",e;if(goog.color.names&&(o=goog.color.names[t.toLowerCase()]))return e.hex=o,e.type="named",e;throw Error(t+" is not a valid color string")},goog.color.isValidColor=function(t){var e=goog.color.prependHashIfNecessaryHelper(t);return!!(goog.color.isValidHexColor_(e)||goog.color.isValidRgbColor_(t).length||goog.color.names&&goog.color.names[t.toLowerCase()])},goog.color.parseRgb=function(t){var e=goog.color.isValidRgbColor_(t);if(!e.length)throw Error(t+" is not a valid RGB color");return e},goog.color.hexToRgbStyle=function(t){return goog.color.rgbStyle_(goog.color.hexToRgb(t))},goog.color.hexTripletRe_=/#(.)(.)(.)/,goog.color.normalizeHex=function(t){if(!goog.color.isValidHexColor_(t))throw Error("'"+t+"' is not a valid hex color");return 4==t.length&&(t=t.replace(goog.color.hexTripletRe_,"#$1$1$2$2$3$3")),t.toLowerCase()},goog.color.hexToRgb=function(t){t=goog.color.normalizeHex(t);var e=parseInt(t.substr(1,2),16),o=parseInt(t.substr(3,2),16);return t=parseInt(t.substr(5,2),16),[e,o,t]},goog.color.rgbToHex=function(t,e,o){if(t=Number(t),e=Number(e),o=Number(o),t!=(255&t)||e!=(255&e)||o!=(255&o))throw Error('"('+t+","+e+","+o+'") is not a valid RGB color');return t=goog.color.prependZeroIfNecessaryHelper(t.toString(16)),e=goog.color.prependZeroIfNecessaryHelper(e.toString(16)),o=goog.color.prependZeroIfNecessaryHelper(o.toString(16)),"#"+t+e+o},goog.color.rgbArrayToHex=function(t){return goog.color.rgbToHex(t[0],t[1],t[2])},goog.color.rgbToHsl=function(t,e,o){t/=255,e/=255,o/=255;var n=Math.max(t,e,o),i=Math.min(t,e,o),r=0,s=0,a=.5*(n+i);return n!=i&&(n==t?r=60*(e-o)/(n-i):n==e?r=60*(o-t)/(n-i)+120:n==o&&(r=60*(t-e)/(n-i)+240),s=0<a&&.5>=a?(n-i)/(2*a):(n-i)/(2-2*a)),[Math.round(r+360)%360,s,a]},goog.color.rgbArrayToHsl=function(t){return goog.color.rgbToHsl(t[0],t[1],t[2])},goog.color.hueToRgb_=function(t,e,o){return 0>o?o+=1:1<o&&--o,1>6*o?t+6*(e-t)*o:1>2*o?e:2>3*o?t+(e-t)*(2/3-o)*6:t},goog.color.hslToRgb=function(t,e,o){if(t/=360,0==e)o=e=t=255*o;else{var n=.5>o?o*(1+e):o+e-e*o,i=2*o-n;o=255*goog.color.hueToRgb_(i,n,t+1/3),e=255*goog.color.hueToRgb_(i,n,t),t=255*goog.color.hueToRgb_(i,n,t-1/3)}return[Math.round(o),Math.round(e),Math.round(t)]},goog.color.hslArrayToRgb=function(t){return goog.color.hslToRgb(t[0],t[1],t[2])},goog.color.validHexColorRe_=/^#(?:[0-9a-f]{3}){1,2}$/i,goog.color.isValidHexColor_=function(t){return goog.color.validHexColorRe_.test(t)},goog.color.normalizedHexColorRe_=/^#[0-9a-f]{6}$/,goog.color.isNormalizedHexColor_=function(t){return goog.color.normalizedHexColorRe_.test(t)},goog.color.rgbColorRe_=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i,goog.color.isValidRgbColor_=function(t){var e=t.match(goog.color.rgbColorRe_);if(e){t=Number(e[1]);var o=Number(e[2]);if(e=Number(e[3]),0<=t&&255>=t&&0<=o&&255>=o&&0<=e&&255>=e)return[t,o,e]}return[]},goog.color.prependZeroIfNecessaryHelper=function(t){return 1==t.length?"0"+t:t},goog.color.prependHashIfNecessaryHelper=function(t){return"#"==t.charAt(0)?t:"#"+t},goog.color.rgbStyle_=function(t){return"rgb("+t.join(",")+")"},goog.color.hsvToRgb=function(t,e,o){var n=0,i=0,r=0;if(0==e)r=i=n=o;else{var s=Math.floor(t/60),a=t/60-s;t=o*(1-e);var l=o*(1-e*a);switch(e=o*(1-e*(1-a)),s){case 1:n=l,i=o,r=t;break;case 2:n=t,i=o,r=e;break;case 3:n=t,i=l,r=o;break;case 4:n=e,i=t,r=o;break;case 5:n=o,i=t,r=l;break;case 6:case 0:n=o,i=e,r=t}}return[Math.floor(n),Math.floor(i),Math.floor(r)]},goog.color.rgbToHsv=function(t,e,o){var n=Math.max(Math.max(t,e),o),i=Math.min(Math.min(t,e),o);if(i==n)i=t=0;else{var r=n-i;i=r/n,t=60*(t==n?(e-o)/r:e==n?2+(o-t)/r:4+(t-e)/r),0>t&&(t+=360),360<t&&(t-=360)}return[t,i,n]},goog.color.rgbArrayToHsv=function(t){return goog.color.rgbToHsv(t[0],t[1],t[2])},goog.color.hsvArrayToRgb=function(t){return goog.color.hsvToRgb(t[0],t[1],t[2])},goog.color.hexToHsl=function(t){return t=goog.color.hexToRgb(t),goog.color.rgbToHsl(t[0],t[1],t[2])},goog.color.hslToHex=function(t,e,o){return goog.color.rgbArrayToHex(goog.color.hslToRgb(t,e,o))},goog.color.hslArrayToHex=function(t){return goog.color.rgbArrayToHex(goog.color.hslToRgb(t[0],t[1],t[2]))},goog.color.hexToHsv=function(t){return goog.color.rgbArrayToHsv(goog.color.hexToRgb(t))},goog.color.hsvToHex=function(t,e,o){return goog.color.rgbArrayToHex(goog.color.hsvToRgb(t,e,o))},goog.color.hsvArrayToHex=function(t){return goog.color.hsvToHex(t[0],t[1],t[2])},goog.color.hslDistance=function(t,e){var o=.5>=t[2]?t[1]*t[2]:t[1]*(1-t[2]),n=.5>=e[2]?e[1]*e[2]:e[1]*(1-e[2]);return(t[2]-e[2])*(t[2]-e[2])+o*o+n*n-2*o*n*Math.cos(2*(t[0]/360-e[0]/360)*Math.PI)},goog.color.blend=function(t,e,o){return o=goog.math.clamp(o,0,1),[Math.round(o*t[0]+(1-o)*e[0]),Math.round(o*t[1]+(1-o)*e[1]),Math.round(o*t[2]+(1-o)*e[2])]},goog.color.darken=function(t,e){return goog.color.blend([0,0,0],t,e)},goog.color.lighten=function(t,e){return goog.color.blend([255,255,255],t,e)},goog.color.highContrast=function(t,e){for(var o=[],n=0;n<e.length;n++)o.push({color:e[n],diff:goog.color.yiqBrightnessDiff_(e[n],t)+goog.color.colorDiff_(e[n],t)});return o.sort(function(t,e){return e.diff-t.diff}),o[0].color},goog.color.yiqBrightness_=function(t){return Math.round((299*t[0]+587*t[1]+114*t[2])/1e3)},goog.color.yiqBrightnessDiff_=function(t,e){return Math.abs(goog.color.yiqBrightness_(t)-goog.color.yiqBrightness_(e))},goog.color.colorDiff_=function(t,e){return Math.abs(t[0]-e[0])+Math.abs(t[1]-e[1])+Math.abs(t[2]-e[2])},goog.dom.vendor={},goog.dom.vendor.getVendorJsPrefix=function(){return goog.userAgent.WEBKIT?"Webkit":goog.userAgent.GECKO?"Moz":goog.userAgent.IE?"ms":goog.userAgent.OPERA?"O":null},goog.dom.vendor.getVendorPrefix=function(){return goog.userAgent.WEBKIT?"-webkit":goog.userAgent.GECKO?"-moz":goog.userAgent.IE?"-ms":goog.userAgent.OPERA?"-o":null},goog.dom.vendor.getPrefixedPropertyName=function(t,e){if(e&&t in e)return t;var o=goog.dom.vendor.getVendorJsPrefix();return o?(o=o.toLowerCase(),o+=goog.string.toTitleCase(t),!goog.isDef(e)||o in e?o:null):null},goog.dom.vendor.getPrefixedEventType=function(t){return((goog.dom.vendor.getVendorJsPrefix()||"")+t).toLowerCase()},goog.html.legacyconversions={},goog.html.legacyconversions.safeHtmlFromString=function(t){return goog.html.legacyconversions.reportCallback_(),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(t,null)},goog.html.legacyconversions.safeScriptFromString=function(t){return goog.html.legacyconversions.reportCallback_(),goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(t)},goog.html.legacyconversions.safeStyleFromString=function(t){return goog.html.legacyconversions.reportCallback_(),goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(t)},goog.html.legacyconversions.safeStyleSheetFromString=function(t){return goog.html.legacyconversions.reportCallback_(),goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(t)},goog.html.legacyconversions.safeUrlFromString=function(t){return goog.html.legacyconversions.reportCallback_(),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(t)},goog.html.legacyconversions.trustedResourceUrlFromString=function(t){return goog.html.legacyconversions.reportCallback_(),goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(t)},goog.html.legacyconversions.reportCallback_=goog.nullFunction,goog.html.legacyconversions.setReportCallback=function(t){goog.html.legacyconversions.reportCallback_=t},goog.math.Box=function(t,e,o,n){this.top=t,this.right=e,this.bottom=o,this.left=n},goog.math.Box.boundingBox=function(t){for(var e=new goog.math.Box(arguments[0].y,arguments[0].x,arguments[0].y,arguments[0].x),o=1;o<arguments.length;o++)e.expandToIncludeCoordinate(arguments[o]);return e},goog.math.Box.prototype.getWidth=function(){return this.right-this.left},goog.math.Box.prototype.getHeight=function(){return this.bottom-this.top},goog.math.Box.prototype.clone=function(){return new goog.math.Box(this.top,this.right,this.bottom,this.left)},goog.DEBUG&&(goog.math.Box.prototype.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"}),goog.math.Box.prototype.contains=function(t){return goog.math.Box.contains(this,t)},goog.math.Box.prototype.expand=function(t,e,o,n){return goog.isObject(t)?(this.top-=t.top,this.right+=t.right,this.bottom+=t.bottom,this.left-=t.left):(this.top-=t,this.right+=Number(e),this.bottom+=Number(o),this.left-=Number(n)),this},goog.math.Box.prototype.expandToInclude=function(t){this.left=Math.min(this.left,t.left),this.top=Math.min(this.top,t.top),this.right=Math.max(this.right,t.right),this.bottom=Math.max(this.bottom,t.bottom)},goog.math.Box.prototype.expandToIncludeCoordinate=function(t){this.top=Math.min(this.top,t.y),this.right=Math.max(this.right,t.x),this.bottom=Math.max(this.bottom,t.y),this.left=Math.min(this.left,t.x)},goog.math.Box.equals=function(t,e){return t==e||!(!t||!e)&&(t.top==e.top&&t.right==e.right&&t.bottom==e.bottom&&t.left==e.left)},goog.math.Box.contains=function(t,e){return!(!t||!e)&&(e instanceof goog.math.Box?e.left>=t.left&&e.right<=t.right&&e.top>=t.top&&e.bottom<=t.bottom:e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom)},goog.math.Box.relativePositionX=function(t,e){return e.x<t.left?e.x-t.left:e.x>t.right?e.x-t.right:0},goog.math.Box.relativePositionY=function(t,e){return e.y<t.top?e.y-t.top:e.y>t.bottom?e.y-t.bottom:0},goog.math.Box.distance=function(t,e){var o=goog.math.Box.relativePositionX(t,e),n=goog.math.Box.relativePositionY(t,e);return Math.sqrt(o*o+n*n)},goog.math.Box.intersects=function(t,e){return t.left<=e.right&&e.left<=t.right&&t.top<=e.bottom&&e.top<=t.bottom},goog.math.Box.intersectsWithPadding=function(t,e,o){return t.left<=e.right+o&&e.left<=t.right+o&&t.top<=e.bottom+o&&e.top<=t.bottom+o},goog.math.Box.prototype.ceil=function(){return this.top=Math.ceil(this.top),this.right=Math.ceil(this.right),this.bottom=Math.ceil(this.bottom),this.left=Math.ceil(this.left),this},goog.math.Box.prototype.floor=function(){return this.top=Math.floor(this.top),this.right=Math.floor(this.right),this.bottom=Math.floor(this.bottom),this.left=Math.floor(this.left),this},goog.math.Box.prototype.round=function(){return this.top=Math.round(this.top),this.right=Math.round(this.right),this.bottom=Math.round(this.bottom),this.left=Math.round(this.left),this},goog.math.Box.prototype.translate=function(t,e){return t instanceof goog.math.Coordinate?(this.left+=t.x,this.right+=t.x,this.top+=t.y,this.bottom+=t.y):(goog.asserts.assertNumber(t),this.left+=t,this.right+=t,goog.isNumber(e)&&(this.top+=e,this.bottom+=e)),this},goog.math.Box.prototype.scale=function(t,e){var o=goog.isNumber(e)?e:t;return this.left*=t,this.right*=t,this.top*=o,this.bottom*=o,this},goog.math.IRect=function(){},goog.math.Rect=function(t,e,o,n){this.left=t,this.top=e,this.width=o,this.height=n},goog.math.Rect.prototype.clone=function(){return new goog.math.Rect(this.left,this.top,this.width,this.height)},goog.math.Rect.prototype.toBox=function(){return new goog.math.Box(this.top,this.left+this.width,this.top+this.height,this.left)},goog.math.Rect.createFromPositionAndSize=function(t,e){return new goog.math.Rect(t.x,t.y,e.width,e.height)},goog.math.Rect.createFromBox=function(t){return new goog.math.Rect(t.left,t.top,t.right-t.left,t.bottom-t.top)},goog.DEBUG&&(goog.math.Rect.prototype.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"}),goog.math.Rect.equals=function(t,e){return t==e||!(!t||!e)&&(t.left==e.left&&t.width==e.width&&t.top==e.top&&t.height==e.height)},goog.math.Rect.prototype.intersection=function(t){var e=Math.max(this.left,t.left),o=Math.min(this.left+this.width,t.left+t.width);if(e<=o){var n=Math.max(this.top,t.top);if(t=Math.min(this.top+this.height,t.top+t.height),n<=t)return this.left=e,this.top=n,this.width=o-e,this.height=t-n,!0}return!1},goog.math.Rect.intersection=function(t,e){var o=Math.max(t.left,e.left),n=Math.min(t.left+t.width,e.left+e.width);if(o<=n){var i=Math.max(t.top,e.top),r=Math.min(t.top+t.height,e.top+e.height);if(i<=r)return new goog.math.Rect(o,i,n-o,r-i)}return null},goog.math.Rect.intersects=function(t,e){return t.left<=e.left+e.width&&e.left<=t.left+t.width&&t.top<=e.top+e.height&&e.top<=t.top+t.height},goog.math.Rect.prototype.intersects=function(t){return goog.math.Rect.intersects(this,t)},goog.math.Rect.difference=function(t,e){var o=goog.math.Rect.intersection(t,e);if(!o||!o.height||!o.width)return[t.clone()];o=[];var n=t.top,i=t.height,r=t.left+t.width,s=t.top+t.height,a=e.left+e.width,l=e.top+e.height;return e.top>t.top&&(o.push(new goog.math.Rect(t.left,t.top,t.width,e.top-t.top)),n=e.top,i-=e.top-t.top),l<s&&(o.push(new goog.math.Rect(t.left,l,t.width,s-l)),i=l-n),e.left>t.left&&o.push(new goog.math.Rect(t.left,n,e.left-t.left,i)),a<r&&o.push(new goog.math.Rect(a,n,r-a,i)),o},goog.math.Rect.prototype.difference=function(t){return goog.math.Rect.difference(this,t)},goog.math.Rect.prototype.boundingRect=function(t){var e=Math.max(this.left+this.width,t.left+t.width),o=Math.max(this.top+this.height,t.top+t.height);this.left=Math.min(this.left,t.left),this.top=Math.min(this.top,t.top),this.width=e-this.left,this.height=o-this.top},goog.math.Rect.boundingRect=function(t,e){if(!t||!e)return null;var o=new goog.math.Rect(t.left,t.top,t.width,t.height);return o.boundingRect(e),o},goog.math.Rect.prototype.contains=function(t){return t instanceof goog.math.Coordinate?t.x>=this.left&&t.x<=this.left+this.width&&t.y>=this.top&&t.y<=this.top+this.height:this.left<=t.left&&this.left+this.width>=t.left+t.width&&this.top<=t.top&&this.top+this.height>=t.top+t.height};goog.math.Rect.prototype.squaredDistance=function(t){var e=t.x<this.left?this.left-t.x:Math.max(t.x-(this.left+this.width),0);return t=t.y<this.top?this.top-t.y:Math.max(t.y-(this.top+this.height),0),e*e+t*t},goog.math.Rect.prototype.distance=function(t){return Math.sqrt(this.squaredDistance(t))},goog.math.Rect.prototype.getSize=function(){return new goog.math.Size(this.width,this.height)},goog.math.Rect.prototype.getTopLeft=function(){return new goog.math.Coordinate(this.left,this.top)},goog.math.Rect.prototype.getCenter=function(){return new goog.math.Coordinate(this.left+this.width/2,this.top+this.height/2)},goog.math.Rect.prototype.getBottomRight=function(){return new goog.math.Coordinate(this.left+this.width,this.top+this.height)},goog.math.Rect.prototype.ceil=function(){return this.left=Math.ceil(this.left),this.top=Math.ceil(this.top),this.width=Math.ceil(this.width),this.height=Math.ceil(this.height),this},goog.math.Rect.prototype.floor=function(){return this.left=Math.floor(this.left),this.top=Math.floor(this.top),this.width=Math.floor(this.width),this.height=Math.floor(this.height),this},goog.math.Rect.prototype.round=function(){return this.left=Math.round(this.left),this.top=Math.round(this.top),this.width=Math.round(this.width),this.height=Math.round(this.height),this},goog.math.Rect.prototype.translate=function(t,e){return t instanceof goog.math.Coordinate?(this.left+=t.x,this.top+=t.y):(this.left+=goog.asserts.assertNumber(t),goog.isNumber(e)&&(this.top+=e)),this},goog.math.Rect.prototype.scale=function(t,e){var o=goog.isNumber(e)?e:t;return this.left*=t,this.width*=t,this.top*=o,this.height*=o,this},goog.style={},goog.style.setStyle=function(t,e,o){if(goog.isString(e))goog.style.setStyle_(t,o,e);else for(var n in e)goog.style.setStyle_(t,e[n],n)},goog.style.setStyle_=function(t,e,o){(o=goog.style.getVendorJsStyleName_(t,o))&&(t.style[o]=e)},goog.style.styleNameCache_={},goog.style.getVendorJsStyleName_=function(t,e){var o=goog.style.styleNameCache_[e];if(!o){var n=goog.string.toCamelCase(e);o=n,void 0===t.style[n]&&(n=goog.dom.vendor.getVendorJsPrefix()+goog.string.toTitleCase(n),void 0!==t.style[n]&&(o=n)),goog.style.styleNameCache_[e]=o}return o},goog.style.getVendorStyleName_=function(t,e){var o=goog.string.toCamelCase(e);return void 0===t.style[o]&&(o=goog.dom.vendor.getVendorJsPrefix()+goog.string.toTitleCase(o),void 0!==t.style[o])?goog.dom.vendor.getVendorPrefix()+"-"+e:e},goog.style.getStyle=function(t,e){var o=t.style[goog.string.toCamelCase(e)];return void 0!==o?o:t.style[goog.style.getVendorJsStyleName_(t,e)]||""},goog.style.getComputedStyle=function(t,e){var o=goog.dom.getOwnerDocument(t);return o.defaultView&&o.defaultView.getComputedStyle&&(o=o.defaultView.getComputedStyle(t,null))?o[e]||o.getPropertyValue(e)||"":""},goog.style.getCascadedStyle=function(t,e){return t.currentStyle?t.currentStyle[e]:null},goog.style.getStyle_=function(t,e){return goog.style.getComputedStyle(t,e)||goog.style.getCascadedStyle(t,e)||t.style&&t.style[e]},goog.style.getComputedBoxSizing=function(t){return goog.style.getStyle_(t,"boxSizing")||goog.style.getStyle_(t,"MozBoxSizing")||goog.style.getStyle_(t,"WebkitBoxSizing")||null},goog.style.getComputedPosition=function(t){return goog.style.getStyle_(t,"position")},goog.style.getBackgroundColor=function(t){return goog.style.getStyle_(t,"backgroundColor")},goog.style.getComputedOverflowX=function(t){return goog.style.getStyle_(t,"overflowX")},goog.style.getComputedOverflowY=function(t){return goog.style.getStyle_(t,"overflowY")},goog.style.getComputedZIndex=function(t){return goog.style.getStyle_(t,"zIndex")},goog.style.getComputedTextAlign=function(t){return goog.style.getStyle_(t,"textAlign")},goog.style.getComputedCursor=function(t){return goog.style.getStyle_(t,"cursor")},goog.style.getComputedTransform=function(t){var e=goog.style.getVendorStyleName_(t,"transform");return goog.style.getStyle_(t,e)||goog.style.getStyle_(t,"transform")},goog.style.setPosition=function(t,e,o){if(e instanceof goog.math.Coordinate){var n=e.x;e=e.y}else n=e,e=o;t.style.left=goog.style.getPixelStyleValue_(n,!1),t.style.top=goog.style.getPixelStyleValue_(e,!1)},goog.style.getPosition=function(t){return new goog.math.Coordinate(t.offsetLeft,t.offsetTop)},goog.style.getClientViewportElement=function(t){return t=t?goog.dom.getOwnerDocument(t):goog.dom.getDocument(),!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9)||goog.dom.getDomHelper(t).isCss1CompatMode()?t.documentElement:t.body},goog.style.getViewportPageOffset=function(t){var e=t.body;return t=t.documentElement,new goog.math.Coordinate(e.scrollLeft||t.scrollLeft,e.scrollTop||t.scrollTop)},goog.style.getBoundingClientRect_=function(t){try{var e=t.getBoundingClientRect()}catch(t){return{left:0,top:0,right:0,bottom:0}}return goog.userAgent.IE&&t.ownerDocument.body&&(t=t.ownerDocument,e.left-=t.documentElement.clientLeft+t.body.clientLeft,e.top-=t.documentElement.clientTop+t.body.clientTop),e},goog.style.getOffsetParent=function(t){if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(8))return goog.asserts.assert(t&&"offsetParent"in t),t.offsetParent;var e=goog.dom.getOwnerDocument(t),o=goog.style.getStyle_(t,"position"),n="fixed"==o||"absolute"==o;for(t=t.parentNode;t&&t!=e;t=t.parentNode)if(t.nodeType==goog.dom.NodeType.DOCUMENT_FRAGMENT&&t.host&&(t=t.host),o=goog.style.getStyle_(t,"position"),!(n=n&&"static"==o&&t!=e.documentElement&&t!=e.body)&&(t.scrollWidth>t.clientWidth||t.scrollHeight>t.clientHeight||"fixed"==o||"absolute"==o||"relative"==o))return t;return null},goog.style.getVisibleRectForElement=function(t){for(var e=new goog.math.Box(0,1/0,1/0,0),o=goog.dom.getDomHelper(t),n=o.getDocument().body,i=o.getDocument().documentElement,r=o.getDocumentScrollElement();t=goog.style.getOffsetParent(t);)if(!(goog.userAgent.IE&&0==t.clientWidth||goog.userAgent.WEBKIT&&0==t.clientHeight&&t==n)&&t!=n&&t!=i&&"visible"!=goog.style.getStyle_(t,"overflow")){var s=goog.style.getPageOffset(t),a=goog.style.getClientLeftTop(t);s.x+=a.x,s.y+=a.y,e.top=Math.max(e.top,s.y),e.right=Math.min(e.right,s.x+t.clientWidth),e.bottom=Math.min(e.bottom,s.y+t.clientHeight),e.left=Math.max(e.left,s.x)}return n=r.scrollLeft,r=r.scrollTop,e.left=Math.max(e.left,n),e.top=Math.max(e.top,r),o=o.getViewportSize(),e.right=Math.min(e.right,n+o.width),e.bottom=Math.min(e.bottom,r+o.height),0<=e.top&&0<=e.left&&e.bottom>e.top&&e.right>e.left?e:null},goog.style.getContainerOffsetToScrollInto=function(t,e,o){var n=e||goog.dom.getDocumentScrollElement(),i=goog.style.getPageOffset(t),r=goog.style.getPageOffset(n),s=goog.style.getBorderBox(n);return n==goog.dom.getDocumentScrollElement()?(e=i.x-n.scrollLeft,i=i.y-n.scrollTop,goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(10)&&(e+=s.left,i+=s.top)):(e=i.x-r.x-s.left,i=i.y-r.y-s.top),s=goog.style.getSizeWithDisplay_(t),t=n.clientWidth-s.width,s=n.clientHeight-s.height,r=n.scrollLeft,n=n.scrollTop,o?(r+=e-t/2,n+=i-s/2):(r+=Math.min(e,Math.max(e-t,0)),n+=Math.min(i,Math.max(i-s,0))),new goog.math.Coordinate(r,n)},goog.style.scrollIntoContainerView=function(t,e,o){e=e||goog.dom.getDocumentScrollElement(),t=goog.style.getContainerOffsetToScrollInto(t,e,o),e.scrollLeft=t.x,e.scrollTop=t.y},goog.style.getClientLeftTop=function(t){return new goog.math.Coordinate(t.clientLeft,t.clientTop)},goog.style.getPageOffset=function(t){var e=goog.dom.getOwnerDocument(t);goog.asserts.assertObject(t,"Parameter is required");var o=new goog.math.Coordinate(0,0);return t==goog.style.getClientViewportElement(e)?o:(t=goog.style.getBoundingClientRect_(t),e=goog.dom.getDomHelper(e).getDocumentScroll(),o.x=t.left+e.x,o.y=t.top+e.y,o)},goog.style.getPageOffsetLeft=function(t){return goog.style.getPageOffset(t).x},goog.style.getPageOffsetTop=function(t){return goog.style.getPageOffset(t).y},goog.style.getFramedPageOffset=function(t,e){var o=new goog.math.Coordinate(0,0),n=goog.dom.getWindow(goog.dom.getOwnerDocument(t));if(!goog.reflect.canAccessProperty(n,"parent"))return o;var i=t;do{var r=n==e?goog.style.getPageOffset(i):goog.style.getClientPositionForElement_(goog.asserts.assert(i));o.x+=r.x,o.y+=r.y}while(n&&n!=e&&n!=n.parent&&(i=n.frameElement)&&(n=n.parent));return o},goog.style.translateRectForAnotherFrame=function(t,e,o){if(e.getDocument()!=o.getDocument()){var n=e.getDocument().body;o=goog.style.getFramedPageOffset(n,o.getWindow()),o=goog.math.Coordinate.difference(o,goog.style.getPageOffset(n)),!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9)||e.isCss1CompatMode()||(o=goog.math.Coordinate.difference(o,e.getDocumentScroll())),t.left+=o.x,t.top+=o.y}},goog.style.getRelativePosition=function(t,e){var o=goog.style.getClientPosition(t),n=goog.style.getClientPosition(e);return new goog.math.Coordinate(o.x-n.x,o.y-n.y)},goog.style.getClientPositionForElement_=function(t){return t=goog.style.getBoundingClientRect_(t),new goog.math.Coordinate(t.left,t.top)},goog.style.getClientPosition=function(t){return goog.asserts.assert(t),t.nodeType==goog.dom.NodeType.ELEMENT?goog.style.getClientPositionForElement_(t):(t=t.changedTouches?t.changedTouches[0]:t,new goog.math.Coordinate(t.clientX,t.clientY))},goog.style.setPageOffset=function(t,e,o){var n=goog.style.getPageOffset(t);e instanceof goog.math.Coordinate&&(o=e.y,e=e.x),e=goog.asserts.assertNumber(e)-n.x,goog.style.setPosition(t,t.offsetLeft+e,t.offsetTop+(Number(o)-n.y))},goog.style.setSize=function(t,e,o){if(e instanceof goog.math.Size)o=e.height,e=e.width;else if(void 0==o)throw Error("missing height argument");goog.style.setWidth(t,e),goog.style.setHeight(t,o)},goog.style.getPixelStyleValue_=function(t,e){return"number"==typeof t&&(t=(e?Math.round(t):t)+"px"),t},goog.style.setHeight=function(t,e){t.style.height=goog.style.getPixelStyleValue_(e,!0)},goog.style.setWidth=function(t,e){t.style.width=goog.style.getPixelStyleValue_(e,!0)},goog.style.getSize=function(t){return goog.style.evaluateWithTemporaryDisplay_(goog.style.getSizeWithDisplay_,t)},goog.style.evaluateWithTemporaryDisplay_=function(t,e){if("none"!=goog.style.getStyle_(e,"display"))return t(e);var o=e.style,n=o.display,i=o.visibility,r=o.position;o.visibility="hidden",o.position="absolute",o.display="inline";var s=t(e);return o.display=n,o.position=r,o.visibility=i,s},goog.style.getSizeWithDisplay_=function(t){var e=t.offsetWidth,o=t.offsetHeight,n=goog.userAgent.WEBKIT&&!e&&!o;return goog.isDef(e)&&!n||!t.getBoundingClientRect?new goog.math.Size(e,o):(t=goog.style.getBoundingClientRect_(t),new goog.math.Size(t.right-t.left,t.bottom-t.top))},goog.style.getTransformedSize=function(t){return t.getBoundingClientRect?(t=goog.style.evaluateWithTemporaryDisplay_(goog.style.getBoundingClientRect_,t),new goog.math.Size(t.right-t.left,t.bottom-t.top)):null},goog.style.getBounds=function(t){var e=goog.style.getPageOffset(t);return t=goog.style.getSize(t),new goog.math.Rect(e.x,e.y,t.width,t.height)},goog.style.toCamelCase=function(t){return goog.string.toCamelCase(String(t))},goog.style.toSelectorCase=function(t){return goog.string.toSelectorCase(t)},goog.style.getOpacity=function(t){goog.asserts.assert(t);var e=t.style;return t="","opacity"in e?t=e.opacity:"MozOpacity"in e?t=e.MozOpacity:"filter"in e&&(e=e.filter.match(/alpha\(opacity=([\d.]+)\)/))&&(t=String(e[1]/100)),""==t?t:Number(t)},goog.style.setOpacity=function(t,e){goog.asserts.assert(t);var o=t.style;"opacity"in o?o.opacity=e:"MozOpacity"in o?o.MozOpacity=e:"filter"in o&&(o.filter=""===e?"":"alpha(opacity="+100*Number(e)+")")},goog.style.setTransparentBackgroundImage=function(t,e){var o=t.style;goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("8")?o.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+e+'", sizingMethod="crop")':(o.backgroundImage="url("+e+")",o.backgroundPosition="top left",o.backgroundRepeat="no-repeat")},goog.style.clearTransparentBackgroundImage=function(t){t=t.style,"filter"in t?t.filter="":t.backgroundImage="none"},goog.style.showElement=function(t,e){goog.style.setElementShown(t,e)},goog.style.setElementShown=function(t,e){t.style.display=e?"":"none"},goog.style.isElementShown=function(t){return"none"!=t.style.display},goog.style.installStyles=function(t,e){return goog.style.installSafeStyleSheet(goog.html.legacyconversions.safeStyleSheetFromString(t),e)},goog.style.installSafeStyleSheet=function(t,e){var o=goog.dom.getDomHelper(e),n=o.getDocument();if(goog.userAgent.IE&&n.createStyleSheet){var i=n.createStyleSheet();goog.style.setSafeStyleSheet(i,t)}else n=o.getElementsByTagNameAndClass("HEAD")[0],n||(i=o.getElementsByTagNameAndClass("BODY")[0],n=o.createDom("HEAD"),i.parentNode.insertBefore(n,i)),i=o.createDom("STYLE"),goog.style.setSafeStyleSheet(i,t),o.appendChild(n,i);return i},goog.style.uninstallStyles=function(t){goog.dom.removeNode(t.ownerNode||t.owningElement||t)},goog.style.setStyles=function(t,e){goog.style.setSafeStyleSheet(t,goog.html.legacyconversions.safeStyleSheetFromString(e))},goog.style.setSafeStyleSheet=function(t,e){var o=goog.html.SafeStyleSheet.unwrap(e);goog.userAgent.IE&&goog.isDef(t.cssText)?t.cssText=o:t.innerHTML=o},goog.style.setPreWrap=function(t){t=t.style,goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("8")?(t.whiteSpace="pre",t.wordWrap="break-word"):t.whiteSpace=goog.userAgent.GECKO?"-moz-pre-wrap":"pre-wrap"},goog.style.setInlineBlock=function(t){t=t.style,t.position="relative",goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("8")?(t.zoom="1",t.display="inline"):t.display="inline-block"},goog.style.isRightToLeft=function(t){return"rtl"==goog.style.getStyle_(t,"direction")},goog.style.unselectableStyle_=goog.userAgent.GECKO?"MozUserSelect":goog.userAgent.WEBKIT||goog.userAgent.EDGE?"WebkitUserSelect":null,goog.style.isUnselectable=function(t){return goog.style.unselectableStyle_?"none"==t.style[goog.style.unselectableStyle_].toLowerCase():!(!goog.userAgent.IE&&!goog.userAgent.OPERA)&&"on"==t.getAttribute("unselectable")},goog.style.setUnselectable=function(t,e,o){o=o?null:t.getElementsByTagName("*");var n=goog.style.unselectableStyle_;if(n){if(e=e?"none":"",t.style&&(t.style[n]=e),o){t=0;for(var i;i=o[t];t++)i.style&&(i.style[n]=e)}}else if((goog.userAgent.IE||goog.userAgent.OPERA)&&(e=e?"on":"",t.setAttribute("unselectable",e),o))for(t=0;i=o[t];t++)i.setAttribute("unselectable",e)},goog.style.getBorderBoxSize=function(t){return new goog.math.Size(t.offsetWidth,t.offsetHeight)},goog.style.setBorderBoxSize=function(t,e){var o=goog.dom.getOwnerDocument(t),n=goog.dom.getDomHelper(o).isCss1CompatMode();if(!goog.userAgent.IE||goog.userAgent.isVersionOrHigher("10")||n&&goog.userAgent.isVersionOrHigher("8"))goog.style.setBoxSizingSize_(t,e,"border-box");else if(o=t.style,n){n=goog.style.getPaddingBox(t);var i=goog.style.getBorderBox(t);o.pixelWidth=e.width-i.left-n.left-n.right-i.right,o.pixelHeight=e.height-i.top-n.top-n.bottom-i.bottom}else o.pixelWidth=e.width,o.pixelHeight=e.height},goog.style.getContentBoxSize=function(t){var e=goog.dom.getOwnerDocument(t),o=goog.userAgent.IE&&t.currentStyle;return o&&goog.dom.getDomHelper(e).isCss1CompatMode()&&"auto"!=o.width&&"auto"!=o.height&&!o.boxSizing?(e=goog.style.getIePixelValue_(t,o.width,"width","pixelWidth"),t=goog.style.getIePixelValue_(t,o.height,"height","pixelHeight"),new goog.math.Size(e,t)):(o=goog.style.getBorderBoxSize(t),e=goog.style.getPaddingBox(t),t=goog.style.getBorderBox(t),new goog.math.Size(o.width-t.left-e.left-e.right-t.right,o.height-t.top-e.top-e.bottom-t.bottom))},goog.style.setContentBoxSize=function(t,e){var o=goog.dom.getOwnerDocument(t),n=goog.dom.getDomHelper(o).isCss1CompatMode();if(!goog.userAgent.IE||goog.userAgent.isVersionOrHigher("10")||n&&goog.userAgent.isVersionOrHigher("8"))goog.style.setBoxSizingSize_(t,e,"content-box");else if(o=t.style,n)o.pixelWidth=e.width,o.pixelHeight=e.height;else{n=goog.style.getPaddingBox(t);var i=goog.style.getBorderBox(t);o.pixelWidth=e.width+i.left+n.left+n.right+i.right,o.pixelHeight=e.height+i.top+n.top+n.bottom+i.bottom}},goog.style.setBoxSizingSize_=function(t,e,o){t=t.style,goog.userAgent.GECKO?t.MozBoxSizing=o:goog.userAgent.WEBKIT?t.WebkitBoxSizing=o:t.boxSizing=o,t.width=Math.max(e.width,0)+"px",t.height=Math.max(e.height,0)+"px"},goog.style.getIePixelValue_=function(t,e,o,n){if(/^\d+px?$/.test(e))return parseInt(e,10);var i=t.style[o],r=t.runtimeStyle[o];return t.runtimeStyle[o]=t.currentStyle[o],t.style[o]=e,e=t.style[n],t.style[o]=i,t.runtimeStyle[o]=r,+e},goog.style.getIePixelDistance_=function(t,e){var o=goog.style.getCascadedStyle(t,e);return o?goog.style.getIePixelValue_(t,o,"left","pixelLeft"):0},goog.style.getBox_=function(t,e){if(goog.userAgent.IE){var o=goog.style.getIePixelDistance_(t,e+"Left"),n=goog.style.getIePixelDistance_(t,e+"Right"),i=goog.style.getIePixelDistance_(t,e+"Top"),r=goog.style.getIePixelDistance_(t,e+"Bottom");return new goog.math.Box(i,n,r,o)}return o=goog.style.getComputedStyle(t,e+"Left"),n=goog.style.getComputedStyle(t,e+"Right"),i=goog.style.getComputedStyle(t,e+"Top"),r=goog.style.getComputedStyle(t,e+"Bottom"),new goog.math.Box(parseFloat(i),parseFloat(n),parseFloat(r),parseFloat(o))},goog.style.getPaddingBox=function(t){return goog.style.getBox_(t,"padding")},goog.style.getMarginBox=function(t){return goog.style.getBox_(t,"margin")},goog.style.ieBorderWidthKeywords_={thin:2,medium:4,thick:6},goog.style.getIePixelBorder_=function(t,e){if("none"==goog.style.getCascadedStyle(t,e+"Style"))return 0;var o=goog.style.getCascadedStyle(t,e+"Width");return o in goog.style.ieBorderWidthKeywords_?goog.style.ieBorderWidthKeywords_[o]:goog.style.getIePixelValue_(t,o,"left","pixelLeft")},goog.style.getBorderBox=function(t){if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)){var e=goog.style.getIePixelBorder_(t,"borderLeft"),o=goog.style.getIePixelBorder_(t,"borderRight"),n=goog.style.getIePixelBorder_(t,"borderTop");return t=goog.style.getIePixelBorder_(t,"borderBottom"),new goog.math.Box(n,o,t,e)}return e=goog.style.getComputedStyle(t,"borderLeftWidth"),o=goog.style.getComputedStyle(t,"borderRightWidth"),n=goog.style.getComputedStyle(t,"borderTopWidth"),t=goog.style.getComputedStyle(t,"borderBottomWidth"),new goog.math.Box(parseFloat(n),parseFloat(o),parseFloat(t),parseFloat(e))},goog.style.getFontFamily=function(t){var e=goog.dom.getOwnerDocument(t),o="";if(e.body.createTextRange&&goog.dom.contains(e,t)){e=e.body.createTextRange(),e.moveToElementText(t);try{o=e.queryCommandValue("FontName")}catch(t){o=""}}return o||(o=goog.style.getStyle_(t,"fontFamily")),t=o.split(","),1<t.length&&(o=t[0]),goog.string.stripQuotes(o,"\"'")},goog.style.lengthUnitRegex_=/[^\d]+$/,goog.style.getLengthUnits=function(t){return(t=t.match(goog.style.lengthUnitRegex_))&&t[0]||null},goog.style.ABSOLUTE_CSS_LENGTH_UNITS_={cm:1,in:1,mm:1,pc:1,pt:1},goog.style.CONVERTIBLE_RELATIVE_CSS_UNITS_={em:1,ex:1},goog.style.getFontSize=function(t){var e=goog.style.getStyle_(t,"fontSize"),o=goog.style.getLengthUnits(e);if(e&&"px"==o)return parseInt(e,10);if(goog.userAgent.IE){if(String(o)in goog.style.ABSOLUTE_CSS_LENGTH_UNITS_)return goog.style.getIePixelValue_(t,e,"left","pixelLeft");if(t.parentNode&&t.parentNode.nodeType==goog.dom.NodeType.ELEMENT&&String(o)in goog.style.CONVERTIBLE_RELATIVE_CSS_UNITS_)return t=t.parentNode,o=goog.style.getStyle_(t,"fontSize"),goog.style.getIePixelValue_(t,e==o?"1em":e,"left","pixelLeft")}return o=goog.dom.createDom("SPAN",{style:"visibility:hidden;position:absolute;line-height:0;padding:0;margin:0;border:0;height:1em;"}),goog.dom.appendChild(t,o),e=o.offsetHeight,goog.dom.removeNode(o),e},goog.style.parseStyleAttribute=function(t){var e={};return goog.array.forEach(t.split(/\s*;\s*/),function(t){var o=t.match(/\s*([\w-]+)\s*\:(.+)/);o&&(t=o[1],o=goog.string.trim(o[2]),e[goog.string.toCamelCase(t.toLowerCase())]=o)}),e},goog.style.toStyleAttribute=function(t){var e=[];return goog.object.forEach(t,function(t,o){e.push(goog.string.toSelectorCase(o),":",t,";")}),e.join("")},goog.style.setFloat=function(t,e){t.style[goog.userAgent.IE?"styleFloat":"cssFloat"]=e},goog.style.getFloat=function(t){return t.style[goog.userAgent.IE?"styleFloat":"cssFloat"]||""},goog.style.getScrollbarWidth=function(t){var e=goog.dom.createElement("DIV");return t&&(e.className=t),e.style.cssText="overflow:auto;position:absolute;top:0;width:100px;height:100px",t=goog.dom.createElement("DIV"),goog.style.setSize(t,"200px","200px"),e.appendChild(t),goog.dom.appendChild(goog.dom.getDocument().body,e),t=e.offsetWidth-e.clientWidth,goog.dom.removeNode(e),t},goog.style.MATRIX_TRANSLATION_REGEX_=/matrix\([0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, ([0-9\.\-]+)p?x?, ([0-9\.\-]+)p?x?\)/,goog.style.getCssTranslation=function(t){return t=goog.style.getComputedTransform(t),t&&(t=t.match(goog.style.MATRIX_TRANSLATION_REGEX_))?new goog.math.Coordinate(parseFloat(t[1]),parseFloat(t[2])):new goog.math.Coordinate(0,0)},goog.events.EventHandler=function(t){goog.Disposable.call(this),this.handler_=t,this.keys_={}},goog.inherits(goog.events.EventHandler,goog.Disposable),goog.events.EventHandler.typeArray_=[],goog.events.EventHandler.prototype.listen=function(t,e,o,n){return this.listen_(t,e,o,n)},goog.events.EventHandler.prototype.listenWithScope=function(t,e,o,n,i){return this.listen_(t,e,o,n,i)},goog.events.EventHandler.prototype.listen_=function(t,e,o,n,i){goog.isArray(e)||(e&&(goog.events.EventHandler.typeArray_[0]=e.toString()),e=goog.events.EventHandler.typeArray_);for(var r=0;r<e.length;r++){var s=goog.events.listen(t,e[r],o||this.handleEvent,n||!1,i||this.handler_||this);if(!s)break;this.keys_[s.key]=s}return this},goog.events.EventHandler.prototype.listenOnce=function(t,e,o,n){return this.listenOnce_(t,e,o,n)},goog.events.EventHandler.prototype.listenOnceWithScope=function(t,e,o,n,i){return this.listenOnce_(t,e,o,n,i)},goog.events.EventHandler.prototype.listenOnce_=function(t,e,o,n,i){if(goog.isArray(e))for(var r=0;r<e.length;r++)this.listenOnce_(t,e[r],o,n,i);else{if(!(t=goog.events.listenOnce(t,e,o||this.handleEvent,n,i||this.handler_||this)))return this;this.keys_[t.key]=t}return this},goog.events.EventHandler.prototype.listenWithWrapper=function(t,e,o,n){return this.listenWithWrapper_(t,e,o,n)},goog.events.EventHandler.prototype.listenWithWrapperAndScope=function(t,e,o,n,i){return this.listenWithWrapper_(t,e,o,n,i)},goog.events.EventHandler.prototype.listenWithWrapper_=function(t,e,o,n,i){return e.listen(t,o,n,i||this.handler_||this,this),this},goog.events.EventHandler.prototype.getListenerCount=function(){var t,e=0;for(t in this.keys_)Object.prototype.hasOwnProperty.call(this.keys_,t)&&e++;return e},goog.events.EventHandler.prototype.unlisten=function(t,e,o,n,i){if(goog.isArray(e))for(var r=0;r<e.length;r++)this.unlisten(t,e[r],o,n,i);else n=goog.isObject(n)?!!n.capture:!!n,(t=goog.events.getListener(t,e,o||this.handleEvent,n,i||this.handler_||this))&&(goog.events.unlistenByKey(t),delete this.keys_[t.key]);return this},goog.events.EventHandler.prototype.unlistenWithWrapper=function(t,e,o,n,i){return e.unlisten(t,o,n,i||this.handler_||this,this),this},goog.events.EventHandler.prototype.removeAll=function(){goog.object.forEach(this.keys_,function(t,e){this.keys_.hasOwnProperty(e)&&goog.events.unlistenByKey(t)},this),this.keys_={}},goog.events.EventHandler.prototype.disposeInternal=function(){goog.events.EventHandler.superClass_.disposeInternal.call(this),this.removeAll()},goog.events.EventHandler.prototype.handleEvent=function(t){throw Error("EventHandler.handleEvent not implemented")},goog.ui={},goog.ui.IdGenerator=function(){},goog.addSingletonGetter(goog.ui.IdGenerator),goog.ui.IdGenerator.prototype.nextId_=0,goog.ui.IdGenerator.prototype.getNextUniqueId=function(){return":"+(this.nextId_++).toString(36)},goog.ui.Component=function(t){goog.events.EventTarget.call(this),this.dom_=t||goog.dom.getDomHelper(),this.rightToLeft_=goog.ui.Component.defaultRightToLeft_,this.id_=null,this.inDocument_=!1,this.element_=null,this.googUiComponentHandler_=void 0,this.childIndex_=this.children_=this.parent_=this.model_=null,this.wasDecorated_=!1},goog.inherits(goog.ui.Component,goog.events.EventTarget),goog.ui.Component.ALLOW_DETACHED_DECORATION=!1,goog.ui.Component.prototype.idGenerator_=goog.ui.IdGenerator.getInstance(),goog.ui.Component.DEFAULT_BIDI_DIR=0,goog.ui.Component.defaultRightToLeft_=1!=goog.ui.Component.DEFAULT_BIDI_DIR&&(-1==goog.ui.Component.DEFAULT_BIDI_DIR||null),goog.ui.Component.EventType={BEFORE_SHOW:"beforeshow",SHOW:"show",HIDE:"hide",DISABLE:"disable",ENABLE:"enable",HIGHLIGHT:"highlight",UNHIGHLIGHT:"unhighlight",ACTIVATE:"activate",DEACTIVATE:"deactivate",SELECT:"select",UNSELECT:"unselect",CHECK:"check",UNCHECK:"uncheck",FOCUS:"focus",BLUR:"blur",OPEN:"open",CLOSE:"close",ENTER:"enter",LEAVE:"leave",ACTION:"action",CHANGE:"change"},goog.ui.Component.Error={NOT_SUPPORTED:"Method not supported",DECORATE_INVALID:"Invalid element to decorate",ALREADY_RENDERED:"Component already rendered",PARENT_UNABLE_TO_BE_SET:"Unable to set parent component",CHILD_INDEX_OUT_OF_BOUNDS:"Child component index out of bounds",NOT_OUR_CHILD:"Child is not in parent component",NOT_IN_DOCUMENT:"Operation not supported while component is not in document",STATE_INVALID:"Invalid component state"},goog.ui.Component.State={ALL:255,DISABLED:1,HOVER:2,ACTIVE:4,SELECTED:8,CHECKED:16,FOCUSED:32,OPENED:64},goog.ui.Component.getStateTransitionEvent=function(t,e){switch(t){case goog.ui.Component.State.DISABLED:return e?goog.ui.Component.EventType.DISABLE:goog.ui.Component.EventType.ENABLE;case goog.ui.Component.State.HOVER:return e?goog.ui.Component.EventType.HIGHLIGHT:goog.ui.Component.EventType.UNHIGHLIGHT;case goog.ui.Component.State.ACTIVE:return e?goog.ui.Component.EventType.ACTIVATE:goog.ui.Component.EventType.DEACTIVATE;case goog.ui.Component.State.SELECTED:return e?goog.ui.Component.EventType.SELECT:goog.ui.Component.EventType.UNSELECT;case goog.ui.Component.State.CHECKED:return e?goog.ui.Component.EventType.CHECK:goog.ui.Component.EventType.UNCHECK;case goog.ui.Component.State.FOCUSED:return e?goog.ui.Component.EventType.FOCUS:goog.ui.Component.EventType.BLUR;case goog.ui.Component.State.OPENED:return e?goog.ui.Component.EventType.OPEN:goog.ui.Component.EventType.CLOSE}throw Error(goog.ui.Component.Error.STATE_INVALID)},goog.ui.Component.setDefaultRightToLeft=function(t){goog.ui.Component.defaultRightToLeft_=t},goog.ui.Component.prototype.getId=function(){return this.id_||(this.id_=this.idGenerator_.getNextUniqueId())},goog.ui.Component.prototype.setId=function(t){this.parent_&&this.parent_.childIndex_&&(goog.object.remove(this.parent_.childIndex_,this.id_),goog.object.add(this.parent_.childIndex_,t,this)),this.id_=t},goog.ui.Component.prototype.getElement=function(){return this.element_},goog.ui.Component.prototype.getElementStrict=function(){var t=this.element_;return goog.asserts.assert(t,"Can not call getElementStrict before rendering/decorating."),t},goog.ui.Component.prototype.setElementInternal=function(t){this.element_=t},goog.ui.Component.prototype.getElementsByClass=function(t){return this.element_?this.dom_.getElementsByClass(t,this.element_):[]},goog.ui.Component.prototype.getElementByClass=function(t){return this.element_?this.dom_.getElementByClass(t,this.element_):null},goog.ui.Component.prototype.getRequiredElementByClass=function(t){var e=this.getElementByClass(t);return goog.asserts.assert(e,"Expected element in component with class: %s",t),e},goog.ui.Component.prototype.getHandler=function(){return this.googUiComponentHandler_||(this.googUiComponentHandler_=new goog.events.EventHandler(this)),this.googUiComponentHandler_},goog.ui.Component.prototype.setParent=function(t){if(this==t)throw Error(goog.ui.Component.Error.PARENT_UNABLE_TO_BE_SET);if(t&&this.parent_&&this.id_&&this.parent_.getChild(this.id_)&&this.parent_!=t)throw Error(goog.ui.Component.Error.PARENT_UNABLE_TO_BE_SET);this.parent_=t,goog.ui.Component.superClass_.setParentEventTarget.call(this,t)},goog.ui.Component.prototype.getParent=function(){return this.parent_},goog.ui.Component.prototype.setParentEventTarget=function(t){if(this.parent_&&this.parent_!=t)throw Error(goog.ui.Component.Error.NOT_SUPPORTED);goog.ui.Component.superClass_.setParentEventTarget.call(this,t)},goog.ui.Component.prototype.getDomHelper=function(){return this.dom_},goog.ui.Component.prototype.isInDocument=function(){return this.inDocument_},goog.ui.Component.prototype.createDom=function(){this.element_=this.dom_.createElement("DIV")},goog.ui.Component.prototype.render=function(t){this.render_(t)},goog.ui.Component.prototype.renderBefore=function(t){this.render_(t.parentNode,t)},goog.ui.Component.prototype.render_=function(t,e){if(this.inDocument_)throw Error(goog.ui.Component.Error.ALREADY_RENDERED);this.element_||this.createDom(),t?t.insertBefore(this.element_,e||null):this.dom_.getDocument().body.appendChild(this.element_),this.parent_&&!this.parent_.isInDocument()||this.enterDocument()},goog.ui.Component.prototype.decorate=function(t){if(this.inDocument_)throw Error(goog.ui.Component.Error.ALREADY_RENDERED);if(!t||!this.canDecorate(t))throw Error(goog.ui.Component.Error.DECORATE_INVALID);this.wasDecorated_=!0;var e=goog.dom.getOwnerDocument(t);this.dom_&&this.dom_.getDocument()==e||(this.dom_=goog.dom.getDomHelper(t)),this.decorateInternal(t),goog.ui.Component.ALLOW_DETACHED_DECORATION&&!goog.dom.contains(e,t)||this.enterDocument()},goog.ui.Component.prototype.canDecorate=function(t){return!0},goog.ui.Component.prototype.wasDecorated=function(){return this.wasDecorated_},goog.ui.Component.prototype.decorateInternal=function(t){this.element_=t},goog.ui.Component.prototype.enterDocument=function(){this.inDocument_=!0,this.forEachChild(function(t){!t.isInDocument()&&t.getElement()&&t.enterDocument()})},goog.ui.Component.prototype.exitDocument=function(){this.forEachChild(function(t){t.isInDocument()&&t.exitDocument()}),this.googUiComponentHandler_&&this.googUiComponentHandler_.removeAll(),this.inDocument_=!1},goog.ui.Component.prototype.disposeInternal=function(){this.inDocument_&&this.exitDocument(),this.googUiComponentHandler_&&(this.googUiComponentHandler_.dispose(),delete this.googUiComponentHandler_),this.forEachChild(function(t){t.dispose()}),!this.wasDecorated_&&this.element_&&goog.dom.removeNode(this.element_),this.parent_=this.model_=this.element_=this.childIndex_=this.children_=null,goog.ui.Component.superClass_.disposeInternal.call(this)},goog.ui.Component.prototype.makeId=function(t){return this.getId()+"."+t},goog.ui.Component.prototype.makeIds=function(t){var e,o={};for(e in t)o[e]=this.makeId(t[e]);return o},goog.ui.Component.prototype.getModel=function(){return this.model_},goog.ui.Component.prototype.setModel=function(t){this.model_=t},goog.ui.Component.prototype.getFragmentFromId=function(t){return t.substring(this.getId().length+1)},goog.ui.Component.prototype.getElementByFragment=function(t){if(!this.inDocument_)throw Error(goog.ui.Component.Error.NOT_IN_DOCUMENT);return this.dom_.getElement(this.makeId(t))},goog.ui.Component.prototype.addChild=function(t,e){this.addChildAt(t,this.getChildCount(),e)},goog.ui.Component.prototype.addChildAt=function(t,e,o){if(goog.asserts.assert(!!t,"Provided element must not be null."),t.inDocument_&&(o||!this.inDocument_))throw Error(goog.ui.Component.Error.ALREADY_RENDERED);if(0>e||e>this.getChildCount())throw Error(goog.ui.Component.Error.CHILD_INDEX_OUT_OF_BOUNDS);this.childIndex_&&this.children_||(this.childIndex_={},this.children_=[]),t.getParent()==this?(goog.object.set(this.childIndex_,t.getId(),t),goog.array.remove(this.children_,t)):goog.object.add(this.childIndex_,t.getId(),t),t.setParent(this),goog.array.insertAt(this.children_,t,e),t.inDocument_&&this.inDocument_&&t.getParent()==this?(o=this.getContentElement(),(e=o.childNodes[e]||null)!=t.getElement()&&o.insertBefore(t.getElement(),e)):o?(this.element_||this.createDom(),e=this.getChildAt(e+1),t.render_(this.getContentElement(),e?e.element_:null)):this.inDocument_&&!t.inDocument_&&t.element_&&t.element_.parentNode&&t.element_.parentNode.nodeType==goog.dom.NodeType.ELEMENT&&t.enterDocument()},goog.ui.Component.prototype.getContentElement=function(){return this.element_},goog.ui.Component.prototype.isRightToLeft=function(){return null==this.rightToLeft_&&(this.rightToLeft_=goog.style.isRightToLeft(this.inDocument_?this.element_:this.dom_.getDocument().body)),this.rightToLeft_},goog.ui.Component.prototype.setRightToLeft=function(t){if(this.inDocument_)throw Error(goog.ui.Component.Error.ALREADY_RENDERED);this.rightToLeft_=t},goog.ui.Component.prototype.hasChildren=function(){return!!this.children_&&0!=this.children_.length},goog.ui.Component.prototype.getChildCount=function(){return this.children_?this.children_.length:0},goog.ui.Component.prototype.getChildIds=function(){var t=[];return this.forEachChild(function(e){t.push(e.getId())}),t},goog.ui.Component.prototype.getChild=function(t){return this.childIndex_&&t?goog.object.get(this.childIndex_,t)||null:null},goog.ui.Component.prototype.getChildAt=function(t){return this.children_?this.children_[t]||null:null},goog.ui.Component.prototype.forEachChild=function(t,e){this.children_&&goog.array.forEach(this.children_,t,e)},goog.ui.Component.prototype.indexOfChild=function(t){return this.children_&&t?goog.array.indexOf(this.children_,t):-1},goog.ui.Component.prototype.removeChild=function(t,e){if(t){var o=goog.isString(t)?t:t.getId();t=this.getChild(o),o&&t&&(goog.object.remove(this.childIndex_,o),goog.array.remove(this.children_,t),e&&(t.exitDocument(),t.element_&&goog.dom.removeNode(t.element_)),t.setParent(null))}if(!t)throw Error(goog.ui.Component.Error.NOT_OUR_CHILD);return t},goog.ui.Component.prototype.removeChildAt=function(t,e){return this.removeChild(this.getChildAt(t),e)},goog.ui.Component.prototype.removeChildren=function(t){for(var e=[];this.hasChildren();)e.push(this.removeChildAt(0,t));return e},goog.a11y={},goog.a11y.aria={},goog.a11y.aria.Role={ALERT:"alert",ALERTDIALOG:"alertdialog",APPLICATION:"application",ARTICLE:"article",BANNER:"banner",BUTTON:"button",CHECKBOX:"checkbox",COLUMNHEADER:"columnheader",COMBOBOX:"combobox",COMPLEMENTARY:"complementary",CONTENTINFO:"contentinfo",DEFINITION:"definition",DIALOG:"dialog",DIRECTORY:"directory",DOCUMENT:"document",FORM:"form",GRID:"grid",GRIDCELL:"gridcell",GROUP:"group",HEADING:"heading",IMG:"img",LINK:"link",LIST:"list",LISTBOX:"listbox",LISTITEM:"listitem",LOG:"log",MAIN:"main",MARQUEE:"marquee",MATH:"math",MENU:"menu",MENUBAR:"menubar",MENU_ITEM:"menuitem",MENU_ITEM_CHECKBOX:"menuitemcheckbox",MENU_ITEM_RADIO:"menuitemradio",NAVIGATION:"navigation",NOTE:"note",OPTION:"option",PRESENTATION:"presentation",PROGRESSBAR:"progressbar",RADIO:"radio",RADIOGROUP:"radiogroup",REGION:"region",ROW:"row",ROWGROUP:"rowgroup",ROWHEADER:"rowheader",SCROLLBAR:"scrollbar",SEARCH:"search",SEPARATOR:"separator",SLIDER:"slider",SPINBUTTON:"spinbutton",STATUS:"status",TAB:"tab",TAB_LIST:"tablist",TAB_PANEL:"tabpanel",TEXTBOX:"textbox",TEXTINFO:"textinfo",TIMER:"timer",TOOLBAR:"toolbar",TOOLTIP:"tooltip",TREE:"tree",TREEGRID:"treegrid",TREEITEM:"treeitem"},goog.a11y.aria.State={ACTIVEDESCENDANT:"activedescendant",ATOMIC:"atomic",AUTOCOMPLETE:"autocomplete",BUSY:"busy",CHECKED:"checked",COLINDEX:"colindex",CONTROLS:"controls",DESCRIBEDBY:"describedby",DISABLED:"disabled",DROPEFFECT:"dropeffect",EXPANDED:"expanded",FLOWTO:"flowto",GRABBED:"grabbed",HASPOPUP:"haspopup",HIDDEN:"hidden",INVALID:"invalid",LABEL:"label",LABELLEDBY:"labelledby",LEVEL:"level",LIVE:"live",MULTILINE:"multiline",MULTISELECTABLE:"multiselectable",ORIENTATION:"orientation",OWNS:"owns",POSINSET:"posinset",PRESSED:"pressed",READONLY:"readonly",RELEVANT:"relevant",REQUIRED:"required",ROWINDEX:"rowindex",SELECTED:"selected",SETSIZE:"setsize",SORT:"sort",VALUEMAX:"valuemax",VALUEMIN:"valuemin",VALUENOW:"valuenow",VALUETEXT:"valuetext"},goog.a11y.aria.AutoCompleteValues={INLINE:"inline",LIST:"list",BOTH:"both",NONE:"none"},goog.a11y.aria.DropEffectValues={COPY:"copy",MOVE:"move",LINK:"link",EXECUTE:"execute",POPUP:"popup",NONE:"none"},goog.a11y.aria.LivePriority={OFF:"off",POLITE:"polite",ASSERTIVE:"assertive"},goog.a11y.aria.OrientationValues={VERTICAL:"vertical",HORIZONTAL:"horizontal"},goog.a11y.aria.RelevantValues={ADDITIONS:"additions",REMOVALS:"removals",TEXT:"text",ALL:"all"},goog.a11y.aria.SortValues={ASCENDING:"ascending",DESCENDING:"descending",NONE:"none",OTHER:"other"},goog.a11y.aria.CheckedValues={TRUE:"true",FALSE:"false",MIXED:"mixed",UNDEFINED:"undefined"},goog.a11y.aria.ExpandedValues={TRUE:"true",FALSE:"false",UNDEFINED:"undefined"},goog.a11y.aria.GrabbedValues={TRUE:"true",FALSE:"false",UNDEFINED:"undefined"},goog.a11y.aria.InvalidValues={FALSE:"false",TRUE:"true",GRAMMAR:"grammar",SPELLING:"spelling"},goog.a11y.aria.PressedValues={TRUE:"true",FALSE:"false",MIXED:"mixed",UNDEFINED:"undefined"},goog.a11y.aria.SelectedValues={TRUE:"true",FALSE:"false",UNDEFINED:"undefined"};goog.a11y.aria.datatables={},goog.a11y.aria.datatables.getDefaultValuesMap=function(){return goog.a11y.aria.DefaultStateValueMap_||(goog.a11y.aria.DefaultStateValueMap_=goog.object.create(goog.a11y.aria.State.ATOMIC,!1,goog.a11y.aria.State.AUTOCOMPLETE,"none",goog.a11y.aria.State.DROPEFFECT,"none",goog.a11y.aria.State.HASPOPUP,!1,goog.a11y.aria.State.LIVE,"off",goog.a11y.aria.State.MULTILINE,!1,goog.a11y.aria.State.MULTISELECTABLE,!1,goog.a11y.aria.State.ORIENTATION,"vertical",goog.a11y.aria.State.READONLY,!1,goog.a11y.aria.State.RELEVANT,"additions text",goog.a11y.aria.State.REQUIRED,!1,goog.a11y.aria.State.SORT,"none",goog.a11y.aria.State.BUSY,!1,goog.a11y.aria.State.DISABLED,!1,goog.a11y.aria.State.HIDDEN,!1,goog.a11y.aria.State.INVALID,"false")),goog.a11y.aria.DefaultStateValueMap_},goog.a11y.aria.ARIA_PREFIX_="aria-",goog.a11y.aria.ROLE_ATTRIBUTE_="role",goog.a11y.aria.TAGS_WITH_ASSUMED_ROLES_=goog.object.createSet("A AREA BUTTON HEAD INPUT LINK MENU META OPTGROUP OPTION PROGRESS STYLE SELECT SOURCE TEXTAREA TITLE TRACK".split(" ")),goog.a11y.aria.CONTAINER_ROLES_=[goog.a11y.aria.Role.COMBOBOX,goog.a11y.aria.Role.GRID,goog.a11y.aria.Role.GROUP,goog.a11y.aria.Role.LISTBOX,goog.a11y.aria.Role.MENU,goog.a11y.aria.Role.MENUBAR,goog.a11y.aria.Role.RADIOGROUP,goog.a11y.aria.Role.ROW,goog.a11y.aria.Role.ROWGROUP,goog.a11y.aria.Role.TAB_LIST,goog.a11y.aria.Role.TEXTBOX,goog.a11y.aria.Role.TOOLBAR,goog.a11y.aria.Role.TREE,goog.a11y.aria.Role.TREEGRID],goog.a11y.aria.setRole=function(t,e){e?(goog.asserts.ENABLE_ASSERTS&&goog.asserts.assert(goog.object.containsValue(goog.a11y.aria.Role,e),"No such ARIA role "+e),t.setAttribute(goog.a11y.aria.ROLE_ATTRIBUTE_,e)):goog.a11y.aria.removeRole(t)},goog.a11y.aria.getRole=function(t){return t.getAttribute(goog.a11y.aria.ROLE_ATTRIBUTE_)||null},goog.a11y.aria.removeRole=function(t){t.removeAttribute(goog.a11y.aria.ROLE_ATTRIBUTE_)},goog.a11y.aria.setState=function(t,e,o){goog.isArray(o)&&(o=o.join(" "));var n=goog.a11y.aria.getAriaAttributeName_(e);""===o||void 0==o?(o=goog.a11y.aria.datatables.getDefaultValuesMap(),e in o?t.setAttribute(n,o[e]):t.removeAttribute(n)):t.setAttribute(n,o)},goog.a11y.aria.toggleState=function(t,e){var o=goog.a11y.aria.getState(t,e);goog.string.isEmptyOrWhitespace(goog.string.makeSafe(o))||"true"==o||"false"==o?goog.a11y.aria.setState(t,e,"true"==o?"false":"true"):goog.a11y.aria.removeState(t,e)},goog.a11y.aria.removeState=function(t,e){t.removeAttribute(goog.a11y.aria.getAriaAttributeName_(e))},goog.a11y.aria.getState=function(t,e){var o=t.getAttribute(goog.a11y.aria.getAriaAttributeName_(e));return null==o||void 0==o?"":String(o)},goog.a11y.aria.getActiveDescendant=function(t){var e=goog.a11y.aria.getState(t,goog.a11y.aria.State.ACTIVEDESCENDANT);return goog.dom.getOwnerDocument(t).getElementById(e)},goog.a11y.aria.setActiveDescendant=function(t,e){var o="";e&&(o=e.id,goog.asserts.assert(o,"The active element should have an id.")),goog.a11y.aria.setState(t,goog.a11y.aria.State.ACTIVEDESCENDANT,o)},goog.a11y.aria.getLabel=function(t){return goog.a11y.aria.getState(t,goog.a11y.aria.State.LABEL)},goog.a11y.aria.setLabel=function(t,e){goog.a11y.aria.setState(t,goog.a11y.aria.State.LABEL,e)},goog.a11y.aria.assertRoleIsSetInternalUtil=function(t,e){if(!goog.a11y.aria.TAGS_WITH_ASSUMED_ROLES_[t.tagName]){var o=goog.a11y.aria.getRole(t);goog.asserts.assert(null!=o,"The element ARIA role cannot be null."),goog.asserts.assert(goog.array.contains(e,o),'Non existing or incorrect role set for element.The role set is "'+o+'". The role should be any of "'+e+'". Check the ARIA specification for more details http://www.w3.org/TR/wai-aria/roles.')}},goog.a11y.aria.getStateBoolean=function(t,e){var o=t.getAttribute(goog.a11y.aria.getAriaAttributeName_(e));return goog.asserts.assert(goog.isBoolean(o)||null==o||"true"==o||"false"==o),null==o?o:goog.isBoolean(o)?o:"true"==o},goog.a11y.aria.getStateNumber=function(t,e){var o=t.getAttribute(goog.a11y.aria.getAriaAttributeName_(e));return goog.asserts.assert(!(null!=o&&isNaN(Number(o))||goog.isBoolean(o))),null==o?null:Number(o)},goog.a11y.aria.getStateString=function(t,e){var o=t.getAttribute(goog.a11y.aria.getAriaAttributeName_(e));return goog.asserts.assert((null==o||goog.isString(o))&&(""==o||isNaN(Number(o)))&&"true"!=o&&"false"!=o),null==o||""==o?null:o},goog.a11y.aria.getStringArrayStateInternalUtil=function(t,e){var o=t.getAttribute(goog.a11y.aria.getAriaAttributeName_(e));return goog.a11y.aria.splitStringOnWhitespace_(o)},goog.a11y.aria.hasState=function(t,e){return t.hasAttribute(goog.a11y.aria.getAriaAttributeName_(e))},goog.a11y.aria.isContainerRole=function(t){return t=goog.a11y.aria.getRole(t),goog.array.contains(goog.a11y.aria.CONTAINER_ROLES_,t)},goog.a11y.aria.splitStringOnWhitespace_=function(t){return t?t.split(/\s+/):[]},goog.a11y.aria.getAriaAttributeName_=function(t){return goog.asserts.ENABLE_ASSERTS&&(goog.asserts.assert(t,"ARIA attribute cannot be empty."),goog.asserts.assert(goog.object.containsValue(goog.a11y.aria.State,t),"No such ARIA attribute "+t)),goog.a11y.aria.ARIA_PREFIX_+t},goog.events.KeyCodes={WIN_KEY_FF_LINUX:0,MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS_SIGN:43,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,FF_DASH:173,QUESTION_MARK:63,AT_SIGN:64,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLL_LOCK:145,FIRST_MEDIA_KEY:166,LAST_MEDIA_KEY:183,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,TILDE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,MAC_WK_CMD_LEFT:91,MAC_WK_CMD_RIGHT:93,WIN_IME:229,VK_NONAME:252,PHANTOM:255},goog.events.KeyCodes.isTextModifyingKeyEvent=function(t){if(t.altKey&&!t.ctrlKey||t.metaKey||t.keyCode>=goog.events.KeyCodes.F1&&t.keyCode<=goog.events.KeyCodes.F12)return!1;switch(t.keyCode){case goog.events.KeyCodes.ALT:case goog.events.KeyCodes.CAPS_LOCK:case goog.events.KeyCodes.CONTEXT_MENU:case goog.events.KeyCodes.CTRL:case goog.events.KeyCodes.DOWN:case goog.events.KeyCodes.END:case goog.events.KeyCodes.ESC:case goog.events.KeyCodes.HOME:case goog.events.KeyCodes.INSERT:case goog.events.KeyCodes.LEFT:case goog.events.KeyCodes.MAC_FF_META:case goog.events.KeyCodes.META:case goog.events.KeyCodes.NUMLOCK:case goog.events.KeyCodes.NUM_CENTER:case goog.events.KeyCodes.PAGE_DOWN:case goog.events.KeyCodes.PAGE_UP:case goog.events.KeyCodes.PAUSE:case goog.events.KeyCodes.PHANTOM:case goog.events.KeyCodes.PRINT_SCREEN:case goog.events.KeyCodes.RIGHT:case goog.events.KeyCodes.SCROLL_LOCK:case goog.events.KeyCodes.SHIFT:case goog.events.KeyCodes.UP:case goog.events.KeyCodes.VK_NONAME:case goog.events.KeyCodes.WIN_KEY:case goog.events.KeyCodes.WIN_KEY_RIGHT:return!1;case goog.events.KeyCodes.WIN_KEY_FF_LINUX:return!goog.userAgent.GECKO;default:return t.keyCode<goog.events.KeyCodes.FIRST_MEDIA_KEY||t.keyCode>goog.events.KeyCodes.LAST_MEDIA_KEY}},goog.events.KeyCodes.firesKeyPressEvent=function(t,e,o,n,i,r){if(!(goog.userAgent.IE||goog.userAgent.EDGE||goog.userAgent.WEBKIT&&goog.userAgent.isVersionOrHigher("525")))return!0;if(goog.userAgent.MAC&&i)return goog.events.KeyCodes.isCharacterKey(t);if(i&&!n)return!1;if(goog.isNumber(e)&&(e=goog.events.KeyCodes.normalizeKeyCode(e)),i=e==goog.events.KeyCodes.CTRL||e==goog.events.KeyCodes.ALT||goog.userAgent.MAC&&e==goog.events.KeyCodes.META,r=e==goog.events.KeyCodes.SHIFT&&(n||r),(!o||goog.userAgent.MAC)&&i||goog.userAgent.MAC&&r)return!1;if((goog.userAgent.WEBKIT||goog.userAgent.EDGE)&&n&&o)switch(t){case goog.events.KeyCodes.BACKSLASH:case goog.events.KeyCodes.OPEN_SQUARE_BRACKET:case goog.events.KeyCodes.CLOSE_SQUARE_BRACKET:case goog.events.KeyCodes.TILDE:case goog.events.KeyCodes.SEMICOLON:case goog.events.KeyCodes.DASH:case goog.events.KeyCodes.EQUALS:case goog.events.KeyCodes.COMMA:case goog.events.KeyCodes.PERIOD:case goog.events.KeyCodes.SLASH:case goog.events.KeyCodes.APOSTROPHE:case goog.events.KeyCodes.SINGLE_QUOTE:return!1}if(goog.userAgent.IE&&n&&e==t)return!1;switch(t){case goog.events.KeyCodes.ENTER:return!0;case goog.events.KeyCodes.ESC:return!(goog.userAgent.WEBKIT||goog.userAgent.EDGE)}return goog.events.KeyCodes.isCharacterKey(t)},goog.events.KeyCodes.isCharacterKey=function(t){if(t>=goog.events.KeyCodes.ZERO&&t<=goog.events.KeyCodes.NINE||t>=goog.events.KeyCodes.NUM_ZERO&&t<=goog.events.KeyCodes.NUM_MULTIPLY||t>=goog.events.KeyCodes.A&&t<=goog.events.KeyCodes.Z||(goog.userAgent.WEBKIT||goog.userAgent.EDGE)&&0==t)return!0;switch(t){case goog.events.KeyCodes.SPACE:case goog.events.KeyCodes.PLUS_SIGN:case goog.events.KeyCodes.QUESTION_MARK:case goog.events.KeyCodes.AT_SIGN:case goog.events.KeyCodes.NUM_PLUS:case goog.events.KeyCodes.NUM_MINUS:case goog.events.KeyCodes.NUM_PERIOD:case goog.events.KeyCodes.NUM_DIVISION:case goog.events.KeyCodes.SEMICOLON:case goog.events.KeyCodes.FF_SEMICOLON:case goog.events.KeyCodes.DASH:case goog.events.KeyCodes.EQUALS:case goog.events.KeyCodes.FF_EQUALS:case goog.events.KeyCodes.COMMA:case goog.events.KeyCodes.PERIOD:case goog.events.KeyCodes.SLASH:case goog.events.KeyCodes.APOSTROPHE:case goog.events.KeyCodes.SINGLE_QUOTE:case goog.events.KeyCodes.OPEN_SQUARE_BRACKET:case goog.events.KeyCodes.BACKSLASH:case goog.events.KeyCodes.CLOSE_SQUARE_BRACKET:return!0;default:return!1}},goog.events.KeyCodes.normalizeKeyCode=function(t){return goog.userAgent.GECKO?goog.events.KeyCodes.normalizeGeckoKeyCode(t):goog.userAgent.MAC&&goog.userAgent.WEBKIT?goog.events.KeyCodes.normalizeMacWebKitKeyCode(t):t},goog.events.KeyCodes.normalizeGeckoKeyCode=function(t){switch(t){case goog.events.KeyCodes.FF_EQUALS:return goog.events.KeyCodes.EQUALS;case goog.events.KeyCodes.FF_SEMICOLON:return goog.events.KeyCodes.SEMICOLON;case goog.events.KeyCodes.FF_DASH:return goog.events.KeyCodes.DASH;case goog.events.KeyCodes.MAC_FF_META:return goog.events.KeyCodes.META;case goog.events.KeyCodes.WIN_KEY_FF_LINUX:return goog.events.KeyCodes.WIN_KEY;default:return t}},goog.events.KeyCodes.normalizeMacWebKitKeyCode=function(t){switch(t){case goog.events.KeyCodes.MAC_WK_CMD_RIGHT:return goog.events.KeyCodes.META;default:return t}},goog.events.KeyHandler=function(t,e){goog.events.EventTarget.call(this),t&&this.attach(t,e)},goog.inherits(goog.events.KeyHandler,goog.events.EventTarget),goog.events.KeyHandler.prototype.element_=null,goog.events.KeyHandler.prototype.keyPressKey_=null,goog.events.KeyHandler.prototype.keyDownKey_=null,goog.events.KeyHandler.prototype.keyUpKey_=null,goog.events.KeyHandler.prototype.lastKey_=-1,goog.events.KeyHandler.prototype.keyCode_=-1,goog.events.KeyHandler.prototype.altKey_=!1,goog.events.KeyHandler.EventType={KEY:"key"},goog.events.KeyHandler.safariKey_={3:goog.events.KeyCodes.ENTER,12:goog.events.KeyCodes.NUMLOCK,63232:goog.events.KeyCodes.UP,63233:goog.events.KeyCodes.DOWN,63234:goog.events.KeyCodes.LEFT,63235:goog.events.KeyCodes.RIGHT,63236:goog.events.KeyCodes.F1,63237:goog.events.KeyCodes.F2,63238:goog.events.KeyCodes.F3,63239:goog.events.KeyCodes.F4,63240:goog.events.KeyCodes.F5,63241:goog.events.KeyCodes.F6,63242:goog.events.KeyCodes.F7,63243:goog.events.KeyCodes.F8,63244:goog.events.KeyCodes.F9,63245:goog.events.KeyCodes.F10,63246:goog.events.KeyCodes.F11,63247:goog.events.KeyCodes.F12,63248:goog.events.KeyCodes.PRINT_SCREEN,63272:goog.events.KeyCodes.DELETE,63273:goog.events.KeyCodes.HOME,63275:goog.events.KeyCodes.END,63276:goog.events.KeyCodes.PAGE_UP,63277:goog.events.KeyCodes.PAGE_DOWN,63289:goog.events.KeyCodes.NUMLOCK,63302:goog.events.KeyCodes.INSERT},goog.events.KeyHandler.keyIdentifier_={Up:goog.events.KeyCodes.UP,Down:goog.events.KeyCodes.DOWN,Left:goog.events.KeyCodes.LEFT,Right:goog.events.KeyCodes.RIGHT,Enter:goog.events.KeyCodes.ENTER,F1:goog.events.KeyCodes.F1,F2:goog.events.KeyCodes.F2,F3:goog.events.KeyCodes.F3,F4:goog.events.KeyCodes.F4,F5:goog.events.KeyCodes.F5,F6:goog.events.KeyCodes.F6,F7:goog.events.KeyCodes.F7,F8:goog.events.KeyCodes.F8,F9:goog.events.KeyCodes.F9,F10:goog.events.KeyCodes.F10,F11:goog.events.KeyCodes.F11,F12:goog.events.KeyCodes.F12,"U+007F":goog.events.KeyCodes.DELETE,Home:goog.events.KeyCodes.HOME,End:goog.events.KeyCodes.END,PageUp:goog.events.KeyCodes.PAGE_UP,PageDown:goog.events.KeyCodes.PAGE_DOWN,Insert:goog.events.KeyCodes.INSERT},goog.events.KeyHandler.USES_KEYDOWN_=goog.userAgent.IE||goog.userAgent.EDGE||goog.userAgent.WEBKIT&&goog.userAgent.isVersionOrHigher("525"),goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_=goog.userAgent.MAC&&goog.userAgent.GECKO,goog.events.KeyHandler.prototype.handleKeyDown_=function(t){(goog.userAgent.WEBKIT||goog.userAgent.EDGE)&&(this.lastKey_==goog.events.KeyCodes.CTRL&&!t.ctrlKey||this.lastKey_==goog.events.KeyCodes.ALT&&!t.altKey||goog.userAgent.MAC&&this.lastKey_==goog.events.KeyCodes.META&&!t.metaKey)&&this.resetState(),-1==this.lastKey_&&(t.ctrlKey&&t.keyCode!=goog.events.KeyCodes.CTRL?this.lastKey_=goog.events.KeyCodes.CTRL:t.altKey&&t.keyCode!=goog.events.KeyCodes.ALT?this.lastKey_=goog.events.KeyCodes.ALT:t.metaKey&&t.keyCode!=goog.events.KeyCodes.META&&(this.lastKey_=goog.events.KeyCodes.META)),goog.events.KeyHandler.USES_KEYDOWN_&&!goog.events.KeyCodes.firesKeyPressEvent(t.keyCode,this.lastKey_,t.shiftKey,t.ctrlKey,t.altKey,t.metaKey)?this.handleEvent(t):(this.keyCode_=goog.events.KeyCodes.normalizeKeyCode(t.keyCode),goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_&&(this.altKey_=t.altKey))},goog.events.KeyHandler.prototype.resetState=function(){this.keyCode_=this.lastKey_=-1},goog.events.KeyHandler.prototype.handleKeyup_=function(t){this.resetState(),this.altKey_=t.altKey},goog.events.KeyHandler.prototype.handleEvent=function(t){var e=t.getBrowserEvent(),o=e.altKey;if(goog.userAgent.IE&&t.type==goog.events.EventType.KEYPRESS)var n=this.keyCode_,i=n!=goog.events.KeyCodes.ENTER&&n!=goog.events.KeyCodes.ESC?e.keyCode:0;else(goog.userAgent.WEBKIT||goog.userAgent.EDGE)&&t.type==goog.events.EventType.KEYPRESS?(n=this.keyCode_,i=0<=e.charCode&&63232>e.charCode&&goog.events.KeyCodes.isCharacterKey(n)?e.charCode:0):goog.userAgent.OPERA&&!goog.userAgent.WEBKIT?(n=this.keyCode_,i=goog.events.KeyCodes.isCharacterKey(n)?e.keyCode:0):(n=e.keyCode||this.keyCode_,i=e.charCode||0,goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_&&(o=this.altKey_),goog.userAgent.MAC&&i==goog.events.KeyCodes.QUESTION_MARK&&n==goog.events.KeyCodes.WIN_KEY&&(n=goog.events.KeyCodes.SLASH));var r=n=goog.events.KeyCodes.normalizeKeyCode(n);n?63232<=n&&n in goog.events.KeyHandler.safariKey_?r=goog.events.KeyHandler.safariKey_[n]:25==n&&t.shiftKey&&(r=9):e.keyIdentifier&&e.keyIdentifier in goog.events.KeyHandler.keyIdentifier_&&(r=goog.events.KeyHandler.keyIdentifier_[e.keyIdentifier]),t=r==this.lastKey_,this.lastKey_=r,e=new goog.events.KeyEvent(r,i,t,e),e.altKey=o,this.dispatchEvent(e)},goog.events.KeyHandler.prototype.getElement=function(){return this.element_},goog.events.KeyHandler.prototype.attach=function(t,e){this.keyUpKey_&&this.detach(),this.element_=t,this.keyPressKey_=goog.events.listen(this.element_,goog.events.EventType.KEYPRESS,this,e),this.keyDownKey_=goog.events.listen(this.element_,goog.events.EventType.KEYDOWN,this.handleKeyDown_,e,this),this.keyUpKey_=goog.events.listen(this.element_,goog.events.EventType.KEYUP,this.handleKeyup_,e,this)},goog.events.KeyHandler.prototype.detach=function(){this.keyPressKey_&&(goog.events.unlistenByKey(this.keyPressKey_),goog.events.unlistenByKey(this.keyDownKey_),goog.events.unlistenByKey(this.keyUpKey_),this.keyUpKey_=this.keyDownKey_=this.keyPressKey_=null),this.element_=null,this.keyCode_=this.lastKey_=-1},goog.events.KeyHandler.prototype.disposeInternal=function(){goog.events.KeyHandler.superClass_.disposeInternal.call(this),this.detach()},goog.events.KeyEvent=function(t,e,o,n){goog.events.BrowserEvent.call(this,n),this.type=goog.events.KeyHandler.EventType.KEY,this.keyCode=t,this.charCode=e,this.repeat=o},goog.inherits(goog.events.KeyEvent,goog.events.BrowserEvent),goog.dom.classlist={},goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST=!1,goog.dom.classlist.get=function(t){return goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||t.classList?t.classList:(t=t.className,goog.isString(t)&&t.match(/\S+/g)||[])},goog.dom.classlist.set=function(t,e){t.className=e},goog.dom.classlist.contains=function(t,e){return goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||t.classList?t.classList.contains(e):goog.array.contains(goog.dom.classlist.get(t),e)},goog.dom.classlist.add=function(t,e){goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||t.classList?t.classList.add(e):goog.dom.classlist.contains(t,e)||(t.className+=0<t.className.length?" "+e:e)},goog.dom.classlist.addAll=function(t,e){if(goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||t.classList)goog.array.forEach(e,function(e){goog.dom.classlist.add(t,e)});else{var o={};goog.array.forEach(goog.dom.classlist.get(t),function(t){o[t]=!0}),goog.array.forEach(e,function(t){o[t]=!0}),t.className="";for(var n in o)t.className+=0<t.className.length?" "+n:n}},goog.dom.classlist.remove=function(t,e){goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||t.classList?t.classList.remove(e):goog.dom.classlist.contains(t,e)&&(t.className=goog.array.filter(goog.dom.classlist.get(t),function(t){return t!=e}).join(" "))},goog.dom.classlist.removeAll=function(t,e){goog.dom.classlist.ALWAYS_USE_DOM_TOKEN_LIST||t.classList?goog.array.forEach(e,function(e){goog.dom.classlist.remove(t,e)}):t.className=goog.array.filter(goog.dom.classlist.get(t),function(t){return!goog.array.contains(e,t)}).join(" ")},goog.dom.classlist.enable=function(t,e,o){o?goog.dom.classlist.add(t,e):goog.dom.classlist.remove(t,e)},goog.dom.classlist.enableAll=function(t,e,o){(o?goog.dom.classlist.addAll:goog.dom.classlist.removeAll)(t,e)},goog.dom.classlist.swap=function(t,e,o){return!!goog.dom.classlist.contains(t,e)&&(goog.dom.classlist.remove(t,e),goog.dom.classlist.add(t,o),!0)},goog.dom.classlist.toggle=function(t,e){var o=!goog.dom.classlist.contains(t,e);return goog.dom.classlist.enable(t,e,o),o},goog.dom.classlist.addRemove=function(t,e,o){goog.dom.classlist.remove(t,e),goog.dom.classlist.add(t,o)},goog.ui.registry={},goog.ui.registry.getDefaultRenderer=function(t){for(var e;t&&(e=goog.getUid(t),!(e=goog.ui.registry.defaultRenderers_[e]));)t=t.superClass_?t.superClass_.constructor:null;return e?goog.isFunction(e.getInstance)?e.getInstance():new e:null},goog.ui.registry.setDefaultRenderer=function(t,e){if(!goog.isFunction(t))throw Error("Invalid component class "+t);if(!goog.isFunction(e))throw Error("Invalid renderer class "+e);var o=goog.getUid(t);goog.ui.registry.defaultRenderers_[o]=e},goog.ui.registry.getDecoratorByClassName=function(t){return t in goog.ui.registry.decoratorFunctions_?goog.ui.registry.decoratorFunctions_[t]():null},goog.ui.registry.setDecoratorByClassName=function(t,e){if(!t)throw Error("Invalid class name "+t);if(!goog.isFunction(e))throw Error("Invalid decorator function "+e);goog.ui.registry.decoratorFunctions_[t]=e},goog.ui.registry.getDecorator=function(t){goog.asserts.assert(t);for(var e=goog.dom.classlist.get(t),o=0,n=e.length;o<n;o++)if(t=goog.ui.registry.getDecoratorByClassName(e[o]))return t;return null},goog.ui.registry.reset=function(){goog.ui.registry.defaultRenderers_={},goog.ui.registry.decoratorFunctions_={}},goog.ui.registry.defaultRenderers_={},goog.ui.registry.decoratorFunctions_={},goog.ui.ContainerRenderer=function(t){this.ariaRole_=t},goog.addSingletonGetter(goog.ui.ContainerRenderer),goog.ui.ContainerRenderer.getCustomRenderer=function(t,e){var o=new t;return o.getCssClass=function(){return e},o},goog.ui.ContainerRenderer.CSS_CLASS="goog-container",goog.ui.ContainerRenderer.prototype.getAriaRole=function(){return this.ariaRole_},goog.ui.ContainerRenderer.prototype.enableTabIndex=function(t,e){t&&(t.tabIndex=e?0:-1)},goog.ui.ContainerRenderer.prototype.createDom=function(t){return t.getDomHelper().createDom("DIV",this.getClassNames(t).join(" "))},goog.ui.ContainerRenderer.prototype.getContentElement=function(t){return t},goog.ui.ContainerRenderer.prototype.canDecorate=function(t){return"DIV"==t.tagName},goog.ui.ContainerRenderer.prototype.decorate=function(t,e){e.id&&t.setId(e.id);var o=this.getCssClass(),n=!1,i=goog.dom.classlist.get(e);return i&&goog.array.forEach(i,function(e){e==o?n=!0:e&&this.setStateFromClassName(t,e,o)},this),n||goog.dom.classlist.add(e,o),this.decorateChildren(t,this.getContentElement(e)),e},goog.ui.ContainerRenderer.prototype.setStateFromClassName=function(t,e,o){e==o+"-disabled"?t.setEnabled(!1):e==o+"-horizontal"?t.setOrientation(goog.ui.Container.Orientation.HORIZONTAL):e==o+"-vertical"&&t.setOrientation(goog.ui.Container.Orientation.VERTICAL)},goog.ui.ContainerRenderer.prototype.decorateChildren=function(t,e,o){if(e){o=o||e.firstChild;for(var n;o&&o.parentNode==e;){if(n=o.nextSibling,o.nodeType==goog.dom.NodeType.ELEMENT){var i=this.getDecoratorForChild(o);i&&(i.setElementInternal(o),t.isEnabled()||i.setEnabled(!1),t.addChild(i),i.decorate(o))}else o.nodeValue&&""!=goog.string.trim(o.nodeValue)||e.removeChild(o);o=n}}},goog.ui.ContainerRenderer.prototype.getDecoratorForChild=function(t){return goog.ui.registry.getDecorator(t)},goog.ui.ContainerRenderer.prototype.initializeDom=function(t){t=t.getElement(),goog.asserts.assert(t,"The container DOM element cannot be null."),goog.style.setUnselectable(t,!0,goog.userAgent.GECKO),goog.userAgent.IE&&(t.hideFocus=!0);var e=this.getAriaRole();e&&goog.a11y.aria.setRole(t,e)},goog.ui.ContainerRenderer.prototype.getKeyEventTarget=function(t){return t.getElement()},goog.ui.ContainerRenderer.prototype.getCssClass=function(){return goog.ui.ContainerRenderer.CSS_CLASS},goog.ui.ContainerRenderer.prototype.getClassNames=function(t){var e=this.getCssClass(),o=t.getOrientation()==goog.ui.Container.Orientation.HORIZONTAL;return o=[e,o?e+"-horizontal":e+"-vertical"],t.isEnabled()||o.push(e+"-disabled"),o},goog.ui.ContainerRenderer.prototype.getDefaultOrientation=function(){return goog.ui.Container.Orientation.VERTICAL},goog.ui.ControlRenderer=function(){},goog.addSingletonGetter(goog.ui.ControlRenderer),goog.tagUnsealableClass(goog.ui.ControlRenderer),goog.ui.ControlRenderer.getCustomRenderer=function(t,e){var o=new t;return o.getCssClass=function(){return e},o},goog.ui.ControlRenderer.CSS_CLASS="goog-control",goog.ui.ControlRenderer.IE6_CLASS_COMBINATIONS=[],goog.ui.ControlRenderer.TOGGLE_ARIA_STATE_MAP_=goog.object.create(goog.a11y.aria.Role.BUTTON,goog.a11y.aria.State.PRESSED,goog.a11y.aria.Role.CHECKBOX,goog.a11y.aria.State.CHECKED,goog.a11y.aria.Role.MENU_ITEM,goog.a11y.aria.State.SELECTED,goog.a11y.aria.Role.MENU_ITEM_CHECKBOX,goog.a11y.aria.State.CHECKED,goog.a11y.aria.Role.MENU_ITEM_RADIO,goog.a11y.aria.State.CHECKED,goog.a11y.aria.Role.RADIO,goog.a11y.aria.State.CHECKED,goog.a11y.aria.Role.TAB,goog.a11y.aria.State.SELECTED,goog.a11y.aria.Role.TREEITEM,goog.a11y.aria.State.SELECTED),goog.ui.ControlRenderer.prototype.getAriaRole=function(){},goog.ui.ControlRenderer.prototype.createDom=function(t){return t.getDomHelper().createDom("DIV",this.getClassNames(t).join(" "),t.getContent())},goog.ui.ControlRenderer.prototype.getContentElement=function(t){return t},goog.ui.ControlRenderer.prototype.enableClassName=function(t,e,o){if(t=t.getElement?t.getElement():t){var n=[e];goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("7")&&(n=this.getAppliedCombinedClassNames_(goog.dom.classlist.get(t),e),n.push(e)),goog.dom.classlist.enableAll(t,n,o)}},goog.ui.ControlRenderer.prototype.enableExtraClassName=function(t,e,o){this.enableClassName(t,e,o)},goog.ui.ControlRenderer.prototype.canDecorate=function(t){return!0},goog.ui.ControlRenderer.prototype.decorate=function(t,e){e.id&&t.setId(e.id);var o=this.getContentElement(e);o&&o.firstChild?t.setContentInternal(o.firstChild.nextSibling?goog.array.clone(o.childNodes):o.firstChild):t.setContentInternal(null);var n=0,i=this.getCssClass(),r=this.getStructuralCssClass(),s=!1,a=!1,l=!1,c=goog.array.toArray(goog.dom.classlist.get(e));goog.array.forEach(c,function(t){s||t!=i?a||t!=r?n|=this.getStateFromClass(t):a=!0:(s=!0,r==i&&(a=!0)),this.getStateFromClass(t)==goog.ui.Component.State.DISABLED&&(goog.asserts.assertElement(o),goog.dom.isFocusableTabIndex(o)&&goog.dom.setFocusableTabIndex(o,!1))},this),t.setStateInternal(n),s||(c.push(i),r==i&&(a=!0)),a||c.push(r);var u=t.getExtraClassNames();if(u&&c.push.apply(c,u),goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("7")){var h=this.getAppliedCombinedClassNames_(c);0<h.length&&(c.push.apply(c,h),l=!0)}return s&&a&&!u&&!l||goog.dom.classlist.set(e,c.join(" ")),e},goog.ui.ControlRenderer.prototype.initializeDom=function(t){t.isRightToLeft()&&this.setRightToLeft(t.getElement(),!0),t.isEnabled()&&this.setFocusable(t,t.isVisible())},goog.ui.ControlRenderer.prototype.setAriaRole=function(t,e){var o=e||this.getAriaRole();if(o){goog.asserts.assert(t,"The element passed as a first parameter cannot be null.");o!=goog.a11y.aria.getRole(t)&&goog.a11y.aria.setRole(t,o)}},goog.ui.ControlRenderer.prototype.setAriaStates=function(t,e){goog.asserts.assert(t),goog.asserts.assert(e);var o=t.getAriaLabel();goog.isDefAndNotNull(o)&&this.setAriaLabel(e,o),t.isVisible()||goog.a11y.aria.setState(e,goog.a11y.aria.State.HIDDEN,!t.isVisible()),t.isEnabled()||this.updateAriaState(e,goog.ui.Component.State.DISABLED,!t.isEnabled()),t.isSupportedState(goog.ui.Component.State.SELECTED)&&this.updateAriaState(e,goog.ui.Component.State.SELECTED,t.isSelected()),t.isSupportedState(goog.ui.Component.State.CHECKED)&&this.updateAriaState(e,goog.ui.Component.State.CHECKED,t.isChecked()),t.isSupportedState(goog.ui.Component.State.OPENED)&&this.updateAriaState(e,goog.ui.Component.State.OPENED,t.isOpen())},goog.ui.ControlRenderer.prototype.setAriaLabel=function(t,e){goog.a11y.aria.setLabel(t,e)},goog.ui.ControlRenderer.prototype.setAllowTextSelection=function(t,e){goog.style.setUnselectable(t,!e,!goog.userAgent.IE&&!goog.userAgent.OPERA)},goog.ui.ControlRenderer.prototype.setRightToLeft=function(t,e){this.enableClassName(t,this.getStructuralCssClass()+"-rtl",e)},goog.ui.ControlRenderer.prototype.isFocusable=function(t){var e;return!(!t.isSupportedState(goog.ui.Component.State.FOCUSED)||!(e=t.getKeyEventTarget()))&&goog.dom.isFocusableTabIndex(e)},goog.ui.ControlRenderer.prototype.setFocusable=function(t,e){var o;if(t.isSupportedState(goog.ui.Component.State.FOCUSED)&&(o=t.getKeyEventTarget())){if(!e&&t.isFocused()){try{o.blur()}catch(t){}t.isFocused()&&t.handleBlur(null)}goog.dom.isFocusableTabIndex(o)!=e&&goog.dom.setFocusableTabIndex(o,e)}},goog.ui.ControlRenderer.prototype.setVisible=function(t,e){goog.style.setElementShown(t,e),t&&goog.a11y.aria.setState(t,goog.a11y.aria.State.HIDDEN,!e)},goog.ui.ControlRenderer.prototype.setState=function(t,e,o){var n=t.getElement();if(n){var i=this.getClassForState(e);i&&this.enableClassName(t,i,o),this.updateAriaState(n,e,o)}},goog.ui.ControlRenderer.prototype.updateAriaState=function(t,e,o){goog.ui.ControlRenderer.ariaAttributeMap_||(goog.ui.ControlRenderer.ariaAttributeMap_=goog.object.create(goog.ui.Component.State.DISABLED,goog.a11y.aria.State.DISABLED,goog.ui.Component.State.SELECTED,goog.a11y.aria.State.SELECTED,goog.ui.Component.State.CHECKED,goog.a11y.aria.State.CHECKED,goog.ui.Component.State.OPENED,goog.a11y.aria.State.EXPANDED)),goog.asserts.assert(t,"The element passed as a first parameter cannot be null."),(e=goog.ui.ControlRenderer.getAriaStateForAriaRole_(t,goog.ui.ControlRenderer.ariaAttributeMap_[e]))&&goog.a11y.aria.setState(t,e,o)},goog.ui.ControlRenderer.getAriaStateForAriaRole_=function(t,e){var o=goog.a11y.aria.getRole(t);return o?(o=goog.ui.ControlRenderer.TOGGLE_ARIA_STATE_MAP_[o]||e,goog.ui.ControlRenderer.isAriaState_(e)?o:e):e},goog.ui.ControlRenderer.isAriaState_=function(t){return t==goog.a11y.aria.State.CHECKED||t==goog.a11y.aria.State.SELECTED},goog.ui.ControlRenderer.prototype.setContent=function(t,e){var o=this.getContentElement(t);if(o&&(goog.dom.removeChildren(o),e))if(goog.isString(e))goog.dom.setTextContent(o,e);else{var n=function(t){if(t){var e=goog.dom.getOwnerDocument(o);o.appendChild(goog.isString(t)?e.createTextNode(t):t)}};goog.isArray(e)?goog.array.forEach(e,n):!goog.isArrayLike(e)||"nodeType"in e?n(e):goog.array.forEach(goog.array.clone(e),n)}},goog.ui.ControlRenderer.prototype.getKeyEventTarget=function(t){return t.getElement()},goog.ui.ControlRenderer.prototype.getCssClass=function(){return goog.ui.ControlRenderer.CSS_CLASS},goog.ui.ControlRenderer.prototype.getIe6ClassCombinations=function(){return[]},goog.ui.ControlRenderer.prototype.getStructuralCssClass=function(){return this.getCssClass()},goog.ui.ControlRenderer.prototype.getClassNames=function(t){var e=this.getCssClass(),o=[e],n=this.getStructuralCssClass();return n!=e&&o.push(n),e=this.getClassNamesForState(t.getState()),o.push.apply(o,e),(t=t.getExtraClassNames())&&o.push.apply(o,t),goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("7")&&o.push.apply(o,this.getAppliedCombinedClassNames_(o)),o},goog.ui.ControlRenderer.prototype.getAppliedCombinedClassNames_=function(t,e){var o=[];return e&&(t=goog.array.concat(t,[e])),goog.array.forEach(this.getIe6ClassCombinations(),function(n){!goog.array.every(n,goog.partial(goog.array.contains,t))||e&&!goog.array.contains(n,e)||o.push(n.join("_"))}),o},goog.ui.ControlRenderer.prototype.getClassNamesForState=function(t){for(var e=[];t;){var o=t&-t;e.push(this.getClassForState(o)),t&=~o}return e},goog.ui.ControlRenderer.prototype.getClassForState=function(t){return this.classByState_||this.createClassByStateMap_(),this.classByState_[t]},goog.ui.ControlRenderer.prototype.getStateFromClass=function(t){return this.stateByClass_||this.createStateByClassMap_(),t=parseInt(this.stateByClass_[t],10),isNaN(t)?0:t},goog.ui.ControlRenderer.prototype.createClassByStateMap_=function(){var t=this.getStructuralCssClass(),e=!goog.string.contains(goog.string.normalizeWhitespace(t)," ");goog.asserts.assert(e,"ControlRenderer has an invalid css class: '"+t+"'"),this.classByState_=goog.object.create(goog.ui.Component.State.DISABLED,t+"-disabled",goog.ui.Component.State.HOVER,t+"-hover",goog.ui.Component.State.ACTIVE,t+"-active",goog.ui.Component.State.SELECTED,t+"-selected",goog.ui.Component.State.CHECKED,t+"-checked",goog.ui.Component.State.FOCUSED,t+"-focused",goog.ui.Component.State.OPENED,t+"-open")},goog.ui.ControlRenderer.prototype.createStateByClassMap_=function(){this.classByState_||this.createClassByStateMap_(),this.stateByClass_=goog.object.transpose(this.classByState_)},goog.ui.Control=function(t,e,o){goog.ui.Component.call(this,o),this.renderer_=e||goog.ui.registry.getDefaultRenderer(this.constructor),this.setContentInternal(goog.isDef(t)?t:null),this.ariaLabel_=null},goog.inherits(goog.ui.Control,goog.ui.Component),goog.tagUnsealableClass(goog.ui.Control),goog.ui.Control.registerDecorator=goog.ui.registry.setDecoratorByClassName,goog.ui.Control.getDecorator=goog.ui.registry.getDecorator,goog.ui.Control.prototype.content_=null,goog.ui.Control.prototype.state_=0,goog.ui.Control.prototype.supportedStates_=goog.ui.Component.State.DISABLED|goog.ui.Component.State.HOVER|goog.ui.Component.State.ACTIVE|goog.ui.Component.State.FOCUSED,goog.ui.Control.prototype.autoStates_=goog.ui.Component.State.ALL,goog.ui.Control.prototype.statesWithTransitionEvents_=0,goog.ui.Control.prototype.visible_=!0,goog.ui.Control.prototype.extraClassNames_=null,goog.ui.Control.prototype.handleMouseEvents_=!0,goog.ui.Control.prototype.allowTextSelection_=!1,goog.ui.Control.prototype.preferredAriaRole_=null,goog.ui.Control.prototype.isHandleMouseEvents=function(){return this.handleMouseEvents_},goog.ui.Control.prototype.setHandleMouseEvents=function(t){this.isInDocument()&&t!=this.handleMouseEvents_&&this.enableMouseEventHandling_(t),this.handleMouseEvents_=t},goog.ui.Control.prototype.getKeyEventTarget=function(){return this.renderer_.getKeyEventTarget(this)},goog.ui.Control.prototype.getKeyHandler=function(){return this.keyHandler_||(this.keyHandler_=new goog.events.KeyHandler)},goog.ui.Control.prototype.getRenderer=function(){return this.renderer_},goog.ui.Control.prototype.setRenderer=function(t){if(this.isInDocument())throw Error(goog.ui.Component.Error.ALREADY_RENDERED);this.getElement()&&this.setElementInternal(null),this.renderer_=t},goog.ui.Control.prototype.getExtraClassNames=function(){return this.extraClassNames_},goog.ui.Control.prototype.addClassName=function(t){t&&(this.extraClassNames_?goog.array.contains(this.extraClassNames_,t)||this.extraClassNames_.push(t):this.extraClassNames_=[t],this.renderer_.enableExtraClassName(this,t,!0))},goog.ui.Control.prototype.removeClassName=function(t){t&&this.extraClassNames_&&goog.array.remove(this.extraClassNames_,t)&&(0==this.extraClassNames_.length&&(this.extraClassNames_=null),this.renderer_.enableExtraClassName(this,t,!1))},goog.ui.Control.prototype.enableClassName=function(t,e){e?this.addClassName(t):this.removeClassName(t)},goog.ui.Control.prototype.createDom=function(){var t=this.renderer_.createDom(this);this.setElementInternal(t),this.renderer_.setAriaRole(t,this.getPreferredAriaRole()),this.isAllowTextSelection()||this.renderer_.setAllowTextSelection(t,!1),this.isVisible()||this.renderer_.setVisible(t,!1)},goog.ui.Control.prototype.getPreferredAriaRole=function(){return this.preferredAriaRole_},goog.ui.Control.prototype.setPreferredAriaRole=function(t){this.preferredAriaRole_=t},goog.ui.Control.prototype.getAriaLabel=function(){return this.ariaLabel_},goog.ui.Control.prototype.setAriaLabel=function(t){this.ariaLabel_=t;var e=this.getElement();e&&this.renderer_.setAriaLabel(e,t)},goog.ui.Control.prototype.getContentElement=function(){return this.renderer_.getContentElement(this.getElement())},goog.ui.Control.prototype.canDecorate=function(t){return this.renderer_.canDecorate(t)},goog.ui.Control.prototype.decorateInternal=function(t){t=this.renderer_.decorate(this,t),this.setElementInternal(t),this.renderer_.setAriaRole(t,this.getPreferredAriaRole()),this.isAllowTextSelection()||this.renderer_.setAllowTextSelection(t,!1),this.visible_="none"!=t.style.display},goog.ui.Control.prototype.enterDocument=function(){if(goog.ui.Control.superClass_.enterDocument.call(this),this.renderer_.setAriaStates(this,this.getElementStrict()),this.renderer_.initializeDom(this),this.supportedStates_&~goog.ui.Component.State.DISABLED&&(this.isHandleMouseEvents()&&this.enableMouseEventHandling_(!0),this.isSupportedState(goog.ui.Component.State.FOCUSED))){var t=this.getKeyEventTarget();if(t){var e=this.getKeyHandler();e.attach(t),this.getHandler().listen(e,goog.events.KeyHandler.EventType.KEY,this.handleKeyEvent).listen(t,goog.events.EventType.FOCUS,this.handleFocus).listen(t,goog.events.EventType.BLUR,this.handleBlur)}}},goog.ui.Control.prototype.enableMouseEventHandling_=function(t){var e=this.getHandler(),o=this.getElement();t?(e.listen(o,goog.events.EventType.MOUSEOVER,this.handleMouseOver).listen(o,goog.events.EventType.MOUSEDOWN,this.handleMouseDown).listen(o,goog.events.EventType.MOUSEUP,this.handleMouseUp).listen(o,goog.events.EventType.MOUSEOUT,this.handleMouseOut),this.handleContextMenu!=goog.nullFunction&&e.listen(o,goog.events.EventType.CONTEXTMENU,this.handleContextMenu),goog.userAgent.IE&&(goog.userAgent.isVersionOrHigher(9)||e.listen(o,goog.events.EventType.DBLCLICK,this.handleDblClick),this.ieMouseEventSequenceSimulator_||(this.ieMouseEventSequenceSimulator_=new goog.ui.Control.IeMouseEventSequenceSimulator_(this),this.registerDisposable(this.ieMouseEventSequenceSimulator_)))):(e.unlisten(o,goog.events.EventType.MOUSEOVER,this.handleMouseOver).unlisten(o,goog.events.EventType.MOUSEDOWN,this.handleMouseDown).unlisten(o,goog.events.EventType.MOUSEUP,this.handleMouseUp).unlisten(o,goog.events.EventType.MOUSEOUT,this.handleMouseOut),this.handleContextMenu!=goog.nullFunction&&e.unlisten(o,goog.events.EventType.CONTEXTMENU,this.handleContextMenu),goog.userAgent.IE&&(goog.userAgent.isVersionOrHigher(9)||e.unlisten(o,goog.events.EventType.DBLCLICK,this.handleDblClick),goog.dispose(this.ieMouseEventSequenceSimulator_),this.ieMouseEventSequenceSimulator_=null))},goog.ui.Control.prototype.exitDocument=function(){goog.ui.Control.superClass_.exitDocument.call(this),this.keyHandler_&&this.keyHandler_.detach(),this.isVisible()&&this.isEnabled()&&this.renderer_.setFocusable(this,!1)},goog.ui.Control.prototype.disposeInternal=function(){goog.ui.Control.superClass_.disposeInternal.call(this),this.keyHandler_&&(this.keyHandler_.dispose(),delete this.keyHandler_),delete this.renderer_,this.ieMouseEventSequenceSimulator_=this.extraClassNames_=this.content_=null},goog.ui.Control.prototype.getContent=function(){return this.content_},goog.ui.Control.prototype.setContent=function(t){this.renderer_.setContent(this.getElement(),t),this.setContentInternal(t)},goog.ui.Control.prototype.setContentInternal=function(t){this.content_=t},goog.ui.Control.prototype.getCaption=function(){var t=this.getContent();return t?(t=goog.isString(t)?t:goog.isArray(t)?goog.array.map(t,goog.dom.getRawTextContent).join(""):goog.dom.getTextContent(t),goog.string.collapseBreakingSpaces(t)):""},goog.ui.Control.prototype.setCaption=function(t){this.setContent(t)},goog.ui.Control.prototype.setRightToLeft=function(t){goog.ui.Control.superClass_.setRightToLeft.call(this,t);var e=this.getElement();e&&this.renderer_.setRightToLeft(e,t)},goog.ui.Control.prototype.isAllowTextSelection=function(){return this.allowTextSelection_},goog.ui.Control.prototype.setAllowTextSelection=function(t){this.allowTextSelection_=t;var e=this.getElement();e&&this.renderer_.setAllowTextSelection(e,t)},goog.ui.Control.prototype.isVisible=function(){return this.visible_},goog.ui.Control.prototype.setVisible=function(t,e){if(e||this.visible_!=t&&this.dispatchEvent(t?goog.ui.Component.EventType.SHOW:goog.ui.Component.EventType.HIDE)){var o=this.getElement();return o&&this.renderer_.setVisible(o,t),this.isEnabled()&&this.renderer_.setFocusable(this,t),this.visible_=t,!0}return!1},goog.ui.Control.prototype.isEnabled=function(){return!this.hasState(goog.ui.Component.State.DISABLED)},goog.ui.Control.prototype.isParentDisabled_=function(){var t=this.getParent();return!!t&&"function"==typeof t.isEnabled&&!t.isEnabled()},goog.ui.Control.prototype.setEnabled=function(t){!this.isParentDisabled_()&&this.isTransitionAllowed(goog.ui.Component.State.DISABLED,!t)&&(t||(this.setActive(!1),this.setHighlighted(!1)),this.isVisible()&&this.renderer_.setFocusable(this,t),this.setState(goog.ui.Component.State.DISABLED,!t,!0))},goog.ui.Control.prototype.isHighlighted=function(){return this.hasState(goog.ui.Component.State.HOVER)},goog.ui.Control.prototype.setHighlighted=function(t){this.isTransitionAllowed(goog.ui.Component.State.HOVER,t)&&this.setState(goog.ui.Component.State.HOVER,t)},goog.ui.Control.prototype.isActive=function(){return this.hasState(goog.ui.Component.State.ACTIVE)},goog.ui.Control.prototype.setActive=function(t){this.isTransitionAllowed(goog.ui.Component.State.ACTIVE,t)&&this.setState(goog.ui.Component.State.ACTIVE,t)},goog.ui.Control.prototype.isSelected=function(){return this.hasState(goog.ui.Component.State.SELECTED)},goog.ui.Control.prototype.setSelected=function(t){this.isTransitionAllowed(goog.ui.Component.State.SELECTED,t)&&this.setState(goog.ui.Component.State.SELECTED,t)},goog.ui.Control.prototype.isChecked=function(){return this.hasState(goog.ui.Component.State.CHECKED)},goog.ui.Control.prototype.setChecked=function(t){this.isTransitionAllowed(goog.ui.Component.State.CHECKED,t)&&this.setState(goog.ui.Component.State.CHECKED,t)},goog.ui.Control.prototype.isFocused=function(){return this.hasState(goog.ui.Component.State.FOCUSED)},goog.ui.Control.prototype.setFocused=function(t){this.isTransitionAllowed(goog.ui.Component.State.FOCUSED,t)&&this.setState(goog.ui.Component.State.FOCUSED,t)},goog.ui.Control.prototype.isOpen=function(){return this.hasState(goog.ui.Component.State.OPENED)},goog.ui.Control.prototype.setOpen=function(t){this.isTransitionAllowed(goog.ui.Component.State.OPENED,t)&&this.setState(goog.ui.Component.State.OPENED,t)},goog.ui.Control.prototype.getState=function(){return this.state_};goog.ui.Control.prototype.hasState=function(t){return!!(this.state_&t)},goog.ui.Control.prototype.setState=function(t,e,o){o||t!=goog.ui.Component.State.DISABLED?this.isSupportedState(t)&&e!=this.hasState(t)&&(this.renderer_.setState(this,t,e),this.state_=e?this.state_|t:this.state_&~t):this.setEnabled(!e)},goog.ui.Control.prototype.setStateInternal=function(t){this.state_=t},goog.ui.Control.prototype.isSupportedState=function(t){return!!(this.supportedStates_&t)},goog.ui.Control.prototype.setSupportedState=function(t,e){if(this.isInDocument()&&this.hasState(t)&&!e)throw Error(goog.ui.Component.Error.ALREADY_RENDERED);!e&&this.hasState(t)&&this.setState(t,!1),this.supportedStates_=e?this.supportedStates_|t:this.supportedStates_&~t},goog.ui.Control.prototype.isAutoState=function(t){return!!(this.autoStates_&t)&&this.isSupportedState(t)},goog.ui.Control.prototype.setAutoStates=function(t,e){this.autoStates_=e?this.autoStates_|t:this.autoStates_&~t},goog.ui.Control.prototype.isDispatchTransitionEvents=function(t){return!!(this.statesWithTransitionEvents_&t)&&this.isSupportedState(t)},goog.ui.Control.prototype.setDispatchTransitionEvents=function(t,e){this.statesWithTransitionEvents_=e?this.statesWithTransitionEvents_|t:this.statesWithTransitionEvents_&~t},goog.ui.Control.prototype.isTransitionAllowed=function(t,e){return this.isSupportedState(t)&&this.hasState(t)!=e&&(!(this.statesWithTransitionEvents_&t)||this.dispatchEvent(goog.ui.Component.getStateTransitionEvent(t,e)))&&!this.isDisposed()},goog.ui.Control.prototype.handleMouseOver=function(t){!goog.ui.Control.isMouseEventWithinElement_(t,this.getElement())&&this.dispatchEvent(goog.ui.Component.EventType.ENTER)&&this.isEnabled()&&this.isAutoState(goog.ui.Component.State.HOVER)&&this.setHighlighted(!0)},goog.ui.Control.prototype.handleMouseOut=function(t){!goog.ui.Control.isMouseEventWithinElement_(t,this.getElement())&&this.dispatchEvent(goog.ui.Component.EventType.LEAVE)&&(this.isAutoState(goog.ui.Component.State.ACTIVE)&&this.setActive(!1),this.isAutoState(goog.ui.Component.State.HOVER)&&this.setHighlighted(!1))},goog.ui.Control.prototype.handleContextMenu=goog.nullFunction,goog.ui.Control.isMouseEventWithinElement_=function(t,e){return!!t.relatedTarget&&goog.dom.contains(e,t.relatedTarget)},goog.ui.Control.prototype.handleMouseDown=function(t){this.isEnabled()&&(this.isAutoState(goog.ui.Component.State.HOVER)&&this.setHighlighted(!0),t.isMouseActionButton()&&(this.isAutoState(goog.ui.Component.State.ACTIVE)&&this.setActive(!0),this.renderer_&&this.renderer_.isFocusable(this)&&this.getKeyEventTarget().focus())),!this.isAllowTextSelection()&&t.isMouseActionButton()&&t.preventDefault()},goog.ui.Control.prototype.handleMouseUp=function(t){this.isEnabled()&&(this.isAutoState(goog.ui.Component.State.HOVER)&&this.setHighlighted(!0),this.isActive()&&this.performActionInternal(t)&&this.isAutoState(goog.ui.Component.State.ACTIVE)&&this.setActive(!1))},goog.ui.Control.prototype.handleDblClick=function(t){this.isEnabled()&&this.performActionInternal(t)},goog.ui.Control.prototype.performActionInternal=function(t){this.isAutoState(goog.ui.Component.State.CHECKED)&&this.setChecked(!this.isChecked()),this.isAutoState(goog.ui.Component.State.SELECTED)&&this.setSelected(!0),this.isAutoState(goog.ui.Component.State.OPENED)&&this.setOpen(!this.isOpen());var e=new goog.events.Event(goog.ui.Component.EventType.ACTION,this);return t&&(e.altKey=t.altKey,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.platformModifierKey=t.platformModifierKey),this.dispatchEvent(e)},goog.ui.Control.prototype.handleFocus=function(t){this.isAutoState(goog.ui.Component.State.FOCUSED)&&this.setFocused(!0)},goog.ui.Control.prototype.handleBlur=function(t){this.isAutoState(goog.ui.Component.State.ACTIVE)&&this.setActive(!1),this.isAutoState(goog.ui.Component.State.FOCUSED)&&this.setFocused(!1)},goog.ui.Control.prototype.handleKeyEvent=function(t){return!!(this.isVisible()&&this.isEnabled()&&this.handleKeyEventInternal(t))&&(t.preventDefault(),t.stopPropagation(),!0)},goog.ui.Control.prototype.handleKeyEventInternal=function(t){return t.keyCode==goog.events.KeyCodes.ENTER&&this.performActionInternal(t)},goog.ui.registry.setDefaultRenderer(goog.ui.Control,goog.ui.ControlRenderer),goog.ui.registry.setDecoratorByClassName(goog.ui.ControlRenderer.CSS_CLASS,function(){return new goog.ui.Control(null)}),goog.ui.Control.IeMouseEventSequenceSimulator_=function(t){goog.Disposable.call(this),this.control_=t,this.clickExpected_=!1,this.handler_=new goog.events.EventHandler(this),this.registerDisposable(this.handler_),t=this.control_.getElementStrict(),this.handler_.listen(t,goog.events.EventType.MOUSEDOWN,this.handleMouseDown_).listen(t,goog.events.EventType.MOUSEUP,this.handleMouseUp_).listen(t,goog.events.EventType.CLICK,this.handleClick_)},goog.inherits(goog.ui.Control.IeMouseEventSequenceSimulator_,goog.Disposable),goog.ui.Control.IeMouseEventSequenceSimulator_.SYNTHETIC_EVENTS_=!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),goog.ui.Control.IeMouseEventSequenceSimulator_.prototype.handleMouseDown_=function(){this.clickExpected_=!1},goog.ui.Control.IeMouseEventSequenceSimulator_.prototype.handleMouseUp_=function(){this.clickExpected_=!0},goog.ui.Control.IeMouseEventSequenceSimulator_.makeLeftMouseEvent_=function(t,e){if(!goog.ui.Control.IeMouseEventSequenceSimulator_.SYNTHETIC_EVENTS_)return t.button=goog.events.BrowserEvent.MouseButton.LEFT,t.type=e,t;var o=document.createEvent("MouseEvents");return o.initMouseEvent(e,t.bubbles,t.cancelable,t.view||null,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,goog.events.BrowserEvent.MouseButton.LEFT,t.relatedTarget||null),o},goog.ui.Control.IeMouseEventSequenceSimulator_.prototype.handleClick_=function(t){if(this.clickExpected_)this.clickExpected_=!1;else{var e=t.getBrowserEvent(),o=e.button,n=e.type,i=goog.ui.Control.IeMouseEventSequenceSimulator_.makeLeftMouseEvent_(e,goog.events.EventType.MOUSEDOWN);this.control_.handleMouseDown(new goog.events.BrowserEvent(i,t.currentTarget)),i=goog.ui.Control.IeMouseEventSequenceSimulator_.makeLeftMouseEvent_(e,goog.events.EventType.MOUSEUP),this.control_.handleMouseUp(new goog.events.BrowserEvent(i,t.currentTarget)),goog.ui.Control.IeMouseEventSequenceSimulator_.SYNTHETIC_EVENTS_||(e.button=o,e.type=n)}},goog.ui.Control.IeMouseEventSequenceSimulator_.prototype.disposeInternal=function(){this.control_=null,goog.ui.Control.IeMouseEventSequenceSimulator_.superClass_.disposeInternal.call(this)},goog.ui.Container=function(t,e,o){goog.ui.Component.call(this,o),this.renderer_=e||goog.ui.ContainerRenderer.getInstance(),this.orientation_=t||this.renderer_.getDefaultOrientation()},goog.inherits(goog.ui.Container,goog.ui.Component),goog.tagUnsealableClass(goog.ui.Container),goog.ui.Container.EventType={AFTER_SHOW:"aftershow",AFTER_HIDE:"afterhide"},goog.ui.Container.Orientation={HORIZONTAL:"horizontal",VERTICAL:"vertical"},goog.ui.Container.prototype.keyEventTarget_=null,goog.ui.Container.prototype.keyHandler_=null,goog.ui.Container.prototype.renderer_=null,goog.ui.Container.prototype.orientation_=null,goog.ui.Container.prototype.visible_=!0,goog.ui.Container.prototype.enabled_=!0,goog.ui.Container.prototype.focusable_=!0,goog.ui.Container.prototype.highlightedIndex_=-1,goog.ui.Container.prototype.openItem_=null,goog.ui.Container.prototype.mouseButtonPressed_=!1,goog.ui.Container.prototype.allowFocusableChildren_=!1,goog.ui.Container.prototype.openFollowsHighlight_=!0,goog.ui.Container.prototype.childElementIdMap_=null,goog.ui.Container.prototype.getKeyEventTarget=function(){return this.keyEventTarget_||this.renderer_.getKeyEventTarget(this)},goog.ui.Container.prototype.setKeyEventTarget=function(t){if(!this.focusable_)throw Error("Can't set key event target for container that doesn't support keyboard focus!");var e=this.getKeyEventTarget(),o=this.isInDocument();this.keyEventTarget_=t;var n=this.getKeyEventTarget();o&&(this.keyEventTarget_=e,this.enableFocusHandling_(!1),this.keyEventTarget_=t,this.getKeyHandler().attach(n),this.enableFocusHandling_(!0))},goog.ui.Container.prototype.getKeyHandler=function(){return this.keyHandler_||(this.keyHandler_=new goog.events.KeyHandler(this.getKeyEventTarget()))},goog.ui.Container.prototype.getRenderer=function(){return this.renderer_},goog.ui.Container.prototype.setRenderer=function(t){if(this.getElement())throw Error(goog.ui.Component.Error.ALREADY_RENDERED);this.renderer_=t},goog.ui.Container.prototype.createDom=function(){this.setElementInternal(this.renderer_.createDom(this))},goog.ui.Container.prototype.getContentElement=function(){return this.renderer_.getContentElement(this.getElement())},goog.ui.Container.prototype.canDecorate=function(t){return this.renderer_.canDecorate(t)},goog.ui.Container.prototype.decorateInternal=function(t){this.setElementInternal(this.renderer_.decorate(this,t)),"none"==t.style.display&&(this.visible_=!1)},goog.ui.Container.prototype.enterDocument=function(){goog.ui.Container.superClass_.enterDocument.call(this),this.forEachChild(function(t){t.isInDocument()&&this.registerChildId_(t)},this);var t=this.getElement();this.renderer_.initializeDom(this),this.setVisible(this.visible_,!0),this.getHandler().listen(this,goog.ui.Component.EventType.ENTER,this.handleEnterItem).listen(this,goog.ui.Component.EventType.HIGHLIGHT,this.handleHighlightItem).listen(this,goog.ui.Component.EventType.UNHIGHLIGHT,this.handleUnHighlightItem).listen(this,goog.ui.Component.EventType.OPEN,this.handleOpenItem).listen(this,goog.ui.Component.EventType.CLOSE,this.handleCloseItem).listen(t,goog.events.EventType.MOUSEDOWN,this.handleMouseDown).listen(goog.dom.getOwnerDocument(t),goog.events.EventType.MOUSEUP,this.handleDocumentMouseUp).listen(t,[goog.events.EventType.MOUSEDOWN,goog.events.EventType.MOUSEUP,goog.events.EventType.MOUSEOVER,goog.events.EventType.MOUSEOUT,goog.events.EventType.CONTEXTMENU],this.handleChildMouseEvents),this.isFocusable()&&this.enableFocusHandling_(!0)},goog.ui.Container.prototype.enableFocusHandling_=function(t){var e=this.getHandler(),o=this.getKeyEventTarget();t?e.listen(o,goog.events.EventType.FOCUS,this.handleFocus).listen(o,goog.events.EventType.BLUR,this.handleBlur).listen(this.getKeyHandler(),goog.events.KeyHandler.EventType.KEY,this.handleKeyEvent):e.unlisten(o,goog.events.EventType.FOCUS,this.handleFocus).unlisten(o,goog.events.EventType.BLUR,this.handleBlur).unlisten(this.getKeyHandler(),goog.events.KeyHandler.EventType.KEY,this.handleKeyEvent)},goog.ui.Container.prototype.exitDocument=function(){this.setHighlightedIndex(-1),this.openItem_&&this.openItem_.setOpen(!1),this.mouseButtonPressed_=!1,goog.ui.Container.superClass_.exitDocument.call(this)},goog.ui.Container.prototype.disposeInternal=function(){goog.ui.Container.superClass_.disposeInternal.call(this),this.keyHandler_&&(this.keyHandler_.dispose(),this.keyHandler_=null),this.renderer_=this.openItem_=this.childElementIdMap_=this.keyEventTarget_=null},goog.ui.Container.prototype.handleEnterItem=function(t){return!0},goog.ui.Container.prototype.handleHighlightItem=function(t){var e=this.indexOfChild(t.target);if(-1<e&&e!=this.highlightedIndex_){var o=this.getHighlighted();o&&o.setHighlighted(!1),this.highlightedIndex_=e,o=this.getHighlighted(),this.isMouseButtonPressed()&&o.setActive(!0),this.openFollowsHighlight_&&this.openItem_&&o!=this.openItem_&&(o.isSupportedState(goog.ui.Component.State.OPENED)?o.setOpen(!0):this.openItem_.setOpen(!1))}e=this.getElement(),goog.asserts.assert(e,"The DOM element for the container cannot be null."),null!=t.target.getElement()&&goog.a11y.aria.setState(e,goog.a11y.aria.State.ACTIVEDESCENDANT,t.target.getElement().id)},goog.ui.Container.prototype.handleUnHighlightItem=function(t){t.target==this.getHighlighted()&&(this.highlightedIndex_=-1),t=this.getElement(),goog.asserts.assert(t,"The DOM element for the container cannot be null."),goog.a11y.aria.removeState(t,goog.a11y.aria.State.ACTIVEDESCENDANT)},goog.ui.Container.prototype.handleOpenItem=function(t){(t=t.target)&&t!=this.openItem_&&t.getParent()==this&&(this.openItem_&&this.openItem_.setOpen(!1),this.openItem_=t)},goog.ui.Container.prototype.handleCloseItem=function(t){t.target==this.openItem_&&(this.openItem_=null);var e=this.getElement(),o=t.target.getElement();e&&t.target.isHighlighted()&&o&&goog.a11y.aria.setActiveDescendant(e,o)},goog.ui.Container.prototype.handleMouseDown=function(t){this.enabled_&&this.setMouseButtonPressed(!0);var e=this.getKeyEventTarget();e&&goog.dom.isFocusableTabIndex(e)?e.focus():t.preventDefault()},goog.ui.Container.prototype.handleDocumentMouseUp=function(t){this.setMouseButtonPressed(!1)},goog.ui.Container.prototype.handleChildMouseEvents=function(t){var e=this.getOwnerControl(t.target);if(e)switch(t.type){case goog.events.EventType.MOUSEDOWN:e.handleMouseDown(t);break;case goog.events.EventType.MOUSEUP:e.handleMouseUp(t);break;case goog.events.EventType.MOUSEOVER:e.handleMouseOver(t);break;case goog.events.EventType.MOUSEOUT:e.handleMouseOut(t);break;case goog.events.EventType.CONTEXTMENU:e.handleContextMenu(t)}},goog.ui.Container.prototype.getOwnerControl=function(t){if(this.childElementIdMap_)for(var e=this.getElement();t&&t!==e;){var o=t.id;if(o in this.childElementIdMap_)return this.childElementIdMap_[o];t=t.parentNode}return null},goog.ui.Container.prototype.handleFocus=function(t){},goog.ui.Container.prototype.handleBlur=function(t){this.setHighlightedIndex(-1),this.setMouseButtonPressed(!1),this.openItem_&&this.openItem_.setOpen(!1)},goog.ui.Container.prototype.handleKeyEvent=function(t){return!(!this.isEnabled()||!this.isVisible()||0==this.getChildCount()&&!this.keyEventTarget_||!this.handleKeyEventInternal(t))&&(t.preventDefault(),t.stopPropagation(),!0)},goog.ui.Container.prototype.handleKeyEventInternal=function(t){var e=this.getHighlighted();if(e&&"function"==typeof e.handleKeyEvent&&e.handleKeyEvent(t)||this.openItem_&&this.openItem_!=e&&"function"==typeof this.openItem_.handleKeyEvent&&this.openItem_.handleKeyEvent(t))return!0;if(t.shiftKey||t.ctrlKey||t.metaKey||t.altKey)return!1;switch(t.keyCode){case goog.events.KeyCodes.ESC:if(!this.isFocusable())return!1;this.getKeyEventTarget().blur();break;case goog.events.KeyCodes.HOME:this.highlightFirst();break;case goog.events.KeyCodes.END:this.highlightLast();break;case goog.events.KeyCodes.UP:if(this.orientation_!=goog.ui.Container.Orientation.VERTICAL)return!1;this.highlightPrevious();break;case goog.events.KeyCodes.LEFT:if(this.orientation_!=goog.ui.Container.Orientation.HORIZONTAL)return!1;this.isRightToLeft()?this.highlightNext():this.highlightPrevious();break;case goog.events.KeyCodes.DOWN:if(this.orientation_!=goog.ui.Container.Orientation.VERTICAL)return!1;this.highlightNext();break;case goog.events.KeyCodes.RIGHT:if(this.orientation_!=goog.ui.Container.Orientation.HORIZONTAL)return!1;this.isRightToLeft()?this.highlightPrevious():this.highlightNext();break;default:return!1}return!0},goog.ui.Container.prototype.registerChildId_=function(t){var e=t.getElement();e=e.id||(e.id=t.getId()),this.childElementIdMap_||(this.childElementIdMap_={}),this.childElementIdMap_[e]=t},goog.ui.Container.prototype.addChild=function(t,e){goog.asserts.assertInstanceof(t,goog.ui.Control,"The child of a container must be a control"),goog.ui.Container.superClass_.addChild.call(this,t,e)},goog.ui.Container.prototype.addChildAt=function(t,e,o){goog.asserts.assertInstanceof(t,goog.ui.Control),t.setDispatchTransitionEvents(goog.ui.Component.State.HOVER,!0),t.setDispatchTransitionEvents(goog.ui.Component.State.OPENED,!0),!this.isFocusable()&&this.isFocusableChildrenAllowed()||t.setSupportedState(goog.ui.Component.State.FOCUSED,!1),t.setHandleMouseEvents(!1);var n=t.getParent()==this?this.indexOfChild(t):-1;goog.ui.Container.superClass_.addChildAt.call(this,t,e,o),t.isInDocument()&&this.isInDocument()&&this.registerChildId_(t),this.updateHighlightedIndex_(n,e)},goog.ui.Container.prototype.updateHighlightedIndex_=function(t,e){-1==t&&(t=this.getChildCount()),t==this.highlightedIndex_?this.highlightedIndex_=Math.min(this.getChildCount()-1,e):t>this.highlightedIndex_&&e<=this.highlightedIndex_?this.highlightedIndex_++:t<this.highlightedIndex_&&e>this.highlightedIndex_&&this.highlightedIndex_--},goog.ui.Container.prototype.removeChild=function(t,e){if(t=goog.isString(t)?this.getChild(t):t,goog.asserts.assertInstanceof(t,goog.ui.Control),t){var o=this.indexOfChild(t);-1!=o&&(o==this.highlightedIndex_?(t.setHighlighted(!1),this.highlightedIndex_=-1):o<this.highlightedIndex_&&this.highlightedIndex_--),(o=t.getElement())&&o.id&&this.childElementIdMap_&&goog.object.remove(this.childElementIdMap_,o.id)}return t=goog.ui.Container.superClass_.removeChild.call(this,t,e),t.setHandleMouseEvents(!0),t},goog.ui.Container.prototype.getOrientation=function(){return this.orientation_},goog.ui.Container.prototype.setOrientation=function(t){if(this.getElement())throw Error(goog.ui.Component.Error.ALREADY_RENDERED);this.orientation_=t},goog.ui.Container.prototype.isVisible=function(){return this.visible_},goog.ui.Container.prototype.setVisible=function(t,e){if(e||this.visible_!=t&&this.dispatchEvent(t?goog.ui.Component.EventType.SHOW:goog.ui.Component.EventType.HIDE)){this.visible_=t;var o=this.getElement();return o&&(goog.style.setElementShown(o,t),this.isFocusable()&&this.renderer_.enableTabIndex(this.getKeyEventTarget(),this.enabled_&&this.visible_),e||this.dispatchEvent(this.visible_?goog.ui.Container.EventType.AFTER_SHOW:goog.ui.Container.EventType.AFTER_HIDE)),!0}return!1},goog.ui.Container.prototype.isEnabled=function(){return this.enabled_},goog.ui.Container.prototype.setEnabled=function(t){this.enabled_!=t&&this.dispatchEvent(t?goog.ui.Component.EventType.ENABLE:goog.ui.Component.EventType.DISABLE)&&(t?(this.enabled_=!0,this.forEachChild(function(t){t.wasDisabled?delete t.wasDisabled:t.setEnabled(!0)})):(this.forEachChild(function(t){t.isEnabled()?t.setEnabled(!1):t.wasDisabled=!0}),this.enabled_=!1,this.setMouseButtonPressed(!1)),this.isFocusable()&&this.renderer_.enableTabIndex(this.getKeyEventTarget(),t&&this.visible_))},goog.ui.Container.prototype.isFocusable=function(){return this.focusable_},goog.ui.Container.prototype.setFocusable=function(t){t!=this.focusable_&&this.isInDocument()&&this.enableFocusHandling_(t),this.focusable_=t,this.enabled_&&this.visible_&&this.renderer_.enableTabIndex(this.getKeyEventTarget(),t)},goog.ui.Container.prototype.isFocusableChildrenAllowed=function(){return this.allowFocusableChildren_},goog.ui.Container.prototype.setFocusableChildrenAllowed=function(t){this.allowFocusableChildren_=t},goog.ui.Container.prototype.isOpenFollowsHighlight=function(){return this.openFollowsHighlight_},goog.ui.Container.prototype.setOpenFollowsHighlight=function(t){this.openFollowsHighlight_=t},goog.ui.Container.prototype.getHighlightedIndex=function(){return this.highlightedIndex_},goog.ui.Container.prototype.setHighlightedIndex=function(t){(t=this.getChildAt(t))?t.setHighlighted(!0):-1<this.highlightedIndex_&&this.getHighlighted().setHighlighted(!1)},goog.ui.Container.prototype.setHighlighted=function(t){this.setHighlightedIndex(this.indexOfChild(t))},goog.ui.Container.prototype.getHighlighted=function(){return this.getChildAt(this.highlightedIndex_)},goog.ui.Container.prototype.highlightFirst=function(){this.highlightHelper(function(t,e){return(t+1)%e},this.getChildCount()-1)},goog.ui.Container.prototype.highlightLast=function(){this.highlightHelper(function(t,e){return t--,0>t?e-1:t},0)},goog.ui.Container.prototype.highlightNext=function(){this.highlightHelper(function(t,e){return(t+1)%e},this.highlightedIndex_)},goog.ui.Container.prototype.highlightPrevious=function(){this.highlightHelper(function(t,e){return t--,0>t?e-1:t},this.highlightedIndex_)},goog.ui.Container.prototype.highlightHelper=function(t,e){var o=0>e?this.indexOfChild(this.openItem_):e,n=this.getChildCount();o=t.call(this,o,n);for(var i=0;i<=n;){var r=this.getChildAt(o);if(r&&this.canHighlightItem(r))return this.setHighlightedIndexFromKeyEvent(o),!0;i++,o=t.call(this,o,n)}return!1},goog.ui.Container.prototype.canHighlightItem=function(t){return t.isVisible()&&t.isEnabled()&&t.isSupportedState(goog.ui.Component.State.HOVER)},goog.ui.Container.prototype.setHighlightedIndexFromKeyEvent=function(t){this.setHighlightedIndex(t)},goog.ui.Container.prototype.getOpenItem=function(){return this.openItem_},goog.ui.Container.prototype.isMouseButtonPressed=function(){return this.mouseButtonPressed_},goog.ui.Container.prototype.setMouseButtonPressed=function(t){this.mouseButtonPressed_=t},goog.ui.MenuHeaderRenderer=function(){goog.ui.ControlRenderer.call(this)},goog.inherits(goog.ui.MenuHeaderRenderer,goog.ui.ControlRenderer),goog.addSingletonGetter(goog.ui.MenuHeaderRenderer),goog.ui.MenuHeaderRenderer.CSS_CLASS="goog-menuheader",goog.ui.MenuHeaderRenderer.prototype.getCssClass=function(){return goog.ui.MenuHeaderRenderer.CSS_CLASS},goog.ui.MenuHeader=function(t,e,o){goog.ui.Control.call(this,t,o||goog.ui.MenuHeaderRenderer.getInstance(),e),this.setSupportedState(goog.ui.Component.State.DISABLED,!1),this.setSupportedState(goog.ui.Component.State.HOVER,!1),this.setSupportedState(goog.ui.Component.State.ACTIVE,!1),this.setSupportedState(goog.ui.Component.State.FOCUSED,!1),this.setStateInternal(goog.ui.Component.State.DISABLED)},goog.inherits(goog.ui.MenuHeader,goog.ui.Control),goog.ui.registry.setDecoratorByClassName(goog.ui.MenuHeaderRenderer.CSS_CLASS,function(){return new goog.ui.MenuHeader(null)}),goog.ui.MenuItemRenderer=function(){goog.ui.ControlRenderer.call(this),this.classNameCache_=[]},goog.inherits(goog.ui.MenuItemRenderer,goog.ui.ControlRenderer),goog.addSingletonGetter(goog.ui.MenuItemRenderer),goog.ui.MenuItemRenderer.CSS_CLASS="goog-menuitem",goog.ui.MenuItemRenderer.CompositeCssClassIndex_={HOVER:0,CHECKBOX:1,CONTENT:2},goog.ui.MenuItemRenderer.prototype.getCompositeCssClass_=function(t){var e=this.classNameCache_[t];if(!e){switch(t){case goog.ui.MenuItemRenderer.CompositeCssClassIndex_.HOVER:e=this.getStructuralCssClass()+"-highlight";break;case goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CHECKBOX:e=this.getStructuralCssClass()+"-checkbox";break;case goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CONTENT:e=this.getStructuralCssClass()+"-content"}this.classNameCache_[t]=e}return e},goog.ui.MenuItemRenderer.prototype.getAriaRole=function(){return goog.a11y.aria.Role.MENU_ITEM},goog.ui.MenuItemRenderer.prototype.createDom=function(t){var e=t.getDomHelper().createDom("DIV",this.getClassNames(t).join(" "),this.createContent(t.getContent(),t.getDomHelper()));return this.setEnableCheckBoxStructure(t,e,t.isSupportedState(goog.ui.Component.State.SELECTED)||t.isSupportedState(goog.ui.Component.State.CHECKED)),e},goog.ui.MenuItemRenderer.prototype.getContentElement=function(t){return t&&t.firstChild},goog.ui.MenuItemRenderer.prototype.decorate=function(t,e){return goog.asserts.assert(e),this.hasContentStructure(e)||e.appendChild(this.createContent(e.childNodes,t.getDomHelper())),goog.dom.classlist.contains(e,"goog-option")&&(t.setCheckable(!0),this.setCheckable(t,e,!0)),goog.ui.MenuItemRenderer.superClass_.decorate.call(this,t,e)},goog.ui.MenuItemRenderer.prototype.setContent=function(t,e){var o=this.getContentElement(t),n=this.hasCheckBoxStructure(t)?o.firstChild:null;goog.ui.MenuItemRenderer.superClass_.setContent.call(this,t,e),n&&!this.hasCheckBoxStructure(t)&&o.insertBefore(n,o.firstChild||null)},goog.ui.MenuItemRenderer.prototype.hasContentStructure=function(t){t=goog.dom.getFirstElementChild(t);var e=this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CONTENT);return!!t&&goog.dom.classlist.contains(t,e)},goog.ui.MenuItemRenderer.prototype.createContent=function(t,e){var o=this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CONTENT);return e.createDom("DIV",o,t)},goog.ui.MenuItemRenderer.prototype.setSelectable=function(t,e,o){t&&e&&this.setEnableCheckBoxStructure(t,e,o)},goog.ui.MenuItemRenderer.prototype.setCheckable=function(t,e,o){t&&e&&this.setEnableCheckBoxStructure(t,e,o)},goog.ui.MenuItemRenderer.prototype.hasCheckBoxStructure=function(t){if(t=this.getContentElement(t)){t=t.firstChild;var e=this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CHECKBOX);return!!t&&goog.dom.isElement(t)&&goog.dom.classlist.contains(t,e)}return!1},goog.ui.MenuItemRenderer.prototype.setEnableCheckBoxStructure=function(t,e,o){this.setAriaRole(e,t.getPreferredAriaRole()),this.setAriaStates(t,e),o!=this.hasCheckBoxStructure(e)&&(goog.dom.classlist.enable(e,"goog-option",o),e=this.getContentElement(e),o?(o=this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.CHECKBOX),e.insertBefore(t.getDomHelper().createDom("DIV",o),e.firstChild||null)):e.removeChild(e.firstChild))},goog.ui.MenuItemRenderer.prototype.getClassForState=function(t){switch(t){case goog.ui.Component.State.HOVER:return this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.HOVER);case goog.ui.Component.State.CHECKED:case goog.ui.Component.State.SELECTED:return"goog-option-selected";default:return goog.ui.MenuItemRenderer.superClass_.getClassForState.call(this,t)}},goog.ui.MenuItemRenderer.prototype.getStateFromClass=function(t){var e=this.getCompositeCssClass_(goog.ui.MenuItemRenderer.CompositeCssClassIndex_.HOVER);switch(t){case"goog-option-selected":return goog.ui.Component.State.CHECKED;case e:return goog.ui.Component.State.HOVER;default:return goog.ui.MenuItemRenderer.superClass_.getStateFromClass.call(this,t)}},goog.ui.MenuItemRenderer.prototype.getCssClass=function(){return goog.ui.MenuItemRenderer.CSS_CLASS},goog.ui.MenuItem=function(t,e,o,n){goog.ui.Control.call(this,t,n||goog.ui.MenuItemRenderer.getInstance(),o),this.setValue(e)},goog.inherits(goog.ui.MenuItem,goog.ui.Control),goog.tagUnsealableClass(goog.ui.MenuItem),goog.ui.MenuItem.MNEMONIC_WRAPPER_CLASS_="goog-menuitem-mnemonic-separator",goog.ui.MenuItem.ACCELERATOR_CLASS="goog-menuitem-accel",goog.ui.MenuItem.prototype.getValue=function(){var t=this.getModel();return null!=t?t:this.getCaption()},goog.ui.MenuItem.prototype.setValue=function(t){this.setModel(t)},goog.ui.MenuItem.prototype.setSupportedState=function(t,e){switch(goog.ui.MenuItem.superClass_.setSupportedState.call(this,t,e),t){case goog.ui.Component.State.SELECTED:this.setSelectableInternal_(e);break;case goog.ui.Component.State.CHECKED:this.setCheckableInternal_(e)}},goog.ui.MenuItem.prototype.setSelectable=function(t){this.setSupportedState(goog.ui.Component.State.SELECTED,t)},goog.ui.MenuItem.prototype.setSelectableInternal_=function(t){this.isChecked()&&!t&&this.setChecked(!1);var e=this.getElement();e&&this.getRenderer().setSelectable(this,e,t)},goog.ui.MenuItem.prototype.setCheckable=function(t){this.setSupportedState(goog.ui.Component.State.CHECKED,t)},goog.ui.MenuItem.prototype.setCheckableInternal_=function(t){var e=this.getElement();e&&this.getRenderer().setCheckable(this,e,t)},goog.ui.MenuItem.prototype.getCaption=function(){var t=this.getContent();if(goog.isArray(t)){var e=goog.ui.MenuItem.ACCELERATOR_CLASS,o=goog.ui.MenuItem.MNEMONIC_WRAPPER_CLASS_;return t=goog.array.map(t,function(t){return goog.dom.isElement(t)&&(goog.dom.classlist.contains(t,e)||goog.dom.classlist.contains(t,o))?"":goog.dom.getRawTextContent(t)}).join(""),goog.string.collapseBreakingSpaces(t)}return goog.ui.MenuItem.superClass_.getCaption.call(this)},goog.ui.MenuItem.prototype.getAccelerator=function(){var t=this.getDomHelper(),e=this.getContent();return goog.isArray(e)&&(e=goog.array.find(e,function(t){return goog.dom.classlist.contains(t,goog.ui.MenuItem.ACCELERATOR_CLASS)}))?t.getTextContent(e):null},goog.ui.MenuItem.prototype.handleMouseUp=function(t){var e=this.getParent();if(e){var o=e.openingCoords;if(e.openingCoords=null,o&&goog.isNumber(t.clientX)&&(e=new goog.math.Coordinate(t.clientX,t.clientY),goog.math.Coordinate.equals(o,e)))return}goog.ui.MenuItem.superClass_.handleMouseUp.call(this,t)},goog.ui.MenuItem.prototype.handleKeyEventInternal=function(t){return!(t.keyCode!=this.getMnemonic()||!this.performActionInternal(t))||goog.ui.MenuItem.superClass_.handleKeyEventInternal.call(this,t)},goog.ui.MenuItem.prototype.setMnemonic=function(t){this.mnemonicKey_=t},goog.ui.MenuItem.prototype.getMnemonic=function(){return this.mnemonicKey_},goog.ui.registry.setDecoratorByClassName(goog.ui.MenuItemRenderer.CSS_CLASS,function(){return new goog.ui.MenuItem(null)}),goog.ui.MenuItem.prototype.getPreferredAriaRole=function(){return this.isSupportedState(goog.ui.Component.State.CHECKED)?goog.a11y.aria.Role.MENU_ITEM_CHECKBOX:this.isSupportedState(goog.ui.Component.State.SELECTED)?goog.a11y.aria.Role.MENU_ITEM_RADIO:goog.ui.MenuItem.superClass_.getPreferredAriaRole.call(this)},goog.ui.MenuItem.prototype.getParent=function(){return goog.ui.Control.prototype.getParent.call(this)},goog.ui.MenuItem.prototype.getParentEventTarget=function(){return goog.ui.Control.prototype.getParentEventTarget.call(this)},goog.ui.MenuSeparatorRenderer=function(){goog.ui.ControlRenderer.call(this)},goog.inherits(goog.ui.MenuSeparatorRenderer,goog.ui.ControlRenderer),goog.addSingletonGetter(goog.ui.MenuSeparatorRenderer),goog.ui.MenuSeparatorRenderer.CSS_CLASS="goog-menuseparator",goog.ui.MenuSeparatorRenderer.prototype.createDom=function(t){return t.getDomHelper().createDom("DIV",this.getCssClass())},goog.ui.MenuSeparatorRenderer.prototype.decorate=function(t,e){if(e.id&&t.setId(e.id),"HR"==e.tagName){var o=e;e=this.createDom(t),goog.dom.insertSiblingBefore(e,o),goog.dom.removeNode(o)}else goog.dom.classlist.add(e,this.getCssClass());return e},goog.ui.MenuSeparatorRenderer.prototype.setContent=function(t,e){},goog.ui.MenuSeparatorRenderer.prototype.getCssClass=function(){return goog.ui.MenuSeparatorRenderer.CSS_CLASS},goog.ui.Separator=function(t,e){goog.ui.Control.call(this,null,t||goog.ui.MenuSeparatorRenderer.getInstance(),e),this.setSupportedState(goog.ui.Component.State.DISABLED,!1),this.setSupportedState(goog.ui.Component.State.HOVER,!1),this.setSupportedState(goog.ui.Component.State.ACTIVE,!1),this.setSupportedState(goog.ui.Component.State.FOCUSED,!1),this.setStateInternal(goog.ui.Component.State.DISABLED)},goog.inherits(goog.ui.Separator,goog.ui.Control),goog.ui.Separator.prototype.enterDocument=function(){goog.ui.Separator.superClass_.enterDocument.call(this);var t=this.getElement();goog.asserts.assert(t,"The DOM element for the separator cannot be null."),goog.a11y.aria.setRole(t,"separator")},goog.ui.registry.setDecoratorByClassName(goog.ui.MenuSeparatorRenderer.CSS_CLASS,function(){return new goog.ui.Separator}),goog.ui.MenuRenderer=function(t){goog.ui.ContainerRenderer.call(this,t||goog.a11y.aria.Role.MENU)},goog.inherits(goog.ui.MenuRenderer,goog.ui.ContainerRenderer),goog.addSingletonGetter(goog.ui.MenuRenderer),goog.ui.MenuRenderer.CSS_CLASS="goog-menu",goog.ui.MenuRenderer.prototype.canDecorate=function(t){return"UL"==t.tagName||goog.ui.MenuRenderer.superClass_.canDecorate.call(this,t)},goog.ui.MenuRenderer.prototype.getDecoratorForChild=function(t){return"HR"==t.tagName?new goog.ui.Separator:goog.ui.MenuRenderer.superClass_.getDecoratorForChild.call(this,t)},goog.ui.MenuRenderer.prototype.containsElement=function(t,e){return goog.dom.contains(t.getElement(),e)},goog.ui.MenuRenderer.prototype.getCssClass=function(){return goog.ui.MenuRenderer.CSS_CLASS},goog.ui.MenuRenderer.prototype.initializeDom=function(t){goog.ui.MenuRenderer.superClass_.initializeDom.call(this,t),t=t.getElement(),goog.asserts.assert(t,"The menu DOM element cannot be null."),goog.a11y.aria.setState(t,goog.a11y.aria.State.HASPOPUP,"true")},goog.ui.MenuSeparator=function(t){goog.ui.Separator.call(this,goog.ui.MenuSeparatorRenderer.getInstance(),t)},goog.inherits(goog.ui.MenuSeparator,goog.ui.Separator),goog.ui.registry.setDecoratorByClassName(goog.ui.MenuSeparatorRenderer.CSS_CLASS,function(){return new goog.ui.Separator}),goog.ui.Menu=function(t,e){goog.ui.Container.call(this,goog.ui.Container.Orientation.VERTICAL,e||goog.ui.MenuRenderer.getInstance(),t),this.setFocusable(!1)},goog.inherits(goog.ui.Menu,goog.ui.Container),goog.tagUnsealableClass(goog.ui.Menu),goog.ui.Menu.EventType={BEFORE_SHOW:goog.ui.Component.EventType.BEFORE_SHOW,SHOW:goog.ui.Component.EventType.SHOW,BEFORE_HIDE:goog.ui.Component.EventType.HIDE,HIDE:goog.ui.Component.EventType.HIDE},goog.ui.Menu.CSS_CLASS=goog.ui.MenuRenderer.CSS_CLASS,goog.ui.Menu.prototype.allowAutoFocus_=!0,goog.ui.Menu.prototype.allowHighlightDisabled_=!1,goog.ui.Menu.prototype.getCssClass=function(){return this.getRenderer().getCssClass()},goog.ui.Menu.prototype.containsElement=function(t){if(this.getRenderer().containsElement(this,t))return!0;for(var e=0,o=this.getChildCount();e<o;e++){var n=this.getChildAt(e);if("function"==typeof n.containsElement&&n.containsElement(t))return!0}return!1},goog.ui.Menu.prototype.addItem=function(t){this.addChild(t,!0)},goog.ui.Menu.prototype.addItemAt=function(t,e){this.addChildAt(t,e,!0)},goog.ui.Menu.prototype.removeItem=function(t){(t=this.removeChild(t,!0))&&t.dispose()},goog.ui.Menu.prototype.removeItemAt=function(t){(t=this.removeChildAt(t,!0))&&t.dispose()},goog.ui.Menu.prototype.getItemAt=function(t){return this.getChildAt(t)},goog.ui.Menu.prototype.getItemCount=function(){return this.getChildCount()},goog.ui.Menu.prototype.getItems=function(){var t=[];return this.forEachChild(function(e){t.push(e)}),t},goog.ui.Menu.prototype.setPosition=function(t,e){var o=this.isVisible();o||goog.style.setElementShown(this.getElement(),!0),goog.style.setPageOffset(this.getElement(),t,e),o||goog.style.setElementShown(this.getElement(),!1)},goog.ui.Menu.prototype.getPosition=function(){return this.isVisible()?goog.style.getPageOffset(this.getElement()):null},goog.ui.Menu.prototype.setAllowAutoFocus=function(t){(this.allowAutoFocus_=t)&&this.setFocusable(!0)};goog.ui.Menu.prototype.getAllowAutoFocus=function(){return this.allowAutoFocus_},goog.ui.Menu.prototype.setAllowHighlightDisabled=function(t){this.allowHighlightDisabled_=t},goog.ui.Menu.prototype.getAllowHighlightDisabled=function(){return this.allowHighlightDisabled_},goog.ui.Menu.prototype.setVisible=function(t,e,o){return(e=goog.ui.Menu.superClass_.setVisible.call(this,t,e))&&t&&this.isInDocument()&&this.allowAutoFocus_&&this.getKeyEventTarget().focus(),t&&o&&goog.isNumber(o.clientX)?this.openingCoords=new goog.math.Coordinate(o.clientX,o.clientY):this.openingCoords=null,e},goog.ui.Menu.prototype.handleEnterItem=function(t){return this.allowAutoFocus_&&this.getKeyEventTarget().focus(),goog.ui.Menu.superClass_.handleEnterItem.call(this,t)},goog.ui.Menu.prototype.highlightNextPrefix=function(t){var e=new RegExp("^"+goog.string.regExpEscape(t),"i");return this.highlightHelper(function(t,o){var n=0>t?0:t,i=!1;do{++t,t==o&&(t=0,i=!0);var r=this.getChildAt(t).getCaption();if(r&&r.match(e))return t}while(!i||t!=n);return this.getHighlightedIndex()},this.getHighlightedIndex())},goog.ui.Menu.prototype.canHighlightItem=function(t){return(this.allowHighlightDisabled_||t.isEnabled())&&t.isVisible()&&t.isSupportedState(goog.ui.Component.State.HOVER)},goog.ui.Menu.prototype.decorateInternal=function(t){this.decorateContent(t),goog.ui.Menu.superClass_.decorateInternal.call(this,t)},goog.ui.Menu.prototype.handleKeyEventInternal=function(t){var e=goog.ui.Menu.superClass_.handleKeyEventInternal.call(this,t);return e||this.forEachChild(function(o){!e&&o.getMnemonic&&o.getMnemonic()==t.keyCode&&(this.isEnabled()&&this.setHighlighted(o),e=o.handleKeyEvent(t))},this),e},goog.ui.Menu.prototype.setHighlightedIndex=function(t){goog.ui.Menu.superClass_.setHighlightedIndex.call(this,t),(t=this.getChildAt(t))&&goog.style.scrollIntoContainerView(t.getElement(),this.getElement())},goog.ui.Menu.prototype.decorateContent=function(t){var e=this.getRenderer();t=this.getDomHelper().getElementsByTagNameAndClass("DIV",e.getCssClass()+"-content",t);for(var o=t.length,n=0;n<o;n++)e.decorateChildren(this,t[n])},goog.iter={},goog.iter.StopIteration="StopIteration"in goog.global?goog.global.StopIteration:{message:"StopIteration",stack:""},goog.iter.Iterator=function(){},goog.iter.Iterator.prototype.next=function(){throw goog.iter.StopIteration},goog.iter.Iterator.prototype.__iterator__=function(t){return this},goog.iter.toIterator=function(t){if(t instanceof goog.iter.Iterator)return t;if("function"==typeof t.__iterator__)return t.__iterator__(!1);if(goog.isArrayLike(t)){var e=0,o=new goog.iter.Iterator;return o.next=function(){for(;;){if(e>=t.length)throw goog.iter.StopIteration;if(e in t)return t[e++];e++}},o}throw Error("Not implemented")},goog.iter.forEach=function(t,e,o){if(goog.isArrayLike(t))try{goog.array.forEach(t,e,o)}catch(t){if(t!==goog.iter.StopIteration)throw t}else{t=goog.iter.toIterator(t);try{for(;;)e.call(o,t.next(),void 0,t)}catch(t){if(t!==goog.iter.StopIteration)throw t}}},goog.iter.filter=function(t,e,o){var n=goog.iter.toIterator(t);return t=new goog.iter.Iterator,t.next=function(){for(;;){var t=n.next();if(e.call(o,t,void 0,n))return t}},t},goog.iter.filterFalse=function(t,e,o){return goog.iter.filter(t,goog.functions.not(e),o)},goog.iter.range=function(t,e,o){var n=0,i=t,r=o||1;if(1<arguments.length&&(n=t,i=e),0==r)throw Error("Range step argument must not be zero");var s=new goog.iter.Iterator;return s.next=function(){if(0<r&&n>=i||0>r&&n<=i)throw goog.iter.StopIteration;var t=n;return n+=r,t},s},goog.iter.join=function(t,e){return goog.iter.toArray(t).join(e)},goog.iter.map=function(t,e,o){var n=goog.iter.toIterator(t);return t=new goog.iter.Iterator,t.next=function(){var t=n.next();return e.call(o,t,void 0,n)},t},goog.iter.reduce=function(t,e,o,n){var i=o;return goog.iter.forEach(t,function(t){i=e.call(n,i,t)}),i},goog.iter.some=function(t,e,o){t=goog.iter.toIterator(t);try{for(;;)if(e.call(o,t.next(),void 0,t))return!0}catch(t){if(t!==goog.iter.StopIteration)throw t}return!1},goog.iter.every=function(t,e,o){t=goog.iter.toIterator(t);try{for(;;)if(!e.call(o,t.next(),void 0,t))return!1}catch(t){if(t!==goog.iter.StopIteration)throw t}return!0},goog.iter.chain=function(t){return goog.iter.chainFromIterable(arguments)},goog.iter.chainFromIterable=function(t){var e=goog.iter.toIterator(t);t=new goog.iter.Iterator;var o=null;return t.next=function(){for(;;){if(null==o){var t=e.next();o=goog.iter.toIterator(t)}try{return o.next()}catch(t){if(t!==goog.iter.StopIteration)throw t;o=null}}},t},goog.iter.dropWhile=function(t,e,o){var n=goog.iter.toIterator(t);t=new goog.iter.Iterator;var i=!0;return t.next=function(){for(;;){var t=n.next();if(!i||!e.call(o,t,void 0,n))return i=!1,t}},t},goog.iter.takeWhile=function(t,e,o){var n=goog.iter.toIterator(t);return t=new goog.iter.Iterator,t.next=function(){var t=n.next();if(e.call(o,t,void 0,n))return t;throw goog.iter.StopIteration},t},goog.iter.toArray=function(t){if(goog.isArrayLike(t))return goog.array.toArray(t);t=goog.iter.toIterator(t);var e=[];return goog.iter.forEach(t,function(t){e.push(t)}),e},goog.iter.equals=function(t,e,o){t=goog.iter.zipLongest({},t,e);var n=o||goog.array.defaultCompareEquality;return goog.iter.every(t,function(t){return n(t[0],t[1])})},goog.iter.nextOrValue=function(t,e){try{return goog.iter.toIterator(t).next()}catch(t){if(t!=goog.iter.StopIteration)throw t;return e}},goog.iter.product=function(t){if(goog.array.some(arguments,function(t){return!t.length})||!arguments.length)return new goog.iter.Iterator;var e=new goog.iter.Iterator,o=arguments,n=goog.array.repeat(0,o.length);return e.next=function(){if(n){for(var t=goog.array.map(n,function(t,e){return o[e][t]}),e=n.length-1;0<=e;e--){if(goog.asserts.assert(n),n[e]<o[e].length-1){n[e]++;break}if(0==e){n=null;break}n[e]=0}return t}throw goog.iter.StopIteration},e},goog.iter.cycle=function(t){var e=goog.iter.toIterator(t),o=[],n=0;t=new goog.iter.Iterator;var i=!1;return t.next=function(){var t=null;if(!i)try{return t=e.next(),o.push(t),t}catch(t){if(t!=goog.iter.StopIteration||goog.array.isEmpty(o))throw t;i=!0}return t=o[n],n=(n+1)%o.length,t},t},goog.iter.count=function(t,e){var o=t||0,n=goog.isDef(e)?e:1,i=new goog.iter.Iterator;return i.next=function(){var t=o;return o+=n,t},i},goog.iter.repeat=function(t){var e=new goog.iter.Iterator;return e.next=goog.functions.constant(t),e},goog.iter.accumulate=function(t){var e=goog.iter.toIterator(t),o=0;return t=new goog.iter.Iterator,t.next=function(){return o+=e.next()},t},goog.iter.zip=function(t){var e=arguments,o=new goog.iter.Iterator;if(0<e.length){var n=goog.array.map(e,goog.iter.toIterator);o.next=function(){return goog.array.map(n,function(t){return t.next()})}}return o},goog.iter.zipLongest=function(t,e){var o=goog.array.slice(arguments,1),n=new goog.iter.Iterator;if(0<o.length){var i=goog.array.map(o,goog.iter.toIterator);n.next=function(){var e=!1,o=goog.array.map(i,function(o){try{var n=o.next();e=!0}catch(e){if(e!==goog.iter.StopIteration)throw e;n=t}return n});if(!e)throw goog.iter.StopIteration;return o}}return n},goog.iter.compress=function(t,e){var o=goog.iter.toIterator(e);return goog.iter.filter(t,function(){return!!o.next()})},goog.iter.GroupByIterator_=function(t,e){this.iterator=goog.iter.toIterator(t),this.keyFunc=e||goog.functions.identity},goog.inherits(goog.iter.GroupByIterator_,goog.iter.Iterator),goog.iter.GroupByIterator_.prototype.next=function(){for(;this.currentKey==this.targetKey;)this.currentValue=this.iterator.next(),this.currentKey=this.keyFunc(this.currentValue);return this.targetKey=this.currentKey,[this.currentKey,this.groupItems_(this.targetKey)]},goog.iter.GroupByIterator_.prototype.groupItems_=function(t){for(var e=[];this.currentKey==t;){e.push(this.currentValue);try{this.currentValue=this.iterator.next()}catch(t){if(t!==goog.iter.StopIteration)throw t;break}this.currentKey=this.keyFunc(this.currentValue)}return e},goog.iter.groupBy=function(t,e){return new goog.iter.GroupByIterator_(t,e)},goog.iter.starMap=function(t,e,o){var n=goog.iter.toIterator(t);return t=new goog.iter.Iterator,t.next=function(){var t=goog.iter.toArray(n.next());return e.apply(o,goog.array.concat(t,void 0,n))},t},goog.iter.tee=function(t,e){var o=goog.iter.toIterator(t),n=goog.isNumber(e)?e:2,i=goog.array.map(goog.array.range(n),function(){return[]}),r=function(){var t=o.next();goog.array.forEach(i,function(e){e.push(t)})};return goog.array.map(i,function(t){var e=new goog.iter.Iterator;return e.next=function(){return goog.array.isEmpty(t)&&r(),goog.asserts.assert(!goog.array.isEmpty(t)),t.shift()},e})},goog.iter.enumerate=function(t,e){return goog.iter.zip(goog.iter.count(e),t)},goog.iter.limit=function(t,e){goog.asserts.assert(goog.math.isInt(e)&&0<=e);var o=goog.iter.toIterator(t),n=new goog.iter.Iterator,i=e;return n.next=function(){if(0<i--)return o.next();throw goog.iter.StopIteration},n},goog.iter.consume=function(t,e){goog.asserts.assert(goog.math.isInt(e)&&0<=e);for(var o=goog.iter.toIterator(t);0<e--;)goog.iter.nextOrValue(o,null);return o},goog.iter.slice=function(t,e,o){return goog.asserts.assert(goog.math.isInt(e)&&0<=e),t=goog.iter.consume(t,e),goog.isNumber(o)&&(goog.asserts.assert(goog.math.isInt(o)&&o>=e),t=goog.iter.limit(t,o-e)),t},goog.iter.hasDuplicates_=function(t){var e=[];return goog.array.removeDuplicates(t,e),t.length!=e.length},goog.iter.permutations=function(t,e){var o=goog.iter.toArray(t),n=goog.isNumber(e)?e:o.length;return o=goog.array.repeat(o,n),o=goog.iter.product.apply(void 0,o),goog.iter.filter(o,function(t){return!goog.iter.hasDuplicates_(t)})},goog.iter.combinations=function(t,e){function o(t){return n[t]}var n=goog.iter.toArray(t),i=goog.iter.range(n.length);i=goog.iter.permutations(i,e);var r=goog.iter.filter(i,function(t){return goog.array.isSorted(t)});return i=new goog.iter.Iterator,i.next=function(){return goog.array.map(r.next(),o)},i},goog.iter.combinationsWithReplacement=function(t,e){function o(t){return n[t]}var n=goog.iter.toArray(t),i=goog.array.range(n.length);i=goog.array.repeat(i,e),i=goog.iter.product.apply(void 0,i);var r=goog.iter.filter(i,function(t){return goog.array.isSorted(t)});return i=new goog.iter.Iterator,i.next=function(){return goog.array.map(r.next(),o)},i},goog.dom.TagWalkType={START_TAG:1,OTHER:0,END_TAG:-1},goog.dom.TagIterator=function(t,e,o,n,i){this.reversed=!!e,this.node=null,this.tagType=goog.dom.TagWalkType.OTHER,this.started_=!1,this.constrained=!o,t&&this.setPosition(t,n),this.depth=void 0!=i?i:this.tagType||0,this.reversed&&(this.depth*=-1)},goog.inherits(goog.dom.TagIterator,goog.iter.Iterator),goog.dom.TagIterator.prototype.setPosition=function(t,e,o){(this.node=t)&&(goog.isNumber(e)?this.tagType=e:this.tagType=this.node.nodeType!=goog.dom.NodeType.ELEMENT?goog.dom.TagWalkType.OTHER:this.reversed?goog.dom.TagWalkType.END_TAG:goog.dom.TagWalkType.START_TAG),goog.isNumber(o)&&(this.depth=o)},goog.dom.TagIterator.prototype.copyFrom=function(t){this.node=t.node,this.tagType=t.tagType,this.depth=t.depth,this.reversed=t.reversed,this.constrained=t.constrained},goog.dom.TagIterator.prototype.clone=function(){return new goog.dom.TagIterator(this.node,this.reversed,!this.constrained,this.tagType,this.depth)},goog.dom.TagIterator.prototype.skipTag=function(){var t=this.reversed?goog.dom.TagWalkType.END_TAG:goog.dom.TagWalkType.START_TAG;this.tagType==t&&(this.tagType=-1*t,this.depth+=this.tagType*(this.reversed?-1:1))},goog.dom.TagIterator.prototype.restartTag=function(){var t=this.reversed?goog.dom.TagWalkType.START_TAG:goog.dom.TagWalkType.END_TAG;this.tagType==t&&(this.tagType=-1*t,this.depth+=this.tagType*(this.reversed?-1:1))},goog.dom.TagIterator.prototype.next=function(){if(this.started_){if(!this.node||this.constrained&&0==this.depth)throw goog.iter.StopIteration;var t=this.node,e=this.reversed?goog.dom.TagWalkType.END_TAG:goog.dom.TagWalkType.START_TAG;if(this.tagType==e){var o=this.reversed?t.lastChild:t.firstChild;o?this.setPosition(o):this.setPosition(t,-1*e)}else(o=this.reversed?t.previousSibling:t.nextSibling)?this.setPosition(o):this.setPosition(t.parentNode,-1*e);this.depth+=this.tagType*(this.reversed?-1:1)}else this.started_=!0;if(t=this.node,!this.node)throw goog.iter.StopIteration;return t},goog.dom.TagIterator.prototype.isStarted=function(){return this.started_},goog.dom.TagIterator.prototype.isStartTag=function(){return this.tagType==goog.dom.TagWalkType.START_TAG},goog.dom.TagIterator.prototype.isEndTag=function(){return this.tagType==goog.dom.TagWalkType.END_TAG},goog.dom.TagIterator.prototype.isNonElement=function(){return this.tagType==goog.dom.TagWalkType.OTHER},goog.dom.TagIterator.prototype.equals=function(t){return t.node==this.node&&(!this.node||t.tagType==this.tagType)},goog.dom.TagIterator.prototype.splice=function(t){var e=this.node;this.restartTag(),this.reversed=!this.reversed,goog.dom.TagIterator.prototype.next.call(this),this.reversed=!this.reversed;for(var o=goog.isArrayLike(arguments[0])?arguments[0]:arguments,n=o.length-1;0<=n;n--)goog.dom.insertSiblingAfter(o[n],e);goog.dom.removeNode(e)},goog.dom.NodeIterator=function(t,e,o,n){goog.dom.TagIterator.call(this,t,e,o,null,n)},goog.inherits(goog.dom.NodeIterator,goog.dom.TagIterator),goog.dom.NodeIterator.prototype.next=function(){do{goog.dom.NodeIterator.superClass_.next.call(this)}while(this.isEndTag());return this.node},goog.ui.PaletteRenderer=function(){goog.ui.ControlRenderer.call(this)},goog.inherits(goog.ui.PaletteRenderer,goog.ui.ControlRenderer),goog.addSingletonGetter(goog.ui.PaletteRenderer),goog.ui.PaletteRenderer.cellId_=0,goog.ui.PaletteRenderer.CSS_CLASS="goog-palette",goog.ui.PaletteRenderer.prototype.createDom=function(t){var e=this.getClassNames(t);return t=t.getDomHelper().createDom("DIV",e,this.createGrid(t.getContent(),t.getSize(),t.getDomHelper())),goog.a11y.aria.setRole(t,goog.a11y.aria.Role.GRID),t},goog.ui.PaletteRenderer.prototype.createGrid=function(t,e,o){for(var n=[],i=0,r=0;i<e.height;i++){for(var s=[],a=0;a<e.width;a++){var l=t&&t[r++];s.push(this.createCell(l,o))}n.push(this.createRow(s,o))}return this.createTable(n,o)},goog.ui.PaletteRenderer.prototype.createTable=function(t,e){var o=e.createDom("TABLE",this.getCssClass()+"-table",e.createDom("TBODY",this.getCssClass()+"-body",t));return o.cellSpacing="0",o.cellPadding="0",o},goog.ui.PaletteRenderer.prototype.createRow=function(t,e){var o=e.createDom("TR",this.getCssClass()+"-row",t);return goog.a11y.aria.setRole(o,goog.a11y.aria.Role.ROW),o},goog.ui.PaletteRenderer.prototype.createCell=function(t,e){var o=e.createDom("TD",{class:this.getCssClass()+"-cell",id:this.getCssClass()+"-cell-"+goog.ui.PaletteRenderer.cellId_++},t);if(goog.a11y.aria.setRole(o,goog.a11y.aria.Role.GRIDCELL),goog.a11y.aria.setState(o,goog.a11y.aria.State.SELECTED,!1),!goog.dom.getTextContent(o)&&!goog.a11y.aria.getLabel(o)){var n=this.findAriaLabelForCell_(o);n&&goog.a11y.aria.setLabel(o,n)}return o},goog.ui.PaletteRenderer.prototype.findAriaLabelForCell_=function(t){t=new goog.dom.NodeIterator(t);for(var e,o="";!o&&(e=goog.iter.nextOrValue(t,null));)e.nodeType==goog.dom.NodeType.ELEMENT&&(o=goog.a11y.aria.getLabel(e)||e.title);return o},goog.ui.PaletteRenderer.prototype.canDecorate=function(t){return!1},goog.ui.PaletteRenderer.prototype.decorate=function(t,e){return null},goog.ui.PaletteRenderer.prototype.setContent=function(t,e){if(t){var o=goog.dom.getElementsByTagNameAndClass("TBODY",this.getCssClass()+"-body",t)[0];if(o){var n=0;if(goog.array.forEach(o.rows,function(t){goog.array.forEach(t.cells,function(t){if(goog.dom.removeChildren(t),e){var o=e[n++];o&&goog.dom.appendChild(t,o)}})}),n<e.length){for(var i=[],r=goog.dom.getDomHelper(t),s=o.rows[0].cells.length;n<e.length;){var a=e[n++];i.push(this.createCell(a,r)),i.length==s&&(a=this.createRow(i,r),goog.dom.appendChild(o,a),i.length=0)}if(0<i.length){for(;i.length<s;)i.push(this.createCell("",r));a=this.createRow(i,r),goog.dom.appendChild(o,a)}}}goog.style.setUnselectable(t,!0,goog.userAgent.GECKO)}},goog.ui.PaletteRenderer.prototype.getContainingItem=function(t,e){for(var o=t.getElement();e&&e.nodeType==goog.dom.NodeType.ELEMENT&&e!=o;){if("TD"==e.tagName&&goog.dom.classlist.contains(e,this.getCssClass()+"-cell"))return e.firstChild;e=e.parentNode}return null},goog.ui.PaletteRenderer.prototype.highlightCell=function(t,e,o){e&&(e=this.getCellForItem(e),goog.asserts.assert(e),goog.dom.classlist.enable(e,this.getCssClass()+"-cell-hover",o),o?goog.a11y.aria.setState(t.getElementStrict(),goog.a11y.aria.State.ACTIVEDESCENDANT,e.id):e.id==goog.a11y.aria.getState(t.getElementStrict(),goog.a11y.aria.State.ACTIVEDESCENDANT)&&goog.a11y.aria.removeState(t.getElementStrict(),goog.a11y.aria.State.ACTIVEDESCENDANT))},goog.ui.PaletteRenderer.prototype.getCellForItem=function(t){return t?t.parentNode:null},goog.ui.PaletteRenderer.prototype.selectCell=function(t,e,o){e&&(t=e.parentNode,goog.dom.classlist.enable(t,this.getCssClass()+"-cell-selected",o),goog.a11y.aria.setState(t,goog.a11y.aria.State.SELECTED,o))},goog.ui.PaletteRenderer.prototype.getCssClass=function(){return goog.ui.PaletteRenderer.CSS_CLASS},goog.ui.SelectionModel=function(t){goog.events.EventTarget.call(this),this.items_=[],this.addItems(t)},goog.inherits(goog.ui.SelectionModel,goog.events.EventTarget),goog.tagUnsealableClass(goog.ui.SelectionModel),goog.ui.SelectionModel.prototype.selectedItem_=null,goog.ui.SelectionModel.prototype.selectionHandler_=null,goog.ui.SelectionModel.prototype.getSelectionHandler=function(){return this.selectionHandler_},goog.ui.SelectionModel.prototype.setSelectionHandler=function(t){this.selectionHandler_=t},goog.ui.SelectionModel.prototype.getItemCount=function(){return this.items_.length},goog.ui.SelectionModel.prototype.indexOfItem=function(t){return t?goog.array.indexOf(this.items_,t):-1},goog.ui.SelectionModel.prototype.getFirst=function(){return this.items_[0]},goog.ui.SelectionModel.prototype.getLast=function(){return this.items_[this.items_.length-1]},goog.ui.SelectionModel.prototype.getItemAt=function(t){return this.items_[t]||null},goog.ui.SelectionModel.prototype.addItems=function(t){t&&(goog.array.forEach(t,function(t){this.selectItem_(t,!1)},this),goog.array.extend(this.items_,t))},goog.ui.SelectionModel.prototype.addItem=function(t){this.addItemAt(t,this.getItemCount())},goog.ui.SelectionModel.prototype.addItemAt=function(t,e){t&&(this.selectItem_(t,!1),goog.array.insertAt(this.items_,t,e))},goog.ui.SelectionModel.prototype.removeItem=function(t){t&&goog.array.remove(this.items_,t)&&t==this.selectedItem_&&(this.selectedItem_=null,this.dispatchEvent(goog.events.EventType.SELECT))},goog.ui.SelectionModel.prototype.removeItemAt=function(t){this.removeItem(this.getItemAt(t))},goog.ui.SelectionModel.prototype.getSelectedItem=function(){return this.selectedItem_},goog.ui.SelectionModel.prototype.getItems=function(){return goog.array.clone(this.items_)},goog.ui.SelectionModel.prototype.setSelectedItem=function(t){t!=this.selectedItem_&&(this.selectItem_(this.selectedItem_,!1),this.selectedItem_=t,this.selectItem_(t,!0)),this.dispatchEvent(goog.events.EventType.SELECT)},goog.ui.SelectionModel.prototype.getSelectedIndex=function(){return this.indexOfItem(this.selectedItem_)},goog.ui.SelectionModel.prototype.setSelectedIndex=function(t){this.setSelectedItem(this.getItemAt(t))},goog.ui.SelectionModel.prototype.clear=function(){goog.array.clear(this.items_),this.selectedItem_=null},goog.ui.SelectionModel.prototype.disposeInternal=function(){goog.ui.SelectionModel.superClass_.disposeInternal.call(this),delete this.items_,this.selectedItem_=null},goog.ui.SelectionModel.prototype.selectItem_=function(t,e){t&&("function"==typeof this.selectionHandler_?this.selectionHandler_(t,e):"function"==typeof t.setSelected&&t.setSelected(e))},goog.ui.Palette=function(t,e,o){goog.ui.Control.call(this,t,e||goog.ui.PaletteRenderer.getInstance(),o),this.setAutoStates(goog.ui.Component.State.CHECKED|goog.ui.Component.State.SELECTED|goog.ui.Component.State.OPENED,!1),this.currentCellControl_=new goog.ui.Palette.CurrentCell_,this.currentCellControl_.setParentEventTarget(this),this.lastHighlightedIndex_=-1},goog.inherits(goog.ui.Palette,goog.ui.Control),goog.tagUnsealableClass(goog.ui.Palette),goog.ui.Palette.EventType={AFTER_HIGHLIGHT:goog.events.getUniqueId("afterhighlight")},goog.ui.Palette.prototype.size_=null,goog.ui.Palette.prototype.highlightedIndex_=-1,goog.ui.Palette.prototype.selectionModel_=null,goog.ui.Palette.prototype.disposeInternal=function(){goog.ui.Palette.superClass_.disposeInternal.call(this),this.selectionModel_&&(this.selectionModel_.dispose(),this.selectionModel_=null),this.size_=null,this.currentCellControl_.dispose()},goog.ui.Palette.prototype.setContentInternal=function(t){goog.ui.Palette.superClass_.setContentInternal.call(this,t),this.adjustSize_(),this.selectionModel_?(this.selectionModel_.clear(),this.selectionModel_.addItems(t)):(this.selectionModel_=new goog.ui.SelectionModel(t),this.selectionModel_.setSelectionHandler(goog.bind(this.selectItem_,this)),this.getHandler().listen(this.selectionModel_,goog.events.EventType.SELECT,this.handleSelectionChange)),this.highlightedIndex_=-1},goog.ui.Palette.prototype.getCaption=function(){return""},goog.ui.Palette.prototype.setCaption=function(t){},goog.ui.Palette.prototype.handleMouseOver=function(t){goog.ui.Palette.superClass_.handleMouseOver.call(this,t);var e=this.getRenderer().getContainingItem(this,t.target);e&&t.relatedTarget&&goog.dom.contains(e,t.relatedTarget)||e!=this.getHighlightedItem()&&this.setHighlightedItem(e)},goog.ui.Palette.prototype.handleMouseDown=function(t){goog.ui.Palette.superClass_.handleMouseDown.call(this,t),this.isActive()&&(t=this.getRenderer().getContainingItem(this,t.target))!=this.getHighlightedItem()&&this.setHighlightedItem(t)},goog.ui.Palette.prototype.performActionInternal=function(t){var e=this.getHighlightedItem();return!!e&&(t&&this.shouldSelectHighlightedItem_(t)&&this.setSelectedItem(e),goog.ui.Palette.superClass_.performActionInternal.call(this,t))},goog.ui.Palette.prototype.shouldSelectHighlightedItem_=function(t){return!this.getSelectedItem()||("mouseup"!=t.type||!!this.getRenderer().getContainingItem(this,t.target))},goog.ui.Palette.prototype.handleKeyEvent=function(t){var e=this.getContent();e=e?e.length:0;var o=this.size_.width;if(0==e||!this.isEnabled())return!1;if(t.keyCode==goog.events.KeyCodes.ENTER||t.keyCode==goog.events.KeyCodes.SPACE)return this.performActionInternal(t);if(t.keyCode==goog.events.KeyCodes.HOME)return this.setHighlightedIndex(0),!0;if(t.keyCode==goog.events.KeyCodes.END)return this.setHighlightedIndex(e-1),!0;var n=0>this.highlightedIndex_?this.getSelectedIndex():this.highlightedIndex_;switch(t.keyCode){case goog.events.KeyCodes.LEFT:return-1!=n&&0!=n||(n=e),this.setHighlightedIndex(n-1),t.preventDefault(),!0;case goog.events.KeyCodes.RIGHT:return n==e-1&&(n=-1),this.setHighlightedIndex(n+1),t.preventDefault(),!0;case goog.events.KeyCodes.UP:if(-1==n&&(n=e+o-1),n>=o)return this.setHighlightedIndex(n-o),t.preventDefault(),!0;break;case goog.events.KeyCodes.DOWN:if(-1==n&&(n=-o),n<e-o)return this.setHighlightedIndex(n+o),t.preventDefault(),!0}return!1},goog.ui.Palette.prototype.handleSelectionChange=function(t){},goog.ui.Palette.prototype.getSize=function(){return this.size_},goog.ui.Palette.prototype.setSize=function(t,e){if(this.getElement())throw Error(goog.ui.Component.Error.ALREADY_RENDERED);this.size_=goog.isNumber(t)?new goog.math.Size(t,e):t,this.adjustSize_()},goog.ui.Palette.prototype.getHighlightedIndex=function(){return this.highlightedIndex_},goog.ui.Palette.prototype.getHighlightedItem=function(){var t=this.getContent();return t&&t[this.highlightedIndex_]},goog.ui.Palette.prototype.getHighlightedCellElement_=function(){return this.getRenderer().getCellForItem(this.getHighlightedItem())},goog.ui.Palette.prototype.setHighlightedIndex=function(t){t!=this.highlightedIndex_&&(this.highlightIndex_(this.highlightedIndex_,!1),this.lastHighlightedIndex_=this.highlightedIndex_,this.highlightedIndex_=t,this.highlightIndex_(t,!0),this.dispatchEvent(goog.ui.Palette.EventType.AFTER_HIGHLIGHT))},goog.ui.Palette.prototype.setHighlightedItem=function(t){var e=this.getContent();this.setHighlightedIndex(e&&t?goog.array.indexOf(e,t):-1)},goog.ui.Palette.prototype.getSelectedIndex=function(){return this.selectionModel_?this.selectionModel_.getSelectedIndex():-1},goog.ui.Palette.prototype.getSelectedItem=function(){return this.selectionModel_?this.selectionModel_.getSelectedItem():null},goog.ui.Palette.prototype.setSelectedIndex=function(t){this.selectionModel_&&this.selectionModel_.setSelectedIndex(t)},goog.ui.Palette.prototype.setSelectedItem=function(t){this.selectionModel_&&this.selectionModel_.setSelectedItem(t)},goog.ui.Palette.prototype.highlightIndex_=function(t,e){if(this.getElement()){var o=this.getContent();if(o&&0<=t&&t<o.length){var n=this.getHighlightedCellElement_();this.currentCellControl_.getElement()!=n&&this.currentCellControl_.setElementInternal(n),this.currentCellControl_.tryHighlight(e)&&this.getRenderer().highlightCell(this,o[t],e)}}},goog.ui.Palette.prototype.setHighlighted=function(t){t&&-1==this.highlightedIndex_?this.setHighlightedIndex(-1<this.lastHighlightedIndex_?this.lastHighlightedIndex_:0):t||this.setHighlightedIndex(-1),goog.ui.Palette.superClass_.setHighlighted.call(this,t)},goog.ui.Palette.prototype.selectItem_=function(t,e){this.getElement()&&this.getRenderer().selectCell(this,t,e)},goog.ui.Palette.prototype.adjustSize_=function(){var t=this.getContent();t?this.size_&&this.size_.width?(t=Math.ceil(t.length/this.size_.width),(!goog.isNumber(this.size_.height)||this.size_.height<t)&&(this.size_.height=t)):(t=Math.ceil(Math.sqrt(t.length)),this.size_=new goog.math.Size(t,t)):this.size_=new goog.math.Size(0,0)},goog.ui.Palette.CurrentCell_=function(){goog.ui.Control.call(this,null),this.setDispatchTransitionEvents(goog.ui.Component.State.HOVER,!0)},goog.inherits(goog.ui.Palette.CurrentCell_,goog.ui.Control),goog.ui.Palette.CurrentCell_.prototype.tryHighlight=function(t){return this.setHighlighted(t),this.isHighlighted()==t},goog.ui.ColorPalette=function(t,e,o){this.colors_=t||[],goog.ui.Palette.call(this,null,e||goog.ui.PaletteRenderer.getInstance(),o),this.setColors(this.colors_)},goog.inherits(goog.ui.ColorPalette,goog.ui.Palette),goog.tagUnsealableClass(goog.ui.ColorPalette),goog.ui.ColorPalette.prototype.normalizedColors_=null,goog.ui.ColorPalette.prototype.labels_=null,goog.ui.ColorPalette.prototype.getColors=function(){return this.colors_},goog.ui.ColorPalette.prototype.setColors=function(t,e){this.colors_=t,this.labels_=e||null,this.normalizedColors_=null,this.setContent(this.createColorNodes())},goog.ui.ColorPalette.prototype.getSelectedColor=function(){var t=this.getSelectedItem();return t?(t=goog.style.getStyle(t,"background-color"),goog.ui.ColorPalette.parseColor_(t)):null},goog.ui.ColorPalette.prototype.setSelectedColor=function(t){t=goog.ui.ColorPalette.parseColor_(t),this.normalizedColors_||(this.normalizedColors_=goog.array.map(this.colors_,function(t){return goog.ui.ColorPalette.parseColor_(t)})),this.setSelectedIndex(t?goog.array.indexOf(this.normalizedColors_,t):-1)},goog.ui.ColorPalette.prototype.createColorNodes=function(){return goog.array.map(this.colors_,function(t,e){var o=this.getDomHelper().createDom("DIV",{class:this.getRenderer().getCssClass()+"-colorswatch",style:"background-color:"+t});return o.title=this.labels_&&this.labels_[e]?this.labels_[e]:"#"==t.charAt(0)?"RGB ("+goog.color.hexToRgb(t).join(", ")+")":t,o},this)},goog.ui.ColorPalette.parseColor_=function(t){if(t)try{return goog.color.parse(t).hex}catch(t){}return null},goog.ui.ColorPicker=function(t,e){goog.ui.Component.call(this,t),this.colorPalette_=e||null,this.getHandler().listen(this,goog.ui.Component.EventType.ACTION,this.onColorPaletteAction_)},goog.inherits(goog.ui.ColorPicker,goog.ui.Component),goog.ui.ColorPicker.DEFAULT_NUM_COLS=5,goog.ui.ColorPicker.EventType={CHANGE:"change"},goog.ui.ColorPicker.prototype.focusable_=!0,goog.ui.ColorPicker.prototype.getColors=function(){return this.colorPalette_?this.colorPalette_.getColors():null},goog.ui.ColorPicker.prototype.setColors=function(t){this.colorPalette_?this.colorPalette_.setColors(t):this.createColorPalette_(t)},goog.ui.ColorPicker.prototype.addColors=function(t){this.setColors(t)},goog.ui.ColorPicker.prototype.setSize=function(t){this.colorPalette_||this.createColorPalette_([]),this.colorPalette_.setSize(t)},goog.ui.ColorPicker.prototype.getSize=function(){return this.colorPalette_?this.colorPalette_.getSize():null},goog.ui.ColorPicker.prototype.setColumnCount=function(t){this.setSize(t)},goog.ui.ColorPicker.prototype.getSelectedIndex=function(){return this.colorPalette_?this.colorPalette_.getSelectedIndex():-1},goog.ui.ColorPicker.prototype.setSelectedIndex=function(t){this.colorPalette_&&this.colorPalette_.setSelectedIndex(t)},goog.ui.ColorPicker.prototype.getSelectedColor=function(){return this.colorPalette_?this.colorPalette_.getSelectedColor():null},goog.ui.ColorPicker.prototype.setSelectedColor=function(t){this.colorPalette_&&this.colorPalette_.setSelectedColor(t)},goog.ui.ColorPicker.prototype.isFocusable=function(){return this.focusable_},goog.ui.ColorPicker.prototype.setFocusable=function(t){this.focusable_=t,this.colorPalette_&&this.colorPalette_.setSupportedState(goog.ui.Component.State.FOCUSED,t)},goog.ui.ColorPicker.prototype.canDecorate=function(t){return!1},goog.ui.ColorPicker.prototype.enterDocument=function(){goog.ui.ColorPicker.superClass_.enterDocument.call(this),this.colorPalette_&&this.colorPalette_.render(this.getElement()),this.getElement().unselectable="on"},goog.ui.ColorPicker.prototype.disposeInternal=function(){goog.ui.ColorPicker.superClass_.disposeInternal.call(this),this.colorPalette_&&(this.colorPalette_.dispose(),this.colorPalette_=null)},goog.ui.ColorPicker.prototype.focus=function(){this.colorPalette_&&this.colorPalette_.getElement().focus()},goog.ui.ColorPicker.prototype.onColorPaletteAction_=function(t){t.stopPropagation(),this.dispatchEvent(goog.ui.ColorPicker.EventType.CHANGE)},goog.ui.ColorPicker.prototype.createColorPalette_=function(t){t=new goog.ui.ColorPalette(t,null,this.getDomHelper()),t.setSize(goog.ui.ColorPicker.DEFAULT_NUM_COLS),t.setSupportedState(goog.ui.Component.State.FOCUSED,this.focusable_),this.addChild(t),this.colorPalette_=t,this.isInDocument()&&this.colorPalette_.render(this.getElement())},goog.ui.ColorPicker.createSimpleColorGrid=function(t){return t=new goog.ui.ColorPicker(t),t.setSize(7),t.setColors(goog.ui.ColorPicker.SIMPLE_GRID_COLORS),t},goog.ui.ColorPicker.SIMPLE_GRID_COLORS="#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033".split(" "),goog.events.FocusHandler=function(t){goog.events.EventTarget.call(this),this.element_=t,t=goog.userAgent.IE?"focusout":"blur",this.listenKeyIn_=goog.events.listen(this.element_,goog.userAgent.IE?"focusin":"focus",this,!goog.userAgent.IE),this.listenKeyOut_=goog.events.listen(this.element_,t,this,!goog.userAgent.IE)},goog.inherits(goog.events.FocusHandler,goog.events.EventTarget),goog.events.FocusHandler.EventType={FOCUSIN:"focusin",FOCUSOUT:"focusout"},goog.events.FocusHandler.prototype.handleEvent=function(t){var e=t.getBrowserEvent();e=new goog.events.BrowserEvent(e),e.type="focusin"==t.type||"focus"==t.type?goog.events.FocusHandler.EventType.FOCUSIN:goog.events.FocusHandler.EventType.FOCUSOUT,this.dispatchEvent(e)},goog.events.FocusHandler.prototype.disposeInternal=function(){goog.events.FocusHandler.superClass_.disposeInternal.call(this),goog.events.unlistenByKey(this.listenKeyIn_),goog.events.unlistenByKey(this.listenKeyOut_),delete this.element_},goog.debug.errorcontext={},goog.debug.errorcontext.addErrorContext=function(t,e,o){t[goog.debug.errorcontext.CONTEXT_KEY_]||(t[goog.debug.errorcontext.CONTEXT_KEY_]={}),t[goog.debug.errorcontext.CONTEXT_KEY_][e]=o},goog.debug.errorcontext.getErrorContext=function(t){return t[goog.debug.errorcontext.CONTEXT_KEY_]||{}},goog.debug.errorcontext.CONTEXT_KEY_="__closure__error__context__984382",goog.debug.LOGGING_ENABLED=goog.DEBUG,goog.debug.FORCE_SLOPPY_STACKS=!1;goog.debug.catchErrors=function(t,e,o){o=o||goog.global;var n=o.onerror,i=!!e;goog.userAgent.WEBKIT&&!goog.userAgent.isVersionOrHigher("535.3")&&(i=!i),o.onerror=function(e,o,r,s,a){return n&&n(e,o,r,s,a),t({message:e,fileName:o,line:r,col:s,error:a}),i}},goog.debug.expose=function(t,e){if(void 0===t)return"undefined";if(null==t)return"NULL";var o,n=[];for(o in t)if(e||!goog.isFunction(t[o])){var i=o+" = ";try{i+=t[o]}catch(t){i+="*** "+t+" ***"}n.push(i)}return n.join("\n")},goog.debug.deepExpose=function(t,e){var o=[],n=[],i={},r=function(t,s){var a=s+"  ";try{if(goog.isDef(t))if(goog.isNull(t))o.push("NULL");else if(goog.isString(t))o.push('"'+t.replace(/\n/g,"\n"+s)+'"');else if(goog.isFunction(t))o.push(String(t).replace(/\n/g,"\n"+s));else if(goog.isObject(t)){goog.hasUid(t)||n.push(t);var l=goog.getUid(t);if(i[l])o.push("*** reference loop detected (id="+l+") ***");else{i[l]=!0,o.push("{");for(var c in t)!e&&goog.isFunction(t[c])||(o.push("\n"),o.push(a),o.push(c+" = "),r(t[c],a));o.push("\n"+s+"}"),delete i[l]}}else o.push(t);else o.push("undefined")}catch(t){o.push("*** "+t+" ***")}};r(t,"");for(var s=0;s<n.length;s++)goog.removeUid(n[s]);return o.join("")},goog.debug.exposeArray=function(t){for(var e=[],o=0;o<t.length;o++)goog.isArray(t[o])?e.push(goog.debug.exposeArray(t[o])):e.push(t[o]);return"[ "+e.join(", ")+" ]"},goog.debug.normalizeErrorObject=function(t){var e=goog.getObjectByName("window.location.href");if(goog.isString(t))return{message:t,name:"Unknown error",lineNumber:"Not available",fileName:e,stack:"Not available"};var o=!1;try{var n=t.lineNumber||t.line||"Not available"}catch(t){n="Not available",o=!0}try{var i=t.fileName||t.filename||t.sourceURL||goog.global.$googDebugFname||e}catch(t){i="Not available",o=!0}return!o&&t.lineNumber&&t.fileName&&t.stack&&t.message&&t.name?t:{message:t.message||"Not available",name:t.name||"UnknownError",lineNumber:n,fileName:i,stack:t.stack||"Not available"}},goog.debug.enhanceError=function(t,e){if(t instanceof Error)var o=t;else o=Error(t),Error.captureStackTrace&&Error.captureStackTrace(o,goog.debug.enhanceError);if(o.stack||(o.stack=goog.debug.getStacktrace(goog.debug.enhanceError)),e){for(var n=0;o["message"+n];)++n;o["message"+n]=String(e)}return o},goog.debug.enhanceErrorWithContext=function(t,e){var o=goog.debug.enhanceError(t);if(e)for(var n in e)goog.debug.errorcontext.addErrorContext(o,n,e[n]);return o},goog.debug.getStacktraceSimple=function(t){if(!goog.debug.FORCE_SLOPPY_STACKS){var e=goog.debug.getNativeStackTrace_(goog.debug.getStacktraceSimple);if(e)return e}e=[];for(var o=arguments.callee.caller,n=0;o&&(!t||n<t);){e.push(goog.debug.getFunctionName(o)),e.push("()\n");try{o=o.caller}catch(t){e.push("[exception trying to get caller]\n");break}if(++n>=goog.debug.MAX_STACK_DEPTH){e.push("[...long stack...]");break}}return t&&n>=t?e.push("[...reached max depth limit...]"):e.push("[end]"),e.join("")},goog.debug.MAX_STACK_DEPTH=50,goog.debug.getNativeStackTrace_=function(t){var e=Error();if(Error.captureStackTrace)return Error.captureStackTrace(e,t),String(e.stack);try{throw e}catch(t){e=t}return(t=e.stack)?String(t):null},goog.debug.getStacktrace=function(t){var e;return goog.debug.FORCE_SLOPPY_STACKS||(e=goog.debug.getNativeStackTrace_(t||goog.debug.getStacktrace)),e||(e=goog.debug.getStacktraceHelper_(t||arguments.callee.caller,[])),e},goog.debug.getStacktraceHelper_=function(t,e){var o=[];if(goog.array.contains(e,t))o.push("[...circular reference...]");else if(t&&e.length<goog.debug.MAX_STACK_DEPTH){o.push(goog.debug.getFunctionName(t)+"(");for(var n=t.arguments,i=0;n&&i<n.length;i++){0<i&&o.push(", ");var r=n[i];switch(typeof r){case"object":r=r?"object":"null";break;case"string":break;case"number":r=String(r);break;case"boolean":r=r?"true":"false";break;case"function":r=(r=goog.debug.getFunctionName(r))?r:"[fn]";break;default:r=typeof r}40<r.length&&(r=r.substr(0,40)+"..."),o.push(r)}e.push(t),o.push(")\n");try{o.push(goog.debug.getStacktraceHelper_(t.caller,e))}catch(t){o.push("[exception trying to get caller]\n")}}else t?o.push("[...long stack...]"):o.push("[end]");return o.join("")},goog.debug.setFunctionResolver=function(t){goog.debug.fnNameResolver_=t},goog.debug.getFunctionName=function(t){if(goog.debug.fnNameCache_[t])return goog.debug.fnNameCache_[t];if(goog.debug.fnNameResolver_){var e=goog.debug.fnNameResolver_(t);if(e)return goog.debug.fnNameCache_[t]=e}return t=String(t),goog.debug.fnNameCache_[t]||(e=/function ([^\(]+)/.exec(t),goog.debug.fnNameCache_[t]=e?e[1]:"[Anonymous]"),goog.debug.fnNameCache_[t]},goog.debug.makeWhitespaceVisible=function(t){return t.replace(/ /g,"[_]").replace(/\f/g,"[f]").replace(/\n/g,"[n]\n").replace(/\r/g,"[r]").replace(/\t/g,"[t]")},goog.debug.runtimeType=function(t){return t instanceof Function?t.displayName||t.name||"unknown type name":t instanceof Object?t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t):null===t?"null":typeof t},goog.debug.fnNameCache_={},goog.debug.LogRecord=function(t,e,o,n,i){this.reset(t,e,o,n,i)},goog.debug.LogRecord.prototype.sequenceNumber_=0,goog.debug.LogRecord.prototype.exception_=null,goog.debug.LogRecord.ENABLE_SEQUENCE_NUMBERS=!0,goog.debug.LogRecord.nextSequenceNumber_=0,goog.debug.LogRecord.prototype.reset=function(t,e,o,n,i){goog.debug.LogRecord.ENABLE_SEQUENCE_NUMBERS&&(this.sequenceNumber_="number"==typeof i?i:goog.debug.LogRecord.nextSequenceNumber_++),this.time_=n||goog.now(),this.level_=t,this.msg_=e,this.loggerName_=o,delete this.exception_},goog.debug.LogRecord.prototype.getLoggerName=function(){return this.loggerName_},goog.debug.LogRecord.prototype.getException=function(){return this.exception_},goog.debug.LogRecord.prototype.setException=function(t){this.exception_=t},goog.debug.LogRecord.prototype.setLoggerName=function(t){this.loggerName_=t},goog.debug.LogRecord.prototype.getLevel=function(){return this.level_},goog.debug.LogRecord.prototype.setLevel=function(t){this.level_=t},goog.debug.LogRecord.prototype.getMessage=function(){return this.msg_},goog.debug.LogRecord.prototype.setMessage=function(t){this.msg_=t},goog.debug.LogRecord.prototype.getMillis=function(){return this.time_},goog.debug.LogRecord.prototype.setMillis=function(t){this.time_=t},goog.debug.LogRecord.prototype.getSequenceNumber=function(){return this.sequenceNumber_},goog.debug.LogBuffer=function(){goog.asserts.assert(goog.debug.LogBuffer.isBufferingEnabled(),"Cannot use goog.debug.LogBuffer without defining goog.debug.LogBuffer.CAPACITY."),this.clear()},goog.debug.LogBuffer.getInstance=function(){return goog.debug.LogBuffer.instance_||(goog.debug.LogBuffer.instance_=new goog.debug.LogBuffer),goog.debug.LogBuffer.instance_},goog.debug.LogBuffer.CAPACITY=0,goog.debug.LogBuffer.prototype.addRecord=function(t,e,o){var n=(this.curIndex_+1)%goog.debug.LogBuffer.CAPACITY;return this.curIndex_=n,this.isFull_?(n=this.buffer_[n],n.reset(t,e,o),n):(this.isFull_=n==goog.debug.LogBuffer.CAPACITY-1,this.buffer_[n]=new goog.debug.LogRecord(t,e,o))},goog.debug.LogBuffer.isBufferingEnabled=function(){return 0<goog.debug.LogBuffer.CAPACITY},goog.debug.LogBuffer.prototype.clear=function(){this.buffer_=Array(goog.debug.LogBuffer.CAPACITY),this.curIndex_=-1,this.isFull_=!1},goog.debug.LogBuffer.prototype.forEachRecord=function(t){var e=this.buffer_;if(e[0]){var o=this.curIndex_,n=this.isFull_?o:-1;do{n=(n+1)%goog.debug.LogBuffer.CAPACITY,t(e[n])}while(n!=o)}},goog.debug.Logger=function(t){this.name_=t,this.handlers_=this.children_=this.level_=this.parent_=null},goog.debug.Logger.ROOT_LOGGER_NAME="",goog.debug.Logger.ENABLE_HIERARCHY=!0,goog.debug.Logger.ENABLE_HIERARCHY||(goog.debug.Logger.rootHandlers_=[]),goog.debug.Logger.Level=function(t,e){this.name=t,this.value=e},goog.debug.Logger.Level.prototype.toString=function(){return this.name},goog.debug.Logger.Level.OFF=new goog.debug.Logger.Level("OFF",1/0),goog.debug.Logger.Level.SHOUT=new goog.debug.Logger.Level("SHOUT",1200),goog.debug.Logger.Level.SEVERE=new goog.debug.Logger.Level("SEVERE",1e3),goog.debug.Logger.Level.WARNING=new goog.debug.Logger.Level("WARNING",900),goog.debug.Logger.Level.INFO=new goog.debug.Logger.Level("INFO",800),goog.debug.Logger.Level.CONFIG=new goog.debug.Logger.Level("CONFIG",700),goog.debug.Logger.Level.FINE=new goog.debug.Logger.Level("FINE",500),goog.debug.Logger.Level.FINER=new goog.debug.Logger.Level("FINER",400),goog.debug.Logger.Level.FINEST=new goog.debug.Logger.Level("FINEST",300),goog.debug.Logger.Level.ALL=new goog.debug.Logger.Level("ALL",0),goog.debug.Logger.Level.PREDEFINED_LEVELS=[goog.debug.Logger.Level.OFF,goog.debug.Logger.Level.SHOUT,goog.debug.Logger.Level.SEVERE,goog.debug.Logger.Level.WARNING,goog.debug.Logger.Level.INFO,goog.debug.Logger.Level.CONFIG,goog.debug.Logger.Level.FINE,goog.debug.Logger.Level.FINER,goog.debug.Logger.Level.FINEST,goog.debug.Logger.Level.ALL],goog.debug.Logger.Level.predefinedLevelsCache_=null,goog.debug.Logger.Level.createPredefinedLevelsCache_=function(){goog.debug.Logger.Level.predefinedLevelsCache_={};for(var t,e=0;t=goog.debug.Logger.Level.PREDEFINED_LEVELS[e];e++)goog.debug.Logger.Level.predefinedLevelsCache_[t.value]=t,goog.debug.Logger.Level.predefinedLevelsCache_[t.name]=t},goog.debug.Logger.Level.getPredefinedLevel=function(t){return goog.debug.Logger.Level.predefinedLevelsCache_||goog.debug.Logger.Level.createPredefinedLevelsCache_(),goog.debug.Logger.Level.predefinedLevelsCache_[t]||null},goog.debug.Logger.Level.getPredefinedLevelByValue=function(t){if(goog.debug.Logger.Level.predefinedLevelsCache_||goog.debug.Logger.Level.createPredefinedLevelsCache_(),t in goog.debug.Logger.Level.predefinedLevelsCache_)return goog.debug.Logger.Level.predefinedLevelsCache_[t];for(var e=0;e<goog.debug.Logger.Level.PREDEFINED_LEVELS.length;++e){var o=goog.debug.Logger.Level.PREDEFINED_LEVELS[e];if(o.value<=t)return o}return null},goog.debug.Logger.getLogger=function(t){return goog.debug.LogManager.getLogger(t)},goog.debug.Logger.logToProfilers=function(t){var e=goog.global.console;e&&e.timeStamp&&e.timeStamp(t),(e=goog.global.msWriteProfilerMark)&&e(t)},goog.debug.Logger.prototype.getName=function(){return this.name_},goog.debug.Logger.prototype.addHandler=function(t){goog.debug.LOGGING_ENABLED&&(goog.debug.Logger.ENABLE_HIERARCHY?(this.handlers_||(this.handlers_=[]),this.handlers_.push(t)):(goog.asserts.assert(!this.name_,"Cannot call addHandler on a non-root logger when goog.debug.Logger.ENABLE_HIERARCHY is false."),goog.debug.Logger.rootHandlers_.push(t)))},goog.debug.Logger.prototype.removeHandler=function(t){if(goog.debug.LOGGING_ENABLED){var e=goog.debug.Logger.ENABLE_HIERARCHY?this.handlers_:goog.debug.Logger.rootHandlers_;return!!e&&goog.array.remove(e,t)}return!1},goog.debug.Logger.prototype.getParent=function(){return this.parent_},goog.debug.Logger.prototype.getChildren=function(){return this.children_||(this.children_={}),this.children_},goog.debug.Logger.prototype.setLevel=function(t){goog.debug.LOGGING_ENABLED&&(goog.debug.Logger.ENABLE_HIERARCHY?this.level_=t:(goog.asserts.assert(!this.name_,"Cannot call setLevel() on a non-root logger when goog.debug.Logger.ENABLE_HIERARCHY is false."),goog.debug.Logger.rootLevel_=t))},goog.debug.Logger.prototype.getLevel=function(){return goog.debug.LOGGING_ENABLED?this.level_:goog.debug.Logger.Level.OFF},goog.debug.Logger.prototype.getEffectiveLevel=function(){return goog.debug.LOGGING_ENABLED?goog.debug.Logger.ENABLE_HIERARCHY?this.level_?this.level_:this.parent_?this.parent_.getEffectiveLevel():(goog.asserts.fail("Root logger has no level set."),null):goog.debug.Logger.rootLevel_:goog.debug.Logger.Level.OFF},goog.debug.Logger.prototype.isLoggable=function(t){return goog.debug.LOGGING_ENABLED&&t.value>=this.getEffectiveLevel().value},goog.debug.Logger.prototype.log=function(t,e,o){goog.debug.LOGGING_ENABLED&&this.isLoggable(t)&&(goog.isFunction(e)&&(e=e()),this.doLogRecord_(this.getLogRecord(t,e,o)))},goog.debug.Logger.prototype.getLogRecord=function(t,e,o){return t=goog.debug.LogBuffer.isBufferingEnabled()?goog.debug.LogBuffer.getInstance().addRecord(t,e,this.name_):new goog.debug.LogRecord(t,String(e),this.name_),o&&t.setException(o),t},goog.debug.Logger.prototype.shout=function(t,e){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.SHOUT,t,e)},goog.debug.Logger.prototype.severe=function(t,e){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.SEVERE,t,e)},goog.debug.Logger.prototype.warning=function(t,e){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.WARNING,t,e)},goog.debug.Logger.prototype.info=function(t,e){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.INFO,t,e)},goog.debug.Logger.prototype.config=function(t,e){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.CONFIG,t,e)},goog.debug.Logger.prototype.fine=function(t,e){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.FINE,t,e)},goog.debug.Logger.prototype.finer=function(t,e){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.FINER,t,e)},goog.debug.Logger.prototype.finest=function(t,e){goog.debug.LOGGING_ENABLED&&this.log(goog.debug.Logger.Level.FINEST,t,e)},goog.debug.Logger.prototype.logRecord=function(t){goog.debug.LOGGING_ENABLED&&this.isLoggable(t.getLevel())&&this.doLogRecord_(t)},goog.debug.Logger.prototype.doLogRecord_=function(t){if(goog.debug.Logger.logToProfilers("log:"+t.getMessage()),goog.debug.Logger.ENABLE_HIERARCHY)for(var e=this;e;)e.callPublish_(t),e=e.getParent();else{e=0;for(var o;o=goog.debug.Logger.rootHandlers_[e++];)o(t)}},goog.debug.Logger.prototype.callPublish_=function(t){if(this.handlers_)for(var e,o=0;e=this.handlers_[o];o++)e(t)},goog.debug.Logger.prototype.setParent_=function(t){this.parent_=t},goog.debug.Logger.prototype.addChild_=function(t,e){this.getChildren()[t]=e},goog.debug.LogManager={},goog.debug.LogManager.loggers_={},goog.debug.LogManager.rootLogger_=null,goog.debug.LogManager.initialize=function(){goog.debug.LogManager.rootLogger_||(goog.debug.LogManager.rootLogger_=new goog.debug.Logger(goog.debug.Logger.ROOT_LOGGER_NAME),goog.debug.LogManager.loggers_[goog.debug.Logger.ROOT_LOGGER_NAME]=goog.debug.LogManager.rootLogger_,goog.debug.LogManager.rootLogger_.setLevel(goog.debug.Logger.Level.CONFIG))},goog.debug.LogManager.getLoggers=function(){return goog.debug.LogManager.loggers_},goog.debug.LogManager.getRoot=function(){return goog.debug.LogManager.initialize(),goog.debug.LogManager.rootLogger_},goog.debug.LogManager.getLogger=function(t){return goog.debug.LogManager.initialize(),goog.debug.LogManager.loggers_[t]||goog.debug.LogManager.createLogger_(t)},goog.debug.LogManager.createFunctionForCatchErrors=function(t){return function(e){(t||goog.debug.LogManager.getRoot()).severe("Error: "+e.message+" ("+e.fileName+" @ Line: "+e.line+")")}},goog.debug.LogManager.createLogger_=function(t){var e=new goog.debug.Logger(t);if(goog.debug.Logger.ENABLE_HIERARCHY){var o=t.lastIndexOf("."),n=t.substr(0,o);o=t.substr(o+1),n=goog.debug.LogManager.getLogger(n),n.addChild_(o,e),e.setParent_(n)}return goog.debug.LogManager.loggers_[t]=e},goog.log={},goog.log.ENABLED=goog.debug.LOGGING_ENABLED,goog.log.ROOT_LOGGER_NAME=goog.debug.Logger.ROOT_LOGGER_NAME,goog.log.Logger=goog.debug.Logger,goog.log.Level=goog.debug.Logger.Level,goog.log.LogRecord=goog.debug.LogRecord,goog.log.getLogger=function(t,e){if(goog.log.ENABLED){var o=goog.debug.LogManager.getLogger(t);return e&&o&&o.setLevel(e),o}return null},goog.log.addHandler=function(t,e){goog.log.ENABLED&&t&&t.addHandler(e)},goog.log.removeHandler=function(t,e){return!(!goog.log.ENABLED||!t)&&t.removeHandler(e)},goog.log.log=function(t,e,o,n){goog.log.ENABLED&&t&&t.log(e,o,n)},goog.log.error=function(t,e,o){goog.log.ENABLED&&t&&t.severe(e,o)},goog.log.warning=function(t,e,o){goog.log.ENABLED&&t&&t.warning(e,o)},goog.log.info=function(t,e,o){goog.log.ENABLED&&t&&t.info(e,o)},goog.log.fine=function(t,e,o){goog.log.ENABLED&&t&&t.fine(e,o)},goog.string.StringBuffer=function(t,e){null!=t&&this.append.apply(this,arguments)},goog.string.StringBuffer.prototype.buffer_="",goog.string.StringBuffer.prototype.set=function(t){this.buffer_=""+t},goog.string.StringBuffer.prototype.append=function(t,e,o){if(this.buffer_+=String(t),null!=e)for(var n=1;n<arguments.length;n++)this.buffer_+=arguments[n];return this},goog.string.StringBuffer.prototype.clear=function(){this.buffer_=""},goog.string.StringBuffer.prototype.getLength=function(){return this.buffer_.length},goog.string.StringBuffer.prototype.toString=function(){return this.buffer_},goog.ui.tree={},goog.ui.tree.BaseNode=function(t,e,o){goog.ui.Component.call(this,o),this.config_=e||goog.ui.tree.BaseNode.defaultConfig,this.html_=goog.html.SafeHtml.htmlEscapePreservingNewlines(t),this.expanded_=this.selected_=!1,this.toolTip_=null,this.afterLabelHtml_=goog.html.SafeHtml.EMPTY,this.isUserCollapsible_=!0,this.depth_=-1},goog.inherits(goog.ui.tree.BaseNode,goog.ui.Component),goog.ui.tree.BaseNode.EventType={BEFORE_EXPAND:"beforeexpand",EXPAND:"expand",BEFORE_COLLAPSE:"beforecollapse",COLLAPSE:"collapse"},goog.ui.tree.BaseNode.allNodes={},goog.ui.tree.BaseNode.prototype.disposeInternal=function(){goog.ui.tree.BaseNode.superClass_.disposeInternal.call(this),this.tree&&(this.tree.removeNode(this),this.tree=null),this.setElementInternal(null)},goog.ui.tree.BaseNode.prototype.initAccessibility=function(){var t=this.getElement();if(t){var e=this.getLabelElement();if(e&&!e.id&&(e.id=this.getId()+".label"),goog.a11y.aria.setRole(t,"treeitem"),goog.a11y.aria.setState(t,"selected",!1),goog.a11y.aria.setState(t,"level",this.getDepth()),e&&goog.a11y.aria.setState(t,"labelledby",e.id),(e=this.getIconElement())&&goog.a11y.aria.setRole(e,"presentation"),(e=this.getExpandIconElement())&&goog.a11y.aria.setRole(e,"presentation"),(e=this.getChildrenElement())&&(goog.a11y.aria.setRole(e,"group"),e.hasChildNodes()))for(goog.a11y.aria.setState(t,goog.a11y.aria.State.EXPANDED,!1),t=this.getChildCount(),e=1;e<=t;e++){var o=this.getChildAt(e-1).getElement();goog.asserts.assert(o,"The child element cannot be null"),goog.a11y.aria.setState(o,"setsize",t),goog.a11y.aria.setState(o,"posinset",e)}}},goog.ui.tree.BaseNode.prototype.createDom=function(){var t=this.getDomHelper().safeHtmlToNode(this.toSafeHtml());this.setElementInternal(t)},goog.ui.tree.BaseNode.prototype.enterDocument=function(){goog.ui.tree.BaseNode.superClass_.enterDocument.call(this),goog.ui.tree.BaseNode.allNodes[this.getId()]=this,this.initAccessibility()},goog.ui.tree.BaseNode.prototype.exitDocument=function(){goog.ui.tree.BaseNode.superClass_.exitDocument.call(this),delete goog.ui.tree.BaseNode.allNodes[this.getId()]},goog.ui.tree.BaseNode.prototype.addChildAt=function(t,e,o){goog.asserts.assert(!t.getParent()),goog.asserts.assertInstanceof(t,goog.ui.tree.BaseNode),o=this.getChildAt(e-1);var n=this.getChildAt(e);if(goog.ui.tree.BaseNode.superClass_.addChildAt.call(this,t,e),t.previousSibling_=o,t.nextSibling_=n,o?o.nextSibling_=t:this.firstChild_=t,n?n.previousSibling_=t:this.lastChild_=t,(e=this.getTree())&&t.setTreeInternal(e),t.setDepth_(this.getDepth()+1),(e=this.getElement())&&(this.updateExpandIcon(),goog.a11y.aria.setState(e,goog.a11y.aria.State.EXPANDED,this.getExpanded()),this.getExpanded())){e=this.getChildrenElement(),t.getElement()||t.createDom();var i=t.getElement(),r=n&&n.getElement();e.insertBefore(i,r),this.isInDocument()&&t.enterDocument(),n||(o?o.updateExpandIcon():(goog.style.setElementShown(e,!0),this.setExpanded(this.getExpanded())))}},goog.ui.tree.BaseNode.prototype.add=function(t,e){return goog.asserts.assert(!e||e.getParent()==this,"Can only add nodes before siblings"),t.getParent()&&t.getParent().removeChild(t),this.addChildAt(t,e?this.indexOfChild(e):this.getChildCount()),t},goog.ui.tree.BaseNode.prototype.removeChild=function(t,e){var o=this.getTree(),n=o?o.getSelectedItem():null;if((n==t||t.contains(n))&&(o.hasFocus()?(this.select(),goog.Timer.callOnce(this.onTimeoutSelect_,10,this)):this.select()),goog.ui.tree.BaseNode.superClass_.removeChild.call(this,t),this.lastChild_==t&&(this.lastChild_=t.previousSibling_),this.firstChild_==t&&(this.firstChild_=t.nextSibling_),t.previousSibling_&&(t.previousSibling_.nextSibling_=t.nextSibling_),t.nextSibling_&&(t.nextSibling_.previousSibling_=t.previousSibling_),n=t.isLastSibling(),t.tree=null,t.depth_=-1,o&&(o.removeNode(t),this.isInDocument())){if(o=this.getChildrenElement(),t.isInDocument()){var i=t.getElement();o.removeChild(i),t.exitDocument()}n&&(n=this.getLastChild())&&n.updateExpandIcon(),this.hasChildren()||(o.style.display="none",this.updateExpandIcon(),this.updateIcon_(),(n=this.getElement())&&goog.a11y.aria.removeState(n,goog.a11y.aria.State.EXPANDED))}return t},goog.ui.tree.BaseNode.prototype.remove=goog.ui.tree.BaseNode.prototype.removeChild,goog.ui.tree.BaseNode.prototype.onTimeoutSelect_=function(){this.select()},goog.ui.tree.BaseNode.prototype.getTree=goog.abstractMethod,goog.ui.tree.BaseNode.prototype.getDepth=function(){var t=this.depth_;return 0>t&&(t=this.computeDepth_(),this.setDepth_(t)),t},goog.ui.tree.BaseNode.prototype.computeDepth_=function(){var t=this.getParent();return t?t.getDepth()+1:0},goog.ui.tree.BaseNode.prototype.setDepth_=function(t){if(t!=this.depth_){this.depth_=t;var e=this.getRowElement();if(e){var o=this.getPixelIndent_()+"px";this.isRightToLeft()?e.style.paddingRight=o:e.style.paddingLeft=o}this.forEachChild(function(e){e.setDepth_(t+1)})}},goog.ui.tree.BaseNode.prototype.contains=function(t){for(;t;){if(t==this)return!0;t=t.getParent()}return!1},goog.ui.tree.BaseNode.EMPTY_CHILDREN_=[],goog.ui.tree.BaseNode.prototype.getChildren=function(){var t=[];return this.forEachChild(function(e){t.push(e)}),t},goog.ui.tree.BaseNode.prototype.getFirstChild=function(){return this.getChildAt(0)},goog.ui.tree.BaseNode.prototype.getLastChild=function(){return this.getChildAt(this.getChildCount()-1)},goog.ui.tree.BaseNode.prototype.getPreviousSibling=function(){return this.previousSibling_},goog.ui.tree.BaseNode.prototype.getNextSibling=function(){return this.nextSibling_},goog.ui.tree.BaseNode.prototype.isLastSibling=function(){return!this.nextSibling_},goog.ui.tree.BaseNode.prototype.isSelected=function(){return this.selected_},goog.ui.tree.BaseNode.prototype.select=function(){var t=this.getTree();t&&t.setSelectedItem(this)},goog.ui.tree.BaseNode.prototype.deselect=goog.nullFunction,goog.ui.tree.BaseNode.prototype.setSelectedInternal=function(t){if(this.selected_!=t){this.selected_=t,this.updateRow();var e=this.getElement();e&&(goog.a11y.aria.setState(e,"selected",t),t&&(t=this.getTree().getElement(),goog.asserts.assert(t,"The DOM element for the tree cannot be null"),goog.a11y.aria.setState(t,"activedescendant",this.getId())))}},goog.ui.tree.BaseNode.prototype.getExpanded=function(){return this.expanded_},goog.ui.tree.BaseNode.prototype.setExpandedInternal=function(t){this.expanded_=t},goog.ui.tree.BaseNode.prototype.setExpanded=function(t){var e=t!=this.expanded_;if(!e||this.dispatchEvent(t?goog.ui.tree.BaseNode.EventType.BEFORE_EXPAND:goog.ui.tree.BaseNode.EventType.BEFORE_COLLAPSE)){this.expanded_=t;var o=this.getTree(),n=this.getElement();if(this.hasChildren()){if(!t&&o&&this.contains(o.getSelectedItem())&&this.select(),n){if((o=this.getChildrenElement())&&(goog.style.setElementShown(o,t),goog.a11y.aria.setState(n,goog.a11y.aria.State.EXPANDED,t),t&&this.isInDocument()&&!o.hasChildNodes())){var i=[];this.forEachChild(function(t){i.push(t.toSafeHtml())}),goog.dom.safe.setInnerHtml(o,goog.html.SafeHtml.concat(i)),this.forEachChild(function(t){t.enterDocument()})}this.updateExpandIcon()}}else(o=this.getChildrenElement())&&goog.style.setElementShown(o,!1);n&&this.updateIcon_(),e&&this.dispatchEvent(t?goog.ui.tree.BaseNode.EventType.EXPAND:goog.ui.tree.BaseNode.EventType.COLLAPSE)}},goog.ui.tree.BaseNode.prototype.toggle=function(){this.setExpanded(!this.getExpanded())},goog.ui.tree.BaseNode.prototype.expand=function(){this.setExpanded(!0)},goog.ui.tree.BaseNode.prototype.collapse=function(){this.setExpanded(!1)},goog.ui.tree.BaseNode.prototype.collapseChildren=function(){this.forEachChild(function(t){t.collapseAll()})},goog.ui.tree.BaseNode.prototype.collapseAll=function(){this.collapseChildren(),this.collapse()},goog.ui.tree.BaseNode.prototype.expandChildren=function(){this.forEachChild(function(t){t.expandAll()})},goog.ui.tree.BaseNode.prototype.expandAll=function(){this.expandChildren(),this.expand()},goog.ui.tree.BaseNode.prototype.reveal=function(){var t=this.getParent();t&&(t.setExpanded(!0),t.reveal())},goog.ui.tree.BaseNode.prototype.setIsUserCollapsible=function(t){(this.isUserCollapsible_=t)||this.expand(),this.getElement()&&this.updateExpandIcon()},goog.ui.tree.BaseNode.prototype.isUserCollapsible=function(){return this.isUserCollapsible_},goog.ui.tree.BaseNode.prototype.toSafeHtml=function(){var t=this.getTree(),e=!t.getShowLines()||t==this.getParent()&&!t.getShowRootLines()?this.config_.cssChildrenNoLines:this.config_.cssChildren;t=this.getExpanded()&&this.hasChildren(),e={class:e,style:this.getLineStyle()};var o=[];return t&&this.forEachChild(function(t){o.push(t.toSafeHtml())}),t=goog.html.SafeHtml.create("div",e,o),goog.html.SafeHtml.create("div",{class:this.config_.cssItem,id:this.getId()},[this.getRowSafeHtml(),t])},goog.ui.tree.BaseNode.prototype.getPixelIndent_=function(){return Math.max(0,(this.getDepth()-1)*this.config_.indentWidth)},goog.ui.tree.BaseNode.prototype.getRowSafeHtml=function(){var t={};t["padding-"+(this.isRightToLeft()?"right":"left")]=this.getPixelIndent_()+"px",t={class:this.getRowClassName(),style:t};var e=[this.getExpandIconSafeHtml(),this.getIconSafeHtml(),this.getLabelSafeHtml()];return goog.html.SafeHtml.create("div",t,e)},goog.ui.tree.BaseNode.prototype.getRowClassName=function(){var t=this.isSelected()?" "+this.config_.cssSelectedRow:"";return this.config_.cssTreeRow+t},goog.ui.tree.BaseNode.prototype.getLabelSafeHtml=function(){var t=goog.html.SafeHtml.create("span",{class:this.config_.cssItemLabel,title:this.getToolTip()||null},this.getSafeHtml());return goog.html.SafeHtml.concat(t,goog.html.SafeHtml.create("span",{},this.getAfterLabelSafeHtml()))},goog.ui.tree.BaseNode.prototype.getAfterLabelHtml=function(){return goog.html.SafeHtml.unwrap(this.getAfterLabelSafeHtml())},goog.ui.tree.BaseNode.prototype.getAfterLabelSafeHtml=function(){return this.afterLabelHtml_},goog.ui.tree.BaseNode.prototype.setAfterLabelSafeHtml=function(t){this.afterLabelHtml_=t;var e=this.getAfterLabelElement();e&&goog.dom.safe.setInnerHtml(e,t)},goog.ui.tree.BaseNode.prototype.getIconSafeHtml=function(){return goog.html.SafeHtml.create("span",{style:{display:"inline-block"},class:this.getCalculatedIconClass()})},goog.ui.tree.BaseNode.prototype.getCalculatedIconClass=goog.abstractMethod,goog.ui.tree.BaseNode.prototype.getExpandIconSafeHtml=function(){return goog.html.SafeHtml.create("span",{type:"expand",style:{display:"inline-block"},class:this.getExpandIconClass()})},goog.ui.tree.BaseNode.prototype.getExpandIconClass=function(){var t=this.getTree(),e=!t.getShowLines()||t==this.getParent()&&!t.getShowRootLines(),o=this.config_,n=new goog.string.StringBuffer;if(n.append(o.cssTreeIcon," ",o.cssExpandTreeIcon," "),this.hasChildren()){var i=0;switch(t.getShowExpandIcons()&&this.isUserCollapsible_&&(i=this.getExpanded()?2:1),e||(i=this.isLastSibling()?i+4:i+8),i){case 1:n.append(o.cssExpandTreeIconPlus);break;case 2:n.append(o.cssExpandTreeIconMinus);break;case 4:n.append(o.cssExpandTreeIconL);break;case 5:n.append(o.cssExpandTreeIconLPlus);break;case 6:n.append(o.cssExpandTreeIconLMinus);break;case 8:n.append(o.cssExpandTreeIconT);break;case 9:n.append(o.cssExpandTreeIconTPlus);break;case 10:n.append(o.cssExpandTreeIconTMinus);break;default:n.append(o.cssExpandTreeIconBlank)}}else e?n.append(o.cssExpandTreeIconBlank):this.isLastSibling()?n.append(o.cssExpandTreeIconL):n.append(o.cssExpandTreeIconT);return n.toString()},goog.ui.tree.BaseNode.prototype.getLineStyle=function(){var t=this.getExpanded()&&this.hasChildren();return goog.html.SafeStyle.create({"background-position":this.getBackgroundPosition(),display:t?null:"none"})},goog.ui.tree.BaseNode.prototype.getBackgroundPosition=function(){return(this.isLastSibling()?"-100":(this.getDepth()-1)*this.config_.indentWidth)+"px 0"},goog.ui.tree.BaseNode.prototype.getElement=function(){var t=goog.ui.tree.BaseNode.superClass_.getElement.call(this);return t||(t=this.getDomHelper().getElement(this.getId()),this.setElementInternal(t)),t},goog.ui.tree.BaseNode.prototype.getRowElement=function(){var t=this.getElement();return t?t.firstChild:null},goog.ui.tree.BaseNode.prototype.getExpandIconElement=function(){var t=this.getRowElement();return t?t.firstChild:null},goog.ui.tree.BaseNode.prototype.getIconElement=function(){var t=this.getRowElement();return t?t.childNodes[1]:null},goog.ui.tree.BaseNode.prototype.getLabelElement=function(){var t=this.getRowElement();return t&&t.lastChild?t.lastChild.previousSibling:null},goog.ui.tree.BaseNode.prototype.getAfterLabelElement=function(){var t=this.getRowElement();return t?t.lastChild:null},goog.ui.tree.BaseNode.prototype.getChildrenElement=function(){var t=this.getElement();return t?t.lastChild:null},goog.ui.tree.BaseNode.prototype.setIconClass=function(t){this.iconClass_=t,this.isInDocument()&&this.updateIcon_()},goog.ui.tree.BaseNode.prototype.getIconClass=function(){return this.iconClass_},goog.ui.tree.BaseNode.prototype.setExpandedIconClass=function(t){this.expandedIconClass_=t,this.isInDocument()&&this.updateIcon_()},goog.ui.tree.BaseNode.prototype.getExpandedIconClass=function(){return this.expandedIconClass_},goog.ui.tree.BaseNode.prototype.setText=function(t){this.setSafeHtml(goog.html.SafeHtml.htmlEscape(t))},goog.ui.tree.BaseNode.prototype.getText=function(){return goog.string.unescapeEntities(goog.html.SafeHtml.unwrap(this.html_))},goog.ui.tree.BaseNode.prototype.setSafeHtml=function(t){this.html_=t;var e=this.getLabelElement();e&&goog.dom.safe.setInnerHtml(e,t),(t=this.getTree())&&t.setNode(this)},goog.ui.tree.BaseNode.prototype.getHtml=function(){return goog.html.SafeHtml.unwrap(this.getSafeHtml())},goog.ui.tree.BaseNode.prototype.getSafeHtml=function(){return this.html_},goog.ui.tree.BaseNode.prototype.setToolTip=function(t){this.toolTip_=t;var e=this.getLabelElement();e&&(e.title=t)},goog.ui.tree.BaseNode.prototype.getToolTip=function(){return this.toolTip_},goog.ui.tree.BaseNode.prototype.updateRow=function(){var t=this.getRowElement();t&&(t.className=this.getRowClassName())},goog.ui.tree.BaseNode.prototype.updateExpandIcon=function(){var t=this.getExpandIconElement();t&&(t.className=this.getExpandIconClass()),(t=this.getChildrenElement())&&(t.style.backgroundPosition=this.getBackgroundPosition())},goog.ui.tree.BaseNode.prototype.updateIcon_=function(){this.getIconElement().className=this.getCalculatedIconClass()},goog.ui.tree.BaseNode.prototype.onMouseDown=function(t){"expand"==t.target.getAttribute("type")&&this.hasChildren()?this.isUserCollapsible_&&this.toggle():(this.select(),this.updateRow())},goog.ui.tree.BaseNode.prototype.onClick_=goog.events.Event.preventDefault,goog.ui.tree.BaseNode.prototype.onDoubleClick_=function(t){"expand"==t.target.getAttribute("type")&&this.hasChildren()||this.isUserCollapsible_&&this.toggle()};goog.ui.tree.BaseNode.prototype.onKeyDown=function(t){var e=!0;switch(t.keyCode){case goog.events.KeyCodes.RIGHT:if(t.altKey)break;this.hasChildren()&&(this.getExpanded()?this.getFirstChild().select():this.setExpanded(!0));break;case goog.events.KeyCodes.LEFT:if(t.altKey)break;if(this.hasChildren()&&this.getExpanded()&&this.isUserCollapsible_)this.setExpanded(!1);else{var o=this.getParent(),n=this.getTree();o&&(n.getShowRootNode()||o!=n)&&o.select()}break;case goog.events.KeyCodes.DOWN:(n=this.getNextShownNode())&&n.select();break;case goog.events.KeyCodes.UP:(n=this.getPreviousShownNode())&&n.select();break;default:e=!1}return e&&(t.preventDefault(),(n=this.getTree())&&n.clearTypeAhead()),e},goog.ui.tree.BaseNode.prototype.getLastShownDescendant=function(){return this.getExpanded()&&this.hasChildren()?this.getLastChild().getLastShownDescendant():this},goog.ui.tree.BaseNode.prototype.getNextShownNode=function(){if(this.hasChildren()&&this.getExpanded())return this.getFirstChild();for(var t,e=this;e!=this.getTree();){if(null!=(t=e.getNextSibling()))return t;e=e.getParent()}return null},goog.ui.tree.BaseNode.prototype.getPreviousShownNode=function(){var t=this.getPreviousSibling();if(null!=t)return t.getLastShownDescendant();t=this.getParent();var e=this.getTree();return!e.getShowRootNode()&&t==e||this==e?null:t},goog.ui.tree.BaseNode.prototype.getClientData=goog.ui.tree.BaseNode.prototype.getModel,goog.ui.tree.BaseNode.prototype.setClientData=goog.ui.tree.BaseNode.prototype.setModel,goog.ui.tree.BaseNode.prototype.getConfig=function(){return this.config_},goog.ui.tree.BaseNode.prototype.setTreeInternal=function(t){this.tree!=t&&(this.tree=t,t.setNode(this),this.forEachChild(function(e){e.setTreeInternal(t)}))},goog.ui.tree.BaseNode.defaultConfig={indentWidth:19,cssRoot:"goog-tree-root goog-tree-item",cssHideRoot:"goog-tree-hide-root",cssItem:"goog-tree-item",cssChildren:"goog-tree-children",cssChildrenNoLines:"goog-tree-children-nolines",cssTreeRow:"goog-tree-row",cssItemLabel:"goog-tree-item-label",cssTreeIcon:"goog-tree-icon",cssExpandTreeIcon:"goog-tree-expand-icon",cssExpandTreeIconPlus:"goog-tree-expand-icon-plus",cssExpandTreeIconMinus:"goog-tree-expand-icon-minus",cssExpandTreeIconTPlus:"goog-tree-expand-icon-tplus",cssExpandTreeIconTMinus:"goog-tree-expand-icon-tminus",cssExpandTreeIconLPlus:"goog-tree-expand-icon-lplus",cssExpandTreeIconLMinus:"goog-tree-expand-icon-lminus",cssExpandTreeIconT:"goog-tree-expand-icon-t",cssExpandTreeIconL:"goog-tree-expand-icon-l",cssExpandTreeIconBlank:"goog-tree-expand-icon-blank",cssExpandedFolderIcon:"goog-tree-expanded-folder-icon",cssCollapsedFolderIcon:"goog-tree-collapsed-folder-icon",cssFileIcon:"goog-tree-file-icon",cssExpandedRootIcon:"goog-tree-expanded-folder-icon",cssCollapsedRootIcon:"goog-tree-collapsed-folder-icon",cssSelectedRow:"selected"},goog.ui.tree.TreeNode=function(t,e,o){goog.ui.tree.BaseNode.call(this,t,e,o)},goog.inherits(goog.ui.tree.TreeNode,goog.ui.tree.BaseNode),goog.ui.tree.TreeNode.prototype.getTree=function(){if(this.tree)return this.tree;var t=this.getParent();return t&&(t=t.getTree())?(this.setTreeInternal(t),t):null},goog.ui.tree.TreeNode.prototype.getCalculatedIconClass=function(){var t=this.getExpanded(),e=this.getExpandedIconClass();if(t&&e)return e;if(e=this.getIconClass(),!t&&e)return e;if(e=this.getConfig(),this.hasChildren()){if(t&&e.cssExpandedFolderIcon)return e.cssTreeIcon+" "+e.cssExpandedFolderIcon;if(!t&&e.cssCollapsedFolderIcon)return e.cssTreeIcon+" "+e.cssCollapsedFolderIcon}else if(e.cssFileIcon)return e.cssTreeIcon+" "+e.cssFileIcon;return""},goog.structs={},goog.structs.getCount=function(t){return t.getCount&&"function"==typeof t.getCount?t.getCount():goog.isArrayLike(t)||goog.isString(t)?t.length:goog.object.getCount(t)},goog.structs.getValues=function(t){if(t.getValues&&"function"==typeof t.getValues)return t.getValues();if(goog.isString(t))return t.split("");if(goog.isArrayLike(t)){for(var e=[],o=t.length,n=0;n<o;n++)e.push(t[n]);return e}return goog.object.getValues(t)},goog.structs.getKeys=function(t){if(t.getKeys&&"function"==typeof t.getKeys)return t.getKeys();if(!t.getValues||"function"!=typeof t.getValues){if(goog.isArrayLike(t)||goog.isString(t)){var e=[];t=t.length;for(var o=0;o<t;o++)e.push(o);return e}return goog.object.getKeys(t)}},goog.structs.contains=function(t,e){return t.contains&&"function"==typeof t.contains?t.contains(e):t.containsValue&&"function"==typeof t.containsValue?t.containsValue(e):goog.isArrayLike(t)||goog.isString(t)?goog.array.contains(t,e):goog.object.containsValue(t,e)},goog.structs.isEmpty=function(t){return t.isEmpty&&"function"==typeof t.isEmpty?t.isEmpty():goog.isArrayLike(t)||goog.isString(t)?goog.array.isEmpty(t):goog.object.isEmpty(t)},goog.structs.clear=function(t){t.clear&&"function"==typeof t.clear?t.clear():goog.isArrayLike(t)?goog.array.clear(t):goog.object.clear(t)},goog.structs.forEach=function(t,e,o){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,o);else if(goog.isArrayLike(t)||goog.isString(t))goog.array.forEach(t,e,o);else for(var n=goog.structs.getKeys(t),i=goog.structs.getValues(t),r=i.length,s=0;s<r;s++)e.call(o,i[s],n&&n[s],t)},goog.structs.filter=function(t,e,o){if("function"==typeof t.filter)return t.filter(e,o);if(goog.isArrayLike(t)||goog.isString(t))return goog.array.filter(t,e,o);var n=goog.structs.getKeys(t),i=goog.structs.getValues(t),r=i.length;if(n)for(var s={},a=0;a<r;a++)e.call(o,i[a],n[a],t)&&(s[n[a]]=i[a]);else for(s=[],a=0;a<r;a++)e.call(o,i[a],void 0,t)&&s.push(i[a]);return s},goog.structs.map=function(t,e,o){if("function"==typeof t.map)return t.map(e,o);if(goog.isArrayLike(t)||goog.isString(t))return goog.array.map(t,e,o);var n=goog.structs.getKeys(t),i=goog.structs.getValues(t),r=i.length;if(n)for(var s={},a=0;a<r;a++)s[n[a]]=e.call(o,i[a],n[a],t);else for(s=[],a=0;a<r;a++)s[a]=e.call(o,i[a],void 0,t);return s},goog.structs.some=function(t,e,o){if("function"==typeof t.some)return t.some(e,o);if(goog.isArrayLike(t)||goog.isString(t))return goog.array.some(t,e,o);for(var n=goog.structs.getKeys(t),i=goog.structs.getValues(t),r=i.length,s=0;s<r;s++)if(e.call(o,i[s],n&&n[s],t))return!0;return!1},goog.structs.every=function(t,e,o){if("function"==typeof t.every)return t.every(e,o);if(goog.isArrayLike(t)||goog.isString(t))return goog.array.every(t,e,o);for(var n=goog.structs.getKeys(t),i=goog.structs.getValues(t),r=i.length,s=0;s<r;s++)if(!e.call(o,i[s],n&&n[s],t))return!1;return!0},goog.structs.Trie=function(t){this.value_=void 0,this.childNodes_={},t&&this.setAll(t)},goog.structs.Trie.prototype.set=function(t,e){this.setOrAdd_(t,e,!1)},goog.structs.Trie.prototype.add=function(t,e){this.setOrAdd_(t,e,!0)},goog.structs.Trie.prototype.setOrAdd_=function(t,e,o){for(var n=this,i=0;i<t.length;i++){var r=t.charAt(i);n.childNodes_[r]||(n.childNodes_[r]=new goog.structs.Trie),n=n.childNodes_[r]}if(o&&void 0!==n.value_)throw Error('The collection already contains the key "'+t+'"');n.value_=e},goog.structs.Trie.prototype.setAll=function(t){var e=goog.structs.getKeys(t);t=goog.structs.getValues(t);for(var o=0;o<e.length;o++)this.set(e[o],t[o])},goog.structs.Trie.prototype.getChildNode_=function(t){for(var e=this,o=0;o<t.length;o++){var n=t.charAt(o);if(!(e=e.childNodes_[n]))return}return e},goog.structs.Trie.prototype.get=function(t){return(t=this.getChildNode_(t))?t.value_:void 0},goog.structs.Trie.prototype.getKeyAndPrefixes=function(t,e){var o=this,n={},i=e||0;for(void 0!==o.value_&&(n[i]=o.value_);i<t.length;i++){var r=t.charAt(i);if(!(r in o.childNodes_))break;o=o.childNodes_[r],void 0!==o.value_&&(n[i]=o.value_)}return n},goog.structs.Trie.prototype.getValues=function(){var t=[];return this.getValuesInternal_(t),t},goog.structs.Trie.prototype.getValuesInternal_=function(t){void 0!==this.value_&&t.push(this.value_);for(var e in this.childNodes_)this.childNodes_[e].getValuesInternal_(t)},goog.structs.Trie.prototype.getKeys=function(t){var e=[];if(t){for(var o=this,n=0;n<t.length;n++){var i=t.charAt(n);if(!o.childNodes_[i])return[];o=o.childNodes_[i]}o.getKeysInternal_(t,e)}else this.getKeysInternal_("",e);return e},goog.structs.Trie.prototype.getKeysInternal_=function(t,e){void 0!==this.value_&&e.push(t);for(var o in this.childNodes_)this.childNodes_[o].getKeysInternal_(t+o,e)},goog.structs.Trie.prototype.containsKey=function(t){return void 0!==this.get(t)},goog.structs.Trie.prototype.containsPrefix=function(t){return 0==t.length?!this.isEmpty():!!this.getChildNode_(t)},goog.structs.Trie.prototype.containsValue=function(t){if(this.value_===t)return!0;for(var e in this.childNodes_)if(this.childNodes_[e].containsValue(t))return!0;return!1},goog.structs.Trie.prototype.clear=function(){this.childNodes_={},this.value_=void 0},goog.structs.Trie.prototype.remove=function(t){for(var e,o=this,n=[],i=0;i<t.length;i++){if(e=t.charAt(i),!o.childNodes_[e])throw Error('The collection does not have the key "'+t+'"');n.push([o,e]),o=o.childNodes_[e]}for(t=o.value_,delete o.value_;0<n.length&&(e=n.pop(),o=e[0],e=e[1],o.childNodes_[e].isEmpty());)delete o.childNodes_[e];return t},goog.structs.Trie.prototype.clone=function(){return new goog.structs.Trie(this)},goog.structs.Trie.prototype.getCount=function(){return goog.structs.getCount(this.getValues())},goog.structs.Trie.prototype.isEmpty=function(){return void 0===this.value_&&goog.object.isEmpty(this.childNodes_)},goog.ui.tree.TypeAhead=function(){this.nodeMap_=new goog.structs.Trie,this.buffer_="",this.matchingNodes_=this.matchingLabels_=null,this.matchingNodeIndex_=this.matchingLabelIndex_=0},goog.ui.tree.TypeAhead.Offset={DOWN:1,UP:-1},goog.ui.tree.TypeAhead.prototype.handleNavigation=function(t){var e=!1;switch(t.keyCode){case goog.events.KeyCodes.DOWN:case goog.events.KeyCodes.UP:t.ctrlKey&&(this.jumpTo_(t.keyCode==goog.events.KeyCodes.DOWN?goog.ui.tree.TypeAhead.Offset.DOWN:goog.ui.tree.TypeAhead.Offset.UP),e=!0);break;case goog.events.KeyCodes.BACKSPACE:t=this.buffer_.length-1,e=!0,0<t?(this.buffer_=this.buffer_.substring(0,t),this.jumpToLabel_(this.buffer_)):0==t?this.buffer_="":e=!1;break;case goog.events.KeyCodes.ESC:this.buffer_="",e=!0}return e},goog.ui.tree.TypeAhead.prototype.handleTypeAheadChar=function(t){var e=!1;return t.ctrlKey||t.altKey||(t=String.fromCharCode(t.charCode||t.keyCode).toLowerCase(),goog.string.isUnicodeChar(t)&&(" "!=t||this.buffer_)&&(this.buffer_+=t,e=this.jumpToLabel_(this.buffer_))),e},goog.ui.tree.TypeAhead.prototype.setNodeInMap=function(t){var e=t.getText();if(e&&!goog.string.isEmptyOrWhitespace(goog.string.makeSafe(e))){e=e.toLowerCase();var o=this.nodeMap_.get(e);o?o.push(t):this.nodeMap_.set(e,[t])}},goog.ui.tree.TypeAhead.prototype.removeNodeFromMap=function(t){var e=t.getText();if(e&&!goog.string.isEmptyOrWhitespace(goog.string.makeSafe(e))){e=e.toLowerCase();var o=this.nodeMap_.get(e);if(o){for(var n=t.getChildCount(),i=0;i<n;i++)this.removeNodeFromMap(t.getChildAt(i));goog.array.remove(o,t),o.length||this.nodeMap_.remove(e)}}},goog.ui.tree.TypeAhead.prototype.jumpToLabel_=function(t){var e=!1;return(t=this.nodeMap_.getKeys(t))&&t.length&&(this.matchingLabelIndex_=this.matchingNodeIndex_=0,e=this.nodeMap_.get(t[0]),e=this.selectMatchingNode_(e))&&(this.matchingLabels_=t),e},goog.ui.tree.TypeAhead.prototype.jumpTo_=function(t){var e=!1,o=this.matchingLabels_;if(o){e=null;var n=!1;if(this.matchingNodes_){var i=this.matchingNodeIndex_+t;0<=i&&i<this.matchingNodes_.length?(this.matchingNodeIndex_=i,e=this.matchingNodes_):n=!0}e||(i=this.matchingLabelIndex_+t,0<=i&&i<o.length&&(this.matchingLabelIndex_=i),o.length>this.matchingLabelIndex_&&(e=this.nodeMap_.get(o[this.matchingLabelIndex_])),e&&e.length&&n&&(this.matchingNodeIndex_=t==goog.ui.tree.TypeAhead.Offset.UP?e.length-1:0)),(e=this.selectMatchingNode_(e))&&(this.matchingLabels_=o)}return e},goog.ui.tree.TypeAhead.prototype.selectMatchingNode_=function(t){if(t){if(this.matchingNodeIndex_<t.length){var e=t[this.matchingNodeIndex_];this.matchingNodes_=t}e&&(e.reveal(),e.select())}return!!e},goog.ui.tree.TypeAhead.prototype.clear=function(){this.buffer_=""},goog.ui.tree.TreeControl=function(t,e,o){if(goog.ui.tree.BaseNode.call(this,t,e,o),this.setExpandedInternal(!0),this.setSelectedInternal(!0),this.selectedItem_=this,this.typeAhead_=new goog.ui.tree.TypeAhead,this.focusHandler_=this.keyHandler_=null,this.logger_=goog.log.getLogger("this"),this.focused_=!1,this.focusedNode_=null,this.showRootLines_=this.showRootNode_=this.showExpandIcons_=this.showLines_=!0,goog.userAgent.IE)try{document.execCommand("BackgroundImageCache",!1,!0)}catch(t){goog.log.warning(this.logger_,"Failed to enable background image cache")}},goog.inherits(goog.ui.tree.TreeControl,goog.ui.tree.BaseNode),goog.ui.tree.TreeControl.prototype.getTree=function(){return this},goog.ui.tree.TreeControl.prototype.getDepth=function(){return 0},goog.ui.tree.TreeControl.prototype.reveal=function(){},goog.ui.tree.TreeControl.prototype.handleFocus_=function(t){this.focused_=!0,goog.dom.classlist.add(goog.asserts.assert(this.getElement()),"focused"),this.selectedItem_&&this.selectedItem_.select()},goog.ui.tree.TreeControl.prototype.handleBlur_=function(t){this.focused_=!1,goog.dom.classlist.remove(goog.asserts.assert(this.getElement()),"focused")},goog.ui.tree.TreeControl.prototype.hasFocus=function(){return this.focused_},goog.ui.tree.TreeControl.prototype.getExpanded=function(){return!this.showRootNode_||goog.ui.tree.TreeControl.superClass_.getExpanded.call(this)},goog.ui.tree.TreeControl.prototype.setExpanded=function(t){this.showRootNode_?goog.ui.tree.TreeControl.superClass_.setExpanded.call(this,t):this.setExpandedInternal(t)},goog.ui.tree.TreeControl.prototype.getExpandIconSafeHtml=function(){return goog.html.SafeHtml.EMPTY},goog.ui.tree.TreeControl.prototype.getIconElement=function(){var t=this.getRowElement();return t?t.firstChild:null},goog.ui.tree.TreeControl.prototype.getExpandIconElement=function(){return null},goog.ui.tree.TreeControl.prototype.updateExpandIcon=function(){},goog.ui.tree.TreeControl.prototype.getRowClassName=function(){return goog.ui.tree.TreeControl.superClass_.getRowClassName.call(this)+(this.showRootNode_?"":" "+this.getConfig().cssHideRoot)},goog.ui.tree.TreeControl.prototype.getCalculatedIconClass=function(){var t=this.getExpanded(),e=this.getExpandedIconClass();return t&&e?e:(e=this.getIconClass(),!t&&e?e:(e=this.getConfig(),t&&e.cssExpandedRootIcon?e.cssTreeIcon+" "+e.cssExpandedRootIcon:!t&&e.cssCollapsedRootIcon?e.cssTreeIcon+" "+e.cssCollapsedRootIcon:""))},goog.ui.tree.TreeControl.prototype.setSelectedItem=function(t){if(this.selectedItem_!=t){var e=!1;this.selectedItem_&&(e=this.selectedItem_==this.focusedNode_,this.selectedItem_.setSelectedInternal(!1)),(this.selectedItem_=t)&&(t.setSelectedInternal(!0),e&&t.select()),this.dispatchEvent(goog.events.EventType.CHANGE)}},goog.ui.tree.TreeControl.prototype.getSelectedItem=function(){return this.selectedItem_},goog.ui.tree.TreeControl.prototype.setShowLines=function(t){this.showLines_!=t&&(this.showLines_=t,this.isInDocument()&&this.updateLinesAndExpandIcons_())},goog.ui.tree.TreeControl.prototype.getShowLines=function(){return this.showLines_},goog.ui.tree.TreeControl.prototype.updateLinesAndExpandIcons_=function(){function t(i){var r=i.getChildrenElement();if(r){var s=!o||e==i.getParent()&&!n?i.getConfig().cssChildrenNoLines:i.getConfig().cssChildren;r.className=s,(r=i.getExpandIconElement())&&(r.className=i.getExpandIconClass())}i.forEachChild(t)}var e=this,o=e.getShowLines(),n=e.getShowRootLines();t(this)},goog.ui.tree.TreeControl.prototype.setShowRootLines=function(t){this.showRootLines_!=t&&(this.showRootLines_=t,this.isInDocument()&&this.updateLinesAndExpandIcons_())},goog.ui.tree.TreeControl.prototype.getShowRootLines=function(){return this.showRootLines_},goog.ui.tree.TreeControl.prototype.setShowExpandIcons=function(t){this.showExpandIcons_!=t&&(this.showExpandIcons_=t,this.isInDocument()&&this.updateLinesAndExpandIcons_())},goog.ui.tree.TreeControl.prototype.getShowExpandIcons=function(){return this.showExpandIcons_},goog.ui.tree.TreeControl.prototype.setShowRootNode=function(t){if(this.showRootNode_!=t){if(this.showRootNode_=t,this.isInDocument()){var e=this.getRowElement();e&&(e.className=this.getRowClassName())}!t&&this.getSelectedItem()==this&&this.getFirstChild()&&this.setSelectedItem(this.getFirstChild())}},goog.ui.tree.TreeControl.prototype.getShowRootNode=function(){return this.showRootNode_},goog.ui.tree.TreeControl.prototype.initAccessibility=function(){goog.ui.tree.TreeControl.superClass_.initAccessibility.call(this);var t=this.getElement();goog.asserts.assert(t,"The DOM element for the tree cannot be null."),goog.a11y.aria.setRole(t,"tree"),goog.a11y.aria.setState(t,"labelledby",this.getLabelElement().id)},goog.ui.tree.TreeControl.prototype.enterDocument=function(){goog.ui.tree.TreeControl.superClass_.enterDocument.call(this);var t=this.getElement();t.className=this.getConfig().cssRoot,t.setAttribute("hideFocus","true"),this.attachEvents_(),this.initAccessibility()},goog.ui.tree.TreeControl.prototype.exitDocument=function(){goog.ui.tree.TreeControl.superClass_.exitDocument.call(this),this.detachEvents_()},goog.ui.tree.TreeControl.prototype.attachEvents_=function(){var t=this.getElement();t.tabIndex=0;var e=this.keyHandler_=new goog.events.KeyHandler(t),o=this.focusHandler_=new goog.events.FocusHandler(t);this.getHandler().listen(o,goog.events.FocusHandler.EventType.FOCUSOUT,this.handleBlur_).listen(o,goog.events.FocusHandler.EventType.FOCUSIN,this.handleFocus_).listen(e,goog.events.KeyHandler.EventType.KEY,this.handleKeyEvent).listen(t,goog.events.EventType.MOUSEDOWN,this.handleMouseEvent_).listen(t,goog.events.EventType.CLICK,this.handleMouseEvent_).listen(t,goog.events.EventType.DBLCLICK,this.handleMouseEvent_)},goog.ui.tree.TreeControl.prototype.detachEvents_=function(){this.keyHandler_.dispose(),this.keyHandler_=null,this.focusHandler_.dispose(),this.focusHandler_=null},goog.ui.tree.TreeControl.prototype.handleMouseEvent_=function(t){goog.log.fine(this.logger_,"Received event "+t.type);var e=this.getNodeFromEvent_(t);if(e)switch(t.type){case goog.events.EventType.MOUSEDOWN:e.onMouseDown(t);break;case goog.events.EventType.CLICK:e.onClick_(t);break;case goog.events.EventType.DBLCLICK:e.onDoubleClick_(t)}},goog.ui.tree.TreeControl.prototype.handleKeyEvent=function(t){var e;return(e=this.typeAhead_.handleNavigation(t)||this.selectedItem_&&this.selectedItem_.onKeyDown(t)||this.typeAhead_.handleTypeAheadChar(t))&&t.preventDefault(),e},goog.ui.tree.TreeControl.prototype.getNodeFromEvent_=function(t){for(var e=t.target;null!=e;){if(t=goog.ui.tree.BaseNode.allNodes[e.id])return t;if(e==this.getElement())break;e=e.parentNode}return null},goog.ui.tree.TreeControl.prototype.createNode=function(t){return new goog.ui.tree.TreeNode(t||goog.html.SafeHtml.EMPTY,this.getConfig(),this.getDomHelper())},goog.ui.tree.TreeControl.prototype.setNode=function(t){this.typeAhead_.setNodeInMap(t)},goog.ui.tree.TreeControl.prototype.removeNode=function(t){this.typeAhead_.removeNodeFromMap(t)},goog.ui.tree.TreeControl.prototype.clearTypeAhead=function(){this.typeAhead_.clear()},goog.ui.tree.TreeControl.defaultConfig=goog.ui.tree.BaseNode.defaultConfig;var Blockly={};Blockly.Blocks=Object(null),Blockly.Colours={motion:{primary:"#4C97FF",secondary:"#4280D7",tertiary:"#3373CC"},looks:{primary:"#9966FF",secondary:"#855CD6",tertiary:"#774DCB"},sounds:{primary:"#CF63CF",secondary:"#C94FC9",tertiary:"#BD42BD"},control:{primary:"#FFAB19",secondary:"#EC9C13",tertiary:"#CF8B17"},event:{primary:"#FFBF00",secondary:"#E6AC00",tertiary:"#CC9900"},sensing:{primary:"#5CB1D6",secondary:"#47A8D1",tertiary:"#2E8EB8"},pen:{primary:"#0fBD8C",secondary:"#0DA57A",tertiary:"#0B8E69"},operators:{primary:"#59C059",secondary:"#46B946",tertiary:"#389438"},data:{primary:"#FF8C1A",secondary:"#FF8000",tertiary:"#DB6E00"},more:{primary:"#FF6680",secondary:"#FF4D6A",tertiary:"#FF3355"},text:"#575E75",workspace:"#F9F9F9",toolboxHover:"#4C97FF",toolboxSelected:"#e9eef2",toolboxText:"#575E75",toolbox:"#FFFFFF",flyout:"#F9F9F9",scrollbar:"#CECDCE",scrollbarHover:"#CECDCE",textField:"#FFFFFF",insertionMarker:"#000000",insertionMarkerOpacity:.2,dragShadowOpacity:.3,stackGlow:"#FFF200",stackGlowOpacity:1,replacementGlow:"#FFFFFF",replacementGlowOpacity:1,colourPickerStroke:"#FFFFFF",fieldShadow:"rgba(0,0,0,0.1)",dropDownShadow:"rgba(0, 0, 0, .3)",numPadBackground:"#547AB2",numPadBorder:"#435F91",numPadActiveBackground:"#435F91",numPadText:"#FFFFFF",valueReportBackground:"#FFFFFF",valueReportBorder:"#AAAAAA"},Blockly.Touch={},Blockly.Touch.touchIdentifier_=null,Blockly.Touch.TOUCH_MAP={},goog.events.BrowserFeature.TOUCH_ENABLED&&(Blockly.Touch.TOUCH_MAP={mousedown:["touchstart"],mousemove:["touchmove"],mouseup:["touchend","touchcancel"]}),Blockly.longPid_=0,Blockly.longStart_=function(t,e){Blockly.longStop_(),1==t.changedTouches.length&&(Blockly.longPid_=setTimeout(function(){t.button=2,t.clientX=t.changedTouches[0].clientX,t.clientY=t.changedTouches[0].clientY,e&&e.handleRightClick(t)},Blockly.LONGPRESS))},Blockly.longStop_=function(){Blockly.longPid_&&(clearTimeout(Blockly.longPid_),Blockly.longPid_=0)},Blockly.Touch.clearTouchIdentifier=function(){Blockly.Touch.touchIdentifier_=null},Blockly.Touch.shouldHandleEvent=function(t){return!Blockly.Touch.isMouseOrTouchEvent(t)||Blockly.Touch.checkTouchIdentifier(t)},Blockly.Touch.getTouchIdentifierFromEvent=function(t){return t.changedTouches&&t.changedTouches[0]&&void 0!=t.changedTouches[0].identifier&&null!=t.changedTouches[0].identifier?t.changedTouches[0].identifier:"mouse"},Blockly.Touch.checkTouchIdentifier=function(t){var e=Blockly.Touch.getTouchIdentifierFromEvent(t);return void 0!=Blockly.Touch.touchIdentifier_&&null!=Blockly.Touch.touchIdentifier_?Blockly.Touch.touchIdentifier_==e:("mousedown"==t.type||"touchstart"==t.type)&&(Blockly.Touch.touchIdentifier_=e,!0)},Blockly.Touch.setClientFromTouch=function(t){if(goog.string.startsWith(t.type,"touch")){var e=t.changedTouches[0];t.clientX=e.clientX,t.clientY=e.clientY}},Blockly.Touch.isMouseOrTouchEvent=function(t){return goog.string.startsWith(t.type,"touch")||goog.string.startsWith(t.type,"mouse")},Blockly.Touch.splitEventByTouches=function(t){var e=[];if(t.changedTouches)for(var o=0;o<t.changedTouches.length;o++)e[o]={type:t.type,changedTouches:[t.changedTouches[o]],target:t.target,stopPropagation:function(){t.stopPropagation()},preventDefault:function(){t.preventDefault()}};else e.push(t);return e},Blockly.VariableModel=function(t,e,o,n){this.workspace=t,this.name=e,this.type=o||"",this.id_=n||Blockly.utils.genUid(),Blockly.Events.fire(new Blockly.Events.VarCreate(this))},Blockly.VariableModel.prototype.getId=function(){return this.id_},Blockly.VariableModel.compareByName=function(t,e){return goog.string.caseInsensitiveCompare(t.name,e.name)},Blockly.VariableMap=function(t){this.variableMap_={},this.workspace=t},Blockly.VariableMap.prototype.clear=function(){this.variableMap_=Object(null)},Blockly.VariableMap.prototype.renameVariable=function(t,e){var o=this.getVariable(e),n=-1,i=-1,r="";(t||o)&&(r=(t||o).type);var s=this.getVariablesOfType(r);t&&(n=s.indexOf(t)),o&&(i=s.indexOf(o)),-1==n&&-1==i?(this.createVariable(e,""),console.log("Tried to rename an non-existent variable.")):n==i||-1!=n&&-1==i?(o=this.variableMap_[r][n],Blockly.Events.fire(new Blockly.Events.VarRename(o,e)),o.name=e):-1!=n&&-1!=i&&(o=this.variableMap_[r][i],Blockly.Events.fire(new Blockly.Events.VarRename(o,e)),Blockly.Events.fire(new Blockly.Events.VarDelete(this.variableMap_[r][n])),o.name=e,this.variableMap_[r].splice(n,1))},Blockly.VariableMap.prototype.createVariable=function(t,e,o){var n=this.getVariable(t);if(n){if(e&&n.type!=e)throw Error('Variable "'+t+'" is already in use and its type is "'+n.type+'" which conflicts with the passed in type, "'+e+'".');if(o&&n.getId()!=o)throw Error('Variable "'+t+'" is already in use and its id is "'+n.getId()+'" which conflicts with the passed in id, "'+o+'".');return n}if(o&&this.getVariableById(o))throw Error('Variable id, "'+o+'", is already in use.');return o=o||Blockly.utils.genUid(),e=e||"",n=new Blockly.VariableModel(this.workspace,t,e,o),this.variableMap_[e]?this.variableMap_[e].push(n):this.variableMap_[e]=[n],n},Blockly.VariableMap.prototype.deleteVariable=function(t){for(var e,o=this.variableMap_[t.type],n=0;e=o[n];n++)if(e.getId()==t.getId()){o.splice(n,1),Blockly.Events.fire(new Blockly.Events.VarDelete(t));break}},Blockly.VariableMap.prototype.getVariable=function(t){for(var e=Object.keys(this.variableMap_),o=0;o<e.length;o++)for(var n,i=e[o],r=0;n=this.variableMap_[i][r];r++)if(Blockly.Names.equals(n.name,t))return n;return null},Blockly.VariableMap.prototype.getVariableById=function(t){for(var e=Object.keys(this.variableMap_),o=0;o<e.length;o++)for(var n,i=e[o],r=0;n=this.variableMap_[i][r];r++)if(n.getId()==t)return n;return null},Blockly.VariableMap.prototype.getVariablesOfType=function(t){return(t=this.variableMap_[t||""])?t.slice():[]},Blockly.VariableMap.prototype.getVariableTypes=function(){return Object.keys(this.variableMap_)},Blockly.VariableMap.prototype.getAllVariables=function(){for(var t=[],e=Object.keys(this.variableMap_),o=0;o<e.length;o++)t=t.concat(this.variableMap_[e[o]]);return t},Blockly.Workspace=function(t){this.id=Blockly.utils.genUid(),Blockly.Workspace.WorkspaceDB_[this.id]=this,this.options=t||{},this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.topBlocks_=[],this.listeners_=[],this.tapListeners_=[],this.undoStack_=[],this.redoStack_=[],this.blockDB_=Object.create(null),this.variableMap_=new Blockly.VariableMap(this)},Blockly.Workspace.prototype.rendered=!1,Blockly.Workspace.prototype.MAX_UNDO=1024,Blockly.Workspace.prototype.dispose=function(){this.listeners_.length=0,this.clear(),delete Blockly.Workspace.WorkspaceDB_[this.id]},Blockly.Workspace.SCAN_ANGLE=3,Blockly.Workspace.prototype.addTopBlock=function(t){if(this.topBlocks_.push(t),this.isFlyout){t=Blockly.Variables.allUsedVariables(t);for(var e,o=0;e=t[o];o++)this.getVariable(e)||this.createVariable(e)}},Blockly.Workspace.prototype.removeTopBlock=function(t){if(!goog.array.remove(this.topBlocks_,t))throw"Block not present in workspace's list of top-most blocks."},Blockly.Workspace.prototype.getTopBlocks=function(t){var e=[].concat(this.topBlocks_);if(t&&1<e.length){var o=Math.sin(goog.math.toRadians(Blockly.Workspace.SCAN_ANGLE));this.RTL&&(o*=-1),e.sort(function(t,e){var n=t.getRelativeToSurfaceXY(),i=e.getRelativeToSurfaceXY();return n.y+o*n.x-(i.y+o*i.x)})}return e},Blockly.Workspace.prototype.getAllBlocks=function(){for(var t=this.getTopBlocks(!1),e=0;e<t.length;e++)t.push.apply(t,t[e].getChildren());return t},Blockly.Workspace.prototype.clear=function(){var t=Blockly.Events.getGroup();for(t||Blockly.Events.setGroup(!0);this.topBlocks_.length;)this.topBlocks_[0].dispose();t||Blockly.Events.setGroup(!1),this.variableMap_.clear(),Blockly.DropDownDiv&&Blockly.DropDownDiv.hideWithoutAnimation(),Blockly.WidgetDiv&&Blockly.WidgetDiv.hide(!0)},Blockly.Workspace.prototype.updateVariableStore=function(t){if(!this.isFlyout){for(var e,o=Blockly.Variables.allUsedVariables(this),n=[],i=0;e=o[i];i++){var r=this.getVariable(e);r?n.push({name:r.name,type:r.type,id:r.getId()}):n.push({name:e,type:null,id:null})}for(t&&this.variableMap_.clear(),i=0;t=n[i];i++)this.getVariable(t.name)||this.createVariable(t.name,t.type,t.id)}},Blockly.Workspace.prototype.renameVariableInternal_=function(t,e){var o=this.getVariable(e);if(t&&o&&t.type!=o.type)throw Error('Variable "'+t.name+'" is type "'+t.type+'" and variable "'+e+'" is type "'+o.type+'". Both must be the same type.');if(o&&o.name!=e)var n=o.name;Blockly.Events.setGroup(!0),o=this.getAllBlocks();for(var i=0;i<o.length;i++)o[i].renameVar(t.name,e),n&&o[i].renameVar(n,e);this.variableMap_.renameVariable(t,e),Blockly.Events.setGroup(!1)},Blockly.Workspace.prototype.renameVariable=function(t,e){var o=this.getVariable(t);this.renameVariableInternal_(o,e)},Blockly.Workspace.prototype.renameVariableById=function(t,e){var o=this.getVariableById(t);this.renameVariableInternal_(o,e)},Blockly.Workspace.prototype.createVariable=function(t,e,o){if(t.toLowerCase()!=Blockly.Variables.noVariableText())return this.variableMap_.createVariable(t,e,o)},Blockly.Workspace.prototype.getVariableUses=function(t){for(var e=[],o=this.getAllBlocks(),n=0;n<o.length;n++){var i=o[n].getVars();if(i)for(var r=0;r<i.length;r++){var s=i[r];s&&t&&Blockly.Names.equals(s,t)&&e.push(o[n])}}return e},Blockly.Workspace.prototype.deleteVariable=function(t){for(var e,o=this.getVariableUses(t),n=0;e=o[n];n++)if("procedures_defnoreturn"==e.type||"procedures_defreturn"==e.type)return o=e.getFieldValue("NAME"),void Blockly.alert(Blockly.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",t).replace("%2",o));var i=this,r=i.getVariable(t);1<o.length?Blockly.confirm(Blockly.Msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",o.length).replace("%2",t),function(t){t&&i.deleteVariableInternal_(r)}):this.deleteVariableInternal_(r)},Blockly.Workspace.prototype.deleteVariableById=function(t){var e=this.getVariableById(t);e?this.deleteVariableInternal_(e):console.warn("Can't delete non-existant variable: "+t)},Blockly.Workspace.prototype.deleteVariableInternal_=function(t){var e=this.getVariableUses(t.name);Blockly.Events.setGroup(!0);for(var o=0;o<e.length;o++)e[o].dispose(!0,!1);this.variableMap_.deleteVariable(t),Blockly.Events.setGroup(!1)},Blockly.Workspace.prototype.variableIndexOf=function(){return console.warn("Deprecated call to Blockly.Workspace.prototype.variableIndexOf"),-1},Blockly.Workspace.prototype.getVariable=function(t){return this.variableMap_.getVariable(t)},Blockly.Workspace.prototype.getVariableById=function(t){return this.variableMap_.getVariableById(t)},Blockly.Workspace.prototype.getWidth=function(){return 0},Blockly.Workspace.prototype.newBlock=function(t,e){return new Blockly.Block(this,t,e)},Blockly.Workspace.prototype.undo=function(t){var e=t?this.redoStack_:this.undoStack_,o=t?this.undoStack_:this.redoStack_,n=e.pop();if(n){for(var i=[n];e.length&&n.group&&n.group==e[e.length-1].group;)i.push(e.pop());for(e=0;n=i[e];e++)o.push(n);i=Blockly.Events.filter(i,t),Blockly.Events.recordUndo=!1;try{for(e=0;n=i[e];e++)n.run(t)}finally{Blockly.Events.recordUndo=!0}}},Blockly.Workspace.prototype.clearUndo=function(){this.undoStack_.length=0,this.redoStack_.length=0,Blockly.Events.clearPendingUndo()},Blockly.Workspace.prototype.addChangeListener=function(t){return this.listeners_.push(t),t},Blockly.Workspace.prototype.removeChangeListener=function(t){goog.array.remove(this.listeners_,t)},Blockly.Workspace.prototype.fireChangeListener=function(t){t.recordUndo&&(this.undoStack_.push(t),this.redoStack_.length=0,this.undoStack_.length>this.MAX_UNDO&&this.undoStack_.unshift());for(var e,o=this.listeners_.slice(),n=0;e=o[n];n++)e(t)},Blockly.Workspace.prototype.getBlockById=function(t){var e=this.blockDB_[t];return!e&&this.getFlyout()&&this.getFlyout().getWorkspace()&&(e=this.getFlyout().getWorkspace().blockDB_[t]),e||null},Blockly.Workspace.prototype.getFlyout=function(){return null},Blockly.Workspace.prototype.allInputsFilled=function(t){for(var e,o=this.getTopBlocks(!1),n=0;e=o[n];n++)if(!e.allInputsFilled(t))return!1;return!0},Blockly.Workspace.prototype.getVariablesOfType=function(t){return this.variableMap_.getVariablesOfType(t)},Blockly.Workspace.prototype.getVariableTypes=function(){return this.variableMap_.getVariableTypes()},Blockly.Workspace.prototype.getAllVariables=function(){return this.variableMap_.getAllVariables()},Blockly.Workspace.WorkspaceDB_=Object.create(null),Blockly.Workspace.getById=function(t){return Blockly.Workspace.WorkspaceDB_[t]||null},Blockly.Workspace.prototype.clear=Blockly.Workspace.prototype.clear,Blockly.Workspace.prototype.clearUndo=Blockly.Workspace.prototype.clearUndo,Blockly.Workspace.prototype.addChangeListener=Blockly.Workspace.prototype.addChangeListener,Blockly.Workspace.prototype.removeChangeListener=Blockly.Workspace.prototype.removeChangeListener,Blockly.Bubble=function(t,e,o,n,i,r){this.workspace_=t,this.content_=e,this.shape_=o,o=Blockly.Bubble.ARROW_ANGLE,this.workspace_.RTL&&(o=-o),this.arrow_radians_=goog.math.toRadians(o),t.getBubbleCanvas().appendChild(this.createDom_(e,!(!i||!r))),this.setAnchorLocation(n),i&&r||(e=this.content_.getBBox(),i=e.width+2*Blockly.Bubble.BORDER_WIDTH,r=e.height+2*Blockly.Bubble.BORDER_WIDTH),this.setBubbleSize(i,r),this.positionBubble_(),this.renderArrow_(),this.rendered_=!0,t.options.readOnly||(Blockly.bindEventWithChecks_(this.bubbleBack_,"mousedown",this,this.bubbleMouseDown_),this.resizeGroup_&&Blockly.bindEventWithChecks_(this.resizeGroup_,"mousedown",this,this.resizeMouseDown_))},Blockly.Bubble.BORDER_WIDTH=6,Blockly.Bubble.ARROW_THICKNESS=5,Blockly.Bubble.ARROW_ANGLE=20,Blockly.Bubble.ARROW_BEND=4,Blockly.Bubble.ANCHOR_RADIUS=8,Blockly.Bubble.onMouseUpWrapper_=null,Blockly.Bubble.onMouseMoveWrapper_=null,Blockly.Bubble.prototype.resizeCallback_=null,Blockly.Bubble.unbindDragEvents_=function(){Blockly.Bubble.onMouseUpWrapper_&&(Blockly.unbindEvent_(Blockly.Bubble.onMouseUpWrapper_),Blockly.Bubble.onMouseUpWrapper_=null),Blockly.Bubble.onMouseMoveWrapper_&&(Blockly.unbindEvent_(Blockly.Bubble.onMouseMoveWrapper_),Blockly.Bubble.onMouseMoveWrapper_=null)},Blockly.Bubble.bubbleMouseUp_=function(){Blockly.Touch.clearTouchIdentifier(),Blockly.Bubble.unbindDragEvents_()},Blockly.Bubble.prototype.rendered_=!1,Blockly.Bubble.prototype.anchorXY_=null,Blockly.Bubble.prototype.relativeLeft_=0,Blockly.Bubble.prototype.relativeTop_=0,Blockly.Bubble.prototype.width_=0,Blockly.Bubble.prototype.height_=0,Blockly.Bubble.prototype.autoLayout_=!0,Blockly.Bubble.prototype.createDom_=function(t,e){this.bubbleGroup_=Blockly.utils.createSvgElement("g",{},null);var o={filter:"url(#"+this.workspace_.options.embossFilterId+")"};return-1!=goog.userAgent.getUserAgentString().indexOf("JavaFX")&&(o={}),o=Blockly.utils.createSvgElement("g",o,this.bubbleGroup_),this.bubbleArrow_=Blockly.utils.createSvgElement("path",{},o),this.bubbleBack_=Blockly.utils.createSvgElement("rect",{class:"blocklyDraggable",x:0,y:0,rx:Blockly.Bubble.BORDER_WIDTH,ry:Blockly.Bubble.BORDER_WIDTH},o),e?(this.resizeGroup_=Blockly.utils.createSvgElement("g",{class:this.workspace_.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.bubbleGroup_),o=2*Blockly.Bubble.BORDER_WIDTH,Blockly.utils.createSvgElement("polygon",{points:"0,x x,x x,0".replace(/x/g,o.toString())},this.resizeGroup_),Blockly.utils.createSvgElement("line",{class:"blocklyResizeLine",x1:o/3,y1:o-1,x2:o-1,y2:o/3},this.resizeGroup_),Blockly.utils.createSvgElement("line",{class:"blocklyResizeLine",x1:2*o/3,y1:o-1,x2:o-1,y2:2*o/3},this.resizeGroup_)):this.resizeGroup_=null,this.bubbleGroup_.appendChild(t),this.bubbleGroup_},Blockly.Bubble.prototype.bubbleMouseDown_=function(t){this.promote_(),Blockly.Bubble.unbindDragEvents_(),Blockly.utils.isRightButton(t)?t.stopPropagation():Blockly.utils.isTargetInput(t)||(this.workspace_.startDrag(t,new goog.math.Coordinate(this.workspace_.RTL?-this.relativeLeft_:this.relativeLeft_,this.relativeTop_)),Blockly.Bubble.onMouseUpWrapper_=Blockly.bindEventWithChecks_(document,"mouseup",this,Blockly.Bubble.bubbleMouseUp_),Blockly.Bubble.onMouseMoveWrapper_=Blockly.bindEventWithChecks_(document,"mousemove",this,this.bubbleMouseMove_),Blockly.hideChaff(),t.stopPropagation())},Blockly.Bubble.prototype.bubbleMouseMove_=function(t){this.autoLayout_=!1,t=this.workspace_.moveDrag(t),this.relativeLeft_=this.workspace_.RTL?-t.x:t.x,this.relativeTop_=t.y,this.positionBubble_(),this.renderArrow_()},Blockly.Bubble.prototype.resizeMouseDown_=function(t){this.promote_(),Blockly.Bubble.unbindDragEvents_(),Blockly.utils.isRightButton(t)||(this.workspace_.startDrag(t,new goog.math.Coordinate(this.workspace_.RTL?-this.width_:this.width_,this.height_)),Blockly.Bubble.onMouseUpWrapper_=Blockly.bindEventWithChecks_(document,"mouseup",this,Blockly.Bubble.bubbleMouseUp_),Blockly.Bubble.onMouseMoveWrapper_=Blockly.bindEventWithChecks_(document,"mousemove",this,this.resizeMouseMove_),Blockly.hideChaff()),t.stopPropagation()},Blockly.Bubble.prototype.resizeMouseMove_=function(t){this.autoLayout_=!1,t=this.workspace_.moveDrag(t),this.setBubbleSize(this.workspace_.RTL?-t.x:t.x,t.y),this.workspace_.RTL&&this.positionBubble_()},Blockly.Bubble.prototype.registerResizeEvent=function(t){this.resizeCallback_=t},Blockly.Bubble.prototype.promote_=function(){this.bubbleGroup_.parentNode.appendChild(this.bubbleGroup_)},Blockly.Bubble.prototype.setAnchorLocation=function(t){this.anchorXY_=t,this.rendered_&&this.positionBubble_()},Blockly.Bubble.prototype.layoutBubble_=function(){var t=-this.width_/4,e=-this.height_-Blockly.BlockSvg.MIN_BLOCK_Y,o=this.workspace_.getMetrics();o.viewWidth/=this.workspace_.scale,o.viewLeft/=this.workspace_.scale;var n=this.anchorXY_.x;this.workspace_.RTL?n-o.viewLeft-t-this.width_<Blockly.Scrollbar.scrollbarThickness?t=n-o.viewLeft-this.width_-Blockly.Scrollbar.scrollbarThickness:n-o.viewLeft-t>o.viewWidth&&(t=n-o.viewLeft-o.viewWidth):n+t<o.viewLeft?t=o.viewLeft-n:o.viewLeft+o.viewWidth<n+t+this.width_+Blockly.BlockSvg.SEP_SPACE_X+Blockly.Scrollbar.scrollbarThickness&&(t=o.viewLeft+o.viewWidth-n-this.width_-Blockly.Scrollbar.scrollbarThickness),this.anchorXY_.y+e<o.viewTop&&(e=this.shape_.getBBox().height),this.relativeLeft_=t,this.relativeTop_=e},Blockly.Bubble.prototype.positionBubble_=function(){var t=this.anchorXY_.x;t=this.workspace_.RTL?t-(this.relativeLeft_+this.width_):t+this.relativeLeft_,this.bubbleGroup_.setAttribute("transform","translate("+t+","+(this.relativeTop_+this.anchorXY_.y)+")")},Blockly.Bubble.prototype.getBubbleSize=function(){return{width:this.width_,height:this.height_}},Blockly.Bubble.prototype.setBubbleSize=function(t,e){var o=2*Blockly.Bubble.BORDER_WIDTH;t=Math.max(t,o+45),e=Math.max(e,o+20),this.width_=t,this.height_=e,this.bubbleBack_.setAttribute("width",t),this.bubbleBack_.setAttribute("height",e),this.resizeGroup_&&(this.workspace_.RTL?this.resizeGroup_.setAttribute("transform","translate("+2*Blockly.Bubble.BORDER_WIDTH+","+(e-o)+") scale(-1 1)"):this.resizeGroup_.setAttribute("transform","translate("+(t-o)+","+(e-o)+")")),this.rendered_&&(this.autoLayout_&&this.layoutBubble_(),this.positionBubble_(),this.renderArrow_()),this.resizeCallback_&&this.resizeCallback_()},Blockly.Bubble.prototype.renderArrow_=function(){var t=[],e=this.width_/2,o=this.height_/2,n=-this.relativeLeft_,i=-this.relativeTop_;if(e==n&&o==i)t.push("M "+e+","+o);else{i-=o,n-=e,this.workspace_.RTL&&(n*=-1);var r=Math.sqrt(i*i+n*n),s=Math.acos(n/r);0>i&&(s=2*Math.PI-s);var a=s+Math.PI/2;a>2*Math.PI&&(a-=2*Math.PI);var l=Math.sin(a),c=Math.cos(a),u=this.getBubbleSize();a=(u.width+u.height)/Blockly.Bubble.ARROW_THICKNESS,a=Math.min(a,u.width,u.height)/4,u=1-Blockly.Bubble.ANCHOR_RADIUS/r,n=e+u*n,i=o+u*i,u=e+a*c;var h=o+a*l;e-=a*c,o-=a*l,l=s+this.arrow_radians_,l>2*Math.PI&&(l-=2*Math.PI),s=Math.sin(l)*r/Blockly.Bubble.ARROW_BEND,r=Math.cos(l)*r/Blockly.Bubble.ARROW_BEND,t.push("M"+u+","+h),t.push("C"+(u+r)+","+(h+s)+" "+n+","+i+" "+n+","+i),t.push("C"+n+","+i+" "+(e+r)+","+(o+s)+" "+e+","+o)}t.push("z"),this.bubbleArrow_.setAttribute("d",t.join(" "))},Blockly.Bubble.prototype.setColour=function(t){this.bubbleBack_.setAttribute("fill",t),this.bubbleArrow_.setAttribute("fill",t)},Blockly.Bubble.prototype.dispose=function(){Blockly.Bubble.unbindDragEvents_(),goog.dom.removeNode(this.bubbleGroup_),this.shape_=this.content_=this.workspace_=this.resizeGroup_=this.bubbleBack_=this.bubbleArrow_=this.bubbleGroup_=null},Blockly.Icon=function(t){this.block_=t},Blockly.Icon.prototype.collapseHidden=!0,Blockly.Icon.prototype.SIZE=17,Blockly.Icon.prototype.bubble_=null,Blockly.Icon.prototype.iconXY_=null,Blockly.Icon.prototype.createIcon=function(){this.iconGroup_||(this.iconGroup_=Blockly.utils.createSvgElement("g",{class:"blocklyIconGroup"},null),this.block_.isInFlyout&&Blockly.utils.addClass(this.iconGroup_,"blocklyIconGroupReadonly"),this.drawIcon_(this.iconGroup_),this.block_.getSvgRoot().appendChild(this.iconGroup_),Blockly.bindEventWithChecks_(this.iconGroup_,"mouseup",this,this.iconClick_),this.updateEditable())},Blockly.Icon.prototype.dispose=function(){goog.dom.removeNode(this.iconGroup_),this.iconGroup_=null,this.setVisible(!1),this.block_=null},Blockly.Icon.prototype.updateEditable=function(){},Blockly.Icon.prototype.isVisible=function(){return!!this.bubble_},Blockly.Icon.prototype.iconClick_=function(t){this.block_.workspace.isDragging()||this.block_.isInFlyout||Blockly.utils.isRightButton(t)||this.setVisible(!this.isVisible())},Blockly.Icon.prototype.updateColour=function(){this.isVisible()&&this.bubble_.setColour(this.block_.getColour())},Blockly.Icon.prototype.renderIcon=function(t){if(this.collapseHidden&&this.block_.isCollapsed())return this.iconGroup_.setAttribute("display","none"),t;this.iconGroup_.setAttribute("display","block");var e=this.SIZE;return this.block_.RTL&&(t-=e),this.iconGroup_.setAttribute("transform","translate("+t+",5)"),this.computeIconLocation(),t=this.block_.RTL?t-Blockly.BlockSvg.SEP_SPACE_X:t+(e+Blockly.BlockSvg.SEP_SPACE_X)},Blockly.Icon.prototype.setIconLocation=function(t){this.iconXY_=t,this.isVisible()&&this.bubble_.setAnchorLocation(t)},Blockly.Icon.prototype.computeIconLocation=function(){var t=this.block_.getRelativeToSurfaceXY(),e=Blockly.utils.getRelativeXY(this.iconGroup_);t=new goog.math.Coordinate(t.x+e.x+this.SIZE/2,t.y+e.y+this.SIZE/2),goog.math.Coordinate.equals(this.getIconLocation(),t)||this.setIconLocation(t)},Blockly.Icon.prototype.getIconLocation=function(){return this.iconXY_},Blockly.Comment=function(t){Blockly.Comment.superClass_.constructor.call(this,t),this.createIcon()},goog.inherits(Blockly.Comment,Blockly.Icon),Blockly.Comment.prototype.text_="",Blockly.Comment.prototype.width_=160,Blockly.Comment.prototype.height_=80,Blockly.Comment.prototype.drawIcon_=function(t){Blockly.utils.createSvgElement("circle",{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},t),Blockly.utils.createSvgElement("path",{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.405 0.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25 -1.201,0.998 -1.201,1.528 -1.204,2.19z"},t),Blockly.utils.createSvgElement("rect",{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},t)},Blockly.Comment.prototype.createEditor_=function(){this.foreignObject_=Blockly.utils.createSvgElement("foreignObject",{x:Blockly.Bubble.BORDER_WIDTH,y:Blockly.Bubble.BORDER_WIDTH},null);var t=document.createElementNS(Blockly.HTML_NS,"body");t.setAttribute("xmlns",Blockly.HTML_NS),t.className="blocklyMinimalBody";var e=document.createElementNS(Blockly.HTML_NS,"textarea");return e.className="blocklyCommentTextarea",e.setAttribute("dir",this.block_.RTL?"RTL":"LTR"),t.appendChild(e),this.textarea_=e,this.foreignObject_.appendChild(t),Blockly.bindEventWithChecks_(e,"mouseup",this,this.textareaFocus_),Blockly.bindEventWithChecks_(e,"wheel",this,function(t){t.stopPropagation()}),Blockly.bindEventWithChecks_(e,"change",this,function(){this.text_!=e.value&&(Blockly.Events.fire(new Blockly.Events.BlockChange(this.block_,"comment",null,this.text_,e.value)),this.text_=e.value)}),setTimeout(function(){e.focus()},0),this.foreignObject_},Blockly.Comment.prototype.updateEditable=function(){this.isVisible()&&(this.setVisible(!1),this.setVisible(!0)),Blockly.Icon.prototype.updateEditable.call(this)},Blockly.Comment.prototype.resizeBubble_=function(){if(this.isVisible()){var t=this.bubble_.getBubbleSize(),e=2*Blockly.Bubble.BORDER_WIDTH;this.foreignObject_.setAttribute("width",t.width-e),this.foreignObject_.setAttribute("height",t.height-e),this.textarea_.style.width=t.width-e-4+"px",this.textarea_.style.height=t.height-e-4+"px"}},Blockly.Comment.prototype.setVisible=function(t){if(t!=this.isVisible())if(Blockly.Events.fire(new Blockly.Events.Ui(this.block_,"commentOpen",!t,t)),!this.block_.isEditable()&&!this.textarea_||goog.userAgent.IE)Blockly.Warning.prototype.setVisible.call(this,t);else{var e=this.getText(),o=this.getBubbleSize();t?(this.bubble_=new Blockly.Bubble(this.block_.workspace,this.createEditor_(),this.block_.svgPath_,this.iconXY_,this.width_,this.height_),this.bubble_.registerResizeEvent(this.resizeBubble_.bind(this)),this.updateColour()):(this.bubble_.dispose(),this.foreignObject_=this.textarea_=this.bubble_=null),this.setText(e),this.setBubbleSize(o.width,o.height)}},Blockly.Comment.prototype.textareaFocus_=function(){this.bubble_.promote_(),this.textarea_.focus()},Blockly.Comment.prototype.getBubbleSize=function(){return this.isVisible()?this.bubble_.getBubbleSize():{width:this.width_,height:this.height_}},Blockly.Comment.prototype.setBubbleSize=function(t,e){this.textarea_?this.bubble_.setBubbleSize(t,e):(this.width_=t,this.height_=e)},Blockly.Comment.prototype.getText=function(){return this.textarea_?this.textarea_.value:this.text_},Blockly.Comment.prototype.setText=function(t){this.text_!=t&&(Blockly.Events.fire(new Blockly.Events.BlockChange(this.block_,"comment",null,this.text_,t)),this.text_=t),this.textarea_&&(this.textarea_.value=t)},Blockly.Comment.prototype.dispose=function(){Blockly.Events.isEnabled()&&this.setText(""),this.block_.comment=null,Blockly.Icon.prototype.dispose.call(this)},Blockly.Connection=function(t,e){this.sourceBlock_=t,this.type=e,t.workspace.connectionDBList&&(this.db_=t.workspace.connectionDBList[e],this.dbOpposite_=t.workspace.connectionDBList[Blockly.OPPOSITE_TYPE[e]],this.hidden_=!this.db_)},Blockly.Connection.CAN_CONNECT=0,Blockly.Connection.REASON_SELF_CONNECTION=1,Blockly.Connection.REASON_WRONG_TYPE=2,Blockly.Connection.REASON_TARGET_NULL=3,Blockly.Connection.REASON_CHECKS_FAILED=4,Blockly.Connection.REASON_DIFFERENT_WORKSPACES=5,Blockly.Connection.REASON_SHADOW_PARENT=6,Blockly.Connection.prototype.targetConnection=null,Blockly.Connection.prototype.check_=null,Blockly.Connection.prototype.shadowDom_=null,Blockly.Connection.prototype.x_=0,Blockly.Connection.prototype.y_=0,Blockly.Connection.prototype.inDB_=!1,Blockly.Connection.prototype.db_=null,Blockly.Connection.prototype.dbOpposite_=null,Blockly.Connection.prototype.hidden_=null,Blockly.Connection.prototype.connect_=function(t){var e=this,o=e.getSourceBlock(),n=t.getSourceBlock(),i=!1;if(e==o.getFirstStatementConnection()&&(i=!0),t.isConnected()){if(i)var r=t.targetConnection;t.disconnect()}if(e.isConnected()){var s=e.targetBlock(),a=e.getShadowDom();if(e.setShadowDom(null),s.isShadow())a=Blockly.Xml.blockToDom(s),s.dispose(),s=null;else if(e.type==Blockly.NEXT_STATEMENT){if(!s.previousConnection)throw"Orphan block does not have a previous connection.";for(var l=n;l.nextConnection;){var c=l.getNextBlock();if(!c||c.isShadow()){s.previousConnection.checkType_(l.nextConnection)&&(l.nextConnection.connect(s.previousConnection),s=null);break}l=c}}if(s&&(e.disconnect(),Blockly.Events.recordUndo)){var u=Blockly.Events.getGroup();setTimeout(function(){s.workspace&&!s.getParent()&&(Blockly.Events.setGroup(u),s.outputConnection?s.outputConnection.bumpAwayFrom_(e):s.previousConnection&&s.previousConnection.bumpAwayFrom_(e),Blockly.Events.setGroup(!1))},Blockly.BUMP_DELAY)}e.setShadowDom(a)}i&&r&&r.connect(o.previousConnection);var h;Blockly.Events.isEnabled()&&(h=new Blockly.Events.BlockMove(n)),Blockly.Connection.connectReciprocally_(e,t),n.setParent(o),h&&(h.recordNew(),Blockly.Events.fire(h))},Blockly.Connection.prototype.dispose=function(){if(this.isConnected())throw"Disconnect connection before disposing of it.";this.inDB_&&this.db_.removeConnection_(this),this.dbOpposite_=this.db_=null},Blockly.Connection.prototype.isConnectedToNonInsertionMarker=function(){return this.targetConnection&&!this.targetBlock().isInsertionMarker()},Blockly.Connection.prototype.getSourceBlock=function(){return this.sourceBlock_},Blockly.Connection.prototype.isSuperior=function(){return this.type==Blockly.INPUT_VALUE||this.type==Blockly.NEXT_STATEMENT},Blockly.Connection.prototype.isConnected=function(){return!!this.targetConnection},Blockly.Connection.prototype.canConnectWithReason_=function(t){if(!t)return Blockly.Connection.REASON_TARGET_NULL;if(this.isSuperior())var e=this.sourceBlock_,o=t.getSourceBlock();else o=this.sourceBlock_,e=t.getSourceBlock();return e&&e==o?Blockly.Connection.REASON_SELF_CONNECTION:t.type!=Blockly.OPPOSITE_TYPE[this.type]?Blockly.Connection.REASON_WRONG_TYPE:e&&o&&e.workspace!==o.workspace?Blockly.Connection.REASON_DIFFERENT_WORKSPACES:this.checkType_(t)?e.isShadow()&&!o.isShadow()?Blockly.Connection.REASON_SHADOW_PARENT:Blockly.Connection.CAN_CONNECT:Blockly.Connection.REASON_CHECKS_FAILED},Blockly.Connection.prototype.checkConnection_=function(t){switch(this.canConnectWithReason_(t)){case Blockly.Connection.CAN_CONNECT:break;case Blockly.Connection.REASON_SELF_CONNECTION:throw"Attempted to connect a block to itself.";case Blockly.Connection.REASON_DIFFERENT_WORKSPACES:throw"Blocks not on same workspace.";case Blockly.Connection.REASON_WRONG_TYPE:throw"Attempt to connect incompatible types.";case Blockly.Connection.REASON_TARGET_NULL:throw"Target connection is null.";case Blockly.Connection.REASON_CHECKS_FAILED:throw"Connection checks failed. "+this+" expected "+this.check_+", found "+t.check_;case Blockly.Connection.REASON_SHADOW_PARENT:throw"Connecting non-shadow to shadow block.";default:throw"Unknown connection failure: this should never happen!"}},Blockly.Connection.prototype.canConnectToPrevious_=function(t){if(this.targetConnection||-1!=Blockly.draggingConnections_.indexOf(t))return!1;var e=this.sourceBlock_.getFirstStatementConnection(),o=this==e,n=this==this.sourceBlock_.nextConnection;return!(null!=e&&!o&&!n)&&(e=null!=this.sourceBlock_.previousConnection,!(!o||!e)||(n||o&&!e?!t.targetConnection||(t=t.targetBlock(),!!t.isInsertionMarker()&&!t.getPreviousBlock()):void 0))},Blockly.Connection.prototype.isConnectionAllowed=function(t){if(t.sourceBlock_.isInsertionMarker()||this.canConnectWithReason_(t)!=Blockly.Connection.CAN_CONNECT)return!1;var e=this.sourceBlock_.getFirstStatementConnection();switch(t.type){case Blockly.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(t);case Blockly.OUTPUT_VALUE:return!1;case Blockly.INPUT_VALUE:if(t.targetConnection&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;case Blockly.NEXT_STATEMENT:if(e&&this==this.sourceBlock_.previousConnection&&t.isConnectedToNonInsertionMarker()&&!e.targetConnection||t.isConnectedToNonInsertionMarker()&&!this.sourceBlock_.nextConnection&&!t.targetBlock().isShadow()&&t.targetBlock().nextConnection)return!1;break;default:throw"Unknown connection type in isConnectionAllowed"}return-1==Blockly.draggingConnections_.indexOf(t)},Blockly.Connection.prototype.connect=function(t){this.targetConnection!=t&&(this.checkConnection_(t),this.isSuperior()?this.connect_(t):t.connect_(this))},Blockly.Connection.connectReciprocally_=function(t,e){goog.asserts.assert(t&&e,"Cannot connect null connections."),t.targetConnection=e,e.targetConnection=t},Blockly.Connection.singleConnection_=function(t,e){for(var o=!1,n=0;n<t.inputList.length;n++){var i=t.inputList[n].connection;if(i&&i.type==Blockly.INPUT_VALUE&&e.outputConnection.checkType_(i)){if(o)return null;o=i}}return o},Blockly.Connection.prototype.disconnect=function(){var t=this.targetConnection;if(goog.asserts.assert(t,"Source connection not connected."),goog.asserts.assert(t.targetConnection==this,"Target connection not connected to source connection."),this.isSuperior()){var e=this.sourceBlock_,o=t.getSourceBlock();t=this}else e=t.getSourceBlock(),o=this.sourceBlock_;this.disconnectInternal_(e,o),t.respawnShadow_()},Blockly.Connection.prototype.disconnectInternal_=function(t,e){var o;Blockly.Events.isEnabled()&&(o=new Blockly.Events.BlockMove(e)),this.targetConnection=this.targetConnection.targetConnection=null,e.setParent(null),o&&(o.recordNew(),Blockly.Events.fire(o))},Blockly.Connection.prototype.respawnShadow_=function(){var t=this.getSourceBlock(),e=this.getShadowDom();if(t.workspace&&e&&Blockly.Events.recordUndo)if(t=Blockly.Xml.domToBlock(e,t.workspace),t.outputConnection)this.connect(t.outputConnection);else{if(!t.previousConnection)throw"Child block does not have output or previous statement.";this.connect(t.previousConnection)}},Blockly.Connection.prototype.targetBlock=function(){return this.isConnected()?this.targetConnection.getSourceBlock():null},Blockly.Connection.prototype.checkType_=function(t){if(!this.check_||!t.check_)return!0;for(var e=0;e<this.check_.length;e++)if(-1!=t.check_.indexOf(this.check_[e]))return!0;return!1},Blockly.Connection.prototype.onCheckChanged_=function(){this.isConnected()&&!this.checkType_(this.targetConnection)&&(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()},Blockly.Connection.prototype.setCheck=function(t){return t?(goog.isArray(t)||(t=[t]),this.check_=t,this.onCheckChanged_()):this.check_=null,this},Blockly.Connection.prototype.getOutputShape=function(){return this.check_?-1!==this.check_.indexOf("Boolean")?Blockly.OUTPUT_SHAPE_HEXAGONAL:-1!==this.check_.indexOf("Number")?Blockly.OUTPUT_SHAPE_ROUND:-1!==this.check_.indexOf("String")?Blockly.OUTPUT_SHAPE_SQUARE:Blockly.OUTPUT_SHAPE_ROUND:Blockly.OUTPUT_SHAPE_ROUND},Blockly.Connection.prototype.setShadowDom=function(t){this.shadowDom_=t},Blockly.Connection.prototype.getShadowDom=function(){return this.shadowDom_},Blockly.Connection.prototype.neighbours_=function(){return[]},Blockly.Connection.prototype.toString=function(){var t=this.sourceBlock_;if(!t)return"Orphan Connection";if(t.outputConnection==this)var e="Output Connection of ";else if(t.previousConnection==this)e="Previous Connection of ";else if(t.nextConnection==this)e="Next Connection of ";else{if(!(e=goog.array.find(t.inputList,function(t){return t.connection==this},this)))return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";e='Input "'+e.name+'" connection on '}return e+t.toDevString()},Blockly.ConnectionDB=function(){},Blockly.ConnectionDB.prototype=[],Blockly.ConnectionDB.constructor=Blockly.ConnectionDB,Blockly.ConnectionDB.prototype.addConnection=function(t){if(t.inDB_)throw"Connection already in database.";if(!t.getSourceBlock().isInFlyout){var e=this.findPositionForConnection_(t);this.splice(e,0,t),t.inDB_=!0}},Blockly.ConnectionDB.prototype.findConnection=function(t){if(!this.length)return-1;var e=this.findPositionForConnection_(t);if(e>=this.length)return-1;for(var o=t.y_,n=e;0<=n&&this[n].y_==o;){if(this[n]==t)return n;n--}for(;e<this.length&&this[e].y_==o;){if(this[e]==t)return e;e++}return-1},Blockly.ConnectionDB.prototype.findPositionForConnection_=function(t){if(!this.length)return 0;for(var e=0,o=this.length;e<o;){var n=Math.floor((e+o)/2);if(this[n].y_<t.y_)e=n+1;else{if(!(this[n].y_>t.y_)){e=n;break}o=n}}return e},Blockly.ConnectionDB.prototype.removeConnection_=function(t){if(!t.inDB_)throw"Connection not in database.";var e=this.findConnection(t);if(-1==e)throw"Unable to find connection in connectionDB.";t.inDB_=!1,this.splice(e,1)},Blockly.ConnectionDB.prototype.getNeighbours=function(t,e){function o(t){var o=i-n[t].x_,s=r-n[t].y_;return Math.sqrt(o*o+s*s)<=e&&c.push(n[t]),s<e}for(var n=this,i=t.x_,r=t.y_,s=0,a=n.length-2,l=a;s<l;)n[l].y_<r?s=l:a=l,l=Math.floor((s+a)/2);var c=[];if(a=s=l,n.length){for(;0<=s&&o(s);)s--;do{a++}while(a<n.length&&o(a))}return c},Blockly.ConnectionDB.prototype.isInYRange_=function(t,e,o){return Math.abs(this[t].y_-e)<=o},Blockly.ConnectionDB.prototype.searchForClosest=function(t,e,o){if(!this.length)return{connection:null,radius:e};var n=t.y_,i=t.x_;t.x_=i+o.x,t.y_=n+o.y;var r=this.findPositionForConnection_(t);o=null;for(var s,a=e,l=r-1;0<=l&&this.isInYRange_(l,t.y_,e);)s=this[l],t.isConnectionAllowed(s,a)&&(o=s,a=s.distanceFrom(t)),l--;for(;r<this.length&&this.isInYRange_(r,t.y_,e);)s=this[r],t.isConnectionAllowed(s,a)&&(o=s,a=s.distanceFrom(t)),r++;return t.x_=i,t.y_=n,{connection:o,radius:a}},Blockly.ConnectionDB.init=function(t){var e=[];e[Blockly.INPUT_VALUE]=new Blockly.ConnectionDB,e[Blockly.OUTPUT_VALUE]=new Blockly.ConnectionDB,e[Blockly.NEXT_STATEMENT]=new Blockly.ConnectionDB,e[Blockly.PREVIOUS_STATEMENT]=new Blockly.ConnectionDB,t.connectionDBList=e},Blockly.constants={},Blockly.DRAG_RADIUS=3,Blockly.FLYOUT_DRAG_RADIUS=10,Blockly.SNAP_RADIUS=48,Blockly.CONNECTING_SNAP_RADIUS=96,Blockly.CURRENT_CONNECTION_PREFERENCE=20,Blockly.BUMP_DELAY=0,Blockly.COLLAPSE_CHARS=30,Blockly.LONGPRESS=750,Blockly.SOUND_LIMIT=100,Blockly.DRAG_STACK=!0,Blockly.HSV_SATURATION=.45,Blockly.HSV_VALUE=.65;Blockly.SPRITE={width:96,height:124,url:"sprites.png"},Blockly.SVG_NS="http://www.w3.org/2000/svg",Blockly.HTML_NS="http://www.w3.org/1999/xhtml",Blockly.INPUT_VALUE=1,Blockly.OUTPUT_VALUE=2,Blockly.NEXT_STATEMENT=3,Blockly.PREVIOUS_STATEMENT=4,Blockly.DUMMY_INPUT=5,Blockly.ALIGN_LEFT=-1,Blockly.ALIGN_CENTRE=0,Blockly.ALIGN_RIGHT=1,Blockly.DRAG_NONE=0,Blockly.DRAG_STICKY=1,Blockly.DRAG_BEGIN=1,Blockly.DRAG_FREE=2,Blockly.OPPOSITE_TYPE=[],Blockly.OPPOSITE_TYPE[Blockly.INPUT_VALUE]=Blockly.OUTPUT_VALUE,Blockly.OPPOSITE_TYPE[Blockly.OUTPUT_VALUE]=Blockly.INPUT_VALUE,Blockly.OPPOSITE_TYPE[Blockly.NEXT_STATEMENT]=Blockly.PREVIOUS_STATEMENT,Blockly.OPPOSITE_TYPE[Blockly.PREVIOUS_STATEMENT]=Blockly.NEXT_STATEMENT,Blockly.TOOLBOX_AT_TOP=0,Blockly.TOOLBOX_AT_BOTTOM=1,Blockly.TOOLBOX_AT_LEFT=2,Blockly.TOOLBOX_AT_RIGHT=3,Blockly.OUTPUT_SHAPE_HEXAGONAL=1,Blockly.OUTPUT_SHAPE_ROUND=2,Blockly.OUTPUT_SHAPE_SQUARE=3,Blockly.STACK_GLOW_RADIUS=1.3,Blockly.REPLACEMENT_GLOW_RADIUS=2,Blockly.Categories={motion:"motion",looks:"looks",sound:"sounds",pen:"pen",data:"data",event:"events",control:"control",sensing:"sensing",operators:"operators",more:"more"},Blockly.DELETE_AREA_NONE=null,Blockly.DELETE_AREA_TRASH=1,Blockly.DELETE_AREA_TOOLBOX=2,Blockly.VARIABLE_CATEGORY_NAME="VARIABLE",Blockly.PROCEDURE_CATEGORY_NAME="PROCEDURE",Blockly.RENAME_VARIABLE_ID="RENAME_VARIABLE_ID",Blockly.DELETE_VARIABLE_ID="DELETE_VARIABLE_ID",Blockly.Variables={},Blockly.Variables.NAME_TYPE=Blockly.VARIABLE_CATEGORY_NAME,Blockly.Variables.allUsedVariables=function(t){if(t instanceof Blockly.Block)var e=t.getDescendants();else{if(!(t instanceof Blockly.Workspace||t instanceof Blockly.WorkspaceSvg))throw"Not Block or Workspace: "+t;e=t.getAllBlocks()}var o=Blockly.Variables.noVariableText();t=Object.create(null);for(var n=0;n<e.length;n++){var i=e[n].getVars();if(i)for(var r=0;r<i.length;r++){var s=i[r];s&&s.toLowerCase()!=o&&(t[s.toLowerCase()]=s)}}e=[];for(var a in t)e.push(t[a]);return e},Blockly.Variables.allVariables=function(t){return t instanceof Blockly.Block?(console.warn("Deprecated call to Blockly.Variables.allVariables with a block instead of a workspace.  You may want Blockly.Variables.allUsedVariables"),{}):t.getAllVariables()},Blockly.Variables.createValueDom_=function(t){var e=goog.dom.createDom("value");return e.setAttribute("name",t),e},Blockly.Variables.createShadowDom_=function(t){var e=goog.dom.createDom("shadow");return e.setAttribute("type",t),e},Blockly.Variables.createVariableDom_=function(t){var e=goog.dom.createDom("field",null,t.name);return e.setAttribute("name","VARIABLE"),e.setAttribute("variableType",t.type),e.setAttribute("id",t.getId()),e},Blockly.Variables.createTextDom_=function(){var t=Blockly.Variables.createValueDom_("VALUE"),e=Blockly.Variables.createShadowDom_("text"),o=goog.dom.createDom("field",null,"0");return o.setAttribute("name","TEXT"),e.appendChild(o),t.appendChild(e),t},Blockly.Variables.createMathNumberDom_=function(){var t=Blockly.Variables.createValueDom_("VALUE"),e=Blockly.Variables.createShadowDom_("math_number"),o=goog.dom.createDom("field",null,"1");return o.setAttribute("name","NUM"),e.appendChild(o),t.appendChild(e),t},Blockly.Variables.noVariableText=function(){return"No variable selected"},Blockly.Variables.generateUniqueName=function(t){t=t.getAllVariables();var e="";if(t.length)for(var o=1,n=0,i="ijkmnopqrstuvwxyzabcdefgh".charAt(n);!e;){for(var r=!1,s=0;s<t.length;s++)if(t[s].name.toLowerCase()==i){r=!0;break}r?(n++,25==n&&(n=0,o++),i="ijkmnopqrstuvwxyzabcdefgh".charAt(n),1<o&&(i+=o)):e=i}else e="i";return e},Blockly.Variables.createVariable=function(t,e,o){var n=function(i){Blockly.Variables.promptName(Blockly.Msg.NEW_VARIABLE_TITLE,i,function(i){if(i)if(t.getVariable(i))Blockly.alert(Blockly.Msg.VARIABLE_ALREADY_EXISTS.replace("%1",i.toLowerCase()),function(){n(i)});else if(Blockly.Procedures.isNameUsed(i,t)){var r=t.createVariable(i,o),s=t.getFlyout();r=r.getId(),s.setCheckboxState&&s.setCheckboxState(r,!0),e&&e(i)}else Blockly.alert(Blockly.Msg.PROCEDURE_ALREADY_EXISTS.replace("%1",i.toLowerCase()),function(){n(i)});else e&&e(null)})};n("")},Blockly.Variables.renameVariable=function(t,e,o){var n=function(i){Blockly.Variables.promptName(Blockly.Msg.RENAME_VARIABLE_TITLE.replace("%1",e.name),i,function(i){if(i){var r=t.getVariable(i);r&&r.type!=e.type?Blockly.alert(Blockly.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",i.toLowerCase()).replace("%2",r.type),function(){n(i)}):Blockly.Procedures.isNameUsed(i,t)?(t.renameVariable(e.name,i),o&&o(i)):Blockly.alert(Blockly.Msg.PROCEDURE_ALREADY_EXISTS.replace("%1",i.toLowerCase()),function(){n(i)})}else o&&o(null)})};n("")},Blockly.Variables.promptName=function(t,e,o){Blockly.prompt(t,e,function(t){t&&((t=t.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,""))==Blockly.Msg.RENAME_VARIABLE||t==Blockly.Msg.NEW_VARIABLE)&&(t=null),o(t)})},Blockly.Variables.generateVariableFieldXml_=function(t,e){return'<field name="'+(e||"VARIABLE")+'" variableType="'+t.type+'" id="'+t.getId()+'">'+t.name+"</field>"},Blockly.DataCategory=function(t){var e=t.getVariablesOfType("");e.sort(Blockly.VariableModel.compareByName);var o=[];Blockly.DataCategory.addCreateButton(o,t,"VARIABLE");for(var n=0;n<e.length;n++)Blockly.DataCategory.addDataVariable(o,e[n]);for(0<e.length&&(o[o.length-1].setAttribute("gap",24),e=e[0],Blockly.DataCategory.addSetVariableTo(o,e),Blockly.DataCategory.addChangeVariableBy(o,e),Blockly.DataCategory.addShowVariable(o,e),Blockly.DataCategory.addHideVariable(o,e)),e=t.getVariablesOfType("list"),e.sort(Blockly.VariableModel.compareByName),n=0;n<e.length;n++)Blockly.DataCategory.addDataVariable(o,e[n]);return 0<e.length&&(o[o.length-1].setAttribute("gap",24),e=e[0],Blockly.DataCategory.addAddToList(o,e),Blockly.DataCategory.addDeleteOfList(o,e),Blockly.DataCategory.addInsertAtList(o,e),Blockly.DataCategory.addReplaceItemOfList(o,e),Blockly.DataCategory.addItemOfList(o,e),Blockly.DataCategory.addLengthOfList(o,e),Blockly.DataCategory.addListContainsItem(o,e),Blockly.DataCategory.addShowList(o,e),Blockly.DataCategory.addHideList(o,e)),o},Blockly.DataCategory.addDataVariable=function(t,e){Blockly.DataCategory.addBlock(t,e,"data_variable","VARIABLE")},Blockly.DataCategory.addSetVariableTo=function(t,e){Blockly.DataCategory.addBlock(t,e,"data_setvariableto","VARIABLE",["VALUE","text"])},Blockly.DataCategory.addChangeVariableBy=function(t,e){Blockly.DataCategory.addBlock(t,e,"data_changevariableby","VARIABLE",["VALUE","math_number"])},Blockly.DataCategory.addShowVariable=function(t,e){Blockly.DataCategory.addBlock(t,e,"data_showvariable","VARIABLE")},Blockly.DataCategory.addHideVariable=function(t,e){Blockly.DataCategory.addBlock(t,e,"data_hidevariable","VARIABLE")},Blockly.DataCategory.addAddToList=function(t,e){Blockly.DataCategory.addBlock(t,e,"data_addtolist","LIST",["ITEM","text"])},Blockly.DataCategory.addDeleteOfList=function(t,e){Blockly.DataCategory.addBlock(t,e,"data_deleteoflist","LIST",["INDEX","math_integer"])},Blockly.DataCategory.addInsertAtList=function(t,e){Blockly.DataCategory.addBlock(t,e,"data_insertatlist","LIST",["INDEX","math_integer"],["ITEM","text"])},Blockly.DataCategory.addReplaceItemOfList=function(t,e){Blockly.DataCategory.addBlock(t,e,"data_replaceitemoflist","LIST",["INDEX","math_integer"],["ITEM","text"])},Blockly.DataCategory.addItemOfList=function(t,e){Blockly.DataCategory.addBlock(t,e,"data_itemoflist","LIST",["INDEX","math_integer"])},Blockly.DataCategory.addLengthOfList=function(t,e){Blockly.DataCategory.addBlock(t,e,"data_lengthoflist","LIST")},Blockly.DataCategory.addListContainsItem=function(t,e){Blockly.DataCategory.addBlock(t,e,"data_listcontainsitem","LIST",["ITEM","text"])},Blockly.DataCategory.addShowList=function(t,e){Blockly.DataCategory.addBlock(t,e,"data_showlist","LIST")},Blockly.DataCategory.addHideList=function(t,e){Blockly.DataCategory.addBlock(t,e,"data_hidelist","LIST")},Blockly.DataCategory.addCreateButton=function(t,e,o){var n=goog.dom.createDom("button"),i=Blockly.Msg.NEW_VARIABLE,r="CREATE_VARIABLE",s=function(t){Blockly.Variables.createVariable(t.getTargetWorkspace())};"LIST"===o&&(i=Blockly.Msg.NEW_LIST,r="CREATE_LIST",s=function(t){Blockly.Variables.createVariable(t.getTargetWorkspace(),null,"list")}),n.setAttribute("text",i),n.setAttribute("callbackKey",r),e.registerButtonCallback(r,s),t.push(n)},Blockly.DataCategory.addBlock=function(t,e,o,n,i,r){if(Blockly.Blocks[o]){var s,a;i&&(s=Blockly.DataCategory.createValue(i[0],i[1])),r&&(a=Blockly.DataCategory.createValue(r[0],r[1])),e='<xml><block type="'+o+'" gap="8">'+Blockly.Variables.generateVariableFieldXml_(e,n)+s+a+"</block></xml>",e=Blockly.Xml.textToDom(e).firstChild,t.push(e)}},Blockly.DataCategory.createValue=function(t,e){switch(t){case"ITEM":var o="TEXT",n="thing";break;case"INDEX":o="NUM",n=1;break;case"VALUE":o="math_number"===e?"NUM":"TEXT",n=0}return'<value name="'+t+'"><shadow type="'+e+'"><field name="'+o+'">'+n+"</field></shadow></value>"},Blockly.DropDownDiv=function(){},Blockly.DropDownDiv.DIV_=null,Blockly.DropDownDiv.boundsElement_=null,Blockly.DropDownDiv.owner_=null,Blockly.DropDownDiv.ARROW_SIZE=16,Blockly.DropDownDiv.BORDER_SIZE=1,Blockly.DropDownDiv.ARROW_HORIZONTAL_PADDING=12,Blockly.DropDownDiv.PADDING_Y=20,Blockly.DropDownDiv.ANIMATION_TIME=.25,Blockly.DropDownDiv.animateOutTimer_=null,Blockly.DropDownDiv.onHide_=0,Blockly.DropDownDiv.createDom=function(){Blockly.DropDownDiv.DIV_||(Blockly.DropDownDiv.DIV_=goog.dom.createDom("div","blocklyDropDownDiv"),document.body.appendChild(Blockly.DropDownDiv.DIV_),Blockly.DropDownDiv.content_=goog.dom.createDom("div","blocklyDropDownContent"),Blockly.DropDownDiv.DIV_.appendChild(Blockly.DropDownDiv.content_),Blockly.DropDownDiv.arrow_=goog.dom.createDom("div","blocklyDropDownArrow"),Blockly.DropDownDiv.DIV_.appendChild(Blockly.DropDownDiv.arrow_),Blockly.DropDownDiv.DIV_.style.transition="transform "+Blockly.DropDownDiv.ANIMATION_TIME+"s, opacity "+Blockly.DropDownDiv.ANIMATION_TIME+"s")},Blockly.DropDownDiv.setBoundsElement=function(t){Blockly.DropDownDiv.boundsElement_=t},Blockly.DropDownDiv.getContentDiv=function(){return Blockly.DropDownDiv.content_},Blockly.DropDownDiv.clearContent=function(){Blockly.DropDownDiv.content_.innerHTML=""},Blockly.DropDownDiv.setColour=function(t,e){Blockly.DropDownDiv.DIV_.style.backgroundColor=t,Blockly.DropDownDiv.DIV_.style.borderColor=e},Blockly.DropDownDiv.setCategory=function(t){Blockly.DropDownDiv.DIV_.setAttribute("data-category",t)},Blockly.DropDownDiv.showPositionedByBlock=function(t,e,o,n){var i=e.workspace.scale,r=e.width;return t=e.height,r*=i,t*=i,i=e.getSvgRoot().getBoundingClientRect(),r=i.left+r/2,t=i.top+t,i=i.top,n&&(i+=n),Blockly.DropDownDiv.setBoundsElement(e.workspace.getParentSvg().parentNode),Blockly.DropDownDiv.show(this,r,t,r,i,o)},Blockly.DropDownDiv.show=function(t,e,o,n,i,r){return Blockly.DropDownDiv.owner_=t,Blockly.DropDownDiv.onHide_=r,t=Blockly.DropDownDiv.DIV_,e=Blockly.DropDownDiv.getPositionMetrics(e,o,n,i),Blockly.DropDownDiv.arrow_.style.transform="translate("+e.arrowX+"px,"+e.arrowY+"px) rotate(45deg)",Blockly.DropDownDiv.arrow_.setAttribute("class",e.arrowAtTop?"blocklyDropDownArrow arrowTop":"blocklyDropDownArrow arrowBottom"),t.style.left=e.initialX+"px",t.style.top=e.initialY+"px",t.style.display="block",t.style.opacity=1,t.style.transform="translate("+(e.finalX-e.initialX)+"px,"+(e.finalY-e.initialY)+"px)",e.arrowAtTop},Blockly.DropDownDiv.getPositionMetrics=function(t,e,o,n){var i=Blockly.DropDownDiv.DIV_,r=Blockly.DropDownDiv.boundsElement_.getBoundingClientRect(),s=goog.style.getSize(Blockly.DropDownDiv.boundsElement_);if(i=goog.style.getSize(i),e+i.height>r.top+s.height)if(n-i.height<r.top){o=e+Blockly.DropDownDiv.PADDING_Y;var a=!1}else t=o,o=n-i.height-Blockly.DropDownDiv.PADDING_Y,a=!0;else o=e+Blockly.DropDownDiv.PADDING_Y,a=!1;var l=t-Blockly.DropDownDiv.ARROW_SIZE/2;return l=Math.max(r.left,Math.min(l,r.left+s.width)),t=Math.max(r.left,Math.min(t-i.width/2,r.left+s.width-i.width)),l=Math.max(Blockly.DropDownDiv.ARROW_HORIZONTAL_PADDING,Math.min(l-t,i.width-Blockly.DropDownDiv.ARROW_HORIZONTAL_PADDING-Blockly.DropDownDiv.ARROW_SIZE)),r=a?i.height-Blockly.DropDownDiv.BORDER_SIZE:0,r-=Blockly.DropDownDiv.ARROW_SIZE/2+Blockly.DropDownDiv.BORDER_SIZE,{initialX:t,initialY:a?n-i.height:e,finalX:t,finalY:o,arrowX:l,arrowY:r,arrowAtTop:!a}},Blockly.DropDownDiv.isVisible=function(){return!!Blockly.DropDownDiv.owner_},Blockly.DropDownDiv.hideIfOwner=function(t){return Blockly.DropDownDiv.owner_===t&&(Blockly.DropDownDiv.hide(),!0)},Blockly.DropDownDiv.hide=function(){var t=Blockly.DropDownDiv.DIV_;t.style.transform="translate(0px, 0px)",t.style.opacity=0,Blockly.DropDownDiv.animateOutTimer_=setTimeout(function(){Blockly.DropDownDiv.hideWithoutAnimation()},1e3*Blockly.DropDownDiv.ANIMATION_TIME),Blockly.DropDownDiv.onHide_&&(Blockly.DropDownDiv.onHide_(),Blockly.DropDownDiv.onHide_=null)},Blockly.DropDownDiv.hideWithoutAnimation=function(){if(Blockly.DropDownDiv.isVisible()){var t=Blockly.DropDownDiv.DIV_;Blockly.DropDownDiv.animateOutTimer_&&window.clearTimeout(Blockly.DropDownDiv.animateOutTimer_),t.style.transform="",t.style.top="",t.style.left="",t.style.display="none",Blockly.DropDownDiv.clearContent(),Blockly.DropDownDiv.owner_=null,Blockly.DropDownDiv.onHide_&&(Blockly.DropDownDiv.onHide_(),Blockly.DropDownDiv.onHide_=null)}},Blockly.Events={},Blockly.Events.group_="",Blockly.Events.recordUndo=!0,Blockly.Events.disabled_=0,Blockly.Events.CREATE="create",Blockly.Events.BLOCK_CREATE=Blockly.Events.CREATE,Blockly.Events.DELETE="delete",Blockly.Events.BLOCK_DELETE=Blockly.Events.DELETE,Blockly.Events.CHANGE="change",Blockly.Events.BLOCK_CHANGE=Blockly.Events.CHANGE,Blockly.Events.MOVE="move",Blockly.Events.BLOCK_MOVE=Blockly.Events.MOVE,Blockly.Events.VAR_CREATE="var_create",Blockly.Events.VAR_DELETE="var_delete",Blockly.Events.VAR_RENAME="var_rename",Blockly.Events.UI="ui",Blockly.Events.FIRE_QUEUE_=[],Blockly.Events.fire=function(t){Blockly.Events.isEnabled()&&(Blockly.Events.FIRE_QUEUE_.length||setTimeout(Blockly.Events.fireNow_,0),Blockly.Events.FIRE_QUEUE_.push(t))},Blockly.Events.fireNow_=function(){for(var t,e=Blockly.Events.filter(Blockly.Events.FIRE_QUEUE_,!0),o=Blockly.Events.FIRE_QUEUE_.length=0;t=e[o];o++){var n=Blockly.Workspace.getById(t.workspaceId);n&&n.fireChangeListener(t)}},Blockly.Events.filter=function(t,e){var o=goog.array.clone(t);e||o.reverse();for(var n,i=0;n=o[i];i++)for(var r,s=i+1;r=o[s];s++)n.type==r.type&&n.blockId==r.blockId&&n.workspaceId==r.workspaceId&&(n.type==Blockly.Events.MOVE?(n.newParentId=r.newParentId,n.newInputName=r.newInputName,n.newCoordinate=r.newCoordinate,o.splice(s,1),s--):n.type==Blockly.Events.CHANGE&&n.element==r.element&&n.name==r.name?(n.newValue=r.newValue,o.splice(s,1),s--):n.type!=Blockly.Events.UI||"click"!=r.element||"commentOpen"!=n.element&&"mutatorOpen"!=n.element&&"warningOpen"!=n.element||(n.newValue=r.newValue,o.splice(s,1),s--));for(i=o.length-1;0<=i;i--)o[i].isNull()&&o.splice(i,1);for(e||o.reverse(),i=1;n=o[i];i++)n.type==Blockly.Events.CHANGE&&"mutation"==n.element&&o.unshift(o.splice(i,1)[0]);return o},Blockly.Events.clearPendingUndo=function(){for(var t,e=0;t=Blockly.Events.FIRE_QUEUE_[e];e++)t.recordUndo=!1},Blockly.Events.disable=function(){Blockly.Events.disabled_++},Blockly.Events.enable=function(){Blockly.Events.disabled_--},Blockly.Events.isEnabled=function(){return 0==Blockly.Events.disabled_},Blockly.Events.getGroup=function(){return Blockly.Events.group_},Blockly.Events.setGroup=function(t){Blockly.Events.group_="boolean"==typeof t?t?Blockly.utils.genUid():"":t},Blockly.Events.getDescendantIds_=function(t){var e=[];t=t.getDescendants();for(var o,n=0;o=t[n];n++)e[n]=o.id;return e},Blockly.Events.fromJson=function(t,e){switch(t.type){case Blockly.Events.CREATE:var o=new Blockly.Events.Create(null);break;case Blockly.Events.DELETE:o=new Blockly.Events.Delete(null);break;case Blockly.Events.CHANGE:o=new Blockly.Events.Change(null);break;case Blockly.Events.MOVE:o=new Blockly.Events.Move(null);break;case Blockly.Events.VAR_CREATE:o=new Blockly.Events.VarCreate(null);break;case Blockly.Events.VAR_DELETE:o=new Blockly.Events.VarDelete(null);break;case Blockly.Events.VAR_RENAME:o=new Blockly.Events.VarRename(null);break;case Blockly.Events.UI:o=new Blockly.Events.Ui(null);break;default:throw"Unknown event type."}return o.fromJson(t),o.workspaceId=e.id,o},Blockly.Events.Abstract=function(t){t instanceof Blockly.Block?(this.blockId=t.id,this.workspaceId=t.workspace.id):t instanceof Blockly.VariableModel&&(this.workspaceId=t.workspace.id,this.varId=t.getId()),this.group=Blockly.Events.group_,this.recordUndo=Blockly.Events.recordUndo},Blockly.Events.Abstract.prototype.toJson=function(){var t={type:this.type};return this.blockId&&(t.blockId=this.blockId),this.varId&&(t.varId=this.varId),this.group&&(t.group=this.group),t},Blockly.Events.Abstract.prototype.fromJson=function(t){this.blockId=t.blockId,this.varId=t.varId,this.group=t.group},Blockly.Events.Abstract.prototype.isNull=function(){return!1},Blockly.Events.Abstract.prototype.run=function(){},Blockly.Events.Abstract.prototype.getEventWorkspace_=function(){var t=Blockly.Workspace.getById(this.workspaceId);if(!t)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return t},Blockly.Events.Create=function(t){t&&(Blockly.Events.Create.superClass_.constructor.call(this,t),this.xml=t.workspace.rendered?Blockly.Xml.blockToDomWithXY(t):Blockly.Xml.blockToDom(t),this.ids=Blockly.Events.getDescendantIds_(t))},goog.inherits(Blockly.Events.Create,Blockly.Events.Abstract),Blockly.Events.BlockCreate=Blockly.Events.Create,Blockly.Events.Create.prototype.type=Blockly.Events.CREATE,Blockly.Events.Create.prototype.toJson=function(){var t=Blockly.Events.Create.superClass_.toJson.call(this);return t.xml=Blockly.Xml.domToText(this.xml),t.ids=this.ids,t},Blockly.Events.Create.prototype.fromJson=function(t){Blockly.Events.Create.superClass_.fromJson.call(this,t),this.xml=Blockly.Xml.textToDom("<xml>"+t.xml+"</xml>").firstChild,this.ids=t.ids},Blockly.Events.Create.prototype.run=function(t){var e=this.getEventWorkspace_();if(t)t=goog.dom.createDom("xml"),t.appendChild(this.xml),Blockly.Xml.domToWorkspace(t,e);else{t=0;for(var o;o=this.ids[t];t++){var n=e.getBlockById(o);n?n.dispose(!1,!1):o==this.blockId&&console.warn("Can't uncreate non-existant block: "+o)}}},Blockly.Events.Delete=function(t){if(t){if(t.getParent())throw"Connected blocks cannot be deleted.";Blockly.Events.Delete.superClass_.constructor.call(this,t),this.oldXml=t.workspace.rendered?Blockly.Xml.blockToDomWithXY(t):Blockly.Xml.blockToDom(t),this.ids=Blockly.Events.getDescendantIds_(t)}},goog.inherits(Blockly.Events.Delete,Blockly.Events.Abstract),Blockly.Events.BlockDelete=Blockly.Events.Delete,Blockly.Events.Delete.prototype.type=Blockly.Events.DELETE,Blockly.Events.Delete.prototype.toJson=function(){var t=Blockly.Events.Delete.superClass_.toJson.call(this);return t.ids=this.ids,t},Blockly.Events.Delete.prototype.fromJson=function(t){Blockly.Events.Delete.superClass_.fromJson.call(this,t),this.ids=t.ids},Blockly.Events.Delete.prototype.run=function(t){var e=this.getEventWorkspace_();if(t){t=0;for(var o;o=this.ids[t];t++){var n=e.getBlockById(o);n?n.dispose(!1,!1):o==this.blockId&&console.warn("Can't delete non-existant block: "+o)}}else t=goog.dom.createDom("xml"),t.appendChild(this.oldXml),Blockly.Xml.domToWorkspace(t,e)},Blockly.Events.Change=function(t,e,o,n,i){t&&(Blockly.Events.Change.superClass_.constructor.call(this,t),this.element=e,this.name=o,this.oldValue=n,this.newValue=i)},goog.inherits(Blockly.Events.Change,Blockly.Events.Abstract),Blockly.Events.BlockChange=Blockly.Events.Change,Blockly.Events.Change.prototype.type=Blockly.Events.CHANGE,Blockly.Events.Change.prototype.toJson=function(){var t=Blockly.Events.Change.superClass_.toJson.call(this);return t.element=this.element,this.name&&(t.name=this.name),t.newValue=this.newValue,t},Blockly.Events.Change.prototype.fromJson=function(t){Blockly.Events.Change.superClass_.fromJson.call(this,t),this.element=t.element,this.name=t.name,this.newValue=t.newValue},Blockly.Events.Change.prototype.isNull=function(){return this.oldValue==this.newValue},Blockly.Events.Change.prototype.run=function(t){var e=this.getEventWorkspace_().getBlockById(this.blockId);if(e)switch(e.mutator&&e.mutator.setVisible(!1),t=t?this.newValue:this.oldValue,this.element){case"field":(e=e.getField(this.name))?(e.callValidator(t),e.setValue(t)):console.warn("Can't set non-existant field: "+this.name);break;case"comment":e.setCommentText(t||null);break;case"collapsed":e.setCollapsed(t);break;case"disabled":e.setDisabled(t);break;case"inline":e.setInputsInline(t);break;case"mutation":var o="";if(e.mutationToDom&&(o=(o=e.mutationToDom())&&Blockly.Xml.domToText(o)),e.domToMutation){t=t||"<mutation></mutation>";var n=Blockly.Xml.textToDom("<xml>"+t+"</xml>");e.domToMutation(n.firstChild)}Blockly.Events.fire(new Blockly.Events.Change(e,"mutation",null,o,t));break;default:console.warn("Unknown change type: "+this.element)}else console.warn("Can't change non-existant block: "+this.blockId)},Blockly.Events.Move=function(t){t&&(Blockly.Events.Move.superClass_.constructor.call(this,t),t=this.currentLocation_(),this.oldParentId=t.parentId,this.oldInputName=t.inputName,this.oldCoordinate=t.coordinate)},goog.inherits(Blockly.Events.Move,Blockly.Events.Abstract),Blockly.Events.BlockMove=Blockly.Events.Move,Blockly.Events.Move.prototype.type=Blockly.Events.MOVE,Blockly.Events.Move.prototype.toJson=function(){var t=Blockly.Events.Move.superClass_.toJson.call(this);return this.newParentId&&(t.newParentId=this.newParentId),this.newInputName&&(t.newInputName=this.newInputName),this.newCoordinate&&(t.newCoordinate=Math.round(this.newCoordinate.x)+","+Math.round(this.newCoordinate.y)),t},Blockly.Events.Move.prototype.fromJson=function(t){Blockly.Events.Move.superClass_.fromJson.call(this,t),this.newParentId=t.newParentId,this.newInputName=t.newInputName,t.newCoordinate&&(t=t.newCoordinate.split(","),this.newCoordinate=new goog.math.Coordinate(parseFloat(t[0]),parseFloat(t[1])))},Blockly.Events.Move.prototype.recordNew=function(){var t=this.currentLocation_();this.newParentId=t.parentId,this.newInputName=t.inputName,this.newCoordinate=t.coordinate},Blockly.Events.Move.prototype.currentLocation_=function(){var t=Blockly.Workspace.getById(this.workspaceId).getBlockById(this.blockId),e={},o=t.getParent();return o?(e.parentId=o.id,(t=o.getInputWithBlock(t))&&(e.inputName=t.name)):e.coordinate=t.getRelativeToSurfaceXY(),e},Blockly.Events.Move.prototype.isNull=function(){return this.oldParentId==this.newParentId&&this.oldInputName==this.newInputName&&goog.math.Coordinate.equals(this.oldCoordinate,this.newCoordinate)},Blockly.Events.Move.prototype.run=function(t){var e=this.getEventWorkspace_(),o=e.getBlockById(this.blockId);if(o){var n=t?this.newParentId:this.oldParentId,i=t?this.newInputName:this.oldInputName;t=t?this.newCoordinate:this.oldCoordinate;var r=null;if(n&&!(r=e.getBlockById(n)))return void console.warn("Can't connect to non-existant block: "+n);if(o.getParent()&&o.unplug(),t)i=o.getRelativeToSurfaceXY(),o.moveBy(t.x-i.x,t.y-i.y);else{if(o=o.outputConnection||o.previousConnection,i){if(e=r.getInput(i))var s=e.connection}else o.type==Blockly.PREVIOUS_STATEMENT&&(s=r.nextConnection);s?o.connect(s):console.warn("Can't connect to non-existant input: "+i)}}else console.warn("Can't move non-existant block: "+this.blockId)},Blockly.Events.Ui=function(t,e,o,n){Blockly.Events.Ui.superClass_.constructor.call(this,t),this.element=e,this.oldValue=o,this.newValue=n,this.recordUndo=!1},goog.inherits(Blockly.Events.Ui,Blockly.Events.Abstract),Blockly.Events.Ui.prototype.type=Blockly.Events.UI,Blockly.Events.Ui.prototype.toJson=function(){var t=Blockly.Events.Ui.superClass_.toJson.call(this);return t.element=this.element,void 0!==this.newValue&&(t.newValue=this.newValue),t},Blockly.Events.Ui.prototype.fromJson=function(t){Blockly.Events.Ui.superClass_.fromJson.call(this,t),this.element=t.element,this.newValue=t.newValue},Blockly.Events.VarCreate=function(t){t&&(Blockly.Events.VarCreate.superClass_.constructor.call(this,t),this.varType=t.type,this.varName=t.name)},goog.inherits(Blockly.Events.VarCreate,Blockly.Events.Abstract),Blockly.Events.VarCreate.prototype.type=Blockly.Events.VAR_CREATE,Blockly.Events.VarCreate.prototype.toJson=function(){var t=Blockly.Events.VarCreate.superClass_.toJson.call(this);return t.varType=this.varType,t.varName=this.varName,t},Blockly.Events.VarCreate.prototype.fromJson=function(t){Blockly.Events.VarCreate.superClass_.fromJson.call(this,t),this.varType=t.varType,this.varName=t.varName},Blockly.Events.VarCreate.prototype.run=function(t){var e=this.getEventWorkspace_();t?e.createVariable(this.varName,this.varType,this.varId):e.deleteVariableById(this.varId)},Blockly.Events.VarDelete=function(t){t&&(Blockly.Events.VarDelete.superClass_.constructor.call(this,t),this.varType=t.type,this.varName=t.name)},goog.inherits(Blockly.Events.VarDelete,Blockly.Events.Abstract),Blockly.Events.VarDelete.prototype.type=Blockly.Events.VAR_DELETE,Blockly.Events.VarDelete.prototype.toJson=function(){var t=Blockly.Events.VarDelete.superClass_.toJson.call(this);return t.varType=this.varType,t.varName=this.varName,t},Blockly.Events.VarDelete.prototype.fromJson=function(t){Blockly.Events.VarDelete.superClass_.fromJson.call(this,t),this.varType=t.varType,this.varName=t.varName},Blockly.Events.VarDelete.prototype.run=function(t){var e=this.getEventWorkspace_();t?e.deleteVariableById(this.varId):e.createVariable(this.varName,this.varType,this.varId)},Blockly.Events.VarRename=function(t,e){t&&(Blockly.Events.VarRename.superClass_.constructor.call(this,t),this.oldName=t.name,this.newName=e)},goog.inherits(Blockly.Events.VarRename,Blockly.Events.Abstract),Blockly.Events.VarRename.prototype.type=Blockly.Events.VAR_RENAME,Blockly.Events.VarRename.prototype.toJson=function(){var t=Blockly.Events.VarRename.superClass_.toJson.call(this);return t.oldName=this.oldName,t.newName=this.newName,t},Blockly.Events.VarRename.prototype.fromJson=function(t){Blockly.Events.VarRename.superClass_.fromJson.call(this,t),this.oldName=t.oldName,this.newName=t.newName},Blockly.Events.VarRename.prototype.run=function(t){var e=this.getEventWorkspace_();t?e.renameVariableById(this.varId,this.newName):e.renameVariableById(this.varId,this.oldName)},Blockly.Events.disableOrphans=function(t){if(t.type==Blockly.Events.MOVE||t.type==Blockly.Events.CREATE){Blockly.Events.disable();var e=Blockly.Workspace.getById(t.workspaceId);if(t=e.getBlockById(t.blockId))if(t.getParent()&&!t.getParent().disabled){e=t.getDescendants(),t=0;for(var o;o=e[t];t++)o.setDisabled(!1)}else if((t.outputConnection||t.previousConnection)&&!e.isDragging())do{t.setDisabled(!0),t=t.getNextBlock()}while(t);Blockly.Events.enable()}},Blockly.RenderedConnection=function(t,e){Blockly.RenderedConnection.superClass_.constructor.call(this,t,e),this.offsetInBlock_=new goog.math.Coordinate(0,0)},goog.inherits(Blockly.RenderedConnection,Blockly.Connection),Blockly.RenderedConnection.prototype.distanceFrom=function(t){var e=this.x_-t.x_;return t=this.y_-t.y_,Math.sqrt(e*e+t*t)},Blockly.RenderedConnection.prototype.bumpAwayFrom_=function(t){if(!this.sourceBlock_.workspace.isDragging()){var e=this.sourceBlock_.getRootBlock();if(!e.isInFlyout){var o=!1;if(!e.isMovable()){if(e=t.getSourceBlock().getRootBlock(),!e.isMovable())return;t=this,o=!0}var n=Blockly.selected==e;n||e.addSelect();var i=t.x_+Blockly.SNAP_RADIUS-this.x_;t=t.y_+Blockly.SNAP_RADIUS-this.y_,o&&(t=-t),e.RTL&&(i=-i),e.moveBy(i,t),n||e.removeSelect()}}},Blockly.RenderedConnection.prototype.moveTo=function(t,e){this.inDB_&&this.db_.removeConnection_(this),this.x_=t,this.y_=e,this.hidden_||this.db_.addConnection(this)},Blockly.RenderedConnection.prototype.moveBy=function(t,e){this.moveTo(this.x_+t,this.y_+e)},Blockly.RenderedConnection.prototype.moveToOffset=function(t){this.moveTo(t.x+this.offsetInBlock_.x,t.y+this.offsetInBlock_.y)},Blockly.RenderedConnection.prototype.setOffsetInBlock=function(t,e){this.offsetInBlock_.x=t,this.offsetInBlock_.y=e},Blockly.RenderedConnection.prototype.tighten_=function(){var t=this.targetConnection.x_-this.x_,e=this.targetConnection.y_-this.y_;if(0!=t||0!=e){var o=this.targetBlock(),n=o.getSvgRoot();if(!n)throw"block is not rendered.";n=Blockly.utils.getRelativeXY(n),o.getSvgRoot().setAttribute("transform","translate("+(n.x-t)+","+(n.y-e)+")"),o.moveConnections_(-t,-e)}},Blockly.RenderedConnection.prototype.closest=function(t,e){return this.dbOpposite_.searchForClosest(this,t,e)},Blockly.RenderedConnection.prototype.highlight=function(){var t="m -20,0 h 5 "+Blockly.BlockSvg.NOTCH_PATH_LEFT+" h 5",e=this.sourceBlock_.getRelativeToSurfaceXY();Blockly.Connection.highlightedPath_=Blockly.utils.createSvgElement("path",{class:"blocklyHighlightedConnectionPath",d:t,transform:"translate("+(this.x_-e.x)+","+(this.y_-e.y)+")"+(this.sourceBlock_.RTL?" scale(-1 1)":"")},this.sourceBlock_.getSvgRoot())},Blockly.RenderedConnection.prototype.unhideAll=function(){this.setHidden(!1);var t=[];if(this.type!=Blockly.INPUT_VALUE&&this.type!=Blockly.NEXT_STATEMENT)return t;var e=this.targetBlock();if(e){if(e.isCollapsed()){var o=[];e.outputConnection&&o.push(e.outputConnection),e.nextConnection&&o.push(e.nextConnection),e.previousConnection&&o.push(e.previousConnection)}else o=e.getConnections_(!0);for(var n=0;n<o.length;n++)t.push.apply(t,o[n].unhideAll());t.length||(t[0]=e)}return t},Blockly.RenderedConnection.prototype.unhighlight=function(){goog.dom.removeNode(Blockly.Connection.highlightedPath_),delete Blockly.Connection.highlightedPath_},Blockly.RenderedConnection.prototype.setHidden=function(t){(this.hidden_=t)&&this.inDB_?this.db_.removeConnection_(this):t||this.inDB_||this.db_.addConnection(this)},Blockly.RenderedConnection.prototype.hideAll=function(){if(this.setHidden(!0),this.targetConnection)for(var t=this.targetBlock().getDescendants(),e=0;e<t.length;e++){for(var o=t[e],n=o.getConnections_(!0),i=0;i<n.length;i++)n[i].setHidden(!0);for(o=o.getIcons(),i=0;i<o.length;i++)o[i].setVisible(!1)}},Blockly.RenderedConnection.prototype.isConnectionAllowed=function(t,e){return!(this.distanceFrom(t)>e)&&Blockly.RenderedConnection.superClass_.isConnectionAllowed.call(this,t)};Blockly.RenderedConnection.prototype.disconnectInternal_=function(t,e){Blockly.RenderedConnection.superClass_.disconnectInternal_.call(this,t,e),t.rendered&&t.render(),e.rendered&&(e.updateDisabled(),e.render())},Blockly.RenderedConnection.prototype.respawnShadow_=function(){var t=this.getSourceBlock(),e=this.getShadowDom();if(t.workspace&&e&&Blockly.Events.recordUndo){if(Blockly.RenderedConnection.superClass_.respawnShadow_.call(this),!(e=this.targetBlock()))throw"Couldn't respawn the shadow block that should exist here.";e.initSvg(),e.render(!1),t.rendered&&t.render()}},Blockly.RenderedConnection.prototype.neighbours_=function(t){return this.dbOpposite_.getNeighbours(this,t)},Blockly.RenderedConnection.prototype.connect_=function(t){Blockly.RenderedConnection.superClass_.connect_.call(this,t);var e=this.getSourceBlock();t=t.getSourceBlock(),e.rendered&&e.updateDisabled(),t.rendered&&t.updateDisabled(),e.rendered&&t.rendered&&(this.type==Blockly.NEXT_STATEMENT||this.type==Blockly.PREVIOUS_STATEMENT?t.render():e.render())},Blockly.RenderedConnection.prototype.onCheckChanged_=function(){this.isConnected()&&!this.checkType_(this.targetConnection)&&((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours_())},Blockly.InsertionMarkerManager=function(t){this.topBlock_=Blockly.selected=t,this.workspace_=t.workspace,this.lastMarker_=this.lastOnStack_=null,this.firstMarker_=this.createMarkerBlock_(this.topBlock_),this.localConnection_=this.closestConnection_=null,this.wouldDeleteBlock_=!1,this.markerConnection_=null,this.highlightingBlock_=!1,this.highlightedBlock_=null,this.availableConnections_=this.initAvailableConnections_()},Blockly.InsertionMarkerManager.prototype.dispose=function(){this.workspace_=this.topBlock_=null,this.availableConnections_.length=0,this.localConnection_=this.closestConnection_=null,Blockly.Events.disable();try{this.firstMarker_&&(this.firstMarker_.dispose(),this.firstMarker_=null),this.lastMarker_&&(this.lastMarker_.dispose(),this.lastMarker_=null)}finally{Blockly.Events.enable()}this.highlightedBlock_=null},Blockly.InsertionMarkerManager.prototype.wouldDeleteBlock=function(){return this.wouldDeleteBlock_},Blockly.InsertionMarkerManager.prototype.applyConnections=function(){this.closestConnection_&&(Blockly.Events.disable(),this.hidePreview_(),Blockly.Events.enable(),this.localConnection_.connect(this.closestConnection_),this.topBlock_.rendered&&(this.localConnection_.isSuperior()?this.closestConnection_:this.localConnection_).getSourceBlock().connectionUiEffect())},Blockly.InsertionMarkerManager.prototype.update=function(t,e){var o=this.getCandidate_(t);((this.wouldDeleteBlock_=this.shouldDelete_(o,e))||this.shouldUpdatePreviews_(o,t))&&(Blockly.Events.disable(),this.maybeHidePreview_(o),this.maybeShowPreview_(o),Blockly.Events.enable())},Blockly.InsertionMarkerManager.prototype.createMarkerBlock_=function(t){var e=t.type;Blockly.Events.disable();try{var o=this.workspace_.newBlock(e);if(t.mutationToDom){var n=t.mutationToDom();o.domToMutation(n)}o.setInsertionMarker(!0,t.width),o.initSvg()}finally{Blockly.Events.enable()}return o},Blockly.InsertionMarkerManager.prototype.initAvailableConnections_=function(){var t=this.topBlock_.getConnections_(!1),e=this.topBlock_.lastConnectionInStack();return e&&e!=this.topBlock_.nextConnection&&(t.push(e),this.lastOnStack_=e,this.lastMarker_=this.createMarkerBlock_(e.sourceBlock_)),t},Blockly.InsertionMarkerManager.prototype.shouldUpdatePreviews_=function(t,e){var o=t.local,n=t.closest,i=t.radius;if(!o||!n)return!(!this.localConnection_||!this.closestConnection_);if(o.type==Blockly.OUTPUT_VALUE)return!0;if(this.localConnection_&&this.closestConnection_){if(this.closestConnection_==n)return!1;o=this.localConnection_.x_+e.x-this.closestConnection_.x_;var r=this.localConnection_.y_+e.y-this.closestConnection_.y_;return o=Math.sqrt(o*o+r*r),!(n&&i>o-Blockly.CURRENT_CONNECTION_PREFERENCE)}return!this.localConnection_&&!this.closestConnection_||(console.error("Only one of localConnection_ and closestConnection_ was set."),console.error("Returning true from shouldUpdatePreviews, but it's not clear why."),!0)},Blockly.InsertionMarkerManager.prototype.getCandidate_=function(t){for(var e=this.getStartRadius_(),o=null,n=null,i=0;i<this.availableConnections_.length;i++){var r=this.availableConnections_[i],s=r.closest(e,t);s.connection&&(o=s.connection,n=r,e=s.radius)}return{closest:o,local:n,radius:e}},Blockly.InsertionMarkerManager.prototype.getStartRadius_=function(){return this.closestConnection_&&this.localConnection_?Blockly.CONNECTING_SNAP_RADIUS:Blockly.SNAP_RADIUS},Blockly.InsertionMarkerManager.prototype.shouldReplace_=function(){var t=this.closestConnection_,e=this.localConnection_;return e.type==Blockly.OUTPUT_VALUE||e!=e.sourceBlock_.getFirstStatementConnection()&&!(this.topBlock_.nextConnection||e.type!=Blockly.PREVIOUS_STATEMENT||!t.isConnected())},Blockly.InsertionMarkerManager.prototype.shouldDelete_=function(t,e){var o=t&&!!t.closest&&e!=Blockly.DELETE_AREA_TOOLBOX;return!!e&&!this.topBlock_.getParent()&&this.topBlock_.isDeletable()&&!o},Blockly.InsertionMarkerManager.prototype.maybeShowPreview_=function(t){if(!this.wouldDeleteBlock_){var e=t.closest;t=t.local,e&&e!=this.closestConnection_&&!e.sourceBlock_.isInsertionMarker()&&(this.closestConnection_=e,this.localConnection_=t,this.showPreview_())}},Blockly.InsertionMarkerManager.prototype.showPreview_=function(){this.shouldReplace_()?this.highlightBlock_():this.connectMarker_()},Blockly.InsertionMarkerManager.prototype.maybeHidePreview_=function(t){t.closest||this.hidePreview_();var e=this.closestConnection_!=t.closest;t=this.localConnection_!=t.local,this.closestConnection_&&this.localConnection_&&(e||t||this.wouldDeleteBlock_)&&this.hidePreview_(),this.localConnection_=this.closestConnection_=this.markerConnection_=null},Blockly.InsertionMarkerManager.prototype.hidePreview_=function(){this.highlightingBlock_?this.unhighlightBlock_():this.markerConnection_&&this.disconnectMarker_()},Blockly.InsertionMarkerManager.prototype.highlightBlock_=function(){var t=this.closestConnection_,e=this.localConnection_;t.targetBlock()?(this.highlightedBlock_=t.targetBlock(),t.targetBlock().highlightForReplacement(!0)):e.type==Blockly.OUTPUT_VALUE&&(this.highlightedBlock_=t.sourceBlock_,t.sourceBlock_.highlightShapeForInput(t,!0)),this.highlightingBlock_=!0},Blockly.InsertionMarkerManager.prototype.unhighlightBlock_=function(){var t=this.closestConnection_;t.type!=Blockly.INPUT_VALUE||t.isConnected()?this.highlightedBlock_.highlightForReplacement(!1):this.highlightedBlock_.highlightShapeForInput(t,!1),this.highlightedBlock_=null,this.highlightingBlock_=!1},Blockly.InsertionMarkerManager.prototype.disconnectMarker_=function(){if(this.markerConnection_){var t=this.markerConnection_,e=t.sourceBlock_,o=e.nextConnection,n=e.previousConnection;if(t!=o||n&&n.targetConnection?t.type==Blockly.NEXT_STATEMENT&&t!=o?(o=t.targetConnection,o.sourceBlock_.unplug(!1),n=n?n.targetConnection:null,e.unplug(!0),n&&n.connect(o)):e.unplug(!0):t.targetBlock().unplug(!1),t.targetConnection)throw"markerConnection_ still connected at the end of disconnectInsertionMarker";this.markerConnection_=null,e.getSvgRoot().setAttribute("visibility","hidden")}else console.log("No insertion marker connection to disconnect")},Blockly.InsertionMarkerManager.prototype.connectMarker_=function(){var t=this.localConnection_,e=this.closestConnection_,o=this.lastOnStack_&&t==this.lastOnStack_?this.lastMarker_:this.firstMarker_;t=o.getMatchingConnection(t.sourceBlock_,t),goog.asserts.assert(t!=this.markerConnection_,"Made it to connectMarker_ even though the marker isn't changing"),o.render(),o.rendered=!0,o.getSvgRoot().setAttribute("visibility","visible"),o.positionNewBlock(o,t,e),t.connect(e),this.markerConnection_=t},Blockly.BlockDragger=function(t,e){this.draggingBlock_=t,this.workspace_=e,this.draggedConnectionManager_=new Blockly.InsertionMarkerManager(this.draggingBlock_),this.deleteArea_=null,this.wouldDeleteBlock_=!1,this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY(),this.dragIconData_=Blockly.BlockDragger.initIconData_(t)},Blockly.BlockDragger.prototype.dispose=function(){this.startWorkspace_=this.workspace_=this.draggingBlock_=null,this.dragIconData_.length=0,this.draggedConnectionManager_&&(this.draggedConnectionManager_.dispose(),this.draggedConnectionManager_=null)},Blockly.BlockDragger.initIconData_=function(t){var e=[];t=t.getDescendants();for(var o,n=0;o=t[n];n++){o=o.getIcons();for(var i=0;i<o.length;i++){var r={location:o[i].getIconLocation(),icon:o[i]};e.push(r)}}return e},Blockly.BlockDragger.prototype.startBlockDrag=function(t){Blockly.Events.getGroup()||Blockly.Events.setGroup(!0),this.workspace_.setResizesEnabled(!1),Blockly.BlockSvg.disconnectUiStop_(),this.draggingBlock_.getParent()&&(this.draggingBlock_.unplug(),t=this.pixelsToWorkspaceUnits_(t),t=goog.math.Coordinate.sum(this.startXY_,t),this.draggingBlock_.translate(t.x,t.y),this.draggingBlock_.disconnectUiEffect()),this.draggingBlock_.setDragging(!0),this.draggingBlock_.moveToDragSurface_(),this.workspace_.toolbox_&&this.workspace_.toolbox_.addDeleteStyle()},Blockly.BlockDragger.prototype.dragBlock=function(t,e){var o=this.pixelsToWorkspaceUnits_(e),n=goog.math.Coordinate.sum(this.startXY_,o);this.draggingBlock_.moveDuringDrag(n),this.dragIcons_(o),this.deleteArea_=this.workspace_.isDeleteArea(t),this.draggedConnectionManager_.update(o,this.deleteArea_),this.updateCursorDuringBlockDrag_()},Blockly.BlockDragger.prototype.endBlockDrag=function(t,e){this.dragBlock(t,e),this.dragIconData_=[],Blockly.BlockSvg.disconnectUiStop_();var o=this.pixelsToWorkspaceUnits_(e),n=goog.math.Coordinate.sum(this.startXY_,o);this.draggingBlock_.moveOffDragSurface_(n),this.maybeDeleteBlock_()||(this.draggingBlock_.moveConnections_(o.x,o.y),this.draggingBlock_.setDragging(!1),this.draggedConnectionManager_.applyConnections(),this.draggingBlock_.render(),this.fireMoveEvent_(),this.draggingBlock_.scheduleSnapAndBump()),this.workspace_.setResizesEnabled(!0),this.workspace_.toolbox_&&this.workspace_.toolbox_.removeDeleteStyle(),Blockly.Events.setGroup(!1)},Blockly.BlockDragger.prototype.fireMoveEvent_=function(){var t=new Blockly.Events.BlockMove(this.draggingBlock_);t.oldCoordinate=this.startXY_,t.recordNew(),Blockly.Events.fire(t)},Blockly.BlockDragger.prototype.maybeDeleteBlock_=function(){var t=this.workspace_.trashcan;return this.wouldDeleteBlock_?(t&&goog.Timer.callOnce(t.close,100,t),this.fireMoveEvent_(),this.draggingBlock_.dispose(!1,!0)):t&&t.close(),this.wouldDeleteBlock_},Blockly.BlockDragger.prototype.updateCursorDuringBlockDrag_=function(){this.wouldDeleteBlock_=this.draggedConnectionManager_.wouldDeleteBlock();var t=this.workspace_.trashcan;this.wouldDeleteBlock_?(this.draggingBlock_.setDeleteStyle(!0),this.deleteArea_==Blockly.DELETE_AREA_TRASH&&t&&t.setOpen_(!0)):(this.draggingBlock_.setDeleteStyle(!1),t&&t.setOpen_(!1))},Blockly.BlockDragger.prototype.pixelsToWorkspaceUnits_=function(t){return t=new goog.math.Coordinate(t.x/this.workspace_.scale,t.y/this.workspace_.scale),this.workspace_.isMutator&&(t=t.scale(1/this.workspace_.options.parentWorkspace.scale)),t},Blockly.BlockDragger.prototype.dragIcons_=function(t){for(var e=0;e<this.dragIconData_.length;e++){var o=this.dragIconData_[e];o.icon.setIconLocation(goog.math.Coordinate.sum(o.location,t))}},Blockly.WorkspaceDragger=function(t){this.workspace_=t,this.startDragMetrics_=t.getMetrics(),this.startScrollXY_=new goog.math.Coordinate(t.scrollX,t.scrollY)},Blockly.WorkspaceDragger.prototype.dispose=function(){this.workspace_=null},Blockly.WorkspaceDragger.prototype.startDrag=function(){Blockly.selected&&Blockly.selected.unselect(),this.workspace_.setupDragSurface()},Blockly.WorkspaceDragger.prototype.endDrag=function(t){this.drag(t),this.workspace_.resetDragSurface()},Blockly.WorkspaceDragger.prototype.drag=function(t){var e=this.startDragMetrics_,o=goog.math.Coordinate.sum(this.startScrollXY_,t);t=Math.min(o.x,-e.contentLeft),o=Math.min(o.y,-e.contentTop),t=Math.max(t,e.viewWidth-e.contentLeft-e.contentWidth),o=Math.max(o,e.viewHeight-e.contentTop-e.contentHeight),t=-t-e.contentLeft,o=-o-e.contentTop,this.updateScroll_(t,o)},Blockly.WorkspaceDragger.prototype.updateScroll_=function(t,e){this.workspace_.scrollbar.set(t,e)},Blockly.FlyoutDragger=function(t){Blockly.FlyoutDragger.superClass_.constructor.call(this,t.getWorkspace()),this.scrollbar_=t.scrollbar_,this.horizontalLayout_=t.horizontalLayout_},goog.inherits(Blockly.FlyoutDragger,Blockly.WorkspaceDragger),Blockly.FlyoutDragger.prototype.updateScroll_=function(t,e){this.horizontalLayout_?this.scrollbar_.set(t):this.scrollbar_.set(e)},Blockly.Tooltip={},Blockly.Tooltip.visible=!1,Blockly.Tooltip.blocked_=!1,Blockly.Tooltip.LIMIT=50,Blockly.Tooltip.mouseOutPid_=0,Blockly.Tooltip.showPid_=0,Blockly.Tooltip.lastX_=0,Blockly.Tooltip.lastY_=0,Blockly.Tooltip.element_=null,Blockly.Tooltip.poisonedElement_=null,Blockly.Tooltip.OFFSET_X=0,Blockly.Tooltip.OFFSET_Y=10,Blockly.Tooltip.RADIUS_OK=10,Blockly.Tooltip.HOVER_MS=750,Blockly.Tooltip.MARGINS=5,Blockly.Tooltip.DIV=null,Blockly.Tooltip.createDom=function(){Blockly.Tooltip.DIV||(Blockly.Tooltip.DIV=goog.dom.createDom("DIV","blocklyTooltipDiv"),document.body.appendChild(Blockly.Tooltip.DIV))},Blockly.Tooltip.bindMouseEvents=function(t){Blockly.bindEvent_(t,"mouseover",null,Blockly.Tooltip.onMouseOver_),Blockly.bindEvent_(t,"mouseout",null,Blockly.Tooltip.onMouseOut_),t.addEventListener("mousemove",Blockly.Tooltip.onMouseMove_,!1)},Blockly.Tooltip.onMouseOver_=function(t){if(!Blockly.Tooltip.blocked_){for(t=t.target;!goog.isString(t.tooltip)&&!goog.isFunction(t.tooltip);)t=t.tooltip;Blockly.Tooltip.element_!=t&&(Blockly.Tooltip.hide(),Blockly.Tooltip.poisonedElement_=null,Blockly.Tooltip.element_=t),clearTimeout(Blockly.Tooltip.mouseOutPid_)}},Blockly.Tooltip.onMouseOut_=function(){Blockly.Tooltip.blocked_||(Blockly.Tooltip.mouseOutPid_=setTimeout(function(){Blockly.Tooltip.element_=null,Blockly.Tooltip.poisonedElement_=null,Blockly.Tooltip.hide()},1),clearTimeout(Blockly.Tooltip.showPid_))},Blockly.Tooltip.onMouseMove_=function(t){if(Blockly.Tooltip.element_&&Blockly.Tooltip.element_.tooltip&&!Blockly.WidgetDiv.isVisible()&&!Blockly.Tooltip.blocked_)if(Blockly.Tooltip.visible){var e=Blockly.Tooltip.lastX_-t.pageX;t=Blockly.Tooltip.lastY_-t.pageY,Math.sqrt(e*e+t*t)>Blockly.Tooltip.RADIUS_OK&&Blockly.Tooltip.hide()}else Blockly.Tooltip.poisonedElement_!=Blockly.Tooltip.element_&&(clearTimeout(Blockly.Tooltip.showPid_),Blockly.Tooltip.lastX_=t.pageX,Blockly.Tooltip.lastY_=t.pageY,Blockly.Tooltip.showPid_=setTimeout(Blockly.Tooltip.show_,Blockly.Tooltip.HOVER_MS))},Blockly.Tooltip.hide=function(){Blockly.Tooltip.visible&&(Blockly.Tooltip.visible=!1,Blockly.Tooltip.DIV&&(Blockly.Tooltip.DIV.style.display="none")),clearTimeout(Blockly.Tooltip.showPid_)},Blockly.Tooltip.block=function(){Blockly.Tooltip.hide(),Blockly.Tooltip.blocked_=!0},Blockly.Tooltip.unblock=function(){Blockly.Tooltip.blocked_=!1},Blockly.Tooltip.show_=function(){if(!Blockly.Tooltip.blocked_&&(Blockly.Tooltip.poisonedElement_=Blockly.Tooltip.element_,Blockly.Tooltip.DIV)){goog.dom.removeChildren(Blockly.Tooltip.DIV);for(var t=Blockly.Tooltip.element_.tooltip;goog.isFunction(t);)t=t();t=Blockly.utils.wrap(t,Blockly.Tooltip.LIMIT),t=t.split("\n");for(var e=0;e<t.length;e++){var o=document.createElement("div");o.appendChild(document.createTextNode(t[e])),Blockly.Tooltip.DIV.appendChild(o)}t=Blockly.Tooltip.element_.RTL,e=goog.dom.getViewportSize(),Blockly.Tooltip.DIV.style.direction=t?"rtl":"ltr",Blockly.Tooltip.DIV.style.display="block",Blockly.Tooltip.visible=!0,o=Blockly.Tooltip.lastX_,o=t?o-(Blockly.Tooltip.OFFSET_X+Blockly.Tooltip.DIV.offsetWidth):o+Blockly.Tooltip.OFFSET_X;var n=Blockly.Tooltip.lastY_+Blockly.Tooltip.OFFSET_Y;n+Blockly.Tooltip.DIV.offsetHeight>e.height+window.scrollY&&(n-=Blockly.Tooltip.DIV.offsetHeight+2*Blockly.Tooltip.OFFSET_Y),t?o=Math.max(Blockly.Tooltip.MARGINS-window.scrollX,o):o+Blockly.Tooltip.DIV.offsetWidth>e.width+window.scrollX-2*Blockly.Tooltip.MARGINS&&(o=e.width-Blockly.Tooltip.DIV.offsetWidth-2*Blockly.Tooltip.MARGINS),Blockly.Tooltip.DIV.style.top=n+"px",Blockly.Tooltip.DIV.style.left=o+"px"}},Blockly.Gesture=function(t,e){this.mouseDownXY_=null,this.currentDragDeltaXY_=new goog.math.Coordinate(0,0),this.startWorkspace_=this.targetBlock_=this.startBlock_=this.startField_=null,this.creatorWorkspace_=e,this.isDraggingBlock_=this.isDraggingWorkspace_=this.hasExceededDragRadius_=!1,this.mostRecentEvent_=t,this.flyout_=this.workspaceDragger_=this.blockDragger_=this.onUpWrapper_=this.onMoveWrapper_=null,this.isEnding_=this.hasStarted_=this.calledUpdateIsDragging_=!1},Blockly.Gesture.prototype.dispose=function(){Blockly.Touch.clearTouchIdentifier(),Blockly.Tooltip.unblock(),this.creatorWorkspace_.clearGesture(),this.onMoveWrapper_&&Blockly.unbindEvent_(this.onMoveWrapper_),this.onUpWrapper_&&Blockly.unbindEvent_(this.onUpWrapper_),this.flyout_=this.startWorkspace_=this.targetBlock_=this.startBlock_=this.startField_=null,this.blockDragger_&&(this.blockDragger_.dispose(),this.blockDragger_=null),this.workspaceDragger_&&(this.workspaceDragger_.dispose(),this.workspaceDragger_=null)},Blockly.Gesture.prototype.updateFromEvent_=function(t){var e=new goog.math.Coordinate(t.clientX,t.clientY);this.updateDragDelta_(e)&&(this.updateIsDragging_(),Blockly.longStop_()),this.mostRecentEvent_=t},Blockly.Gesture.prototype.updateDragDelta_=function(t){return this.currentDragDeltaXY_=goog.math.Coordinate.difference(t,this.mouseDownXY_),!this.hasExceededDragRadius_&&(this.hasExceededDragRadius_=goog.math.Coordinate.magnitude(this.currentDragDeltaXY_)>(this.flyout_?Blockly.FLYOUT_DRAG_RADIUS:Blockly.DRAG_RADIUS))},Blockly.Gesture.prototype.updateIsDraggingFromFlyout_=function(){return!this.targetBlock_.disabled&&(!(this.flyout_.isScrollable()&&!this.flyout_.isDragTowardWorkspace(this.currentDragDeltaXY_))&&(this.startWorkspace_=this.flyout_.targetWorkspace_,this.startWorkspace_.updateScreenCalculationsIfScrolled(),Blockly.Events.getGroup()||Blockly.Events.setGroup(!0),this.startBlock_=null,this.targetBlock_=this.flyout_.createBlock(this.targetBlock_),this.targetBlock_.select(),!0))},Blockly.Gesture.prototype.updateIsDraggingBlock_=function(){return!!this.targetBlock_&&(this.flyout_?this.isDraggingBlock_=this.updateIsDraggingFromFlyout_():this.targetBlock_.isMovable()&&(this.isDraggingBlock_=!0),!!this.isDraggingBlock_&&(this.startDraggingBlock_(),!0))},Blockly.Gesture.prototype.updateIsDraggingWorkspace_=function(){(this.flyout_?this.flyout_.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.workspaceDragger_=this.flyout_?new Blockly.FlyoutDragger(this.flyout_):new Blockly.WorkspaceDragger(this.startWorkspace_),this.isDraggingWorkspace_=!0,this.workspaceDragger_.startDrag())},Blockly.Gesture.prototype.updateIsDragging_=function(){goog.asserts.assert(!this.calledUpdateIsDragging_,"updateIsDragging_ should only be called once per gesture."),this.calledUpdateIsDragging_=!0,this.updateIsDraggingBlock_()||this.updateIsDraggingWorkspace_()},Blockly.Gesture.prototype.startDraggingBlock_=function(){this.blockDragger_=new Blockly.BlockDragger(this.targetBlock_,this.startWorkspace_),this.blockDragger_.startBlockDrag(this.currentDragDeltaXY_),this.blockDragger_.dragBlock(this.mostRecentEvent_,this.currentDragDeltaXY_)},Blockly.Gesture.prototype.doStart=function(t){Blockly.utils.isTargetInput(t)?this.cancel():(this.hasStarted_=!0,Blockly.BlockSvg.disconnectUiStop_(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.startWorkspace_.markFocused(),this.mostRecentEvent_=t,Blockly.hideChaff(!!this.flyout_),Blockly.Tooltip.block(),this.targetBlock_&&this.targetBlock_.select(),Blockly.utils.isRightButton(t)?this.handleRightClick(t):(goog.string.caseInsensitiveEquals(t.type,"touchstart")&&Blockly.longStart_(t,this),this.mouseDownXY_=new goog.math.Coordinate(t.clientX,t.clientY),this.onMoveWrapper_=Blockly.bindEventWithChecks_(document,"mousemove",null,this.handleMove.bind(this)),this.onUpWrapper_=Blockly.bindEventWithChecks_(document,"mouseup",null,this.handleUp.bind(this)),t.preventDefault(),t.stopPropagation()))},Blockly.Gesture.prototype.handleMove=function(t){this.updateFromEvent_(t),this.isDraggingWorkspace_?this.workspaceDragger_.drag(this.currentDragDeltaXY_):this.isDraggingBlock_&&this.blockDragger_.dragBlock(this.mostRecentEvent_,this.currentDragDeltaXY_),t.preventDefault(),t.stopPropagation()},Blockly.Gesture.prototype.handleUp=function(t){this.updateFromEvent_(t),Blockly.longStop_(),this.isEnding_?console.log("Trying to end a gesture recursively."):(this.isEnding_=!0,this.isDraggingBlock_?this.blockDragger_.endBlockDrag(t,this.currentDragDeltaXY_):this.isDraggingWorkspace_?this.workspaceDragger_.endDrag(this.currentDragDeltaXY_):this.isFieldClick_()?this.doFieldClick_():this.isBlockClick_()?this.doBlockClick_():this.isWorkspaceClick_()&&this.doWorkspaceClick_(),t.preventDefault(),t.stopPropagation(),this.dispose())},Blockly.Gesture.prototype.cancel=function(){this.isEnding_||(Blockly.longStop_(),this.isDraggingBlock_?this.blockDragger_.endBlockDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingWorkspace_&&this.workspaceDragger_.endDrag(this.currentDragDeltaXY_),this.dispose())},Blockly.Gesture.prototype.handleRightClick=function(t){this.targetBlock_?(this.bringBlockToFront_(),Blockly.hideChaff(this.flyout_),this.targetBlock_.showContextMenu_(t)):this.startWorkspace_&&!this.flyout_&&(Blockly.hideChaff(),this.startWorkspace_.showContextMenu_(t)),t.preventDefault(),t.stopPropagation(),this.dispose()},Blockly.Gesture.prototype.handleWsStart=function(t,e){goog.asserts.assert(!this.hasStarted_,"Tried to call gesture.handleWsStart, but the gesture had already been started."),this.setStartWorkspace_(e),this.mostRecentEvent_=t,this.doStart(t)},Blockly.Gesture.prototype.handleFlyoutStart=function(t,e){goog.asserts.assert(!this.hasStarted_,"Tried to call gesture.handleFlyoutStart, but the gesture had already been started."),this.setStartFlyout_(e),this.handleWsStart(t,e.getWorkspace())},Blockly.Gesture.prototype.handleBlockStart=function(t,e){goog.asserts.assert(!this.hasStarted_,"Tried to call gesture.handleBlockStart, but the gesture had already been started."),this.setStartBlock(e),this.mostRecentEvent_=t},Blockly.Gesture.prototype.doFieldClick_=function(){this.startField_.showEditor_(),this.bringBlockToFront_()},Blockly.Gesture.prototype.doBlockClick_=function(){if(this.flyout_&&this.flyout_.autoClose)this.targetBlock_.disabled||(Blockly.Events.getGroup()||Blockly.Events.setGroup(!0),this.flyout_.createBlock(this.targetBlock_).scheduleSnapAndBump());else if(!Blockly.WidgetDiv.isVisible()&&!Blockly.DropDownDiv.isVisible()){Blockly.Events.fire(new Blockly.Events.Ui(this.startBlock_,"click",void 0,void 0));var t=this.startBlock_.getRootBlock();Blockly.Events.fire(new Blockly.Events.Ui(t,"stackclick",void 0,void 0))}this.bringBlockToFront_(),Blockly.Events.setGroup(!1)},Blockly.Gesture.prototype.doWorkspaceClick_=function(){Blockly.selected&&Blockly.selected.unselect()},Blockly.Gesture.prototype.bringBlockToFront_=function(){this.targetBlock_&&!this.flyout_&&this.targetBlock_.bringToFront()},Blockly.Gesture.prototype.setStartField=function(t){goog.asserts.assert(!this.hasStarted_,"Tried to call gesture.setStartField, but the gesture had already been started."),this.startField_||(this.startField_=t)},Blockly.Gesture.prototype.setStartBlock=function(t){this.startBlock_||(this.startBlock_=t,t.isInFlyout&&t!=t.getRootBlock()?this.setTargetBlock_(t.getRootBlock()):this.setTargetBlock_(t))},Blockly.Gesture.prototype.setTargetBlock_=function(t){t.isShadow()?this.setTargetBlock_(t.getParent()):this.targetBlock_=t},Blockly.Gesture.prototype.setStartWorkspace_=function(t){this.startWorkspace_||(this.startWorkspace_=t)},Blockly.Gesture.prototype.setStartFlyout_=function(t){this.flyout_||(this.flyout_=t)},Blockly.Gesture.prototype.isBlockClick_=function(){return!!this.startBlock_&&!this.hasExceededDragRadius_&&!this.isFieldClick_()},Blockly.Gesture.prototype.isFieldClick_=function(){return!!this.startField_&&this.startField_.isCurrentlyEditable()&&!this.hasExceededDragRadius_},Blockly.Gesture.prototype.isWorkspaceClick_=function(){return!this.startBlock_&&!this.startField_&&!this.hasExceededDragRadius_},Blockly.Gesture.prototype.isDragging=function(){return this.isDraggingWorkspace_||this.isDraggingBlock_},Blockly.Gesture.prototype.hasStarted=function(){return this.hasStarted_},Blockly.Gesture.prototype.forceStartBlockDrag=function(t,e){this.handleBlockStart(t,e),this.handleWsStart(t,e.workspace),this.hasExceededDragRadius_=this.isDraggingBlock_=!0,this.startDraggingBlock_()},Blockly.utils={},Blockly.utils.removeAttribute=function(t,e){goog.userAgent.IE&&goog.userAgent.isVersion("10.0")?t.setAttribute(e,null):t.removeAttribute(e)},Blockly.utils.addClass=function(t,e){var o=t.getAttribute("class")||"";return-1==(" "+o+" ").indexOf(" "+e+" ")&&(o&&(o+=" "),t.setAttribute("class",o+e),!0)},Blockly.utils.removeClass=function(t,e){var o=t.getAttribute("class");if(-1==(" "+o+" ").indexOf(" "+e+" "))return!1;o=o.split(/\s+/);for(var n=0;n<o.length;n++)o[n]&&o[n]!=e||(o.splice(n,1),n--);return o.length?t.setAttribute("class",o.join(" ")):Blockly.utils.removeAttribute(t,"class"),!0},Blockly.utils.hasClass=function(t,e){return-1!=(" "+t.getAttribute("class")+" ").indexOf(" "+e+" ")},Blockly.utils.noEvent=function(t){t.preventDefault(),t.stopPropagation()},Blockly.utils.isTargetInput=function(t){return"textarea"==t.target.type||"text"==t.target.type||"number"==t.target.type||"email"==t.target.type||"password"==t.target.type||"search"==t.target.type||"tel"==t.target.type||"url"==t.target.type||t.target.isContentEditable},Blockly.utils.getRelativeXY=function(t){var e=new goog.math.Coordinate(0,0),o=t.getAttribute("x");return o&&(e.x=parseInt(o,10)),(o=t.getAttribute("y"))&&(e.y=parseInt(o,10)),(o=(o=t.getAttribute("transform"))&&o.match(Blockly.utils.getRelativeXY.XY_REGEX_))&&(e.x+=parseFloat(o[1]),o[3]&&(e.y+=parseFloat(o[3]))),(t=t.getAttribute("style"))&&-1<t.indexOf("translate")&&((o=t.match(Blockly.utils.getRelativeXY.XY_2D_REGEX_))||(o=t.match(Blockly.utils.getRelativeXY.XY_3D_REGEX_)),o&&(e.x+=parseFloat(o[1]),o[3]&&(e.y+=parseFloat(o[3])))),e},Blockly.utils.getInjectionDivXY_=function(t){for(var e,o=0,n=0;t;){var i=Blockly.utils.getRelativeXY(t);if(e=Blockly.utils.getScale_(t),o=o*e+i.x,n=n*e+i.y,-1!=(" "+(t.getAttribute("class")||"")+" ").indexOf(" injectionDiv "))break;t=t.parentNode}return new goog.math.Coordinate(o,n)},Blockly.utils.getScale_=function(t){var e=1;return(t=t.getAttribute("transform"))&&(t=t.match(Blockly.utils.getScale_.REGEXP_))&&t[0]&&(e=parseFloat(t[0])),e},Blockly.utils.getRelativeXY.XY_REGEX_=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*\))?/,Blockly.utils.getScale_REGEXP_=/scale\(\s*([-+\d.e]+)\s*\)/,Blockly.utils.getRelativeXY.XY_3D_REGEX_=/transform:\s*translate3d\(\s*([-+\d.e]+)px([ ,]\s*([-+\d.e]+)\s*)px([ ,]\s*([-+\d.e]+)\s*)px\)?/,Blockly.utils.getRelativeXY.XY_2D_REGEX_=/transform:\s*translate\(\s*([-+\d.e]+)px([ ,]\s*([-+\d.e]+)\s*)px\)?/,Blockly.utils.createSvgElement=function(t,e,o){t=document.createElementNS(Blockly.SVG_NS,t);for(var n in e)t.setAttribute(n,e[n]);return document.body.runtimeStyle&&(t.runtimeStyle=t.currentStyle=t.style),o&&o.appendChild(t),t},Blockly.utils.isRightButton=function(t){return!(!t.ctrlKey||!goog.userAgent.MAC)||2==t.button},Blockly.utils.mouseToSvg=function(t,e,o){var n=e.createSVGPoint();return n.x=t.clientX,n.y=t.clientY,o||(o=e.getScreenCTM().inverse()),n.matrixTransform(o)},Blockly.utils.shortestStringLength=function(t){return t.length?t.reduce(function(t,e){return t.length<e.length?t:e}).length:0},Blockly.utils.commonWordPrefix=function(t,e){if(!t.length)return 0;if(1==t.length)return t[0].length;for(var o=0,n=e||Blockly.utils.shortestStringLength(t),i=0;i<n;i++){for(var r=t[0][i],s=1;s<t.length;s++)if(r!=t[s][i])return o;" "==r&&(o=i+1)}for(s=1;s<t.length;s++)if((r=t[s][i])&&" "!=r)return o;return n},Blockly.utils.commonWordSuffix=function(t,e){if(!t.length)return 0;if(1==t.length)return t[0].length;for(var o=0,n=e||Blockly.utils.shortestStringLength(t),i=0;i<n;i++){for(var r=t[0].substr(-i-1,1),s=1;s<t.length;s++)if(r!=t[s].substr(-i-1,1))return o;" "==r&&(o=i+1)}for(s=1;s<t.length;s++)if((r=t[s].charAt(t[s].length-i-1))&&" "!=r)return o;return n},Blockly.utils.tokenizeInterpolation=function(t){return Blockly.utils.tokenizeInterpolation_(t,!0)},Blockly.utils.replaceMessageReferences=function(t){return goog.isString(t)?(t=Blockly.utils.tokenizeInterpolation_(t,!1),t.length?t[0]:""):t},Blockly.utils.checkMessageReferences=function(t){for(var e=!0,o=/%{BKY_([a-zA-Z][a-zA-Z0-9_]*)}/g,n=o.exec(t);null!=n;){var i=n[1];null==Blockly.Msg[i]&&(console.log("WARNING: No message string for %{BKY_"+i+"}."),e=!1),t=t.substring(n.index+i.length+1),n=o.exec(t)}return e},Blockly.utils.tokenizeInterpolation_=function(t,e){var o=[],n=t.split("");n.push("");for(var i=0,r=[],s=null,a=0;a<n.length;a++){var l=n[a];0==i?"%"==l?((l=r.join(""))&&o.push(l),r.length=0,i=1):r.push(l):1==i?"%"==l?(r.push(l),i=0):e&&"0"<=l&&"9">=l?(i=2,s=l,(l=r.join(""))&&o.push(l),r.length=0):"{"==l?i=3:(r.push("%",l),i=0):2==i?"0"<=l&&"9">=l?s+=l:(o.push(parseInt(s,10)),a--,i=0):3==i&&(""==l?(r.splice(0,0,"%{"),a--,i=0):"}"!=l?r.push(l):(l=r.join(""),/[a-zA-Z][a-zA-Z0-9_]*/.test(l)?(i=l.toUpperCase(),(i=goog.string.startsWith(i,"BKY_")?i.substring(4):null)&&i in Blockly.Msg?(l=Blockly.Msg[i],goog.isString(l)?Array.prototype.push.apply(o,Blockly.utils.tokenizeInterpolation(l)):e?o.push(String(l)):o.push(l)):o.push("%{"+l+"}")):o.push("%{"+l+"}"),i=r.length=0))}for((l=r.join(""))&&o.push(l),n=[],a=r.length=0;a<o.length;++a)"string"==typeof o[a]?r.push(o[a]):((l=r.join(""))&&n.push(l),r.length=0,n.push(o[a]));return(l=r.join(""))&&n.push(l),r.length=0,n},Blockly.utils.genUid=function(){for(var t=Blockly.utils.genUid.soup_.length,e=[],o=0;20>o;o++)e[o]=Blockly.utils.genUid.soup_.charAt(Math.random()*t);return e.join("")},Blockly.utils.genUid.soup_="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Blockly.utils.wrap=function(t,e){for(var o=t.split("\n"),n=0;n<o.length;n++)o[n]=Blockly.utils.wrapLine_(o[n],e);return o.join("\n")},Blockly.utils.wrapLine_=function(t,e){if(t.length<=e)return t;for(var o=t.trim().split(/\s+/),n=0;n<o.length;n++)o[n].length>e&&(e=o[n].length);n=-1/0;var i=1;do{var r=n,s=t,a=[],l=o.length/i,c=1;for(n=0;n<o.length-1;n++)c<(n+1.5)/l?(c++,a[n]=!0):a[n]=!1;a=Blockly.utils.wrapMutate_(o,a,e),n=Blockly.utils.wrapScore_(o,a,e),t=Blockly.utils.wrapToText_(o,a),i++}while(n>r);return s},Blockly.utils.wrapScore_=function(t,e,o){for(var n=[0],i=[],r=0;r<t.length;r++)n[n.length-1]+=t[r].length,!0===e[r]?(n.push(0),i.push(t[r].charAt(t[r].length-1))):!1===e[r]&&n[n.length-1]++;for(t=Math.max.apply(Math,n),r=e=0;r<n.length;r++)e-=2*Math.pow(Math.abs(o-n[r]),1.5),e-=Math.pow(t-n[r],1.5),-1!=".?!".indexOf(i[r])?e+=o/3:-1!=",;)]}".indexOf(i[r])&&(e+=o/4);return 1<n.length&&n[n.length-1]<=n[n.length-2]&&(e+=.5),e},Blockly.utils.wrapMutate_=function(t,e,o){for(var n,i=Blockly.utils.wrapScore_(t,e,o),r=0;r<e.length-1;r++)if(e[r]!=e[r+1]){var s=[].concat(e);s[r]=!s[r],s[r+1]=!s[r+1];var a=Blockly.utils.wrapScore_(t,s,o);a>i&&(i=a,n=s)}return n?Blockly.utils.wrapMutate_(t,n,o):e},Blockly.utils.wrapToText_=function(t,e){for(var o=[],n=0;n<t.length;n++)o.push(t[n]),void 0!==e[n]&&o.push(e[n]?"\n":" ");return o.join("")},Blockly.utils.measureText=function(t,e,o,n){var i=document.createElement("canvas").getContext("2d");return i.font=o+" "+t+" "+e,i.measureText(n).width},Blockly.utils.encodeEntities=function(t){return t.replace(/[\u00A0-\u9999<>\&]/gim,function(t){return"&#"+t.charCodeAt(0)+";"})},Blockly.utils.is3dSupported=function(){if(void 0!==Blockly.utils.is3dSupported.cached_)return Blockly.utils.is3dSupported.cached_;if(!goog.global.getComputedStyle)return!1;var t=document.createElement("p"),e="none",o={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(t,null);for(var n in o)if(void 0!==t.style[n]){if(t.style[n]="translate3d(1px,1px,1px)",!(e=goog.global.getComputedStyle(t)))return document.body.removeChild(t),!1;e=e.getPropertyValue(o[n])}return document.body.removeChild(t),Blockly.utils.is3dSupported.cached_="none"!==e,Blockly.utils.is3dSupported.cached_},Blockly.utils.insertAfter_=function(t,e){var o=e.nextSibling,n=e.parentNode;if(!n)throw"Reference node has no parent.";o?n.insertBefore(t,o):n.appendChild(t)},Blockly.utils.runAfterPageLoad=function(t){if(!document)throw Error("Blockly.utils.runAfterPageLoad() requires browser document.");if("complete"===document.readyState)t();else var e=setInterval(function(){"complete"===document.readyState&&(clearInterval(e),t())},10)},Blockly.utils.setCssTransform=function(t,e){t.style.transform=e,t.style["-webkit-transform"]=e},Blockly.utils.changeObscuredShadowIds=function(t){t=t.getDescendants();for(var e=t.length-1;0<=e;e--)for(var o=t[e],n=0;n<o.inputList.length;n++){var i=o.inputList[n].connection;if(i){var r=i.getShadowDom();r&&(r.setAttribute("id",Blockly.utils.genUid()),i.setShadowDom(r))}}},Blockly.Grid=function(t,e){this.gridPattern_=t,this.spacing_=e.spacing,this.length_=e.length,this.line2_=(this.line1_=t.firstChild)&&this.line1_.nextSibling,this.snapToGrid_=e.snap},Blockly.Grid.prototype.scale_=1,Blockly.Grid.prototype.dispose=function(){this.gridPattern_=null},Blockly.Grid.prototype.shouldSnap=function(){return this.snapToGrid_},Blockly.Grid.prototype.getSpacing=function(){return this.spacing_},Blockly.Grid.prototype.getPatternId=function(){return this.gridPattern_.id},Blockly.Grid.prototype.update=function(t){this.scale_=t;var e=this.spacing_*t||100;this.gridPattern_.setAttribute("width",e),this.gridPattern_.setAttribute("height",e),e=Math.floor(this.spacing_/2)+.5;var o=e-this.length_/2,n=e+this.length_/2;e*=t,o*=t,n*=t,this.setLineAttributes_(this.line1_,t,o,n,e,e),this.setLineAttributes_(this.line2_,t,e,e,o,n)},Blockly.Grid.prototype.setLineAttributes_=function(t,e,o,n,i,r){t&&(t.setAttribute("stroke-width",e),t.setAttribute("x1",o),t.setAttribute("y1",i),t.setAttribute("x2",n),t.setAttribute("y2",r))},Blockly.Grid.prototype.moveTo=function(t,e){this.gridPattern_.setAttribute("x",t),this.gridPattern_.setAttribute("y",e),(goog.userAgent.IE||goog.userAgent.EDGE)&&this.update(this.scale_)},Blockly.Grid.createDom=function(t,e,o){return t=Blockly.utils.createSvgElement("pattern",{id:"blocklyGridPattern"+t,patternUnits:"userSpaceOnUse"},o),0<e.length&&0<e.spacing&&(Blockly.utils.createSvgElement("line",{stroke:e.colour},t),1<e.length&&Blockly.utils.createSvgElement("line",{stroke:e.colour},t)),t},Blockly.Options=function(t){var e,o,n,i,r,s=!!t.readOnly;if(s)var a=null,l=e=o=n=i=r=!1;else t.toolbox||(l=(new DOMParser).parseFromString(Blockly.Blocks.defaultToolbox,"text/xml"),t.toolbox=l.documentElement),a=Blockly.Options.parseToolboxTree(t.toolbox),r=!(!a||!a.getElementsByTagName("category").length),i=t.trashcan,void 0===i&&(i=!1),n=t.collapse,void 0===n&&(n=r),o=t.comments,void 0===o&&(o=r),e=t.disable,void 0===e&&(e=r),void 0===(l=t.sounds)&&(l=!0);var c=!!t.rtl,u=t.horizontalLayout;void 0===u&&(u=!1);var h=t.toolboxPosition;h="end"!==h;var g=u?h?Blockly.TOOLBOX_AT_TOP:Blockly.TOOLBOX_AT_BOTTOM:h==c?Blockly.TOOLBOX_AT_RIGHT:Blockly.TOOLBOX_AT_LEFT,p=t.scrollbars;void 0===p&&(p=r);var d=t.css;void 0===d&&(d=!0);var f="https://blockly-demo.appspot.com/static/media/";t.media?f=t.media:t.path&&(f=t.path+"media/"),h=void 0===t.oneBasedIndex||!!t.oneBasedIndex;var m=!!t.realtime,y=m?t.realtimeOptions:void 0,v=t.colours;if(v)for(var _ in v)v.hasOwnProperty(_)&&Blockly.Colours.hasOwnProperty(_)&&(Blockly.Colours[_]=v[_]);this.RTL=c,this.oneBasedIndex=h,this.collapse=n,this.comments=o,this.disable=e,this.readOnly=s,this.pathToMedia=f,this.hasCategories=r,this.hasScrollbars=p,this.hasTrashcan=i,this.hasSounds=l,this.hasCss=d,this.horizontalLayout=u,this.languageTree=a,this.gridOptions=Blockly.Options.parseGridOptions_(t),this.zoomOptions=Blockly.Options.parseZoomOptions_(t),this.enableRealtime=m,this.realtimeOptions=y,this.toolboxPosition=g},Blockly.Options.prototype.parentWorkspace=null,Blockly.Options.prototype.setMetrics=null,Blockly.Options.prototype.getMetrics=null,Blockly.Options.parseZoomOptions_=function(t){t=t.zoom||{};var e={};return e.controls=void 0!==t.controls&&!!t.controls,e.wheel=void 0!==t.wheel&&!!t.wheel,e.startScale=void 0===t.startScale?1:parseFloat(t.startScale),e.maxScale=void 0===t.maxScale?3:parseFloat(t.maxScale),e.minScale=void 0===t.minScale?.3:parseFloat(t.minScale),e.scaleSpeed=void 0===t.scaleSpeed?1.2:parseFloat(t.scaleSpeed),e},Blockly.Options.parseGridOptions_=function(t){t=t.grid||{};var e={};return e.spacing=parseFloat(t.spacing)||0,e.colour=t.colour||"#888",e.length=parseFloat(t.length)||1,e.snap=0<e.spacing&&!!t.snap,e},Blockly.Options.parseToolboxTree=function(t){return t?("string"!=typeof t&&("undefined"==typeof XSLTProcessor&&t.outerHTML?t=t.outerHTML:t instanceof Element||(t=null)),"string"==typeof t&&(t=Blockly.Xml.textToDom(t))):t=null,t},Blockly.ScrollbarPair=function(t){this.workspace_=t,this.hScroll=new Blockly.Scrollbar(t,!0,!0,"blocklyMainWorkspaceScrollbar"),this.vScroll=new Blockly.Scrollbar(t,!1,!0,"blocklyMainWorkspaceScrollbar"),this.corner_=Blockly.utils.createSvgElement("rect",{height:Blockly.Scrollbar.scrollbarThickness,width:Blockly.Scrollbar.scrollbarThickness,class:"blocklyScrollbarBackground"},null),Blockly.utils.insertAfter_(this.corner_,t.getBubbleCanvas())},Blockly.ScrollbarPair.prototype.oldHostMetrics_=null,Blockly.ScrollbarPair.prototype.dispose=function(){goog.dom.removeNode(this.corner_),this.oldHostMetrics_=this.workspace_=this.corner_=null,this.hScroll.dispose(),this.hScroll=null,this.vScroll.dispose(),this.vScroll=null},Blockly.ScrollbarPair.prototype.resize=function(){var t=this.workspace_.getMetrics();if(t){var e=!1,o=!1;this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth==t.viewWidth&&this.oldHostMetrics_.viewHeight==t.viewHeight&&this.oldHostMetrics_.absoluteTop==t.absoluteTop&&this.oldHostMetrics_.absoluteLeft==t.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.contentWidth==t.contentWidth&&this.oldHostMetrics_.viewLeft==t.viewLeft&&this.oldHostMetrics_.contentLeft==t.contentLeft||(e=!0),this.oldHostMetrics_&&this.oldHostMetrics_.contentHeight==t.contentHeight&&this.oldHostMetrics_.viewTop==t.viewTop&&this.oldHostMetrics_.contentTop==t.contentTop||(o=!0)):o=e=!0,e&&this.hScroll.resize(t),o&&this.vScroll.resize(t),this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth==t.viewWidth&&this.oldHostMetrics_.absoluteLeft==t.absoluteLeft||this.corner_.setAttribute("x",this.vScroll.position_.x),this.oldHostMetrics_&&this.oldHostMetrics_.viewHeight==t.viewHeight&&this.oldHostMetrics_.absoluteTop==t.absoluteTop||this.corner_.setAttribute("y",this.hScroll.position_.y),this.oldHostMetrics_=t}},Blockly.ScrollbarPair.prototype.set=function(t,e){var o={},n=t*this.hScroll.ratio_,i=e*this.vScroll.ratio_,r=this.vScroll.scrollViewSize_;o.x=this.getRatio_(n,this.hScroll.scrollViewSize_),o.y=this.getRatio_(i,r),this.workspace_.setMetrics(o),this.hScroll.setHandlePosition(n),this.vScroll.setHandlePosition(i)},Blockly.ScrollbarPair.prototype.getRatio_=function(t,e){var o=t/e;return isNaN(o)?0:o},Blockly.Scrollbar=function(t,e,o,n){this.workspace_=t,this.pair_=o||!1,this.horizontal_=e,this.oldHostMetrics_=null,this.createDom_(n),this.position_=new goog.math.Coordinate(0,0),e?(this.svgBackground_.setAttribute("height",Blockly.Scrollbar.scrollbarThickness),this.outerSvg_.setAttribute("height",Blockly.Scrollbar.scrollbarThickness),this.svgHandle_.setAttribute("height",Blockly.Scrollbar.scrollbarThickness-5),this.svgHandle_.setAttribute("y",2.5),this.lengthAttribute_="width",this.positionAttribute_="x"):(this.svgBackground_.setAttribute("width",Blockly.Scrollbar.scrollbarThickness),this.outerSvg_.setAttribute("width",Blockly.Scrollbar.scrollbarThickness),this.svgHandle_.setAttribute("width",Blockly.Scrollbar.scrollbarThickness-5),this.svgHandle_.setAttribute("x",2.5),this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=Blockly.bindEventWithChecks_(this.svgBackground_,"mousedown",this,this.onMouseDownBar_),this.onMouseDownHandleWrapper_=Blockly.bindEventWithChecks_(this.svgHandle_,"mousedown",this,this.onMouseDownHandle_)},Blockly.Scrollbar.prototype.origin_=new goog.math.Coordinate(0,0),Blockly.Scrollbar.prototype.originHasChanged_=!0,Blockly.Scrollbar.prototype.scrollViewSize_=0,Blockly.Scrollbar.prototype.handleLength_=0,Blockly.Scrollbar.prototype.handlePosition_=0,Blockly.Scrollbar.prototype.isVisible_=!0,Blockly.Scrollbar.prototype.containerVisible_=!0,Blockly.Scrollbar.scrollbarThickness=11,goog.events.BrowserFeature.TOUCH_ENABLED&&(Blockly.Scrollbar.scrollbarThickness=25),Blockly.Scrollbar.metricsAreEquivalent_=function(t,e){return!(!t||!e||t.viewWidth!=e.viewWidth||t.viewHeight!=e.viewHeight||t.viewLeft!=e.viewLeft||t.viewTop!=e.viewTop||t.absoluteTop!=e.absoluteTop||t.absoluteLeft!=e.absoluteLeft||t.contentWidth!=e.contentWidth||t.contentHeight!=e.contentHeight||t.contentLeft!=e.contentLeft||t.contentTop!=e.contentTop)},Blockly.Scrollbar.prototype.dispose=function(){this.cleanUp_(),Blockly.unbindEvent_(this.onMouseDownBarWrapper_),this.onMouseDownBarWrapper_=null,Blockly.unbindEvent_(this.onMouseDownHandleWrapper_),this.onMouseDownHandleWrapper_=null,goog.dom.removeNode(this.outerSvg_),this.workspace_=this.svgHandle_=this.svgBackground_=this.svgGroup_=this.outerSvg_=null},Blockly.Scrollbar.prototype.setHandleLength_=function(t){this.handleLength_=t,this.svgHandle_.setAttribute(this.lengthAttribute_,this.handleLength_)},Blockly.Scrollbar.prototype.setHandlePosition=function(t){this.handlePosition_=t,this.svgHandle_.setAttribute(this.positionAttribute_,this.handlePosition_)},Blockly.Scrollbar.prototype.setScrollViewSize_=function(t){this.scrollViewSize_=t,this.outerSvg_.setAttribute(this.lengthAttribute_,this.scrollViewSize_),this.svgBackground_.setAttribute(this.lengthAttribute_,this.scrollViewSize_)},Blockly.ScrollbarPair.prototype.setContainerVisible=function(t){this.hScroll.setContainerVisible(t),this.vScroll.setContainerVisible(t)},Blockly.Scrollbar.prototype.setPosition=function(t,e){this.position_.x=t,this.position_.y=e,Blockly.utils.setCssTransform(this.outerSvg_,"translate("+(this.position_.x+this.origin_.x)+"px,"+(this.position_.y+this.origin_.y)+"px)")},Blockly.Scrollbar.prototype.resize=function(t){if(t||(t=this.workspace_.getMetrics())){if(this.originHasChanged_)this.originHasChanged_=!1;else if(Blockly.Scrollbar.metricsAreEquivalent_(t,this.oldHostMetrics_))return;this.oldHostMetrics_=t,this.horizontal_?this.resizeHorizontal_(t):this.resizeVertical_(t),this.onScroll_()}},Blockly.Scrollbar.prototype.resizeHorizontal_=function(t){this.resizeViewHorizontal(t)},Blockly.Scrollbar.prototype.resizeViewHorizontal=function(t){var e=t.viewWidth-1;this.pair_&&(e-=Blockly.Scrollbar.scrollbarThickness),this.setScrollViewSize_(Math.max(0,e)),e=t.absoluteLeft+.5,this.pair_&&this.workspace_.RTL&&(e+=Blockly.Scrollbar.scrollbarThickness),this.setPosition(e,t.absoluteTop+t.viewHeight-Blockly.Scrollbar.scrollbarThickness-.5),this.resizeContentHorizontal(t)},Blockly.Scrollbar.prototype.resizeContentHorizontal=function(t){this.pair_||this.setVisible(this.scrollViewSize_<t.contentWidth),this.ratio_=this.scrollViewSize_/t.contentWidth,(-1/0==this.ratio_||1/0==this.ratio_||isNaN(this.ratio_))&&(this.ratio_=0),this.setHandleLength_(Math.max(0,t.viewWidth*this.ratio_)),this.setHandlePosition(this.constrainHandle_((t.viewLeft-t.contentLeft)*this.ratio_))},Blockly.Scrollbar.prototype.resizeVertical_=function(t){this.resizeViewVertical(t)},Blockly.Scrollbar.prototype.resizeViewVertical=function(t){var e=t.viewHeight-1;this.pair_&&(e-=Blockly.Scrollbar.scrollbarThickness),this.setScrollViewSize_(Math.max(0,e)),e=t.absoluteLeft+.5,this.workspace_.RTL||(e+=t.viewWidth-Blockly.Scrollbar.scrollbarThickness-1),this.setPosition(e,t.absoluteTop+.5),this.resizeContentVertical(t)},Blockly.Scrollbar.prototype.resizeContentVertical=function(t){this.pair_||this.setVisible(this.scrollViewSize_<t.contentHeight),this.ratio_=this.scrollViewSize_/t.contentHeight,(-1/0==this.ratio_||1/0==this.ratio_||isNaN(this.ratio_))&&(this.ratio_=0),this.setHandleLength_(Math.max(0,t.viewHeight*this.ratio_)),this.setHandlePosition(this.constrainHandle_((t.viewTop-t.contentTop)*this.ratio_))},Blockly.Scrollbar.prototype.createDom_=function(t){var e="blocklyScrollbar"+(this.horizontal_?"Horizontal":"Vertical");t&&(e+=" "+t),this.outerSvg_=Blockly.utils.createSvgElement("svg",{class:e},null),this.svgGroup_=Blockly.utils.createSvgElement("g",{},this.outerSvg_),this.svgBackground_=Blockly.utils.createSvgElement("rect",{class:"blocklyScrollbarBackground"},this.svgGroup_),t=Math.floor((Blockly.Scrollbar.scrollbarThickness-5)/2),this.svgHandle_=Blockly.utils.createSvgElement("rect",{class:"blocklyScrollbarHandle",rx:t,ry:t},this.svgGroup_),Blockly.utils.insertAfter_(this.outerSvg_,this.workspace_.getParentSvg())},Blockly.Scrollbar.prototype.isVisible=function(){return this.isVisible_},Blockly.Scrollbar.prototype.setContainerVisible=function(t){var e=t!=this.containerVisible_;this.containerVisible_=t,e&&this.updateDisplay_()},Blockly.Scrollbar.prototype.setVisible=function(t){var e=t!=this.isVisible();if(this.pair_)throw"Unable to toggle visibility of paired scrollbars.";this.isVisible_=t,e&&this.updateDisplay_()},Blockly.Scrollbar.prototype.updateDisplay_=function(){this.containerVisible_&&this.isVisible()?this.outerSvg_.setAttribute("display","block"):this.outerSvg_.setAttribute("display","none")},Blockly.Scrollbar.prototype.onMouseDownBar_=function(t){if(this.workspace_.markFocused(),Blockly.Touch.clearTouchIdentifier(),this.cleanUp_(),Blockly.utils.isRightButton(t))t.stopPropagation();else{var e=Blockly.utils.mouseToSvg(t,this.workspace_.getParentSvg(),this.workspace_.getInverseScreenCTM());e=this.horizontal_?e.x:e.y;var o=Blockly.utils.getInjectionDivXY_(this.svgHandle_);o=this.horizontal_?o.x:o.y;var n=this.handlePosition_,i=.95*this.handleLength_;e<=o?n-=i:e>=o+this.handleLength_&&(n+=i),Blockly.WidgetDiv.hide(!0),Blockly.DropDownDiv.hideWithoutAnimation(),this.setHandlePosition(this.constrainHandle_(n)),this.onScroll_(),t.stopPropagation(),t.preventDefault()}},Blockly.Scrollbar.prototype.onMouseDownHandle_=function(t){this.workspace_.markFocused(),this.cleanUp_(),Blockly.utils.isRightButton(t)?t.stopPropagation():(this.startDragHandle=this.handlePosition_,this.workspace_.setupDragSurface(),this.startDragMouse=this.horizontal_?t.clientX:t.clientY,Blockly.Scrollbar.onMouseUpWrapper_=Blockly.bindEventWithChecks_(document,"mouseup",this,this.onMouseUpHandle_),Blockly.Scrollbar.onMouseMoveWrapper_=Blockly.bindEventWithChecks_(document,"mousemove",this,this.onMouseMoveHandle_),Blockly.WidgetDiv.hide(!0),Blockly.DropDownDiv.hideWithoutAnimation(),t.stopPropagation(),t.preventDefault())},Blockly.Scrollbar.prototype.onMouseMoveHandle_=function(t){this.setHandlePosition(this.constrainHandle_(this.startDragHandle+((this.horizontal_?t.clientX:t.clientY)-this.startDragMouse))),this.onScroll_()},Blockly.Scrollbar.prototype.onMouseUpHandle_=function(){this.workspace_.resetDragSurface(),Blockly.Touch.clearTouchIdentifier(),this.cleanUp_()},Blockly.Scrollbar.prototype.cleanUp_=function(){Blockly.hideChaff(!0),Blockly.Scrollbar.onMouseUpWrapper_&&(Blockly.unbindEvent_(Blockly.Scrollbar.onMouseUpWrapper_),Blockly.Scrollbar.onMouseUpWrapper_=null),Blockly.Scrollbar.onMouseMoveWrapper_&&(Blockly.unbindEvent_(Blockly.Scrollbar.onMouseMoveWrapper_),Blockly.Scrollbar.onMouseMoveWrapper_=null)},Blockly.Scrollbar.prototype.constrainHandle_=function(t){return t=0>=t||isNaN(t)||this.scrollViewSize_<this.handleLength_?0:Math.min(t,this.scrollViewSize_-this.handleLength_)},Blockly.Scrollbar.prototype.onScroll_=function(){var t=this.handlePosition_/this.scrollViewSize_;isNaN(t)&&(t=0);var e={};this.horizontal_?e.x=t:e.y=t,this.workspace_.setMetrics(e)},Blockly.Scrollbar.prototype.set=function(t){this.setHandlePosition(this.constrainHandle_(t*this.ratio_)),this.onScroll_()};Blockly.Scrollbar.prototype.setOrigin=function(t,e){t==this.origin_.x&&e==this.origin_.y||(this.origin_=new goog.math.Coordinate(t,e),this.originHasChanged_=!0)},Blockly.Trashcan=function(t){this.workspace_=t},Blockly.Trashcan.prototype.WIDTH_=47,Blockly.Trashcan.prototype.BODY_HEIGHT_=44,Blockly.Trashcan.prototype.LID_HEIGHT_=16,Blockly.Trashcan.prototype.MARGIN_BOTTOM_=20,Blockly.Trashcan.prototype.MARGIN_SIDE_=20,Blockly.Trashcan.prototype.MARGIN_HOTSPOT_=10,Blockly.Trashcan.prototype.SPRITE_LEFT_=0,Blockly.Trashcan.prototype.SPRITE_TOP_=32,Blockly.Trashcan.prototype.isOpen=!1,Blockly.Trashcan.prototype.svgGroup_=null,Blockly.Trashcan.prototype.svgLid_=null,Blockly.Trashcan.prototype.lidTask_=0,Blockly.Trashcan.prototype.lidOpen_=0,Blockly.Trashcan.prototype.left_=0,Blockly.Trashcan.prototype.top_=0,Blockly.Trashcan.prototype.createDom=function(){this.svgGroup_=Blockly.utils.createSvgElement("g",{class:"blocklyTrash"},null);var t=String(Math.random()).substring(2),e=Blockly.utils.createSvgElement("clipPath",{id:"blocklyTrashBodyClipPath"+t},this.svgGroup_);return Blockly.utils.createSvgElement("rect",{width:this.WIDTH_,height:this.BODY_HEIGHT_,y:this.LID_HEIGHT_},e),Blockly.utils.createSvgElement("image",{width:Blockly.SPRITE.width,x:-this.SPRITE_LEFT_,height:Blockly.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashBodyClipPath"+t+")"},this.svgGroup_).setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this.workspace_.options.pathToMedia+Blockly.SPRITE.url),e=Blockly.utils.createSvgElement("clipPath",{id:"blocklyTrashLidClipPath"+t},this.svgGroup_),Blockly.utils.createSvgElement("rect",{width:this.WIDTH_,height:this.LID_HEIGHT_},e),this.svgLid_=Blockly.utils.createSvgElement("image",{width:Blockly.SPRITE.width,x:-this.SPRITE_LEFT_,height:Blockly.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashLidClipPath"+t+")"},this.svgGroup_),this.svgLid_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this.workspace_.options.pathToMedia+Blockly.SPRITE.url),Blockly.bindEventWithChecks_(this.svgGroup_,"mouseup",this,this.click),this.animateLid_(),this.svgGroup_},Blockly.Trashcan.prototype.init=function(t){return this.bottom_=this.MARGIN_BOTTOM_+t,this.setOpen_(!1),this.bottom_+this.BODY_HEIGHT_+this.LID_HEIGHT_},Blockly.Trashcan.prototype.dispose=function(){this.svgGroup_&&(goog.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.workspace_=this.svgLid_=null,clearTimeout(this.lidTask_)},Blockly.Trashcan.prototype.position=function(){var t=this.workspace_.getMetrics();t&&(this.workspace_.RTL?(this.left_=this.MARGIN_SIDE_+Blockly.Scrollbar.scrollbarThickness,t.toolboxPosition==Blockly.TOOLBOX_AT_LEFT&&(this.left_+=t.flyoutWidth,this.workspace_.toolbox_&&(this.left_+=t.absoluteLeft))):(this.left_=t.viewWidth+t.absoluteLeft-this.WIDTH_-this.MARGIN_SIDE_-Blockly.Scrollbar.scrollbarThickness,t.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT&&(this.left_-=t.flyoutWidth)),this.top_=t.viewHeight+t.absoluteTop-(this.BODY_HEIGHT_+this.LID_HEIGHT_)-this.bottom_,t.toolboxPosition==Blockly.TOOLBOX_AT_BOTTOM&&(this.top_-=t.flyoutHeight),this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")"))},Blockly.Trashcan.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var t=this.svgGroup_.getBoundingClientRect();return new goog.math.Rect(t.left+this.SPRITE_LEFT_-this.MARGIN_HOTSPOT_,t.top+this.SPRITE_TOP_-this.MARGIN_HOTSPOT_,this.WIDTH_+2*this.MARGIN_HOTSPOT_,this.LID_HEIGHT_+this.BODY_HEIGHT_+2*this.MARGIN_HOTSPOT_)},Blockly.Trashcan.prototype.setOpen_=function(t){this.isOpen!=t&&(clearTimeout(this.lidTask_),this.isOpen=t,this.animateLid_())},Blockly.Trashcan.prototype.animateLid_=function(){this.lidOpen_+=this.isOpen?.2:-.2,this.lidOpen_=goog.math.clamp(this.lidOpen_,0,1);var t=45*this.lidOpen_;this.svgLid_.setAttribute("transform","rotate("+(this.workspace_.RTL?-t:t)+","+(this.workspace_.RTL?4:this.WIDTH_-4)+","+(this.LID_HEIGHT_-2)+")"),t=goog.math.lerp(.4,.8,this.lidOpen_),this.svgGroup_.style.opacity=t,0<this.lidOpen_&&1>this.lidOpen_&&(this.lidTask_=setTimeout(this.animateLid_.bind(this),20))},Blockly.Trashcan.prototype.close=function(){this.setOpen_(!1)},Blockly.Trashcan.prototype.click=function(){var t=this.workspace_.startScrollX-this.workspace_.scrollX,e=this.workspace_.startScrollY-this.workspace_.scrollY;Math.sqrt(t*t+e*e)>Blockly.DRAG_RADIUS||console.log("TODO: Inspect trash.")},Blockly.WorkspaceAudio=function(t){this.parentWorkspace_=t,this.SOUNDS_=Object.create(null)},Blockly.WorkspaceAudio.prototype.lastSound_=null,Blockly.WorkspaceAudio.prototype.dispose=function(){this.SOUNDS_=this.parentWorkspace_=null},Blockly.WorkspaceAudio.prototype.load=function(t,e){if(t.length){try{var o=new window.Audio}catch(t){return}for(var n,i=0;i<t.length;i++){var r=t[i],s=r.match(/\.(\w+)$/);if(s&&o.canPlayType("audio/"+s[1])){n=new window.Audio(r);break}}n&&n.play&&(this.SOUNDS_[e]=n)}},Blockly.WorkspaceAudio.prototype.preload=function(){for(var t in this.SOUNDS_){var e=this.SOUNDS_[t];if(e.volume=.01,e.play(),e.pause(),goog.userAgent.IPAD||goog.userAgent.IPHONE)break}},Blockly.WorkspaceAudio.prototype.play=function(t,e){var o=this.SOUNDS_[t];if(o){var n=new Date;null!=this.lastSound_&&n-this.lastSound_<Blockly.SOUND_LIMIT||(this.lastSound_=n,o=goog.userAgent.DOCUMENT_MODE&&9===goog.userAgent.DOCUMENT_MODE||goog.userAgent.IPAD||goog.userAgent.ANDROID?o:o.cloneNode(),o.volume=void 0===e?1:e,o.play())}else this.parentWorkspace_&&this.parentWorkspace_.getAudioManager().play(t,e)},Blockly.WorkspaceDragSurfaceSvg=function(t){this.container_=t,this.createDom()},Blockly.WorkspaceDragSurfaceSvg.prototype.SVG_=null,Blockly.WorkspaceDragSurfaceSvg.prototype.dragGroup_=null,Blockly.WorkspaceDragSurfaceSvg.prototype.container_=null,Blockly.WorkspaceDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=Blockly.utils.createSvgElement("svg",{xmlns:Blockly.SVG_NS,"xmlns:html":Blockly.HTML_NS,"xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",class:"blocklyWsDragSurface"},null),this.container_.appendChild(this.SVG_))},Blockly.WorkspaceDragSurfaceSvg.prototype.translateSurface=function(t,e){t=t.toFixed(0),e=e.toFixed(0),this.SVG_.style.display="block",Blockly.utils.setCssTransform(this.SVG_,"translate3d("+t+"px, "+e+"px, 0px)")},Blockly.WorkspaceDragSurfaceSvg.prototype.getSurfaceTranslation=function(){return Blockly.utils.getRelativeXY(this.SVG_)},Blockly.WorkspaceDragSurfaceSvg.prototype.clearAndHide=function(t){var e=this.SVG_.childNodes[0],o=this.SVG_.childNodes[1];if(!(e&&o&&Blockly.utils.hasClass(e,"blocklyBlockCanvas")&&Blockly.utils.hasClass(o,"blocklyBubbleCanvas")))throw"Couldn't clear and hide the drag surface.  A node was missing.";null!=this.previousSibling_?Blockly.utils.insertAfter_(e,this.previousSibling_):t.insertBefore(e,t.firstChild),Blockly.utils.insertAfter_(o,e),this.SVG_.style.display="none",goog.asserts.assert(0==this.SVG_.childNodes.length,"Drag surface was not cleared."),Blockly.utils.setCssTransform(this.SVG_,""),this.previousSibling_=null},Blockly.WorkspaceDragSurfaceSvg.prototype.setContentsAndShow=function(t,e,o,n,i,r){goog.asserts.assert(0==this.SVG_.childNodes.length,"Already dragging a block."),this.previousSibling_=o,t.setAttribute("transform","translate(0, 0) scale("+r+")"),e.setAttribute("transform","translate(0, 0) scale("+r+")"),this.SVG_.setAttribute("width",n),this.SVG_.setAttribute("height",i),this.SVG_.appendChild(t),this.SVG_.appendChild(e),this.SVG_.style.display="block"},Blockly.Xml={},Blockly.Xml.workspaceToDom=function(t,e){var o=goog.dom.createDom("xml");o.appendChild(Blockly.Xml.variablesToDom(t.getAllVariables()));for(var n,i=t.getTopBlocks(!0),r=0;n=i[r];r++)o.appendChild(Blockly.Xml.blockToDomWithXY(n,e));return o},Blockly.Xml.variablesToDom=function(t){for(var e,o=goog.dom.createDom("variables"),n=0;e=t[n];n++){var i=goog.dom.createDom("variable",null,e.name);i.setAttribute("type",e.type),i.setAttribute("id",e.getId()),o.appendChild(i)}return o},Blockly.Xml.blockToDomWithXY=function(t,e){var o;t.workspace.RTL&&(o=t.workspace.getWidth());var n=Blockly.Xml.blockToDom(t,e),i=t.getRelativeToSurfaceXY();return n.setAttribute("x",Math.round(t.workspace.RTL?o-i.x:i.x)),n.setAttribute("y",Math.round(i.y)),n},Blockly.Xml.blockToDom=function(t,e){var o,n=goog.dom.createDom(t.isShadow()?"shadow":"block");if(n.setAttribute("type",t.type),e||n.setAttribute("id",t.id),t.mutationToDom){var i=t.mutationToDom();i&&(i.hasChildNodes()||i.hasAttributes())&&n.appendChild(i)}i=0;for(var r;r=t.inputList[i];i++)for(var s,a=0;s=r.fieldRow[a];a++){var l=s;l.name&&l.EDITABLE&&(s=goog.dom.createDom("field",null,l.getValue()),s.setAttribute("name",l.name),(l instanceof Blockly.FieldVariable||l instanceof Blockly.FieldVariableGetter)&&(l=t.workspace.getVariable(l.getValue()))&&(s.setAttribute("id",l.getId()),s.setAttribute("variableType",l.type)),n.appendChild(s))}for((i=t.getCommentText())&&(i=goog.dom.createDom("comment",null,i),"object"==typeof t.comment&&(i.setAttribute("pinned",t.comment.isVisible()),r=t.comment.getBubbleSize(),i.setAttribute("h",r.height),i.setAttribute("w",r.width)),n.appendChild(i)),t.data&&(i=goog.dom.createDom("data",null,t.data),n.appendChild(i)),i=0;r=t.inputList[i];i++)s=!0,r.type!=Blockly.DUMMY_INPUT&&(l=r.connection.targetBlock(),r.type==Blockly.INPUT_VALUE?o=goog.dom.createDom("value"):r.type==Blockly.NEXT_STATEMENT&&(o=goog.dom.createDom("statement")),a=r.connection.getShadowDom(),!a||l&&l.isShadow()||o.appendChild(Blockly.Xml.cloneShadow_(a)),l&&(o.appendChild(Blockly.Xml.blockToDom(l,e)),s=!1),o.setAttribute("name",r.name),s||n.appendChild(o));return t.inputsInlineDefault!=t.inputsInline&&n.setAttribute("inline",t.inputsInline),t.isCollapsed()&&n.setAttribute("collapsed",!0),t.disabled&&n.setAttribute("disabled",!0),t.isDeletable()||t.isShadow()||n.setAttribute("deletable",!1),t.isMovable()||t.isShadow()||n.setAttribute("movable",!1),t.isEditable()||n.setAttribute("editable",!1),(i=t.getNextBlock())&&(o=goog.dom.createDom("next",null,Blockly.Xml.blockToDom(i,e)),n.appendChild(o)),a=t.nextConnection&&t.nextConnection.getShadowDom(),!a||i&&i.isShadow()||o.appendChild(Blockly.Xml.cloneShadow_(a)),n},Blockly.Xml.cloneShadow_=function(t){for(var e,o=t=t.cloneNode(!0);o;)if(o.firstChild)o=o.firstChild;else{for(;o&&!o.nextSibling;)e=o,o=o.parentNode,3==e.nodeType&&""==e.data.trim()&&o.firstChild!=e&&goog.dom.removeNode(e);o&&(e=o,o=o.nextSibling,3==e.nodeType&&""==e.data.trim()&&goog.dom.removeNode(e))}return t},Blockly.Xml.domToText=function(t){return(new XMLSerializer).serializeToString(t)},Blockly.Xml.domToPrettyText=function(t){t=Blockly.Xml.domToText(t).split("<");for(var e="",o=1;o<t.length;o++){var n=t[o];"/"==n[0]&&(e=e.substring(2)),t[o]=e+"<"+n,"/"!=n[0]&&"/>"!=n.slice(-2)&&(e+="  ")}return t=t.join("\n"),t=t.replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>"),t.replace(/^\n/,"")},Blockly.Xml.textToDom=function(t){return(t=(new DOMParser).parseFromString(t,"text/xml"))&&t.firstChild&&"xml"==t.firstChild.nodeName.toLowerCase()&&t.firstChild===t.lastChild||goog.asserts.fail("Blockly.Xml.textToDom did not obtain a valid XML tree."),t.firstChild},Blockly.Xml.domToWorkspace=function(t,e){if(t instanceof Blockly.Workspace){var o=t;t=e,e=o,console.warn("Deprecated call to Blockly.Xml.domToWorkspace, swap the arguments.")}var n;e.RTL&&(n=e.getWidth()),o=[],Blockly.Field.startCache();var i=t.childNodes.length,r=Blockly.Events.getGroup();r||Blockly.Events.setGroup(!0),e.setResizesEnabled&&e.setResizesEnabled(!1);var s=!0;try{for(var a=0;a<i;a++){var l=t.childNodes[a],c=l.nodeName.toLowerCase();if("block"==c||"shadow"==c&&!Blockly.Events.recordUndo){var u=Blockly.Xml.domToBlock(l,e);o.push(u.id);var h=parseInt(l.getAttribute("x"),10),g=parseInt(l.getAttribute("y"),10);isNaN(h)||isNaN(g)||u.moveBy(e.RTL?n-h:h,g),s=!1}else if("shadow"==c)goog.asserts.fail("Shadow block cannot be a top-level block."),s=!1;else if("variables"==c){if(!s)throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");Blockly.Xml.domToVariables(l,e),s=!1}}}finally{r||Blockly.Events.setGroup(!1),Blockly.Field.stopCache()}return e.updateVariableStore(!1),e.setResizesEnabled&&e.setResizesEnabled(!0),o},Blockly.Xml.appendDomToWorkspace=function(t,e){if(e.hasOwnProperty("scale")){var o=Blockly.BlockSvg.TAB_WIDTH;try{Blockly.BlockSvg.TAB_WIDTH=0;var n=e.getBlocksBoundingBox()}finally{Blockly.BlockSvg.TAB_WIDTH=o}}if(o=Blockly.Xml.domToWorkspace(t,e),n&&n.height){var i=n.y+n.height,r=n.x,s=1/0,a=1/0;for(n=0;n<o.length;n++){var l=e.getBlockById(o[n]).getRelativeToSurfaceXY();l.y<a&&(a=l.y),l.x<s&&(s=l.x)}i=i-a+Blockly.BlockSvg.SEP_SPACE_Y,r-=s;var c;for(e.RTL&&(c=e.getWidth()),n=0;n<o.length;n++)e.getBlockById(o[n]).moveBy(e.RTL?c-r:r,i)}return o},Blockly.Xml.domToBlock=function(t,e){if(t instanceof Blockly.Workspace){var o=t;t=e,e=o,console.warn("Deprecated call to Blockly.Xml.domToBlock, swap the arguments.")}Blockly.Events.disable();try{var n=Blockly.Xml.domToBlockHeadless_(t,e);if(e.rendered){n.setConnectionsHidden(!0);for(var i=n.getDescendants(),r=i.length-1;0<=r;r--)i[r].initSvg();for(r=i.length-1;0<=r;r--)i[r].render(!1);e.isFlyout?setTimeout(function(){n.workspace&&(goog.userAgent.IE||goog.userAgent.EDGE)&&n.render()},1):setTimeout(function(){n.workspace&&(n.setConnectionsHidden(!1),(goog.userAgent.IE||goog.userAgent.EDGE)&&n.render())},1),n.updateDisabled(),e.resizeContents()}}finally{Blockly.Events.enable()}return Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.BlockCreate(n)),n},Blockly.Xml.domToVariables=function(t,e){for(var o,n=0;o=t.children[n];n++){var i=o.getAttribute("type"),r=o.getAttribute("id");if(o=o.textContent,null===i)throw Error("Variable with id, "+r+" is without a type");e.createVariable(o,i,r)}},Blockly.Xml.domToBlockHeadless_=function(t,e){var o=null,n=t.getAttribute("type");goog.asserts.assert(n,"Block type unspecified: %s",t.outerHTML);var i=t.getAttribute("id");o=e.newBlock(n,i);for(var r,s=null,a=0;r=t.childNodes[a];a++)if(3!=r.nodeType){var l=null,c=null;s=0;for(var u;u=r.childNodes[s];s++)1==u.nodeType&&("block"==u.nodeName.toLowerCase()?l=u:"shadow"==u.nodeName.toLowerCase()&&(c=u));switch(!l&&c&&(l=c),s=r.getAttribute("name"),r.nodeName.toLowerCase()){case"mutation":o.domToMutation&&(o.domToMutation(r),o.initSvg&&o.initSvg());break;case"comment":o.setCommentText(r.textContent);var h=r.getAttribute("pinned");h&&!o.isInFlyout&&setTimeout(function(){o.comment&&o.comment.setVisible&&o.comment.setVisible("true"==h)},1),s=parseInt(r.getAttribute("w"),10),r=parseInt(r.getAttribute("h"),10),!isNaN(s)&&!isNaN(r)&&o.comment&&o.comment.setVisible&&o.comment.setBubbleSize(s,r);break;case"data":o.data=r.textContent;break;case"title":case"field":if(l=o.getField(s),c=r.textContent,l instanceof Blockly.FieldVariable||l instanceof Blockly.FieldVariableGetter){u=r.getAttribute("variableType")||"";var g=e.getVariable(c);if(g||(g=e.createVariable(c,u,r.getAttribute(i))),null!==u&&u!==g.type)throw Error("Serialized variable type with id '"+g.getId()+"' had type "+g.type+", and does not match variable field that references it: "+Blockly.Xml.domToText(r)+".")}if(!l){console.warn("Ignoring non-existent field "+s+" in block "+n);break}l.setValue(c);break;case"value":case"statement":if(!(r=o.getInput(s))){console.warn("Ignoring non-existent input "+s+" in block "+n);break}c&&r.connection.setShadowDom(c),l&&(s=Blockly.Xml.domToBlockHeadless_(l,e),s.outputConnection?r.connection.connect(s.outputConnection):s.previousConnection?r.connection.connect(s.previousConnection):goog.asserts.fail("Child block does not have output or previous statement."));break;case"next":c&&o.nextConnection&&o.nextConnection.setShadowDom(c),l&&(goog.asserts.assert(o.nextConnection,"Next statement does not exist."),goog.asserts.assert(!o.nextConnection.isConnected(),"Next statement is already connected."),s=Blockly.Xml.domToBlockHeadless_(l,e),goog.asserts.assert(s.previousConnection,"Next block does not have previous statement."),o.nextConnection.connect(s.previousConnection));break;default:console.warn("Ignoring unknown tag: "+r.nodeName)}}if((a=t.getAttribute("inline"))&&o.setInputsInline("true"==a),(a=t.getAttribute("disabled"))&&o.setDisabled("true"==a),(a=t.getAttribute("deletable"))&&o.setDeletable("true"==a),(a=t.getAttribute("movable"))&&o.setMovable("true"==a),(a=t.getAttribute("editable"))&&o.setEditable("true"==a),(a=t.getAttribute("collapsed"))&&o.setCollapsed("true"==a),"shadow"==t.nodeName.toLowerCase()){for(n=o.getChildren(),a=0;i=n[a];a++)goog.asserts.assert(i.isShadow(),"Shadow block not allowed non-shadow child.");goog.asserts.assert(0==o.getVars().length,"Shadow blocks cannot have variable fields."),o.setShadow(!0)}return o},Blockly.Xml.deleteNext=function(t){for(var e,o=0;e=t.childNodes[o];o++)if("next"==e.nodeName.toLowerCase()){t.removeChild(e);break}},goog.global.Blockly||(goog.global.Blockly={}),goog.global.Blockly.Xml||(goog.global.Blockly.Xml={}),goog.global.Blockly.Xml.domToText=Blockly.Xml.domToText,goog.global.Blockly.Xml.domToWorkspace=Blockly.Xml.domToWorkspace,goog.global.Blockly.Xml.textToDom=Blockly.Xml.textToDom,goog.global.Blockly.Xml.workspaceToDom=Blockly.Xml.workspaceToDom,Blockly.ZoomControls=function(t){this.workspace_=t},Blockly.ZoomControls.prototype.ZOOM_IN_PATH_="zoom-in.svg",Blockly.ZoomControls.prototype.ZOOM_OUT_PATH_="zoom-out.svg",Blockly.ZoomControls.prototype.ZOOM_RESET_PATH_="zoom-reset.svg",Blockly.ZoomControls.prototype.WIDTH_=36,Blockly.ZoomControls.prototype.HEIGHT_=124,Blockly.ZoomControls.prototype.MARGIN_BETWEEN_=8,Blockly.ZoomControls.prototype.MARGIN_BOTTOM_=12,Blockly.ZoomControls.prototype.MARGIN_SIDE_=12,Blockly.ZoomControls.prototype.svgGroup_=null,Blockly.ZoomControls.prototype.left_=0,Blockly.ZoomControls.prototype.top_=0,Blockly.ZoomControls.prototype.createDom=function(){var t=this.workspace_;this.svgGroup_=Blockly.utils.createSvgElement("g",{class:"blocklyZoom"},null);var e=Blockly.utils.createSvgElement("image",{width:this.WIDTH_,height:this.WIDTH_,y:0},this.svgGroup_);e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t.options.pathToMedia+this.ZOOM_IN_PATH_);var o=Blockly.utils.createSvgElement("image",{width:this.WIDTH_,height:this.WIDTH_,y:1*this.WIDTH_+1*this.MARGIN_BETWEEN_},this.svgGroup_);o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t.options.pathToMedia+this.ZOOM_OUT_PATH_);var n=Blockly.utils.createSvgElement("image",{width:this.WIDTH_,height:this.WIDTH_,y:2*this.WIDTH_+2*this.MARGIN_BETWEEN_},this.svgGroup_);return n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t.options.pathToMedia+this.ZOOM_RESET_PATH_),Blockly.bindEventWithChecks_(n,"mousedown",null,function(e){t.markFocused(),t.setScale(t.options.zoomOptions.startScale),t.scrollCenter(),Blockly.Touch.clearTouchIdentifier(),e.stopPropagation(),e.preventDefault()}),Blockly.bindEventWithChecks_(e,"mousedown",null,function(e){t.markFocused(),t.zoomCenter(1),Blockly.Touch.clearTouchIdentifier(),e.stopPropagation(),e.preventDefault()}),Blockly.bindEventWithChecks_(o,"mousedown",null,function(e){t.markFocused(),t.zoomCenter(-1),Blockly.Touch.clearTouchIdentifier(),e.stopPropagation(),e.preventDefault()}),this.svgGroup_},Blockly.ZoomControls.prototype.init=function(t){return this.bottom_=this.MARGIN_BOTTOM_+t,this.bottom_+this.HEIGHT_},Blockly.ZoomControls.prototype.dispose=function(){this.svgGroup_&&(goog.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.workspace_=null},Blockly.ZoomControls.prototype.position=function(){var t=this.workspace_.getMetrics();t&&(this.workspace_.RTL?(this.left_=this.MARGIN_SIDE_+Blockly.Scrollbar.scrollbarThickness,t.toolboxPosition==Blockly.TOOLBOX_AT_LEFT&&(this.left_+=t.flyoutWidth,this.workspace_.toolbox_&&(this.left_+=t.absoluteLeft))):(this.left_=t.viewWidth+t.absoluteLeft-this.WIDTH_-this.MARGIN_SIDE_-Blockly.Scrollbar.scrollbarThickness,t.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT&&(this.left_-=t.flyoutWidth)),this.top_=t.viewHeight+t.absoluteTop-this.HEIGHT_-this.bottom_,t.toolboxPosition==Blockly.TOOLBOX_AT_BOTTOM&&(this.top_-=t.flyoutHeight),this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")"))},Blockly.WorkspaceSvg=function(t,e,o){Blockly.WorkspaceSvg.superClass_.constructor.call(this,t),this.getMetrics=t.getMetrics||Blockly.WorkspaceSvg.getTopLevelWorkspaceMetrics_,this.setMetrics=t.setMetrics||Blockly.WorkspaceSvg.setTopLevelWorkspaceMetrics_,Blockly.ConnectionDB.init(this),e&&(this.blockDragSurface_=e),o&&(this.workspaceDragSurface_=o),this.useWorkspaceDragSurface_=this.workspaceDragSurface_&&Blockly.utils.is3dSupported(),this.highlightedBlocks_=[],this.audioManager_=new Blockly.WorkspaceAudio(t.parentWorkspace),this.grid_=this.options.gridPattern?new Blockly.Grid(t.gridPattern,t.gridOptions):null,this.registerToolboxCategoryCallback(Blockly.VARIABLE_CATEGORY_NAME,Blockly.DataCategory),this.registerToolboxCategoryCallback(Blockly.PROCEDURE_CATEGORY_NAME,Blockly.Procedures.flyoutCategory)},goog.inherits(Blockly.WorkspaceSvg,Blockly.Workspace),Blockly.WorkspaceSvg.prototype.resizeHandlerWrapper_=null,Blockly.WorkspaceSvg.prototype.rendered=!0,Blockly.WorkspaceSvg.prototype.isFlyout=!1,Blockly.WorkspaceSvg.prototype.isMutator=!1,Blockly.WorkspaceSvg.prototype.resizesEnabled_=!0,Blockly.WorkspaceSvg.prototype.scrollX=0,Blockly.WorkspaceSvg.prototype.scrollY=0,Blockly.WorkspaceSvg.prototype.startScrollX=0,Blockly.WorkspaceSvg.prototype.startScrollY=0,Blockly.WorkspaceSvg.prototype.dragDeltaXY_=null,Blockly.WorkspaceSvg.prototype.scale=1,Blockly.WorkspaceSvg.prototype.trashcan=null,Blockly.WorkspaceSvg.prototype.scrollbar=null,Blockly.WorkspaceSvg.prototype.currentGesture_=null,Blockly.WorkspaceSvg.prototype.blockDragSurface_=null,Blockly.WorkspaceSvg.prototype.workspaceDragSurface_=null,Blockly.WorkspaceSvg.prototype.useWorkspaceDragSurface_=!1,Blockly.WorkspaceSvg.prototype.isDragSurfaceActive_=!1,Blockly.WorkspaceSvg.prototype.lastRecordedPageScroll_=null,Blockly.WorkspaceSvg.prototype.injectionDiv_=null,Blockly.WorkspaceSvg.prototype.flyoutButtonCallbacks_={},Blockly.WorkspaceSvg.prototype.toolboxCategoryCallbacks_={},Blockly.WorkspaceSvg.prototype.inverseScreenCTM_=null,Blockly.WorkspaceSvg.prototype.getInverseScreenCTM=function(){return this.inverseScreenCTM_},Blockly.WorkspaceSvg.prototype.updateInverseScreenCTM=function(){var t=this.getParentSvg().getScreenCTM();t&&(this.inverseScreenCTM_=t.inverse())},Blockly.WorkspaceSvg.prototype.getSvgXY=function(t){var e=0,o=0,n=1;(goog.dom.contains(this.getCanvas(),t)||goog.dom.contains(this.getBubbleCanvas(),t))&&(n=this.scale);do{var i=Blockly.utils.getRelativeXY(t);t!=this.getCanvas()&&t!=this.getBubbleCanvas()||(n=1),e+=i.x*n,o+=i.y*n,t=t.parentNode}while(t&&t!=this.getParentSvg());return new goog.math.Coordinate(e,o)},Blockly.WorkspaceSvg.prototype.getOriginOffsetInPixels=function(){return Blockly.utils.getInjectionDivXY_(this.svgBlockCanvas_)},Blockly.WorkspaceSvg.prototype.getInjectionDiv=function(){if(!this.injectionDiv_)for(var t=this.svgGroup_;t;){if(-1!=(" "+(t.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")){this.injectionDiv_=t;break}t=t.parentNode}return this.injectionDiv_},Blockly.WorkspaceSvg.prototype.setResizeHandlerWrapper=function(t){this.resizeHandlerWrapper_=t},Blockly.WorkspaceSvg.prototype.createDom=function(t){return this.svgGroup_=Blockly.utils.createSvgElement("g",{class:"blocklyWorkspace"},null),t&&(this.svgBackground_=Blockly.utils.createSvgElement("rect",{height:"100%",width:"100%",class:t},this.svgGroup_),"blocklyMainBackground"==t&&this.grid_&&(this.svgBackground_.style.fill="url(#"+this.grid_.getPatternId()+")")),this.svgBlockCanvas_=Blockly.utils.createSvgElement("g",{class:"blocklyBlockCanvas"},this.svgGroup_,this),this.svgBubbleCanvas_=Blockly.utils.createSvgElement("g",{class:"blocklyBubbleCanvas"},this.svgGroup_,this),t=Blockly.Scrollbar.scrollbarThickness,this.options.hasTrashcan&&(t=this.addTrashcan_(t)),this.options.zoomOptions&&this.options.zoomOptions.controls&&this.addZoomControls_(t),this.isFlyout||(Blockly.bindEventWithChecks_(this.svgGroup_,"mousedown",this,this.onMouseDown_),this.options.zoomOptions&&this.options.zoomOptions.wheel&&Blockly.bindEventWithChecks_(this.svgGroup_,"wheel",this,this.onMouseWheel_)),this.options.hasCategories&&(this.toolbox_=new Blockly.Toolbox(this)),this.grid_&&this.grid_.update(this.scale),this.recordDeleteAreas(),this.svgGroup_},Blockly.WorkspaceSvg.prototype.dispose=function(){this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),Blockly.WorkspaceSvg.superClass_.dispose.call(this),this.svgGroup_&&(goog.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.svgBubbleCanvas_=this.svgBlockCanvas_=null,this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout_&&(this.flyout_.dispose(),this.flyout_=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&(this.zoomControls_.dispose(),this.zoomControls_=null),this.audioManager_&&(this.audioManager_.dispose(),this.audioManager_=null),this.grid_&&(this.grid_.dispose(),this.grid_=null),this.toolboxCategoryCallbacks_&&(this.toolboxCategoryCallbacks_=null),this.flyoutButtonCallbacks_&&(this.flyoutButtonCallbacks_=null),this.options.parentWorkspace||goog.dom.removeNode(this.getParentSvg().parentNode),this.resizeHandlerWrapper_&&(Blockly.unbindEvent_(this.resizeHandlerWrapper_),this.resizeHandlerWrapper_=null)},Blockly.WorkspaceSvg.prototype.newBlock=function(t,e){return new Blockly.BlockSvg(this,t,e)},Blockly.WorkspaceSvg.prototype.addTrashcan_=function(t){this.trashcan=new Blockly.Trashcan(this);var e=this.trashcan.createDom();return this.svgGroup_.insertBefore(e,this.svgBlockCanvas_),this.trashcan.init(t)},Blockly.WorkspaceSvg.prototype.addZoomControls_=function(t){this.zoomControls_=new Blockly.ZoomControls(this);var e=this.zoomControls_.createDom();return this.svgGroup_.appendChild(e),this.zoomControls_.init(t)},Blockly.WorkspaceSvg.prototype.addFlyout_=function(t){var e={disabledPatternId:this.options.disabledPatternId,parentWorkspace:this,RTL:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,toolboxPosition:this.options.toolboxPosition};return this.flyout_=this.horizontalLayout?new Blockly.HorizontalFlyout(e):new Blockly.VerticalFlyout(e),this.flyout_.autoClose=!1,this.flyout_.createDom(t)},Blockly.WorkspaceSvg.prototype.getFlyout=function(){return this.flyout_?this.flyout_:this.toolbox_?this.toolbox_.flyout_:null},Blockly.WorkspaceSvg.prototype.updateScreenCalculations_=function(){this.updateInverseScreenCTM(),this.recordDeleteAreas()},Blockly.WorkspaceSvg.prototype.resizeContents=function(){this.resizesEnabled_&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())},Blockly.WorkspaceSvg.prototype.resize=function(){this.toolbox_&&this.toolbox_.position(),this.flyout_&&this.flyout_.position(),this.trashcan&&this.trashcan.position(),this.zoomControls_&&this.zoomControls_.position(),this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations_()},Blockly.WorkspaceSvg.prototype.updateScreenCalculationsIfScrolled=function(){var t=goog.dom.getDocumentScroll();goog.math.Coordinate.equals(this.lastRecordedPageScroll_,t)||(this.lastRecordedPageScroll_=t,this.updateScreenCalculations_())},Blockly.WorkspaceSvg.prototype.getCanvas=function(){return this.svgBlockCanvas_},Blockly.WorkspaceSvg.prototype.getBubbleCanvas=function(){return this.svgBubbleCanvas_},Blockly.WorkspaceSvg.prototype.getParentSvg=function(){if(this.cachedParentSvg_)return this.cachedParentSvg_;for(var t=this.svgGroup_;t;){if("svg"==t.tagName)return this.cachedParentSvg_=t;t=t.parentNode}return null},Blockly.WorkspaceSvg.prototype.translate=function(t,e){if(this.useWorkspaceDragSurface_&&this.isDragSurfaceActive_)this.workspaceDragSurface_.translateSurface(t,e);else{var o="translate("+t+","+e+") scale("+this.scale+")";this.svgBlockCanvas_.setAttribute("transform",o),this.svgBubbleCanvas_.setAttribute("transform",o)}this.blockDragSurface_&&this.blockDragSurface_.translateAndScaleGroup(t,e,this.scale)},Blockly.WorkspaceSvg.prototype.resetDragSurface=function(){if(this.useWorkspaceDragSurface_){this.isDragSurfaceActive_=!1;var t=this.workspaceDragSurface_.getSurfaceTranslation();this.workspaceDragSurface_.clearAndHide(this.svgGroup_),t="translate("+t.x+","+t.y+") scale("+this.scale+")",this.svgBlockCanvas_.setAttribute("transform",t),this.svgBubbleCanvas_.setAttribute("transform",t)}},Blockly.WorkspaceSvg.prototype.setupDragSurface=function(){if(this.useWorkspaceDragSurface_&&!this.isDragSurfaceActive_){this.isDragSurfaceActive_=!0;var t=this.svgBlockCanvas_.previousSibling,e=this.getParentSvg().getAttribute("width"),o=this.getParentSvg().getAttribute("height"),n=Blockly.utils.getRelativeXY(this.svgBlockCanvas_);this.workspaceDragSurface_.setContentsAndShow(this.svgBlockCanvas_,this.svgBubbleCanvas_,t,e,o,this.scale),this.workspaceDragSurface_.translateSurface(n.x,n.y)}},Blockly.WorkspaceSvg.prototype.getWidth=function(){var t=this.getMetrics();return t?t.viewWidth/this.scale:0},Blockly.WorkspaceSvg.prototype.setVisible=function(t){this.scrollbar&&this.scrollbar.setContainerVisible(t),this.getFlyout()&&this.getFlyout().setContainerVisible(t),this.getParentSvg().style.display=t?"block":"none",this.toolbox_&&(this.toolbox_.HtmlDiv.style.display=t?"block":"none"),t?(this.render(),this.resize()):(Blockly.hideChaff(!0),Blockly.DropDownDiv.hideWithoutAnimation())},Blockly.WorkspaceSvg.prototype.render=function(){for(var t=this.getAllBlocks(),e=t.length-1;0<=e;e--)t[e].render(!1)},Blockly.WorkspaceSvg.prototype.traceOn=function(){console.warn("Deprecated call to traceOn, delete this.")},Blockly.WorkspaceSvg.prototype.highlightBlock=function(t,e){if(void 0===e){for(var o,n=0;o=this.highlightedBlocks_[n];n++)o.setHighlighted(!1);this.highlightedBlocks_.length=0}(o=t?this.getBlockById(t):null)&&((n=void 0===e||e)?-1==this.highlightedBlocks_.indexOf(o)&&this.highlightedBlocks_.push(o):goog.array.remove(this.highlightedBlocks_,o),o.setHighlighted(n))},Blockly.WorkspaceSvg.prototype.glowBlock=function(t,e){var o=null;if(t&&!(o=this.getBlockById(t)))throw"Tried to glow block that does not exist.";o.setGlowBlock(e)},Blockly.WorkspaceSvg.prototype.glowStack=function(t,e){var o=null;if(t&&!(o=this.getBlockById(t)))throw"Tried to glow stack on block that does not exist.";o.setGlowStack(e)},Blockly.WorkspaceSvg.prototype.reportValue=function(t,e){var o=this.getBlockById(t);if(!o)throw"Tried to report value on block that does not exist.";Blockly.DropDownDiv.hideWithoutAnimation(),Blockly.DropDownDiv.clearContent();var n=Blockly.DropDownDiv.getContentDiv(),i=goog.dom.createElement("div");i.setAttribute("class","valueReportBox"),i.innerHTML=Blockly.utils.encodeEntities(e),n.appendChild(i),Blockly.DropDownDiv.setColour(Blockly.Colours.valueReportBackground,Blockly.Colours.valueReportBorder),Blockly.DropDownDiv.showPositionedByBlock(this,o)},Blockly.WorkspaceSvg.prototype.paste=function(t){if(this.rendered){this.currentGesture_&&this.currentGesture_.cancel(),Blockly.Events.disable();try{var e=Blockly.Xml.domToBlock(t,this);Blockly.utils.changeObscuredShadowIds(e);for(var o=e.getDescendants(),n=o.length-1;0<=n;n--){var i=o[n];(goog.userAgent.IE||goog.userAgent.EDGE)&&i.render(!1)}var r=parseInt(t.getAttribute("x"),10),s=parseInt(t.getAttribute("y"),10);if(!isNaN(r)&&!isNaN(s)){this.RTL&&(r=-r);do{var a=!1,l=this.getAllBlocks();n=0;for(var c;c=l[n];n++){var u=c.getRelativeToSurfaceXY();if(1>=Math.abs(r-u.x)&&1>=Math.abs(s-u.y)){a=!0;break}}if(!a){var h=e.getConnections_(!1);n=0;for(var g;g=h[n];n++)if(g.closest(Blockly.SNAP_RADIUS,new goog.math.Coordinate(r,s)).connection){a=!0;break}}a&&(r=this.RTL?r-Blockly.SNAP_RADIUS:r+Blockly.SNAP_RADIUS,s+=2*Blockly.SNAP_RADIUS)}while(a);e.moveBy(r,s)}}finally{Blockly.Events.enable()}Blockly.Events.isEnabled()&&!e.isShadow()&&Blockly.Events.fire(new Blockly.Events.BlockCreate(e)),e.select()}},Blockly.WorkspaceSvg.prototype.refreshToolboxSelection_=function(){this.toolbox_&&this.toolbox_.flyout_&&!this.currentGesture_&&this.toolbox_.refreshSelection()},Blockly.WorkspaceSvg.prototype.renameVariable=function(t,e){Blockly.WorkspaceSvg.superClass_.renameVariable.call(this,t,e),this.refreshToolboxSelection_()},Blockly.WorkspaceSvg.prototype.renameVariableById=function(t,e){Blockly.WorkspaceSvg.superClass_.renameVariableById.call(this,t,e),this.refreshToolboxSelection_()},Blockly.WorkspaceSvg.prototype.deleteVariable=function(t){Blockly.WorkspaceSvg.superClass_.deleteVariable.call(this,t),this.refreshToolboxSelection_()},Blockly.WorkspaceSvg.prototype.deleteVariableById=function(t){Blockly.WorkspaceSvg.superClass_.deleteVariableById.call(this,t),this.refreshToolboxSelection_()},Blockly.WorkspaceSvg.prototype.createVariable=function(t,e,o){return t=Blockly.WorkspaceSvg.superClass_.createVariable.call(this,t,e,o),this.refreshToolboxSelection_(),t},Blockly.WorkspaceSvg.prototype.recordDeleteAreas=function(){this.deleteAreaTrash_=this.trashcan?this.trashcan.getClientRect():null,this.deleteAreaToolbox_=this.flyout_?this.flyout_.getClientRect():this.toolbox_?this.toolbox_.getClientRect():null},Blockly.WorkspaceSvg.prototype.isDeleteArea=function(t){return t=new goog.math.Coordinate(t.clientX,t.clientY),this.deleteAreaTrash_&&this.deleteAreaTrash_.contains(t)?Blockly.DELETE_AREA_TRASH:this.deleteAreaToolbox_&&this.deleteAreaToolbox_.contains(t)?Blockly.DELETE_AREA_TOOLBOX:Blockly.DELETE_AREA_NONE},Blockly.WorkspaceSvg.prototype.onMouseDown_=function(t){var e=this.getGesture(t);e&&e.handleWsStart(t,this)},Blockly.WorkspaceSvg.prototype.startDrag=function(t,e){var o=Blockly.utils.mouseToSvg(t,this.getParentSvg(),this.getInverseScreenCTM());o.x/=this.scale,o.y/=this.scale,this.dragDeltaXY_=goog.math.Coordinate.difference(e,o)},Blockly.WorkspaceSvg.prototype.moveDrag=function(t){return t=Blockly.utils.mouseToSvg(t,this.getParentSvg(),this.getInverseScreenCTM()),t.x/=this.scale,t.y/=this.scale,goog.math.Coordinate.sum(this.dragDeltaXY_,t)},Blockly.WorkspaceSvg.prototype.isDragging=function(){return this.currentGesture_&&this.currentGesture_.isDragging()},Blockly.WorkspaceSvg.prototype.isDraggable=function(){return!!this.scrollbar},Blockly.WorkspaceSvg.prototype.onMouseWheel_=function(t){if(this.currentGesture_&&this.currentGesture_.cancel(),t.ctrlKey){var e=-t.deltaY/50,o=Blockly.utils.mouseToSvg(t,this.getParentSvg(),this.getInverseScreenCTM());this.zoom(o.x,o.y,e)}else Blockly.WidgetDiv.hide(!0),Blockly.DropDownDiv.hideWithoutAnimation(),e=this.scrollX-t.deltaX,o=this.scrollY-t.deltaY,this.startDragMetrics=this.getMetrics(),this.scroll(e,o);t.preventDefault()},Blockly.WorkspaceSvg.prototype.getBlocksBoundingBox=function(){var t=this.getTopBlocks(!1);if(!t.length)return{x:0,y:0,width:0,height:0};for(var e=t[0].getBoundingRectangle(),o=1;o<t.length;o++){var n=t[o].getBoundingRectangle();n.topLeft.x<e.topLeft.x&&(e.topLeft.x=n.topLeft.x),n.bottomRight.x>e.bottomRight.x&&(e.bottomRight.x=n.bottomRight.x),n.topLeft.y<e.topLeft.y&&(e.topLeft.y=n.topLeft.y),n.bottomRight.y>e.bottomRight.y&&(e.bottomRight.y=n.bottomRight.y)}return{x:e.topLeft.x,y:e.topLeft.y,width:e.bottomRight.x-e.topLeft.x,height:e.bottomRight.y-e.topLeft.y}},Blockly.WorkspaceSvg.prototype.cleanUp=function(){Blockly.Events.setGroup(!0);for(var t,e=this.getTopBlocks(!0),o=0,n=0;t=e[n];n++){var i=t.getRelativeToSurfaceXY();t.moveBy(-i.x,o-i.y),t.snapToGrid(),o=t.getRelativeToSurfaceXY().y+t.getHeightWidth().height+Blockly.BlockSvg.MIN_BLOCK_Y}Blockly.Events.setGroup(!1),this.resizeContents()},Blockly.WorkspaceSvg.prototype.showContextMenu_=function(t){function e(t){if(t.isDeletable())g=g.concat(t.getDescendants());else{t=t.getChildren();for(var o=0;o<t.length;o++)e(t[o])}}function o(){Blockly.Events.setGroup(r);var t=g.shift();t&&(t.workspace?(t.dispose(!1,!0),setTimeout(o,10)):o()),Blockly.Events.setGroup(!1)}if(!this.options.readOnly&&!this.isFlyout){var n=[],i=this.getTopBlocks(!0),r=Blockly.utils.genUid(),s=this,a={};if(a.text=Blockly.Msg.UNDO,a.enabled=0<this.undoStack_.length,a.callback=this.undo.bind(this,!1),n.push(a),a={},a.text=Blockly.Msg.REDO,a.enabled=0<this.redoStack_.length,a.callback=this.undo.bind(this,!0),n.push(a),this.scrollbar&&(a={},a.text=Blockly.Msg.CLEAN_UP,a.enabled=1<i.length,a.callback=this.cleanUp.bind(this),n.push(a)),this.options.collapse){for(var l=a=!1,c=0;c<i.length;c++)for(var u=i[c];u;)u.isCollapsed()?a=!0:l=!0,u=u.getNextBlock();var h=function(t){for(var e=0,o=0;o<i.length;o++)for(var n=i[o];n;)setTimeout(n.setCollapsed.bind(n,t),e),n=n.getNextBlock(),e+=10};l={enabled:l},l.text=Blockly.Msg.COLLAPSE_ALL,l.callback=function(){h(!0)},n.push(l),a={enabled:a},a.text=Blockly.Msg.EXPAND_ALL,a.callback=function(){h(!1)},n.push(a)}var g=[];for(c=0;c<i.length;c++)e(i[c]);var p=0;for(c=0;c<g.length;c++)g[c].isShadow()||p++;a={text:1==p?Blockly.Msg.DELETE_BLOCK:Blockly.Msg.DELETE_X_BLOCKS.replace("%1",String(p)),enabled:0<p,callback:function(){s.currentGesture_&&s.currentGesture_.cancel(),2>g.length?o():Blockly.confirm(Blockly.Msg.DELETE_ALL_BLOCKS.replace("%1",String(p)),function(t){t&&o()})}},n.push(a),Blockly.ContextMenu.show(t,n,this.RTL)}},Blockly.WorkspaceSvg.prototype.updateToolbox=function(t){if(t=Blockly.Options.parseToolboxTree(t)){if(!this.options.languageTree)throw"Existing toolbox is null.  Can't create new toolbox.";if(t.getElementsByTagName("category").length){if(!this.toolbox_)throw"Existing toolbox has no categories.  Can't change mode.";this.options.languageTree=t,this.toolbox_.populate_(t),this.toolbox_.position()}else{if(!this.flyout_)throw"Existing toolbox has categories.  Can't change mode.";this.options.languageTree=t,this.flyout_.show(t.childNodes)}}else if(this.options.languageTree)throw"Can't nullify an existing toolbox."},Blockly.WorkspaceSvg.prototype.markFocused=function(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(Blockly.mainWorkspace=this,this.setBrowserFocus())},Blockly.WorkspaceSvg.prototype.setBrowserFocus=function(){document.activeElement&&document.activeElement.blur();try{this.getParentSvg().focus()}catch(t){try{this.getParentSvg().parentNode.setActive()}catch(t){this.getParentSvg().parentNode.focus()}}},Blockly.WorkspaceSvg.prototype.zoom=function(t,e,o){var n=this.options.zoomOptions.scaleSpeed,i=this.getMetrics(),r=this.getParentSvg().createSVGPoint();r.x=t,r.y=e,r=r.matrixTransform(this.getCanvas().getCTM().inverse()),t=r.x,e=r.y,r=this.getCanvas(),n=Math.pow(n,o),o=this.scale*n,o>this.options.zoomOptions.maxScale?n=this.options.zoomOptions.maxScale/this.scale:o<this.options.zoomOptions.minScale&&(n=this.options.zoomOptions.minScale/this.scale),this.scale!=o&&(this.scrollbar&&(t=r.getCTM().translate(t*(1-n),e*(1-n)).scale(n),this.scrollX=t.e-i.absoluteLeft,this.scrollY=t.f-i.absoluteTop),this.setScale(o),Blockly.WidgetDiv.hide(!0),Blockly.DropDownDiv.hideWithoutAnimation())},Blockly.WorkspaceSvg.prototype.zoomCenter=function(t){var e=this.getMetrics();this.zoom(e.viewWidth/2,e.viewHeight/2,t)},Blockly.WorkspaceSvg.prototype.zoomToFit=function(){var t=this.getMetrics(),e=this.getBlocksBoundingBox(),o=e.width;if(e=e.height,o){var n=t.viewWidth,i=t.viewHeight;this.flyout_&&(n-=this.flyout_.width_),this.scrollbar||(o+=t.contentLeft,e+=t.contentTop),this.setScale(Math.min(n/o,i/e)),this.scrollCenter()}},Blockly.WorkspaceSvg.prototype.scrollCenter=function(){if(this.scrollbar){Blockly.WidgetDiv.hide(!0),Blockly.DropDownDiv.hideWithoutAnimation(),Blockly.hideChaff(!1);var t=this.getMetrics(),e=(t.contentWidth-t.viewWidth)/2;this.flyout_&&(e-=this.flyout_.width_/2),this.scrollbar.set(e,(t.contentHeight-t.viewHeight)/2)}},Blockly.WorkspaceSvg.prototype.setScale=function(t){this.options.zoomOptions.maxScale&&t>this.options.zoomOptions.maxScale?t=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&t<this.options.zoomOptions.minScale&&(t=this.options.zoomOptions.minScale),this.scale=t,this.grid_&&this.grid_.update(this.scale),this.scrollbar?this.scrollbar.resize():this.translate(this.scrollX,this.scrollY),Blockly.hideChaff(!1),this.flyout_&&this.flyout_.reflow()},Blockly.WorkspaceSvg.prototype.scroll=function(t,e){var o=this.startDragMetrics;t=Math.min(t,-o.contentLeft),e=Math.min(e,-o.contentTop),t=Math.max(t,o.viewWidth-o.contentLeft-o.contentWidth),e=Math.max(e,o.viewHeight-o.contentTop-o.contentHeight),Blockly.WidgetDiv.hide(!0),Blockly.DropDownDiv.hideWithoutAnimation(),this.scrollbar.set(-t-o.contentLeft,-e-o.contentTop)},Blockly.WorkspaceSvg.prototype.updateStackGlowScale_=function(){this.options.stackGlowBlur&&this.options.stackGlowBlur.setAttribute("stdDeviation",Blockly.STACK_GLOW_RADIUS/this.scale)},Blockly.WorkspaceSvg.getTopLevelWorkspaceMetrics_=function(){var t=Blockly.svgSize(this.getParentSvg());this.toolbox_&&(this.toolboxPosition==Blockly.TOOLBOX_AT_TOP||this.toolboxPosition==Blockly.TOOLBOX_AT_BOTTOM?t.height-=this.toolbox_.getHeight():this.toolboxPosition!=Blockly.TOOLBOX_AT_LEFT&&this.toolboxPosition!=Blockly.TOOLBOX_AT_RIGHT||(t.width-=this.toolbox_.getWidth()));var e=Blockly.Flyout.prototype.CORNER_RADIUS-1,o=t.width-e,n=t.height-e,i=this.getBlocksBoundingBox(),r=i.width*this.scale,s=i.height*this.scale,a=i.x*this.scale,l=i.y*this.scale;return this.scrollbar?(e=Math.min(a-o/2,a+r-o),r=Math.max(a+r+o/2,a+o),o=Math.min(l-n/2,l+s-n),n=Math.max(l+s+n/2,l+n)):(e=i.x,r=e+i.width,o=i.y,n=o+i.height),i=0,this.toolbox_&&this.toolboxPosition==Blockly.TOOLBOX_AT_LEFT&&(i=this.toolbox_.getWidth()),s=0,this.toolbox_&&this.toolboxPosition==Blockly.TOOLBOX_AT_TOP&&(s=this.toolbox_.getHeight()),{viewHeight:t.height,viewWidth:t.width,contentHeight:n-o,contentWidth:r-e,viewTop:-this.scrollY,viewLeft:-this.scrollX,contentTop:o,contentLeft:e,absoluteTop:s,absoluteLeft:i,toolboxWidth:this.toolbox_?this.toolbox_.getWidth():0,toolboxHeight:this.toolbox_?this.toolbox_.getHeight():0,flyoutWidth:this.flyout_?this.flyout_.getWidth():0,flyoutHeight:this.flyout_?this.flyout_.getHeight():0,toolboxPosition:this.toolboxPosition}},Blockly.WorkspaceSvg.setTopLevelWorkspaceMetrics_=function(t){if(!this.scrollbar)throw"Attempt to set top level workspace scroll without scrollbars.";var e=this.getMetrics();goog.isNumber(t.x)&&(this.scrollX=-e.contentWidth*t.x-e.contentLeft),goog.isNumber(t.y)&&(this.scrollY=-e.contentHeight*t.y-e.contentTop),t=this.scrollX+e.absoluteLeft,e=this.scrollY+e.absoluteTop,this.translate(t,e),this.grid_&&this.grid_.moveTo(t,e)},Blockly.WorkspaceSvg.prototype.setResizesEnabled=function(t){var e=!this.resizesEnabled_&&t;this.resizesEnabled_=t,e&&this.resizeContents()},Blockly.WorkspaceSvg.prototype.clear=function(){this.setResizesEnabled(!1),Blockly.WorkspaceSvg.superClass_.clear.call(this),this.setResizesEnabled(!0)},Blockly.WorkspaceSvg.prototype.registerButtonCallback=function(t,e){goog.asserts.assert(goog.isFunction(e),"Button callbacks must be functions."),this.flyoutButtonCallbacks_[t]=e},Blockly.WorkspaceSvg.prototype.getButtonCallback=function(t){return(t=this.flyoutButtonCallbacks_[t])?t:null},Blockly.WorkspaceSvg.prototype.removeButtonCallback=function(t){this.flyoutButtonCallbacks_[t]=null},Blockly.WorkspaceSvg.prototype.registerToolboxCategoryCallback=function(t,e){goog.asserts.assert(goog.isFunction(e),"Toolbox category callbacks must be functions."),this.toolboxCategoryCallbacks_[t]=e},Blockly.WorkspaceSvg.prototype.getToolboxCategoryCallback=function(t){return(t=this.toolboxCategoryCallbacks_[t])?t:null},Blockly.WorkspaceSvg.prototype.removeToolboxCategoryCallback=function(t){this.toolboxCategoryCallbacks_[t]=null},Blockly.WorkspaceSvg.prototype.getGesture=function(t){var e="mousedown"==t.type||"touchstart"==t.type,o=this.currentGesture_;return o?e&&o.hasStarted()?(console.warn("tried to start the same gesture twice"),o.cancel(),null):o:e?this.currentGesture_=new Blockly.Gesture(t,this):null},Blockly.WorkspaceSvg.prototype.clearGesture=function(){this.currentGesture_=null},Blockly.WorkspaceSvg.prototype.cancelCurrentGesture=function(){this.currentGesture_&&this.currentGesture_.cancel()},Blockly.WorkspaceSvg.prototype.startDragWithFakeEvent=function(t,e){Blockly.Touch.clearTouchIdentifier(),Blockly.Touch.checkTouchIdentifier(t),e.workspace.getGesture(t).forceStartBlockDrag(t,e)},Blockly.WorkspaceSvg.prototype.getAudioManager=function(){return this.audioManager_},Blockly.WorkspaceSvg.prototype.getGrid=function(){return this.grid_},Blockly.WorkspaceSvg.prototype.setVisible=Blockly.WorkspaceSvg.prototype.setVisible,Blockly.Mutator=function(t){Blockly.Mutator.superClass_.constructor.call(this,null),this.quarkNames_=t},goog.inherits(Blockly.Mutator,Blockly.Icon),Blockly.Mutator.prototype.workspaceWidth_=0,Blockly.Mutator.prototype.workspaceHeight_=0,Blockly.Mutator.prototype.drawIcon_=function(t){Blockly.utils.createSvgElement("rect",{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},t),Blockly.utils.createSvgElement("path",{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},t),Blockly.utils.createSvgElement("circle",{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},t)},Blockly.Mutator.prototype.iconClick_=function(t){this.block_.isEditable()&&Blockly.Icon.prototype.iconClick_.call(this,t)},Blockly.Mutator.prototype.createEditor_=function(){if(this.svgDialog_=Blockly.utils.createSvgElement("svg",{x:Blockly.Bubble.BORDER_WIDTH,y:Blockly.Bubble.BORDER_WIDTH},null),this.quarkNames_.length)for(var t,e=goog.dom.createDom("xml"),o=0;t=this.quarkNames_[o];o++)e.appendChild(goog.dom.createDom("block",{type:t}));else e=null;return e={languageTree:e,parentWorkspace:this.block_.workspace,pathToMedia:this.block_.workspace.options.pathToMedia,RTL:this.block_.RTL,toolboxPosition:this.block_.RTL?Blockly.TOOLBOX_AT_RIGHT:Blockly.TOOLBOX_AT_LEFT,horizontalLayout:!1,getMetrics:this.getFlyoutMetrics_.bind(this),setMetrics:null},this.workspace_=new Blockly.WorkspaceSvg(e,this.block_.workspace.dragSurface),this.workspace_.isMutator=!0,e=this.workspace_.addFlyout_("g"),o=this.workspace_.createDom("blocklyMutatorBackground"),o.insertBefore(e,this.workspace_.svgBlockCanvas_),this.svgDialog_.appendChild(o),this.svgDialog_},Blockly.Mutator.prototype.updateEditable=function(){this.block_.isInFlyout||(this.block_.isEditable()?this.iconGroup_&&Blockly.utils.removeClass(this.iconGroup_,"blocklyIconGroupReadonly"):(this.setVisible(!1),this.iconGroup_&&Blockly.utils.addClass(this.iconGroup_,"blocklyIconGroupReadonly"))),Blockly.Icon.prototype.updateEditable.call(this)},Blockly.Mutator.prototype.resizeBubble_=function(){var t=2*Blockly.Bubble.BORDER_WIDTH,e=this.workspace_.getCanvas().getBBox(),o=this.block_.RTL?-e.x:e.width+e.x;if(e=e.height+3*t,this.workspace_.flyout_){var n=this.workspace_.flyout_.getMetrics_();e=Math.max(e,n.contentHeight+20)}o+=3*t,(Math.abs(this.workspaceWidth_-o)>t||Math.abs(this.workspaceHeight_-e)>t)&&(this.workspaceWidth_=o,this.workspaceHeight_=e,this.bubble_.setBubbleSize(o+t,e+t),this.svgDialog_.setAttribute("width",this.workspaceWidth_),this.svgDialog_.setAttribute("height",this.workspaceHeight_)),this.block_.RTL&&(t="translate("+this.workspaceWidth_+",0)",this.workspace_.getCanvas().setAttribute("transform",t)),this.workspace_.resize()},Blockly.Mutator.prototype.setVisible=function(t){if(t!=this.isVisible())if(Blockly.Events.fire(new Blockly.Events.Ui(this.block_,"mutatorOpen",!t,t)),t){this.bubble_=new Blockly.Bubble(this.block_.workspace,this.createEditor_(),this.block_.svgPath_,this.iconXY_,null,null),(t=this.workspace_.options.languageTree)&&(this.workspace_.flyout_.init(this.workspace_),this.workspace_.flyout_.show(t.childNodes)),this.rootBlock_=this.block_.decompose(this.workspace_),t=this.rootBlock_.getDescendants();for(var e,o=0;e=t[o];o++)e.render();if(this.rootBlock_.setMovable(!1),this.rootBlock_.setDeletable(!1),this.workspace_.flyout_?(o=2*this.workspace_.flyout_.CORNER_RADIUS,t=this.workspace_.flyout_.width_+o):t=o=16,this.block_.RTL&&(t=-t),this.rootBlock_.moveBy(t,o),this.block_.saveConnections){var n=this;this.block_.saveConnections(this.rootBlock_),this.sourceListener_=function(){n.block_.saveConnections(n.rootBlock_)},this.block_.workspace.addChangeListener(this.sourceListener_)}this.resizeBubble_(),this.workspace_.addChangeListener(this.workspaceChanged_.bind(this)),this.updateColour()}else this.svgDialog_=null,this.workspace_.dispose(),this.rootBlock_=this.workspace_=null,this.bubble_.dispose(),this.bubble_=null,this.workspaceHeight_=this.workspaceWidth_=0,this.sourceListener_&&(this.block_.workspace.removeChangeListener(this.sourceListener_),this.sourceListener_=null)},Blockly.Mutator.prototype.workspaceChanged_=function(){var t;if(!this.workspace_.isDragging())for(var e=this.workspace_.getTopBlocks(!1),o=0;t=e[o];o++){var n=t.getRelativeToSurfaceXY(),i=t.getHeightWidth();20>n.y+i.height&&t.moveBy(0,20-i.height-n.y)}if(this.rootBlock_.workspace==this.workspace_){if(Blockly.Events.setGroup(!0),t=this.block_,e=(e=t.mutationToDom())&&Blockly.Xml.domToText(e),o=t.rendered,t.rendered=!1,t.compose(this.rootBlock_),t.rendered=o,t.initSvg(),o=(o=t.mutationToDom())&&Blockly.Xml.domToText(o),e!=o){Blockly.Events.fire(new Blockly.Events.BlockChange(t,"mutation",null,e,o));var r=Blockly.Events.getGroup();setTimeout(function(){Blockly.Events.setGroup(r),t.bumpNeighbours_(),Blockly.Events.setGroup(!1)},Blockly.BUMP_DELAY)}t.rendered&&t.render(),this.workspace_.isDragging()||this.resizeBubble_(),Blockly.Events.setGroup(!1)}},Blockly.Mutator.prototype.getFlyoutMetrics_=function(){return{viewHeight:this.workspaceHeight_,viewWidth:this.workspaceWidth_,absoluteTop:0,absoluteLeft:0}},Blockly.Mutator.prototype.dispose=function(){this.block_.mutator=null,Blockly.Icon.prototype.dispose.call(this)},Blockly.Mutator.reconnect=function(t,e,o){if(!t||!t.getSourceBlock().workspace)return!1;o=e.getInput(o).connection;var n=t.targetBlock();return!(n&&n!=e||o.targetConnection==t)&&(o.isConnected()&&o.disconnect(),o.connect(t),!0)},goog.global.Blockly||(goog.global.Blockly={}),goog.global.Blockly.Mutator||(goog.global.Blockly.Mutator={}),goog.global.Blockly.Mutator.reconnect=Blockly.Mutator.reconnect,Blockly.Extensions={},Blockly.Extensions.ALL_={},Blockly.Extensions.MUTATOR_PROPERTIES_=["domToMutation","mutationToDom","compose","decompose"],Blockly.Extensions.register=function(t,e){if(!goog.isString(t)||goog.string.isEmptyOrWhitespace(t))throw Error('Error: Invalid extension name "'+t+'"');if(Blockly.Extensions.ALL_[t])throw Error('Error: Extension "'+t+'" is already registered.');if(!goog.isFunction(e))throw Error('Error: Extension "'+t+'" must be a function');Blockly.Extensions.ALL_[t]=e};Blockly.Extensions.registerMixin=function(t,e){Blockly.Extensions.register(t,function(){this.mixin(e)})},Blockly.Extensions.registerMutator=function(t,e,o,n){var i='Error when registering mutator "'+t+'": ';Blockly.Extensions.checkHasFunction_(i,e,"domToMutation"),Blockly.Extensions.checkHasFunction_(i,e,"mutationToDom");var r=Blockly.Extensions.checkMutatorDialog_(e,i);if(o&&!goog.isFunction(o))throw Error('Extension "'+t+'" is not a function');Blockly.Extensions.register(t,function(){r&&this.setMutator(new Blockly.Mutator(n)),this.mixin(e),o&&o.apply(this)})},Blockly.Extensions.apply=function(t,e,o){var n,i=Blockly.Extensions.ALL_[t];if(!goog.isFunction(i))throw Error('Error: Extension "'+t+'" not found.');if(o?Blockly.Extensions.checkNoMutatorProperties_(t,e):n=Blockly.Extensions.getMutatorProperties_(e),i.apply(e),o)Blockly.Extensions.checkBlockHasMutatorProperties_(t,e,'Error after applying mutator "'+t+'": ');else if(!Blockly.Extensions.mutatorPropertiesMatch_(n,e))throw Error('Error when applying extension "'+t+'": mutation properties changed when applying a non-mutator extension.')},Blockly.Extensions.checkHasFunction_=function(t,e,o){if(!e.hasOwnProperty(o))throw Error(t+'missing required property "'+o+'"');if("function"!=typeof e[o])throw Error(t+'" required property "'+o+'" must be a function')},Blockly.Extensions.checkNoMutatorProperties_=function(t,e){for(var o=0;o<Blockly.Extensions.MUTATOR_PROPERTIES_.length;o++){var n=Blockly.Extensions.MUTATOR_PROPERTIES_[o];if(e.hasOwnProperty(n))throw Error('Error: tried to apply mutation "'+t+'" to a block that already has a "'+n+'" function.  Block id: '+e.id)}},Blockly.Extensions.checkMutatorDialog_=function(t,e){var o=t.hasOwnProperty("compose"),n=t.hasOwnProperty("decompose");if(o&&n){if("function"!=typeof t.compose)throw Error(e+"compose must be a function.");if("function"!=typeof t.decompose)throw Error(e+"decompose must be a function.");return!0}if(o||n)throw Error(e+'Must have both or neither of "compose" and "decompose"');return!1},Blockly.Extensions.checkBlockHasMutatorProperties_=function(t,e){if(!e.hasOwnProperty("domToMutation"))throw Error(t+'Applying a mutator didn\'t add "domToMutation"');if(!e.hasOwnProperty("mutationToDom"))throw Error(t+'Applying a mutator didn\'t add "mutationToDom"');Blockly.Extensions.checkMutatorDialog_(e,t)},Blockly.Extensions.getMutatorProperties_=function(t){for(var e=[],o=0;o<Blockly.Extensions.MUTATOR_PROPERTIES_.length;o++)e.push(t[Blockly.Extensions.MUTATOR_PROPERTIES_[o]]);return e},Blockly.Extensions.mutatorPropertiesMatch_=function(t,e){var o=!0,n=Blockly.Extensions.getMutatorProperties_(e);if(n.length!=t.length)o=!1;else for(var i=0;i<n.length;i++)t[i]!=n[i]&&(o=!1);return o},Blockly.Extensions.buildTooltipForDropdown=function(t,e){var o=[];return document&&Blockly.utils.runAfterPageLoad(function(){for(var t in e)Blockly.utils.checkMessageReferences(e[t])}),function(){this.type&&-1===o.indexOf(this.type)&&(Blockly.Extensions.checkDropdownOptionsInTable_(this,t,e),o.push(this.type)),this.setTooltip(function(){var n=this.getFieldValue(t),i=e[n];return null==i?-1===o.indexOf(this.type)&&(n="No tooltip mapping for value "+n+" of field "+t,null!=this.type&&(n+=" of block type "+this.type),console.warn(n+".")):i=Blockly.utils.replaceMessageReferences(i),i}.bind(this))}},Blockly.Extensions.checkDropdownOptionsInTable_=function(t,e,o){var n=t.getField(e);if(!n.isOptionListDynamic()){n=n.getOptions();for(var i=0;i<n.length;++i){var r=n[i][1];null==o[r]&&console.warn("No tooltip mapping for value "+r+" of field "+e+" of block type "+t.type)}}},Blockly.Extensions.buildTooltipWithFieldValue=function(t,e){return document&&Blockly.utils.runAfterPageLoad(function(){Blockly.utils.checkMessageReferences(t)}),function(){this.setTooltip(function(){return Blockly.utils.replaceMessageReferences(t).replace("%1",this.getFieldValue(e))}.bind(this))}},Blockly.Extensions.extensionParentTooltip_=function(){this.tooltipWhenNotConnected_=this.tooltip,this.setTooltip(function(){var t=this.getParent();return t&&t.getInputsInline()&&t.tooltip||this.tooltipWhenNotConnected_}.bind(this))},Blockly.Extensions.register("parent_tooltip_when_inline",Blockly.Extensions.extensionParentTooltip_),Blockly.Field=function(t,e){this.size_=new goog.math.Size(Blockly.BlockSvg.FIELD_WIDTH,Blockly.BlockSvg.FIELD_HEIGHT),this.setValue(t),this.setValidator(e),this.maxDisplayLength=Blockly.BlockSvg.MAX_DISPLAY_LENGTH},Blockly.Field.cacheWidths_=null,Blockly.Field.cacheReference_=0,Blockly.Field.prototype.name=void 0,Blockly.Field.prototype.text_="",Blockly.Field.prototype.sourceBlock_=null,Blockly.Field.prototype.visible_=!0,Blockly.Field.prototype.argType_=null,Blockly.Field.prototype.validator_=null,Blockly.Field.NBSP="",Blockly.Field.prototype.EDITABLE=!0,Blockly.Field.prototype.setSourceBlock=function(t){goog.asserts.assert(!this.sourceBlock_,"Field already bound to a block."),this.sourceBlock_=t},Blockly.Field.prototype.init=function(){if(!this.fieldGroup_){this.fieldGroup_=Blockly.utils.createSvgElement("g",{},null),this.visible_||(this.fieldGroup_.style.display="none"),null!==this.getArgTypes()&&(this.sourceBlock_.isShadow()?this.sourceBlock_.svgGroup_.setAttribute("data-argument-type",this.getArgTypes()):this.fieldGroup_.setAttribute("data-argument-type",this.getArgTypes()));var t=this.getSize();this.textElement_=Blockly.utils.createSvgElement("text",{class:"blocklyText",x:this.sourceBlock_.RTL?-t.width/2:t.width/2,y:t.height/2+Blockly.BlockSvg.FIELD_TOP_PADDING,"dominant-baseline":"middle","text-anchor":"middle"},this.fieldGroup_),this.updateEditable(),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.render_(),this.size_.width=0,this.mouseDownWrapper_=Blockly.bindEventWithChecks_(this.getClickTarget_(),"mousedown",this,this.onMouseDown_)}},Blockly.Field.prototype.initModel=function(){},Blockly.Field.prototype.dispose=function(){this.mouseDownWrapper_&&(Blockly.unbindEvent_(this.mouseDownWrapper_),this.mouseDownWrapper_=null),this.sourceBlock_=null,goog.dom.removeNode(this.fieldGroup_),this.validator_=this.textElement_=this.fieldGroup_=null},Blockly.Field.prototype.updateEditable=function(){var t=this.fieldGroup_;this.EDITABLE&&t&&(this.sourceBlock_.isEditable()?(Blockly.utils.addClass(t,"blocklyEditableText"),Blockly.utils.removeClass(t,"blocklyNonEditableText"),this.fieldGroup_.style.cursor=this.CURSOR):(Blockly.utils.addClass(t,"blocklyNonEditableText"),Blockly.utils.removeClass(t,"blocklyEditableText"),this.fieldGroup_.style.cursor=""))},Blockly.Field.prototype.isCurrentlyEditable=function(){return this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()},Blockly.Field.prototype.isVisible=function(){return this.visible_},Blockly.Field.prototype.setVisible=function(t){if(this.visible_!=t){this.visible_=t;var e=this.getSvgRoot();e&&(e.style.display=t?"block":"none",this.render_())}},Blockly.Field.prototype.addArgType=function(t){null==this.argType_&&(this.argType_=[]),this.argType_.push(t)},Blockly.Field.prototype.getArgTypes=function(){return null===this.argType_||0===this.argType_.length?null:this.argType_.join(" ")},Blockly.Field.prototype.setValidator=function(t){this.validator_=t},Blockly.Field.prototype.getValidator=function(){return this.validator_},Blockly.Field.prototype.classValidator=function(t){return t},Blockly.Field.prototype.callValidator=function(t){var e=this.classValidator(t);if(null===e)return null;if(void 0!==e&&(t=e),e=this.getValidator()){if(null===(e=e.call(this,t)))return null;void 0!==e&&(t=e)}return t},Blockly.Field.prototype.getSvgRoot=function(){return this.fieldGroup_},Blockly.Field.prototype.render_=function(){if(this.visible_&&this.textElement_){goog.dom.removeChildren(this.textElement_);var t=document.createTextNode(this.getDisplayText_());if(this.textElement_.appendChild(t),this.updateWidth(),t=(this.size_.width-this.arrowWidth_)/2,this.sourceBlock_.RTL&&(t+=this.arrowWidth_),this.sourceBlock_.isShadow()&&!this.positionArrow){var e=Blockly.BlockSvg.FIELD_WIDTH/2;t=this.sourceBlock_.RTL?Math.min(this.size_.width-e,t):Math.max(e,t)}this.textElement_.setAttribute("x",t)}this.box_&&(this.box_.setAttribute("width",this.size_.width),this.box_.setAttribute("height",this.size_.height))},Blockly.Field.prototype.updateWidth=function(){var t=Blockly.Field.getCachedWidth(this.textElement_);this.EDITABLE&&(t+=Blockly.BlockSvg.EDITABLE_FIELD_PADDING),this.arrowWidth_=0,this.positionArrow&&(this.arrowWidth_=this.positionArrow(t),t+=this.arrowWidth_),this.box_&&(t+=2*Blockly.BlockSvg.BOX_FIELD_PADDING),this.size_.width=t},Blockly.Field.getCachedWidth=function(t){var e,o=t.textContent+"\n"+t.className.baseVal;if(Blockly.Field.cacheWidths_&&(e=Blockly.Field.cacheWidths_[o]))return e;try{e=t.getComputedTextLength()}catch(e){return 8*t.textContent.length}return Blockly.Field.cacheWidths_&&(Blockly.Field.cacheWidths_[o]=e),e},Blockly.Field.startCache=function(){Blockly.Field.cacheReference_++,Blockly.Field.cacheWidths_||(Blockly.Field.cacheWidths_={})},Blockly.Field.stopCache=function(){--Blockly.Field.cacheReference_||(Blockly.Field.cacheWidths_=null)},Blockly.Field.prototype.getSize=function(){return this.size_.width||this.render_(),this.size_},Blockly.Field.prototype.getScaledBBox_=function(){var t=this.getSize();return new goog.math.Size(t.width*this.sourceBlock_.workspace.scale,t.height*this.sourceBlock_.workspace.scale)},Blockly.Field.prototype.getDisplayText_=function(){var t=this.text_;return t?(t.length>this.maxDisplayLength&&(t=t.substring(0,this.maxDisplayLength-2)+""),t=t.replace(/\s/g,Blockly.Field.NBSP),this.sourceBlock_.RTL&&(t+=""),t):Blockly.Field.NBSP},Blockly.Field.prototype.getText=function(){return this.text_},Blockly.Field.prototype.setText=function(t){null!==t&&(t=String(t))!==this.text_&&(this.text_=t,this.size_.width=0,this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours_()))},Blockly.Field.prototype.updateTextNode_=function(){if(this.textElement_){var t=this.text_;t.length>this.maxDisplayLength?(t=t.substring(0,this.maxDisplayLength-2)+"",this.textElement_.setAttribute("class","blocklyText blocklyTextTruncated")):this.textElement_.setAttribute("class","blocklyText"),goog.dom.removeChildren(this.textElement_),t=t.replace(/\s/g,Blockly.Field.NBSP),this.sourceBlock_.RTL&&t&&(t+=""),t||(t=Blockly.Field.NBSP),t=document.createTextNode(t),this.textElement_.appendChild(t),this.size_.width=0}},Blockly.Field.prototype.getValue=function(){return this.getText()},Blockly.Field.prototype.setValue=function(t){if(null!==t){var e=this.getValue();e!=t&&(this.sourceBlock_&&Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,e,t)),this.setText(t))}},Blockly.Field.prototype.onMouseDown_=function(t){this.sourceBlock_&&this.sourceBlock_.workspace&&(t=this.sourceBlock_.workspace.getGesture(t))&&t.setStartField(this)},Blockly.Field.prototype.setTooltip=function(){},Blockly.Field.prototype.getClickTarget_=function(){for(var t,e=0,o=0;t=this.sourceBlock_.inputList[o];o++)e+=t.fieldRow.length;return 1>=e?this.sourceBlock_.getSvgRoot():this.getSvgRoot()},Blockly.Field.prototype.getAbsoluteXY_=function(){return goog.style.getPageOffset(this.getClickTarget_())},Blockly.FieldVariableGetter=function(t,e){Blockly.FieldVariableGetter.superClass_.constructor.call(this,t),this.name_=e},goog.inherits(Blockly.FieldVariableGetter,Blockly.Field),Blockly.FieldVariableGetter.prototype.EDITABLE=!0,Blockly.FieldVariableGetter.prototype.init=function(){this.fieldGroup_||(Blockly.FieldVariableGetter.superClass_.init.call(this),this.getValue()||this.setValue(Blockly.Variables.generateUniqueName(this.sourceBlock_.isInFlyout?this.sourceBlock_.workspace.targetWorkspace:this.sourceBlock_.workspace)),this.sourceBlock_.isInFlyout||this.sourceBlock_.workspace.createVariable(this.getValue()))},Blockly.FieldVariableGetter.prototype.showEditor_=function(){},Blockly.FieldVariableGetter.prototype.updateEditable=function(){},Blockly.FieldLabel=function(t,e){this.size_=new goog.math.Size(0,0),this.class_=e,this.setValue(t)},goog.inherits(Blockly.FieldLabel,Blockly.Field),Blockly.FieldLabel.prototype.EDITABLE=!1,Blockly.FieldLabel.prototype.init=function(){this.textElement_||(this.textElement_=Blockly.utils.createSvgElement("text",{class:"blocklyText",y:Blockly.BlockSvg.FIELD_TOP_PADDING,"text-anchor":"middle","dominant-baseline":"middle"},null),this.class_&&Blockly.utils.addClass(this.textElement_,this.class_),this.visible_||(this.textElement_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.textElement_),this.textElement_.tooltip=this.sourceBlock_,Blockly.Tooltip.bindMouseEvents(this.textElement_),this.render_())},Blockly.FieldLabel.prototype.dispose=function(){goog.dom.removeNode(this.textElement_),this.textElement_=null},Blockly.FieldLabel.prototype.getSvgRoot=function(){return this.textElement_},Blockly.FieldLabel.prototype.setTooltip=function(t){this.textElement_.tooltip=t},Blockly.Input=function(t,e,o,n){if(t!=Blockly.DUMMY_INPUT&&!e)throw"Value inputs and statement inputs must have non-empty name.";this.type=t,this.name=e,this.sourceBlock_=o,this.connection=n,this.fieldRow=[]},Blockly.Input.prototype.align=Blockly.ALIGN_LEFT,Blockly.Input.prototype.visible_=!0,Blockly.Input.prototype.appendField=function(t,e){return this.insertFieldAt(this.fieldRow.length,t,e),this},Blockly.Input.prototype.insertFieldAt=function(t,e,o){if(0>t||t>this.fieldRow.length)throw Error("index "+t+" out of bounds.");return e||o?(goog.isString(e)&&(e=new Blockly.FieldLabel(e)),e.setSourceBlock(this.sourceBlock_),this.sourceBlock_.rendered&&e.init(),e.name=o,e.prefixField&&(t=this.insertFieldAt(t,e.prefixField)),this.fieldRow.splice(t,0,e),++t,e.suffixField&&(t=this.insertFieldAt(t,e.suffixField)),this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours_()),t):this},Blockly.Input.prototype.removeField=function(t){for(var e,o=0;e=this.fieldRow[o];o++)if(e.name===t)return e.dispose(),this.fieldRow.splice(o,1),void(this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours_()));goog.asserts.fail('Field "%s" not found.',t)},Blockly.Input.prototype.isVisible=function(){return this.visible_},Blockly.Input.prototype.setVisible=function(t){var e=[];if(this.visible_==t)return e;for(var o,n=(this.visible_=t)?"block":"none",i=0;o=this.fieldRow[i];i++)o.setVisible(t);return this.connection&&(t?e=this.connection.unhideAll():this.connection.hideAll(),i=this.connection.targetBlock())&&(i.getSvgRoot().style.display=n,t||(i.rendered=!1)),e},Blockly.Input.prototype.setCheck=function(t){if(!this.connection)throw"This input does not have a connection.";return this.connection.setCheck(t),this},Blockly.Input.prototype.setAlign=function(t){return this.align=t,this.sourceBlock_.rendered&&this.sourceBlock_.render(),this},Blockly.Input.prototype.init=function(){if(this.sourceBlock_.workspace.rendered)for(var t=0;t<this.fieldRow.length;t++)this.fieldRow[t].init(this.sourceBlock_)},Blockly.Input.prototype.dispose=function(){for(var t,e=0;t=this.fieldRow[e];e++)t.dispose();this.connection&&this.connection.dispose(),this.sourceBlock_=null},Blockly.Warning=function(t){Blockly.Warning.superClass_.constructor.call(this,t),this.createIcon(),this.text_={}},goog.inherits(Blockly.Warning,Blockly.Icon),Blockly.Warning.prototype.collapseHidden=!1,Blockly.Warning.prototype.drawIcon_=function(t){Blockly.utils.createSvgElement("path",{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},t),Blockly.utils.createSvgElement("path",{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},t),Blockly.utils.createSvgElement("rect",{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},t)},Blockly.Warning.textToDom_=function(t){var e=Blockly.utils.createSvgElement("text",{class:"blocklyText blocklyBubbleText",y:Blockly.Bubble.BORDER_WIDTH},null);t=t.split("\n");for(var o=0;o<t.length;o++){var n=Blockly.utils.createSvgElement("tspan",{dy:"1em",x:Blockly.Bubble.BORDER_WIDTH},e),i=document.createTextNode(t[o]);n.appendChild(i)}return e},Blockly.Warning.prototype.setVisible=function(t){if(t!=this.isVisible())if(Blockly.Events.fire(new Blockly.Events.Ui(this.block_,"warningOpen",!t,t)),t){if(t=Blockly.Warning.textToDom_(this.getText()),this.bubble_=new Blockly.Bubble(this.block_.workspace,t,this.block_.svgPath_,this.iconXY_,null,null),this.block_.RTL)for(var e,o=t.getBBox().width,n=0;e=t.childNodes[n];n++)e.setAttribute("text-anchor","end"),e.setAttribute("x",o+Blockly.Bubble.BORDER_WIDTH);this.updateColour(),t=this.bubble_.getBubbleSize(),this.bubble_.setBubbleSize(t.width,t.height)}else this.bubble_.dispose(),this.body_=this.bubble_=null},Blockly.Warning.prototype.bodyFocus_=function(){this.bubble_.promote_()},Blockly.Warning.prototype.setText=function(t,e){this.text_[e]!=t&&(t?this.text_[e]=t:delete this.text_[e],this.isVisible()&&(this.setVisible(!1),this.setVisible(!0)))},Blockly.Warning.prototype.getText=function(){var t,e=[];for(t in this.text_)e.push(this.text_[t]);return e.join("\n")},Blockly.Warning.prototype.dispose=function(){this.block_.warning=null,Blockly.Icon.prototype.dispose.call(this)},Blockly.Block=function(t,e,o){var n=t&&t.getFlyout&&t.getFlyout()?t.getFlyout().getWorkspace():null;this.id=!o||t.getBlockById(o)||n&&n.getBlockById(o)?Blockly.utils.genUid():o,t.blockDB_[this.id]=this,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.inputsInline=!0,this.disabled=!1,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable_=this.movable_=this.deletable_=!0,this.checkboxInFlyout_=this.collapsed_=this.isShadow_=!1,this.category_=this.outputShape_=this.comment=null,this.xy_=new goog.math.Coordinate(0,0),this.workspace=t,this.isInFlyout=t.isFlyout,this.isInMutator=t.isMutator,this.RTL=t.RTL,this.isInsertionMarker_=!1,e&&(this.type=e,o=Blockly.Blocks[e],goog.asserts.assertObject(o,'Error: Unknown block type "%s".',e),goog.mixin(this,o)),t.addTopBlock(this),goog.isFunction(this.init)&&this.init(),this.inputsInlineDefault=this.inputsInline,Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.BlockCreate(this)),goog.isFunction(this.onchange)&&this.setOnChange(this.onchange)},Blockly.Block.prototype.data=null,Blockly.Block.prototype.colour_="#FF0000",Blockly.Block.prototype.colourSecondary_="#FF0000",Blockly.Block.prototype.colourTertiary_="#FF0000",Blockly.Block.prototype.dispose=function(t){if(this.workspace){this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.unplug(t),Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.BlockDelete(this)),Blockly.Events.disable();try{this.workspace&&(this.workspace.removeTopBlock(this),delete this.workspace.blockDB_[this.id],this.workspace=null),Blockly.selected==this&&(Blockly.selected=null);for(var e=this.childBlocks_.length-1;0<=e;e--)this.childBlocks_[e].dispose(!1);e=0;for(var o;o=this.inputList[e];e++)o.dispose();this.inputList.length=0;var n=this.getConnections_(!0);for(e=0;e<n.length;e++){var i=n[e];i.isConnected()&&i.disconnect(),n[e].dispose()}}finally{Blockly.Events.enable()}}},Blockly.Block.prototype.unplug=function(t){if(this.outputConnection)this.outputConnection.isConnected()&&this.outputConnection.disconnect();else if(this.previousConnection){var e=null;this.previousConnection.isConnected()&&(e=this.previousConnection.targetConnection,this.previousConnection.disconnect());var o=this.getNextBlock();t&&o&&(t=this.nextConnection.targetConnection,t.disconnect(),e&&e.checkType_(t)&&e.connect(t))}},Blockly.Block.prototype.getConnections_=function(){var t=[];this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection);for(var e,o=0;e=this.inputList[o];o++)e.connection&&t.push(e.connection);return t},Blockly.Block.prototype.lastConnectionInStack=function(){for(var t=this.nextConnection;t;){var e=t.targetBlock();if(!e)return t;t=e.nextConnection}return null},Blockly.Block.prototype.bumpNeighbours_=function(){console.warn("Not expected to reach this bumpNeighbours_ function. The BlockSvg function for bumpNeighbours_ was expected to be called instead.")},Blockly.Block.prototype.getParent=function(){return this.parentBlock_},Blockly.Block.prototype.getInputWithBlock=function(t){for(var e,o=0;e=this.inputList[o];o++)if(e.connection&&e.connection.targetBlock()==t)return e;return null},Blockly.Block.prototype.getInputWithConnection=function(t){for(var e,o=0;e=this.inputList[o];o++)if(e.connection==t)return e;return null},Blockly.Block.prototype.getSurroundParent=function(){var t=this;do{var e=t;if(!(t=t.getParent()))return null}while(t.getNextBlock()==e);return t},Blockly.Block.prototype.getNextBlock=function(){return this.nextConnection&&this.nextConnection.targetBlock()},Blockly.Block.prototype.getPreviousBlock=function(){return this.previousConnection&&this.previousConnection.targetBlock()},Blockly.Block.prototype.getFirstStatementConnection=function(){for(var t,e=0;t=this.inputList[e];e++)if(t.connection&&t.connection.type==Blockly.NEXT_STATEMENT)return t.connection;return null},Blockly.Block.prototype.getRootBlock=function(){var t=this;do{var e=t;t=e.parentBlock_}while(t);return e},Blockly.Block.prototype.getChildren=function(){return this.childBlocks_},Blockly.Block.prototype.setParent=function(t){if(t!=this.parentBlock_){if(this.parentBlock_){if(goog.array.remove(this.parentBlock_.childBlocks_,this),this.previousConnection&&this.previousConnection.isConnected())throw"Still connected to previous block.";if(this.outputConnection&&this.outputConnection.isConnected())throw"Still connected to parent block.";this.parentBlock_=null}else this.workspace.removeTopBlock(this);(this.parentBlock_=t)?t.childBlocks_.push(this):this.workspace.addTopBlock(this)}},Blockly.Block.prototype.getDescendants=function(t){for(var e,o=[this],n=0;e=this.childBlocks_[n];n++)t&&e.isShadow_||o.push.apply(o,e.getDescendants(t));return o},Blockly.Block.prototype.isDeletable=function(){return this.deletable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)},Blockly.Block.prototype.setDeletable=function(t){this.deletable_=t},Blockly.Block.prototype.isMovable=function(){return this.movable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)},Blockly.Block.prototype.setMovable=function(t){this.movable_=t},Blockly.Block.prototype.isShadow=function(){return this.isShadow_},Blockly.Block.prototype.setShadow=function(t){this.isShadow_=t},Blockly.Block.prototype.isInsertionMarker=function(){return this.isInsertionMarker_},Blockly.Block.prototype.setInsertionMarker=function(t){this.isInsertionMarker_!=t&&(this.isInsertionMarker_=t)&&(this.setColour(Blockly.Colours.insertionMarker),this.setOpacity(Blockly.Colours.insertionMarkerOpacity),Blockly.utils.addClass(this.svgGroup_,"blocklyInsertionMarker"))},Blockly.Block.prototype.isEditable=function(){return this.editable_&&!(this.workspace&&this.workspace.options.readOnly)},Blockly.Block.prototype.setEditable=function(t){this.editable_=t,t=0;for(var e;e=this.inputList[t];t++)for(var o,n=0;o=e.fieldRow[n];n++)o.updateEditable()},Blockly.Block.prototype.setConnectionsHidden=function(t){var e;if(!t&&this.isCollapsed())this.outputConnection&&this.outputConnection.setHidden(t),this.previousConnection&&this.previousConnection.setHidden(t),this.nextConnection&&(this.nextConnection.setHidden(t),(e=this.nextConnection.targetBlock())&&e.setConnectionsHidden(t));else for(var o=this.getConnections_(!0),n=0;e=o[n];n++)e.setHidden(t),e.isSuperior()&&(e=e.targetBlock())&&e.setConnectionsHidden(t)},Blockly.Block.prototype.getMatchingConnection=function(t,e){var o=this.getConnections_(!0),n=t.getConnections_(!0);if(o.length!=n.length)throw"Connection lists did not match in length.";for(var i=0;i<n.length;i++)if(n[i]==e)return o[i];return null},Blockly.Block.prototype.setHelpUrl=function(t){this.helpUrl=t},Blockly.Block.prototype.setTooltip=function(t){this.tooltip=t},Blockly.Block.prototype.getColour=function(){return this.colour_},Blockly.Block.prototype.getColourSecondary=function(){return this.colourSecondary_},Blockly.Block.prototype.getColourTertiary=function(){return this.colourTertiary_},Blockly.Block.prototype.makeColour_=function(t){var e=Number(t);if(isNaN(e)){if(goog.isString(t)&&t.match(/^#[0-9a-fA-F]{6}$/))return t;throw"Invalid colour: "+t}return Blockly.hueToRgb(e)},Blockly.Block.prototype.setColour=function(t,e,o){this.colour_=this.makeColour_(t),this.colourSecondary_=void 0!==e?this.makeColour_(e):goog.color.rgbArrayToHex(goog.color.darken(goog.color.hexToRgb(this.colour_),.1)),this.colourTertiary_=void 0!==o?this.makeColour_(o):goog.color.rgbArrayToHex(goog.color.darken(goog.color.hexToRgb(this.colour_),.2)),this.rendered&&this.updateColour()},Blockly.Block.prototype.setOnChange=function(t){if(t&&!goog.isFunction(t))throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),(this.onchange=t)&&(this.onchangeWrapper_=t.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_))},Blockly.Block.prototype.getField=function(t){for(var e,o=0;e=this.inputList[o];o++)for(var n,i=0;n=e.fieldRow[i];i++)if(n.name===t)return n;return null},Blockly.Block.prototype.getVars=function(){for(var t,e=[],o=0;t=this.inputList[o];o++)for(var n,i=0;n=t.fieldRow[i];i++)(n instanceof Blockly.FieldVariable||n instanceof Blockly.FieldVariableGetter)&&e.push(n.getValue());return e},Blockly.Block.prototype.renameVar=function(t,e){for(var o,n=0;o=this.inputList[n];n++)for(var i,r=0;i=o.fieldRow[r];r++)(i instanceof Blockly.FieldVariable||i instanceof Blockly.FieldVariableGetter)&&Blockly.Names.equals(t,i.getValue())&&i.setValue(e)},Blockly.Block.prototype.getFieldValue=function(t){return(t=this.getField(t))?t.getValue():null},Blockly.Block.prototype.setFieldValue=function(t,e){var o=this.getField(e);goog.asserts.assertObject(o,'Field "%s" not found.',e),o.setValue(t)},Blockly.Block.prototype.setPreviousStatement=function(t,e){t?(void 0===e&&(e=null),this.previousConnection||(goog.asserts.assert(!this.outputConnection,"Remove output connection prior to adding previous connection."),this.previousConnection=this.makeConnection_(Blockly.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(e)):this.previousConnection&&(goog.asserts.assert(!this.previousConnection.isConnected(),"Must disconnect previous statement before removing connection."),this.previousConnection.dispose(),this.previousConnection=null)},Blockly.Block.prototype.setNextStatement=function(t,e){t?(void 0===e&&(e=null),this.nextConnection||(this.nextConnection=this.makeConnection_(Blockly.NEXT_STATEMENT)),this.nextConnection.setCheck(e)):this.nextConnection&&(goog.asserts.assert(!this.nextConnection.isConnected(),"Must disconnect next statement before removing connection."),this.nextConnection.dispose(),this.nextConnection=null)},Blockly.Block.prototype.setOutput=function(t,e){t?(void 0===e&&(e=null),this.outputConnection||(goog.asserts.assert(!this.previousConnection,"Remove previous connection prior to adding output connection."),this.outputConnection=this.makeConnection_(Blockly.OUTPUT_VALUE)),this.outputConnection.setCheck(e)):this.outputConnection&&(goog.asserts.assert(!this.outputConnection.isConnected(),"Must disconnect output value before removing connection."),this.outputConnection.dispose(),this.outputConnection=null)},Blockly.Block.prototype.setInputsInline=function(t){this.inputsInline!=t&&(Blockly.Events.fire(new Blockly.Events.BlockChange(this,"inline",null,this.inputsInline,t)),this.inputsInline=t)},Blockly.Block.prototype.getInputsInline=function(){if(void 0!=this.inputsInline)return this.inputsInline;for(var t=1;t<this.inputList.length;t++)if(this.inputList[t-1].type==Blockly.DUMMY_INPUT&&this.inputList[t].type==Blockly.DUMMY_INPUT)return!1;for(t=1;t<this.inputList.length;t++)if(this.inputList[t-1].type==Blockly.INPUT_VALUE&&this.inputList[t].type==Blockly.DUMMY_INPUT)return!0;return!1},Blockly.Block.prototype.setDisabled=function(t){this.disabled!=t&&(Blockly.Events.fire(new Blockly.Events.BlockChange(this,"disabled",null,this.disabled,t)),this.disabled=t)},Blockly.Block.prototype.getInheritedDisabled=function(){for(var t=this.getSurroundParent();t;){if(t.disabled)return!0;t=t.getSurroundParent()}return!1},Blockly.Block.prototype.isCollapsed=function(){return this.collapsed_},Blockly.Block.prototype.setCollapsed=function(t){this.collapsed_!=t&&(Blockly.Events.fire(new Blockly.Events.BlockChange(this,"collapsed",null,this.collapsed_,t)),this.collapsed_=t)},Blockly.Block.prototype.toString=function(t,e){var o=[],n=e||"?";if(this.collapsed_)o.push(this.getInput("_TEMP_COLLAPSED_INPUT").fieldRow[0].text_);else for(var i,r=0;i=this.inputList[r];r++){for(var s,a=0;s=i.fieldRow[a];a++)s instanceof Blockly.FieldDropdown&&!s.getValue()?o.push(n):o.push(s.getText());i.connection&&((i=i.connection.targetBlock())?o.push(i.toString(void 0,e)):o.push(n))}return o=goog.string.trim(o.join(" "))||"???",t&&(o=goog.string.truncate(o,t)),o},Blockly.Block.prototype.appendValueInput=function(t){return this.appendInput_(Blockly.INPUT_VALUE,t)},Blockly.Block.prototype.appendStatementInput=function(t){return this.appendInput_(Blockly.NEXT_STATEMENT,t)},Blockly.Block.prototype.appendDummyInput=function(t){return this.appendInput_(Blockly.DUMMY_INPUT,t||"")},Blockly.Block.prototype.jsonInit=function(t){var e;for(goog.asserts.assert(void 0==t.output||void 0==t.previousStatement,"Must not have both an output and a previousStatement."),void 0!==t.colour&&this.setColourFromJson_(t),e=0;void 0!==t["message"+e];)this.interpolate_(t["message"+e],t["args"+e]||[],t["lastDummyAlign"+e]),e++;if(void 0!==t.inputsInline&&this.setInputsInline(t.inputsInline),void 0!==t.output&&this.setOutput(!0,t.output),void 0!==t.previousStatement&&this.setPreviousStatement(!0,t.previousStatement),void 0!==t.nextStatement&&this.setNextStatement(!0,t.nextStatement),void 0!==t.tooltip&&(e=t.tooltip,e=Blockly.utils.replaceMessageReferences(e),this.setTooltip(e)),void 0!==t.enableContextMenu&&(e=t.enableContextMenu,this.contextMenu=!!e),void 0!==t.helpUrl&&(e=t.helpUrl,e=Blockly.utils.replaceMessageReferences(e),this.setHelpUrl(e)),goog.isString(t.extensions)&&(console.warn("JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+t.type+"' block."),t.extensions=[t.extensions]),void 0!==t.mutator&&Blockly.Extensions.apply(t.mutator,this,!0),Array.isArray(t.extensions)){var o=t.extensions;for(e=0;e<o.length;++e)Blockly.Extensions.apply(o[e],this,!1)}void 0!==t.outputShape&&this.setOutputShape(t.outputShape),void 0!==t.checkboxInFlyout&&this.setCheckboxInFlyout(t.checkboxInFlyout),void 0!==t.category&&this.setCategory(t.category)},Blockly.Block.prototype.mixin=function(t,e){if(goog.isDef(e)&&!goog.isBoolean(e))throw Error("opt_disableCheck must be a boolean if provided");if(!e){var o,n=[];for(o in t)void 0!==this[o]&&n.push(o);if(n.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(n))}goog.mixin(this,t)},Blockly.Block.prototype.setColourFromRawValues_=function(t,e,o){t=goog.isString(t)?Blockly.utils.replaceMessageReferences(t):t,e=goog.isString(e)?Blockly.utils.replaceMessageReferences(e):e,o=goog.isString(o)?Blockly.utils.replaceMessageReferences(o):o,this.setColour(t,e,o)},Blockly.Block.prototype.setColourFromJson_=function(t){this.setColourFromRawValues_(t.colour,t.colourSecondary,t.colourTertiary)},Blockly.Block.prototype.interpolate_=function(t,e,o){var n=Blockly.utils.tokenizeInterpolation(t),i=[],r=0;t=[];for(var s=0;s<n.length;s++){var a=n[s];if("number"==typeof a){if(0>=a||a>e.length)throw Error('Block "'+this.type+'": Message index %'+a+" out of range.");if(i[a])throw Error('Block "'+this.type+'": Message index %'+a+" duplicated.");i[a]=!0,r++,t.push(e[a-1])}else(a=a.trim())&&t.push(a)}if(r!=e.length)throw Error('Block "'+this.type+'": Message does not reference all '+e.length+" arg(s).");for(t.length&&("string"==typeof t[t.length-1]||goog.string.startsWith(t[t.length-1].type,"field_"))&&(s={type:"input_dummy"},o&&(s.align=o),t.push(s)),o={LEFT:Blockly.ALIGN_LEFT,RIGHT:Blockly.ALIGN_RIGHT,CENTRE:Blockly.ALIGN_CENTRE},e=[],s=0;s<t.length;s++)if("string"==typeof(r=t[s]))e.push([r,void 0]);else{n=a=null;do{if(i=!1,"string"==typeof r)a=new Blockly.FieldLabel(r);else switch(r.type){case"input_value":n=this.appendValueInput(r.name);break;case"input_statement":n=this.appendStatementInput(r.name);break;case"input_dummy":n=this.appendDummyInput(r.name);break;case"field_label":a=Blockly.Block.newFieldLabelFromJson_(r);break;case"field_input":a=Blockly.Block.newFieldTextInputFromJson_(r);break;case"field_textdropdown":a=new Blockly.FieldTextDropdown(r.text,r.options),"boolean"==typeof r.spellcheck&&a.setSpellcheck(r.spellcheck);break;case"field_numberdropdown":a=new Blockly.FieldNumberDropdown(r.value,r.options,r.min,r.max,r.precision);break;case"field_angle":a=new Blockly.FieldAngle(r.angle);break;case"field_checkbox":a=new Blockly.FieldCheckbox(r.checked?"TRUE":"FALSE");break;case"field_colour":a=new Blockly.FieldColour(r.colour);break;case"field_variable":a=Blockly.Block.newFieldVariableFromJson_(r);break;case"field_dropdown":a=new Blockly.FieldDropdown(r.options);break;case"field_iconmenu":a=new Blockly.FieldIconMenu(r.options);break;case"field_image":a=Blockly.Block.newFieldImageFromJson_(r);break;case"field_number":a=new Blockly.FieldNumber(r.value,r.min,r.max,r.precision);break;case"field_variable_getter":a=Blockly.Block.newFieldVariableGetterFromJson_(r);break;case"field_date":if(Blockly.FieldDate){a=new Blockly.FieldDate(r.date);break}default:r.alt&&(r=r.alt,i=!0)}}while(i);if(a)e.push([a,r.name]);else if(n){for(r.check&&n.setCheck(r.check),r.align&&n.setAlign(o[r.align]),i=0;i<e.length;i++)n.appendField(e[i][0],e[i][1]);e.length=0}}},Blockly.Block.newFieldImageFromJson_=function(t){var e=Blockly.utils.replaceMessageReferences(t.src),o=Number(Blockly.utils.replaceMessageReferences(t.width)),n=Number(Blockly.utils.replaceMessageReferences(t.height)),i=Blockly.utils.replaceMessageReferences(t.alt);return new Blockly.FieldImage(e,o,n,i,!!t.flip_rtl)},Blockly.Block.newFieldLabelFromJson_=function(t){var e=Blockly.utils.replaceMessageReferences(t.text);return new Blockly.FieldLabel(e,t.class)},Blockly.Block.newFieldTextInputFromJson_=function(t){var e=Blockly.utils.replaceMessageReferences(t.text);return e=new Blockly.FieldTextInput(e,t.class),"boolean"==typeof t.spellcheck&&e.setSpellcheck(t.spellcheck),e},Blockly.Block.newFieldVariableFromJson_=function(t){var e=Blockly.utils.replaceMessageReferences(t.variable);return new Blockly.FieldVariable(e,null,t.variableTypes)},Blockly.Block.newFieldVariableGetterFromJson_=function(t){var e=Blockly.utils.replaceMessageReferences(t.text);return new Blockly.FieldVariableGetter(e,t.name,t.class)},Blockly.Block.prototype.appendInput_=function(t,e){var o=null;return t!=Blockly.INPUT_VALUE&&t!=Blockly.NEXT_STATEMENT||(o=this.makeConnection_(t)),o=new Blockly.Input(t,e,this,o),this.inputList.push(o),o},Blockly.Block.prototype.moveInputBefore=function(t,e){if(t!=e){for(var o,n=-1,i=e?-1:this.inputList.length,r=0;o=this.inputList[r];r++)if(o.name==t){if(n=r,-1!=i)break}else if(e&&o.name==e&&(i=r,-1!=n))break;goog.asserts.assert(-1!=n,'Named input "%s" not found.',t),goog.asserts.assert(-1!=i,'Reference input "%s" not found.',e),this.moveNumberedInputBefore(n,i)}},Blockly.Block.prototype.moveNumberedInputBefore=function(t,e){goog.asserts.assert(t!=e,"Can't move input to itself."),goog.asserts.assert(t<this.inputList.length,"Input index "+t+" out of bounds."),goog.asserts.assert(e<=this.inputList.length,"Reference input "+e+" out of bounds.");var o=this.inputList[t];this.inputList.splice(t,1),t<e&&e--,this.inputList.splice(e,0,o)},Blockly.Block.prototype.removeInput=function(t,e){for(var o,n=0;o=this.inputList[n];n++)if(o.name==t){if(o.connection&&o.connection.isConnected()){o.connection.setShadowDom(null);var i=o.connection.targetBlock();i.isShadow()?i.dispose():i.unplug()}return o.dispose(),void this.inputList.splice(n,1)}e||goog.asserts.fail('Input "%s" not found.',t)},Blockly.Block.prototype.getInput=function(t){for(var e,o=0;e=this.inputList[o];o++)if(e.name==t)return e;return null},Blockly.Block.prototype.getInputTargetBlock=function(t){return(t=this.getInput(t))&&t.connection&&t.connection.targetBlock()},Blockly.Block.prototype.getCommentText=function(){return this.comment||""},Blockly.Block.prototype.setCommentText=function(t){this.comment!=t&&(Blockly.Events.fire(new Blockly.Events.BlockChange(this,"comment",null,this.comment,t||"")),this.comment=t)},Blockly.Block.prototype.setOutputShape=function(t){this.outputShape_=t},Blockly.Block.prototype.getOutputShape=function(){return this.outputShape_},Blockly.Block.prototype.setCategory=function(t){this.category_=t},Blockly.Block.prototype.getCategory=function(){return this.category_},Blockly.Block.prototype.setCheckboxInFlyout=function(t){this.checkboxInFlyout_=t},Blockly.Block.prototype.hasCheckboxInFlyout=function(){return this.checkboxInFlyout_},Blockly.Block.prototype.setWarningText=function(){},Blockly.Block.prototype.setMutator=function(){},Blockly.Block.prototype.getRelativeToSurfaceXY=function(){return this.xy_},Blockly.Block.prototype.moveBy=function(t,e){goog.asserts.assert(!this.parentBlock_,"Block has parent.");var o=new Blockly.Events.BlockMove(this);this.xy_.translate(t,e),o.recordNew(),Blockly.Events.fire(o)},Blockly.Block.prototype.makeConnection_=function(t){return new Blockly.Connection(this,t)},Blockly.Block.prototype.allInputsFilled=function(t){if(void 0===t&&(t=!0),!t&&this.isShadow())return!1;for(var e,o=0;e=this.inputList[o];o++)if(e.connection&&(!(e=e.connection.targetBlock())||!e.allInputsFilled(t)))return!1;return!(o=this.getNextBlock())||o.allInputsFilled(t)},Blockly.Block.prototype.toDevString=function(){var t=this.type?'"'+this.type+'" block':"Block";return this.id&&(t+=' (id="'+this.id+'")'),t},Blockly.BlockDragSurfaceSvg=function(t){this.container_=t,this.createDom()},Blockly.BlockDragSurfaceSvg.prototype.SVG_=null,Blockly.BlockDragSurfaceSvg.prototype.dragGroup_=null,Blockly.BlockDragSurfaceSvg.prototype.container_=null,Blockly.BlockDragSurfaceSvg.prototype.scale_=1,Blockly.BlockDragSurfaceSvg.prototype.surfaceXY_=null,Blockly.BlockDragSurfaceSvg.prototype.dragShadowFilterId_="",Blockly.BlockDragSurfaceSvg.SHADOW_STD_DEVIATION=6,Blockly.BlockDragSurfaceSvg.prototype.createDom=function(){if(!this.SVG_){this.SVG_=Blockly.utils.createSvgElement("svg",{xmlns:Blockly.SVG_NS,"xmlns:html":Blockly.HTML_NS,"xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",class:"blocklyBlockDragSurface"},this.container_);var t=Blockly.utils.createSvgElement("defs",{},this.SVG_);this.dragShadowFilterId_=this.createDropShadowDom_(t),this.dragGroup_=Blockly.utils.createSvgElement("g",{},this.SVG_),this.dragGroup_.setAttribute("filter","url(#"+this.dragShadowFilterId_+")")}},Blockly.BlockDragSurfaceSvg.prototype.createDropShadowDom_=function(t){var e=String(Math.random()).substring(2);return t=Blockly.utils.createSvgElement("filter",{id:"blocklyDragShadowFilter"+e,height:"140%",width:"140%",y:"-20%",x:"-20%"},t),Blockly.utils.createSvgElement("feGaussianBlur",{in:"SourceAlpha",stdDeviation:Blockly.BlockDragSurfaceSvg.SHADOW_STD_DEVIATION},t),e=Blockly.utils.createSvgElement("feComponentTransfer",{result:"offsetBlur"},t),Blockly.utils.createSvgElement("feFuncA",{type:"linear",slope:Blockly.Colours.dragShadowOpacity},e),Blockly.utils.createSvgElement("feComposite",{in:"SourceGraphic",in2:"offsetBlur",operator:"over"},t),t.id},Blockly.BlockDragSurfaceSvg.prototype.setBlocksAndShow=function(t){goog.asserts.assert(0==this.dragGroup_.childNodes.length,"Already dragging a block."),this.dragGroup_.appendChild(t),this.SVG_.style.display="block",this.surfaceXY_=new goog.math.Coordinate(0,0),document.getElementsByClassName("injectionDiv")[0].style.overflow="visible"},Blockly.BlockDragSurfaceSvg.prototype.translateAndScaleGroup=function(t,e,o){this.scale_=o,t=t.toFixed(0),e=e.toFixed(0),this.dragGroup_.setAttribute("transform","translate("+t+","+e+") scale("+o+")")},Blockly.BlockDragSurfaceSvg.prototype.translateSurfaceInternal_=function(){var t=this.surfaceXY_.x,e=this.surfaceXY_.y;t=t.toFixed(0),e=e.toFixed(0),this.SVG_.style.display="block",Blockly.utils.setCssTransform(this.SVG_,"translate3d("+t+"px, "+e+"px, 0px)")},Blockly.BlockDragSurfaceSvg.prototype.translateSurface=function(t,e){this.surfaceXY_=new goog.math.Coordinate(t*this.scale_,e*this.scale_),this.translateSurfaceInternal_()},Blockly.BlockDragSurfaceSvg.prototype.getSurfaceTranslation=function(){var t=Blockly.utils.getRelativeXY(this.SVG_);return new goog.math.Coordinate(t.x/this.scale_,t.y/this.scale_)},Blockly.BlockDragSurfaceSvg.prototype.getGroup=function(){return this.dragGroup_},Blockly.BlockDragSurfaceSvg.prototype.getCurrentBlock=function(){return this.dragGroup_.firstChild},Blockly.BlockDragSurfaceSvg.prototype.clearAndHide=function(t){t?t.appendChild(this.getCurrentBlock()):this.dragGroup_.removeChild(this.getCurrentBlock()),this.SVG_.style.display="none",goog.asserts.assert(0==this.dragGroup_.childNodes.length,"Drag group was not cleared."),this.surfaceXY_=null,document.getElementsByClassName("injectionDiv")[0].style.overflow="hidden"};Blockly.ContextMenu={},Blockly.ContextMenu.currentBlock=null,Blockly.ContextMenu.eventWrapper_=null,Blockly.ContextMenu.show=function(t,e,o){if(Blockly.WidgetDiv.show(Blockly.ContextMenu,o,null),e.length){var n=Blockly.ContextMenu.populate_(e,o);goog.events.listen(n,goog.ui.Component.EventType.ACTION,Blockly.ContextMenu.hide),Blockly.ContextMenu.position_(n,t,o),setTimeout(function(){n.getElement().focus()},1),Blockly.ContextMenu.currentBlock=null}else Blockly.ContextMenu.hide()},Blockly.ContextMenu.populate_=function(t,e){var o=new goog.ui.Menu;o.setAllowAutoFocus(!0),o.setRightToLeft(e);for(var n,i=0;n=t[i];i++){var r=new goog.ui.MenuItem(n.text);r.setRightToLeft(e),o.addChild(r,!0),r.setEnabled(n.enabled),n.enabled&&(goog.events.listen(r,goog.ui.Component.EventType.ACTION,n.callback),r.handleContextMenu=function(){goog.events.dispatchEvent(this,goog.ui.Component.EventType.ACTION)})}return o},Blockly.ContextMenu.position_=function(t,e,o){var n=goog.dom.getViewportSize(),i=goog.style.getViewportPageOffset(document);t.render(Blockly.WidgetDiv.DIV),t=t.getElement(),Blockly.utils.addClass(t,"blocklyContextMenu"),Blockly.bindEventWithChecks_(t,"contextmenu",null,Blockly.utils.noEvent),t=goog.style.getSize(t);var r=e.clientX+i.x,s=e.clientY+i.y;e.clientY+t.height>=n.height&&(s-=t.height),o?t.width>=e.clientX&&(r+=t.width):e.clientX+t.width>=n.width&&(r-=t.width),Blockly.WidgetDiv.position(r,s,n,i,o)},Blockly.ContextMenu.hide=function(){Blockly.WidgetDiv.hideIfOwner(Blockly.ContextMenu),Blockly.ContextMenu.currentBlock=null,Blockly.ContextMenu.eventWrapper_&&Blockly.unbindEvent_(Blockly.ContextMenu.eventWrapper_)},Blockly.ContextMenu.callbackFactory=function(t,e){return function(){Blockly.Events.disable();try{var o=Blockly.Xml.domToBlock(e,t.workspace),n=t.getRelativeToSurfaceXY();n.x=t.RTL?n.x-Blockly.SNAP_RADIUS:n.x+Blockly.SNAP_RADIUS,n.y+=2*Blockly.SNAP_RADIUS,o.moveBy(n.x,n.y)}finally{Blockly.Events.enable()}Blockly.Events.isEnabled()&&!o.isShadow()&&Blockly.Events.fire(new Blockly.Events.BlockCreate(o)),o.select()}},Blockly.BlockSvg=function(t,e,o){this.svgGroup_=Blockly.utils.createSvgElement("g",{},null),this.svgPath_=Blockly.utils.createSvgElement("path",{class:"blocklyPath blocklyBlockBackground"},this.svgGroup_),this.svgPath_.tooltip=this,this.rendered=!1,this.inputShapes_={},this.useDragSurface_=Blockly.utils.is3dSupported()&&!!t.blockDragSurface_,Blockly.Tooltip.bindMouseEvents(this.svgPath_),Blockly.BlockSvg.superClass_.constructor.call(this,t,e,o)},goog.inherits(Blockly.BlockSvg,Blockly.Block),Blockly.BlockSvg.prototype.height=0,Blockly.BlockSvg.prototype.width=0,Blockly.BlockSvg.prototype.insertionMarkerMinWidth_=0,Blockly.BlockSvg.prototype.opacity_=1,Blockly.BlockSvg.prototype.dragStartXY_=null,Blockly.BlockSvg.prototype.isGlowingBlock_=!1,Blockly.BlockSvg.prototype.isGlowingStack_=!1,Blockly.BlockSvg.INLINE=-1,Blockly.BlockSvg.prototype.initSvg=function(){if(goog.asserts.assert(this.workspace.rendered,"Workspace is headless."),!this.isInsertionMarker()){for(var t,e=0;t=this.inputList[e];e++)t.init(),t.type===Blockly.INPUT_VALUE&&this.initInputShape(t);for(t=this.getIcons(),e=0;e<t.length;e++)t[e].createIcon()}this.updateColour(),this.updateMovable(),this.workspace.options.readOnly||this.eventsInit_||Blockly.bindEventWithChecks_(this.getSvgRoot(),"mousedown",this,this.onMouseDown_),this.eventsInit_=!0,this.getSvgRoot().parentNode||this.workspace.getCanvas().appendChild(this.getSvgRoot())},Blockly.BlockSvg.prototype.initInputShape=function(t){this.inputShapes_[t.name]||t.connection.getShadowDom()||(this.inputShapes_[t.name]=Blockly.utils.createSvgElement("path",{class:"blocklyPath",style:"visibility: hidden"},this.svgGroup_))},Blockly.BlockSvg.prototype.select=function(){if(this.isShadow()&&this.getParent())this.getParent().select();else if(Blockly.selected!=this){var t=null;if(Blockly.selected){t=Blockly.selected.id,Blockly.Events.disable();try{Blockly.selected.unselect()}finally{Blockly.Events.enable()}}t=new Blockly.Events.Ui(null,"selected",t,this.id),t.workspaceId=this.workspace.id,Blockly.Events.fire(t),Blockly.selected=this,this.addSelect()}},Blockly.BlockSvg.prototype.unselect=function(){if(Blockly.selected==this){var t=new Blockly.Events.Ui(null,"selected",this.id,null);t.workspaceId=this.workspace.id,Blockly.Events.fire(t),Blockly.selected=null,this.removeSelect()}},Blockly.BlockSvg.prototype.setGlowBlock=function(t){this.isGlowingBlock_=t,this.updateColour()},Blockly.BlockSvg.prototype.setGlowStack=function(t){this.isGlowingStack_=t,t=this.getSvgRoot(),this.isGlowingStack_&&!t.hasAttribute("filter")?t.setAttribute("filter","url(#blocklyStackGlowFilter)"):!this.isGlowingStack_&&t.hasAttribute("filter")&&t.removeAttribute("filter")},Blockly.BlockSvg.prototype.mutator=null,Blockly.BlockSvg.prototype.comment=null,Blockly.BlockSvg.prototype.warning=null,Blockly.BlockSvg.prototype.getIcons=function(){var t=[];return this.mutator&&t.push(this.mutator),this.comment&&t.push(this.comment),this.warning&&t.push(this.warning),t},Blockly.BlockSvg.prototype.setParent=function(t){if(t!=this.parentBlock_){var e=this.getSvgRoot();if(this.parentBlock_&&e){var o=this.getRelativeToSurfaceXY();Blockly.selected!=this&&(this.workspace.getCanvas().appendChild(e),this.translate(o.x,o.y))}Blockly.Field.startCache(),Blockly.BlockSvg.superClass_.setParent.call(this,t),Blockly.Field.stopCache(),t&&(o=this.getRelativeToSurfaceXY(),t.getSvgRoot().appendChild(e),e=this.getRelativeToSurfaceXY(),this.moveConnections_(e.x-o.x,e.y-o.y),this.isShadow()&&this.setColour(this.getColour(),this.getColourSecondary(),t.getColourTertiary()))}},Blockly.BlockSvg.prototype.getRelativeToSurfaceXY=function(){var t=0,e=0,o=this.useDragSurface_?this.workspace.blockDragSurface_.getGroup():null,n=this.getSvgRoot();if(n)do{var i=Blockly.utils.getRelativeXY(n);t+=i.x,e+=i.y,this.useDragSurface_&&this.workspace.blockDragSurface_.getCurrentBlock()==n&&(i=this.workspace.blockDragSurface_.getSurfaceTranslation(),t+=i.x,e+=i.y),n=n.parentNode}while(n&&n!=this.workspace.getCanvas()&&n!=o);return new goog.math.Coordinate(t,e)},Blockly.BlockSvg.prototype.moveBy=function(t,e){var o;goog.asserts.assert(!this.parentBlock_,"Block has parent.");var n=Blockly.Events.isEnabled();n&&(o=new Blockly.Events.BlockMove(this));var i=this.getRelativeToSurfaceXY();this.translate(i.x+t,i.y+e),this.moveConnections_(t,e),n&&(o.recordNew(),Blockly.Events.fire(o)),this.workspace.resizeContents()},Blockly.BlockSvg.prototype.translate=function(t,e){this.getSvgRoot().setAttribute("transform","translate("+t+","+e+")")},Blockly.BlockSvg.prototype.moveToDragSurface_=function(){if(this.useDragSurface_){var t=this.getRelativeToSurfaceXY();this.clearTransformAttributes_(),this.workspace.blockDragSurface_.translateSurface(t.x,t.y),this.workspace.blockDragSurface_.setBlocksAndShow(this.getSvgRoot())}},Blockly.BlockSvg.prototype.moveOffDragSurface_=function(t){this.useDragSurface_&&(this.translate(t.x,t.y),this.workspace.blockDragSurface_.clearAndHide(this.workspace.getCanvas()))},Blockly.BlockSvg.prototype.moveDuringDrag=function(t){this.useDragSurface_?this.workspace.blockDragSurface_.translateSurface(t.x,t.y):(this.svgGroup_.translate_="translate("+t.x+","+t.y+")",this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_))},Blockly.BlockSvg.prototype.clearTransformAttributes_=function(){Blockly.utils.removeAttribute(this.getSvgRoot(),"transform")},Blockly.BlockSvg.prototype.snapToGrid=function(){if(this.workspace&&!this.workspace.isDragging()&&!this.getParent()&&!this.isInFlyout){var t=this.workspace.getGrid();if(t&&t.shouldSnap()){var e=t.getSpacing(),o=e/2,n=this.getRelativeToSurfaceXY();t=Math.round((n.x-o)/e)*e+o-n.x,e=Math.round((n.y-o)/e)*e+o-n.y,t=Math.round(t),e=Math.round(e),0==t&&0==e||this.moveBy(t,e)}}},Blockly.BlockSvg.prototype.getBoundingRectangle=function(){var t=this.getRelativeToSurfaceXY(this),e=this.getHeightWidth();if(this.RTL){var o=new goog.math.Coordinate(t.x-e.width,t.y);t=new goog.math.Coordinate(t.x,t.y+e.height)}else o=new goog.math.Coordinate(t.x,t.y),t=new goog.math.Coordinate(t.x+e.width,t.y+e.height);return{topLeft:o,bottomRight:t}},Blockly.BlockSvg.prototype.setOpacity=function(t){this.opacity_=t,this.rendered&&this.updateColour()},Blockly.BlockSvg.prototype.getOpacity=function(){return this.opacity_},Blockly.BlockSvg.prototype.setCollapsed=function(t){if(this.collapsed_!=t){for(var e,o=[],n=0;e=this.inputList[n];n++)o.push.apply(o,e.setVisible(!t));if(t){for(e=this.getIcons(),n=0;n<e.length;n++)e[n].setVisible(!1);n=this.toString(Blockly.COLLAPSE_CHARS),this.appendDummyInput("_TEMP_COLLAPSED_INPUT").appendField(n).init()}else this.removeInput("_TEMP_COLLAPSED_INPUT"),this.setWarningText(null);if(Blockly.BlockSvg.superClass_.setCollapsed.call(this,t),o.length||(o[0]=this),this.rendered)for(n=0;t=o[n];n++)t.render()}},Blockly.BlockSvg.prototype.tab=function(t,e){for(var o,n=[],i=0;o=this.inputList[i];i++){for(var r,s=0;r=o.fieldRow[s];s++)r instanceof Blockly.FieldTextInput&&n.push(r);o.connection&&(o=o.connection.targetBlock())&&n.push(o)}i=n.indexOf(t),-1==i&&(i=e?-1:n.length),(n=n[e?i+1:i-1])?n instanceof Blockly.Field?n.showEditor_():n.tab(null,e):(n=this.outputConnection&&this.outputConnection.targetBlock())?n.tab(this,e):(o=e?this.getNextBlock():this.getPreviousBlock())&&o.tab(this,e)},Blockly.BlockSvg.prototype.onMouseDown_=function(t){var e=this.workspace.getGesture(t);e&&e.handleBlockStart(t,this)},Blockly.BlockSvg.prototype.showHelp_=function(){var t=goog.isFunction(this.helpUrl)?this.helpUrl():this.helpUrl;t&&alert(t)},Blockly.BlockSvg.prototype.duplicateAndDragCallback_=function(){var t=this;return function(e){setTimeout(function(){var o=t.workspace;if(!t.getSvgRoot())throw Error("oldBlock is not rendered.");var n=Blockly.Xml.blockToDom(t);if(o.setResizesEnabled(!1),n=Blockly.Xml.domToBlock(n,o),Blockly.utils.changeObscuredShadowIds(n),!n.getSvgRoot())throw Error("newBlock is not rendered.");var i=t.getRelativeToSurfaceXY();n.moveBy(i.x,i.y),i=i.scale(o.scale);var r=o.getOriginOffsetInPixels();i=goog.math.Coordinate.sum(r,i),r=o.getInjectionDiv().getBoundingClientRect(),o.startDragWithFakeEvent({clientX:i.x+r.left,clientY:i.y+r.top,type:"mousedown",preventDefault:function(){e.preventDefault()},stopPropagation:function(){e.stopPropagation()},target:e.target},n)},0)}},Blockly.BlockSvg.prototype.showContextMenu_=function(t){if(!this.workspace.options.readOnly&&this.contextMenu){var e=this,o=[];if(this.isDeletable()&&this.isMovable()&&!e.isInFlyout){var n={text:Blockly.Msg.DUPLICATE_BLOCK,enabled:!0,callback:e.duplicateAndDragCallback_()};o.push(n),this.isEditable()&&this.workspace.options.comments&&(n={enabled:!goog.userAgent.IE},this.comment?(n.text=Blockly.Msg.REMOVE_COMMENT,n.callback=function(){e.setCommentText(null)}):(n.text=Blockly.Msg.ADD_COMMENT,n.callback=function(){e.setCommentText("")}),o.push(n)),n=this.getDescendants(!0).length;var i=this.getNextBlock();i&&(n-=i.getDescendants(!0).length),n={text:1==n?Blockly.Msg.DELETE_BLOCK:Blockly.Msg.DELETE_X_BLOCKS.replace("%1",String(n)),enabled:!0,callback:function(){Blockly.Events.setGroup(!0),e.dispose(!0,!0),Blockly.Events.setGroup(!1)}},o.push(n)}else if(this.parentBlock_&&this.isShadow_)return void this.parentBlock_.showContextMenu_(t);n={enabled:!(goog.isFunction(this.helpUrl)?!this.helpUrl():!this.helpUrl)},n.text=Blockly.Msg.HELP,n.callback=function(){e.showHelp_()},o.push(n),this.customContextMenu&&this.customContextMenu(o),Blockly.ContextMenu.show(t,o,this.RTL),Blockly.ContextMenu.currentBlock=this}},Blockly.BlockSvg.prototype.moveConnections_=function(t,e){if(this.rendered){for(var o=this.getConnections_(!1),n=0;n<o.length;n++)o[n].moveBy(t,e);for(o=this.getIcons(),n=0;n<o.length;n++)o[n].computeIconLocation();for(n=0;n<this.childBlocks_.length;n++)this.childBlocks_[n].moveConnections_(t,e)}},Blockly.BlockSvg.prototype.setDragging=function(t){if(t){var e=this.getSvgRoot();e.translate_="",e.skew_="",Blockly.draggingConnections_=Blockly.draggingConnections_.concat(this.getConnections_(!0)),Blockly.utils.addClass(this.svgGroup_,"blocklyDragging")}else Blockly.draggingConnections_=[],Blockly.utils.removeClass(this.svgGroup_,"blocklyDragging");for(e=0;e<this.childBlocks_.length;e++)this.childBlocks_[e].setDragging(t)},Blockly.BlockSvg.prototype.updateMovable=function(){this.isMovable()?Blockly.utils.addClass(this.svgGroup_,"blocklyDraggable"):Blockly.utils.removeClass(this.svgGroup_,"blocklyDraggable")},Blockly.BlockSvg.prototype.setMovable=function(t){Blockly.BlockSvg.superClass_.setMovable.call(this,t),this.updateMovable()},Blockly.BlockSvg.prototype.setEditable=function(t){Blockly.BlockSvg.superClass_.setEditable.call(this,t),t=this.getIcons();for(var e=0;e<t.length;e++)t[e].updateEditable()},Blockly.BlockSvg.prototype.setShadow=function(t){Blockly.BlockSvg.superClass_.setShadow.call(this,t),this.updateColour()},Blockly.BlockSvg.prototype.setInsertionMarker=function(t,e){Blockly.BlockSvg.superClass_.setInsertionMarker.call(this,t),this.insertionMarkerMinWidth_=e,this.updateColour()},Blockly.BlockSvg.prototype.getSvgRoot=function(){return this.svgGroup_},Blockly.BlockSvg.prototype.dispose=function(t,e){if(this.workspace){Blockly.Tooltip.hide(),Blockly.Field.startCache();var o=this.workspace;Blockly.selected==this&&(this.unselect(),this.workspace.cancelCurrentGesture()),Blockly.ContextMenu.currentBlock==this&&Blockly.ContextMenu.hide(),e&&this.rendered&&(this.unplug(t),this.disposeUiEffect()),this.rendered=!1,Blockly.Events.disable();try{for(var n=this.getIcons(),i=0;i<n.length;i++)n[i].dispose()}finally{Blockly.Events.enable()}Blockly.BlockSvg.superClass_.dispose.call(this,t),goog.dom.removeNode(this.svgGroup_),o.resizeContents(),this.svgPath_=this.svgGroup_=null,Blockly.Field.stopCache()}},Blockly.BlockSvg.prototype.disposeUiEffect=function(){this.workspace.getAudioManager().play("delete");var t=this.workspace.getSvgXY(this.svgGroup_),e=this.svgGroup_.cloneNode(!0);e.translateX_=t.x,e.translateY_=t.y,e.setAttribute("transform","translate("+e.translateX_+","+e.translateY_+")"),this.workspace.getParentSvg().appendChild(e),e.bBox_=e.getBBox(),Blockly.BlockSvg.disposeUiStep_(e,this.RTL,new Date,this.workspace.scale)},Blockly.BlockSvg.prototype.connectionUiEffect=function(){this.workspace.getAudioManager().play("click")},Blockly.BlockSvg.disposeUiStep_=function(t,e,o,n){var i=(new Date-o)/150;1<i?goog.dom.removeNode(t):(t.setAttribute("transform","translate("+(t.translateX_+(e?-1:1)*t.bBox_.width*n/2*i)+","+(t.translateY_+t.bBox_.height*n*i)+") scale("+(1-i)*n+")"),setTimeout(function(){Blockly.BlockSvg.disposeUiStep_(t,e,o,n)},10))},Blockly.BlockSvg.prototype.disconnectUiEffect=function(){},Blockly.BlockSvg.disconnectUiStop_=function(){},Blockly.BlockSvg.prototype.updateDisabled=function(){},Blockly.BlockSvg.prototype.getCommentText=function(){return this.comment?this.comment.getText().replace(/\s+$/,"").replace(/ +\n/g,"\n"):""},Blockly.BlockSvg.prototype.setCommentText=function(t){var e=!1;goog.isString(t)?(this.comment||(this.comment=new Blockly.Comment(this),e=!0),this.comment.setText(t)):this.comment&&(this.comment.dispose(),e=!0),e&&this.rendered&&(this.render(),this.bumpNeighbours_())},Blockly.BlockSvg.prototype.setWarningText=function(t,e){this.setWarningText.pid_||(this.setWarningText.pid_=Object.create(null));var o=e||"";if(o)this.setWarningText.pid_[o]&&(clearTimeout(this.setWarningText.pid_[o]),delete this.setWarningText.pid_[o]);else for(var n in this.setWarningText.pid_)clearTimeout(this.setWarningText.pid_[n]),delete this.setWarningText.pid_[n];if(this.workspace.isDragging()){var i=this;this.setWarningText.pid_[o]=setTimeout(function(){i.workspace&&(delete i.setWarningText.pid_[o],i.setWarningText(t,o))},100)}else{if(this.isInFlyout&&(t=null),n=!1,goog.isString(t))this.warning||(this.warning=new Blockly.Warning(this),n=!0),this.warning.setText(t,o);else if(this.warning&&!o)this.warning.dispose(),n=!0;else if(this.warning){n=this.warning.getText(),this.warning.setText("",o);var r=this.warning.getText();r||this.warning.dispose(),n=n!=r}n&&this.rendered&&(this.render(),this.bumpNeighbours_())}},Blockly.BlockSvg.prototype.setMutator=function(t){this.mutator&&this.mutator!==t&&this.mutator.dispose(),t&&(t.block_=this,this.mutator=t,t.createIcon())},Blockly.BlockSvg.prototype.addSelect=function(){Blockly.utils.addClass(this.svgGroup_,"blocklySelected")},Blockly.BlockSvg.prototype.removeSelect=function(){Blockly.utils.removeClass(this.svgGroup_,"blocklySelected")},Blockly.BlockSvg.prototype.setDeleteStyle=function(t){t?Blockly.utils.addClass(this.svgGroup_,"blocklyDraggingDelete"):Blockly.utils.removeClass(this.svgGroup_,"blocklyDraggingDelete")},Blockly.BlockSvg.prototype.setColour=function(t,e,o){Blockly.BlockSvg.superClass_.setColour.call(this,t,e,o),this.rendered&&this.updateColour()},Blockly.BlockSvg.prototype.bringToFront=function(){var t=this;do{var e=t.getSvgRoot();e.parentNode.appendChild(e),t=t.getParent()}while(t)},Blockly.BlockSvg.prototype.setPreviousStatement=function(t,e){Blockly.BlockSvg.superClass_.setPreviousStatement.call(this,t,e),this.rendered&&(this.render(),this.bumpNeighbours_())},Blockly.BlockSvg.prototype.setNextStatement=function(t,e){Blockly.BlockSvg.superClass_.setNextStatement.call(this,t,e),this.rendered&&(this.render(),this.bumpNeighbours_())},Blockly.BlockSvg.prototype.setOutput=function(t,e){Blockly.BlockSvg.superClass_.setOutput.call(this,t,e),this.rendered&&(this.render(),this.bumpNeighbours_())},Blockly.BlockSvg.prototype.setInputsInline=function(t){Blockly.BlockSvg.superClass_.setInputsInline.call(this,t),this.rendered&&(this.render(),this.bumpNeighbours_())},Blockly.BlockSvg.prototype.removeInput=function(t,e){Blockly.BlockSvg.superClass_.removeInput.call(this,t,e),this.rendered&&(this.render(),this.bumpNeighbours_())},Blockly.BlockSvg.prototype.moveNumberedInputBefore=function(t,e){Blockly.BlockSvg.superClass_.moveNumberedInputBefore.call(this,t,e),this.rendered&&(this.render(),this.bumpNeighbours_())},Blockly.BlockSvg.prototype.appendInput_=function(t,e){var o=Blockly.BlockSvg.superClass_.appendInput_.call(this,t,e);return this.rendered&&(this.render(),this.bumpNeighbours_()),o},Blockly.BlockSvg.prototype.getConnections_=function(t){var e=[];if((t||this.rendered)&&(this.outputConnection&&e.push(this.outputConnection),this.previousConnection&&e.push(this.previousConnection),this.nextConnection&&e.push(this.nextConnection),t||!this.collapsed_)){t=0;for(var o;o=this.inputList[t];t++)o.connection&&e.push(o.connection)}return e},Blockly.BlockSvg.prototype.makeConnection_=function(t){return new Blockly.RenderedConnection(this,t)},Blockly.BlockSvg.prototype.bumpNeighbours_=function(){if(this.workspace&&Blockly.dragMode_==Blockly.DRAG_NONE){var t=this.getRootBlock();if(!t.isInFlyout)for(var e,o=this.getConnections_(!1),n=0;e=o[n];n++){e.isConnected()&&e.isSuperior()&&e.targetBlock().bumpNeighbours_();for(var i,r=e.neighbours_(Blockly.SNAP_RADIUS),s=0;i=r[s];s++)e.isConnected()&&i.isConnected()||i.getSourceBlock().getRootBlock()!=t&&(e.isSuperior()?i.bumpAwayFrom_(e):e.bumpAwayFrom_(i))}}},Blockly.BlockSvg.prototype.scheduleSnapAndBump=function(){var t=this,e=Blockly.Events.getGroup();setTimeout(function(){Blockly.Events.setGroup(e),t.snapToGrid(),Blockly.Events.setGroup(!1)},Blockly.BUMP_DELAY/2),setTimeout(function(){Blockly.Events.setGroup(e),t.bumpNeighbours_(),Blockly.Events.setGroup(!1)},Blockly.BUMP_DELAY)},Blockly.BlockSvg.render={},Blockly.BlockSvg.GRID_UNIT=4,Blockly.BlockSvg.SEP_SPACE_X=2*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.SEP_SPACE_Y=2*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.MIN_BLOCK_X=16*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.MIN_BLOCK_X_OUTPUT=12*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.MIN_BLOCK_X_SHADOW_OUTPUT=10*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.MIN_BLOCK_Y=12*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.EXTRA_STATEMENT_ROW_Y=8*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.MIN_BLOCK_X_WITH_STATEMENT=40*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.MIN_BLOCK_Y_SINGLE_FIELD_OUTPUT=8*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.MIN_BLOCK_Y_REPORTER=10*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.MIN_STATEMENT_INPUT_HEIGHT=6*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.NOTCH_WIDTH=8*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.NOTCH_HEIGHT=2*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.CORNER_RADIUS=1*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.STATEMENT_INPUT_EDGE_WIDTH=4*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.STATEMENT_INPUT_INNER_SPACE=2*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.START_HAT_HEIGHT=16,Blockly.BlockSvg.START_HAT_PATH="c 25,-22 71,-22 96,0",Blockly.BlockSvg.NOTCH_PATH_LEFT="c 2,0 3,1 4,2 l 4,4 c 1,1 2,2 4,2 h 12 c 2,0 3,-1 4,-2 l 4,-4 c 1,-1 2,-2 4,-2",Blockly.BlockSvg.NOTCH_PATH_RIGHT="c -2,0 -3,1 -4,2 l -4,4 c -1,1 -2,2 -4,2 h -12 c -2,0 -3,-1 -4,-2 l -4,-4 c -1,-1 -2,-2 -4,-2",Blockly.BlockSvg.NOTCH_START_PADDING=3*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.TOP_LEFT_CORNER_START="m 0,"+Blockly.BlockSvg.CORNER_RADIUS,Blockly.BlockSvg.TOP_LEFT_CORNER="A "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,1 "+Blockly.BlockSvg.CORNER_RADIUS+",0",Blockly.BlockSvg.TOP_RIGHT_CORNER="a "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,1 "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS,Blockly.BlockSvg.BOTTOM_RIGHT_CORNER=" a "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,1 -"+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS,Blockly.BlockSvg.BOTTOM_LEFT_CORNER="a "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,1 -"+Blockly.BlockSvg.CORNER_RADIUS+",-"+Blockly.BlockSvg.CORNER_RADIUS,Blockly.BlockSvg.INNER_TOP_LEFT_CORNER=" a "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,0 -"+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS,Blockly.BlockSvg.INNER_BOTTOM_LEFT_CORNER="a "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS+" 0 0,0 "+Blockly.BlockSvg.CORNER_RADIUS+","+Blockly.BlockSvg.CORNER_RADIUS,Blockly.BlockSvg.INPUT_SHAPE_HEXAGONAL="M "+4*Blockly.BlockSvg.GRID_UNIT+",0  h "+4*Blockly.BlockSvg.GRID_UNIT+" l "+4*Blockly.BlockSvg.GRID_UNIT+","+4*Blockly.BlockSvg.GRID_UNIT+" l "+-4*Blockly.BlockSvg.GRID_UNIT+","+4*Blockly.BlockSvg.GRID_UNIT+" h "+-4*Blockly.BlockSvg.GRID_UNIT+" l "+-4*Blockly.BlockSvg.GRID_UNIT+","+-4*Blockly.BlockSvg.GRID_UNIT+" l "+4*Blockly.BlockSvg.GRID_UNIT+","+-4*Blockly.BlockSvg.GRID_UNIT+" z",Blockly.BlockSvg.INPUT_SHAPE_HEXAGONAL_WIDTH=12*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.INPUT_SHAPE_SQUARE=Blockly.BlockSvg.TOP_LEFT_CORNER_START+Blockly.BlockSvg.TOP_LEFT_CORNER+" h "+(12*Blockly.BlockSvg.GRID_UNIT-2*Blockly.BlockSvg.CORNER_RADIUS)+Blockly.BlockSvg.TOP_RIGHT_CORNER+" v "+(8*Blockly.BlockSvg.GRID_UNIT-2*Blockly.BlockSvg.CORNER_RADIUS)+Blockly.BlockSvg.BOTTOM_RIGHT_CORNER+" h "+(-12*Blockly.BlockSvg.GRID_UNIT+2*Blockly.BlockSvg.CORNER_RADIUS)+Blockly.BlockSvg.BOTTOM_LEFT_CORNER+" z",Blockly.BlockSvg.INPUT_SHAPE_SQUARE_WIDTH=10*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.INPUT_SHAPE_ROUND="M "+4*Blockly.BlockSvg.GRID_UNIT+",0 h "+4*Blockly.BlockSvg.GRID_UNIT+" a "+4*Blockly.BlockSvg.GRID_UNIT+" "+4*Blockly.BlockSvg.GRID_UNIT+" 0 0 1 0 "+8*Blockly.BlockSvg.GRID_UNIT+" h "+-4*Blockly.BlockSvg.GRID_UNIT+" a "+4*Blockly.BlockSvg.GRID_UNIT+" "+4*Blockly.BlockSvg.GRID_UNIT+" 0 0 1 0 -"+8*Blockly.BlockSvg.GRID_UNIT+" z",Blockly.BlockSvg.INPUT_SHAPE_ROUND_WIDTH=12*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.INPUT_SHAPE_HEIGHT=8*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.FIELD_HEIGHT=8*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.FIELD_WIDTH=6*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.EDITABLE_FIELD_PADDING=6,Blockly.BlockSvg.BOX_FIELD_PADDING=2*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.DROPDOWN_ARROW_PADDING=2*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.FIELD_WIDTH_MIN_EDIT=8*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.FIELD_WIDTH_MAX_EDIT=1/0,Blockly.BlockSvg.FIELD_HEIGHT_MAX_EDIT=Blockly.BlockSvg.FIELD_HEIGHT,Blockly.BlockSvg.FIELD_TOP_PADDING=.5*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.NUMBER_FIELD_CORNER_RADIUS=4*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.TEXT_FIELD_CORNER_RADIUS=1*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.FIELD_DEFAULT_CORNER_RADIUS=4*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.MAX_DISPLAY_LENGTH=1/0,Blockly.BlockSvg.INPUT_AND_FIELD_MIN_X=12*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.INLINE_PADDING_Y=1*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.FIELD_TEXTINPUT_FONTSIZE_INITIAL=12,Blockly.BlockSvg.FIELD_TEXTINPUT_FONTSIZE_FINAL=12,Blockly.BlockSvg.FIELD_TEXTINPUT_EXPAND_PAST_TRUNCATION=!1,Blockly.BlockSvg.FIELD_TEXTINPUT_ANIMATE_POSITIONING=!1,Blockly.BlockSvg.SHAPE_IN_SHAPE_PADDING={1:{0:5*Blockly.BlockSvg.GRID_UNIT,1:2*Blockly.BlockSvg.GRID_UNIT,2:5*Blockly.BlockSvg.GRID_UNIT,3:5*Blockly.BlockSvg.GRID_UNIT},2:{0:3*Blockly.BlockSvg.GRID_UNIT,1:3*Blockly.BlockSvg.GRID_UNIT,2:1*Blockly.BlockSvg.GRID_UNIT,3:2*Blockly.BlockSvg.GRID_UNIT},3:{0:2*Blockly.BlockSvg.GRID_UNIT,1:2*Blockly.BlockSvg.GRID_UNIT,2:2*Blockly.BlockSvg.GRID_UNIT,3:2*Blockly.BlockSvg.GRID_UNIT}},Blockly.BlockSvg.prototype.updateColour=function(){var t=this.getColourTertiary();this.isShadow()&&this.parentBlock_&&(t=this.parentBlock_.getColourTertiary(),this.inputList[0]&&this.inputList[0].fieldRow[0]&&this.inputList[0].fieldRow[0]instanceof Blockly.FieldColour&&(t=Blockly.Colours.colourPickerStroke)),this.svgPath_.setAttribute("stroke",t),t=this.isGlowingBlock_||this.isShadow()?this.getColourSecondary():this.getColour(),this.svgPath_.setAttribute("fill",t),this.svgPath_.setAttribute("fill-opacity",this.getOpacity());for(var e in this.inputShapes_)this.inputShapes_[e].setAttribute("fill",this.getColourTertiary());for(e=this.getIcons(),t=0;t<e.length;t++)e[t].updateColour();for(e=0;t=this.inputList[e];e++)for(var o,n=0;o=t.fieldRow[n];n++)o.setText(null)},Blockly.BlockSvg.prototype.highlightForReplacement=function(t){t?(this.svgPath_.setAttribute("filter","url(#blocklyReplacementGlowFilter)"),Blockly.utils.addClass(this.svgGroup_,"blocklyReplaceable")):(this.svgPath_.removeAttribute("filter"),Blockly.utils.removeClass(this.svgGroup_,"blocklyReplaceable"))},Blockly.BlockSvg.prototype.highlightShapeForInput=function(t,e){var o=this.getInputWithConnection(t);if(!o)throw"No input found for the connection";o=this.inputShapes_[o.name],e?(o.setAttribute("filter","url(#blocklyReplacementGlowFilter)"),Blockly.utils.addClass(this.svgGroup_,"blocklyReplaceable")):(o.removeAttribute("filter"),Blockly.utils.removeClass(this.svgGroup_,"blocklyReplaceable"))},Blockly.BlockSvg.prototype.getHeightWidth=function(){var t=this.height,e=this.width,o=this.getNextBlock();return o&&(o=o.getHeightWidth(),t+=o.height,t-=Blockly.BlockSvg.NOTCH_HEIGHT,e=Math.max(e,o.width)),{height:t,width:e}},Blockly.BlockSvg.prototype.render=function(t){Blockly.Field.startCache(),this.rendered=!0;var e=Blockly.BlockSvg.SEP_SPACE_X;this.RTL&&(e=-e);for(var o=this.getIcons(),n=0;n<o.length;n++)e=o[n].renderIcon(e);e+=this.RTL?Blockly.BlockSvg.SEP_SPACE_X:-Blockly.BlockSvg.SEP_SPACE_X,o=this.renderCompute_(e),this.renderDraw_(e,o),this.renderClassify_(),!1!==t&&((t=this.getParent())?t.render(!0):Blockly.resizeSvgContents(this.workspace)),Blockly.Field.stopCache()},Blockly.BlockSvg.prototype.renderFields_=function(t,e,o){this.RTL&&(e=-e);for(var n,i=0;n=t[i];i++){var r=n.getSvgRoot();if(r){!this.previousConnection||n instanceof Blockly.FieldLabel||(e=this.RTL?Math.min(e,-Blockly.BlockSvg.INPUT_AND_FIELD_MIN_X):Math.max(e,Blockly.BlockSvg.INPUT_AND_FIELD_MIN_X));var s=-n.getSize().height/2,a="";if(this.RTL){var l=e-=n.renderSep+n.renderWidth;s=o+s,n.renderWidth&&(e-=Blockly.BlockSvg.SEP_SPACE_X)}else l=e+n.renderSep,s=o+s,n.renderWidth&&(e+=n.renderSep+n.renderWidth+Blockly.BlockSvg.SEP_SPACE_X);this.RTL&&n instanceof Blockly.FieldImage&&n.getFlipRTL()&&(a="scale(-1 1)",l+=n.renderWidth),r.setAttribute("transform","translate("+l+", "+s+") "+a),this.isInsertionMarker()&&r.setAttribute("display","none")}}return this.RTL?-e:e},Blockly.BlockSvg.prototype.renderCompute_=function(t){var e,o=this.inputList,n=[];n.rightEdge=0;for(var i,r=n.bottomEdge=0,s=!1,a=!1,l=!1,c=void 0,u=0;i=o[u];u++)if(i.isVisible()){if(c&&c!=Blockly.NEXT_STATEMENT&&i.type!=Blockly.NEXT_STATEMENT)var h=n[n.length-1];else c=i.type,h=[],h.type=i.type!=Blockly.NEXT_STATEMENT?Blockly.BlockSvg.INLINE:i.type,h.height=0,h.paddingStart=Blockly.BlockSvg.SEP_SPACE_X,h.paddingEnd=Blockly.BlockSvg.SEP_SPACE_X,n.push(h);if(h.push(i),1===o.length&&this.isShadow()&&this.outputConnection?i.renderHeight=Blockly.BlockSvg.MIN_BLOCK_Y_SINGLE_FIELD_OUTPUT:i.renderHeight=this.outputConnection?Blockly.BlockSvg.MIN_BLOCK_Y_REPORTER:h.type==Blockly.NEXT_STATEMENT?Blockly.BlockSvg.MIN_STATEMENT_INPUT_HEIGHT:e&&e.type==Blockly.NEXT_STATEMENT?Blockly.BlockSvg.EXTRA_STATEMENT_ROW_Y:Blockly.BlockSvg.MIN_BLOCK_Y,i.type!=Blockly.INPUT_VALUE||i.connection&&i.connection.isConnected())i.renderWidth=0;else switch(i.connection.getOutputShape()){case Blockly.OUTPUT_SHAPE_SQUARE:i.renderWidth=Blockly.BlockSvg.INPUT_SHAPE_SQUARE_WIDTH;break;case Blockly.OUTPUT_SHAPE_ROUND:i.renderWidth=Blockly.BlockSvg.INPUT_SHAPE_ROUND_WIDTH;break;case Blockly.OUTPUT_SHAPE_HEXAGONAL:i.renderWidth=Blockly.BlockSvg.INPUT_SHAPE_HEXAGONAL_WIDTH;break;default:i.renderWidth=0}if(h.statementNotchAtBottom=!0,i.connection&&i.connection.type===Blockly.NEXT_STATEMENT&&(e=i.connection.targetBlock())&&!e.lastConnectionInStack()&&(h.statementNotchAtBottom=!1),i.connection){e=i.connection.targetBlock();var g=0;e?(g=e.getHeightWidth(),e=g.height,g=g.width):e=Blockly.BlockSvg.INPUT_SHAPE_HEIGHT,i.connection.type===Blockly.INPUT_VALUE&&(e+=2*Blockly.BlockSvg.INLINE_PADDING_Y),i.connection.type===Blockly.NEXT_STATEMENT&&h.statementNotchAtBottom&&(e-=Blockly.BlockSvg.NOTCH_HEIGHT),i.renderHeight=Math.max(i.renderHeight,e),i.renderWidth=Math.max(i.renderWidth,g)}h.height=Math.max(h.height,i.renderHeight),i.fieldWidth=0,1==n.length&&(i.fieldWidth+=this.RTL?-t:t),e=!1,g=0;for(var p;p=i.fieldRow[g];g++){0!=g&&(i.fieldWidth+=Blockly.BlockSvg.SEP_SPACE_X);var d=p.getSize();p.renderWidth=d.width,p.renderSep=e&&p.EDITABLE?Blockly.BlockSvg.SEP_SPACE_X:0,i.fieldWidth+=p.renderWidth+p.renderSep,h.height=Math.max(h.height,d.height),e=p.EDITABLE}h.type!=Blockly.BlockSvg.INLINE&&(h.type==Blockly.NEXT_STATEMENT?(a=!0,r=Math.max(r,i.fieldWidth)):h.type==Blockly.INPUT_VALUE?s=!0:h.type==Blockly.DUMMY_INPUT&&(l=!0)),e=h}for(this.computeOutputPadding_(n),n.statementEdge=Blockly.BlockSvg.STATEMENT_INPUT_EDGE_WIDTH+r,this.previousConnection||this.nextConnection?n.rightEdge=Math.max(n.rightEdge,Blockly.BlockSvg.MIN_BLOCK_X):this.outputConnection&&(this.isShadow()?n.rightEdge=Math.max(n.rightEdge,Blockly.BlockSvg.MIN_BLOCK_X_SHADOW_OUTPUT):n.rightEdge=Math.max(n.rightEdge,Blockly.BlockSvg.MIN_BLOCK_X_OUTPUT)),a&&(n.rightEdge=Math.max(n.rightEdge,Blockly.BlockSvg.MIN_BLOCK_X_WITH_STATEMENT)),u=0;u<n.length;u++)n.bottomEdge+=n[u].height;return 0<this.insertionMarkerMinWidth_&&(n.rightEdge=Math.max(n.rightEdge,this.insertionMarkerMinWidth_)),n.hasValue=s,n.hasStatement=a,n.hasDummy=l,n},Blockly.BlockSvg.prototype.computeOutputPadding_=function(t){if(this.getOutputShape()&&this.outputConnection&&!this.isShadow()&&!(1<t.length)){t=t[0];var e=this.getOutputShape();t.paddingStart=0,t.paddingEnd=0;var o=t[0];if(o.fieldRow[0])var n=0;else n=o.connection,n=n.targetConnection?n.targetConnection.getSourceBlock().getOutputShape():n.getOutputShape(),e==Blockly.OUTPUT_SHAPE_HEXAGONAL&&n!=Blockly.OUTPUT_SHAPE_HEXAGONAL&&(o=o.renderHeight-Blockly.BlockSvg.MIN_BLOCK_Y_REPORTER,t.paddingStart+=o/2);t.paddingStart+=Blockly.BlockSvg.SHAPE_IN_SHAPE_PADDING[e][n],o=t[t.length-1],o.connection?(n=o.connection,n=n.targetConnection?n.targetConnection.getSourceBlock().getOutputShape():n.getOutputShape(),e==Blockly.OUTPUT_SHAPE_HEXAGONAL&&n!=Blockly.OUTPUT_SHAPE_HEXAGONAL&&(o=o.renderHeight-Blockly.BlockSvg.MIN_BLOCK_Y_REPORTER,t.paddingEnd+=o/2)):n=0,t.paddingEnd+=Blockly.BlockSvg.SHAPE_IN_SHAPE_PADDING[e][n]}},Blockly.BlockSvg.prototype.renderDraw_=function(t,e){if(this.squareTopLeftCorner_=this.startHat_=!1,this.outputConnection||this.previousConnection||(this.startHat_=this.squareTopLeftCorner_=!0,e.rightEdge=Math.max(e.rightEdge,100)),this.edgeShapeWidth_=0,this.edgeShape_=null,this.outputConnection){var o=this.getOutputShape();o!==Blockly.OUTPUT_SHAPE_HEXAGONAL&&o!==Blockly.OUTPUT_SHAPE_ROUND||(this.edgeShapeWidth_=e.bottomEdge/2,this.edgeShape_=o,this.squareTopLeftCorner_=!0)}o=this.getRelativeToSurfaceXY();var n=[];this.renderDrawTop_(n,o,e.rightEdge);var i=this.renderDrawRight_(n,o,e,t);this.renderDrawBottom_(n,o,i),this.renderDrawLeft_(n,o),o=n.join(" "),this.svgPath_.setAttribute("d",o),this.RTL&&this.svgPath_.setAttribute("transform","scale(-1 1)")},Blockly.BlockSvg.prototype.renderClassify_=function(){var t=[];if(this.outputConnection)this.isShadow_?t.push("argument"):t.push("reporter"),this.edgeShape_===Blockly.OUTPUT_SHAPE_HEXAGONAL?t.push("boolean"):this.edgeShape_===Blockly.OUTPUT_SHAPE_ROUND&&t.push("round");else{for(var e,o=this.inputList,n=0,i=0;e=o[i];i++)e.connection&&e.connection.type===Blockly.NEXT_STATEMENT&&n++;n&&(t.push("c-block"),t.push("c-"+n)),this.startHat_?t.push("hat"):n||t.push("stack"),this.nextConnection||t.push("end")}this.svgGroup_.setAttribute("data-shapes",t.join(" ")),this.getCategory()&&this.svgGroup_.setAttribute("data-category",this.getCategory())},Blockly.BlockSvg.prototype.renderDrawTop_=function(t,e,o){this.squareTopLeftCorner_?(t.push("m 0,0"),this.startHat_&&t.push(Blockly.BlockSvg.START_HAT_PATH),this.edgeShapeWidth_&&t.push("m "+this.edgeShapeWidth_+",0")):(t.push(Blockly.BlockSvg.TOP_LEFT_CORNER_START),t.push(Blockly.BlockSvg.TOP_LEFT_CORNER)),this.previousConnection&&(t.push("H",Blockly.BlockSvg.NOTCH_START_PADDING),t.push(Blockly.BlockSvg.NOTCH_PATH_LEFT),this.previousConnection.moveTo(e.x+(this.RTL?-Blockly.BlockSvg.NOTCH_WIDTH:Blockly.BlockSvg.NOTCH_WIDTH),e.y)),this.width=o},Blockly.BlockSvg.prototype.renderDrawRight_=function(t,e,o,n){for(var i,r,s,a,l,c=0,u=0;l=o[u];u++){if(i=l.paddingStart,0==u&&(i+=this.RTL?-n:n),l.type==Blockly.BlockSvg.INLINE){for(var h=0;s=l[h];h++)if(r=i,i=c,i+=l.height/2,s.align===Blockly.ALIGN_RIGHT?r+=o.rightEdge-s.fieldWidth-2*Blockly.BlockSvg.SEP_SPACE_X:s.align===Blockly.ALIGN_CENTRE&&(r=Math.max(o.rightEdge/2-s.fieldWidth/2,r)),i=this.renderFields_(s.fieldRow,r,i),s.type==Blockly.INPUT_VALUE){this.previousConnection&&(i=Math.max(i,Blockly.BlockSvg.INPUT_AND_FIELD_MIN_X)),r=this.RTL?e.x-i:e.x+i;var g=l.height/2;a=e.y+c+g,s.connection.moveTo(r,a),s.connection.isConnected()&&s.connection.tighten_(),this.renderInputShape_(s,i,c+g),i+=s.renderWidth+Blockly.BlockSvg.SEP_SPACE_X}i-=Blockly.BlockSvg.SEP_SPACE_X,i+=l.paddingEnd,o.rightEdge=Math.max(i,o.rightEdge),i=Math.max(i,o.rightEdge),this.width=Math.max(this.width,i),this.edgeShape_?t.push("H",i-this.edgeShapeWidth_):(t.push("H",i-Blockly.BlockSvg.CORNER_RADIUS-this.edgeShapeWidth_),t.push(Blockly.BlockSvg.TOP_RIGHT_CORNER)),this.edgeShape_||t.push("v",l.height-2*Blockly.BlockSvg.CORNER_RADIUS)}else l.type==Blockly.NEXT_STATEMENT&&(s=l[0],r=i,i=c,this.renderFields_(s.fieldRow,r,i),t.push(Blockly.BlockSvg.BOTTOM_RIGHT_CORNER),i=o.statementEdge+Blockly.BlockSvg.NOTCH_WIDTH,t.push("H",i+Blockly.BlockSvg.STATEMENT_INPUT_INNER_SPACE+2*Blockly.BlockSvg.CORNER_RADIUS),t.push(Blockly.BlockSvg.NOTCH_PATH_RIGHT),t.push("h","-"+Blockly.BlockSvg.STATEMENT_INPUT_INNER_SPACE),t.push(Blockly.BlockSvg.INNER_TOP_LEFT_CORNER),t.push("v",l.height-2*Blockly.BlockSvg.CORNER_RADIUS),t.push(Blockly.BlockSvg.INNER_BOTTOM_LEFT_CORNER),l.statementNotchAtBottom&&(t.push("h ",Blockly.BlockSvg.STATEMENT_INPUT_INNER_SPACE),t.push(Blockly.BlockSvg.NOTCH_PATH_LEFT)),t.push("H",o.rightEdge-Blockly.BlockSvg.CORNER_RADIUS),r=e.x+(this.RTL?-i:i),a=e.y+c,s.connection.moveTo(r,a),s.connection.isConnected()&&(s.connection.tighten_(),this.width=Math.max(this.width,o.statementEdge+s.connection.targetBlock().getHeightWidth().width)),u==o.length-1||o[u+1].type==Blockly.NEXT_STATEMENT)&&(t.push(Blockly.BlockSvg.TOP_RIGHT_CORNER),t.push("v",Blockly.BlockSvg.EXTRA_STATEMENT_ROW_Y-2*Blockly.BlockSvg.CORNER_RADIUS),c+=Blockly.BlockSvg.EXTRA_STATEMENT_ROW_Y);c+=l.height}return this.edgeShape_&&(this.edgeShape_===Blockly.OUTPUT_SHAPE_ROUND?t.push("a "+this.edgeShapeWidth_+" "+this.edgeShapeWidth_+" 0 0 1 0 "+2*this.edgeShapeWidth_):this.edgeShape_===Blockly.OUTPUT_SHAPE_HEXAGONAL&&t.push("l "+this.edgeShapeWidth_+" "+this.edgeShapeWidth_+" l "+-this.edgeShapeWidth_+" "+this.edgeShapeWidth_)),o.length||(c=Blockly.BlockSvg.MIN_BLOCK_Y,t.push("V",c)),c},Blockly.BlockSvg.prototype.renderInputShape_=function(t,e,o){var n=this.inputShapes_[t.name];if(n)if(t.connection.targetConnection)n.setAttribute("style","visibility: hidden");else{switch(t.connection.getOutputShape()){case Blockly.OUTPUT_SHAPE_HEXAGONAL:t=Blockly.BlockSvg.INPUT_SHAPE_HEXAGONAL;var i=Blockly.BlockSvg.INPUT_SHAPE_HEXAGONAL_WIDTH,r="boolean";break;case Blockly.OUTPUT_SHAPE_ROUND:t=Blockly.BlockSvg.INPUT_SHAPE_ROUND,i=Blockly.BlockSvg.INPUT_SHAPE_ROUND_WIDTH,r="round";break;default:t=Blockly.BlockSvg.INPUT_SHAPE_SQUARE,i=Blockly.BlockSvg.INPUT_SHAPE_SQUARE_WIDTH,r="square"}e=this.RTL?-e-i:e,o-=Blockly.BlockSvg.INPUT_SHAPE_HEIGHT/2,n.setAttribute("d",t),n.setAttribute("transform","translate("+e+","+o+")"),n.setAttribute("data-argument-type",r),n.setAttribute("style","visibility: visible")}},Blockly.BlockSvg.prototype.renderDrawBottom_=function(t,e,o){this.height=o,this.edgeShape_||t.push(Blockly.BlockSvg.BOTTOM_RIGHT_CORNER),this.nextConnection&&(t.push("H",Blockly.BlockSvg.NOTCH_WIDTH+Blockly.BlockSvg.NOTCH_START_PADDING+Blockly.BlockSvg.CORNER_RADIUS," "),t.push(Blockly.BlockSvg.NOTCH_PATH_RIGHT),this.nextConnection.moveTo(this.RTL?e.x-Blockly.BlockSvg.NOTCH_WIDTH:e.x+Blockly.BlockSvg.NOTCH_WIDTH,e.y+o),this.nextConnection.isConnected()&&this.nextConnection.tighten_(),this.height+=Blockly.BlockSvg.NOTCH_HEIGHT),this.edgeShape_?t.push("H",this.edgeShapeWidth_):(t.push("H",Blockly.BlockSvg.CORNER_RADIUS),t.push(Blockly.BlockSvg.BOTTOM_LEFT_CORNER))},Blockly.BlockSvg.prototype.renderDrawLeft_=function(t,e){this.outputConnection&&this.outputConnection.moveTo(e.x,e.y+this.height/2),this.edgeShape_&&(this.edgeShape_===Blockly.OUTPUT_SHAPE_ROUND?t.push("a "+this.edgeShapeWidth_+" "+this.edgeShapeWidth_+" 0 0 1 0 -"+2*this.edgeShapeWidth_):this.edgeShape_===Blockly.OUTPUT_SHAPE_HEXAGONAL&&t.push("l "+-this.edgeShapeWidth_+" "+-this.edgeShapeWidth_+" l "+this.edgeShapeWidth_+" "+-this.edgeShapeWidth_)),t.push("z")},Blockly.BlockSvg.prototype.positionNewBlock=function(t,e,o){e.type==Blockly.NEXT_STATEMENT&&t.moveBy(o.x_-e.x_,o.y_-e.y_)},Blockly.Msg={},goog.getMsgOrig=goog.getMsg,goog.getMsg=function(t,e){var o=goog.getMsg.blocklyMsgMap[t];return o&&(t=Blockly.Msg[o]),goog.getMsgOrig(t,e)},goog.getMsg.blocklyMsgMap={Today:"TODAY"},Blockly.FieldTextInput=function(t,e,o){Blockly.FieldTextInput.superClass_.constructor.call(this,t,e),this.setRestrictor(o),this.addArgType("text")},goog.inherits(Blockly.FieldTextInput,Blockly.Field),Blockly.FieldTextInput.ANIMATION_TIME=.25,Blockly.FieldTextInput.TEXT_MEASURE_PADDING_MAGIC=45,Blockly.FieldTextInput.prototype.CURSOR="text",Blockly.FieldTextInput.prototype.spellcheck_=!0,Blockly.FieldTextInput.prototype.init=function(){Blockly.FieldTextInput.superClass_.init.call(this),this.sourceBlock_.isShadow()||(this.box_=Blockly.utils.createSvgElement("rect",{rx:Blockly.BlockSvg.CORNER_RADIUS,ry:Blockly.BlockSvg.CORNER_RADIUS,x:0,y:0,width:this.size_.width,height:this.size_.height,fill:Blockly.Colours.textField,stroke:this.sourceBlock_.getColourTertiary()}),this.fieldGroup_.insertBefore(this.box_,this.textElement_))},Blockly.FieldTextInput.prototype.dispose=function(){Blockly.WidgetDiv.hideIfOwner(this),Blockly.FieldTextInput.superClass_.dispose.call(this)},Blockly.FieldTextInput.prototype.setValue=function(t){if(null!==t){if(this.sourceBlock_){var e=this.callValidator(t);null!==e&&(t=e)}Blockly.Field.prototype.setValue.call(this,t)}},Blockly.FieldTextInput.prototype.setText=function(t){null!==t&&(t=String(t))!==this.text_&&(this.sourceBlock_&&Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,this.text_,t)),Blockly.Field.prototype.setText.call(this,t))},Blockly.FieldTextInput.prototype.setSpellcheck=function(t){this.spellcheck_=t},Blockly.FieldTextInput.prototype.setRestrictor=function(t){this.restrictor_=t},Blockly.FieldTextInput.prototype.showEditor_=function(t,e,o,n){this.workspace_=this.sourceBlock_.workspace,t=t||!1;var i=e||!1;Blockly.WidgetDiv.show(this,this.sourceBlock_.RTL,this.widgetDispose_(),this.widgetDisposeAnimationFinished_(),Blockly.FieldTextInput.ANIMATION_TIME),e=Blockly.WidgetDiv.DIV,e.className+=" fieldTextInput";var r=goog.dom.createDom("INPUT","blocklyHtmlInput");r.setAttribute("spellcheck",this.spellcheck_),i&&r.setAttribute("readonly","true"),Blockly.FieldTextInput.htmlInput_=r,e.appendChild(r),o&&(this.sourceBlock_.RTL?r.style.paddingLeft=this.arrowSize_+Blockly.BlockSvg.DROPDOWN_ARROW_PADDING+"px":r.style.paddingRight=this.arrowSize_+Blockly.BlockSvg.DROPDOWN_ARROW_PADDING+"px",o=goog.dom.createDom("IMG","blocklyTextDropDownArrow"),o.setAttribute("src",Blockly.mainWorkspace.options.pathToMedia+"dropdown-arrow-dark.svg"),o.style.width=this.arrowSize_+"px",o.style.height=this.arrowSize_+"px",o.style.top=this.arrowY_+"px",o.style.cursor="pointer",this.sourceBlock_.RTL?o.style.left="11px":o.style.right="11px",n&&(r.dropDownArrowMouseWrapper_=Blockly.bindEvent_(o,"mousedown",this,n)),e.appendChild(o)),r.value=r.defaultValue=this.text_,r.oldValue_=null,this.validate_(),this.resizeEditor_(),t||(r.focus(),r.select(),r.setSelectionRange(0,99999)),r.onKeyDownWrapper_=Blockly.bindEventWithChecks_(r,"keydown",this,this.onHtmlInputKeyDown_),r.onKeyUpWrapper_=Blockly.bindEventWithChecks_(r,"keyup",this,this.onHtmlInputChange_),r.onKeyPressWrapper_=Blockly.bindEventWithChecks_(r,"keypress",this,this.onHtmlInputChange_),r.onInputWrapper_=Blockly.bindEvent_(r,"input",this,this.onHtmlInputChange_),r.onWorkspaceChangeWrapper_=this.resizeEditor_.bind(this),this.workspace_.addChangeListener(r.onWorkspaceChangeWrapper_),n="box-shadow "+Blockly.FieldTextInput.ANIMATION_TIME+"s",Blockly.BlockSvg.FIELD_TEXTINPUT_ANIMATE_POSITIONING&&(e.style.transition+=",padding "+Blockly.FieldTextInput.ANIMATION_TIME+"s,width "+Blockly.FieldTextInput.ANIMATION_TIME+"s,height "+Blockly.FieldTextInput.ANIMATION_TIME+"s,margin-left "+Blockly.FieldTextInput.ANIMATION_TIME+"s"),e.style.transition=n,r.style.transition="font-size "+Blockly.FieldTextInput.ANIMATION_TIME+"s",r.style.fontSize=Blockly.BlockSvg.FIELD_TEXTINPUT_FONTSIZE_FINAL+"pt",e.style.boxShadow="0px 0px 0px 4px "+Blockly.Colours.fieldShadow},Blockly.FieldTextInput.prototype.onHtmlInputKeyDown_=function(t){var e=Blockly.FieldTextInput.htmlInput_;13==t.keyCode?(Blockly.WidgetDiv.hide(),Blockly.DropDownDiv.hideWithoutAnimation()):27==t.keyCode?(e.value=e.defaultValue,Blockly.WidgetDiv.hide(),Blockly.DropDownDiv.hideWithoutAnimation()):9==t.keyCode&&(Blockly.WidgetDiv.hide(),Blockly.DropDownDiv.hideWithoutAnimation(),this.sourceBlock_.tab(this,!t.shiftKey),t.preventDefault())},Blockly.FieldTextInput.GECKO_KEYCODE_WHITELIST=[97,99,118,120],Blockly.FieldTextInput.prototype.onHtmlInputChange_=function(t){if("keypress"===t.type&&this.restrictor_){var e=!1;if(goog.userAgent.GECKO){var o=t.charCode;32>o||127==o?e=!0:(t.metaKey||t.ctrlKey)&&(e=-1<Blockly.FieldTextInput.GECKO_KEYCODE_WHITELIST.indexOf(o))}else o=t.keyCode;if(o=String.fromCharCode(o),!e&&!this.restrictor_.test(o)&&t.preventDefault)return void t.preventDefault()}t=Blockly.FieldTextInput.htmlInput_,e=t.value,e!==t.oldValue_?(t.oldValue_=e,this.setText(e),this.validate_()):goog.userAgent.WEBKIT&&this.sourceBlock_.render(),this.resizeEditor_()},Blockly.FieldTextInput.prototype.validate_=function(){var t=!0;goog.asserts.assertObject(Blockly.FieldTextInput.htmlInput_);var e=Blockly.FieldTextInput.htmlInput_;this.sourceBlock_&&(t=this.callValidator(e.value)),null===t?Blockly.utils.addClass(e,"blocklyInvalidInput"):Blockly.utils.removeClass(e,"blocklyInvalidInput")},Blockly.FieldTextInput.prototype.resizeEditor_=function(){var t=this.sourceBlock_.workspace.scale,e=Blockly.WidgetDiv.DIV;if(Blockly.BlockSvg.FIELD_TEXTINPUT_EXPAND_PAST_TRUNCATION){var o=Blockly.utils.measureText(Blockly.FieldTextInput.htmlInput_.style.fontSize,Blockly.FieldTextInput.htmlInput_.style.fontFamily,Blockly.FieldTextInput.htmlInput_.style.fontWeight,Blockly.FieldTextInput.htmlInput_.value);o+=Blockly.FieldTextInput.TEXT_MEASURE_PADDING_MAGIC,o*=t}else o=this.sourceBlock_.getHeightWidth().width*t;o=Math.max(o,Blockly.BlockSvg.FIELD_WIDTH_MIN_EDIT*t),o=Math.min(o,Blockly.BlockSvg.FIELD_WIDTH_MAX_EDIT*t),e.style.width=o/t+1+"px",e.style.height=Blockly.BlockSvg.FIELD_HEIGHT+1+"px",e.style.transform="scale("+t+")";var n=this.sourceBlock_.getHeightWidth().width;e.style.marginLeft=-.5*(o-n*t)+"px",n=this.getBorderRadius()+.5,e.style.borderRadius=n+"px",Blockly.FieldTextInput.htmlInput_.style.borderRadius=n+"px",n=this.sourceBlock_.getColourTertiary(),e.style.borderColor=n,n=this.getAbsoluteXY_(),n.x-=t/2,n.y-=t/2,this.sourceBlock_.RTL&&(n.x+=o,n.x-=e.offsetWidth*t,n.x+=1*t),n.y+=1*t,goog.userAgent.GECKO&&Blockly.WidgetDiv.DIV.style.top&&(n.x+=2*t,n.y+=1*t),goog.userAgent.WEBKIT&&(n.y-=1*t),e.style.left=n.x+"px",e.style.top=n.y+"px"},Blockly.FieldTextInput.prototype.getBorderRadius=function(){return this.sourceBlock_.getOutputShape()==Blockly.OUTPUT_SHAPE_ROUND?Blockly.BlockSvg.NUMBER_FIELD_CORNER_RADIUS:Blockly.BlockSvg.TEXT_FIELD_CORNER_RADIUS},Blockly.FieldTextInput.prototype.widgetDispose_=function(){var t=this;return function(){var e=Blockly.WidgetDiv.DIV,o=Blockly.FieldTextInput.htmlInput_,n=o.value;t.sourceBlock_&&(null===(n=t.callValidator(n))?n=o.defaultValue:t.onFinishEditing_&&t.onFinishEditing_(n)),t.setText(n),t.sourceBlock_.rendered&&t.sourceBlock_.render(),Blockly.unbindEvent_(o.onKeyDownWrapper_),Blockly.unbindEvent_(o.onKeyUpWrapper_),Blockly.unbindEvent_(o.onKeyPressWrapper_),Blockly.unbindEvent_(o.onInputWrapper_),o.dropDownArrowMouseWrapper_&&Blockly.unbindEvent_(o.dropDownArrowMouseWrapper_),t.workspace_.removeChangeListener(o.onWorkspaceChangeWrapper_),Blockly.Events.setGroup(!1),o.style.fontSize=Blockly.BlockSvg.FIELD_TEXTINPUT_FONTSIZE_INITIAL+"pt",e.style.boxShadow="",t.sourceBlock_&&(o=t.sourceBlock_.getHeightWidth(),e.style.width=o.width+1+"px",e.style.height=o.height+1+"px"),e.style.marginLeft=0}},Blockly.FieldTextInput.prototype.widgetDisposeAnimationFinished_=function(){return function(){var t=Blockly.WidgetDiv.DIV.style;t.width="auto",t.height="auto",t.fontSize="",Blockly.WidgetDiv.DIV.className="blocklyWidgetDiv",Blockly.WidgetDiv.DIV.removeAttribute("style"),Blockly.FieldTextInput.htmlInput_.style.transition="",Blockly.FieldTextInput.htmlInput_=null}},Blockly.FieldTextInput.numberValidator=function(t){return console.warn("Blockly.FieldTextInput.numberValidator is deprecated. Use Blockly.FieldNumber instead."),null===t?null:(t=String(t),t=t.replace(/O/gi,"0"),t=t.replace(/,/g,""),t=parseFloat(t||0),isNaN(t)?null:String(t))},Blockly.FieldTextInput.nonnegativeIntegerValidator=function(t){return(t=Blockly.FieldTextInput.numberValidator(t))&&(t=String(Math.max(0,Math.floor(t)))),t},Blockly.FieldAngle=function(t,e){this.symbol_=Blockly.utils.createSvgElement("tspan",{},null),this.symbol_.appendChild(document.createTextNode("")),t=t&&!isNaN(t)?String(t):"0",Blockly.FieldAngle.superClass_.constructor.call(this,t,e),this.addArgType("angle")},goog.inherits(Blockly.FieldAngle,Blockly.FieldTextInput),Blockly.FieldAngle.ROUND=15,Blockly.FieldAngle.HALF=50,Blockly.FieldAngle.CLOCKWISE=!0,Blockly.FieldAngle.OFFSET=90,Blockly.FieldAngle.WRAP=180,Blockly.FieldAngle.RADIUS=Blockly.FieldAngle.HALF-1,Blockly.FieldAngle.prototype.dispose_=function(){var t=this;return function(){Blockly.FieldAngle.superClass_.dispose_.call(t)(),t.gauge_=null,t.clickWrapper_&&Blockly.unbindEvent_(t.clickWrapper_),t.moveWrapper_&&Blockly.unbindEvent_(t.moveWrapper_)}},Blockly.FieldAngle.prototype.showEditor_=function(){Blockly.FieldAngle.superClass_.showEditor_.call(this,goog.userAgent.MOBILE||goog.userAgent.ANDROID||goog.userAgent.IPAD),Blockly.DropDownDiv.hideWithoutAnimation(),Blockly.DropDownDiv.clearContent();var t=Blockly.DropDownDiv.getContentDiv();t=Blockly.utils.createSvgElement("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:html":"http://www.w3.org/1999/xhtml","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",height:2*Blockly.FieldAngle.HALF+"px",width:2*Blockly.FieldAngle.HALF+"px"},t),Blockly.utils.createSvgElement("circle",{cx:Blockly.FieldAngle.HALF,cy:Blockly.FieldAngle.HALF,r:Blockly.FieldAngle.RADIUS,class:"blocklyAngleCircle"},t),this.gauge_=Blockly.utils.createSvgElement("path",{class:"blocklyAngleGauge"},t),this.line_=Blockly.utils.createSvgElement("line",{x1:Blockly.FieldAngle.HALF,y1:Blockly.FieldAngle.HALF,class:"blocklyAngleLine"},t);for(var e=0;360>e;e+=15)Blockly.utils.createSvgElement("line",{x1:Blockly.FieldAngle.HALF+Blockly.FieldAngle.RADIUS,y1:Blockly.FieldAngle.HALF,x2:Blockly.FieldAngle.HALF+Blockly.FieldAngle.RADIUS-(0==e%45?10:5),y2:Blockly.FieldAngle.HALF,class:"blocklyAngleMarks",transform:"rotate("+e+","+Blockly.FieldAngle.HALF+","+Blockly.FieldAngle.HALF+")"},t);Blockly.DropDownDiv.setColour(this.sourceBlock_.parentBlock_.getColour(),this.sourceBlock_.getColourTertiary()),Blockly.DropDownDiv.setCategory(this.sourceBlock_.parentBlock_.getCategory()),Blockly.DropDownDiv.showPositionedByBlock(this,this.sourceBlock_),this.clickWrapper_=Blockly.bindEvent_(t,"click",this,function(){Blockly.WidgetDiv.hide(),Blockly.DropDownDiv.hide(),Blockly.unbindEvent_(this.moveWrapper_)}),this.moveWrapper_=Blockly.bindEvent_(t,"mousemove",this,this.onMouseMove),this.updateGraph_()},Blockly.FieldAngle.prototype.onMouseMove=function(t){var e=this.gauge_.ownerSVGElement.getBoundingClientRect(),o=t.clientX-e.left-Blockly.FieldAngle.HALF;t=t.clientY-e.top-Blockly.FieldAngle.HALF,e=Math.atan(-t/o),isNaN(e)||(e=goog.math.toDegrees(e),0>o?e+=180:0<t&&(e+=360),e=Blockly.FieldAngle.CLOCKWISE?Blockly.FieldAngle.OFFSET+360-e:e-Blockly.FieldAngle.OFFSET,Blockly.FieldAngle.ROUND&&(e=Math.round(e/Blockly.FieldAngle.ROUND)*Blockly.FieldAngle.ROUND),e=this.callValidator(e),Blockly.FieldTextInput.htmlInput_.value=e,this.setValue(e),this.validate_(),this.resizeEditor_())},Blockly.FieldAngle.prototype.setText=function(t){Blockly.FieldAngle.superClass_.setText.call(this,t),this.textElement_&&(this.updateGraph_(),this.size_.width=0)},Blockly.FieldAngle.prototype.updateGraph_=function(){if(this.gauge_){var t=Number(this.getText())+Blockly.FieldAngle.OFFSET,e=goog.math.toRadians(t);t=["M ",Blockly.FieldAngle.HALF,",",Blockly.FieldAngle.HALF];var o=Blockly.FieldAngle.HALF,n=Blockly.FieldAngle.HALF;if(!isNaN(e)){var i=goog.math.toRadians(Blockly.FieldAngle.OFFSET),r=Math.cos(i)*Blockly.FieldAngle.RADIUS,s=Math.sin(i)*-Blockly.FieldAngle.RADIUS;Blockly.FieldAngle.CLOCKWISE&&(e=2*i-e),o+=Math.cos(e)*Blockly.FieldAngle.RADIUS,n-=Math.sin(e)*Blockly.FieldAngle.RADIUS,e=Math.abs(Math.floor((e-i)/Math.PI)%2),Blockly.FieldAngle.CLOCKWISE&&(e=1-e),t.push(" l ",r,",",s," A ",Blockly.FieldAngle.RADIUS,",",Blockly.FieldAngle.RADIUS," 0 ",e," ",Number(Blockly.FieldAngle.CLOCKWISE)," ",o,",",n," z")}this.gauge_.setAttribute("d",t.join("")),this.line_.setAttribute("x2",o),this.line_.setAttribute("y2",n)}},Blockly.FieldAngle.prototype.classValidator=function(t){return null===t?null:(t=parseFloat(t||0),isNaN(t)?null:(t%=360,0>t&&(t+=360),t>Blockly.FieldAngle.WRAP&&(t-=360),String(t)))},Blockly.FieldCheckbox=function(t,e){Blockly.FieldCheckbox.superClass_.constructor.call(this,"",e),this.setValue(t),this.addArgType("checkbox")},goog.inherits(Blockly.FieldCheckbox,Blockly.Field),Blockly.FieldCheckbox.CHECK_CHAR="",Blockly.FieldCheckbox.prototype.CURSOR="default",Blockly.FieldCheckbox.prototype.init=function(){if(!this.fieldGroup_){Blockly.FieldCheckbox.superClass_.init.call(this),this.checkElement_=Blockly.utils.createSvgElement("text",{class:"blocklyText blocklyCheckbox",x:-3,y:14},this.fieldGroup_);var t=document.createTextNode(Blockly.FieldCheckbox.CHECK_CHAR);this.checkElement_.appendChild(t),this.checkElement_.style.display=this.state_?"block":"none"}};Blockly.FieldCheckbox.prototype.getValue=function(){return String(this.state_).toUpperCase()},Blockly.FieldCheckbox.prototype.setValue=function(t){t="string"==typeof t?"TRUE"==t.toUpperCase():!!t,this.state_!==t&&(this.sourceBlock_&&Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,this.state_,t)),this.state_=t,this.checkElement_&&(this.checkElement_.style.display=t?"block":"none"))},Blockly.FieldCheckbox.prototype.showEditor_=function(){var t=!this.state_;this.sourceBlock_&&(t=this.callValidator(t)),null!==t&&this.setValue(String(t).toUpperCase())},Blockly.FieldColour=function(t,e){Blockly.FieldColour.superClass_.constructor.call(this,t,e),this.addArgType("colour")},goog.inherits(Blockly.FieldColour,Blockly.Field),Blockly.FieldColour.prototype.colours_=null,Blockly.FieldColour.prototype.columns_=0,Blockly.FieldColour.prototype.init=function(t){Blockly.FieldColour.superClass_.init.call(this,t),this.setValue(this.getValue())},Blockly.FieldColour.prototype.CURSOR="default",Blockly.FieldColour.prototype.dispose=function(){Blockly.WidgetDiv.hideIfOwner(this),Blockly.FieldColour.superClass_.dispose.call(this)},Blockly.FieldColour.prototype.getValue=function(){return this.colour_},Blockly.FieldColour.prototype.setValue=function(t){this.sourceBlock_&&Blockly.Events.isEnabled()&&this.colour_!=t&&Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,this.colour_,t)),this.colour_=t,this.sourceBlock_&&this.sourceBlock_.setColour(t,t,t)},Blockly.FieldColour.prototype.getText=function(){var t=this.colour_,e=t.match(/^#(.)\1(.)\2(.)\3$/);return e&&(t="#"+e[1]+e[2]+e[3]),t},Blockly.FieldColour.prototype.getSize=function(){return new goog.math.Size(Blockly.BlockSvg.FIELD_WIDTH,Blockly.BlockSvg.FIELD_HEIGHT)},Blockly.FieldColour.COLOURS=goog.ui.ColorPicker.SIMPLE_GRID_COLORS,Blockly.FieldColour.COLUMNS=7,Blockly.FieldColour.prototype.setColours=function(t){return this.colours_=t,this},Blockly.FieldColour.prototype.setColumns=function(t){return this.columns_=t,this},Blockly.FieldColour.prototype.showEditor_=function(){Blockly.WidgetDiv.show(this,this.sourceBlock_.RTL,Blockly.FieldColour.widgetDispose_);var t=new goog.ui.ColorPicker;t.setSize(this.columns_||Blockly.FieldColour.COLUMNS),t.setColors(this.colours_||Blockly.FieldColour.COLOURS);var e=goog.dom.getViewportSize(),o=goog.style.getViewportPageOffset(document),n=this.getAbsoluteXY_(),i=this.getScaledBBox_();t.render(Blockly.WidgetDiv.DIV),t.setSelectedColor(this.getValue());var r=goog.style.getSize(t.getElement());n.y=n.y+r.height+i.height>=e.height+o.y?n.y-(r.height-1):n.y+(i.height-1),this.sourceBlock_.RTL?(n.x+=i.width,n.x-=r.width,n.x<o.x&&(n.x=o.x)):n.x>e.width+o.x-r.width&&(n.x=e.width+o.x-r.width),Blockly.WidgetDiv.position(n.x,n.y,e,o,this.sourceBlock_.RTL);var s=this;Blockly.FieldColour.changeEventKey_=goog.events.listen(t,goog.ui.ColorPicker.EventType.CHANGE,function(t){t=t.target.getSelectedColor()||"#000000",Blockly.WidgetDiv.hide(),s.sourceBlock_&&(t=s.callValidator(t)),null!==t&&s.setValue(t)})},Blockly.FieldColour.widgetDispose_=function(){Blockly.FieldColour.changeEventKey_&&goog.events.unlistenByKey(Blockly.FieldColour.changeEventKey_),Blockly.Events.setGroup(!1)},Blockly.FieldDropdown=function(t,e){this.menuGenerator_=t,this.trimOptions_();var o=this.getOptions()[0];Blockly.FieldDropdown.superClass_.constructor.call(this,o[1],e),this.addArgType("dropdown")},goog.inherits(Blockly.FieldDropdown,Blockly.Field),Blockly.FieldDropdown.CHECKMARK_OVERHANG=25,Blockly.FieldDropdown.prototype.CURSOR="default",Blockly.FieldDropdown.prototype.selectedItem=null,Blockly.FieldDropdown.prototype.value_="",Blockly.FieldDropdown.prototype.imageElement_=null,Blockly.FieldDropdown.prototype.imageJson_=null,Blockly.FieldDropdown.prototype.init=function(){if(!this.fieldGroup_){this.arrowSize_=12,this.arrowX_=0,this.arrowY_=11,this.arrow_=Blockly.utils.createSvgElement("image",{height:this.arrowSize_+"px",width:this.arrowSize_+"px"}),this.arrow_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Blockly.mainWorkspace.options.pathToMedia+"dropdown-arrow.svg"),Blockly.FieldDropdown.superClass_.init.call(this),this.sourceBlock_.isShadow()||(this.box_=Blockly.utils.createSvgElement("rect",{rx:Blockly.BlockSvg.CORNER_RADIUS,ry:Blockly.BlockSvg.CORNER_RADIUS,x:0,y:0,width:this.size_.width,height:this.size_.height,stroke:this.sourceBlock_.getColourTertiary(),fill:this.sourceBlock_.getColour(),class:"blocklyBlockBackground","fill-opacity":1},null),this.fieldGroup_.insertBefore(this.box_,this.textElement_));var t=this.text_;this.text_=null,this.setText(t)}},Blockly.FieldDropdown.prototype.showEditor_=function(){this.dropDownOpen_=!0,Blockly.DropDownDiv.hideWithoutAnimation(),Blockly.DropDownDiv.clearContent();var t=Blockly.DropDownDiv.getContentDiv(),e=this,o=new goog.ui.Menu;o.setRightToLeft(this.sourceBlock_.RTL);for(var n=this.getOptions(),i=0;i<n.length;i++){var r=n[i][0],s=n[i][1];if("object"==typeof r){var a=new Image(r.width,r.height);a.src=r.src,a.alt=r.alt||"",r=a}r=new goog.ui.MenuItem(r),r.setRightToLeft(this.sourceBlock_.RTL),r.setValue(s),r.setCheckable(!0),o.addChild(r,!0),s=s==this.value_,r.setChecked(s),s&&(this.selectedItem=r)}goog.events.listen(o,goog.ui.Component.EventType.ACTION,function(t){(t=t.target)&&e.onItemSelected(this,t),Blockly.DropDownDiv.hide(),Blockly.Events.setGroup(!1)}),o.getHandler().listen(o.getElement(),goog.events.EventType.TOUCHSTART,function(t){this.getOwnerControl(t.target).handleMouseDown(t)}),o.getHandler().listen(o.getElement(),goog.events.EventType.TOUCHEND,function(t){this.getOwnerControl(t.target).performActionInternal(t)}),o.render(t),t=o.getElement(),Blockly.utils.addClass(t,"blocklyDropdownMenu"),goog.style.getSize(t).height=t.scrollHeight,n=this.sourceBlock_.isShadow()?this.sourceBlock_.parentBlock_.getColour():this.sourceBlock_.getColour(),Blockly.DropDownDiv.setColour(n,this.sourceBlock_.getColourTertiary()),n=this.sourceBlock_.isShadow()?this.sourceBlock_.parentBlock_.getCategory():this.sourceBlock_.getCategory(),Blockly.DropDownDiv.setCategory(n),i=this.sourceBlock_.workspace.scale,s=this.size_.width,n=this.size_.height,s*=i,n*=i,i=this.fieldGroup_.getBoundingClientRect(),s=i.left+s/2,n=i.top+n,i=i.top,Blockly.DropDownDiv.setBoundsElement(this.sourceBlock_.workspace.getParentSvg().parentNode),Blockly.DropDownDiv.show(this,s,n,s,i,this.onHide.bind(this)),o.setAllowAutoFocus(!0),t.focus(),this.disableColourChange_||(this.sourceBlock_.isShadow()?(this.savedPrimary_=this.sourceBlock_.getColour(),this.sourceBlock_.setColour(this.sourceBlock_.getColourTertiary(),this.sourceBlock_.getColourSecondary(),this.sourceBlock_.getColourTertiary())):this.box_&&this.box_.setAttribute("fill",this.sourceBlock_.getColourTertiary()))},Blockly.FieldDropdown.prototype.onHide=function(){this.dropDownOpen_=!1,!this.disableColourChange_&&this.sourceBlock_&&(this.sourceBlock_.isShadow()?this.sourceBlock_.setColour(this.savedPrimary_,this.sourceBlock_.getColourSecondary(),this.sourceBlock_.getColourTertiary()):this.box_&&this.box_.setAttribute("fill",this.sourceBlock_.getColour()))},Blockly.FieldDropdown.prototype.onItemSelected=function(t,e){var o=e.getValue();this.sourceBlock_&&(o=this.callValidator(o)),null!==o&&this.setValue(o)},Blockly.FieldDropdown.prototype.trimOptions_=function(){this.suffixField=this.prefixField=null;var t=this.menuGenerator_;if(goog.isArray(t)){for(var e=!1,o=0;o<t.length;o++){var n=t[o][0];"string"==typeof n?t[o][0]=Blockly.utils.replaceMessageReferences(n):(null!=n.alt&&(t[o][0].alt=Blockly.utils.replaceMessageReferences(n.alt)),e=!0)}if(!(e||2>t.length)){var i=[];for(o=0;o<t.length;o++)i.push(t[o][0]);if(o=Blockly.utils.shortestStringLength(i),e=Blockly.utils.commonWordPrefix(i,o),n=Blockly.utils.commonWordSuffix(i,o),(e||n)&&!(o<=e+n)){for(e&&(this.prefixField=i[0].substring(0,e-1)),n&&(this.suffixField=i[0].substr(1-n)),i=[],o=0;o<t.length;o++){var r=t[o][0],s=t[o][1];r=r.substring(e,r.length-n),i[o]=[r,s]}this.menuGenerator_=i}}}},Blockly.FieldDropdown.prototype.isOptionListDynamic=function(){return goog.isFunction(this.menuGenerator_)},Blockly.FieldDropdown.prototype.getOptions=function(){return goog.isFunction(this.menuGenerator_)?this.menuGenerator_.call(this):this.menuGenerator_},Blockly.FieldDropdown.prototype.getValue=function(){return this.value_},Blockly.FieldDropdown.prototype.setValue=function(t){if(null!==t&&t!==this.value_){this.sourceBlock_&&Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,this.value_,t)),this.selectedItem&&(this.selectedItem.setChecked(!1),this.selectedItem=null),this.value_=t;for(var e=this.getOptions(),o=0;o<e.length;o++)if(e[o][1]==t)return t=e[o][0],void("object"==typeof t?(this.imageJson_=t,this.setText(t.alt)):(this.imageJson_=null,this.setText(t)));this.setText(t)}},Blockly.FieldDropdown.prototype.setText=function(t){null!==t&&t!==this.text_&&(this.text_=t,this.updateTextNode_(),this.textElement_&&(this.textElement_.setAttribute("class",this.textElement_.getAttribute("class")+" blocklyDropdownText"),this.textElement_.parentNode.appendChild(this.arrow_)),this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours_()))},Blockly.FieldDropdown.prototype.positionArrow=function(t){return this.arrow_?(this.arrowX_=this.sourceBlock_.RTL?this.arrowSize_-Blockly.BlockSvg.DROPDOWN_ARROW_PADDING:t+Blockly.BlockSvg.DROPDOWN_ARROW_PADDING/2,t=this.arrowSize_+Blockly.BlockSvg.DROPDOWN_ARROW_PADDING,this.box_&&(this.arrowX_+=Blockly.BlockSvg.BOX_FIELD_PADDING),this.arrow_.setAttribute("transform","translate("+this.arrowX_+","+this.arrowY_+")"),t):0},Blockly.FieldDropdown.prototype.dispose=function(){this.selectedItem=null,Blockly.WidgetDiv.hideIfOwner(this),Blockly.FieldDropdown.superClass_.dispose.call(this)},Blockly.FieldIconMenu=function(t){this.icons_=t,Blockly.FieldIconMenu.superClass_.constructor.call(this,t[0].value),this.addArgType("iconmenu")},goog.inherits(Blockly.FieldIconMenu,Blockly.Field),Blockly.FieldIconMenu.DROPDOWN_WIDTH=168,Blockly.FieldIconMenu.savedPrimary_=null,Blockly.FieldIconMenu.prototype.init=function(t){this.arrowX_=18,this.arrowY_=10,t.RTL&&(this.arrowX_=-this.arrowX_-12),this.arrowIcon_=Blockly.utils.createSvgElement("image",{height:"12px",width:"12px",transform:"translate("+this.arrowX_+","+this.arrowY_+")"}),this.arrowIcon_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Blockly.mainWorkspace.options.pathToMedia+"dropdown-arrow.svg"),t.getSvgRoot().appendChild(this.arrowIcon_),Blockly.FieldIconMenu.superClass_.init.call(this,t)},Blockly.FieldIconMenu.prototype.CURSOR="default",Blockly.FieldIconMenu.prototype.setValue=function(t){null!==t&&t!==this.value_&&(this.sourceBlock_&&Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.Change(this.sourceBlock_,"field",this.name,this.value_,t)),this.value_=t,this.setParentFieldImage(this.getSrcForValue(this.value_)))},Blockly.FieldIconMenu.prototype.setParentFieldImage=function(t){if(this.sourceBlock_&&this.sourceBlock_.parentBlock_)for(var e,o=this.sourceBlock_.parentBlock_,n=0;e=o.inputList[n];n++)for(var i,r=0;i=e.fieldRow[r];r++)if(i instanceof Blockly.FieldImage)return void i.setValue(t)},Blockly.FieldIconMenu.prototype.getValue=function(){return this.value_},Blockly.FieldIconMenu.prototype.getSrcForValue=function(t){for(var e,o=0;e=this.icons_[o];o++)if(e.value===t)return e.src},Blockly.FieldIconMenu.prototype.showEditor_=function(){if(!Blockly.DropDownDiv.hideIfOwner(this)){Blockly.DropDownDiv.hideWithoutAnimation(),Blockly.DropDownDiv.clearContent();var t=Blockly.DropDownDiv.getContentDiv();t.setAttribute("role","menu"),t.setAttribute("aria-haspopup","true");for(var e,o=0;e=this.icons_[o];o++){if("placeholder"==e.type){var n=document.createElement("span");n.setAttribute("class","blocklyDropDownPlaceholder"),n.style.width=e.width+"px",n.style.height=e.height+"px"}else{n=document.createElement("button"),n.setAttribute("id",":"+o),n.setAttribute("role","menuitem"),n.setAttribute("class","blocklyDropDownButton"),n.title=e.alt,n.style.width=e.width+"px",n.style.height=e.height+"px";var i=this.sourceBlock_.getColour();e.value==this.getValue()&&(i=this.sourceBlock_.getColourTertiary(),n.setAttribute("aria-selected","true")),n.style.backgroundColor=i,n.style.borderColor=this.sourceBlock_.getColourTertiary(),Blockly.bindEvent_(n,"click",this,this.buttonClick_),Blockly.bindEvent_(n,"mouseup",this,this.buttonClick_),Blockly.bindEvent_(n,"mousedown",n,function(t){this.setAttribute("class","blocklyDropDownButton blocklyDropDownButtonHover"),t.preventDefault()}),Blockly.bindEvent_(n,"mouseover",n,function(){this.setAttribute("class","blocklyDropDownButton blocklyDropDownButtonHover"),t.setAttribute("aria-activedescendant",this.id)}),Blockly.bindEvent_(n,"mouseout",n,function(){this.setAttribute("class","blocklyDropDownButton"),t.removeAttribute("aria-activedescendant")}),i=document.createElement("img"),i.src=e.src,n.setAttribute("data-value",e.value),i.setAttribute("data-value",e.value),n.appendChild(i)}t.appendChild(n)}t.style.width=Blockly.FieldIconMenu.DROPDOWN_WIDTH+"px",Blockly.DropDownDiv.setColour(this.sourceBlock_.getColour(),this.sourceBlock_.getColourTertiary()),Blockly.DropDownDiv.setCategory(this.sourceBlock_.parentBlock_.getCategory()),this.savedPrimary_=this.sourceBlock_.getColour(),this.sourceBlock_.setColour(this.sourceBlock_.getColourSecondary(),this.sourceBlock_.getColourSecondary(),this.sourceBlock_.getColourTertiary()),o=this.sourceBlock_.workspace.scale,o=-Blockly.BlockSvg.MIN_BLOCK_Y*o-Blockly.BlockSvg.FIELD_Y_OFFSET*o,Blockly.DropDownDiv.showPositionedByBlock(this,this.sourceBlock_,this.onHide_.bind(this),o)||this.arrowIcon_.setAttribute("transform","translate("+(this.arrowX_+Blockly.DropDownDiv.ARROW_SIZE/1.5+1)+","+(this.arrowY_+Blockly.DropDownDiv.ARROW_SIZE/1.5)+") rotate(180)")}},Blockly.FieldIconMenu.prototype.buttonClick_=function(t){t=t.target.getAttribute("data-value"),this.setValue(t),Blockly.DropDownDiv.hide()},Blockly.FieldIconMenu.prototype.onHide_=function(){this.sourceBlock_&&this.sourceBlock_.setColour(this.savedPrimary_,this.sourceBlock_.getColourSecondary(),this.sourceBlock_.getColourTertiary()),Blockly.DropDownDiv.content_.removeAttribute("role"),Blockly.DropDownDiv.content_.removeAttribute("aria-haspopup"),Blockly.DropDownDiv.content_.removeAttribute("aria-activedescendant"),this.arrowIcon_.setAttribute("transform","translate("+this.arrowX_+","+this.arrowY_+")")},Blockly.FieldImage=function(t,e,o,n,i){this.sourceBlock_=null,this.height_=Number(o),this.width_=Number(e),this.size_=new goog.math.Size(this.width_,this.height_),this.text_=n||"",this.flipRTL_=i,this.setValue(t)},goog.inherits(Blockly.FieldImage,Blockly.Field),Blockly.FieldImage.prototype.EDITABLE=!1,Blockly.FieldImage.prototype.init=function(){this.fieldGroup_||(this.fieldGroup_=Blockly.utils.createSvgElement("g",{},null),this.visible_||(this.fieldGroup_.style.display="none"),this.imageElement_=Blockly.utils.createSvgElement("image",{height:this.height_+"px",width:this.width_+"px"},this.fieldGroup_),this.setValue(this.src_),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.setTooltip(this.sourceBlock_),Blockly.Tooltip.bindMouseEvents(this.imageElement_))},Blockly.FieldImage.prototype.dispose=function(){goog.dom.removeNode(this.fieldGroup_),this.imageElement_=this.fieldGroup_=null},Blockly.FieldImage.prototype.setTooltip=function(t){this.imageElement_.tooltip=t},Blockly.FieldImage.prototype.getValue=function(){return this.src_},Blockly.FieldImage.prototype.setValue=function(t){null!==t&&(this.src_=t,this.imageElement_&&this.imageElement_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t||""))},Blockly.FieldImage.prototype.getFlipRTL=function(){return this.flipRTL_},Blockly.FieldImage.prototype.setText=function(t){null!==t&&(this.text_=t)},Blockly.FieldImage.prototype.render_=function(){},Blockly.FieldImage.prototype.updateWidth=function(){},Blockly.FieldTextDropdown=function(t,e,o,n){this.menuGenerator_=e,Blockly.FieldDropdown.prototype.trimOptions_.call(this),Blockly.FieldTextDropdown.superClass_.constructor.call(this,t,o,n),this.addArgType("textdropdown")},goog.inherits(Blockly.FieldTextDropdown,Blockly.FieldTextInput),Blockly.FieldTextDropdown.prototype.init=function(){Blockly.FieldTextDropdown.superClass_.init.call(this),this.arrow_||(this.arrowSize_=12,this.arrowX_=0,this.arrowY_=11,this.arrow_=Blockly.utils.createSvgElement("image",{height:this.arrowSize_+"px",width:this.arrowSize_+"px"}),this.arrow_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Blockly.mainWorkspace.options.pathToMedia+"dropdown-arrow-dark.svg"),this.arrow_.style.cursor="pointer",this.fieldGroup_.appendChild(this.arrow_),this.mouseUpWrapper_=Blockly.bindEvent_(this.arrow_,"mouseup",this,this.showDropdown_)),this.disableColourChange_=!0},Blockly.FieldTextDropdown.prototype.dispose=function(){this.mouseUpWrapper_&&(Blockly.unbindEvent_(this.mouseUpWrapper_),this.mouseUpWrapper_=null,Blockly.Touch.clearTouchIdentifier()),Blockly.FieldTextDropdown.superClass_.dispose.call(this)},Blockly.FieldTextDropdown.prototype.showEditor_=function(){this.dropDownOpen_||Blockly.FieldTextDropdown.superClass_.showEditor_.call(this,null,null,!0,function(){Blockly.WidgetDiv.hide(),this.showDropdown_(),Blockly.Touch.clearTouchIdentifier()})},Blockly.FieldTextDropdown.prototype.getOptions_=Blockly.FieldDropdown.prototype.getOptions_,Blockly.FieldTextDropdown.prototype.positionArrow=Blockly.FieldDropdown.prototype.positionArrow,Blockly.FieldTextDropdown.prototype.showDropdown_=Blockly.FieldDropdown.prototype.showEditor_,Blockly.FieldTextDropdown.prototype.onHide=Blockly.FieldDropdown.prototype.onHide,Blockly.FieldNumber=function(t,e,o,n,i){e=this.getNumRestrictor(e,o,n),t=t&&!isNaN(t)?String(t):"0",Blockly.FieldNumber.superClass_.constructor.call(this,t,i,e),this.addArgType("number")},goog.inherits(Blockly.FieldNumber,Blockly.FieldTextInput),Blockly.FieldNumber.DROPDOWN_WIDTH=168,Blockly.FieldNumber.DROPDOWN_Y_PADDING=8,Blockly.FieldNumber.NUMPAD_BUTTONS="789456123.0- ".split(""),Blockly.FieldNumber.NUMPAD_DELETE_ICON='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><path d="M28.89,11.45H16.79a2.86,2.86,0,0,0-2,.84L9.09,18a2.85,2.85,0,0,0,0,4l5.69,5.69a2.86,2.86,0,0,0,2,.84h12.1a2.86,2.86,0,0,0,2.86-2.86V14.31A2.86,2.86,0,0,0,28.89,11.45ZM27.15,22.73a1,1,0,0,1,0,1.41,1,1,0,0,1-.71.3,1,1,0,0,1-.71-0.3L23,21.41l-2.73,2.73a1,1,0,0,1-1.41,0,1,1,0,0,1,0-1.41L21.59,20l-2.73-2.73a1,1,0,0,1,0-1.41,1,1,0,0,1,1.41,0L23,18.59l2.73-2.73a1,1,0,1,1,1.42,1.41L24.42,20Z" fill="'+Blockly.Colours.numPadText+'"/></svg>',Blockly.FieldNumber.activeField_=null,Blockly.FieldNumber.prototype.getNumRestrictor=function(t,e,o){return this.setConstraints_(t,e,o),t="[\\d]",this.decimalAllowed_&&(t+="|[\\.]"),this.negativeAllowed_&&(t+="|[-]"),new RegExp(t)},Blockly.FieldNumber.prototype.setConstraints_=function(t,e,o){this.decimalAllowed_=void 0===o||isNaN(o)||0==o||Math.floor(o)!=o,this.negativeAllowed_=void 0===t||isNaN(t)||0>t},Blockly.FieldNumber.prototype.showEditor_=function(){Blockly.FieldNumber.activeField_=this;var t=goog.userAgent.MOBILE||goog.userAgent.ANDROID||goog.userAgent.IPAD;Blockly.FieldNumber.superClass_.showEditor_.call(this,!1,t),t&&this.showNumPad_()},Blockly.FieldNumber.prototype.showNumPad_=function(){Blockly.DropDownDiv.hideWithoutAnimation(),Blockly.DropDownDiv.clearContent();var t=Blockly.DropDownDiv.getContentDiv();t.setAttribute("role","menu"),t.setAttribute("aria-haspopup","true"),this.addButtons_(t),Blockly.DropDownDiv.setColour(Blockly.Colours.numPadBackground,Blockly.Colours.numPadBorder),t.style.width=Blockly.FieldNumber.DROPDOWN_WIDTH+"px",this.position_()},Blockly.FieldNumber.prototype.position_=function(){var t=this.sourceBlock_.workspace.scale,e=this.sourceBlock_.getHeightWidth();e.width*=t,e.height*=t;var o=this.getAbsoluteXY_(),n=o.x+e.width/2;e=o.y+e.height+Blockly.FieldNumber.DROPDOWN_Y_PADDING,t=o.y-Blockly.BlockSvg.MIN_BLOCK_Y*t-Blockly.BlockSvg.FIELD_Y_OFFSET*t,Blockly.DropDownDiv.setBoundsElement(this.sourceBlock_.workspace.getParentSvg().parentNode),Blockly.DropDownDiv.show(this,n,e,n,t,this.onHide_.bind(this))},Blockly.FieldNumber.prototype.addButtons_=function(t){for(var e,o=Blockly.FieldNumber.NUMPAD_BUTTONS,n=0;e=o[n];n++){var i=document.createElement("button");if(i.setAttribute("role","menuitem"),i.setAttribute("class","blocklyNumPadButton"),i.title=e,i.innerHTML=e,Blockly.bindEvent_(i,"mousedown",i,Blockly.FieldNumber.numPadButtonTouch),"."!=e||this.decimalAllowed_){if("-"==e&&!this.negativeAllowed_)continue;if(" "==e&&!this.negativeAllowed_)continue;" "==e&&this.negativeAllowed_&&i.setAttribute("style","visibility: hidden")}else i.setAttribute("style","visibility: hidden");t.appendChild(i)}o=document.createElement("button"),o.setAttribute("role","menuitem"),o.setAttribute("class","blocklyNumPadButton"),o.title="Delete",n=document.createElement("img"),n.src=Blockly.FieldNumber.NUMPAD_DELETE_ICON,o.appendChild(n),Blockly.bindEvent_(o,"mousedown",null,Blockly.FieldNumber.numPadEraseButtonTouch),t.appendChild(o)},Blockly.FieldNumber.numPadButtonTouch=function(){var t=this.innerHTML,e=Blockly.FieldTextInput.htmlInput_.value,o=Blockly.FieldTextInput.htmlInput_.selectionEnd;t=e.slice(0,Blockly.FieldTextInput.htmlInput_.selectionStart)+t+e.slice(o),Blockly.FieldNumber.updateDisplay_(t),Blockly.Touch.clearTouchIdentifier()},Blockly.FieldNumber.numPadEraseButtonTouch=function(){var t=Blockly.FieldTextInput.htmlInput_.value,e=Blockly.FieldTextInput.htmlInput_.selectionStart,o=Blockly.FieldTextInput.htmlInput_.selectionEnd,n=t.slice(0,e)+t.slice(o);0==o-e&&(n=t.slice(0,e-1)+t.slice(e)),Blockly.FieldNumber.updateDisplay_(n),Blockly.Touch.clearTouchIdentifier()},Blockly.FieldNumber.updateDisplay_=function(t){Blockly.FieldTextInput.htmlInput_.value=t,Blockly.FieldNumber.superClass_.resizeEditor_.call(Blockly.FieldNumber.activeField_),Blockly.FieldTextInput.htmlInput_.setSelectionRange(t.length,t.length),Blockly.FieldTextInput.htmlInput_.scrollLeft=Blockly.FieldTextInput.htmlInput_.scrollWidth,Blockly.FieldNumber.activeField_.validate_()},Blockly.FieldNumber.prototype.onHide_=function(){Blockly.DropDownDiv.content_.removeAttribute("role"),Blockly.DropDownDiv.content_.removeAttribute("aria-haspopup")},Blockly.FieldNumberDropdown=function(t,e,o,n,i,r){this.setConstraints_=Blockly.FieldNumber.prototype.setConstraints_,o=Blockly.FieldNumber.prototype.getNumRestrictor.call(this,o,n,i),Blockly.FieldNumberDropdown.superClass_.constructor.call(this,t,e,r,o),this.addArgType("numberdropdown")},goog.inherits(Blockly.FieldNumberDropdown,Blockly.FieldTextDropdown),Blockly.FieldVariable=function(t,e,o){Blockly.FieldVariable.superClass_.constructor.call(this,Blockly.FieldVariable.dropdownCreate,e),this.setValue(t||""),this.addArgType("variable"),this.variableTypes=o},goog.inherits(Blockly.FieldVariable,Blockly.FieldDropdown),Blockly.FieldVariable.prototype.init=function(){this.fieldGroup_||(Blockly.FieldVariable.superClass_.init.call(this),this.initModel())},Blockly.FieldVariable.prototype.initModel=function(){this.getValue()||this.setValue(Blockly.Variables.generateUniqueName(this.sourceBlock_.isInFlyout?this.sourceBlock_.workspace.targetWorkspace:this.sourceBlock_.workspace)),this.sourceBlock_.isInFlyout||this.sourceBlock_.workspace.createVariable(this.getValue())},Blockly.FieldVariable.prototype.setSourceBlock=function(t){goog.asserts.assert(!t.isShadow(),"Variable fields are not allowed to exist on shadow blocks."),Blockly.FieldVariable.superClass_.setSourceBlock.call(this,t)},Blockly.FieldVariable.prototype.getValue=function(){return this.getText()},Blockly.FieldVariable.prototype.setValue=function(t){var e=t,o=t;if(this.sourceBlock_){var n=this.sourceBlock_.workspace.getVariableById(t);n?o=n.name:(n=this.sourceBlock_.workspace.getVariable(t))&&(e=n.getId()),Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,this.value_,e))}this.value_=e,this.setText(o)},Blockly.FieldVariable.prototype.getVariableTypes_=function(){var t=this.variableTypes;if(null===t&&this.sourceBlock_)return this.sourceBlock_.workspace.getVariableTypes();if(t=t||[""],0==t.length)throw t=this.getText(),Error("'variableTypes' of field variable "+t+" was an empty list");return t},Blockly.FieldVariable.dropdownCreate=function(){var t=[],e=this.getText(),o=!!e,n=null;if(this.sourceBlock_&&(n=this.sourceBlock_.workspace),n){var i=this.getVariableTypes_();t=[];for(var r=0;r<i.length;r++){var s=n.getVariablesOfType(i[r]);t=t.concat(s)}for(r=0;r<t.length;r++)if(o&&goog.string.caseInsensitiveEquals(t[r].name,e)){o=!1;break}}for(o&&n&&(r=n.createVariable(e),t.push(r)),t.sort(Blockly.VariableModel.compareByName),o=[],r=0;r<t.length;r++)o[r]=[t[r].name,t[r].getId()];return o.push([Blockly.Msg.RENAME_VARIABLE,Blockly.RENAME_VARIABLE_ID]),o.push([Blockly.Msg.DELETE_VARIABLE.replace("%1",e),Blockly.DELETE_VARIABLE_ID]),o},Blockly.FieldVariable.prototype.onItemSelected=function(t,e){var o=e.getValue();if(this.sourceBlock_&&this.sourceBlock_.workspace){var n=this.sourceBlock_.workspace,i=n.getVariableById(o);if(i)var r=i.name;else{if(o==Blockly.RENAME_VARIABLE_ID)return o=this.getText(),i=n.getVariable(o),void Blockly.Variables.renameVariable(n,i);if(o==Blockly.DELETE_VARIABLE_ID)return void n.deleteVariable(this.getText())}r=this.callValidator(r)}null!==r&&this.setValue(r)},Blockly.Generator=function(t){this.name_=t,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")},Blockly.Generator.NAME_TYPE="generated_function",Blockly.Generator.prototype.INFINITE_LOOP_TRAP=null,Blockly.Generator.prototype.STATEMENT_PREFIX=null,Blockly.Generator.prototype.INDENT="  ",Blockly.Generator.prototype.COMMENT_WRAP=60,Blockly.Generator.prototype.ORDER_OVERRIDES=[],Blockly.Generator.prototype.workspaceToCode=function(t){t||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),t=Blockly.getMainWorkspace());var e=[];this.init(t),t=t.getTopBlocks(!0);for(var o,n=0;o=t[n];n++){var i=this.blockToCode(o);goog.isArray(i)&&(i=i[0]),i&&(o.outputConnection&&this.scrubNakedValue&&(i=this.scrubNakedValue(i)),e.push(i))}return e=e.join("\n"),e=this.finish(e),e=e.replace(/^\s+\n/,""),e=e.replace(/\n\s+$/,"\n"),e=e.replace(/[ \t]+\n/g,"\n")},Blockly.Generator.prototype.prefixLines=function(t,e){return e+t.replace(/(?!\n$)\n/g,"\n"+e)},Blockly.Generator.prototype.allNestedComments=function(t){var e=[];t=t.getDescendants();for(var o=0;o<t.length;o++){var n=t[o].getCommentText();n&&e.push(n)}return e.length&&e.push(""),e.join("\n")},Blockly.Generator.prototype.blockToCode=function(t){if(!t)return"";if(t.disabled)return this.blockToCode(t.getNextBlock());var e=this[t.type];if(goog.asserts.assertFunction(e,'Language "%s" does not know how to generate code for block type "%s".',this.name_,t.type),e=e.call(t,t),goog.isArray(e))return goog.asserts.assert(t.outputConnection,'Expecting string from statement block "%s".',t.type),[this.scrub_(t,e[0]),e[1]];if(goog.isString(e)){var o=t.id.replace(/\$/g,"$$$$");return this.STATEMENT_PREFIX&&(e=this.STATEMENT_PREFIX.replace(/%1/g,"'"+o+"'")+e),this.scrub_(t,e)}if(null===e)return"";goog.asserts.fail("Invalid code generated: %s",e)},Blockly.Generator.prototype.valueToCode=function(t,e,o){isNaN(o)&&goog.asserts.fail('Expecting valid order from block "%s".',t.type);var n=t.getInputTargetBlock(e);if(!n)return"";if(""===(e=this.blockToCode(n)))return"";if(goog.asserts.assertArray(e,'Expecting tuple from value block "%s".',n.type),t=e[0],e=e[1],isNaN(e)&&goog.asserts.fail('Expecting valid order from value block "%s".',n.type),!t)return"";n=!1;var i=Math.floor(o),r=Math.floor(e);if(i<=r&&(i!=r||0!=i&&99!=i))for(n=!0,i=0;i<this.ORDER_OVERRIDES.length;i++)if(this.ORDER_OVERRIDES[i][0]==o&&this.ORDER_OVERRIDES[i][1]==e){n=!1;break}return n&&(t="("+t+")"),t},Blockly.Generator.prototype.statementToCode=function(t,e){var o=t.getInputTargetBlock(e),n=this.blockToCode(o);return goog.asserts.assertString(n,'Expecting code from statement block "%s".',o&&o.type),n&&(n=this.prefixLines(n,this.INDENT)),n},Blockly.Generator.prototype.addLoopTrap=function(t,e){return e=e.replace(/\$/g,"$$$$"),this.INFINITE_LOOP_TRAP&&(t=this.INFINITE_LOOP_TRAP.replace(/%1/g,"'"+e+"'")+t),this.STATEMENT_PREFIX&&(t+=this.prefixLines(this.STATEMENT_PREFIX.replace(/%1/g,"'"+e+"'"),this.INDENT)),t},Blockly.Generator.prototype.RESERVED_WORDS_="",Blockly.Generator.prototype.addReservedWords=function(t){this.RESERVED_WORDS_+=t+","},Blockly.Generator.prototype.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",Blockly.Generator.prototype.provideFunction_=function(t,e){if(!this.definitions_[t]){var o=this.variableDB_.getDistinctName(t,Blockly.Procedures.NAME_TYPE);this.functionNames_[t]=o,o=e.join("\n").replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,o);for(var n;n!=o;)n=o,o=o.replace(/^(( {2})*) {2}/gm,"$1\0");o=o.replace(/\0/g,this.INDENT),this.definitions_[t]=o}return this.functionNames_[t]},Blockly.Generator.prototype.init=void 0,Blockly.Generator.prototype.scrub_=void 0,Blockly.Generator.prototype.finish=void 0,Blockly.Generator.prototype.scrubNakedValue=void 0,Blockly.Names=function(t,e){if(this.variablePrefix_=e||"",this.reservedDict_=Object.create(null),t)for(var o=t.split(","),n=0;n<o.length;n++)this.reservedDict_[o[n]]=!0;this.reset()},Blockly.Names.prototype.reset=function(){this.db_=Object.create(null),this.dbReverse_=Object.create(null)},Blockly.Names.prototype.getName=function(t,e){var o=t.toLowerCase()+"_"+e,n=e==Blockly.Variables.NAME_TYPE?this.variablePrefix_:"";if(o in this.db_)return n+this.db_[o];var i=this.getDistinctName(t,e);return this.db_[o]=i.substr(n.length),i},Blockly.Names.prototype.getDistinctName=function(t,e){for(var o=this.safeName_(t),n="";this.dbReverse_[o+n]||o+n in this.reservedDict_;)n=n?n+1:2;return o+=n,this.dbReverse_[o]=!0,(e==Blockly.Variables.NAME_TYPE?this.variablePrefix_:"")+o},Blockly.Names.prototype.safeName_=function(t){return t?(t=encodeURI(t.replace(/ /g,"_")).replace(/[^\w]/g,"_"),-1!="0123456789".indexOf(t[0])&&(t="my_"+t)):t="unnamed",t},Blockly.Names.equals=function(t,e){return t.toLowerCase()==e.toLowerCase()},Blockly.Procedures={},Blockly.Procedures.NAME_TYPE=Blockly.PROCEDURE_CATEGORY_NAME,Blockly.Procedures.allProcedures=function(t){t=t.getAllBlocks();for(var e=[],o=[],n=0;n<t.length;n++)if(t[n].getProcedureDef){var i=t[n].getProcedureDef();i&&(i[2]?e.push(i):o.push(i))}return o.sort(Blockly.Procedures.procTupleComparator_),e.sort(Blockly.Procedures.procTupleComparator_),[o,e]},Blockly.Procedures.procTupleComparator_=function(t,e){return t[0].toLowerCase().localeCompare(e[0].toLowerCase())},Blockly.Procedures.findLegalName=function(t,e){if(e.isInFlyout)return t;for(;!Blockly.Procedures.isLegalName_(t,e.workspace,e);){var o=t.match(/^(.*?)(\d+)$/);t=o?o[1]+(parseInt(o[2],10)+1):t+"2"}return t},Blockly.Procedures.isLegalName_=function(t,e,o){return!Blockly.Procedures.isNameUsed(t,e,o)},Blockly.Procedures.isNameUsed=function(t,e,o){e=e.getAllBlocks();for(var n=0;n<e.length;n++)if(e[n]!=o&&e[n].getProcedureDef){var i=e[n].getProcedureDef();if(Blockly.Names.equals(i[0],t))return!1}return!0},Blockly.Procedures.rename=function(t){t=t.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"");var e=Blockly.Procedures.findLegalName(t,this.sourceBlock_),o=this.text_;if(o!=t&&o!=e){t=this.sourceBlock_.workspace.getAllBlocks();for(var n=0;n<t.length;n++)t[n].renameProcedure&&t[n].renameProcedure(o,e)}return e},Blockly.Procedures.flyoutCategory=function(t){function e(t,e){for(var n=0;n<t.length;n++){var i=t[n][0],r=t[n][1],s=goog.dom.createDom("block");s.setAttribute("type",e),s.setAttribute("gap",16);var a=goog.dom.createDom("mutation");for(a.setAttribute("name",i),s.appendChild(a),i=0;i<r.length;i++){var l=goog.dom.createDom("arg");l.setAttribute("name",r[i]),a.appendChild(l)}o.push(s)}}var o=[];if(Blockly.Blocks.procedures_defnoreturn){var n=goog.dom.createDom("block");n.setAttribute("type","procedures_defnoreturn"),n.setAttribute("gap",16);var i=goog.dom.createDom("field",null,Blockly.Msg.PROCEDURES_DEFNORETURN_PROCEDURE);i.setAttribute("name","NAME"),n.appendChild(i),o.push(n)}return Blockly.Blocks.procedures_defreturn&&(n=goog.dom.createDom("block"),n.setAttribute("type","procedures_defreturn"),n.setAttribute("gap",16),i=goog.dom.createDom("field",null,Blockly.Msg.PROCEDURES_DEFRETURN_PROCEDURE),i.setAttribute("name","NAME"),n.appendChild(i),o.push(n)),Blockly.Blocks.procedures_report&&(n=goog.dom.createDom("block"),n.setAttribute("type","procedures_report"),n.setAttribute("gap",16),o.push(n)),o.length&&o[o.length-1].setAttribute("gap",24),t=Blockly.Procedures.allProcedures(t),e(t[0],"procedures_callnoreturn"),e(t[1],"procedures_callreturn"),o},Blockly.Procedures.getCallers=function(t,e){for(var o=[],n=e.getAllBlocks(),i=0;i<n.length;i++)if(n[i].getProcedureCall){var r=n[i].getProcedureCall();r&&Blockly.Names.equals(r,t)&&o.push(n[i])}return o},Blockly.Procedures.mutateCallers=function(t){var e=Blockly.Events.recordUndo,o=t.getProcedureDef()[0],n=t.mutationToDom(!0);t=Blockly.Procedures.getCallers(o,t.workspace),o=0;for(var i;i=t[o];o++){var r=i.mutationToDom();r=r&&Blockly.Xml.domToText(r),i.domToMutation(n);var s=i.mutationToDom();s=s&&Blockly.Xml.domToText(s),r!=s&&(Blockly.Events.recordUndo=!1,Blockly.Events.fire(new Blockly.Events.BlockChange(i,"mutation",null,r,s)),Blockly.Events.recordUndo=e)}},Blockly.Procedures.getDefinition=function(t,e){for(var o=e.getTopBlocks(!1),n=0;n<o.length;n++)if(o[n].getProcedureDef){var i=o[n].getProcedureDef();if(i&&Blockly.Names.equals(i[0],t))return o[n]}return null},Blockly.FlyoutButton=function(t,e,o,n){this.workspace_=t,this.targetWorkspace_=e,this.text_=o.getAttribute("text"),this.position_=new goog.math.Coordinate(0,0),this.isLabel_=n,this.callback_=null,t=o.getAttribute("callbackKey"),this.isLabel_&&t?console.warn("Labels should not have callbacks. Label text: "+this.text_):this.isLabel_||t&&e.getButtonCallback(t)?this.callback_=e.getButtonCallback(t):console.warn("Buttons should have callbacks. Button text: "+this.text_),this.cssClass_=o.getAttribute("web-class")||null},Blockly.FlyoutButton.MARGIN=40,Blockly.FlyoutButton.prototype.width=0,Blockly.FlyoutButton.prototype.height=40,Blockly.FlyoutButton.prototype.onMouseUpWrapper_=null,Blockly.FlyoutButton.prototype.createDom=function(){var t,e=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";this.cssClass_&&(e+=" "+this.cssClass_),this.svgGroup_=Blockly.utils.createSvgElement("g",{class:e},this.workspace_.getCanvas()),this.isLabel_||(t=Blockly.utils.createSvgElement("rect",{class:"blocklyFlyoutButtonShadow",rx:4,ry:4,x:1,y:1},this.svgGroup_)),e=Blockly.utils.createSvgElement("rect",{class:this.isLabel_?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:4,ry:4},this.svgGroup_);var o=Blockly.utils.createSvgElement("text",{class:this.isLabel_?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup_);return o.textContent=this.text_,this.width=o.getComputedTextLength()+2*Blockly.FlyoutButton.MARGIN,this.isLabel_||(t.setAttribute("width",this.width),t.setAttribute("height",this.height)),e.setAttribute("width",this.width),e.setAttribute("height",this.height),o.setAttribute("text-anchor","middle"),o.setAttribute("alignment-baseline","central"),o.setAttribute("x",this.width/2),o.setAttribute("y",this.height/2),this.updateTransform_(),this.mouseUpWrapper_=Blockly.bindEventWithChecks_(this.svgGroup_,"mouseup",this,this.onMouseUp_),this.svgGroup_},Blockly.FlyoutButton.prototype.show=function(){this.updateTransform_(),this.svgGroup_.setAttribute("display","block")},Blockly.FlyoutButton.prototype.updateTransform_=function(){this.svgGroup_.setAttribute("transform","translate("+this.position_.x+","+this.position_.y+")")},Blockly.FlyoutButton.prototype.moveTo=function(t,e){this.position_.x=t,this.position_.y=e,this.updateTransform_()},Blockly.FlyoutButton.prototype.getTargetWorkspace=function(){return this.targetWorkspace_},Blockly.FlyoutButton.prototype.dispose=function(){this.onMouseUpWrapper_&&Blockly.unbindEvent_(this.onMouseUpWrapper_),this.svgGroup_&&(goog.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.targetWorkspace_=this.workspace_=null},Blockly.FlyoutButton.prototype.onMouseUp_=function(t){(t=this.targetWorkspace_.getGesture(t))&&t.cancel(),this.callback_&&this.callback_(this)},Blockly.Flyout=function(t){t.getMetrics=this.getMetrics_.bind(this),t.setMetrics=this.setMetrics_.bind(this),this.workspace_=new Blockly.WorkspaceSvg(t),this.workspace_.isFlyout=!0,this.RTL=!!t.RTL,this.horizontalLayout_=t.horizontalLayout,this.toolboxPosition_=t.toolboxPosition,this.eventWrappers_=[],this.backgroundButtons_=[],this.buttons_=[],this.listeners_=[],this.permanentlyDisabled_=[],this.parentToolbox_=null},Blockly.Flyout.prototype.autoClose=!0,Blockly.Flyout.prototype.isVisible_=!1,Blockly.Flyout.prototype.containerVisible_=!0,Blockly.Flyout.prototype.CORNER_RADIUS=0,Blockly.Flyout.prototype.MARGIN=12,Blockly.Flyout.prototype.GAP_X=3*Blockly.Flyout.prototype.MARGIN,Blockly.Flyout.prototype.GAP_Y=Blockly.Flyout.prototype.MARGIN,Blockly.Flyout.prototype.SCROLLBAR_PADDING=2,Blockly.Flyout.prototype.width_=0,Blockly.Flyout.prototype.height_=0,Blockly.Flyout.prototype.contentWidth_=0,Blockly.Flyout.prototype.contentHeight_=0,Blockly.Flyout.prototype.verticalOffset_=0,Blockly.Flyout.prototype.dragAngleRange_=70,Blockly.Flyout.prototype.createDom=function(t){return this.svgGroup_=Blockly.utils.createSvgElement(t,{class:"blocklyFlyout",style:"display: none"},null),this.svgBackground_=Blockly.utils.createSvgElement("path",{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.svgGroup_},Blockly.Flyout.prototype.init=function(t){this.targetWorkspace_=t,this.workspace_.targetWorkspace=t,this.scrollbar_=new Blockly.Scrollbar(this.workspace_,this.horizontalLayout_,!1,"blocklyFlyoutScrollbar"),this.position(),Array.prototype.push.apply(this.eventWrappers_,Blockly.bindEventWithChecks_(this.svgGroup_,"wheel",this,this.wheel_)),Array.prototype.push.apply(this.eventWrappers_,Blockly.bindEventWithChecks_(this.svgGroup_,"mousedown",this,this.onMouseDown_)),this.workspace_.getGesture=this.targetWorkspace_.getGesture.bind(this.targetWorkspace_),this.workspace_.getVariable=this.targetWorkspace_.getVariable.bind(this.targetWorkspace_),this.workspace_.getVariableById=this.targetWorkspace_.getVariableById.bind(this.targetWorkspace_),this.workspace_.getVariablesOfType=this.targetWorkspace_.getVariablesOfType.bind(this.targetWorkspace_),this.workspace_.deleteVariable=this.targetWorkspace_.deleteVariable.bind(this.targetWorkspace_),this.workspace_.deleteVariableById=this.targetWorkspace_.deleteVariableById.bind(this.targetWorkspace_),this.workspace_.renameVariable=this.targetWorkspace_.renameVariable.bind(this.targetWorkspace_),this.workspace_.renameVariableById=this.targetWorkspace_.renameVariableById.bind(this.targetWorkspace_)},Blockly.Flyout.prototype.dispose=function(){this.hide(),Blockly.unbindEvent_(this.eventWrappers_),this.scrollbar_&&(this.scrollbar_.dispose(),this.scrollbar_=null),this.workspace_&&(this.workspace_.targetWorkspace=null,this.workspace_.dispose(),this.workspace_=null),this.svgGroup_&&(goog.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.targetWorkspace_=this.svgBackground_=this.parentToolbox_=null},Blockly.Flyout.prototype.setParentToolbox=function(t){this.parentToolbox_=t},Blockly.Flyout.prototype.getWidth=function(){return this.parentToolbox_?this.parentToolbox_.getWidth():this.DEFAULT_WIDTH},Blockly.Flyout.prototype.getHeight=function(){return this.height_},Blockly.Flyout.prototype.getWorkspace=function(){return this.workspace_},Blockly.Flyout.prototype.isVisible=function(){return this.isVisible_},Blockly.Flyout.prototype.setVisible=function(t){var e=t!=this.isVisible();this.isVisible_=t,e&&this.updateDisplay_()},Blockly.Flyout.prototype.setContainerVisible=function(t){var e=t!=this.containerVisible_;this.containerVisible_=t,e&&this.updateDisplay_()},Blockly.Flyout.prototype.updateDisplay_=function(){var t=!!this.containerVisible_&&this.isVisible();this.svgGroup_.style.display=t?"block":"none",this.scrollbar_.setContainerVisible(t)},Blockly.Flyout.prototype.hide=function(){if(this.isVisible()){this.setVisible(!1);for(var t,e=0;t=this.listeners_[e];e++)Blockly.unbindEvent_(t);this.listeners_.length=0,this.reflowWrapper_&&(this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowWrapper_=null)}},Blockly.Flyout.prototype.show=function(t){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks_(),"string"==typeof t&&(t=this.workspace_.targetWorkspace.getToolboxCategoryCallback(t),goog.asserts.assert(goog.isFunction(t),"Couldn't find a callback function when opening a toolbox category."),t=t(this.workspace_.targetWorkspace),goog.asserts.assert(goog.isArray(t),"The result of a toolbox category callback must be an array.")),this.setVisible(!0);for(var e,o=[],n=[],i=this.permanentlyDisabled_.length=0;e=t[i];i++)if(e.tagName){var r=e.tagName.toUpperCase(),s=this.horizontalLayout_?this.GAP_X:this.GAP_Y;"BLOCK"==r?(r=Blockly.Xml.domToBlock(e,this.workspace_),r.disabled&&this.permanentlyDisabled_.push(r),o.push({type:"block",block:r}),e=parseInt(e.getAttribute("gap"),10),n.push(isNaN(e)?s:e)):"SEP"==e.tagName.toUpperCase()?(e=parseInt(e.getAttribute("gap"),10),!isNaN(e)&&0<n.length?n[n.length-1]=e:n.push(s)):"BUTTON"!=r&&"LABEL"!=r||(e=new Blockly.FlyoutButton(this.workspace_,this.targetWorkspace_,e,"LABEL"==r),o.push({type:"button",button:e}),n.push(s))}this.layout_(o,n),this.listeners_.push(Blockly.bindEvent_(this.svgBackground_,"mouseover",this,function(){for(var t,e=this.workspace_.getTopBlocks(!1),o=0;t=e[o];o++)t.removeSelect()})),this.workspace_.setResizesEnabled(!0),this.reflow(),this.position(),this.reflowWrapper_=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper_)},Blockly.Flyout.prototype.clearOldBlocks_=function(){for(var t,e=this.workspace_.getTopBlocks(!1),o=0;t=e[o];o++)t.workspace==this.workspace_&&t.dispose(!1,!1);for(o=0;e=this.backgroundButtons_[o];o++)goog.dom.removeNode(e);for(o=this.backgroundButtons_.length=0;e=this.buttons_[o];o++)e.dispose();this.buttons_.length=0},Blockly.Flyout.prototype.addBlockListeners_=function(t,e,o){this.autoClose?(this.listeners_.push(Blockly.bindEventWithChecks_(t,"mousedown",null,this.createBlockFunc_(e))),this.listeners_.push(Blockly.bindEventWithChecks_(o,"mousedown",null,this.createBlockFunc_(e)))):(this.listeners_.push(Blockly.bindEventWithChecks_(t,"mousedown",null,this.blockMouseDown_(e))),this.listeners_.push(Blockly.bindEventWithChecks_(o,"mousedown",null,this.blockMouseDown_(e)))),this.listeners_.push(Blockly.bindEvent_(t,"mouseover",e,e.addSelect)),this.listeners_.push(Blockly.bindEvent_(t,"mouseout",e,e.removeSelect)),this.listeners_.push(Blockly.bindEvent_(o,"mouseover",e,e.addSelect)),this.listeners_.push(Blockly.bindEvent_(o,"mouseout",e,e.removeSelect))},Blockly.Flyout.prototype.blockMouseDown_=function(t){var e=this;return function(o){var n=e.targetWorkspace_.getGesture(o);n&&(n.setStartBlock(t),n.handleFlyoutStart(o,e))}},Blockly.Flyout.prototype.onMouseDown_=function(t){var e=this.targetWorkspace_.getGesture(t);e&&e.handleFlyoutStart(t,this)},Blockly.Flyout.prototype.createBlock=function(t){var e=null;Blockly.Events.disable(),this.targetWorkspace_.setResizesEnabled(!1);try{if(e=this.placeNewBlock_(t),goog.userAgent.IE||goog.userAgent.EDGE)for(var o=e.getDescendants(),n=o.length-1;0<=n;n--)o[n].render(!1);Blockly.hideChaff()}finally{Blockly.Events.enable()}return Blockly.Events.isEnabled()&&(Blockly.Events.setGroup(!0),Blockly.Events.fire(new Blockly.Events.Create(e))),this.autoClose&&this.hide(),e},Blockly.Flyout.prototype.reflow=function(){this.reflowWrapper_&&this.workspace_.removeChangeListener(this.reflowWrapper_);var t=this.workspace_.getTopBlocks(!1);this.reflowInternal_(t),this.reflowWrapper_&&this.workspace_.addChangeListener(this.reflowWrapper_)},Blockly.Flyout.prototype.isScrollable=function(){return!!this.scrollbar_&&this.scrollbar_.isVisible()},Blockly.Flyout.prototype.placeNewBlock_=function(t){var e=this.targetWorkspace_;if(!t.getSvgRoot())throw"oldBlock is not rendered.";var o=Blockly.Xml.blockToDom(t);if(e.setResizesEnabled(!1),o=Blockly.Xml.domToBlock(o,e),!o.getSvgRoot())throw"block is not rendered.";var n=e.getOriginOffsetInPixels(),i=this.workspace_.getOriginOffsetInPixels();return t=t.getRelativeToSurfaceXY().scale(this.workspace_.scale),t=goog.math.Coordinate.sum(i,t),e=goog.math.Coordinate.difference(t,n).scale(1/e.scale),o.moveBy(e.x,e.y),o},Blockly.HorizontalFlyout=function(t){t.getMetrics=this.getMetrics_.bind(this),t.setMetrics=this.setMetrics_.bind(this),Blockly.HorizontalFlyout.superClass_.constructor.call(this,t),this.horizontalLayout_=!0},goog.inherits(Blockly.HorizontalFlyout,Blockly.Flyout),Blockly.HorizontalFlyout.prototype.getMetrics_=function(){if(!this.isVisible())return null;try{var t=this.workspace_.getCanvas().getBBox()}catch(e){t={height:0,y:0,width:0,x:0}}var e=this.SCROLLBAR_PADDING,o=this.SCROLLBAR_PADDING;this.toolboxPosition_==Blockly.TOOLBOX_AT_BOTTOM&&(e=0);var n=this.height_;return this.toolboxPosition_==Blockly.TOOLBOX_AT_TOP&&(n+=this.MARGIN),{viewHeight:n,viewWidth:this.width_-2*this.SCROLLBAR_PADDING,contentHeight:t.height*this.workspace_.scale+2*this.MARGIN,contentWidth:t.width*this.workspace_.scale+2*this.MARGIN,viewTop:-this.workspace_.scrollY,viewLeft:-this.workspace_.scrollX,contentTop:t.y,contentLeft:t.x,absoluteTop:e,absoluteLeft:o}},Blockly.HorizontalFlyout.prototype.setMetrics_=function(t){var e=this.getMetrics_();e&&(goog.isNumber(t.x)&&(this.workspace_.scrollX=-e.contentWidth*t.x),this.workspace_.translate(this.workspace_.scrollX+e.absoluteLeft,this.workspace_.scrollY+e.absoluteTop))},Blockly.HorizontalFlyout.prototype.position=function(){if(this.isVisible()){var t=this.targetWorkspace_.getMetrics();if(t){this.setBackgroundPath_(this.horizontalLayout_?t.viewWidth-2*this.CORNER_RADIUS:this.width_-this.CORNER_RADIUS,this.horizontalLayout_?this.height_-this.CORNER_RADIUS:t.viewHeight-2*this.CORNER_RADIUS);var e=t.absoluteLeft;this.toolboxPosition_==Blockly.TOOLBOX_AT_RIGHT&&(e+=t.viewWidth,e-=this.width_);var o=t.absoluteTop;this.toolboxPosition_==Blockly.TOOLBOX_AT_BOTTOM&&(o+=t.viewHeight,o-=this.height_),this.horizontalLayout_?this.width_=t.viewWidth:this.height_=t.viewHeight,this.svgGroup_.setAttribute("width",this.width_),this.svgGroup_.setAttribute("height",this.height_),Blockly.utils.setCssTransform(this.svgGroup_,"translate("+e+"px,"+o+"px)"),this.scrollbar_&&(this.scrollbar_.setOrigin(e,o),this.scrollbar_.resize()),this.svgGroup_.style.opacity=1}}},Blockly.HorizontalFlyout.prototype.setBackgroundPath_=function(t,e){var o=this.toolboxPosition_==Blockly.TOOLBOX_AT_TOP,n=["M 0,"+(o?0:this.CORNER_RADIUS)];o?(n.push("h",t+2*this.CORNER_RADIUS),n.push("v",e),n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),n.push("h",-1*t),n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),n.push("h",t),n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),n.push("v",e),n.push("h",-t-2*this.CORNER_RADIUS)),n.push("z"),this.svgBackground_.setAttribute("d",n.join(" "))},Blockly.HorizontalFlyout.prototype.scrollToStart=function(){this.scrollbar_.set(this.RTL?1/0:0)},Blockly.HorizontalFlyout.prototype.wheel_=function(t){var e=t.deltaX;if(e){goog.userAgent.GECKO&&(e*=10);var o=this.getMetrics_();e=o.viewLeft+e,e=Math.min(e,o.contentWidth-o.viewWidth),e=Math.max(e,0),this.scrollbar_.set(e),Blockly.WidgetDiv.hide(!0),Blockly.DropDownDiv.hideWithoutAnimation()}t.preventDefault(),t.stopPropagation()},Blockly.HorizontalFlyout.prototype.layout_=function(t,e){this.workspace_.scale=this.targetWorkspace_.scale;var o=this.MARGIN,n=o;this.RTL&&(t=t.reverse());for(var i,r=0;i=t[r];r++)if("block"==i.type){i=i.block;for(var s,a=i.getDescendants(),l=0;s=a[l];l++)s.isInFlyout=!0;a=i.getSvgRoot(),l=i.getHeightWidth(),s=n,this.RTL&&(s+=l.width),i.moveBy(s,o),n+=l.width+e[r],l=Blockly.utils.createSvgElement("rect",{"fill-opacity":0},null),l.tooltip=i,Blockly.Tooltip.bindMouseEvents(l),this.workspace_.getCanvas().insertBefore(l,i.getSvgRoot()),i.flyoutRect_=l,this.backgroundButtons_[r]=l,this.addBlockListeners_(a,i,l)}else"button"==i.type&&(i=i.button,a=i.createDom(),i.moveTo(n,o),i.show(),this.listeners_.push(Blockly.bindEventWithChecks_(a,"mousedown",this,this.onMouseDown_)),this.buttons_.push(i),n+=i.width+e[r])};Blockly.HorizontalFlyout.prototype.isDragTowardWorkspace=function(t){t=Math.atan2(t.y,t.x)/Math.PI*180;var e=!1,o=this.dragAngleRange_;return this.toolboxPosition_==Blockly.TOOLBOX_AT_TOP?t<90+o&&t>90-o&&(e=!0):t>-90-o&&t<-90+o&&(e=!0),e},Blockly.HorizontalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var t=this.svgGroup_.getBoundingClientRect(),e=t.top;return t=t.height,this.toolboxPosition_==Blockly.TOOLBOX_AT_TOP?new goog.math.Rect(-1e9,e-1e9,2e9,1e9+t):this.toolboxPosition_==Blockly.TOOLBOX_AT_BOTTOM?new goog.math.Rect(-1e9,e,2e9,1e9+t):void 0},Blockly.HorizontalFlyout.prototype.reflowInternal_=function(t){this.workspace_.scale=this.targetWorkspace_.scale;for(var e,o=0,n=0;e=t[n];n++)o=Math.max(o,e.getHeightWidth().height);if(o+=1.5*this.MARGIN,o*=this.workspace_.scale,o+=Blockly.Scrollbar.scrollbarThickness,this.height_!=o){for(n=0;e=t[n];n++){var i=e.getHeightWidth();if(e.flyoutRect_){e.flyoutRect_.setAttribute("width",i.width),e.flyoutRect_.setAttribute("height",i.height);var r=e.getRelativeToSurfaceXY();e.flyoutRect_.setAttribute("y",r.y),e.flyoutRect_.setAttribute("x",this.RTL?r.x-i.width:r.x),(i=e.startHat_?Blockly.BlockSvg.START_HAT_HEIGHT:0)&&e.moveBy(0,i),e.flyoutRect_.setAttribute("y",r.y)}}this.height_=o,this.targetWorkspace_.resize()}},Blockly.VerticalFlyout=function(t){t.getMetrics=this.getMetrics_.bind(this),t.setMetrics=this.setMetrics_.bind(this),Blockly.VerticalFlyout.superClass_.constructor.call(this,t),this.horizontalLayout_=!1,this.checkboxes_=[]},goog.inherits(Blockly.VerticalFlyout,Blockly.Flyout),Blockly.VerticalFlyout.prototype.autoClose=!1,Blockly.VerticalFlyout.prototype.DEFAULT_WIDTH=250,Blockly.VerticalFlyout.prototype.CHECKBOX_SIZE=20,Blockly.VerticalFlyout.prototype.CHECKMARK_PATH="M"+Blockly.VerticalFlyout.prototype.CHECKBOX_SIZE/4+" "+Blockly.VerticalFlyout.prototype.CHECKBOX_SIZE/2+"L"+5*Blockly.VerticalFlyout.prototype.CHECKBOX_SIZE/12+" "+2*Blockly.VerticalFlyout.prototype.CHECKBOX_SIZE/3+"L"+3*Blockly.VerticalFlyout.prototype.CHECKBOX_SIZE/4+" "+Blockly.VerticalFlyout.prototype.CHECKBOX_SIZE/3,Blockly.VerticalFlyout.prototype.CHECKBOX_CORNER_RADIUS=5,Blockly.VerticalFlyout.prototype.CHECKBOX_MARGIN=Blockly.Flyout.prototype.MARGIN,Blockly.VerticalFlyout.prototype.CHECKBOX_SPACE_X=Blockly.VerticalFlyout.prototype.CHECKBOX_SIZE+2*Blockly.VerticalFlyout.prototype.CHECKBOX_MARGIN,Blockly.VerticalFlyout.prototype.init=function(t){Blockly.VerticalFlyout.superClass_.init.call(this,t),this.workspace_.scale=t.scale},Blockly.VerticalFlyout.prototype.createDom=function(t){return Blockly.VerticalFlyout.superClass_.createDom.call(this,t),this.defs_=Blockly.utils.createSvgElement("defs",{},this.svgGroup_),t=Blockly.utils.createSvgElement("clipPath",{id:"blocklyBlockMenuClipPath"},this.defs_),this.clipRect_=Blockly.utils.createSvgElement("rect",{id:"blocklyBlockMenuClipRect",height:"0",width:"0",y:"0",x:"0"},t),this.workspace_.svgGroup_.setAttribute("clip-path","url(#blocklyBlockMenuClipPath)"),this.svgGroup_},Blockly.VerticalFlyout.prototype.getMetrics_=function(){if(!this.isVisible())return null;try{var t=this.workspace_.getCanvas().getBBox()}catch(e){t={height:0,y:0,width:0,x:0}}var e=this.SCROLLBAR_PADDING;return{viewHeight:this.height_-2*this.SCROLLBAR_PADDING,viewWidth:this.getWidth()-this.SCROLLBAR_PADDING,contentHeight:t.height*this.workspace_.scale+2*this.MARGIN,contentWidth:t.width*this.workspace_.scale+2*this.MARGIN,viewTop:-this.workspace_.scrollY+t.y,viewLeft:-this.workspace_.scrollX,contentTop:t.y,contentLeft:t.x,absoluteTop:e,absoluteLeft:0}},Blockly.VerticalFlyout.prototype.setMetrics_=function(t){var e=this.getMetrics_();e&&(goog.isNumber(t.y)&&(this.workspace_.scrollY=-e.contentHeight*t.y),this.workspace_.translate(this.workspace_.scrollX+e.absoluteLeft,this.workspace_.scrollY+e.absoluteTop),this.clipRect_.setAttribute("height",Math.max(0,e.viewHeight)+"px"),this.clipRect_.setAttribute("width",e.viewWidth+"px"))},Blockly.VerticalFlyout.prototype.position=function(){if(this.isVisible()){var t=this.targetWorkspace_.getMetrics();if(t){if(this.width_=this.getWidth(),this.parentToolbox_)var e=this.parentToolbox_.HtmlDiv.offsetLeft,o=this.parentToolbox_.HtmlDiv.offsetTop+this.parentToolbox_.getHeight();else e=this.toolboxPosition_==Blockly.TOOLBOX_AT_RIGHT?t.viewWidth-this.width_:0,o=0;this.height_=Math.max(0,t.viewHeight-o),this.setBackgroundPath_(this.width_,this.height_),this.svgGroup_.setAttribute("width",this.width_),this.svgGroup_.setAttribute("height",this.height_),Blockly.utils.setCssTransform(this.svgGroup_,"translate("+e+"px,"+o+"px)"),this.scrollbar_&&(this.scrollbar_.setOrigin(e,o),this.scrollbar_.resize()),this.svgGroup_.style.opacity=1}}},Blockly.VerticalFlyout.prototype.setBackgroundPath_=function(t,e){var o=this.toolboxPosition_==Blockly.TOOLBOX_AT_RIGHT,n=["M 0,0"];n.push("h",t),n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,o?0:1,o?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),n.push("v",Math.max(0,e-2*this.CORNER_RADIUS)),n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,o?0:1,o?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),n.push("h",-t),n.push("z"),this.svgBackground_.setAttribute("d",n.join(" "))},Blockly.VerticalFlyout.prototype.scrollToStart=function(){this.scrollbar_.set(0)},Blockly.VerticalFlyout.prototype.wheel_=function(t){var e=t.deltaY;if(e){goog.userAgent.GECKO&&(e*=10);var o=this.getMetrics_();e=-this.workspace_.scrollY+e,e=Math.min(e,o.contentHeight-o.viewHeight),e=Math.max(e,0),this.scrollbar_.set(e),Blockly.WidgetDiv.hide(!0),Blockly.DropDownDiv.hideWithoutAnimation()}t.preventDefault(),t.stopPropagation()},Blockly.VerticalFlyout.prototype.clearOldBlocks_=function(){Blockly.VerticalFlyout.superClass_.clearOldBlocks_.call(this);for(var t,e=0;t=this.checkboxes_[e];e++)t.block.flyoutCheckbox=null,goog.dom.removeNode(t.svgRoot);this.checkboxes_=[]},Blockly.VerticalFlyout.prototype.addBlockListeners_=function(t,e,o){Blockly.VerticalFlyout.superClass_.addBlockListeners_.call(this,t,e,o),e.flyoutCheckbox&&this.listeners_.push(Blockly.bindEvent_(e.flyoutCheckbox.svgRoot,"mousedown",null,this.checkboxClicked_(e.flyoutCheckbox)))},Blockly.VerticalFlyout.prototype.layout_=function(t,e){for(var o,n=this.MARGIN,i=this.getWidth()/this.workspace_.scale,r=n,s=0;o=t[s];s++)if("block"==o.type){o=o.block;for(var a,l=o.getDescendants(),c=0;a=l[c];c++)a.isInFlyout=!0;l=o.getSvgRoot(),c=o.getHeightWidth(),a=o.getRelativeToSurfaceXY().x;var u=i-this.MARGIN;a=this.RTL?u-a:n,o.hasCheckboxInFlyout()&&(this.createCheckbox_(o,n,r,c),a=this.RTL?a-(this.CHECKBOX_SIZE+this.CHECKBOX_MARGIN):a+(this.CHECKBOX_SIZE+this.CHECKBOX_MARGIN)),o.moveBy(a,r+(o.startHat_?Blockly.BlockSvg.START_HAT_HEIGHT:0)),a=this.createRect_(o,this.RTL?a-c.width:a,r,c,s),this.addBlockListeners_(l,o,a),r+=c.height+e[s]+(o.startHat_?Blockly.BlockSvg.START_HAT_HEIGHT:0)}else"button"==o.type&&(o=o.button,l=o.createDom(),o.moveTo(n,r),o.show(),this.listeners_.push(Blockly.bindEventWithChecks_(l,"mousedown",this,this.onMouseDown_)),this.buttons_.push(o),r+=o.height+e[s])},Blockly.VerticalFlyout.prototype.createRect_=function(t,e,o,n,i){return e=Blockly.utils.createSvgElement("rect",{"fill-opacity":0,x:e,y:o,height:n.height,width:n.width},null),e.tooltip=t,Blockly.Tooltip.bindMouseEvents(e),this.workspace_.getCanvas().insertBefore(e,t.getSvgRoot()),t.flyoutRect_=e,this.backgroundButtons_[i]=e},Blockly.VerticalFlyout.prototype.createCheckbox_=function(t,e,o,n){var i=Blockly.VerticalFlyout.getCheckboxState(t.id),r=t.getSvgRoot(),s=this.CHECKBOX_SIZE+this.CHECKBOX_MARGIN;e=this.RTL?this.getWidth()/this.workspace_.scale-s:e,o=Blockly.utils.createSvgElement("g",{class:"blocklyFlyoutCheckbox",transform:"translate("+e+", "+(o+n.height/2-this.CHECKBOX_SIZE/2)+")"},null),Blockly.utils.createSvgElement("rect",{height:this.CHECKBOX_SIZE,width:this.CHECKBOX_SIZE,rx:this.CHECKBOX_CORNER_RADIUS,ry:this.CHECKBOX_CORNER_RADIUS},o),Blockly.utils.createSvgElement("path",{class:"blocklyFlyoutCheckboxPath",d:this.CHECKMARK_PATH},o),n={svgRoot:o,clicked:i,block:t},i&&Blockly.utils.addClass(n.svgRoot,"checked"),t.flyoutCheckbox=n,this.workspace_.getCanvas().insertBefore(o,r),this.checkboxes_.push(n)},Blockly.VerticalFlyout.prototype.checkboxClicked_=function(t){return function(e){this.setCheckboxState(t.block.id,!t.clicked),e.stopPropagation(),e.preventDefault()}.bind(this)},Blockly.VerticalFlyout.prototype.setCheckboxState=function(t,e){for(var o=0;o<this.checkboxes_.length;o++){var n=this.checkboxes_[o];if(n.block.id===t){if(n.clicked===e)break;o=n.clicked,n.clicked=e,n.clicked?Blockly.utils.addClass(n.svgRoot,"checked"):Blockly.utils.removeClass(n.svgRoot,"checked"),Blockly.Events.fire(new Blockly.Events.Change(n.block,"checkbox",null,o,e));break}}},Blockly.VerticalFlyout.prototype.isDragTowardWorkspace=function(t){t=Math.atan2(t.y,t.x)/Math.PI*180;var e=!1,o=this.dragAngleRange_;return this.toolboxPosition_==Blockly.TOOLBOX_AT_LEFT?t<o&&t>-o&&(e=!0):(t<-180+o||t>180-o)&&(e=!0),e},Blockly.VerticalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var t=this.svgGroup_.getBoundingClientRect(),e=t.left;return t=t.width,this.toolboxPosition_==Blockly.TOOLBOX_AT_LEFT?new goog.math.Rect(e-1e9,-1e9,1e9+t,2e9):new goog.math.Rect(e,-1e9,1e9+t,2e9)},Blockly.VerticalFlyout.prototype.reflowInternal_=function(){},Blockly.VerticalFlyout.getCheckboxState=function(){return!1},Blockly.Toolbox=function(t){this.workspace_=t,this.iconic_=!1,this.RTL=t.options.RTL,this.horizontalLayout_=t.options.horizontalLayout,this.toolboxPosition=t.options.toolboxPosition},Blockly.Toolbox.prototype.width=250,Blockly.Toolbox.prototype.height=0,Blockly.Toolbox.prototype.selectedItem_=null,Blockly.Toolbox.prototype.init=function(){var t=this.workspace_,e=this.workspace_.getParentSvg();this.HtmlDiv=goog.dom.createDom("DIV","blocklyToolboxDiv"),this.HtmlDiv.setAttribute("dir",t.RTL?"RTL":"LTR"),e.parentNode.insertBefore(this.HtmlDiv,e),Blockly.bindEventWithChecks_(this.HtmlDiv,"mousedown",this,function(t){Blockly.utils.isRightButton(t)||t.target==this.HtmlDiv?Blockly.hideChaff(!1):Blockly.hideChaff(!0),Blockly.Touch.clearTouchIdentifier()}),this.createFlyout_(),this.categoryMenu_=new Blockly.Toolbox.CategoryMenu(this,this.HtmlDiv),this.populate_(t.options.languageTree),this.position()},Blockly.Toolbox.prototype.dispose=function(){this.flyout_.dispose(),this.categoryMenu_.dispose(),this.categoryMenu_=null,goog.dom.removeNode(this.HtmlDiv),this.lastCategory_=this.workspace_=null},Blockly.Toolbox.prototype.createFlyout_=function(){var t=this.workspace_,e={disabledPatternId:t.options.disabledPatternId,parentWorkspace:t,RTL:t.RTL,oneBasedIndex:t.options.oneBasedIndex,horizontalLayout:t.horizontalLayout,toolboxPosition:t.options.toolboxPosition};this.flyout_=t.horizontalLayout?new Blockly.HorizontalFlyout(e):new Blockly.VerticalFlyout(e),this.flyout_.setParentToolbox(this),goog.dom.insertSiblingAfter(this.flyout_.createDom("svg"),this.workspace_.getParentSvg()),this.flyout_.init(t)},Blockly.Toolbox.prototype.populate_=function(t){this.categoryMenu_.populate(t),this.setSelectedItem(this.categoryMenu_.categories_[0])},Blockly.Toolbox.prototype.getWidth=function(){return this.width},Blockly.Toolbox.prototype.getHeight=function(){return this.categoryMenu_?this.categoryMenu_.getHeight():0},Blockly.Toolbox.prototype.position=function(){var t=this.HtmlDiv;if(t){var e=this.workspace_.getParentSvg();e=Blockly.svgSize(e),this.horizontalLayout_?(t.style.left="0",t.style.height="auto",t.style.width=e.width+"px",this.height=t.offsetHeight,this.toolboxPosition==Blockly.TOOLBOX_AT_TOP?t.style.top="0":t.style.bottom="0"):(this.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT?t.style.right="0":t.style.left="0",t.style.height=this.getHeight()+"px",t.style.width=this.width+"px"),this.flyout_.position()}},Blockly.Toolbox.prototype.clearSelection=function(){this.setSelectedItem(null)},Blockly.Toolbox.prototype.addDeleteStyle=function(){Blockly.utils.addClass(this.HtmlDiv,"blocklyToolboxDelete")},Blockly.Toolbox.prototype.removeDeleteStyle=function(){Blockly.utils.removeClass(this.HtmlDiv,"blocklyToolboxDelete")},Blockly.Toolbox.prototype.getClientRect=function(){if(!this.HtmlDiv)return null;var t=this.HtmlDiv.getBoundingClientRect(),e=t.left,o=t.top,n=t.width;return t=t.height,this.toolboxPosition==Blockly.TOOLBOX_AT_LEFT?new goog.math.Rect(-1e7,-1e7,1e7+e+n,2e7):this.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT?new goog.math.Rect(e,-1e7,1e7+n,2e7):this.toolboxPosition==Blockly.TOOLBOX_AT_TOP?new goog.math.Rect(-1e7,-1e7,2e7,1e7+o+t):new goog.math.Rect(0,o,2e7,1e7+n)},Blockly.Toolbox.prototype.refreshSelection=function(){var t=this.getSelectedItem();t&&t.getContents()&&this.flyout_.show(t.getContents())},Blockly.Toolbox.prototype.getSelectedItem=function(){return this.selectedItem_},Blockly.Toolbox.prototype.setSelectedItem=function(t){if(this.selectedItem_){if(this.selectedItem_==t)return;this.selectedItem_.setSelected(!1)}this.selectedItem_=t,null!=this.selectedItem_&&(this.selectedItem_.setSelected(!0),this.flyout_.show(t.getContents()),this.flyout_.scrollToStart())},Blockly.Toolbox.prototype.setSelectedItemFactory=function(t){return function(){this.setSelectedItem(t),Blockly.Touch.clearTouchIdentifier()}},Blockly.Toolbox.CategoryMenu=function(t,e){this.parent_=t,this.height_=0,this.parentHtml_=e,this.createDom(),this.categories_=[]},Blockly.Toolbox.CategoryMenu.prototype.getHeight=function(){return this.height_},Blockly.Toolbox.CategoryMenu.prototype.createDom=function(){this.table=goog.dom.createDom("table","scratchCategoryMenu"),this.parentHtml_.appendChild(this.table)},Blockly.Toolbox.CategoryMenu.prototype.populate=function(t){if(t){this.dispose(),this.createDom();for(var e,o=[],n=0;e=t.childNodes[n];n++)e.tagName&&"CATEGORY"==e.tagName.toUpperCase()&&o.push(e);for(t=Math.ceil(o.length/2),n=0;n<t;n+=1){e=o[n];var i=goog.dom.createDom("tr","scratchCategoryMenuRow");this.table.appendChild(i),e&&this.categories_.push(new Blockly.Toolbox.Category(this,i,e)),o[n+t]&&this.categories_.push(new Blockly.Toolbox.Category(this,i,o[n+t]))}this.height_=this.table.offsetHeight}},Blockly.Toolbox.CategoryMenu.prototype.dispose=function(){for(var t,e=0;t=this.categories_[e];e++)t.dispose();this.categories_=[],this.table&&(goog.dom.removeNode(this.table),this.table=null)},Blockly.Toolbox.Category=function(t,e,o){this.parent_=t,this.parentHtml_=e,this.name_=o.getAttribute("name"),this.setColour(o),this.custom_=o.getAttribute("custom"),this.contents_=[],this.custom_||this.parseContents_(o),this.createDom()},Blockly.Toolbox.Category.prototype.dispose=function(){this.item_&&(goog.dom.removeNode(this.item_),this.item=null),this.contents_=this.parentHtml_=this.parent_=null},Blockly.Toolbox.Category.prototype.createDom=function(){var t=this.parent_.parent_;this.item_=goog.dom.createDom("td",{class:"scratchCategoryMenuItem"},this.name_),this.bubble_=goog.dom.createDom("div",{class:t.RTL?"scratchCategoryItemBubbleRTL":"scratchCategoryItemBubbleLTR"}),this.bubble_.style.backgroundColor=this.colour_,this.bubble_.style.borderColor=this.secondaryColour_,this.item_.appendChild(this.bubble_),this.parentHtml_.appendChild(this.item_),Blockly.bindEvent_(this.item_,"mousedown",t,t.setSelectedItemFactory(this))},Blockly.Toolbox.Category.prototype.setSelected=function(t){this.item_.className=t?"scratchCategoryMenuItem categorySelected":"scratchCategoryMenuItem"},Blockly.Toolbox.Category.prototype.parseContents_=function(t){for(var e,o=0;e=t.childNodes[o];o++)if(e.tagName)switch(e.tagName.toUpperCase()){case"BLOCK":case"SHADOW":case"LABEL":case"BUTTON":case"SEP":case"TEXT":this.contents_.push(e)}},Blockly.Toolbox.Category.prototype.getContents=function(){return this.custom_?this.custom_:this.contents_},Blockly.Toolbox.Category.prototype.setColour=function(t){var e=t.getAttribute("colour");t=t.getAttribute("secondaryColour"),goog.isString(e)?(e.match(/^#[0-9a-fA-F]{6}$/)?this.colour_=e:this.colour_=Blockly.hueToRgb(e),t.match(/^#[0-9a-fA-F]{6}$/)?this.secondaryColour_=t:this.secondaryColour_=Blockly.hueToRgb(t),this.hasColours_=!0):this.secondaryColour_=this.colour_="#000000"},Blockly.Css={},Blockly.Css.Cursor={OPEN:"handopen",CLOSED:"handclosed",DELETE:"handdelete"},Blockly.Css.currentCursor_="",Blockly.Css.styleSheet_=null,Blockly.Css.mediaPath_="",Blockly.Css.inject=function(t,e){if(!Blockly.Css.styleSheet_){var o=".blocklyDraggable {}\n";t&&(o+=Blockly.Css.CONTENT.join("\n"),Blockly.FieldDate&&(o+=Blockly.FieldDate.CSS.join("\n"))),Blockly.Css.mediaPath_=e.replace(/[\\\/]$/,""),o=o.replace(/<<<PATH>>>/g,Blockly.Css.mediaPath_);for(var n in Blockly.Colours)Blockly.Colours.hasOwnProperty(n)&&(o=o.replace(new RegExp("\\$colour\\_"+n,"g"),Blockly.Colours[n]));n=document.createElement("style"),document.head.insertBefore(n,document.head.firstChild),o=document.createTextNode(o),n.appendChild(o),Blockly.Css.styleSheet_=n.sheet}},Blockly.Css.setCursor=function(t){console.warn("Deprecated call to Blockly.Css.setCursor.See https://github.com/google/blockly/issues/981 for context")},Blockly.Css.CONTENT=[".blocklySvg {","background-color: $colour_workspace;","outline: none;","overflow: hidden;","position: absolute;","display: block;","}",".blocklyRelativeWrapper {","position: relative;","width: 100%;","height: 100%;","}",".blocklyWidgetDiv {","display: none;","position: absolute;","z-index: 99999;","}",".injectionDiv {","height: 100%;","position: relative;","overflow: hidden;","touch-action: none","}",".blocklyNonSelectable {","user-select: none;","-moz-user-select: none;","-webkit-user-select: none;","-ms-user-select: none;","}",".blocklyWidgetDiv.fieldTextInput {","overflow: hidden;","border: 1px solid;","box-sizing: border-box;","transform-origin: 0 0;","-ms-transform-origin: 0 0;","-moz-transform-origin: 0 0;","-webkit-transform-origin: 0 0;","}",".blocklyTextDropDownArrow {","position: absolute;","}",".blocklyNonSelectable {","user-select: none;","-moz-user-select: none;","-webkit-user-select: none;","-ms-user-select: none;","}",".blocklyWsDragSurface {","display: none;","position: absolute;","overflow: visible;","top: 0;","left: 0;","}",".blocklyBlockDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","right: 0;","bottom: 0;","overflow: visible !important;","z-index: 50;","}",".blocklyTooltipDiv {","background-color: #ffffc7;","border: 1px solid #ddc;","box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);","color: #000;","display: none;",'font-family: "Helvetica Neue", Helvetica, sans-serif;',"font-size: 9pt;","opacity: 0.9;","padding: 2px;","position: absolute;","z-index: 100000;","}",".blocklyDropDownDiv {","position: fixed;","left: 0;","top: 0;","z-index: 1000;","display: none;","border: 1px solid;","border-radius: 4px;","box-shadow: 0px 0px 8px 1px "+Blockly.Colours.dropDownShadow+";","padding: 4px;","-webkit-user-select: none;","}",".blocklyDropDownContent {","max-height: 300px;","overflow: auto;","}",".blocklyDropDownArrow {","position: absolute;","left: 0;","top: 0;","width: 16px;","height: 16px;","z-index: -1;","background-color: inherit;","border-color: inherit;","}",".blocklyDropDownButton {","display: inline-block;","float: left;","padding: 0;","margin: 4px;","border-radius: 4px;","outline: none;","border: 1px solid;","transition: box-shadow .1s;","cursor: pointer;","}",".blocklyDropDownButtonHover {","box-shadow: 0px 0px 0px 4px "+Blockly.Colours.fieldShadow+";","}",".blocklyDropDownButton:active {","box-shadow: 0px 0px 0px 6px "+Blockly.Colours.fieldShadow+";","}",".blocklyDropDownButton > img {","width: 80%;","height: 80%;","margin-top: 5%","}",".blocklyDropDownPlaceholder {","display: inline-block;","float: left;","padding: 0;","margin: 4px;","}",".blocklyNumPadButton {","display: inline-block;","float: left;","padding: 0;","width: 48px;","height: 48px;","margin: 4px;","border-radius: 4px;","background: $colour_numPadBackground;","color: $colour_numPadText;","outline: none;","border: 1px solid $colour_numPadBorder;","cursor: pointer;","font-weight: 600;",'font-family: "Helvetica Neue", Helvetica, sans-serif;',"font-size: 12pt;","-webkit-tap-highlight-color: rgba(0,0,0,0);","}",".blocklyNumPadButton > img {","margin-top: 10%;","width: 80%;","height: 80%;","}",".blocklyNumPadButton:active {","background: $colour_numPadActiveBackground;","-webkit-tap-highlight-color: rgba(0,0,0,0);","}",".arrowTop {","border-top: 1px solid;","border-left: 1px solid;","border-top-left-radius: 4px;","border-color: inherit;","}",".arrowBottom {","border-bottom: 1px solid;","border-right: 1px solid;","border-bottom-right-radius: 4px;","border-color: inherit;","}",".valueReportBox {","min-width: 50px;","max-width: 300px;","max-height: 200px;","overflow: auto;","word-wrap: break-word;","text-align: center;",'font-family: "Helvetica Neue", Helvetica, sans-serif;',"font-size: .8em;","}",".blocklyResizeSE {","cursor: se-resize;","fill: #aaa;","}",".blocklyResizeSW {","cursor: sw-resize;","fill: #aaa;","}",".blocklyResizeLine {","stroke: #888;","stroke-width: 1;","}",".blocklyHighlightedConnectionPath {","fill: none;","stroke: #fc3;","stroke-width: 4px;","}",".blocklyPath {","stroke-width: 1px;","}",".blocklySelected>.blocklyPath {","}",".blocklySelected>.blocklyPathLight {","display: none;","}",".blocklyDraggable {",'cursor: url("<<<PATH>>>/handopen.cur"), auto;',"cursor: grab;","cursor: -webkit-grab;","cursor: -moz-grab;","}",".blocklyDragging {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","cursor: -moz-grabbing;","}",".blocklyDraggable:active {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","cursor: -moz-grabbing;","}",".blocklyBlockDragSurface .blocklyDraggable {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","cursor: -moz-grabbing;","}",".blocklyDragging.blocklyDraggingDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyToolboxDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyDragging>.blocklyPath,",".blocklyDragging>.blocklyPathLight {","fill-opacity: 1.0;","stroke-opacity: 1.0;","}",".blocklyDragging>.blocklyPath {","}",".blocklyDisabled>.blocklyPath {","fill-opacity: .5;","stroke-opacity: .5;","}",".blocklyInsertionMarker>.blocklyPath {","stroke: none;","}",".blocklyText {","fill: #fff;",'font-family: "Helvetica Neue", Helvetica, sans-serif;',"font-size: 12pt;","font-weight: 500;","}",".blocklyTextTruncated {","font-size: 11pt;","}",".blocklyNonEditableText>text {","pointer-events: none;","}",".blocklyNonEditableText>text,",".blocklyEditableText>text {","fill: $colour_text;","}",".blocklyDropdownText {","fill: #fff !important;","}",".blocklyBubbleText {","fill: $colour_text;","}",".blocklyFlyout {","position: absolute;","z-index: 20;","}",".blocklyFlyout {","position: absolute;","z-index: 20;","}",".blocklyFlyoutButton {","fill: none;","}",".blocklyFlyoutButtonBackground {","stroke: #c6c6c6;","}",".blocklyFlyoutButton .blocklyText {","fill: $colour_text;","}",".blocklyFlyoutButtonShadow {","fill: none;","}",".blocklyFlyoutButton:hover {","fill: white;","cursor: pointer;","}",".blocklyFlyoutLabel {","cursor: default;","}",".blocklyFlyoutLabelBackground {","opacity: 0;","}",".blocklyFlyoutLabelText {","fill: #000;","}",".blocklySvg text, .blocklyBlockDragSurface text, .blocklyFlyout text, .blocklyToolboxDiv text {","user-select: none;","-moz-user-select: none;","-webkit-user-select: none;","cursor: inherit;","}",".blocklyHidden {","display: none;","}",".blocklyFieldDropdown:not(.blocklyHidden) {","display: block;","}",".blocklyIconGroup {","cursor: default;","}",".blocklyIconGroup:not(:hover),",".blocklyIconGroupReadonly {","opacity: .6;","}",".blocklyIconShape {","fill: #00f;","stroke: #fff;","stroke-width: 1px;","}",".blocklyIconSymbol {","fill: #fff;","}",".blocklyMinimalBody {","margin: 0;","padding: 0;","}",".blocklyCommentTextarea {","background-color: #ffc;","border: 0;","margin: 0;","padding: 2px;","resize: none;","}",".blocklyHtmlInput {","border: none;",'font-family: "Helvetica Neue", Helvetica, sans-serif;',"font-size: 12pt;","height: 100%;","margin: 0;","outline: none;","box-sizing: border-box;","width: 100%;","text-align: center;","color: $colour_text;","font-weight: 500;","}",".blocklyMainBackground {","stroke-width: 1;","stroke: #c6c6c6;","}",".blocklyMutatorBackground {","fill: #fff;","stroke: #ddd;","stroke-width: 1;","}",".blocklyFlyoutBackground {","fill: $colour_flyout;","fill-opacity: .8;","}",".blocklyMainWorkspaceScrollbar {","z-index: 20;","}",".blocklyFlyoutScrollbar {","z-index: 30;","}",".blocklyScrollbarHorizontal, .blocklyScrollbarVertical {","position: absolute;","outline: none;","}",".blocklyScrollbarBackground {","opacity: 0;","}",".blocklyScrollbarHandle {","fill: $colour_scrollbar;","}",".blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyScrollbarHandle:hover {","fill: $colour_scrollbarHover;","}",".blocklyZoom>image {","opacity: 1;","}",".blocklyFlyout .blocklyScrollbarHandle {","fill: #bbb;","}",".blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyFlyout .blocklyScrollbarHandle:hover {","fill: #aaa;","}",".blocklyInvalidInput {","background: #faa;","}",".blocklyAngleCircle {","stroke: #444;","stroke-width: 1;","fill: #ddd;","fill-opacity: .8;","}",".blocklyAngleMarks {","stroke: #444;","stroke-width: 1;","}",".blocklyAngleGauge {","fill: #f88;","fill-opacity: .8;","}",".blocklyAngleLine {","stroke: #f00;","stroke-width: 2;","stroke-linecap: round;","pointer-events: none;","}",".blocklyContextMenu {","border-radius: 4px;","}",".blocklyDropdownMenu {","padding: 0 !important;","}",".blocklyDropDownNumPad {","background-color: $colour_numPadBackground;","}",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-icon {","background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px !important;","}",".blocklyToolboxDiv {","background-color: $colour_toolbox;","color: $colour_toolboxText;","overflow-x: visible;","overflow-y: auto;","position: absolute;",'font-family: "Helvetica Neue", Helvetica, sans-serif;',"z-index: 40;","}",".blocklyTreeRoot {","padding: 4px 0;","}",".blocklyTreeRoot:focus {","outline: none;","}",".blocklyTreeRow {","height: 22px;","line-height: 22px;","margin-bottom: 3px;","padding-right: 8px;","white-space: nowrap;","}",".blocklyHorizontalTree {","float: left;","margin: 1px 5px 8px 0;","}",".blocklyHorizontalTreeRtl {","float: right;","margin: 1px 0 8px 5px;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {',"margin-left: 8px;","}",".blocklyTreeRow:not(.blocklyTreeSelected):hover {","background-color: #e4e4e4;","}",".blocklyTreeSeparator {","border-bottom: solid #e5e5e5 1px;","height: 0;","margin: 5px 0;","}",".blocklyTreeSeparatorHorizontal {","border-right: solid #e5e5e5 1px;","width: 0;","padding: 5px 0;","margin: 0 5px;","}",".blocklyTreeIcon {","background-image: url(<<<PATH>>>/sprites.png);","height: 16px;","vertical-align: middle;","width: 16px;","}",".blocklyTreeIconClosedLtr {","background-position: -32px -1px;","}",".blocklyTreeIconClosedRtl {","background-position: 0px -1px;","}",".blocklyTreeIconOpen {","background-position: -16px -1px;","}",".blocklyTreeSelected>.blocklyTreeIconClosedLtr {","background-position: -32px -17px;","}",".blocklyTreeSelected>.blocklyTreeIconClosedRtl {","background-position: 0px -17px;","}",".blocklyTreeSelected>.blocklyTreeIconOpen {","background-position: -16px -17px;","}",".blocklyTreeIconNone,",".blocklyTreeSelected>.blocklyTreeIconNone {","background-position: -48px -1px;","}",".blocklyTreeLabel {","cursor: default;",'font-family: "Helvetica Neue", Helvetica, sans-serif;',"font-size: 16px;","padding: 0 3px;","vertical-align: middle;","}",".blocklyToolboxDelete .blocklyTreeLabel {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyTreeSelected .blocklyTreeLabel {","color: #fff;","}",".blocklyWidgetDiv .goog-palette {","outline: none;","cursor: default;","}",".blocklyWidgetDiv .goog-palette-table {","border-collapse: collapse;","}",".blocklyWidgetDiv .goog-palette-cell {","height: 13px;","width: 15px;","margin: 0;","border: 0;","text-align: center;","vertical-align: middle;","font-size: 1px;","}",".blocklyWidgetDiv .goog-palette-colorswatch {","position: relative;","height: 13px;","width: 15px;","}",".blocklyWidgetDiv .goog-palette-cell-hover .goog-palette-colorswatch {","border: 1px solid #FFF;","box-sizing: border-box;","}",".blocklyWidgetDiv .goog-palette-cell-selected .goog-palette-colorswatch {","border: 1px solid #000;","box-sizing: border-box;","color: #fff;","}",".blocklyWidgetDiv .goog-menu {","background: #fff;","border-color: #ccc #666 #666 #ccc;","border-style: solid;","border-width: 1px;","cursor: default;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"margin: 0;","outline: none;","padding: 4px 0;","position: absolute;","overflow-y: auto;","overflow-x: hidden;","z-index: 20000;","}",".blocklyDropDownDiv .goog-menu {","cursor: default;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"outline: none;","z-index: 20000;","}",".blocklyWidgetDiv .goog-menuitem {","color: #000;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"list-style: none;","margin: 0;","padding: 4px 7em 4px 28px;","white-space: nowrap;","}",".blocklyDropDownDiv .goog-menuitem {","color: #fff;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"font-weight: bold;","list-style: none;","margin: 0;","padding: 4px 7em 4px 28px;","white-space: nowrap;","}",".blocklyWidgetDiv .goog-menuitem.goog-menuitem-rtl, ",".blocklyDropDownDiv .goog-menuitem.goog-menuitem-rtl {","padding-left: 7em;","padding-right: 28px;","}",".blocklyWidgetDiv .goog-menu-nocheckbox .goog-menuitem,",".blocklyWidgetDiv .goog-menu-noicon .goog-menuitem, ",".blocklyDropDownDiv .goog-menu-nocheckbox .goog-menuitem,",".blocklyDropDownDiv .goog-menu-noicon .goog-menuitem { ","padding-left: 12px;","}",".blocklyWidgetDiv .goog-menu-noaccel .goog-menuitem, ",".blocklyDropDownDiv .goog-menu-noaccel .goog-menuitem {","padding-right: 20px;","}",".blocklyWidgetDiv .goog-menuitem-content ",".blocklyDropDownDiv .goog-menuitem-content {","color: #000;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"}",".blocklyWidgetDiv .goog-menuitem-disabled .goog-menuitem-accel,",".blocklyWidgetDiv .goog-menuitem-disabled .goog-menuitem-content, ",".blocklyDropDownDiv .goog-menuitem-disabled .goog-menuitem-accel,",".blocklyDropDownDiv .goog-menuitem-disabled .goog-menuitem-content {","color: #ccc !important;","}",".blocklyWidgetDiv .goog-menuitem-disabled .goog-menuitem-icon, ",".blocklyDropDownDiv .goog-menuitem-disabled .goog-menuitem-icon {","opacity: 0.3;","-moz-opacity: 0.3;","filter: alpha(opacity=30);","}",".blocklyWidgetDiv .goog-menuitem-highlight,",".blocklyWidgetDiv .goog-menuitem-hover {","background-color: #d6e9f8;","border-color: #d6e9f8;","border-style: dotted;","border-width: 1px 0;","padding-bottom: 3px;","padding-top: 3px;","}",".blocklyDropDownDiv .goog-menuitem-highlight,",".blocklyDropDownDiv .goog-menuitem-hover {","background-color: rgba(0, 0, 0, 0.2);","}",".blocklyWidgetDiv .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-menuitem-icon, ",".blocklyDropDownDiv .goog-menuitem-checkbox,",".blocklyDropDownDiv .goog-menuitem-icon {","background-repeat: no-repeat;","height: 16px;","left: 6px;","position: absolute;","right: auto;","vertical-align: middle;","width: 16px;","}",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-icon,",".blocklyDropDownDiv .goog-option-selected .goog-menuitem-checkbox,",".blocklyDropDownDiv .goog-option-selected .goog-menuitem-icon {","background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px !important;","position: static;","float: left;","margin-left: -24px;","}",".blocklyWidgetDiv .goog-menuitem-rtl .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-menuitem-rtl .goog-menuitem-icon,",".blocklyDropDownDiv .goog-menuitem-rtl .goog-menuitem-checkbox,",".blocklyDropDownDiv .goog-menuitem-rtl .goog-menuitem-icon {","float: right;","margin-left: 6px;","}",".blocklyWidgetDiv .goog-menuitem-accel, ",".blocklyDropDownDiv .goog-menuitem-accel {","color: #999;","direction: ltr;","left: auto;","padding: 0 6px;","position: absolute;","right: 0;","text-align: right;","}",".blocklyWidgetDiv .goog-menuitem-rtl .goog-menuitem-accel, ",".blocklyDropDownDiv .goog-menuitem-rtl .goog-menuitem-accel {","left: 0;","right: auto;","text-align: left;","}",".blocklyWidgetDiv .goog-menuitem-mnemonic-hint, ",".blocklyDropDownDiv .goog-menuitem-mnemonic-hint {","text-decoration: underline;","}",".blocklyWidgetDiv .goog-menuitem-mnemonic-separator, ",".blocklyDropDownDiv .goog-menuitem-mnemonic-separator {","color: #999;","font-size: 12px;","padding-left: 4px;","}",".blocklyWidgetDiv .goog-menuseparator, ",".blocklyDropDownDiv .goog-menuseparator {","border-top: 1px solid #ccc;","margin: 4px 0;","padding: 0;","}",".blocklyFlyoutCheckbox {","fill: white;","stroke: #c8c8c8;","}",".blocklyFlyoutCheckbox.checked {","fill: "+Blockly.Colours.motion.primary+";","stroke: "+Blockly.Colours.motion.tertiary+";","}",".blocklyFlyoutCheckboxPath {","stroke: white;","stroke-width: 3;","stroke-linecap: round;","stroke-linejoin: round;","}",".scratchCategoryMenu {","width: 250px;","background: $colour_toolbox;","color: $colour_toolboxText;","font-size: .9em;","user-select: none;","-webkit-user-select: none;","-moz-user-select: none;","-ms-user-select: none;","}",".scratchCategoryRow {","width: 50%;","}",".scratchCategoryMenuItem {","padding: 4px;","width: 50%;","cursor: pointer;","}",".scratchCategoryMenuItem.categorySelected {","background: $colour_toolboxSelected;","border-radius: 16px;","}",".scratchCategoryItemBubbleLTR {","width: 14px;","height: 14px;","border: 1px solid;","border-radius: 8px;","float: left;","margin-right: 8px;","}",".scratchCategoryItemBubbleRTL {","width: 14px;","height: 14px;","border: 1px solid;","border-radius: 8px;","float: right;","margin-left: 8px;","}",".scratchCategoryMenuItem:hover {","color: $colour_toolboxHover !important;","}",""],Blockly.WidgetDiv={},Blockly.WidgetDiv.DIV=null,Blockly.WidgetDiv.owner_=null,Blockly.WidgetDiv.dispose_=null,Blockly.WidgetDiv.disposeAnimationFinished_=null,Blockly.WidgetDiv.disposeAnimationTimer_=null,Blockly.WidgetDiv.disposeAnimationTimerLength_=0,Blockly.WidgetDiv.createDom=function(){Blockly.WidgetDiv.DIV||(Blockly.WidgetDiv.DIV=goog.dom.createDom("DIV","blocklyWidgetDiv"),document.body.appendChild(Blockly.WidgetDiv.DIV))},Blockly.WidgetDiv.show=function(t,e,o,n,i){Blockly.WidgetDiv.hide(),Blockly.WidgetDiv.owner_=t,Blockly.WidgetDiv.dispose_=o,Blockly.WidgetDiv.disposeAnimationFinished_=n,Blockly.WidgetDiv.disposeAnimationTimerLength_=i,t=goog.style.getViewportPageOffset(document),Blockly.WidgetDiv.DIV.style.top=t.y+"px",Blockly.WidgetDiv.DIV.style.direction=e?"rtl":"ltr",Blockly.WidgetDiv.DIV.style.display="block"},Blockly.WidgetDiv.hide=function(t){Blockly.WidgetDiv.disposeAnimationTimer_?(window.clearTimeout(Blockly.WidgetDiv.disposeAnimationTimer_),Blockly.WidgetDiv.disposeAnimationFinished_&&Blockly.WidgetDiv.disposeAnimationFinished_(),Blockly.WidgetDiv.disposeAnimationFinished_=null,Blockly.WidgetDiv.disposeAnimationTimer_=null,Blockly.WidgetDiv.owner_=null,Blockly.WidgetDiv.hideAndClearDom_()):Blockly.WidgetDiv.isVisible()&&(Blockly.WidgetDiv.dispose_&&Blockly.WidgetDiv.dispose_(),Blockly.WidgetDiv.dispose_=null,Blockly.WidgetDiv.disposeAnimationFinished_&&!t?Blockly.WidgetDiv.disposeAnimationTimer_=window.setTimeout(Blockly.WidgetDiv.hide,1e3*Blockly.WidgetDiv.disposeAnimationTimerLength_):(Blockly.WidgetDiv.disposeAnimationFinished_&&Blockly.WidgetDiv.disposeAnimationFinished_(),Blockly.WidgetDiv.disposeAnimationFinished_=null,Blockly.WidgetDiv.owner_=null,Blockly.WidgetDiv.hideAndClearDom_()))},Blockly.WidgetDiv.hideAndClearDom_=function(){Blockly.WidgetDiv.DIV.style.display="none",Blockly.WidgetDiv.DIV.style.left="",Blockly.WidgetDiv.DIV.style.top="",Blockly.WidgetDiv.DIV.style.height="",goog.dom.removeChildren(Blockly.WidgetDiv.DIV)},Blockly.WidgetDiv.isVisible=function(){return!!Blockly.WidgetDiv.owner_},Blockly.WidgetDiv.hideIfOwner=function(t){Blockly.WidgetDiv.owner_==t&&Blockly.WidgetDiv.hide()},Blockly.WidgetDiv.position=function(t,e,o,n,i){e<n.y&&(e=n.y),i?t>o.width+n.x&&(t=o.width+n.x):t<n.x&&(t=n.x),Blockly.WidgetDiv.DIV.style.left=t+"px",Blockly.WidgetDiv.DIV.style.top=e+"px",Blockly.WidgetDiv.DIV.style.height=o.height+"px"},Blockly.inject=function(t,e){if(goog.isString(t)&&(t=document.getElementById(t)||document.querySelector(t)),!goog.dom.contains(document,t))throw"Error: container is not in current document.";var o=new Blockly.Options(e||{}),n=goog.dom.createDom("div","injectionDiv");t.appendChild(n);var i=Blockly.createDom_(n,o),r=new Blockly.BlockDragSurfaceSvg(n);return n=new Blockly.WorkspaceDragSurfaceSvg(n),o=Blockly.createMainWorkspace_(i,o,r,n),Blockly.init_(o),Blockly.mainWorkspace=o,Blockly.svgResize(o),o},Blockly.createDom_=function(t,e){t.setAttribute("dir","LTR"),goog.ui.Component.setDefaultRightToLeft(e.RTL),Blockly.Css.inject(e.hasCss,e.pathToMedia);var o=Blockly.utils.createSvgElement("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:html":"http://www.w3.org/1999/xhtml","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",class:"blocklySvg"},t),n=Blockly.utils.createSvgElement("defs",{},o),i=String(Math.random()).substring(2),r=Blockly.utils.createSvgElement("filter",{id:"blocklyStackGlowFilter",height:"160%",width:"180%",y:"-30%",x:"-40%"},n);e.stackGlowBlur=Blockly.utils.createSvgElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:Blockly.STACK_GLOW_RADIUS},r);var s=Blockly.utils.createSvgElement("feComponentTransfer",{result:"outBlur"},r);return Blockly.utils.createSvgElement("feFuncA",{type:"table",tableValues:"0"+goog.string.repeat(" 1",16)},s),Blockly.utils.createSvgElement("feFlood",{"flood-color":Blockly.Colours.stackGlow,"flood-opacity":Blockly.Colours.stackGlowOpacity,result:"outColor"},r),Blockly.utils.createSvgElement("feComposite",{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},r),Blockly.utils.createSvgElement("feComposite",{in:"SourceGraphic",in2:"outGlow",operator:"over"},r),r=Blockly.utils.createSvgElement("filter",{id:"blocklyReplacementGlowFilter",height:"160%",width:"180%",y:"-30%",x:"-40%"},n),Blockly.utils.createSvgElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:Blockly.REPLACEMENT_GLOW_RADIUS},r),s=Blockly.utils.createSvgElement("feComponentTransfer",{result:"outBlur"},r),Blockly.utils.createSvgElement("feFuncA",{type:"table",tableValues:"0"+goog.string.repeat(" 1",16)},s),Blockly.utils.createSvgElement("feFlood",{"flood-color":Blockly.Colours.replacementGlow,"flood-opacity":Blockly.Colours.replacementGlowOpacity,result:"outColor"},r),Blockly.utils.createSvgElement("feComposite",{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},r),Blockly.utils.createSvgElement("feComposite",{in:"SourceGraphic",in2:"outGlow",operator:"over"},r),s=Blockly.utils.createSvgElement("pattern",{id:"blocklyDisabledPattern"+i,patternUnits:"userSpaceOnUse",width:10,height:10},n),Blockly.utils.createSvgElement("rect",{width:10,height:10,fill:"#aaa"},s),Blockly.utils.createSvgElement("path",{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},s),e.disabledPatternId=s.id,e.gridPattern=Blockly.Grid.createDom(i,e.gridOptions,n),o},Blockly.createMainWorkspace_=function(t,e,o,n){e.parentWorkspace=null;var i=new Blockly.WorkspaceSvg(e,o,n);return i.scale=e.zoomOptions.startScale,t.appendChild(i.createDom("blocklyMainBackground")),!e.hasCategories&&e.languageTree&&(o=i.addFlyout_("svg"),Blockly.utils.insertAfter_(o,t)),i.translate(0,0),Blockly.mainWorkspace=i,e.readOnly||e.hasScrollbars||i.addChangeListener(function(){if(!i.isDragging()){var t=i.getMetrics(),o=t.viewLeft+t.absoluteLeft,n=t.viewTop+t.absoluteTop;if(t.contentTop<n||t.contentTop+t.contentHeight>t.viewHeight+n||t.contentLeft<(e.RTL?t.viewLeft:o)||t.contentLeft+t.contentWidth>(e.RTL?t.viewWidth:t.viewWidth+o))for(var r,s=i.getTopBlocks(!1),a=0;r=s[a];a++){var l=r.getRelativeToSurfaceXY(),c=r.getHeightWidth(),u=n+25-c.height-l.y;0<u&&r.moveBy(0,u),u=n+t.viewHeight-25-l.y,0>u&&r.moveBy(0,u),u=25+o-l.x-(e.RTL?0:c.width),0<u&&r.moveBy(u,0),l=o+t.viewWidth-25-l.x+(e.RTL?c.width:0),0>l&&r.moveBy(l,0)}}}),Blockly.svgResize(i),Blockly.WidgetDiv.createDom(),Blockly.DropDownDiv.createDom(),Blockly.Tooltip.createDom(),i},Blockly.init_=function(t){var e=t.options,o=t.getParentSvg();Blockly.bindEventWithChecks_(o.parentNode,"contextmenu",null,function(t){Blockly.utils.isTargetInput(t)||t.preventDefault()}),o=Blockly.bindEventWithChecks_(window,"resize",null,function(){Blockly.hideChaff(!0),Blockly.svgResize(t)}),t.setResizeHandlerWrapper(o),Blockly.inject.bindDocumentEvents_(),e.languageTree&&(t.toolbox_?t.toolbox_.init(t):t.flyout_&&(t.flyout_.init(t),t.flyout_.show(e.languageTree.childNodes),t.flyout_.scrollToStart(),e.horizontalLayout?(t.scrollY=t.flyout_.height_,e.toolboxPosition==Blockly.TOOLBOX_AT_BOTTOM&&(t.scrollY*=-1)):(t.scrollX=t.flyout_.width_,e.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT&&(t.scrollX*=-1)),t.translate(t.scrollX,t.scrollY))),e.hasScrollbars&&(t.scrollbar=new Blockly.ScrollbarPair(t),t.scrollbar.resize()),e.hasSounds&&Blockly.inject.loadSounds_(e.pathToMedia,t)},Blockly.inject.bindDocumentEvents_=function(){Blockly.documentEventsBound_||(Blockly.bindEventWithChecks_(document,"keydown",null,Blockly.onKeyDown_),Blockly.bindEvent_(document,"touchend",null,Blockly.longStop_),Blockly.bindEvent_(document,"touchcancel",null,Blockly.longStop_),goog.userAgent.IPAD&&Blockly.bindEventWithChecks_(window,"orientationchange",document,function(){Blockly.svgResize(Blockly.getMainWorkspace())})),Blockly.documentEventsBound_=!0},Blockly.inject.loadSounds_=function(t,e){var o=e.getAudioManager();o.load([t+"click.mp3",t+"click.wav",t+"click.ogg"],"click"),o.load([t+"delete.mp3",t+"delete.ogg",t+"delete.wav"],"delete");var n=[],i=function(){for(;n.length;)Blockly.unbindEvent_(n.pop());o.preload()};n.push(Blockly.bindEventWithChecks_(document,"mousemove",null,i,!0)),n.push(Blockly.bindEventWithChecks_(document,"touchstart",null,i,!0))},Blockly.updateToolbox=function(t){console.warn("Deprecated call to Blockly.updateToolbox, use workspace.updateToolbox instead."),Blockly.getMainWorkspace().updateToolbox(t)};var CLOSURE_DEFINES={"goog.DEBUG":!1};Blockly.mainWorkspace=null,Blockly.selected=null,Blockly.draggingConnections_=[],Blockly.clipboardXml_=null,Blockly.clipboardSource_=null,Blockly.cache3dSupported_=null,Blockly.hueToRgb=function(t){return goog.color.hsvToHex(t,Blockly.HSV_SATURATION,255*Blockly.HSV_VALUE)},Blockly.svgSize=function(t){return{width:t.cachedWidth_,height:t.cachedHeight_}},Blockly.resizeSvgContents=function(t){t.resizeContents()},Blockly.svgResize=function(t){for(;t.options.parentWorkspace;)t=t.options.parentWorkspace;var e=t.getParentSvg(),o=e.parentNode;if(o){var n=o.offsetWidth;o=o.offsetHeight,e.cachedWidth_!=n&&(e.setAttribute("width",n+"px"),e.cachedWidth_=n),e.cachedHeight_!=o&&(e.setAttribute("height",o+"px"),e.cachedHeight_=o),t.resize()}},Blockly.onKeyDown_=function(t){Blockly.mainWorkspace.options.readOnly||Blockly.utils.isTargetInput(t)||(27==t.keyCode?(Blockly.hideChaff(),Blockly.DropDownDiv.hide()):8==t.keyCode||46==t.keyCode?(t.preventDefault(),Blockly.mainWorkspace.isDragging()):(t.altKey||t.ctrlKey||t.metaKey)&&!Blockly.mainWorkspace.isDragging()&&(Blockly.selected&&Blockly.selected.isDeletable()&&Blockly.selected.isMovable()&&(67==t.keyCode?(Blockly.hideChaff(),Blockly.copy_(Blockly.selected)):88==t.keyCode&&(Blockly.copy_(Blockly.selected),Blockly.hideChaff(),Blockly.selected.dispose(!0,!0))),86==t.keyCode?Blockly.clipboardXml_&&(Blockly.Events.setGroup(!0),Blockly.clipboardSource_.paste(Blockly.clipboardXml_),Blockly.Events.setGroup(!1)):90==t.keyCode&&(Blockly.hideChaff(),Blockly.mainWorkspace.undo(t.shiftKey))))},Blockly.copy_=function(t){var e=Blockly.Xml.blockToDom(t),o=t.getRelativeToSurfaceXY();e.setAttribute("x",t.RTL?-o.x:o.x),e.setAttribute("y",o.y),Blockly.clipboardXml_=e,Blockly.clipboardSource_=t.workspace},Blockly.duplicate_=function(t){var e=Blockly.clipboardXml_,o=Blockly.clipboardSource_;Blockly.copy_(t),t.workspace.paste(Blockly.clipboardXml_),Blockly.clipboardXml_=e,Blockly.clipboardSource_=o},Blockly.onContextMenu_=function(t){Blockly.utils.isTargetInput(t)||t.preventDefault()},Blockly.hideChaff=function(t){Blockly.Tooltip.hide(),Blockly.WidgetDiv.hide(!0),Blockly.DropDownDiv.hideWithoutAnimation(),t||(t=Blockly.getMainWorkspace(),t.toolbox_&&t.toolbox_.flyout_&&t.toolbox_.flyout_.autoClose&&t.toolbox_.clearSelection())},Blockly.getMainWorkspace=function(){return Blockly.mainWorkspace},Blockly.alert=function(t,e){window.alert(t),e&&e()},Blockly.confirm=function(t,e){e(window.confirm(t))},Blockly.prompt=function(t,e,o){o(window.prompt(t,e))},Blockly.jsonInitFactory_=function(t){return function(){this.jsonInit(t)}},Blockly.defineBlocksWithJsonArray=function(t){for(var e,o=0;e=t[o];o++){var n=e.type;null==n||""===n?console.warn("Block definition #"+o+" in JSON array is missing a type attribute. Skipping."):(Blockly.Blocks[n]&&console.warn("Block definition #"+o+' in JSON array overwrites prior definition of "'+n+'".'),Blockly.Blocks[n]={init:Blockly.jsonInitFactory_(e)})}},Blockly.bindEventWithChecks_=function(t,e,o,n,i){var r=!1,s=function(t){var e=!i;t=Blockly.Touch.splitEventByTouches(t);for(var s,a=0;s=t[a];a++)e&&!Blockly.Touch.shouldHandleEvent(s)||(Blockly.Touch.setClientFromTouch(s),o?n.call(o,s):n(s),r=!0)};t.addEventListener(e,s,!1);var a=[[t,e,s]];if(e in Blockly.Touch.TOUCH_MAP)for(var l,c=function(t){s(t),r&&t.preventDefault()},u=0;l=Blockly.Touch.TOUCH_MAP[e][u];u++)t.addEventListener(l,c,!1),a.push([t,l,c]);return a},Blockly.bindEvent_=function(t,e,o,n){var i=function(t){o?n.call(o,t):n(t)};t.addEventListener(e,i,!1);var r=[[t,e,i]];if(e in Blockly.Touch.TOUCH_MAP)for(var s,a=function(t){if(1==t.changedTouches.length){var e=t.changedTouches[0];t.clientX=e.clientX,t.clientY=e.clientY}i(t),t.preventDefault()},l=0;s=Blockly.Touch.TOUCH_MAP[e][l];l++)t.addEventListener(s,a,!1),r.push([t,s,a]);return r},Blockly.unbindEvent_=function(t){for(var e;t.length;){e=t.pop();var o=e[0],n=e[1];e=e[2],o.removeEventListener(n,e,!1)}return e},Blockly.isNumber=function(t){return!!t.match(/^\s*-?\d+(\.\d+)?\s*$/)},goog.global.console||(goog.global.console={log:function(){},warn:function(){}}),goog.global.Blockly||(goog.global.Blockly={}),goog.global.Blockly.getMainWorkspace=Blockly.getMainWorkspace,module.exports=Blockly}).call(window)},function(t,e){(function(){function t(){return"#"+("00000"+Math.floor(Math.random()*Math.pow(2,24)).toString(16)).substr(-6)}var e=(window.goog,window.Blockly);e.constants={},e.DRAG_RADIUS=3,e.FLYOUT_DRAG_RADIUS=10,e.SNAP_RADIUS=48,e.CONNECTING_SNAP_RADIUS=96,e.CURRENT_CONNECTION_PREFERENCE=20,e.BUMP_DELAY=0,e.COLLAPSE_CHARS=30,e.LONGPRESS=750,e.SOUND_LIMIT=100,e.DRAG_STACK=!0,e.HSV_SATURATION=.45,e.HSV_VALUE=.65,e.SPRITE={width:96,height:124,url:"sprites.png"},e.SVG_NS="http://www.w3.org/2000/svg",e.HTML_NS="http://www.w3.org/1999/xhtml",e.INPUT_VALUE=1,e.OUTPUT_VALUE=2,e.NEXT_STATEMENT=3,e.PREVIOUS_STATEMENT=4,e.DUMMY_INPUT=5,e.ALIGN_LEFT=-1,e.ALIGN_CENTRE=0,e.ALIGN_RIGHT=1,e.DRAG_NONE=0,e.DRAG_STICKY=1,e.DRAG_BEGIN=1,e.DRAG_FREE=2,e.OPPOSITE_TYPE=[],e.OPPOSITE_TYPE[e.INPUT_VALUE]=e.OUTPUT_VALUE,e.OPPOSITE_TYPE[e.OUTPUT_VALUE]=e.INPUT_VALUE,e.OPPOSITE_TYPE[e.NEXT_STATEMENT]=e.PREVIOUS_STATEMENT,e.OPPOSITE_TYPE[e.PREVIOUS_STATEMENT]=e.NEXT_STATEMENT,e.TOOLBOX_AT_TOP=0,e.TOOLBOX_AT_BOTTOM=1,e.TOOLBOX_AT_LEFT=2,e.TOOLBOX_AT_RIGHT=3,e.OUTPUT_SHAPE_HEXAGONAL=1,e.OUTPUT_SHAPE_ROUND=2,e.OUTPUT_SHAPE_SQUARE=3,e.STACK_GLOW_RADIUS=1.3,e.REPLACEMENT_GLOW_RADIUS=2,e.Categories={motion:"motion",looks:"looks",sound:"sounds",pen:"pen",data:"data",event:"events",control:"control",sensing:"sensing",operators:"operators",more:"more"},e.DELETE_AREA_NONE=null,e.DELETE_AREA_TRASH=1,e.DELETE_AREA_TOOLBOX=2,e.VARIABLE_CATEGORY_NAME="VARIABLE",e.PROCEDURE_CATEGORY_NAME="PROCEDURE",e.RENAME_VARIABLE_ID="RENAME_VARIABLE_ID",e.DELETE_VARIABLE_ID="DELETE_VARIABLE_ID",e.Blocks.colour={},e.Blocks.colour_picker={init:function(){this.jsonInit({message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:t()}],outputShape:e.OUTPUT_SHAPE_ROUND,output:"Colour"})}},e.Colours={motion:{primary:"#4C97FF",secondary:"#4280D7",tertiary:"#3373CC"},looks:{primary:"#9966FF",secondary:"#855CD6",tertiary:"#774DCB"},sounds:{primary:"#CF63CF",secondary:"#C94FC9",tertiary:"#BD42BD"},control:{primary:"#FFAB19",secondary:"#EC9C13",tertiary:"#CF8B17"},event:{primary:"#FFBF00",secondary:"#E6AC00",tertiary:"#CC9900"},sensing:{primary:"#5CB1D6",secondary:"#47A8D1",tertiary:"#2E8EB8"},pen:{primary:"#0fBD8C",secondary:"#0DA57A",tertiary:"#0B8E69"},operators:{primary:"#59C059",secondary:"#46B946",tertiary:"#389438"},data:{primary:"#FF8C1A",secondary:"#FF8000",tertiary:"#DB6E00"},more:{primary:"#FF6680",secondary:"#FF4D6A",tertiary:"#FF3355"},text:"#575E75",workspace:"#F9F9F9",toolboxHover:"#4C97FF",toolboxSelected:"#e9eef2",toolboxText:"#575E75",toolbox:"#FFFFFF",flyout:"#F9F9F9",scrollbar:"#CECDCE",scrollbarHover:"#CECDCE",textField:"#FFFFFF",insertionMarker:"#000000",insertionMarkerOpacity:.2,dragShadowOpacity:.3,stackGlow:"#FFF200",stackGlowOpacity:1,replacementGlow:"#FFFFFF",replacementGlowOpacity:1,colourPickerStroke:"#FFFFFF",fieldShadow:"rgba(0,0,0,0.1)",dropDownShadow:"rgba(0, 0, 0, .3)",numPadBackground:"#547AB2",numPadBorder:"#435F91",numPadActiveBackground:"#435F91",numPadText:"#FFFFFF",valueReportBackground:"#FFFFFF",valueReportBorder:"#AAAAAA"},e.Blocks.math={},e.Blocks.math_number={init:function(){this.jsonInit({message0:"%1",args0:[{type:"field_number",name:"NUM",value:"0"}],output:"Number",outputShape:e.OUTPUT_SHAPE_ROUND,colour:e.Colours.textField,colourSecondary:e.Colours.textField,colourTertiary:e.Colours.textField})}},e.Blocks.math_integer={init:function(){this.jsonInit({message0:"%1",args0:[{type:"field_number",name:"NUM",precision:1}],output:"Number",outputShape:e.OUTPUT_SHAPE_ROUND,colour:e.Colours.textField,colourSecondary:e.Colours.textField,colourTertiary:e.Colours.textField})}},e.Blocks.math_whole_number={init:function(){this.jsonInit({message0:"%1",args0:[{type:"field_number",name:"NUM",min:0,precision:1}],output:"Number",outputShape:e.OUTPUT_SHAPE_ROUND,colour:e.Colours.textField,colourSecondary:e.Colours.textField,colourTertiary:e.Colours.textField})}},e.Blocks.math_positive_number={init:function(){this.jsonInit({message0:"%1",args0:[{type:"field_number",name:"NUM",min:0}],output:"Number",outputShape:e.OUTPUT_SHAPE_ROUND,colour:e.Colours.textField,colourSecondary:e.Colours.textField,colourTertiary:e.Colours.textField})}},e.Blocks.math_angle={init:function(){this.jsonInit({message0:"%1",args0:[{type:"field_angle",name:"NUM",value:90}],output:"Number",outputShape:e.OUTPUT_SHAPE_ROUND,colour:e.Colours.textField,colourSecondary:e.Colours.textField,colourTertiary:e.Colours.textField})}},e.Blocks.texts={},e.Blocks.text={init:function(){this.jsonInit({message0:"%1",args0:[{type:"field_input",name:"TEXT"}],output:"String",outputShape:e.OUTPUT_SHAPE_ROUND,colour:e.Colours.textField,colourSecondary:e.Colours.textField,colourTertiary:e.Colours.textField})}}}).call(window)},function(t,e){(function(){var t=window.goog,e=window.Blockly;t.provide("Blockly.Msg.en"),t.require("Blockly.Msg"),e.Msg.LOGIC_HUE="210",e.Msg.LOOPS_HUE="120",e.Msg.MATH_HUE="230",e.Msg.TEXTS_HUE="160",e.Msg.LISTS_HUE="260",e.Msg.COLOUR_HUE="20",e.Msg.VARIABLES_HUE="330",e.Msg.PROCEDURES_HUE="290",e.Msg.VARIABLES_DEFAULT_NAME="item",e.Msg.TODAY="Today",e.Msg.DUPLICATE_BLOCK="Duplicate",e.Msg.ADD_COMMENT="Add Comment",e.Msg.REMOVE_COMMENT="Remove Comment",e.Msg.EXTERNAL_INPUTS="External Inputs",e.Msg.INLINE_INPUTS="Inline Inputs",e.Msg.DELETE_BLOCK="Delete Block",e.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",e.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",e.Msg.CLEAN_UP="Clean up Blocks",e.Msg.COLLAPSE_BLOCK="Collapse Block",e.Msg.COLLAPSE_ALL="Collapse Blocks",e.Msg.EXPAND_BLOCK="Expand Block",e.Msg.EXPAND_ALL="Expand Blocks",e.Msg.DISABLE_BLOCK="Disable Block",e.Msg.ENABLE_BLOCK="Enable Block",e.Msg.HELP="Help",e.Msg.UNDO="Undo",e.Msg.REDO="Redo",e.Msg.CHANGE_VALUE_TITLE="Change value:",e.Msg.RENAME_VARIABLE="Rename variable...",e.Msg.RENAME_VARIABLE_TITLE='Rename all "%1" variables to:',e.Msg.NEW_VARIABLE="Create variable...",e.Msg.NEW_VARIABLE_TITLE="New variable name:",e.Msg.VARIABLE_ALREADY_EXISTS='A variable named "%1" already exists.',e.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE='A variable named "%1" already exists for another variable of type "%2".',e.Msg.PROCEDURE_ALREADY_EXISTS='A procedure named "%1" already exists.',e.Msg.NEW_LIST="Create list...",e.Msg.DELETE_VARIABLE_CONFIRMATION='Delete %1 uses of the "%2" variable?',e.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE='Can\'t delete the variable "%1" because it\'s part of the definition of the function "%2"',e.Msg.DELETE_VARIABLE='Delete the "%1" variable',e.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",e.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",e.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",e.Msg.COLOUR_RANDOM_TITLE="random colour",e.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",e.Msg.COLOUR_RGB_HELPURL="http://www.december.com/html/spec/colorper.html",e.Msg.COLOUR_RGB_TITLE="colour with",e.Msg.COLOUR_RGB_RED="red",e.Msg.COLOUR_RGB_GREEN="green",e.Msg.COLOUR_RGB_BLUE="blue",e.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",e.Msg.COLOUR_BLEND_HELPURL="http://meyerweb.com/eric/tools/color-blend/",e.Msg.COLOUR_BLEND_TITLE="blend",e.Msg.COLOUR_BLEND_COLOUR1="colour 1",e.Msg.COLOUR_BLEND_COLOUR2="colour 2",e.Msg.COLOUR_BLEND_RATIO="ratio",e.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",e.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",e.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",e.Msg.CONTROLS_REPEAT_INPUT_DO="do",e.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",e.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",e.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",e.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",e.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",e.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",e.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",e.Msg.CONTROLS_FOR_TOOLTIP='Have the variable "%1" take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.',e.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",e.Msg.CONTROLS_FOR_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",e.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",e.Msg.CONTROLS_FOREACH_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_FOREACH_TOOLTIP='For each item in a list, set the variable "%1" to the item, and then do some statements.',e.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",e.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",e.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",e.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",e.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",e.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",e.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",e.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",e.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",e.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",e.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",e.Msg.CONTROLS_IF_MSG_IF="if",e.Msg.CONTROLS_IF_MSG_ELSEIF="else if",e.Msg.CONTROLS_IF_MSG_ELSE="else",e.Msg.CONTROLS_IF_MSG_THEN=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_IF_IF_TITLE_IF=e.Msg.CONTROLS_IF_MSG_IF,e.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",e.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=e.Msg.CONTROLS_IF_MSG_ELSEIF,e.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",e.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=e.Msg.CONTROLS_IF_MSG_ELSE,e.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",e.Msg.IOS_OK="OK",e.Msg.IOS_CANCEL="Cancel",e.Msg.IOS_ERROR="Error",e.Msg.IOS_PROCEDURES_INPUTS="INPUTS",e.Msg.IOS_PROCEDURES_ADD_INPUT="+ Add Input",e.Msg.IOS_PROCEDURES_ALLOW_STATEMENTS="Allow statements",e.Msg.IOS_PROCEDURES_DUPLICATE_INPUTS_ERROR="This function has duplicate inputs.",e.Msg.IOS_VARIABLES_ADD_VARIABLE="+ Add Variable",e.Msg.IOS_VARIABLES_ADD_BUTTON="Add",e.Msg.IOS_VARIABLES_RENAME_BUTTON="Rename",e.Msg.IOS_VARIABLES_DELETE_BUTTON="Delete",e.Msg.IOS_VARIABLES_VARIABLE_NAME="Variable name",e.Msg.IOS_VARIABLES_EMPTY_NAME_ERROR="You can't use an empty variable name.",e.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",e.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",e.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",e.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",e.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",e.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",e.Msg.LOGIC_OPERATION_AND="and",e.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",e.Msg.LOGIC_OPERATION_OR="or",e.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",e.Msg.LOGIC_NEGATE_TITLE="not %1",e.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",e.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",e.Msg.LOGIC_BOOLEAN_TRUE="true",e.Msg.LOGIC_BOOLEAN_FALSE="false",e.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",e.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",e.Msg.LOGIC_NULL="null",e.Msg.LOGIC_NULL_TOOLTIP="Returns null.",e.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",e.Msg.LOGIC_TERNARY_CONDITION="test",e.Msg.LOGIC_TERNARY_IF_TRUE="if true",e.Msg.LOGIC_TERNARY_IF_FALSE="if false",e.Msg.LOGIC_TERNARY_TOOLTIP='Check the condition in "test". If the condition is true, returns the "if true" value; otherwise returns the "if false" value.',e.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",e.Msg.MATH_NUMBER_TOOLTIP="A number.",e.Msg.MATH_ADDITION_SYMBOL="+",e.Msg.MATH_SUBTRACTION_SYMBOL="-",e.Msg.MATH_DIVISION_SYMBOL="",e.Msg.MATH_MULTIPLICATION_SYMBOL="",e.Msg.MATH_POWER_SYMBOL="^",e.Msg.MATH_TRIG_SIN="sin",e.Msg.MATH_TRIG_COS="cos",e.Msg.MATH_TRIG_TAN="tan",e.Msg.MATH_TRIG_ASIN="asin",e.Msg.MATH_TRIG_ACOS="acos",e.Msg.MATH_TRIG_ATAN="atan",e.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",e.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",e.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",e.Msg.MATH_SINGLE_OP_ROOT="square root",e.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",e.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",e.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",e.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",e.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",e.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",e.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",e.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",e.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",e.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",e.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",e.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",e.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",e.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",e.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",e.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",e.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants:  (3.141), e (2.718),  (1.618), sqrt(2) (1.414), sqrt() (0.707), or  (infinity).",e.Msg.MATH_IS_EVEN="is even",e.Msg.MATH_IS_ODD="is odd",e.Msg.MATH_IS_PRIME="is prime",e.Msg.MATH_IS_WHOLE="is whole",e.Msg.MATH_IS_POSITIVE="is positive",e.Msg.MATH_IS_NEGATIVE="is negative",e.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",e.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",e.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",e.Msg.MATH_CHANGE_TITLE="change %1 by %2",e.Msg.MATH_CHANGE_TITLE_ITEM=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.MATH_CHANGE_TOOLTIP='Add a number to variable "%1".',e.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",e.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",e.Msg.MATH_ROUND_OPERATOR_ROUND="round",e.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",e.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",e.Msg.MATH_ONLIST_HELPURL="",e.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",e.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",e.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",e.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",e.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",e.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.";e.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",e.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",e.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",e.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",e.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",e.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",e.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",e.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",e.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",e.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",e.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",e.Msg.MATH_MODULO_TITLE="remainder of %1  %2",e.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",e.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",e.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",e.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",e.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",e.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",e.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",e.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",e.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",e.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",e.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",e.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",e.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",e.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",e.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",e.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",e.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",e.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",e.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",e.Msg.TEXT_APPEND_TO="to",e.Msg.TEXT_APPEND_APPENDTEXT="append text",e.Msg.TEXT_APPEND_VARIABLE=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.TEXT_APPEND_TOOLTIP='Append some text to variable "%1".',e.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",e.Msg.TEXT_LENGTH_TITLE="length of %1",e.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",e.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",e.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",e.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",e.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",e.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",e.Msg.TEXT_INDEXOF_INPUT_INTEXT="in text",e.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",e.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",e.Msg.TEXT_INDEXOF_TAIL="",e.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",e.Msg.TEXT_CHARAT_INPUT_INTEXT="in text",e.Msg.TEXT_CHARAT_FROM_START="get letter #",e.Msg.TEXT_CHARAT_FROM_END="get letter # from end",e.Msg.TEXT_CHARAT_FIRST="get first letter",e.Msg.TEXT_CHARAT_LAST="get last letter",e.Msg.TEXT_CHARAT_RANDOM="get random letter",e.Msg.TEXT_CHARAT_TAIL="",e.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",e.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",e.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",e.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",e.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",e.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",e.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",e.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",e.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",e.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",e.Msg.TEXT_GET_SUBSTRING_TAIL="",e.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",e.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",e.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",e.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",e.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",e.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",e.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",e.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",e.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",e.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",e.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",e.Msg.TEXT_PRINT_TITLE="print %1",e.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",e.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",e.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",e.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",e.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",e.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",e.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",e.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",e.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",e.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",e.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",e.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",e.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",e.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",e.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",e.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",e.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",e.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",e.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",e.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",e.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",e.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",e.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",e.Msg.LISTS_CREATE_WITH_ITEM_TITLE=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",e.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",e.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",e.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",e.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",e.Msg.LISTS_LENGTH_TITLE="length of %1",e.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",e.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",e.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",e.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",e.Msg.LISTS_INLIST="in list",e.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",e.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",e.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",e.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",e.Msg.LISTS_GET_INDEX_HELPURL=e.Msg.LISTS_INDEX_OF_HELPURL,e.Msg.LISTS_GET_INDEX_GET="get",e.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",e.Msg.LISTS_GET_INDEX_REMOVE="remove",e.Msg.LISTS_GET_INDEX_FROM_START="#",e.Msg.LISTS_GET_INDEX_FROM_END="# from end",e.Msg.LISTS_GET_INDEX_FIRST="first",e.Msg.LISTS_GET_INDEX_LAST="last",e.Msg.LISTS_GET_INDEX_RANDOM="random",e.Msg.LISTS_GET_INDEX_TAIL="",e.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",e.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",e.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",e.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_SET_INDEX_SET="set",e.Msg.LISTS_SET_INDEX_INSERT="insert at",e.Msg.LISTS_SET_INDEX_INPUT_TO="as",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",e.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",e.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",e.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",e.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",e.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",e.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",e.Msg.LISTS_GET_SUBLIST_END_LAST="to last",e.Msg.LISTS_GET_SUBLIST_TAIL="",e.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",e.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",e.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",e.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",e.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",e.Msg.LISTS_SORT_ORDER_DESCENDING="descending",e.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",e.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",e.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",e.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",e.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",e.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",e.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",e.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",e.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",e.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",e.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",e.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",e.Msg.ORDINAL_NUMBER_SUFFIX="",e.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",e.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",e.Msg.VARIABLES_GET_CREATE_SET='Create "set %1"',e.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",e.Msg.VARIABLES_SET="set %1 to %2",e.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",e.Msg.VARIABLES_SET_CREATE_GET='Create "get %1"',e.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_DEFNORETURN_TITLE="to",e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",e.Msg.PROCEDURES_BEFORE_PARAMS="with:",e.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",e.Msg.PROCEDURES_DEFNORETURN_DO="",e.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",e.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...";e.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_DEFRETURN_TITLE=e.Msg.PROCEDURES_DEFNORETURN_TITLE,e.Msg.PROCEDURES_DEFRETURN_PROCEDURE=e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,e.Msg.PROCEDURES_DEFRETURN_DO=e.Msg.PROCEDURES_DEFNORETURN_DO,e.Msg.PROCEDURES_DEFRETURN_COMMENT=e.Msg.PROCEDURES_DEFNORETURN_COMMENT,e.Msg.PROCEDURES_DEFRETURN_RETURN="return",e.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",e.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",e.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",e.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_CALLNORETURN_TOOLTIP='Run the user-defined function "%1".',e.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_CALLRETURN_TOOLTIP='Run the user-defined function "%1" and use its output.',e.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",e.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",e.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",e.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",e.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",e.Msg.PROCEDURES_CREATE_DO='Create "%1"',e.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",e.Msg.PROCEDURES_IFRETURN_HELPURL="http://c2.com/cgi/wiki?GuardClause",e.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition."}).call(window)},function(t,e,o){(function(t,e){!function(t,o){"use strict";function n(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),o=0;o<e.length;o++)e[o]=arguments[o+1];var n={callback:t,args:e};return c[l]=n,a(l),l++}function i(t){delete c[t]}function r(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(o,n)}}function s(t){if(u)setTimeout(s,0,t);else{var e=c[t];if(e){u=!0;try{r(e)}finally{i(t),u=!1}}}}if(!t.setImmediate){var a,l=1,c={},u=!1,h=t.document,g=Object.getPrototypeOf&&Object.getPrototypeOf(t);g=g&&g.setTimeout?g:t,"[object process]"==={}.toString.call(t.process)?function(){a=function(t){e.nextTick(function(){s(t)})}}():function(){if(t.postMessage&&!t.importScripts){var e=!0,o=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=o,e}}()?function(){var e="setImmediate$"+Math.random()+"$",o=function(o){o.source===t&&"string"==typeof o.data&&0===o.data.indexOf(e)&&s(+o.data.slice(e.length))};t.addEventListener?t.addEventListener("message",o,!1):t.attachEvent("onmessage",o),a=function(o){t.postMessage(e+o,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){s(t.data)},a=function(e){t.port2.postMessage(e)}}():h&&"onreadystatechange"in h.createElement("script")?function(){var t=h.documentElement;a=function(e){var o=h.createElement("script");o.onreadystatechange=function(){s(e),o.onreadystatechange=null,t.removeChild(o),o=null},t.appendChild(o)}}():function(){a=function(t){setTimeout(s,0,t)}}(),g.setImmediate=n,g.clearImmediate=i}}("undefined"==typeof self?void 0===t?this:t:self)}).call(e,o(2),o(3))},function(t,e,o){function n(t,e){this._id=t,this._clearFn=e}var i=Function.prototype.apply;e.setTimeout=function(){return new n(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new n(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},o(20),e.setImmediate=setImmediate,e.clearImmediate=clearImmediate},function(t,e,o){(function(t){!function(t){t.fn.railsAutocomplete=function(){var e=function(){this.railsAutoCompleter||(this.railsAutoCompleter=new t.railsAutocomplete(this))};return void 0!==t.fn.on?t(document).on("focus",this.selector,e):this.live("focus",e)},t.railsAutocomplete=function(t){_e=t,this.init(_e)},t.railsAutocomplete.fn=t.railsAutocomplete.prototype={railsAutocomplete:"0.0.1"},t.railsAutocomplete.fn.extend=t.railsAutocomplete.extend=t.extend,t.railsAutocomplete.fn.extend({init:function(e){function o(t){return t.split(e.delimiter)}function n(t){return o(t).pop().replace(/^\s+/,"")}e.delimiter=t(e).attr("data-delimiter")||null,e.min_length=t(e).attr("min-length")||2,e.append_to=t(e).attr("data-append-to")||null,t(e).autocomplete({appendTo:e.append_to,source:function(o,i){params={term:n(o.term)},t(e).attr("data-autocomplete-fields")&&t.each(t.parseJSON(t(e).attr("data-autocomplete-fields")),function(e,o){params[e]=t(o).val()}),t.getJSON(t(e).attr("data-autocomplete"),params,function(){0==arguments[0].length&&(arguments[0]=[],arguments[0][0]={id:"",label:"no existing match"}),t(arguments[0]).each(function(o,n){var i={};i[n.id]=n,t(e).data(i)}),i.apply(null,arguments)})},change:function(e,o){if(t(this).is("[data-id-element]")&&""!=t(t(this).attr("data-id-element")).val()&&(t(t(this).attr("data-id-element")).val(o.item?o.item.id:""),t(this).attr("data-update-elements"))){var n=t.parseJSON(t(this).attr("data-update-elements")),i=o.item?t(this).data(o.item.id.toString()):{};if(n&&""==t(n.id).val())return;for(var r in n)element=t(n[r]),element.is(":checkbox")?null!=i[r]&&element.prop("checked",i[r]):element.val(o.item?i[r]:"")}},search:function(){if(n(this.value).length<e.min_length)return!1},focus:function(){return!1},select:function(n,i){var r=o(this.value);if(r.pop(),r.push(i.item.value),null!=e.delimiter)r.push(""),this.value=r.join(e.delimiter);else if(this.value=r.join(""),t(this).attr("data-id-element")&&t(t(this).attr("data-id-element")).val(i.item.id),t(this).attr("data-update-elements")){var s=t(this).data(i.item.id.toString()),a=t.parseJSON(t(this).attr("data-update-elements"));for(var l in a)element=t(a[l]),element.is(":checkbox")?null!=s[l]&&element.prop("checked",s[l]):element.val(s[l])}var c=this.value;return t(this).bind("keyup.clearId",function(){t.trim(t(this).val())!=t.trim(c)&&(t(t(this).attr("data-id-element")).val(""),t(this).unbind("keyup.clearId"))}),t(e).trigger("railsAutocomplete.select",i),!1}})}}),t(document).ready(function(){t("input[data-autocomplete]").railsAutocomplete()})}(t)}).call(e,o(0))},function(t,e,o){(function(e,o,n,i){/* @preserve
 * The MIT License (MIT)
 *
 * Copyright (c) 2013-2017 Petka Antonov
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
 */
!function(e){t.exports=e()}(function(){return function t(e,o,n){function i(s,a){if(!o[s]){if(!e[s]){var l="function"==typeof _dereq_&&_dereq_;if(!a&&l)return l(s,!0);if(r)return r(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=o[s]={exports:{}};e[s][0].call(u.exports,function(t){var o=e[s][1][t];return i(o||t)},u,u.exports,t,e,o,n)}return o[s].exports}for(var r="function"==typeof _dereq_&&_dereq_,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,o){"use strict";e.exports=function(t){function e(t){var e=new o(t),n=e.promise();return e.setHowMany(1),e.setUnwrap(),e.init(),n}var o=t._SomePromiseArray;t.any=function(t){return e(t)},t.prototype.any=function(){return e(this)}}},{}],2:[function(t,o,n){"use strict";function i(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new u(16),this._normalQueue=new u(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=c}function r(t,e,o){this._lateQueue.push(t,e,o),this._queueTick()}function s(t,e,o){this._normalQueue.push(t,e,o),this._queueTick()}function a(t){this._normalQueue._pushOne(t),this._queueTick()}var l;try{throw new Error}catch(t){l=t}var c=t("./schedule"),u=t("./queue"),h=t("./util");i.prototype.setScheduler=function(t){var e=this._schedule;return this._schedule=t,this._customScheduler=!0,e},i.prototype.hasCustomScheduler=function(){return this._customScheduler},i.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},i.prototype.disableTrampolineIfNecessary=function(){h.hasDevTools&&(this._trampolineEnabled=!1)},i.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},i.prototype.fatalError=function(t,o){o?(e.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+"\n"),e.exit(2)):this.throwLater(t)},i.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout(function(){t(e)},0);else try{this._schedule(function(){t(e)})}catch(t){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},h.hasDevTools?(i.prototype.invokeLater=function(t,e,o){this._trampolineEnabled?r.call(this,t,e,o):this._schedule(function(){setTimeout(function(){t.call(e,o)},100)})},i.prototype.invoke=function(t,e,o){this._trampolineEnabled?s.call(this,t,e,o):this._schedule(function(){t.call(e,o)})},i.prototype.settlePromises=function(t){this._trampolineEnabled?a.call(this,t):this._schedule(function(){t._settlePromises()})}):(i.prototype.invokeLater=r,i.prototype.invoke=s,i.prototype.settlePromises=a),i.prototype._drainQueue=function(t){for(;t.length()>0;){var e=t.shift();if("function"==typeof e){var o=t.shift(),n=t.shift();e.call(o,n)}else e._settlePromises()}},i.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},i.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},i.prototype._reset=function(){this._isTickUsed=!1},o.exports=i,o.exports.firstLineError=l},{"./queue":26,"./schedule":29,"./util":36}],3:[function(t,e,o){"use strict";e.exports=function(t,e,o,n){var i=!1,r=function(t,e){this._reject(e)},s=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(r,r,null,this,t)},a=function(t,e){0==(50397184&this._bitField)&&this._resolveCallback(e.target)},l=function(t,e){e.promiseRejectionQueued||this._reject(t)};t.prototype.bind=function(r){i||(i=!0,t.prototype._propagateFrom=n.propagateFromFunction(),t.prototype._boundValue=n.boundValueFunction());var c=o(r),u=new t(e);u._propagateFrom(this,1);var h=this._target();if(u._setBoundTo(c),c instanceof t){var g={promiseRejectionQueued:!1,promise:u,target:h,bindingPromise:c};h._then(e,s,void 0,u,g),c._then(a,l,void 0,u,g),u._setOnCancel(c)}else u._resolveCallback(h);return u},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=2097152|this._bitField,this._boundTo=t):this._bitField=-2097153&this._bitField},t.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},t.bind=function(e,o){return t.resolve(o).bind(e)}}},{}],4:[function(t,e,o){"use strict";function n(){try{Promise===r&&(Promise=i)}catch(t){}return r}var i;"undefined"!=typeof Promise&&(i=Promise);var r=t("./promise")();r.noConflict=n,e.exports=r},{"./promise":22}],5:[function(t,e,o){"use strict";var n=Object.create;if(n){var i=n(null),r=n(null);i[" size"]=r[" size"]=0}e.exports=function(e){function o(t,o){var n;if(null!=t&&(n=t[o]),"function"!=typeof n){var i="Object "+a.classString(t)+" has no method '"+a.toString(o)+"'";throw new e.TypeError(i)}return n}function n(t){return o(t,this.pop()).apply(t,this)}function i(t){return t[this]}function r(t){var e=+this;return 0>e&&(e=Math.max(0,e+t.length)),t[e]}var s,a=t("./util"),l=a.canEvaluate;a.isIdentifier,e.prototype.call=function(t){var e=[].slice.call(arguments,1);return e.push(t),this._then(n,void 0,void 0,e,void 0)},e.prototype.get=function(t){var e;if("number"==typeof t)e=r;else if(l){var o=s(t);e=null!==o?o:i}else e=i;return this._then(e,void 0,void 0,t,void 0)}}},{"./util":36}],6:[function(t,e,o){"use strict";e.exports=function(e,o,n,i){var r=t("./util"),s=r.tryCatch,a=r.errorObj,l=e._async;e.prototype.break=e.prototype.cancel=function(){if(!i.cancellation())return this._warn("cancellation is disabled");for(var t=this,e=t;t._isCancellable();){if(!t._cancelBy(e)){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}var o=t._cancellationParent;if(null==o||!o._isCancellable()){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}t._isFollowing()&&t._followee().cancel(),t._setWillBeCancelled(),e=t,t=o}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(t){return t===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),l.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(t,e){if(r.isArray(t))for(var o=0;o<t.length;++o)this._doInvokeOnCancel(t[o],e);else if(void 0!==t)if("function"==typeof t){if(!e){var n=s(t).call(this._boundValue());n===a&&(this._attachExtraTrace(n.e),l.throwLater(n.e))}}else t._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var t=this._onCancel();this._unsetOnCancel(),l.invoke(this._doInvokeOnCancel,this,t)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(t,e,o){"use strict";e.exports=function(e){function o(t,o,a){return function(l){var c=a._boundValue();t:for(var u=0;u<t.length;++u){var h=t[u];if(h===Error||null!=h&&h.prototype instanceof Error){if(l instanceof h)return r(o).call(c,l)}else if("function"==typeof h){var g=r(h).call(c,l);if(g===s)return g;if(g)return r(o).call(c,l)}else if(n.isObject(l)){for(var p=i(h),d=0;d<p.length;++d){var f=p[d];if(h[f]!=l[f])continue t}return r(o).call(c,l)}}return e}}var n=t("./util"),i=t("./es5").keys,r=n.tryCatch,s=n.errorObj;return o}},{"./es5":13,"./util":36}],8:[function(t,e,o){"use strict";e.exports=function(t){function e(){this._trace=new e.CapturedTrace(n())}function o(){return i?new e:void 0}function n(){var t=r.length-1;return t>=0?r[t]:void 0}var i=!1,r=[];return t.prototype._promiseCreated=function(){},t.prototype._pushContext=function(){},t.prototype._popContext=function(){return null},t._peekContext=t.prototype._peekContext=function(){},e.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,r.push(this._trace))},e.prototype._popContext=function(){if(void 0!==this._trace){var t=r.pop(),e=t._promiseCreated;return t._promiseCreated=null,e}return null},e.CapturedTrace=null,e.create=o,e.deactivateLongStackTraces=function(){},e.activateLongStackTraces=function(){var o=t.prototype._pushContext,r=t.prototype._popContext,s=t._peekContext,a=t.prototype._peekContext,l=t.prototype._promiseCreated;e.deactivateLongStackTraces=function(){t.prototype._pushContext=o,t.prototype._popContext=r,t._peekContext=s,t.prototype._peekContext=a,t.prototype._promiseCreated=l,i=!1},i=!0,t.prototype._pushContext=e.prototype._pushContext,t.prototype._popContext=e.prototype._popContext,t._peekContext=t.prototype._peekContext=n,t.prototype._promiseCreated=function(){var t=this._peekContext();t&&null==t._promiseCreated&&(t._promiseCreated=this)}},e}},{}],9:[function(t,o,n){"use strict";o.exports=function(o,n){function i(t,e){return{promise:e}}function r(){return!1}function s(t,e,o){var n=this;try{t(e,o,function(t){if("function"!=typeof t)throw new TypeError("onCancel must be a function, got: "+F.toString(t));n._attachCancellationCallback(t)})}catch(t){return t}}function a(t){if(!this._isCancellable())return this;var e=this._onCancel();void 0!==e?F.isArray(e)?e.push(t):this._setOnCancel([e,t]):this._setOnCancel(t)}function l(){return this._onCancelField}function c(t){this._onCancelField=t}function u(){this._cancellationParent=void 0,this._onCancelField=void 0}function h(t,e){if(0!=(1&e)){this._cancellationParent=t;var o=t._branchesRemainingToCancel;void 0===o&&(o=0),t._branchesRemainingToCancel=o+1}0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}function g(t,e){0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}function p(){var t=this._boundTo;return void 0!==t&&t instanceof o?t.isFulfilled()?t.value():void 0:t}function d(){this._trace=new L(this._peekContext())}function f(t,e){if(H(t)){var o=this._trace;if(void 0!==o&&e&&(o=o._parent),void 0!==o)o.attachExtraTrace(t);else if(!t.__stackCleaned__){var n=T(t);F.notEnumerableProp(t,"stack",n.message+"\n"+n.stack.join("\n")),F.notEnumerableProp(t,"__stackCleaned__",!0)}}}function m(t,e,o,n,i){if(void 0===t&&null!==e&&$){if(void 0!==i&&i._returnedNonUndefined())return;if(0==(65535&n._bitField))return;o&&(o+=" ");var r="",s="";if(e._trace){for(var a=e._trace.stack.split("\n"),l=x(a),c=l.length-1;c>=0;--c){var u=l[c];if(!G.test(u)){var h=u.match(V);h&&(r="at "+h[1]+":"+h[2]+":"+h[3]+" ");break}}if(l.length>0)for(var g=l[0],c=0;c<a.length;++c)if(a[c]===g){c>0&&(s="\n"+a[c-1]);break}}var p="a promise was created in a "+o+"handler "+r+"but was not returned from it, see http://goo.gl/rRqMUw"+s;n._warn(p,!0,e)}}function y(t,e){var o=t+" is deprecated and will be removed in a future version.";return e&&(o+=" Use "+e+" instead."),v(o)}function v(t,e,n){if(st.warnings){var i,r=new j(t);if(e)n._attachExtraTrace(r);else if(st.longStackTraces&&(i=o._peekContext()))i.attachExtraTrace(r);else{var s=T(r);r.stack=s.message+"\n"+s.stack.join("\n")}et("warning",r)||w(r,"",!0)}}function _(t,e){for(var o=0;o<e.length-1;++o)e[o].push("From previous event:"),e[o]=e[o].join("\n");return o<e.length&&(e[o]=e[o].join("\n")),t+"\n"+e.join("\n")}function b(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}function E(t){for(var e=t[0],o=1;o<t.length;++o){for(var n=t[o],i=e.length-1,r=e[i],s=-1,a=n.length-1;a>=0;--a)if(n[a]===r){s=a;break}for(var a=s;a>=0;--a){var l=n[a];if(e[i]!==l)break;e.pop(),i--}e=n}}function x(t){for(var e=[],o=0;o<t.length;++o){var n=t[o],i="    (No stack trace)"===n||W.test(n),r=i&&nt(n);i&&!r&&(q&&" "!==n.charAt(0)&&(n="    "+n),e.push(n))}return e}function S(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),o=0;o<e.length;++o){var n=e[o];if("    (No stack trace)"===n||W.test(n))break}return o>0&&"SyntaxError"!=t.name&&(e=e.slice(o)),e}function T(t){var e=t.stack,o=t.toString();return e="string"==typeof e&&e.length>0?S(t):["    (No stack trace)"],{message:o,stack:"SyntaxError"==t.name?e:x(e)}}function w(t,e,o){if("undefined"!=typeof console){var n;if(F.isObject(t)){var i=t.stack;n=e+z(i,t)}else n=e+String(t);"function"==typeof D?D(n,o):("function"==typeof console.log||"object"==typeof console.log)&&console.log(n)}}function C(t,e,o,n){var i=!1;try{"function"==typeof e&&(i=!0,"rejectionHandled"===t?e(n):e(o,n))}catch(t){P.throwLater(t)}"unhandledRejection"===t?et(t,o,n)||i||w(o,"Unhandled rejection "):et(t,n)}function k(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{e=t&&"function"==typeof t.toString?t.toString():F.toString(t);if(/\[object [a-zA-Z0-9$_]+\]/.test(e))try{e=JSON.stringify(t)}catch(t){}0===e.length&&(e="(empty array)")}return"(<"+A(e)+">, no stack trace)"}function A(t){return t.length<41?t:t.substr(0,38)+"..."}function I(){return"function"==typeof rt}function B(t){var e=t.match(it);return e?{fileName:e[1],line:parseInt(e[2],10)}:void 0}function M(t,e){if(I()){for(var o,n,i=t.stack.split("\n"),r=e.stack.split("\n"),s=-1,a=-1,l=0;l<i.length;++l){var c=B(i[l]);if(c){o=c.fileName,s=c.line;break}}for(var l=0;l<r.length;++l){var c=B(r[l]);if(c){n=c.fileName,a=c.line;break}}0>s||0>a||!o||!n||o!==n||s>=a||(nt=function(t){if(U.test(t))return!0;var e=B(t);return!!(e&&e.fileName===o&&s<=e.line&&e.line<=a)})}}function L(t){this._parent=t,this._promisesCreated=0;var e=this._length=1+(void 0===t?0:t._length);rt(this,L),e>32&&this.uncycle()}var N,R,D,O=o._getDomain,P=o._async,j=t("./errors").Warning,F=t("./util"),H=F.canAttachTrace,U=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,G=/\((?:timers\.js):\d+:\d+\)/,V=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,W=null,z=null,q=!1,X=!(0==F.env("BLUEBIRD_DEBUG")||!F.env("BLUEBIRD_DEBUG")&&"development"!==F.env("NODE_ENV")),Y=!(0==F.env("BLUEBIRD_WARNINGS")||!X&&!F.env("BLUEBIRD_WARNINGS")),K=!(0==F.env("BLUEBIRD_LONG_STACK_TRACES")||!X&&!F.env("BLUEBIRD_LONG_STACK_TRACES")),$=0!=F.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(Y||!!F.env("BLUEBIRD_W_FORGOTTEN_RETURN"));o.prototype.suppressUnhandledRejections=function(){var t=this._target();t._bitField=-1048577&t._bitField|524288},o.prototype._ensurePossibleRejectionHandled=function(){0==(524288&this._bitField)&&(this._setRejectionIsUnhandled(),P.invokeLater(this._notifyUnhandledRejection,this,void 0))},o.prototype._notifyUnhandledRejectionIsHandled=function(){C("rejectionHandled",N,void 0,this)},o.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},o.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},o.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue();this._setUnhandledRejectionIsNotified(),C("unhandledRejection",R,t,this)}},o.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},o.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},o.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},o.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},o.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},o.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},o.prototype._warn=function(t,e,o){return v(t,e,o||this)},o.onPossiblyUnhandledRejection=function(t){var e=O();R="function"==typeof t?null===e?t:F.domainBind(e,t):void 0},o.onUnhandledRejectionHandled=function(t){var e=O();N="function"==typeof t?null===e?t:F.domainBind(e,t):void 0};var Q=function(){};o.longStackTraces=function(){if(P.haveItemsQueued()&&!st.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!st.longStackTraces&&I()){var t=o.prototype._captureStackTrace,e=o.prototype._attachExtraTrace;st.longStackTraces=!0,Q=function(){if(P.haveItemsQueued()&&!st.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");o.prototype._captureStackTrace=t,o.prototype._attachExtraTrace=e,n.deactivateLongStackTraces(),P.enableTrampoline(),st.longStackTraces=!1},o.prototype._captureStackTrace=d,o.prototype._attachExtraTrace=f,n.activateLongStackTraces(),P.disableTrampolineIfNecessary()}},o.hasLongStackTraces=function(){return st.longStackTraces&&I()};var J=function(){try{if("function"==typeof CustomEvent){var t=new CustomEvent("CustomEvent");return F.global.dispatchEvent(t),function(t,e){var o=new CustomEvent(t.toLowerCase(),{detail:e,cancelable:!0});return!F.global.dispatchEvent(o)}}if("function"==typeof Event){var t=new Event("CustomEvent");return F.global.dispatchEvent(t),function(t,e){var o=new Event(t.toLowerCase(),{cancelable:!0});return o.detail=e,!F.global.dispatchEvent(o)}}var t=document.createEvent("CustomEvent");return t.initCustomEvent("testingtheevent",!1,!0,{}),F.global.dispatchEvent(t),function(t,e){var o=document.createEvent("CustomEvent");return o.initCustomEvent(t.toLowerCase(),!1,!0,e),!F.global.dispatchEvent(o)}}catch(t){}return function(){return!1}}(),Z=function(){return F.isNode?function(){return e.emit.apply(e,arguments)}:F.global?function(t){var e="on"+t.toLowerCase(),o=F.global[e];return!!o&&(o.apply(F.global,[].slice.call(arguments,1)),!0)}:function(){return!1}}(),tt={promiseCreated:i,promiseFulfilled:i,promiseRejected:i,promiseResolved:i,promiseCancelled:i,promiseChained:function(t,e,o){return{promise:e,child:o}},warning:function(t,e){return{warning:e}},unhandledRejection:function(t,e,o){return{reason:e,promise:o}},rejectionHandled:i},et=function(t){var e=!1;try{e=Z.apply(null,arguments)}catch(t){P.throwLater(t),e=!0}var o=!1;try{o=J(t,tt[t].apply(null,arguments))}catch(t){P.throwLater(t),o=!0}return o||e};o.config=function(t){if(t=Object(t),"longStackTraces"in t&&(t.longStackTraces?o.longStackTraces():!t.longStackTraces&&o.hasLongStackTraces()&&Q()),"warnings"in t){var e=t.warnings;st.warnings=!!e,$=st.warnings,F.isObject(e)&&"wForgottenReturn"in e&&($=!!e.wForgottenReturn)}if("cancellation"in t&&t.cancellation&&!st.cancellation){if(P.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");o.prototype._clearCancellationData=u,o.prototype._propagateFrom=h,o.prototype._onCancel=l,o.prototype._setOnCancel=c,o.prototype._attachCancellationCallback=a,o.prototype._execute=s,ot=h,st.cancellation=!0}return"monitoring"in t&&(t.monitoring&&!st.monitoring?(st.monitoring=!0,o.prototype._fireEvent=et):!t.monitoring&&st.monitoring&&(st.monitoring=!1,o.prototype._fireEvent=r)),o},o.prototype._fireEvent=r,o.prototype._execute=function(t,e,o){try{t(e,o)}catch(t){return t}},o.prototype._onCancel=function(){},o.prototype._setOnCancel=function(t){},o.prototype._attachCancellationCallback=function(t){},o.prototype._captureStackTrace=function(){},o.prototype._attachExtraTrace=function(){},o.prototype._clearCancellationData=function(){},o.prototype._propagateFrom=function(t,e){};var ot=g,nt=function(){return!1},it=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;F.inherits(L,Error),n.CapturedTrace=L,L.prototype.uncycle=function(){var t=this._length;if(!(2>t)){for(var e=[],o={},n=0,i=this;void 0!==i;++n)e.push(i),i=i._parent;t=this._length=n;for(var n=t-1;n>=0;--n){var r=e[n].stack;void 0===o[r]&&(o[r]=n)}for(var n=0;t>n;++n){var s=e[n].stack,a=o[s];if(void 0!==a&&a!==n){a>0&&(e[a-1]._parent=void 0,e[a-1]._length=1),e[n]._parent=void 0,e[n]._length=1;var l=n>0?e[n-1]:this;t-1>a?(l._parent=e[a+1],l._parent.uncycle(),l._length=l._parent._length+1):(l._parent=void 0,l._length=1);for(var c=l._length+1,u=n-2;u>=0;--u)e[u]._length=c,c++;return}}}},L.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=T(t),o=e.message,n=[e.stack],i=this;void 0!==i;)n.push(x(i.stack.split("\n"))),i=i._parent;E(n),b(n),F.notEnumerableProp(t,"stack",_(o,n)),F.notEnumerableProp(t,"__stackCleaned__",!0)}};var rt=function(){var t=/^\s*at\s*/,e=function(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():k(e)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,W=t,z=e;var o=Error.captureStackTrace;return nt=function(t){return U.test(t)},function(t,e){Error.stackTraceLimit+=6,o(t,e),Error.stackTraceLimit-=6}}var n=new Error;if("string"==typeof n.stack&&n.stack.split("\n")[0].indexOf("stackDetection@")>=0)return W=/@/,z=e,q=!0,function(t){t.stack=(new Error).stack};var i;try{throw new Error}catch(t){i="stack"in t}return"stack"in n||!i||"number"!=typeof Error.stackTraceLimit?(z=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?k(e):e.toString()},null):(W=t,z=e,function(t){Error.stackTraceLimit+=6;try{throw new Error}catch(e){t.stack=e.stack}Error.stackTraceLimit-=6})}();"undefined"!=typeof console&&void 0!==console.warn&&(D=function(t){console.warn(t)},F.isNode&&e.stderr.isTTY?D=function(t,e){var o=e?"[33m":"[31m";console.warn(o+t+"[0m\n")}:F.isNode||"string"!=typeof(new Error).stack||(D=function(t,e){console.warn("%c"+t,e?"color: darkorange":"color: red")}));var st={warnings:Y,longStackTraces:!1,cancellation:!1,monitoring:!1};return K&&o.longStackTraces(),{longStackTraces:function(){return st.longStackTraces},warnings:function(){return st.warnings},cancellation:function(){return st.cancellation},monitoring:function(){return st.monitoring},propagateFromFunction:function(){return ot},boundValueFunction:function(){return p},checkForgottenReturns:m,setBounds:M,warn:v,deprecated:y,CapturedTrace:L,fireDomEvent:J,fireGlobalEvent:Z}}},{"./errors":12,"./util":36}],10:[function(t,e,o){"use strict";e.exports=function(t){function e(){return this.value}function o(){throw this.reason}t.prototype.return=t.prototype.thenReturn=function(o){return o instanceof t&&o.suppressUnhandledRejections(),this._then(e,void 0,void 0,{value:o},void 0)},t.prototype.throw=t.prototype.thenThrow=function(t){return this._then(o,void 0,void 0,{reason:t},void 0)},t.prototype.catchThrow=function(t){if(arguments.length<=1)return this._then(void 0,o,void 0,{reason:t},void 0);var e=arguments[1],n=function(){throw e};return this.caught(t,n)},t.prototype.catchReturn=function(o){if(arguments.length<=1)return o instanceof t&&o.suppressUnhandledRejections(),this._then(void 0,e,void 0,{value:o},void 0);var n=arguments[1];n instanceof t&&n.suppressUnhandledRejections();var i=function(){return n};return this.caught(o,i)}}},{}],11:[function(t,e,o){"use strict";e.exports=function(t,e){function o(){return r(this)}function n(t,o){return i(t,o,e,e)}var i=t.reduce,r=t.all;t.prototype.each=function(t){return i(this,t,e,0)._then(o,void 0,void 0,this,void 0)},t.prototype.mapSeries=function(t){return i(this,t,e,e)},t.each=function(t,n){return i(t,n,e,0)._then(o,void 0,void 0,t,void 0)},t.mapSeries=n}},{}],12:[function(t,e,o){"use strict";function n(t,e){function o(n){return this instanceof o?(h(this,"message","string"==typeof n?n:e),h(this,"name",t),void(Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this))):new o(n)}return u(o,Error),o}function i(t){return this instanceof i?(h(this,"name","OperationalError"),h(this,"message",t),this.cause=t,this.isOperational=!0,void(t instanceof Error?(h(this,"message",t.message),h(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new i(t)}var r,s,a=t("./es5"),l=a.freeze,c=t("./util"),u=c.inherits,h=c.notEnumerableProp,g=n("Warning","warning"),p=n("CancellationError","cancellation error"),d=n("TimeoutError","timeout error"),f=n("AggregateError","aggregate error");try{r=TypeError,s=RangeError}catch(t){r=n("TypeError","type error"),s=n("RangeError","range error")}for(var m="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),y=0;y<m.length;++y)"function"==typeof Array.prototype[m[y]]&&(f.prototype[m[y]]=Array.prototype[m[y]]);a.defineProperty(f.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),f.prototype.isOperational=!0;var v=0;f.prototype.toString=function(){var t=Array(4*v+1).join(" "),e="\n"+t+"AggregateError of:\n";v++,t=Array(4*v+1).join(" ");for(var o=0;o<this.length;++o){for(var n=this[o]===this?"[Circular AggregateError]":this[o]+"",i=n.split("\n"),r=0;r<i.length;++r)i[r]=t+i[r];n=i.join("\n"),e+=n+"\n"}return v--,e},u(i,Error);var _=Error.__BluebirdErrorTypes__;_||(_=l({CancellationError:p,TimeoutError:d,OperationalError:i,RejectionError:i,AggregateError:f}),a.defineProperty(Error,"__BluebirdErrorTypes__",{value:_,writable:!1,enumerable:!1,configurable:!1})),e.exports={Error:Error,TypeError:r,RangeError:s,CancellationError:_.CancellationError,OperationalError:_.OperationalError,TimeoutError:_.TimeoutError,AggregateError:_.AggregateError,Warning:g}},{"./es5":13,"./util":36}],13:[function(t,e,o){var n=function(){"use strict";return void 0===this}();if(n)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:n,propertyIsWritable:function(t,e){var o=Object.getOwnPropertyDescriptor(t,e);return!(o&&!o.writable&&!o.set)}};else{var i={}.hasOwnProperty,r={}.toString,s={}.constructor.prototype,a=function(t){var e=[];for(var o in t)i.call(t,o)&&e.push(o);return e},l=function(t,e){return{value:t[e]}},c=function(t,e,o){return t[e]=o.value,t},u=function(t){return t},h=function(t){try{return Object(t).constructor.prototype}catch(t){return s}},g=function(t){try{return"[object Array]"===r.call(t)}catch(t){return!1}};e.exports={isArray:g,keys:a,names:a,defineProperty:c,getDescriptor:l,freeze:u,getPrototypeOf:h,isES5:n,propertyIsWritable:function(){return!0}}}},{}],14:[function(t,e,o){"use strict";e.exports=function(t,e){var o=t.map;t.prototype.filter=function(t,n){return o(this,t,n,e)},t.filter=function(t,n,i){return o(t,n,i,e)}}},{}],15:[function(t,e,o){"use strict";e.exports=function(e,o,n){function i(t,e,o){this.promise=t,this.type=e,this.handler=o,this.called=!1,this.cancelPromise=null}function r(t){this.finallyHandler=t}function s(t,e){return null!=t.cancelPromise&&(arguments.length>1?t.cancelPromise._reject(e):t.cancelPromise._cancel(),t.cancelPromise=null,!0)}function a(){return c.call(this,this.promise._target()._settledValue())}function l(t){return s(this,t)?void 0:(g.e=t,g)}function c(t){var i=this.promise,c=this.handler;if(!this.called){this.called=!0;var u=this.isFinallyHandler()?c.call(i._boundValue()):c.call(i._boundValue(),t);if(u===n)return u;if(void 0!==u){i._setReturnedNonUndefined();var p=o(u,i);if(p instanceof e){if(null!=this.cancelPromise){if(p._isCancelled()){var d=new h("late cancellation observer");return i._attachExtraTrace(d),g.e=d,g}p.isPending()&&p._attachCancellationCallback(new r(this))}return p._then(a,l,void 0,this,void 0)}}}return i.isRejected()?(s(this),g.e=t,g):(s(this),t)}var u=t("./util"),h=e.CancellationError,g=u.errorObj,p=t("./catch_filter")(n);return i.prototype.isFinallyHandler=function(){return 0===this.type},r.prototype._resultCancelled=function(){s(this.finallyHandler)},e.prototype._passThrough=function(t,e,o,n){return"function"!=typeof t?this.then():this._then(o,n,void 0,new i(this,e,t),void 0)},e.prototype.lastly=e.prototype.finally=function(t){return this._passThrough(t,0,c,c)},e.prototype.tap=function(t){return this._passThrough(t,1,c)},e.prototype.tapCatch=function(t){var o=arguments.length;if(1===o)return this._passThrough(t,1,void 0,c);var n,i=new Array(o-1),r=0;for(n=0;o-1>n;++n){var s=arguments[n];if(!u.isObject(s))return e.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+u.classString(s)));i[r++]=s}i.length=r;var a=arguments[n];return this._passThrough(p(i,a,this),1,void 0,c)},i}},{"./catch_filter":7,"./util":36}],16:[function(t,e,o){"use strict";e.exports=function(e,o,n,i,r,s){function a(t,o,n){for(var r=0;r<o.length;++r){n._pushContext();var s=p(o[r])(t);if(n._popContext(),s===g){n._pushContext();var a=e.reject(g.e);return n._popContext(),a}var l=i(s,n);if(l instanceof e)return l}return null}function l(t,o,i,r){if(s.cancellation()){var a=new e(n),l=this._finallyPromise=new e(n);this._promise=a.lastly(function(){return l}),a._captureStackTrace(),a._setOnCancel(this)}else{(this._promise=new e(n))._captureStackTrace()}this._stack=r,this._generatorFunction=t,this._receiver=o,this._generator=void 0,this._yieldHandlers="function"==typeof i?[i].concat(d):d,this._yieldedPromise=null,this._cancellationPhase=!1}var c=t("./errors"),u=c.TypeError,h=t("./util"),g=h.errorObj,p=h.tryCatch,d=[];h.inherits(l,r),l.prototype._isResolved=function(){return null===this._promise},l.prototype._cleanup=function(){this._promise=this._generator=null,s.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},l.prototype._promiseCancelled=function(){if(!this._isResolved()){var t;if(void 0!==this._generator.return)this._promise._pushContext(),t=p(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var o=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=o,this._promise._attachExtraTrace(o),this._promise._pushContext(),t=p(this._generator.throw).call(this._generator,o),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t)}},l.prototype._promiseFulfilled=function(t){this._yieldedPromise=null,this._promise._pushContext();var e=p(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(e)},l.prototype._promiseRejected=function(t){this._yieldedPromise=null,this._promise._attachExtraTrace(t),this._promise._pushContext();var e=p(this._generator.throw).call(this._generator,t);this._promise._popContext(),this._continue(e)},l.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},l.prototype.promise=function(){return this._promise},l.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},l.prototype._continue=function(t){var o=this._promise;if(t===g)return this._cleanup(),this._cancellationPhase?o.cancel():o._rejectCallback(t.e,!1);var n=t.value;if(!0===t.done)return this._cleanup(),this._cancellationPhase?o.cancel():o._resolveCallback(n);var r=i(n,this._promise);if(!(r instanceof e)&&null===(r=a(r,this._yieldHandlers,this._promise)))return void this._promiseRejected(new u("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(n))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));r=r._target();var s=r._bitField;0==(50397184&s)?(this._yieldedPromise=r,r._proxy(this,null)):0!=(33554432&s)?e._async.invoke(this._promiseFulfilled,this,r._value()):0!=(16777216&s)?e._async.invoke(this._promiseRejected,this,r._reason()):this._promiseCancelled()},e.coroutine=function(t,e){if("function"!=typeof t)throw new u("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var o=Object(e).yieldHandler,n=l,i=(new Error).stack;return function(){var e=t.apply(this,arguments),r=new n(void 0,void 0,o,i),s=r.promise();return r._generator=e,r._promiseFulfilled(void 0),s}},e.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new u("expecting a function but got "+h.classString(t));d.push(t)},e.spawn=function(t){if(s.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof t)return o("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=new l(t,this),i=n.promise();return n._run(e.spawn),i}}},{"./errors":12,"./util":36}],17:[function(t,e,o){"use strict";e.exports=function(e,o,n,i,r,s){var a=t("./util");a.canEvaluate,a.tryCatch,a.errorObj,e.join=function(){var t,e=arguments.length-1;if(e>0&&"function"==typeof arguments[e]){t=arguments[e];var n}var i=[].slice.call(arguments);t&&i.pop();var n=new o(i).promise();return void 0!==t?n.spread(t):n}}},{"./util":36}],18:[function(t,e,o){"use strict";e.exports=function(e,o,n,i,r,s){function a(t,e,o,n){this.constructor$(t),this._promise._captureStackTrace();var i=c();this._callback=null===i?e:u.domainBind(i,e),this._preservedValues=n===r?new Array(this.length()):null,this._limit=o,this._inFlight=0,this._queue=[],p.invoke(this._asyncInit,this,void 0)}function l(t,o,i,r){if("function"!=typeof o)return n("expecting a function but got "+u.classString(o));var s=0;if(void 0!==i){if("object"!=typeof i||null===i)return e.reject(new TypeError("options argument must be an object but it is "+u.classString(i)));if("number"!=typeof i.concurrency)return e.reject(new TypeError("'concurrency' must be a number but it is "+u.classString(i.concurrency)));s=i.concurrency}return s="number"==typeof s&&isFinite(s)&&s>=1?s:0,new a(t,o,s,r).promise()}var c=e._getDomain,u=t("./util"),h=u.tryCatch,g=u.errorObj,p=e._async;u.inherits(a,o),a.prototype._asyncInit=function(){this._init$(void 0,-2)},a.prototype._init=function(){},a.prototype._promiseFulfilled=function(t,o){var n=this._values,r=this.length(),a=this._preservedValues,l=this._limit;if(0>o){if(o=-1*o-1,n[o]=t,l>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(l>=1&&this._inFlight>=l)return n[o]=t,this._queue.push(o),!1;null!==a&&(a[o]=t);var c=this._promise,u=this._callback,p=c._boundValue();c._pushContext();var d=h(u).call(p,t,o,r),f=c._popContext();if(s.checkForgottenReturns(d,f,null!==a?"Promise.filter":"Promise.map",c),d===g)return this._reject(d.e),!0;var m=i(d,this._promise);if(m instanceof e){m=m._target();var y=m._bitField;if(0==(50397184&y))return l>=1&&this._inFlight++,n[o]=m,m._proxy(this,-1*(o+1)),!1;if(0==(33554432&y))return 0!=(16777216&y)?(this._reject(m._reason()),!0):(this._cancel(),!0);d=m._value()}n[o]=d}return++this._totalResolved>=r&&(null!==a?this._filter(n,a):this._resolve(n),!0)},a.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,o=this._values;t.length>0&&this._inFlight<e;){if(this._isResolved())return;var n=t.pop();this._promiseFulfilled(o[n],n)}},a.prototype._filter=function(t,e){for(var o=e.length,n=new Array(o),i=0,r=0;o>r;++r)t[r]&&(n[i++]=e[r]);n.length=i,this._resolve(n)},a.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(t,e){return l(this,t,e,null)},e.map=function(t,e,o,n){return l(t,e,o,n)}}},{"./util":36}],19:[function(t,e,o){"use strict";e.exports=function(e,o,n,i,r){var s=t("./util"),a=s.tryCatch;e.method=function(t){if("function"!=typeof t)throw new e.TypeError("expecting a function but got "+s.classString(t));return function(){var n=new e(o);n._captureStackTrace(),n._pushContext();var i=a(t).apply(this,arguments),s=n._popContext();return r.checkForgottenReturns(i,s,"Promise.method",n),n._resolveFromSyncValue(i),n}},e.attempt=e.try=function(t){if("function"!=typeof t)return i("expecting a function but got "+s.classString(t));var n=new e(o);n._captureStackTrace(),n._pushContext();var l;if(arguments.length>1){r.deprecated("calling Promise.try with more than 1 argument");var c=arguments[1],u=arguments[2];l=s.isArray(c)?a(t).apply(u,c):a(t).call(u,c)}else l=a(t)();var h=n._popContext();return r.checkForgottenReturns(l,h,"Promise.try",n),n._resolveFromSyncValue(l),n},e.prototype._resolveFromSyncValue=function(t){t===s.errorObj?this._rejectCallback(t.e,!1):this._resolveCallback(t,!0)}}},{"./util":36}],20:[function(t,e,o){"use strict";function n(t){return t instanceof Error&&u.getPrototypeOf(t)===Error.prototype}function i(t){var e;if(n(t)){e=new c(t),e.name=t.name,e.message=t.message,e.stack=t.stack;for(var o=u.keys(t),i=0;i<o.length;++i){var r=o[i];h.test(r)||(e[r]=t[r])}return e}return s.markAsOriginatingFromRejection(t),t}function r(t,e){return function(o,n){if(null!==t){if(o){var r=i(a(o));t._attachExtraTrace(r),t._reject(r)}else if(e){var s=[].slice.call(arguments,1);t._fulfill(s)}else t._fulfill(n);t=null}}}var s=t("./util"),a=s.maybeWrapAsError,l=t("./errors"),c=l.OperationalError,u=t("./es5"),h=/^(?:name|message|stack|cause)$/;e.exports=r},{"./errors":12,"./es5":13,"./util":36}],21:[function(t,e,o){"use strict";e.exports=function(e){function o(t,e){var o=this;if(!r.isArray(t))return n.call(o,t,e);var i=a(e).apply(o._boundValue(),[null].concat(t));i===l&&s.throwLater(i.e)}function n(t,e){var o=this,n=o._boundValue(),i=void 0===t?a(e).call(n,null):a(e).call(n,null,t);i===l&&s.throwLater(i.e)}function i(t,e){var o=this;if(!t){var n=new Error(t+"");n.cause=t,t=n}var i=a(e).call(o._boundValue(),t);i===l&&s.throwLater(i.e)}var r=t("./util"),s=e._async,a=r.tryCatch,l=r.errorObj;e.prototype.asCallback=e.prototype.nodeify=function(t,e){if("function"==typeof t){var r=n;void 0!==e&&Object(e).spread&&(r=o),this._then(r,i,void 0,this,t)}return this}}},{"./util":36}],22:[function(t,o,n){"use strict";o.exports=function(){function n(){}function i(t,e){if(null==t||t.constructor!==r)throw new _("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof e)throw new _("expecting a function but got "+d.classString(e))}function r(t){t!==E&&i(this,t),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(t),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function s(t){this.promise._resolveCallback(t)}function a(t){this.promise._rejectCallback(t,!1)}function l(t){var e=new r(E);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._promise0=t,e._receiver0=t}var c,u=function(){return new _("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},h=function(){return new r.PromiseInspection(this._target())},g=function(t){return r.reject(new _(t))},p={},d=t("./util");c=d.isNode?function(){var t=e.domain;return void 0===t&&(t=null),t}:function(){return null},d.notEnumerableProp(r,"_getDomain",c);var f=t("./es5"),m=t("./async"),y=new m;f.defineProperty(r,"_async",{value:y});var v=t("./errors"),_=r.TypeError=v.TypeError;r.RangeError=v.RangeError;var b=r.CancellationError=v.CancellationError;r.TimeoutError=v.TimeoutError,r.OperationalError=v.OperationalError,r.RejectionError=v.OperationalError,r.AggregateError=v.AggregateError;var E=function(){},x={},S={},T=t("./thenables")(r,E),w=t("./promise_array")(r,E,T,g,n),C=t("./context")(r),k=C.create,A=t("./debuggability")(r,C),I=(A.CapturedTrace,t("./finally")(r,T,S)),B=t("./catch_filter")(S),M=t("./nodeback"),L=d.errorObj,N=d.tryCatch;return r.prototype.toString=function(){return"[object Promise]"},r.prototype.caught=r.prototype.catch=function(t){var e=arguments.length;if(e>1){var o,n=new Array(e-1),i=0;for(o=0;e-1>o;++o){var r=arguments[o];if(!d.isObject(r))return g("Catch statement predicate: expecting an object but got "+d.classString(r));n[i++]=r}return n.length=i,t=arguments[o],this.then(void 0,B(n,t,this))}return this.then(void 0,t)},r.prototype.reflect=function(){return this._then(h,h,void 0,this,void 0)},r.prototype.then=function(t,e){if(A.warnings()&&arguments.length>0&&"function"!=typeof t&&"function"!=typeof e){var o=".then() only accepts functions but was passed: "+d.classString(t);arguments.length>1&&(o+=", "+d.classString(e)),this._warn(o)}return this._then(t,e,void 0,void 0,void 0)},r.prototype.done=function(t,e){this._then(t,e,void 0,void 0,void 0)._setIsFinal()},r.prototype.spread=function(t){return"function"!=typeof t?g("expecting a function but got "+d.classString(t)):this.all()._then(t,void 0,void 0,x,void 0)},r.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},r.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new w(this).promise()},r.prototype.error=function(t){return this.caught(d.originatesFromRejection,t)},r.getNewLibraryCopy=o.exports,r.is=function(t){return t instanceof r},r.fromNode=r.fromCallback=function(t){var e=new r(E);e._captureStackTrace();var o=arguments.length>1&&!!Object(arguments[1]).multiArgs,n=N(t)(M(e,o));return n===L&&e._rejectCallback(n.e,!0),e._isFateSealed()||e._setAsyncGuaranteed(),e},r.all=function(t){return new w(t).promise()},r.cast=function(t){var e=T(t);return e instanceof r||(e=new r(E),e._captureStackTrace(),e._setFulfilled(),e._rejectionHandler0=t),e},r.resolve=r.fulfilled=r.cast,r.reject=r.rejected=function(t){var e=new r(E);return e._captureStackTrace(),e._rejectCallback(t,!0),e},r.setScheduler=function(t){if("function"!=typeof t)throw new _("expecting a function but got "+d.classString(t));return y.setScheduler(t)},r.prototype._then=function(t,e,o,n,i){var s=void 0!==i,a=s?i:new r(E),l=this._target(),u=l._bitField;s||(a._propagateFrom(this,3),a._captureStackTrace(),void 0===n&&0!=(2097152&this._bitField)&&(n=0!=(50397184&u)?this._boundValue():l===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,a));var h=c();if(0!=(50397184&u)){var g,p,f=l._settlePromiseCtx;0!=(33554432&u)?(p=l._rejectionHandler0,g=t):0!=(16777216&u)?(p=l._fulfillmentHandler0,g=e,l._unsetRejectionIsUnhandled()):(f=l._settlePromiseLateCancellationObserver,p=new b("late cancellation observer"),l._attachExtraTrace(p),g=e),y.invoke(f,l,{handler:null===h?g:"function"==typeof g&&d.domainBind(h,g),promise:a,receiver:n,value:p})}else l._addCallbacks(t,e,a,n,h);return a},r.prototype._length=function(){return 65535&this._bitField},r.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},r.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},r.prototype._setLength=function(t){this._bitField=-65536&this._bitField|65535&t},r.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},r.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},r.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},r.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},r.prototype._isFinal=function(){return(4194304&this._bitField)>0},r.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},r.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},r.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},r.prototype._setAsyncGuaranteed=function(){y.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},r.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[4*t-4+3];return e===p?void 0:void 0===e&&this._isBound()?this._boundValue():e},r.prototype._promiseAt=function(t){return this[4*t-4+2]},r.prototype._fulfillmentHandlerAt=function(t){return this[4*t-4+0]},r.prototype._rejectionHandlerAt=function(t){return this[4*t-4+1]},r.prototype._boundValue=function(){},r.prototype._migrateCallback0=function(t){var e=(t._bitField,t._fulfillmentHandler0),o=t._rejectionHandler0,n=t._promise0,i=t._receiverAt(0);void 0===i&&(i=p),this._addCallbacks(e,o,n,i,null)},r.prototype._migrateCallbackAt=function(t,e){var o=t._fulfillmentHandlerAt(e),n=t._rejectionHandlerAt(e),i=t._promiseAt(e),r=t._receiverAt(e);void 0===r&&(r=p),this._addCallbacks(o,n,i,r,null)},r.prototype._addCallbacks=function(t,e,o,n,i){var r=this._length();if(r>=65531&&(r=0,this._setLength(0)),0===r)this._promise0=o,this._receiver0=n,"function"==typeof t&&(this._fulfillmentHandler0=null===i?t:d.domainBind(i,t)),"function"==typeof e&&(this._rejectionHandler0=null===i?e:d.domainBind(i,e));else{var s=4*r-4;this[s+2]=o,this[s+3]=n,"function"==typeof t&&(this[s+0]=null===i?t:d.domainBind(i,t)),"function"==typeof e&&(this[s+1]=null===i?e:d.domainBind(i,e))}return this._setLength(r+1),r},r.prototype._proxy=function(t,e){this._addCallbacks(void 0,void 0,e,t,null)},r.prototype._resolveCallback=function(t,e){if(0==(117506048&this._bitField)){if(t===this)return this._rejectCallback(u(),!1);var o=T(t,this);if(!(o instanceof r))return this._fulfill(t);e&&this._propagateFrom(o,2);var n=o._target();if(n===this)return void this._reject(u());var i=n._bitField;if(0==(50397184&i)){var s=this._length();s>0&&n._migrateCallback0(this);for(var a=1;s>a;++a)n._migrateCallbackAt(this,a);this._setFollowing(),this._setLength(0),this._setFollowee(n)}else if(0!=(33554432&i))this._fulfill(n._value());else if(0!=(16777216&i))this._reject(n._reason());else{var l=new b("late cancellation observer");n._attachExtraTrace(l),this._reject(l)}}},r.prototype._rejectCallback=function(t,e,o){var n=d.ensureErrorObject(t),i=n===t;if(!i&&!o&&A.warnings()){var r="a promise was rejected with a non-error: "+d.classString(t);this._warn(r,!0)}this._attachExtraTrace(n,!!e&&i),this._reject(t)},r.prototype._resolveFromExecutor=function(t){if(t!==E){var e=this;this._captureStackTrace(),this._pushContext();var o=!0,n=this._execute(t,function(t){e._resolveCallback(t)},function(t){e._rejectCallback(t,o)});o=!1,this._popContext(),void 0!==n&&e._rejectCallback(n,!0)}},r.prototype._settlePromiseFromHandler=function(t,e,o,n){var i=n._bitField;if(0==(65536&i)){n._pushContext();var r;e===x?o&&"number"==typeof o.length?r=N(t).apply(this._boundValue(),o):(r=L,r.e=new _("cannot .spread() a non-array: "+d.classString(o))):r=N(t).call(e,o);var s=n._popContext();0==(65536&(i=n._bitField))&&(r===S?n._reject(o):r===L?n._rejectCallback(r.e,!1):(A.checkForgottenReturns(r,s,"",n,this),n._resolveCallback(r)))}},r.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},r.prototype._followee=function(){return this._rejectionHandler0},r.prototype._setFollowee=function(t){this._rejectionHandler0=t},r.prototype._settlePromise=function(t,e,o,i){var s=t instanceof r,a=this._bitField,l=0!=(134217728&a);0!=(65536&a)?(s&&t._invokeInternalOnCancel(),o instanceof I&&o.isFinallyHandler()?(o.cancelPromise=t,N(e).call(o,i)===L&&t._reject(L.e)):e===h?t._fulfill(h.call(o)):o instanceof n?o._promiseCancelled(t):s||t instanceof w?t._cancel():o.cancel()):"function"==typeof e?s?(l&&t._setAsyncGuaranteed(),this._settlePromiseFromHandler(e,o,i,t)):e.call(o,i,t):o instanceof n?o._isResolved()||(0!=(33554432&a)?o._promiseFulfilled(i,t):o._promiseRejected(i,t)):s&&(l&&t._setAsyncGuaranteed(),0!=(33554432&a)?t._fulfill(i):t._reject(i))},r.prototype._settlePromiseLateCancellationObserver=function(t){var e=t.handler,o=t.promise,n=t.receiver,i=t.value;"function"==typeof e?o instanceof r?this._settlePromiseFromHandler(e,n,i,o):e.call(n,i,o):o instanceof r&&o._reject(i)},r.prototype._settlePromiseCtx=function(t){this._settlePromise(t.promise,t.handler,t.receiver,t.value)},r.prototype._settlePromise0=function(t,e,o){var n=this._promise0,i=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(n,t,i,e)},r.prototype._clearCallbackDataAtIndex=function(t){var e=4*t-4;this[e+2]=this[e+3]=this[e+0]=this[e+1]=void 0},r.prototype._fulfill=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(t===this){var o=u();return this._attachExtraTrace(o),this._reject(o)}this._setFulfilled(),this._rejectionHandler0=t,(65535&e)>0&&(0!=(134217728&e)?this._settlePromises():y.settlePromises(this))}},r.prototype._reject=function(t){var e=this._bitField;if(!((117506048&e)>>>16))return this._setRejected(),this._fulfillmentHandler0=t,this._isFinal()?y.fatalError(t,d.isNode):void((65535&e)>0?y.settlePromises(this):this._ensurePossibleRejectionHandled())},r.prototype._fulfillPromises=function(t,e){for(var o=1;t>o;o++){var n=this._fulfillmentHandlerAt(o),i=this._promiseAt(o),r=this._receiverAt(o);this._clearCallbackDataAtIndex(o),this._settlePromise(i,n,r,e)}},r.prototype._rejectPromises=function(t,e){for(var o=1;t>o;o++){var n=this._rejectionHandlerAt(o),i=this._promiseAt(o),r=this._receiverAt(o);this._clearCallbackDataAtIndex(o),this._settlePromise(i,n,r,e)}},r.prototype._settlePromises=function(){var t=this._bitField,e=65535&t;if(e>0){if(0!=(16842752&t)){var o=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,o,t),this._rejectPromises(e,o)}else{var n=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,n,t),this._fulfillPromises(e,n)}this._setLength(0)}this._clearCancellationData()},r.prototype._settledValue=function(){var t=this._bitField;return 0!=(33554432&t)?this._rejectionHandler0:0!=(16777216&t)?this._fulfillmentHandler0:void 0},r.defer=r.pending=function(){return A.deprecated("Promise.defer","new Promise"),{promise:new r(E),resolve:s,reject:a}},d.notEnumerableProp(r,"_makeSelfResolutionError",u),t("./method")(r,E,T,g,A),t("./bind")(r,E,T,A),t("./cancel")(r,w,g,A),t("./direct_resolve")(r),t("./synchronous_inspection")(r),t("./join")(r,w,T,E,y,c),r.Promise=r,r.version="3.5.0",t("./map.js")(r,w,g,T,E,A),t("./call_get.js")(r),t("./using.js")(r,g,T,k,E,A),t("./timers.js")(r,E,A),t("./generators.js")(r,g,E,T,n,A),t("./nodeify.js")(r),t("./promisify.js")(r,E),t("./props.js")(r,w,T,g),t("./race.js")(r,E,T,g),t("./reduce.js")(r,w,g,T,E,A),t("./settle.js")(r,w,A),t("./some.js")(r,w,g),t("./filter.js")(r,E),t("./each.js")(r,E),t("./any.js")(r),d.toFastProperties(r),d.toFastProperties(r.prototype),l({a:1}),l({b:2}),l({c:3}),l(1),l(function(){}),l(void 0),l(!1),l(new r(E)),A.setBounds(m.firstLineError,d.lastLineError),r}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36}],23:[function(t,e,o){"use strict";e.exports=function(e,o,n,i,r){function s(t){switch(t){case-2:return[];case-3:return{};case-6:return new Map}}function a(t){var n=this._promise=new e(o);t instanceof e&&n._propagateFrom(t,3),n._setOnCancel(this),this._values=t,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var l=t("./util");return l.isArray,l.inherits(a,r),a.prototype.length=function(){return this._length},a.prototype.promise=function(){return this._promise},a.prototype._init=function t(o,r){var a=n(this._values,this._promise);if(a instanceof e){a=a._target();var c=a._bitField;if(this._values=a,0==(50397184&c))return this._promise._setAsyncGuaranteed(),a._then(t,this._reject,void 0,this,r);if(0==(33554432&c))return 0!=(16777216&c)?this._reject(a._reason()):this._cancel();a=a._value()}if(null===(a=l.asArray(a))){var u=i("expecting an array or an iterable object but got "+l.classString(a)).reason();return void this._promise._rejectCallback(u,!1)}return 0===a.length?void(-5===r?this._resolveEmptyArray():this._resolve(s(r))):void this._iterate(a)},a.prototype._iterate=function(t){var o=this.getActualLength(t.length);this._length=o,this._values=this.shouldCopyValues()?new Array(o):this._values;for(var i=this._promise,r=!1,s=null,a=0;o>a;++a){var l=n(t[a],i);l instanceof e?(l=l._target(),s=l._bitField):s=null,r?null!==s&&l.suppressUnhandledRejections():null!==s?0==(50397184&s)?(l._proxy(this,a),this._values[a]=l):r=0!=(33554432&s)?this._promiseFulfilled(l._value(),a):0!=(16777216&s)?this._promiseRejected(l._reason(),a):this._promiseCancelled(a):r=this._promiseFulfilled(l,a)}r||i._setAsyncGuaranteed()},a.prototype._isResolved=function(){return null===this._values},a.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},a.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},a.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1)},a.prototype._promiseFulfilled=function(t,e){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},a.prototype._promiseCancelled=function(){return this._cancel(),!0},a.prototype._promiseRejected=function(t){return this._totalResolved++,this._reject(t),!0},a.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var o=0;o<t.length;++o)t[o]instanceof e&&t[o].cancel()}},a.prototype.shouldCopyValues=function(){return!0},a.prototype.getActualLength=function(t){return t},a}},{"./util":36}],24:[function(t,e,o){"use strict";e.exports=function(e,o){function n(t){return!b.test(t)}function i(t){try{return!0===t.__isPromisified__}catch(t){return!1}}function r(t,e,o){var n=g.getDataPropertyOrDefault(t,e+o,v);return!!n&&i(n)}function s(t,e,o){for(var n=0;n<t.length;n+=2){var i=t[n];if(o.test(i))for(var r=i.replace(o,""),s=0;s<t.length;s+=2)if(t[s]===r)throw new y("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",e))}}function a(t,e,o,n){for(var a=g.inheritedDataKeys(t),l=[],c=0;c<a.length;++c){var u=a[c],h=t[u],p=n===E||E(u,h,t);"function"!=typeof h||i(h)||r(t,u,e)||!n(u,h,t,p)||l.push(u,h)}return s(l,e,o),l}function l(t,n,i,r,s,a){function l(){var i=n;n===h&&(i=this);var r=new e(o);r._captureStackTrace();var s="string"==typeof u&&this!==c?this[u]:t,l=p(r,a);try{s.apply(i,d(arguments,l))}catch(t){r._rejectCallback(f(t),!0,!0)}return r._isFateSealed()||r._setAsyncGuaranteed(),r}var c=function(){return this}(),u=t;return"string"==typeof u&&(t=r),g.notEnumerableProp(l,"__isPromisified__",!0),l}function c(t,e,o,n,i){for(var r=new RegExp(x(e)+"$"),s=a(t,e,r,o),l=0,c=s.length;c>l;l+=2){var u=s[l],p=s[l+1],d=u+e;if(n===S)t[d]=S(u,h,u,p,e,i);else{var f=n(p,function(){return S(u,h,u,p,e,i)});g.notEnumerableProp(f,"__isPromisified__",!0),t[d]=f}}return g.toFastProperties(t),t}function u(t,e,o){return S(t,e,void 0,t,null,o)}var h={},g=t("./util"),p=t("./nodeback"),d=g.withAppended,f=g.maybeWrapAsError,m=g.canEvaluate,y=t("./errors").TypeError,v={__isPromisified__:!0},_=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],b=new RegExp("^(?:"+_.join("|")+")$"),E=function(t){return g.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t},x=function(t){return t.replace(/([$])/,"\\$")},S=m?void 0:l;e.promisify=function(t,e){if("function"!=typeof t)throw new y("expecting a function but got "+g.classString(t));if(i(t))return t;e=Object(e);var o=void 0===e.context?h:e.context,r=!!e.multiArgs,s=u(t,o,r);return g.copyDescriptors(t,s,n),s},e.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new y("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");e=Object(e);var o=!!e.multiArgs,n=e.suffix;"string"!=typeof n&&(n="Async");var i=e.filter;"function"!=typeof i&&(i=E);var r=e.promisifier;if("function"!=typeof r&&(r=S),!g.isIdentifier(n))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var s=g.inheritedDataKeys(t),a=0;a<s.length;++a){var l=t[s[a]];"constructor"!==s[a]&&g.isClass(l)&&(c(l.prototype,n,i,r,o),c(l,n,i,r,o))}return c(t,n,i,r,o)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(t,e,o){"use strict";e.exports=function(e,o,n,i){function r(t){var e,o=!1;if(void 0!==a&&t instanceof a)e=h(t),o=!0;else{var n=u.keys(t),i=n.length;e=new Array(2*i);for(var r=0;i>r;++r){var s=n[r];e[r]=t[s],e[r+i]=s}}this.constructor$(e),this._isMap=o,this._init$(void 0,o?-6:-3)}function s(t){var o,s=n(t);return c(s)?(o=s instanceof e?s._then(e.props,void 0,void 0,void 0,void 0):new r(s).promise(),s instanceof e&&o._propagateFrom(s,2),o):i("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}var a,l=t("./util"),c=l.isObject,u=t("./es5");"function"==typeof Map&&(a=Map);var h=function(){function t(t,n){this[e]=t,this[e+o]=n,e++}var e=0,o=0;return function(n){o=n.size,e=0;var i=new Array(2*n.size);return n.forEach(t,i),i}}(),g=function(t){for(var e=new a,o=t.length/2|0,n=0;o>n;++n){var i=t[o+n],r=t[n];e.set(i,r)}return e};l.inherits(r,o),r.prototype._init=function(){},r.prototype._promiseFulfilled=function(t,e){if(this._values[e]=t,++this._totalResolved>=this._length){var o;if(this._isMap)o=g(this._values);else{o={};for(var n=this.length(),i=0,r=this.length();r>i;++i)o[this._values[i+n]]=this._values[i]}return this._resolve(o),!0}return!1},r.prototype.shouldCopyValues=function(){return!1},r.prototype.getActualLength=function(t){return t>>1},e.prototype.props=function(){return s(this)},e.props=function(t){return s(t)}}},{"./es5":13,"./util":36}],26:[function(t,e,o){"use strict";function n(t,e,o,n,i){for(var r=0;i>r;++r)o[r+n]=t[r+e],t[r+e]=void 0}function i(t){this._capacity=t,this._length=0,this._front=0}i.prototype._willBeOverCapacity=function(t){return this._capacity<t},i.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1),this[this._front+e&this._capacity-1]=t,this._length=e+1},i.prototype.push=function(t,e,o){var n=this.length()+3;if(this._willBeOverCapacity(n))return this._pushOne(t),this._pushOne(e),void this._pushOne(o);var i=this._front+n-3;this._checkCapacity(n);var r=this._capacity-1;this[i+0&r]=t,this[i+1&r]=e,this[i+2&r]=o,this._length=n},i.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},i.prototype.length=function(){return this._length},i.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},i.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t,n(this,0,this,e,this._front+this._length&e-1)},e.exports=i},{}],27:[function(t,e,o){"use strict";e.exports=function(e,o,n,i){function r(t,r){var l=n(t);if(l instanceof e)return a(l);if(null===(t=s.asArray(t)))return i("expecting an array or an iterable object but got "+s.classString(t));var c=new e(o);void 0!==r&&c._propagateFrom(r,3);for(var u=c._fulfill,h=c._reject,g=0,p=t.length;p>g;++g){var d=t[g];(void 0!==d||g in t)&&e.cast(d)._then(u,h,void 0,c,null)}return c}var s=t("./util"),a=function(t){return t.then(function(e){return r(e,t)})};e.race=function(t){return r(t,void 0)},e.prototype.race=function(){return r(this,void 0)}}},{"./util":36}],28:[function(t,e,o){"use strict";e.exports=function(e,o,n,i,r,s){function a(t,o,n,i){this.constructor$(t);var s=g();this._fn=null===s?o:p.domainBind(s,o),void 0!==n&&(n=e.resolve(n),n._attachCancellationCallback(this)),this._initialValue=n,this._currentCancellable=null,this._eachValues=i===r?Array(this._length):0===i?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function l(t,e){this.isFulfilled()?e._resolve(t):e._reject(t)}function c(t,e,o,i){return"function"!=typeof e?n("expecting a function but got "+p.classString(e)):new a(t,e,o,i).promise()}function u(t){this.accum=t,this.array._gotAccum(t);var o=i(this.value,this.array._promise);return o instanceof e?(this.array._currentCancellable=o,o._then(h,void 0,void 0,this,void 0)):h.call(this,o)}function h(t){var o=this.array,n=o._promise,i=d(o._fn);n._pushContext();var r;(r=void 0!==o._eachValues?i.call(n._boundValue(),t,this.index,this.length):i.call(n._boundValue(),this.accum,t,this.index,this.length))instanceof e&&(o._currentCancellable=r);var a=n._popContext();return s.checkForgottenReturns(r,a,void 0!==o._eachValues?"Promise.each":"Promise.reduce",n),r}var g=e._getDomain,p=t("./util"),d=p.tryCatch;p.inherits(a,o),a.prototype._gotAccum=function(t){void 0!==this._eachValues&&null!==this._eachValues&&t!==r&&this._eachValues.push(t)},a.prototype._eachComplete=function(t){return null!==this._eachValues&&this._eachValues.push(t),this._eachValues},a.prototype._init=function(){},a.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},a.prototype.shouldCopyValues=function(){return!1},a.prototype._resolve=function(t){this._promise._resolveCallback(t),this._values=null},a.prototype._resultCancelled=function(t){return t===this._initialValue?this._cancel():void(this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel()))},a.prototype._iterate=function(t){this._values=t;var o,n,i=t.length;if(void 0!==this._initialValue?(o=this._initialValue,n=0):(o=e.resolve(t[0]),n=1),this._currentCancellable=o,!o.isRejected())for(;i>n;++n){var r={accum:null,value:t[n],index:n,length:i,array:this};o=o._then(u,void 0,void 0,r,void 0)}void 0!==this._eachValues&&(o=o._then(this._eachComplete,void 0,void 0,this,void 0)),o._then(l,l,void 0,o,this)},e.prototype.reduce=function(t,e){return c(this,t,e,null)},e.reduce=function(t,e,o,n){return c(t,e,o,n)}}},{"./util":36}],29:[function(t,o,r){"use strict";var s,a=t("./util"),l=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")},c=a.getNativePromise();if(a.isNode&&"undefined"==typeof MutationObserver){var u=n.setImmediate,h=e.nextTick;s=a.isRecentNode?function(t){u.call(n,t)}:function(t){h.call(e,t)}}else if("function"==typeof c&&"function"==typeof c.resolve){var g=c.resolve();s=function(t){g.then(t)}}else s="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?void 0!==i?function(t){i(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:l:function(){var t=document.createElement("div"),e={attributes:!0},o=!1,n=document.createElement("div");new MutationObserver(function(){t.classList.toggle("foo"),o=!1}).observe(n,e);var i=function(){o||(o=!0,n.classList.toggle("foo"))};return function(o){var n=new MutationObserver(function(){n.disconnect(),o()});n.observe(t,e),i()}}();o.exports=s},{"./util":36}],30:[function(t,e,o){"use strict";e.exports=function(e,o,n){function i(t){this.constructor$(t)}var r=e.PromiseInspection;t("./util").inherits(i,o),i.prototype._promiseResolved=function(t,e){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},i.prototype._promiseFulfilled=function(t,e){var o=new r;return o._bitField=33554432,o._settledValueField=t,this._promiseResolved(e,o)},i.prototype._promiseRejected=function(t,e){var o=new r;return o._bitField=16777216,o._settledValueField=t,this._promiseResolved(e,o)},e.settle=function(t){return n.deprecated(".settle()",".reflect()"),new i(t).promise()},e.prototype.settle=function(){return e.settle(this)}}},{"./util":36}],31:[function(t,e,o){"use strict";e.exports=function(e,o,n){function i(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function r(t,e){if((0|e)!==e||0>e)return n("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var o=new i(t),r=o.promise();return o.setHowMany(e),o.init(),r}var s=t("./util"),a=t("./errors").RangeError,l=t("./errors").AggregateError,c=s.isArray,u={};s.inherits(i,o),i.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var t=c(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},i.prototype.init=function(){this._initialized=!0,this._init()},i.prototype.setUnwrap=function(){this._unwrap=!0},i.prototype.howMany=function(){return this._howMany},i.prototype.setHowMany=function(t){this._howMany=t},i.prototype._promiseFulfilled=function(t){return this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},i.prototype._promiseRejected=function(t){return this._addRejected(t),this._checkOutcome()},i.prototype._promiseCancelled=function(){return this._values instanceof e||null==this._values?this._cancel():(this._addRejected(u),this._checkOutcome())},i.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var t=new l,e=this.length();e<this._values.length;++e)this._values[e]!==u&&t.push(this._values[e]);return t.length>0?this._reject(t):this._cancel(),!0}return!1},i.prototype._fulfilled=function(){return this._totalResolved},i.prototype._rejected=function(){return this._values.length-this.length()},i.prototype._addRejected=function(t){this._values.push(t)},i.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},i.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},i.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new a(e)},i.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(t,e){return r(t,e)},e.prototype.some=function(t){return r(this,t)},e._SomePromiseArray=i}},{"./errors":12,"./util":36}],32:[function(t,e,o){"use strict";e.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValueField=t._isFateSealed()?t._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var o=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},n=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=e.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},r=e.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},s=e.prototype.isPending=function(){return 0==(50397184&this._bitField)},a=e.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};e.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},t.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},t.prototype._isCancelled=function(){return this._target().__isCancelled()},t.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},t.prototype.isPending=function(){return s.call(this._target())},t.prototype.isRejected=function(){return r.call(this._target())},t.prototype.isFulfilled=function(){return i.call(this._target())},t.prototype.isResolved=function(){return a.call(this._target())},t.prototype.value=function(){return o.call(this._target())},t.prototype.reason=function(){var t=this._target();return t._unsetRejectionIsUnhandled(),n.call(t)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e}},{}],33:[function(t,e,o){"use strict";e.exports=function(e,o){function n(t,n){if(u(t)){if(t instanceof e)return t;var i=r(t);if(i===c){n&&n._pushContext();var l=e.reject(i.e);return n&&n._popContext(),l}if("function"==typeof i){if(s(t)){var l=new e(o);return t._then(l._fulfill,l._reject,void 0,l,null),l}return a(t,i,n)}}return t}function i(t){return t.then}function r(t){try{return i(t)}catch(t){return c.e=t,c}}function s(t){try{return h.call(t,"_promise0")}catch(t){return!1}}function a(t,n,i){function r(t){a&&(a._resolveCallback(t),a=null)}function s(t){a&&(a._rejectCallback(t,h,!0),a=null)}var a=new e(o),u=a;i&&i._pushContext(),a._captureStackTrace(),i&&i._popContext();var h=!0,g=l.tryCatch(n).call(t,r,s);return h=!1,a&&g===c&&(a._rejectCallback(g.e,!0,!0),a=null),u}var l=t("./util"),c=l.errorObj,u=l.isObject,h={}.hasOwnProperty;return n}},{"./util":36}],34:[function(t,e,o){"use strict";e.exports=function(e,o,n){function i(t){this.handle=t}function r(t){return clearTimeout(this.handle),t}function s(t){throw clearTimeout(this.handle),t}var a=t("./util"),l=e.TimeoutError;i.prototype._resultCancelled=function(){clearTimeout(this.handle)};var c=function(t){return u(+this).thenReturn(t)},u=e.delay=function(t,r){var s,a;return void 0!==r?(s=e.resolve(r)._then(c,null,null,t,void 0),n.cancellation()&&r instanceof e&&s._setOnCancel(r)):(s=new e(o),a=setTimeout(function(){s._fulfill()},+t),n.cancellation()&&s._setOnCancel(new i(a)),s._captureStackTrace()),s._setAsyncGuaranteed(),s};e.prototype.delay=function(t){return u(t,this)};var h=function(t,e,o){var n;n="string"!=typeof e?e instanceof Error?e:new l("operation timed out"):new l(e),a.markAsOriginatingFromRejection(n),t._attachExtraTrace(n),t._reject(n),null!=o&&o.cancel()};e.prototype.timeout=function(t,e){t=+t;var o,a,l=new i(setTimeout(function(){o.isPending()&&h(o,e,a)},t));return n.cancellation()?(a=this.then(),o=a._then(r,s,void 0,l,void 0),o._setOnCancel(l)):o=this._then(r,s,void 0,l,void 0),o}}},{"./util":36}],35:[function(t,e,o){"use strict";e.exports=function(e,o,n,i,r,s){function a(t){setTimeout(function(){throw t},0)}function l(t){var e=n(t);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}function c(t,o){function i(){if(s>=c)return u._fulfill();var r=l(t[s++]);if(r instanceof e&&r._isDisposable()){try{r=n(r._getDisposer().tryDispose(o),t.promise)}catch(t){return a(t)}if(r instanceof e)return r._then(i,a,null,null,null)}i()}var s=0,c=t.length,u=new e(r);return i(),u}function u(t,e,o){this._data=t,this._promise=e,this._context=o}function h(t,e,o){this.constructor$(t,e,o)}function g(t){return u.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}function p(t){this.length=t,this.promise=null,this[t-1]=null}var d=t("./util"),f=t("./errors").TypeError,m=t("./util").inherits,y=d.errorObj,v=d.tryCatch,_={};u.prototype.data=function(){return this._data},u.prototype.promise=function(){return this._promise},u.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():_},u.prototype.tryDispose=function(t){var e=this.resource(),o=this._context;void 0!==o&&o._pushContext();var n=e!==_?this.doDispose(e,t):null;return void 0!==o&&o._popContext(),this._promise._unsetDisposable(),this._data=null,n},u.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},m(h,u),h.prototype.doDispose=function(t,e){return this.data().call(t,t,e)},p.prototype._resultCancelled=function(){for(var t=this.length,o=0;t>o;++o){var n=this[o];n instanceof e&&n.cancel()}},e.using=function(){var t=arguments.length;if(2>t)return o("you must pass at least 2 arguments to Promise.using");var i=arguments[t-1];if("function"!=typeof i)return o("expecting a function but got "+d.classString(i));var r,a=!0;2===t&&Array.isArray(arguments[0])?(r=arguments[0],t=r.length,a=!1):(r=arguments,t--);for(var l=new p(t),h=0;t>h;++h){var f=r[h];if(u.isDisposer(f)){var m=f;f=f.promise(),f._setDisposable(m)}else{var _=n(f);_ instanceof e&&(f=_._then(g,null,null,{resources:l,index:h},void 0))}l[h]=f}for(var b=new Array(l.length),h=0;h<b.length;++h)b[h]=e.resolve(l[h]).reflect();var E=e.all(b).then(function(t){for(var e=0;e<t.length;++e){var o=t[e];if(o.isRejected())return y.e=o.error(),y;if(!o.isFulfilled())return void E.cancel();t[e]=o.value()}x._pushContext(),i=v(i);var n=a?i.apply(void 0,t):i(t),r=x._popContext();return s.checkForgottenReturns(n,r,"Promise.using",x),n}),x=E.lastly(function(){var t=new e.PromiseInspection(E);return c(l,t)});return l.promise=x,x._setOnCancel(l),x},e.prototype._setDisposable=function(t){this._bitField=131072|this._bitField,this._disposer=t},e.prototype._isDisposable=function(){return(131072&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},e.prototype.disposer=function(t){if("function"==typeof t)return new h(t,this,i());throw new f}}},{"./errors":12,"./util":36}],36:[function(t,o,i){"use strict";function r(){try{var t=A;return A=null,t.apply(this,arguments)}catch(t){return M.e=t,M}}function s(t){return A=t,r}function a(t){return null==t||!0===t||!1===t||"string"==typeof t||"number"==typeof t}function l(t){return"function"==typeof t||"object"==typeof t&&null!==t}function c(t){return a(t)?new Error(v(t)):t}function u(t,e){var o,n=t.length,i=new Array(n+1);for(o=0;n>o;++o)i[o]=t[o];return i[o]=e,i}function h(t,e,o){if(!I.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var n=Object.getOwnPropertyDescriptor(t,e);return null!=n?null==n.get&&null==n.set?n.value:o:void 0}function g(t,e,o){if(a(t))return t;var n={value:o,configurable:!0,enumerable:!1,writable:!0};return I.defineProperty(t,e,n),t}function p(t){throw t}function d(t){try{if("function"==typeof t){var e=I.names(t.prototype),o=I.isES5&&e.length>1,n=e.length>0&&!(1===e.length&&"constructor"===e[0]),i=D.test(t+"")&&I.names(t).length>0;if(o||n||i)return!0}return!1}catch(t){return!1}}function f(t){function e(){}e.prototype=t;for(var o=8;o--;)new e;return t}function m(t){return O.test(t)}function y(t,e,o){for(var n=new Array(t),i=0;t>i;++i)n[i]=e+i+o;return n}function v(t){try{return t+""}catch(t){return"[no string representation]"}}function _(t){return null!==t&&"object"==typeof t&&"string"==typeof t.message&&"string"==typeof t.name}function b(t){try{g(t,"isOperational",!0)}catch(t){}}function E(t){return null!=t&&(t instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===t.isOperational)}function x(t){return _(t)&&I.propertyIsWritable(t,"stack")}function S(t){return{}.toString.call(t)}function T(t,e,o){for(var n=I.names(t),i=0;i<n.length;++i){var r=n[i];if(o(r))try{I.defineProperty(e,r,I.getDescriptor(t,r))}catch(t){}}}function w(t){return U?e.env[t]:void 0}function C(){if("function"==typeof Promise)try{var t=new Promise(function(){});if("[object Promise]"==={}.toString.call(t))return Promise}catch(t){}}function k(t,e){return t.bind(e)}var A,I=t("./es5"),B="undefined"==typeof navigator,M={e:{}},L="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:void 0!==this?this:null,N=function(t,e){function o(){this.constructor=t,this.constructor$=e;for(var o in e.prototype)n.call(e.prototype,o)&&"$"!==o.charAt(o.length-1)&&(this[o+"$"]=e.prototype[o])}var n={}.hasOwnProperty;return o.prototype=e.prototype,t.prototype=new o,t.prototype},R=function(){var t=[Array.prototype,Object.prototype,Function.prototype],e=function(e){for(var o=0;o<t.length;++o)if(t[o]===e)return!0;return!1};if(I.isES5){var o=Object.getOwnPropertyNames;return function(t){for(var n=[],i=Object.create(null);null!=t&&!e(t);){var r;try{r=o(t)}catch(t){return n}for(var s=0;s<r.length;++s){var a=r[s];if(!i[a]){i[a]=!0;var l=Object.getOwnPropertyDescriptor(t,a);null!=l&&null==l.get&&null==l.set&&n.push(a)}}t=I.getPrototypeOf(t)}return n}}var n={}.hasOwnProperty;return function(o){if(e(o))return[];var i=[];t:for(var r in o)if(n.call(o,r))i.push(r);else{for(var s=0;s<t.length;++s)if(n.call(t[s],r))continue t;i.push(r)}return i}}(),D=/this\s*\.\s*\S+\s*=/,O=/^[a-z$_][a-z$_0-9]*$/i,P=function(){return"stack"in new Error?function(t){return x(t)?t:new Error(v(t))}:function(t){if(x(t))return t;try{throw new Error(v(t))}catch(t){return t}}}(),j=function(t){return I.isArray(t)?t:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var F="function"==typeof Array.from?function(t){return Array.from(t)}:function(t){for(var e,o=[],n=t[Symbol.iterator]();!(e=n.next()).done;)o.push(e.value);return o};j=function(t){return I.isArray(t)?t:null!=t&&"function"==typeof t[Symbol.iterator]?F(t):null}}var H=void 0!==e&&"[object process]"===S(e).toLowerCase(),U=void 0!==e&&void 0!==e.env,G={isClass:d,isIdentifier:m,inheritedDataKeys:R,getDataPropertyOrDefault:h,thrower:p,isArray:I.isArray,asArray:j,notEnumerableProp:g,isPrimitive:a,isObject:l,isError:_,canEvaluate:B,errorObj:M,tryCatch:s,inherits:N,withAppended:u,maybeWrapAsError:c,toFastProperties:f,filledRange:y,toString:v,canAttachTrace:x,ensureErrorObject:P,originatesFromRejection:E,markAsOriginatingFromRejection:b,classString:S,copyDescriptors:T,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:H,hasEnvVariables:U,env:w,global:L,getNativePromise:C,domainBind:k};G.isRecentNode=G.isNode&&function(){var t=e.versions.node.split(".").map(Number);return 0===t[0]&&t[1]>10||t[0]>0}(),G.isNode&&G.toFastProperties(e);try{throw new Error}catch(t){G.lastLineError=t}o.exports=G},{"./es5":13}]},{},[4])(4)}),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)}).call(e,o(3),o(0),o(2),o(21).setImmediate)},function(module,exports,__webpack_require__){(function(jQuery){/*!
 * CanJS - 1.1.6
 * http://canjs.us/
 * Copyright (c) 2013 Bitovi
 * Sat, 06 Jul 2013 14:06:51 GMT
 * Licensed MIT
 * Includes: can/construct/construct.js,can/observe/observe.js,can/observe/compute/compute.js,can/model/model.js,can/view/view.js,can/view/ejs/ejs.js,can/control/control.js,can/route/route.js,can/control/route/route.js,can/view/mustache/mustache.js,can/util/string/string.js
 * Download from: http://bitbuilder.herokuapp.com/can.custom.js?configuration=jquery&plugins=can%2Fconstruct%2Fconstruct.js&plugins=can%2Fobserve%2Fobserve.js&plugins=can%2Fobserve%2Fcompute%2Fcompute.js&plugins=can%2Fmodel%2Fmodel.js&plugins=can%2Fview%2Fview.js&plugins=can%2Fview%2Fejs%2Fejs.js&plugins=can%2Fcontrol%2Fcontrol.js&plugins=can%2Froute%2Froute.js&plugins=can%2Fcontrol%2Froute%2Froute.js&plugins=can%2Fview%2Fmustache%2Fmustache.js&plugins=can%2Futil%2Fstring%2Fstring.js
 */
!function(undefined){var __m5=function(){var t=window.can||{};"undefined"!=typeof GLOBALCAN&&!1===GLOBALCAN||(window.can=t),t.isDeferred=function(t){var e=this.isFunction;return t&&e(t.then)&&e(t.pipe)};var e=0;return t.cid=function(t,o){return t._cid?t._cid:t._cid=(o||"")+ ++e},t.VERSION="@EDGE",t}(),__m6=function(t){return t.each=function(t,e,o){var n,i=0;if(t)if("number"==typeof t.length&&t.pop)for(t.attr&&t.attr("length"),n=t.length;i<n&&!1!==e.call(o||t[i],t[i],i,t);i++);else if(t.hasOwnProperty)for(n in t)if(t.hasOwnProperty(n)&&!1===e.call(o||t[n],t[n],n,t))break;return t},t}(__m5),__m3=function(t,e){t.extend(e,t,{trigger:function(e,o,n){e.trigger?e.trigger(o,n):t.event.trigger(o,n,e,!0)},addEvent:function(e,o){return t([this]).bind(e,o),this},removeEvent:function(e,o){return t([this]).unbind(e,o),this},buildFragment:function(e,o){var n,i=t.buildFragment;return e=[e],o=o||document,o=!o.nodeType&&o[0]||o,o=o.ownerDocument||o,n=i.call(jQuery,e,o),n.cacheable?t.clone(n.fragment):n.fragment||n},$:t,each:e.each}),t.each(["bind","unbind","undelegate","delegate"],function(o,n){e[n]=function(){var e=this[n]?this:t([this]);return e[n].apply(e,arguments),this}}),t.each(["append","filter","addClass","remove","data","get"],function(t,o){e[o]=function(t){return t[o].apply(t,e.makeArray(arguments).slice(1))}});var o=t.cleanData;return t.cleanData=function(n){t.each(n,function(t,o){o&&e.trigger(o,"destroyed",[],!1)}),o(n)},e}(jQuery,__m5),__m2=function(t){var e=/_|-/,o=/\=\=/,n=/([A-Z]+)([A-Z][a-z])/g,i=/([a-z\d])([A-Z])/g,r=/([a-z\d])([A-Z])/g,s=/\{([^\}]+)\}/g,a=/"/g,l=/'/g,c=function(t,e,o){var n=t[e];return n===undefined&&!0===o&&(n=t[e]={}),n},u=function(t){return/^f|^o/.test(typeof t)};return t.extend(t,{esc:function(t){return(""+(null===t||t===undefined||isNaN(t)&&""+t=="NaN"?"":t)).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(a,"&#34;").replace(l,"&#39;")},getObject:function(e,o,n){var i,r,s,a,l=e?e.split("."):[],h=l.length,g=0;if(o=t.isArray(o)?o:[o||window],a=o.length,!h)return o[0];for(g;g<a;g++){for(i=o[g],s=undefined,r=0;r<h&&u(i);r++)s=i,i=c(s,l[r]);if(s!==undefined&&i!==undefined)break}if(!1===n&&i!==undefined&&delete s[l[r-1]],!0===n&&i===undefined)for(i=o[0],r=0;r<h&&u(i);r++)i=c(i,l[r],!0);return i},capitalize:function(t,e){return t.charAt(0).toUpperCase()+t.slice(1)},underscore:function(t){return t.replace(o,"/").replace(n,"$1_$2").replace(i,"$1_$2").replace(r,"_").toLowerCase()},sub:function(e,o,n){var i=[];return e=e||"",i.push(e.replace(s,function(e,r){var s=t.getObject(r,o,!0!==n&&undefined);return s===undefined?(i=null,""):u(s)&&i?(i.push(s),""):""+s})),null===i?i:i.length<=1?i[0]:i},replacer:s,undHash:e}),t}(__m3),__m1=function(t){var e=0;return t.Construct=function(){if(arguments.length)return t.Construct.extend.apply(t.Construct,arguments)},t.extend(t.Construct,{newInstance:function(){var t,e=this.instance();return e.setup&&(t=e.setup.apply(e,arguments)),e.init&&e.init.apply(e,t||arguments),e},_inherit:function(e,o,n){t.extend(n||e,e||{})},_overwrite:function(t,e,o,n){t[o]=n},setup:function(e,o){this.defaults=t.extend(!0,{},e.defaults,this.defaults)},instance:function(){e=1;var t=new this;return e=0,t},extend:function(o,n,i){function r(){if(!e)return this.constructor!==r&&arguments.length?arguments.callee.extend.apply(arguments.callee,arguments):this.constructor.newInstance.apply(this.constructor,arguments)}"string"!=typeof o&&(i=n,n=o,o=null),i||(i=n,n=null),i=i||{};var s,a,l,c,u=this,h=this.prototype;c=this.instance(),t.Construct._inherit(i,h,c);for(s in u)u.hasOwnProperty(s)&&(r[s]=u[s]);if(t.Construct._inherit(n,u,r),o){var g=o.split("."),a=g.pop(),p=t.getObject(g.join("."),window,!0),l=p,d=t.underscore(o.replace(/\./g,"_")),f=t.underscore(a);p[a]=r}t.extend(r,{constructor:r,prototype:c,namespace:l,_shortName:f,fullName:o,_fullName:d}),a!==undefined&&(r.shortName=a),r.prototype.constructor=r;var m=[u].concat(t.makeArray(arguments)),y=r.setup.apply(r,m);return r.init&&r.init.apply(r,y||m),r}}),t.Construct}(__m2),__m8=function(t){return t.bindAndSetup=function(){return t.addEvent.apply(this,arguments),this._init||(this._bindings?this._bindings++:(this._bindings=1,this._bindsetup&&this._bindsetup())),this},t.unbindAndTeardown=function(e,o){return t.removeEvent.apply(this,arguments),this._bindings--,this._bindings||this._bindteardown&&this._bindteardown(),this},t}(__m3),__m7=function(t,e){var o=function(e){return e&&!t.isDeferred(e)&&(t.isArray(e)||t.isPlainObject(e)||e instanceof t.Observe)},n=function(e,o){return t.each(e,function(t){t&&t.unbind&&t.unbind("change"+o)})},i=function(e,o,i,a,l){return a=a||s,l=l||s.List,e instanceof s?i._bindings&&n([e],i._cid):e=t.isArray(e)?new l(e):new a(e),i._bindings&&r(e,o,i),e},r=function(e,o,n){e.bind("change"+n._cid,function(){var i=t.makeArray(arguments),r=i.shift();i[0]=("*"===o?[n.indexOf(e),i[0]]:[o,i[0]]).join("."),r.triggeredNS=r.triggeredNS||{},r.triggeredNS[n._cid]||(r.triggeredNS[n._cid]=!0,t.trigger(n,r,i))})};observeId=0,serialize=function(e,n,i){return e.each(function(e,r){i[r]=o(e)&&t.isFunction(e[n])?e[n]():e}),i},attrParts=function(e,o){return o?[e]:t.isArray(e)?e:(""+e).split(".")},batchNum=1,transactions=0,batchEvents=[],stopCallbacks=[],makeBindSetup=function(t){return function(){var e=this;this._each(function(o,n){o&&o.bind&&r(o,t||n,e)})}};var s=t.Map=t.Observe=t.Construct({bind:t.bindAndSetup,unbind:t.unbindAndTeardown,id:"id",canMakeObserve:o,startBatch:function(t){transactions++,t&&stopCallbacks.push(t)},stopBatch:function(e,o){if(e?transactions=0:transactions--,0==transactions){var n=batchEvents.slice(0),i=stopCallbacks.slice(0);batchEvents=[],stopCallbacks=[],batchNum++,o&&this.startBatch(),t.each(n,function(e){t.trigger.apply(t,e)}),t.each(i,function(t){t()})}},triggerBatch:function(e,o,n){if(!e._init){if(0==transactions)return t.trigger(e,o,n);o="string"==typeof o?{type:o}:o,o.batchNum=batchNum,batchEvents.push([e,o,n])}},keys:function(t){var e=[];s.__reading&&s.__reading(t,"__keys");for(var o in t._data)e.push(o);return e}},{setup:function(e){this._data={},t.cid(this,".observe"),this._init=1,this.attr(e),this.bind("change"+this._cid,t.proxy(this._changes,this)),delete this._init},_bindsetup:makeBindSetup(),_bindteardown:function(){var t=this._cid;this._each(function(e){n([e],t)})},_changes:function(t,e,o,n,i){s.triggerBatch(this,{type:e,batchNum:t.batchNum},[n,i])},_triggerChange:function(e,o,n,i){s.triggerBatch(this,"change",t.makeArray(arguments))},_each:function(t){var e=this.__get();for(var o in e)e.hasOwnProperty(o)&&t(e[o],o)},attr:function(t,e){var o=typeof t;return"string"!==o&&"number"!==o?this._attrs(t,e):1===arguments.length?(s.__reading&&s.__reading(this,t),this._get(t)):(this._set(t,e),this)},each:function(){return s.__reading&&s.__reading(this,"__keys"),t.each.apply(undefined,[this.__get()].concat(t.makeArray(arguments)))},removeAttr:function(e){var o=this instanceof t.Observe.List,n=attrParts(e),i=n.shift(),r=o?this[i]:this._data[i];return n.length?r.removeAttr(n):(o?this.splice(i,1):i in this._data&&(delete this._data[i],i in this.constructor.prototype||delete this[i],s.triggerBatch(this,"__keys"),this._triggerChange(i,"remove",undefined,r)),r)},_get:function(t){var e="string"==typeof t&&!!~t.indexOf(".")&&this.__get(t);if(e)return e;var o=attrParts(t),n=this.__get(o.shift());return o.length?n?n._get(o):undefined:n},__get:function(t){return t?this._data[t]:this._data},_set:function(t,e,n){var i=attrParts(t,n),r=i.shift(),s=this.__get(r);if(o(s)&&i.length)s._set(i,e);else{if(i.length)throw"can.Observe: Object does not exist";this.__convert&&(e=this.__convert(r,e)),this.__set(r,e,s)}},__set:function(t,e,r){if(e!==r){var a=this.__get().hasOwnProperty(t)?"set":"add";this.___set(t,o(e)?i(e,t,this):e),"add"==a&&s.triggerBatch(this,"__keys",undefined),this._triggerChange(t,a,e,r),r&&n([r],this._cid)}},___set:function(t,e){this._data[t]=e,t in this.constructor.prototype||(this[t]=e)},bind:t.bindAndSetup,unbind:t.unbindAndTeardown,serialize:function(){return serialize(this,"serialize",{})},_attrs:function(e,n){if(e===undefined)return serialize(this,"attr",{});e=t.extend({},e);var i,r,a=this;s.startBatch(),this.each(function(i,s){if((r=e[s])===undefined)return void(n&&a.removeAttr(s));a.__convert&&(r=a.__convert(s,r)),r instanceof t.Observe?a.__set(s,r,i):o(i)&&o(r)&&i.attr?i.attr(r,n):i!=r&&a.__set(s,r,i),delete e[s]});for(var i in e)r=e[i],this._set(i,r,!0);return s.stopBatch(),this},compute:function(e){return t.compute(this,e)}}),a=[].splice,l=s({setup:function(e,o){this.length=0,t.cid(this,".observe"),this._init=1,t.isDeferred(e)?this.replace(e):this.push.apply(this,t.makeArray(e||[])),this.bind("change"+this._cid,t.proxy(this._changes,this)),t.extend(this,o),delete this._init},_triggerChange:function(t,e,o,n){s.prototype._triggerChange.apply(this,arguments),~t.indexOf(".")||("add"===e?(s.triggerBatch(this,e,[o,+t]),s.triggerBatch(this,"length",[this.length])):"remove"===e?(s.triggerBatch(this,e,[n,+t]),s.triggerBatch(this,"length",[this.length])):s.triggerBatch(this,e,[o,+t]))},__get:function(t){return t?this[t]:this},___set:function(t,e){this[t]=e,+t>=this.length&&(this.length=+t+1)},_each:function(t){for(var e=this.__get(),o=0;o<e.length;o++)t(e[o],o)},_bindsetup:makeBindSetup("*"),serialize:function(){return serialize(this,"serialize",[])},splice:function(e,r){var s,l=t.makeArray(arguments);for(s=2;s<l.length;s++){var c=l[s];o(c)&&(l[s]=i(c,"*",this,this.constructor.Observe,this.constructor))}r===undefined&&(r=l[1]=this.length-e);var u=a.apply(this,l);return t.Observe.startBatch(),r>0&&(this._triggerChange(""+e,"remove",undefined,u),n(u,this._cid)),l.length>2&&this._triggerChange(""+e,"add",l.slice(2),u),t.Observe.stopBatch(),u},_attrs:function(e,o){if(e===undefined)return serialize(this,"attr",[]);e=t.makeArray(e),s.startBatch(),this._updateAttrs(e,o),s.stopBatch()},_updateAttrs:function(t,e){for(var n=Math.min(t.length,this.length),i=0;i<n;i++){var r=this[i],s=t[i];o(r)&&o(s)?r.attr(s,e):r!=s&&this._set(i,s)}t.length>this.length?this.push.apply(this,t.slice(this.length)):t.length<this.length&&e&&this.splice(t.length)}}),c=function(e){return e[0]&&t.isArray(e[0])?e[0]:t.makeArray(e)};return t.each({push:"length",unshift:0},function(t,e){var n=[][e];l.prototype[e]=function(){var e,r,s=[],a=t?this.length:0,l=arguments.length;for(this.constructor;l--;)r=arguments[l],s[l]=o(r)?i(r,"*",this,this.constructor.Observe,this.constructor):r;return e=n.apply(this,s),this.comparator&&!s.length||this._triggerChange(""+a,"add",s,undefined),e}}),t.each({pop:"length",shift:0},function(t,e){l.prototype[e]=function(){var o=c(arguments),n=t&&this.length?this.length-1:0,i=[][e].apply(this,o);return this._triggerChange(""+n,"remove",undefined,[i]),i&&i.unbind&&i.unbind("change"+this._cid),i}}),t.extend(l.prototype,{indexOf:function(e){return this.attr("length"),t.inArray(e,this)},join:[].join,reverse:[].reverse,slice:function(){var t=Array.prototype.slice.apply(this,arguments);return new this.constructor(t)},concat:function(){var e=[];return t.each(t.makeArray(arguments),function(o,n){e[n]=o instanceof t.Observe.List?o.serialize():o}),new this.constructor(Array.prototype.concat.apply(this.serialize(),e))},forEach:function(e,o){t.each(this,e,o||this)},replace:function(e){return t.isDeferred(e)?e.then(t.proxy(this.replace,this)):this.splice.apply(this,[0,this.length].concat(t.makeArray(e||[]))),this}}),t.List=s.List=l,s.setup=function(){t.Construct.setup.apply(this,arguments),this.List=s.List({Observe:this},{})},s}(__m3,0),__m9=function(t,e){var o=function(e,o){var n;t.Observe&&(n=t.Observe.__reading,t.Observe.__reading=function(t,e){i.push({obj:t,attr:e+""})});var i=[],r=e.call(o);return t.Observe&&(t.Observe.__reading=n),{value:r,observed:i}},n=function(e,n,i,r){var s,a={},l=!0,c={value:undefined,teardown:function(){for(var t in a){var e=a[t];e.observe.obj.unbind(e.observe.attr,u),delete a[t]}}},u=function(t){if((!r||r.bound)&&(t.batchNum===undefined||t.batchNum!==s)){var e=c.value,o=h();c.value=o,o!==e&&i(o,e),s=s=t.batchNum}},h=function(){var i=o(e,n),r=i.observed,s=i.value;l=!l,t.each(r,function(t){a[t.obj._cid+"|"+t.attr]?a[t.obj._cid+"|"+t.attr].matched=l:(a[t.obj._cid+"|"+t.attr]={matched:l,observe:t},t.obj.bind(t.attr,u))});for(var c in a){var h=a[c];h.matched!==l&&(h.observe.obj.unbind(h.observe.attr,u),delete a[c])}return s};return c.value=h(),c.isListening=!t.isEmptyObject(a),c};return t.compute=function(e,i,r){if(e&&e.isComputed)return e;var s,a,l,c={bound:!1,hasDependencies:!1},u=function(){},h=function(){},g=function(){return l},p=function(t){l=t},d=!0;if(a=function(e){if(arguments.length){var o=l,n=p.call(i,e,o);return a.hasDependencies?g.call(i):(l=n===undefined?g.call(i):n,o!==l&&t.Observe.triggerBatch(a,"change",[l,o]),l)}return t.Observe.__reading&&d&&t.Observe.__reading(a,"change"),c.bound?l:g.call(i)},"function"==typeof e)p=e,g=e,d=!1!==r,a.hasDependencies=!1,u=function(t){s=n(e,i||this,t,c),a.hasDependencies=s.isListening,l=s.value},h=function(){s&&s.teardown()};else if(i)if("string"==typeof i){var f=i,m=e instanceof t.Observe;m&&(a.hasDependencies=!0),g=function(){return m?e.attr(f):e[f]},p=function(t){m?e.attr(f,t):e[f]=t};var y;u=function(n){y=function(){n(g(),l)},t.bind.call(e,r||f,y),l=o(g).value},h=function(){t.unbind.call(e,r||f,y)}}else if("function"==typeof i)l=e,p=i;else{l=e;var v=i;g=v.get||g,p=v.set||p,u=v.on||u,h=v.off||h}else l=e;a.isComputed=!0,t.cid(a,"compute");var _=function(e,o){l=e,t.Observe.triggerBatch(a,"change",[e,o])};return t.extend(a,{_bindsetup:function(){c.bound=!0,u.call(this,_)},_bindteardown:function(){h.call(this,_),c.bound=!1},bind:t.bindAndSetup,unbind:t.unbindAndTeardown})},t.compute.binder=n,t.compute}(__m3),__m10=function(t){var e=function(e,o,n){var i=new t.Deferred;return e.then(function(){var e=t.makeArray(arguments);e[0]=o[n](e[0]),i.resolveWith(i,e)},function(){i.rejectWith(this,arguments)}),"function"==typeof e.abort&&(i.abort=function(){return e.abort()}),i},o=0,n=function(e){return t.Observe.__reading&&t.Observe.__reading(e,e.constructor.id),e.__get(e.constructor.id)},i=function(e,o,n,i,r,s){var a={};if("string"==typeof e){var l=e.split(/\s+/);a.url=l.pop(),l.length&&(a.type=l.pop())}else t.extend(a,e);return a.data="object"!=typeof o||t.isArray(o)?o:t.extend(a.data||{},o),a.url=t.sub(a.url,a.data,!0),t.ajax(t.extend({type:n||"post",dataType:i||"json",success:r,error:s},a))},r=function(e,o,i,r,s){var a;t.isArray(e)?(a=e[1],e=e[0]):a=e.serialize(),a=[a];var l,c,u=e.constructor;return"destroy"==o&&a.shift(),"create"!==o&&a.unshift(n(e)),c=u[o].apply(u,a),l=c.pipe(function(t){return e[s||o+"d"](t,c),e}),c.abort&&(l.abort=function(){c.abort()}),l.then(i,r),l},s={create:{url:"_shortName",type:"post"},update:{data:function(e,o){o=o||{};var n=this.id;return o[n]&&o[n]!==e&&(o["new"+t.capitalize(e)]=o[n],delete o[n]),o[n]=e,o},type:"put"},destroy:{type:"delete",data:function(t){var e={};return e.id=e[this.id]=t,e}},findAll:{url:"_shortName"},findOne:{}},a=function(t,e){return function(o){return o=t.data?t.data.apply(this,arguments):o,i(e||this[t.url||"_url"],o,t.type||"get")}};t.Model=t.Observe({fullName:"can.Model",_reqs:0,setup:function(e){if(this.store={},t.Observe.setup.apply(this,arguments),t.Model){this.List=l({Observe:this},{});var n=this,i=t.proxy(this._clean,n);t.each(s,function(o,r){if(t.isFunction(n[r])||(n[r]=a(o,n[r])),n["make"+t.capitalize(r)]){var s=n["make"+t.capitalize(r)](n[r]);t.Construct._overwrite(n,e,r,function(){t.Model._reqs++;var e=s.apply(this,arguments),o=e.then(i,i);return o.abort=e.abort,o})}}),"can.Model"!=n.fullName&&n.fullName||(n.fullName="Model"+ ++o),t.Model._reqs=0,this._url=this._shortName+"/{"+this.id+"}"}},_ajax:a,_makeRequest:r,_clean:function(){if(!--t.Model._reqs)for(var e in this.store)this.store[e]._bindings||delete this.store[e];return arguments[0]},models:function(e,o){if(t.Model._reqs++,e){if(e instanceof this.List)return e;var n=this,i=[],r=o instanceof t.Observe.List?o:new(n.List||l),s=t.isArray(e),a=e instanceof l,c=s?e:a?e.serialize():e.data;return r.length&&r.splice(0),t.each(c,function(t){i.push(n.model(t))}),r.push.apply(r,i),s||t.each(e,function(t,e){"data"!==e&&r.attr(e,t)}),setTimeout(t.proxy(this._clean,this),1),r}},model:function(e){if(e){e instanceof this&&(e=e.serialize());var o=e[this.id],n=(o||0===o)&&this.store[o]?this.store[o].attr(e,this.removeAttr||!1):new this(e);return t.Model._reqs&&(this.store[e[this.id]]=n),n}}},{isNew:function(){var t=n(this);return!(t||0===t)},save:function(t,e){return r(this,this.isNew()?"create":"update",t,e)},destroy:function(e,o){if(this.isNew()){var n=this,i=t.Deferred();return i.then(e,o),i.done(function(t){n.destroyed(t)}).resolve(n)}return r(this,"destroy",e,o,"destroyed")},_bindsetup:function(){return this.constructor.store[this.__get(this.constructor.id)]=this,t.Observe.prototype._bindsetup.apply(this,arguments)},_bindteardown:function(){return delete this.constructor.store[n(this)],t.Observe.prototype._bindteardown.apply(this,arguments)},___set:function(e,o){t.Observe.prototype.___set.call(this,e,o),e===this.constructor.id&&this._bindings&&(this.constructor.store[n(this)]=this)}}),t.each({makeFindAll:"models",makeFindOne:"model",makeCreate:"model",makeUpdate:"model"},function(o,n){t.Model[n]=function(n){return function(){var i=t.makeArray(arguments),r=t.isFunction(i[1])?i.splice(0,1):i.splice(0,2),s=e(n.apply(this,r),this,o);return s.then(i[0],i[1]),s}}}),t.each(["created","updated","destroyed"],function(e){t.Model.prototype[e]=function(o){var n=this.constructor;o&&"object"==typeof o&&this.attr(o.attr?o.attr():o),t.trigger(this,"change",e),t.trigger(n,e,this)}});var l=t.Model.List=t.Observe.List({setup:function(e){t.isPlainObject(e)&&!t.isArray(e)?(t.Observe.List.prototype.setup.apply(this),this.replace(this.constructor.Observe.findAll(e))):t.Observe.List.prototype.setup.apply(this,arguments)},_changes:function(e,o){if(t.Observe.List.prototype._changes.apply(this,arguments),/\w+\.destroyed/.test(o)){var n=this.indexOf(e.target);-1!=n&&this.splice(n,1)}}});return t.Model}(__m3),__m11=function(t){var e=t.isFunction,o=t.makeArray,n=1,i=t.view=t.template=function(o,n,r,s){e(r)&&(s=r,r=undefined);var a=function(t){return i.frag(t)},l=e(s)?function(t){s(a(t))}:null,c=i.render(o,n,r,l),u=t.Deferred();return e(c)?c:t.isDeferred(c)?(c.then(function(t,e){u.resolve.call(u,a(t),e)},function(){u.fail.apply(u,arguments)}),u):a(c)};t.extend(i,{frag:function(t,e){return i.hookup(i.fragment(t),e)},fragment:function(e){var o=t.buildFragment(e,document.body);return o.childNodes.length||o.appendChild(document.createTextNode("")),o},toId:function(e){return t.map(e.toString().split(/\/|\./g),function(t){if(t)return t}).join("_")},hookup:function(e,o){var n,r,s=[];return t.each(e.childNodes?t.makeArray(e.childNodes):e,function(e){1===e.nodeType&&(s.push(e),s.push.apply(s,t.makeArray(e.getElementsByTagName("*"))))}),t.each(s,function(t){t.getAttribute&&(n=t.getAttribute("data-view-id"))&&(r=i.hookups[n])&&(r(t,o,n),delete i.hookups[n],t.removeAttribute("data-view-id"))}),e},hookups:{},hook:function(t){return i.hookups[++n]=t," data-view-id='"+n+"'"},cached:{},cachedRenderers:{},cache:!0,register:function(t){this.types["."+t.suffix]=t},types:{},ext:".ejs",registerScript:function(){},preload:function(){},render:function(n,r,c,u){e(c)&&(u=c,c=undefined);var h=a(r);if(h.length){var g=new t.Deferred,p=t.extend({},r);return h.push(s(n,!0)),t.when.apply(t,h).then(function(e){var n,i=o(arguments),s=i.pop();if(t.isDeferred(r))p=l(e);else for(var a in r)t.isDeferred(r[a])&&(p[a]=l(i.shift()));n=s(p,c),g.resolve(n,p),u&&u(n,p)},function(){g.reject.apply(g,arguments)}),g}var d,f=e(u),g=s(n,f);if(f)d=g,g.then(function(t){u(r?t(r,c):t)});else{if("resolved"===g.state()&&g.__view_id){var m=i.cachedRenderers[g.__view_id];return r?m(r,c):m}g.then(function(t){d=r?t(r,c):t})}return d},registerView:function(e,o,n,r){var s=(n||i.types[i.ext]).renderer(e,o);return r=r||new t.Deferred,i.cache&&(i.cached[e]=r,r.__view_id=e,i.cachedRenderers[e]=s),r.resolve(s)}});var r=function(t,e){if(!t.length)throw"can.view: No template or empty template:"+e},s=function(e,o){var n,s,a,l=e.match(/\.[\w\d]+$/);if(e.match(/^#/)&&(e=e.substr(1)),(s=document.getElementById(e))&&(l="."+s.type.match(/\/(x\-)?(.+)/)[2]),l||i.cached[e]||(e+=l=i.ext),t.isArray(l)&&(l=l[0]),a=i.toId(e),e.match(/^\/\//)){var c=e.substr(2);e=window.steal?steal.config().root.mapJoin(""+steal.id(c)):c}if(n=i.types[l],i.cached[a])return i.cached[a];if(s)return i.registerView(a,s.innerHTML,n);var u=new t.Deferred;return t.ajax({async:o,url:e,dataType:"text",error:function(t){r("",e),u.reject(t)},success:function(t){r(t,e),i.registerView(a,t,n,u)}}),u},a=function(e){var o=[];if(t.isDeferred(e))return[e];for(var n in e)t.isDeferred(e[n])&&o.push(e[n]);return o},l=function(e){return t.isArray(e)&&"success"===e[1]?e[0]:e};
//!steal-pluginify-remove-start
//!steal-pluginify-remove-end
return window.steal&&steal.type("view js",function(t,e,o){var n=i.types["."+t.type],r=i.toId(t.id);t.text="steal('"+(n.plugin||"can/view/"+t.type)+"',function(can){return can.view.preload('"+r+"',"+t.text+");\n})",e()}),t.extend(i,{register:function(e){this.types["."+e.suffix]=e,
//!steal-pluginify-remove-start
window.steal&&steal.type(e.suffix+" view js",function(t,e,o){var n=i.types["."+t.type],r=i.toId(t.id+"");t.text=n.script(r,t.text),e()}),
//!steal-pluginify-remove-end
i[e.suffix]=function(o,n){if(!n){var r=function(){return i.frag(r.render.apply(this,arguments))};return r.render=function(){var t=e.renderer(null,o);return t.apply(t,arguments)},r}return i.preload(o,e.renderer(o,n)),t.view(o)}},registerScript:function(t,e,o){return"can.view.preload('"+e+"',"+i.types["."+t].script(e,o)+");"},preload:function(e,o){function n(){return i.frag(o.apply(this,arguments))}return i.cached[e]=(new t.Deferred).resolve(function(t,e){return o.call(t,t,e)}),n.render=o,n}}),t}(__m3),__m14=function(){var t={tagToContentPropMap:{option:"textContent"in document.createElement("option")?"textContent":"innerText",textarea:"value"},attrMap:{class:"className",value:"value",innerText:"innerText",textContent:"textContent",checked:!0,disabled:!0,readonly:!0,required:!0},defaultValue:["input","textarea"],tagMap:{"":"span",table:"tbody",tr:"td",ol:"li",ul:"li",tbody:"tr",thead:"tr",tfoot:"tr",select:"option",optgroup:"option"},reverseTagMap:{tr:"tbody",option:"select",td:"tr",th:"tr",li:"ul"},getParentNode:function(t,e){return e&&11===t.parentNode.nodeType?e:t.parentNode},setAttr:function(e,o,n){var i=e.nodeName.toString().toLowerCase(),r=t.attrMap[o];!0===r?e[o]=!0:r?(e[r]=n,"value"===r&&can.inArray(i,t.defaultValue)>=0&&(e.defaultValue=n)):e.setAttribute(o,n)},getAttr:function(e,o){return(t.attrMap[o]&&e[t.attrMap[o]]?e[t.attrMap[o]]:e.getAttribute(o))||""},removeAttr:function(e,o){!0===t.attrMap[o]?e[o]=!1:e.removeAttribute(o)},contentText:function(t){return"string"==typeof t?t:t||0===t?""+t:""}};return t}(),__m13=function(can,elements){var newLine=/(\r|\n)+/g,clean=function(t){return t.split("\\").join("\\\\").split("\n").join("\\n").split('"').join('\\"').split("\t").join("\\t")},getTag=function(t,e,o){if(t)return t;for(;o<e.length;){if("<"==e[o]&&elements.reverseTagMap[e[o+1]])return elements.reverseTagMap[e[o+1]];o++}return""},bracketNum=function(t){return--t.split("{").length- --t.split("}").length},myEval=function(script){eval(script)},attrReg=/([^\s]+)[\s]*=[\s]*$/,startTxt="var ___v1ew = [];",finishTxt="return ___v1ew.join('')",put_cmd="___v1ew.push(",insert_cmd=put_cmd,htmlTag=null,quote=null,beforeQuote=null,rescan=null,status=function(){return quote?"'"+beforeQuote.match(attrReg)[1]+"'":htmlTag?1:0};return can.view.Scanner=Scanner=function(t){can.extend(this,{text:{},tokens:[]},t),this.tokenReg=[],this.tokenSimple={"<":"<",">":">",'"':'"',"'":"'"},this.tokenComplex=[],this.tokenMap={};for(var e,o=0;e=this.tokens[o];o++)e[2]?(this.tokenReg.push(e[2]),this.tokenComplex.push({abbr:e[1],re:new RegExp(e[2]),rescan:e[3]})):(this.tokenReg.push(e[1]),this.tokenSimple[e[1]]=e[0]),this.tokenMap[e[0]]=e[1];this.tokenReg=new RegExp("("+this.tokenReg.slice(0).concat(["<",">",'"',"'"]).join("|")+")","g")},Scanner.prototype={helpers:[{name:/\s*\(([\$\w]+)\)\s*->([^\n]*)/,fn:function(t){var e=/\s*\(([\$\w]+)\)\s*->([^\n]*)/,o=t.match(e);return"can.proxy(function(__){var "+o[1]+"=can.$(__);"+o[2]+"}, this);"}}],scan:function(t,e){var o=[],n=0,i=this.tokenSimple,r=this.tokenComplex;t=t.replace(newLine,"\n"),this.transform&&(t=this.transform(t)),t.replace(this.tokenReg,function(e,s){var a=arguments[arguments.length-2];if(a>n&&o.push(t.substring(n,a)),i[e])o.push(e);else for(var l,c=0;l=r[c];c++)if(l.re.test(e)){o.push(l.abbr),l.rescan&&o.push(l.rescan(s));break}n=a+s.length}),n<t.length&&o.push(t.substr(n));var s,a,l,c="",u=[startTxt+(this.text.start||"")],h=function(t,e){u.push(put_cmd,'"',clean(t),'"'+(e||"")+");")},g=[],p=null,d=!1,f="",m=[],y=!1,v=0,_=this.tokenMap;for(htmlTag=quote=beforeQuote=null;(l=o[v++])!==undefined;){if(null===p)switch(l){case _.left:case _.escapeLeft:case _.returnLeft:d=htmlTag&&1;case _.commentLeft:p=l,c.length&&h(c),c="";break;case _.escapeFull:d=htmlTag&&1,rescan=1,p=_.escapeLeft,c.length&&h(c),rescan=o[v++],c=rescan.content||rescan,rescan.before&&h(rescan.before),o.splice(v,0,_.right);break;case _.commentFull:break;case _.templateLeft:c+=_.left;break;case"<":0!==o[v].indexOf("!--")&&(htmlTag=1,d=0),c+=l;break;case">":htmlTag=0;var b="/"==c.substr(c.length-1)||"--"==c.substr(c.length-2);d||!y&&elements.tagToContentPropMap[m[m.length-1]]?(b?h(c.substr(0,c.length-1),',can.view.pending(),"/>"'):h(c,',can.view.pending(),">"'),c="",d=0):c+=l,(b||y)&&(m.pop(),f=m[m.length-1],y=!1);break;case"'":case'"':htmlTag&&(quote&&quote===l?quote=null:null===quote&&(quote=l,beforeQuote=s));default:"<"===s&&(f=l.split(/\s/)[0],0===f.indexOf("/")&&m[m.length-1]===f.substr(1)?(f=m[m.length-1],y=!0):m.push(f)),c+=l}else switch(l){case _.right:case _.returnRight:switch(p){case _.left:a=bracketNum(c),1==a?(u.push(insert_cmd,"can.view.txt(0,'"+getTag(f,o,v)+"',"+status()+",this,function(){",startTxt,c),g.push({before:"",after:finishTxt+"}));\n"})):(n=g.length&&-1==a?g.pop():{after:";"},n.before&&u.push(n.before),u.push(c,";",n.after));break;case _.escapeLeft:case _.returnLeft:a=bracketNum(c),a&&g.push({before:finishTxt,after:"}));"});for(var E=p===_.escapeLeft?1:0,x={insert:insert_cmd,tagName:getTag(f,o,v),status:status()},S=0;S<this.helpers.length;S++){var T=this.helpers[S];if(T.name.test(c)){c=T.fn(c,x),T.name.source==/^>[\s]*\w*/.source&&(E=0);break}}"object"==typeof c?c.raw&&u.push(c.raw):u.push(insert_cmd,"can.view.txt("+E+",'"+f+"',"+status()+",this,function(){ "+(this.text.escape||"")+"return ",c,a?startTxt:"}));"),rescan&&rescan.after&&rescan.after.length&&(h(rescan.after.length),rescan=null)}p=null,c="";break;case _.templateLeft:c+=_.left;break;default:c+=l}s=l}c.length&&h(c),u.push(";");var w=u.join(""),C={out:"with(_VIEW) { with (_CONTEXT) {"+w+" "+finishTxt+"}}"};return myEval.call(C,"this.fn = (function(_CONTEXT,_VIEW){"+C.out+"});\r\n//@ sourceURL="+e+".js"),C}},Scanner}(__m11,__m14),__m17=function(t){var e=!0;try{document.createTextNode("")._=0}catch(t){e=!1}var o={},n={},i={},r="ejs_"+Math.random(),s=0,a=function(t){if(e||3!==t.nodeType)return t[r]?t[r]:t[r]=(t.nodeName?"element_":"obj_")+ ++s;for(var o in n)if(n[o]===t)return o;return n["text_"+ ++s]=t,"text_"+s},l=function(e,n){var i=o[a(e)];if(i){var r=t.inArray(n,i);r>=0&&i.splice(r,1),i.length||delete o[a(e)]}},c=function(t,e){var n=o[a(t)];n||(n=o[a(t)]=[]),n.push(e)},u={id:a,replace:function(e,n){e=t.makeArray(e);var r=e[0];t.each(t.makeArray(o[a(r)]),function(o){var s=i[o],a=t.inArray(r,s),h=t.inArray(e[e.length-1],s);if(a>=0&&h>=0){for(var g=a;g<=h;g++){var p=s[g];l(p,o)}s.splice.apply(s,[a,h-a+1].concat(n)),t.each(n,function(t){c(t,o)})}else u.unregister(s)})},register:function(e){var o=a(e);i[o]=e,t.each(e,function(t){c(t,o)})},unregister:function(e){var o=a(e);t.each(e,function(t){l(t,o)}),delete i[o]},nodeMap:o,nodeListMap:i};return u}(__m3),__m16=function(t,e,o,n){var i=function(e,o,n){var i=function(){n(r),t.unbind.call(e,"destroyed",i)},r={teardownCheck:function(t){t||i()}};return t.bind.call(e,"destroyed",i),o(r),r},r=function(t,e,o){return i(t,function(){e.bind("change",o)},function(t){e.unbind("change",o),t.nodeList&&n.unregister(t.nodeList)})},s=function(t){return(t||"").replace(/['"]/g,"").split("=")};insertElementsAfter=function(t,e){var o=t[t.length-1];o.nextSibling?o.parentNode.insertBefore(e,o.nextSibling):o.parentNode.appendChild(e)};var a={nodeLists:n,list:function(o,r,s,a,l){var c=[],u=function(e,o,i){var r=document.createDocumentFragment(),u=[];if(t.each(o,function(e){var o=s.call(a,e),n=t.view.frag(o,l);u.push(t.makeArray(n.childNodes)),r.appendChild(n)}),c[i]){var h=c[i][0];h.parentNode.insertBefore(r,h)}else insertElementsAfter(0==i?[g]:c[i-1],r);t.each(u,function(t){n.register(t)}),[].splice.apply(c,[i,0].concat(u))},h=function(e,o,i){var r=c.splice(i,o.length),s=[];t.each(r,function(t){[].push.apply(s,t),n.replace(t,[]),n.unregister(t)}),t.remove(t.$(s))},l=e.getParentNode(o,l),g=document.createTextNode("");i(l,function(){r.bind("add",u).bind("remove",h)},function(){r.unbind("add",u).unbind("remove",h),t.each(c,function(t){n.unregister(t)})}),insertElementsAfter([o],g),t.remove(t.$(o)),u(0,r,0)},html:function(o,i,s){var a,s=e.getParentNode(o,s),l=r(s,i,function(t,e,o){a[0].parentNode&&c(e),l.teardownCheck(a[0].parentNode)}),c=function(e){var i=t.view.frag(e,s),r=t.makeArray(i.childNodes);if(insertElementsAfter(a||[o],i),a){var c=t.makeArray(a);n.replace(a,r),t.remove(t.$(c))}else t.remove(t.$(o)),a=r,l.nodeList=a,n.register(a)};c(i(),[o])},text:function(t,o,n){var i=e.getParentNode(t,n),s=r(t.parentNode!==i?t.parentNode:i,o,function(t,e,o){"unknown"!=typeof a.nodeValue&&(a.nodeValue=""+e),s.teardownCheck(a.parentNode)}),a=document.createTextNode(o());t.parentNode!==i?(i=t.parentNode,i.insertBefore(a,t),i.removeChild(t)):(i.insertBefore(a,t),i.removeChild(t))},attributes:function(t,o,n){var i=function(o){var n=s(o),i=n.shift();i!=a&&a&&e.removeAttr(t,a),i&&(e.setAttr(t,i,n.join("=")),a=i)};if(r(t,o,function(t,e){i(e)}),arguments.length>=3)var a=s(n)[0];else i(o())},attributePlaceholder:"__!!__",attributeReplace:/__!!__/g,attribute:function(o,n,i){r(o,i,function(t,i){e.setAttr(o,n,c.render())});var s,l=t.$(o);(s=t.data(l,"hooks"))||t.data(l,"hooks",s={});var c,u=e.getAttr(o,n),h=u.split(a.attributePlaceholder),g=[];g.push(h.shift(),h.join(a.attributePlaceholder)),s[n]?s[n].computes.push(i):s[n]={render:function(){var t=0;return u?u.replace(a.attributeReplace,function(){return e.contentText(c.computes[t++]())}):e.contentText(c.computes[t++]())},computes:[i],batchNum:undefined},c=s[n],g.splice(1,0,i()),e.setAttr(o,n,g.join(""))}};return a}(__m3,__m14,0,__m17),__m15=function(t,e,o){var n=[],i=function(t){var o=e.tagMap[t]||"span";return"span"===o?"@@!!@@":"<"+o+">"+i(o)+"</"+o+">"},r=function(e,o){if("string"==typeof e)return e;if(!e&&0!==e)return"";var i=e.hookup&&function(t,o){e.hookup.call(e,t,o)}||"function"==typeof e&&e;return i?o?"<"+o+" "+t.view.hook(i)+"></"+o+">":(n.push(i),""):""+e},s=function(e){return"string"==typeof e||"number"==typeof e?t.esc(e):r(e)};return t.extend(t.view,{live:o,setupLists:function(){var e,o=t.view.lists;return t.view.lists=function(t,o){e={list:t,renderer:o}},function(){return t.view.lists=o,e}},pending:function(){var e=n.slice(0);return lastHookups=e,n=[],t.view.hook(function(o){t.each(e,function(t){t(o)})})},txt:function(a,l,c,u,h){var g=t.view.setupLists(),p=function(){},d=function(){f.unbind("change",p)},f=t.compute(h,u,!1);f.bind("change",p);var m=e.tagMap[l]||"span",y=g(),v=f();if(y)return"<"+m+t.view.hook(function(t,e){o.list(t,y.list,y.renderer,u,e)})+"></"+m+">";if(!f.hasDependencies)return d(),(a||0!==c?s:r)(v,0===c&&m);var _=e.tagToContentPropMap[l];if(0!==c||_){if(1===c)return n.push(function(t){o.attributes(t,f,f()),d()}),f();var b=0===c?_:c;return(0===c?lastHookups:n).push(function(t){o.attribute(t,b,f),d()}),o.attributePlaceholder}return"<"+m+t.view.hook(a?function(t,e){o.text(t,f,e),d()}:function(t,e){o.html(t,f,e),d()})+">"+i(m)+"</"+m+">"}}),t}(__m11,__m14,__m16),__m12=function(t){var e=t.extend,o=function(t){if(this.constructor!=o){var n=new o(t);return function(t,e){return n.render(t,e)}}if("function"==typeof t)return void(this.template={fn:t});e(this,t),this.template=this.scanner.scan(this.text,this.name)};return t.EJS=o,o.prototype.render=function(t,e){return t=t||{},this.template.fn.call(t,t,new o.Helpers(t,e||{}))},e(o.prototype,{scanner:new t.view.Scanner({tokens:[["templateLeft","<%%"],["templateRight","%>"],["returnLeft","<%=="],["escapeLeft","<%="],["commentLeft","<%#"],["left","<%"],["right","%>"],["returnRight","%>"]],transform:function(t){return t.replace(/<%([\s\S]+?)%>/gm,function(t,e){var o,n,i=[];e.replace(/[{}]/gm,function(t,e){i.push([t,e])});do{for(o=!1,n=i.length-2;n>=0;n--)if("{"==i[n][0]&&"}"==i[n+1][0]){i.splice(n,2),o=!0;break}}while(o);if(i.length>=2){var r,s=["<%"],a=0;for(n=0;r=i[n];n++)s.push(e.substring(a,a=r[1])),"{"==r[0]&&n<i.length-1||"}"==r[0]&&n>0?s.push("{"==r[0]?"{ %><% ":" %><% }"):s.push(r[0]),++a;return s.push(e.substring(a),"%>"),s.join("")}return"<%"+e+"%>"})}})}),o.Helpers=function(t,o){this._data=t,this._extras=o,e(this,o)},o.Helpers.prototype={list:function(e,o){t.each(e,function(t,n){o(t,n,e)})},each:function(e,o){t.isArray(e)?this.list(e,o):t.view.lists(e,o)}},t.view.register({suffix:"ejs",script:function(t,e){return"can.EJS(function(_CONTEXT,_VIEW) { "+new o({text:e,name:t}).template.out+" })"},renderer:function(t,e){return o({text:e,name:t})}}),t}(__m3),__m18=function(t){var e,o=function(e,o,n){return t.bind.call(e,o,n),function(){t.unbind.call(e,o,n)}},n=t.isFunction,i=t.extend,r=t.each,s=[].slice,a=/\{([^\}]+)\}/g,l=t.getObject("$.event.special",[t])||{},c=function(e,o,n,i){return t.delegate.call(e,o,n,i),function(){t.undelegate.call(e,o,n,i)}},u=function(e,n,i,r){return r?c(e,t.trim(r),n,i):o(e,n,i)},h=t.Control=t.Construct({setup:function(){if(t.Construct.setup.apply(this,arguments),t.Control){var e,o=this;o.actions={};for(e in o.prototype)o._isAction(e)&&(o.actions[e]=o._action(e))}},_shifter:function(e,o){var i="string"==typeof o?e[o]:o;return n(i)||(i=e[i]),function(){return e.called=o,i.apply(e,[this.nodeName?t.$(this):this].concat(s.call(arguments,0)))}},_isAction:function(t){var e=this.prototype[t],o=typeof e;return"constructor"!==t&&("function"==o||"string"==o&&n(this.prototype[e]))&&!!(l[t]||g[t]||/[^\w]/.test(t))},_action:function(o,n){if(a.lastIndex=0,n||!a.test(o)){var i=n?t.sub(o,[n,window]):o;if(!i)return null;var r=t.isArray(i),s=r?i[1]:i,l=s.split(/\s+/g),c=l.pop();return{processor:g[c]||e,parts:[s,l.join(" "),c],delegate:r?i[0]:undefined}}},processors:{},defaults:{}},{setup:function(e,o){var n,r=this.constructor,s=r.pluginName||r._fullName;return this.element=t.$(e),s&&"can_control"!==s&&this.element.addClass(s),(n=t.data(this.element,"controls"))||t.data(this.element,"controls",n=[]),n.push(this),this.options=i({},r.defaults,o),this.on(),[this.element,this.options]},on:function(e,o,n,i){if(!e){this.off();var r,s,a=this.constructor,l=this._bindings,c=a.actions,h=this.element,g=t.Control._shifter(this,"destroy");for(r in c)c.hasOwnProperty(r)&&(s=c[r]||a._action(r,this.options))&&l.push(s.processor(s.delegate||h,s.parts[2],s.parts[1],r,this));return t.bind.call(h,"destroyed",g),l.push(function(e){t.unbind.call(e,"destroyed",g)}),l.length}return"string"==typeof e&&(i=n,n=o,o=e,e=this.element),i===undefined&&(i=n,n=o,o=null),"string"==typeof i&&(i=t.Control._shifter(this,i)),this._bindings.push(u(e,n,i,o)),this._bindings.length},off:function(){var t=this.element[0];r(this._bindings||[],function(e){e(t)}),this._bindings=[]},destroy:function(){if(null!==this.element){var e,o=this.constructor,n=o.pluginName||o._fullName;this.off(),n&&"can_control"!==n&&this.element.removeClass(n),e=t.data(this.element,"controls"),e.splice(t.inArray(this,e),1),t.trigger(this,"destroyed"),this.element=null}}}),g=t.Control.processors,e=function(e,o,n,i,r){return u(e,o,t.Control._shifter(r,i),n)};return r(["change","click","contextmenu","dblclick","keydown","keyup","keypress","mousedown","mousemove","mouseout","mouseover","mouseup","reset","resize","scroll","select","submit","focusin","focusout","mouseenter","mouseleave","touchstart","touchmove","touchcancel","touchend","touchleave"],function(t){g[t]=e}),h}(__m3),__m20=function(t){var e=/^\d+$/,o=/([^\[\]]+)|(\[\])/g,n=/([^?#]*)(#.*)?$/,i=function(t){return decodeURIComponent(t.replace(/\+/g," "))};return t.extend(t,{deparam:function(r){var s,a,l={};return r&&n.test(r)&&(s=r.split("&"),t.each(s,function(t){var n=t.split("="),r=i(n.shift()),s=i(n.join("=")),c=l;if(r){n=r.match(o);for(var u=0,h=n.length-1;u<h;u++)c[n[u]]||(c[n[u]]=e.test(n[u+1])||"[]"==n[u+1]?[]:{}),c=c[n[u]];a=n.pop(),"[]"==a?c.push(s):c[a]=s}})),l}}),t}(__m3),__m19=function(t){var e=/\:([\w\.]+)/g,o=/^(?:&[^=]+=[^&]*)+/,n=function(e){var o=[];return t.each(e,function(e,n){o.push(("className"===n?"class":n)+'="'+("href"===n?e:t.esc(e))+'"')}),o.join(" ")},i=function(t,e){var o=0,n=0,i={};for(var r in t.defaults)t.defaults[r]===e[r]&&(i[r]=1,o++);for(;n<t.names.length;n++){if(!e.hasOwnProperty(t.names[n]))return-1;i[t.names[n]]||o++}return o},r=!0,s=window.location,a=function(t){return(t+"").replace(/([.?*+\^$\[\]\\(){}|\-])/g,"\\$1")},l=t.each,c=t.extend;t.route=function(o,n){n=n||{};var i=[],r=o.replace(e,function(e,r,s){return i.push(r),"([^\\"+(o.substr(s+e.length,1)||t.route._querySeparator)+"]"+(n[r]?"*":"+")+")"});return t.route.routes[o]={test:new RegExp("^"+r+"($|"+a(t.route._querySeparator)+")"),route:o,names:i,defaults:n,length:o.split("/").length},t.route},c(t.route,{_querySeparator:"&",_paramsMatcher:o,param:function(o,n){var r,s,a=0,u=o.route,h=0;if(delete o.route,l(o,function(){h++}),l(t.route.routes,function(t,e){if(s=i(t,o),s>a&&(r=t,a=s),s>=h)return!1}),t.route.routes[u]&&i(t.route.routes[u],o)===a&&(r=t.route.routes[u]),r){var g,p=c({},o),d=r.route.replace(e,function(t,e){return delete p[e],o[e]===r.defaults[e]?"":encodeURIComponent(o[e])});return l(r.defaults,function(t,e){p[e]===t&&delete p[e]}),g=t.param(p),n&&t.route.attr("route",r.route),d+(g?t.route._querySeparator+g:"")}return t.isEmptyObject(o)?"":t.route._querySeparator+t.param(o)},deparam:function(e){var o={length:-1};if(l(t.route.routes,function(t,n){t.test.test(e)&&t.length>o.length&&(o=t)}),o.length>-1){var n=e.match(o.test),i=n.shift(),r=e.substr(i.length-(n[n.length-1]===t.route._querySeparator?1:0)),s=r&&t.route._paramsMatcher.test(r)?t.deparam(r.slice(1)):{};return s=c(!0,{},o.defaults,s),l(n,function(e,n){e&&e!==t.route._querySeparator&&(s[o.names[n]]=decodeURIComponent(e))}),s.route=o.route,s}return e.charAt(0)!==t.route._querySeparator&&(e=t.route._querySeparator+e),t.route._paramsMatcher.test(e)?t.deparam(e.slice(1)):{}},data:new t.Observe({}),routes:{},ready:function(e){return!1===e&&(r=e),!0!==e&&!0!==r||(t.route._setup(),d()),t.route},url:function(e,o){return o&&(e=c({},h,e)),"#!"+t.route.param(e)},link:function(e,o,i,r){return"<a "+n(c({href:t.route.url(o,r)},i))+">"+e+"</a>"},current:function(e){return s.hash=="#!"+t.route.param(e)},_setup:function(){t.bind.call(window,"hashchange",d)},_getHash:function(){return s.href.split(/#!?/)[1]||""},_setHash:function(e){var o=t.route.param(e,!0);return s.hash="#!"+o,o}}),l(["bind","unbind","delegate","undelegate","attr","removeAttr"],function(e){t.route[e]=function(){if(t.route.data[e])return t.route.data[e].apply(t.route.data,arguments)}});var u,h,g,p,d=t.route.setState=function(){var e=t.route._getHash();h=t.route.deparam(e),p&&e===g||t.route.attr(h,!0)};return t.route.bind("change",function(e,o){p=1,clearTimeout(u),u=setTimeout(function(){p=0;var e=t.route.data.serialize();g=t.route._setHash(e)},1)}),t.bind.call(document,"ready",t.route.ready),"complete"!==document.readyState&&"interactive"!==document.readyState||!r||t.route.ready(),t.route.constructor.canMakeObserve=t.Observe.canMakeObserve,t.route}(__m3),__m21=function(t){return t.Control.processors.route=function(e,o,n,i,r){n=n||"",t.route(n);var s,a=function(e,o,a){if(t.route.attr("route")===n&&(e.batchNum===undefined||e.batchNum!==s)){s=e.batchNum;var l=t.route.attr();delete l.route,t.isFunction(r[i])?r[i](l):r[r[i]](l)}};return t.route.bind("change",a),function(){t.route.unbind("change",a)}},t}(__m3),__m22=function(t){t.view.ext=".mustache";var e="___st4ck3d",o="___st4ck(___c0nt3xt,this)",n="{context:"+o+",options:options}",i=function(e){return null!==e&&t.isFunction(e.attr)&&e.constructor&&!!e.constructor.canMakeObserve},r=function(t){return t&&t.splice&&"number"==typeof t.length},s=function(e,o){if(this.constructor!=s){var n=new s(e);return function(t,e){return n.render(t,e)}}if("function"==typeof e)return void(this.template={fn:e});t.extend(this,e),this.template=this.scanner.scan(this.text,this.name)};t.Mustache=window.Mustache=s,s.prototype.render=function(t,e){return t=t||{},e=e||{},e.helpers||e.partials||(e.helpers=e),this.template.fn.call(t,t,{_data:t,options:e})},t.extend(s.prototype,{scanner:new t.view.Scanner({text:{start:"var ___c0nt3xt = this && this.___st4ck3d ? this : [];___c0nt3xt.___st4ck3d = true;var ___st4ck = function(context, self) {var s;if (arguments.length == 1 && context) {s = !context.___st4ck3d ? [context] : context;} else if (!context.___st4ck3d) {s = [self, context];} else if (context && context === self && context.___st4ck3d) {s = context.slice(0);} else {s = context && context.___st4ck3d ? context.concat([self]) : ___st4ck(context).concat([self]);}return (s.___st4ck3d = true) && s;};"},tokens:[["returnLeft","{{{","{{[{&]"],["commentFull","{{!}}","^[\\s\\t]*{{!.+?}}\\n"],["commentLeft","{{!","(\\n[\\s\\t]*{{!|{{!)"],["escapeFull","{{}}","(^[\\s\\t]*{{[#/^][^}]+?}}\\n|\\n[\\s\\t]*{{[#/^][^}]+?}}\\n|\\n[\\s\\t]*{{[#/^][^}]+?}}$)",function(t){return{before:/^\n.+?\n$/.test(t)?"\n":"",content:t.match(/\{\{(.+?)\}\}/)[1]||""}}],["escapeLeft","{{"],["returnRight","}}}"],["right","}}"]],helpers:[{name:/^>[\s]*\w*/,fn:function(e,n){var i=t.trim(e.replace(/^>\s?/,"")).replace(/["|']/g,"");return"options.partials && options.partials['"+i+"'] ? can.Mustache.renderPartial(options.partials['"+i+"'],"+o+",options) : can.Mustache.render('"+i+"', "+o+")"}},{name:/^\s*data\s/,fn:function(t,e){return"can.proxy(function(__){can.data(can.$(__),'"+t.match(/["|'](.*)["|']/)[1]+"', this.pop()); }, "+o+")"}},{name:/^.*$/,fn:function(e,o){var i=!1,r=[];if(e=t.trim(e),e.length&&(i=e.match(/^([#^\/]|else$)/))){switch(i=i[0]){case"#":case"^":r.push(o.insert+"can.view.txt(0,'"+o.tagName+"',"+o.status+",this,function(){ return ");break;case"/":return{raw:'return ___v1ew.join("");}}])}));'}}e=e.substring(1)}if("else"!=i){var s,a,l=[],c=0,u=!1;for((t.trim(e)+" ").replace(/((([^\s]+?=)?('.*?'|".*?"))|.*?)\s/g,function(t,e){l.push(e)}),r.push("can.Mustache.txt("+n+","+(i?'"'+i+'"':"null")+",");s=l[c];c++)c&&r.push(","),c&&(a=s.match(/^(('.*?'|".*?"|[0-9]+\.?[0-9]*|true|false)|((.+?)=(('.*?'|".*?"|[0-9]+\.?[0-9]*|true|false)|(.+))))$/))?a[2]?r.push(a[0]):(u||(u=!0,r.push("{___h4sh:{")),r.push(a[4],":",a[6]?a[6]:'can.Mustache.get("'+a[5].replace(/"/g,'\\"')+'",'+n+")"),c==l.length-1&&r.push("}}")):r.push('can.Mustache.get("'+s.replace(/"/g,'\\"')+'",'+n+(0==c&&l.length>1?",true":",false")+(c>0?",true":",false")+")")}switch(i&&"else"!=i&&r.push(",[{_:function(){"),i){case"#":r.push('return ___v1ew.join("");}},{fn:function(___c0nt3xt){var ___v1ew = [];');break;case"else":case"^":r.push('return ___v1ew.join("");}},{inverse:function(___c0nt3xt){var ___v1ew = [];');break;default:r.push(");")}return r=r.join(""),i?{raw:r}:r}}]})});for(var a=t.view.Scanner.prototype.helpers,l=0;l<a.length;l++)s.prototype.scanner.helpers.unshift(a[l]);return s.txt=function(o,n,a){var l=Array.prototype.slice.call(arguments,3),c=t.extend.apply(t,[{fn:function(){},inverse:function(){}}].concat(n?l.pop():[])),u={};if(o.context&&(u=o.options,o=o.context),f=s.getHelper(a,u)||t.isFunction(a)&&!a.isComputed&&{fn:a}){var h=o[e]&&o,o=h&&o[o.length-1]||o,g={fn:t.proxy(c.fn,o),inverse:t.proxy(c.inverse,o)},p=l[l.length-1];return h&&(g.contexts=h),p&&p.___h4sh&&(g.hash=l.pop().___h4sh),l.push(g),f.fn.apply(o,l)||""}t.isFunction(a)&&a.isComputed&&(a=a());var d,f,m,y,v=l.length?l:[a],_=!0,b=[];if(n)for(d=0;d<v.length;d++)y=v[d],m=void 0!==y&&i(y),r(y)?"#"==n?_=_&&!!(m?y.attr("length"):y.length):"^"==n&&(_=_&&!(m?y.attr("length"):y.length)):_="#"==n?_&&!!y:"^"==n?_&&!y:_;if(_)switch(n){case"#":if(r(a)){var E=i(a);for(d=0;d<a.length;d++)b.push(c.fn.call(a[d],o)||""),E&&a.attr(""+d);return b.join("")}return c.fn.call(a||{},o)||"";case"^":return c.inverse.call(a||{},o)||"";default:return""+(a!==undefined?a:"")}return""},s.get=function(e,o,n,r){var a=o.options||{};o=o.context||o;var l,c,u,h,g,p,d,f=o[o.length-1],m=o[o.length-2],y=-1==e.indexOf("\\.")?e.split("."):function(){var t=[],o=0;return e.replace(/(\\)?\./g,function(n,i,r){i||(t.push(e.slice(o,r).replace(/\\\./g,".")),o=r+n.length)}),t.push(e.slice(o).replace(/\\\./g,".")),t}(),v=y.length;if(/^\.|this$/.test(e)){if(/^object|undefined$/.test(typeof m)){for(;l=o.pop();)if(void 0!==l)return l;return""}return m||""}if(!n)for(h=o.length-1;h>=0;h--){if(l=o[h],t.isFunction(l)&&l.isComputed&&(l=l()),void 0!==l&&null!==l){var n=s.getHelper(e,a);for(g=0;g<v;g++){if(void 0===l[y[g]]||null===l[y[g]]){if(n)return e;if(i(l)){p=l,d=y[g],c=l=undefined;break}c=l=undefined;break}c=l,l=l[u=y[g]]}}if(l!==undefined)return s.resolve(l,c,u,r)}return!p||s.getHelper(e)&&-1===t.inArray(d,t.Observe.keys(p))?(l=s.getHelper(e,a))?e:void 0!==f&&null!==f&&t.isFunction(f[e])?f[e]:"":p.compute(d)},s.resolve=function(e,o,n,s){return o&&t.isFunction(o[n])&&s?o[n].isComputed?o[n]:function(){return o[n].apply(o,arguments)}:o&&t.isFunction(o)&&o.isComputed?o()[n]:o&&t.isFunction(o[n])?o[n]():i(e)&&r(e)&&e.attr("length")?e:o&&i(o)?o.compute(n):t.isFunction(e)?e():e},s._helpers={},s.registerHelper=function(t,e){this._helpers[t]={name:t,fn:e}},s.getHelper=function(t,e){return e&&e.helpers&&e.helpers[t]&&{fn:e.helpers[t]}||this._helpers[t]},s.render=function(e,o){return!t.view.cached[e]&&o[e]&&(e=o[e]),t.view.render(e,o)},s.renderPartial=function(t,e,o){return t.render?t.render(e,o):t(e,o)},t.each({if:function(t,e){return s.resolve(t)?e.fn(e.contexts||this):e.inverse(e.contexts||this)},unless:function(t,e){if(!s.resolve(t))return e.fn(e.contexts||this)},each:function(e,o){if((e=s.resolve(e))&&r(e)){if(i(e)&&e.attr("length"))return t.view.lists&&t.view.lists(e,function(t){return o.fn(t)});for(var n=[],a=0;a<e.length;a++)n.push(o.fn(e[a]));return n.join("")}},with:function(t,e){var o=t;if(t=s.resolve(t))return e.fn(o)}},function(t,e){s.registerHelper(e,t)}),t.view.register({suffix:"mustache",contentType:"x-mustache-template",script:function(t,e){return"can.Mustache(function(_CONTEXT,_VIEW) { "+new s({text:e,name:t}).template.out+" })"},renderer:function(t,e){return s({text:e,name:t})}}),t}(__m3);window.can=__m5}()}).call(exports,__webpack_require__(0))},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;this.JSON||(this.JSON={}),function(){function f(t){return t<10?"0"+t:t}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var o,n,i,r,s,a=gap,l=e[t];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(t)),"function"==typeof rep&&(l=rep.call(e,t,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(l)){for(r=l.length,o=0;o<r;o+=1)s[o]=str(o,l)||"null";return i=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+a+"]":"["+s.join(",")+"]",gap=a,i}if(rep&&"object"==typeof rep)for(r=rep.length,o=0;o<r;o+=1)"string"==typeof(n=rep[o])&&(i=str(n,l))&&s.push(quote(n)+(gap?": ":":")+i);else for(n in l)Object.hasOwnProperty.call(l,n)&&(i=str(n,l))&&s.push(quote(n)+(gap?": ":":")+i);return i=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+a+"}":"{"+s.join(",")+"}",gap=a,i}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(t){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(t){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,e,o){var n;if(gap="",indent="","number"==typeof o)for(n=0;n<o;n+=1)indent+=" ";else"string"==typeof o&&(indent=o);if(rep=e,!e||"function"==typeof e||"object"==typeof e&&"number"==typeof e.length)return str("",{"":t});throw new Error("JSON.stringify")}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(t,e){var o,n,i=t[e];if(i&&"object"==typeof i)for(o in i)Object.hasOwnProperty.call(i,o)&&(n=walk(i,o),void 0!==n?i[o]=n:delete i[o]);return reviver.call(t,e,i)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(t,e){__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_FACTORY__=e,void 0!==(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof __WEBPACK_AMD_DEFINE_FACTORY__?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}(0,function(){var t,e={},o=window,n=o.document,i="localStorage",r="script";if(e.disabled=!1,e.version="1.3.17",e.set=function(t,e){},e.get=function(t,e){},e.has=function(t){return void 0!==e.get(t)},e.remove=function(t){},e.clear=function(){},e.transact=function(t,o,n){null==n&&(n=o,o=null),null==o&&(o={});var i=e.get(t,o);n(i),e.set(t,i)},e.getAll=function(){},e.forEach=function(){},e.serialize=function(t){return JSON.stringify(t)},e.deserialize=function(t){if("string"==typeof t)try{return JSON.parse(t)}catch(e){return t||void 0}},function(){try{return i in o&&o[i]}catch(t){return!1}}())t=o[i],e.set=function(o,n){return void 0===n?e.remove(o):(t.setItem(o,e.serialize(n)),n)},e.get=function(o,n){var i=e.deserialize(t.getItem(o));return void 0===i?n:i},e.remove=function(e){t.removeItem(e)},e.clear=function(){t.clear()},e.getAll=function(){var t={};return e.forEach(function(e,o){t[e]=o}),t},e.forEach=function(o){for(var n=0;n<t.length;n++){var i=t.key(n);o(i,e.get(i))}};else if(n.documentElement.addBehavior){var s,a;try{a=new ActiveXObject("htmlfile"),a.open(),a.write("<"+r+">document.w=window</"+r+'><iframe src="/favicon.ico"></iframe>'),a.close(),s=a.w.frames[0].document,t=s.createElement("div")}catch(e){t=n.createElement("div"),s=n.body}var l=function(o){return function(){var n=Array.prototype.slice.call(arguments,0);n.unshift(t),s.appendChild(t),t.addBehavior("#default#userData"),t.load(i);var r=o.apply(e,n);return s.removeChild(t),r}},c=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g"),u=function(t){return t.replace(/^d/,"___$&").replace(c,"___")};e.set=l(function(t,o,n){return o=u(o),void 0===n?e.remove(o):(t.setAttribute(o,e.serialize(n)),t.save(i),n)}),e.get=l(function(t,o,n){o=u(o);var i=e.deserialize(t.getAttribute(o));return void 0===i?n:i}),e.remove=l(function(t,e){e=u(e),t.removeAttribute(e),t.save(i)}),e.clear=l(function(t){var e=t.XMLDocument.documentElement.attributes;for(t.load(i);e.length;)t.removeAttribute(e[0].name);t.save(i)}),e.getAll=function(t){var o={};return e.forEach(function(t,e){o[t]=e}),o},e.forEach=l(function(t,o){for(var n,i=t.XMLDocument.documentElement.attributes,r=0;n=i[r];++r)o(n.name,e.deserialize(t.getAttribute(n.name)))})}try{var h="__storejs__";e.set(h,h),e.get(h)!=h&&(e.disabled=!0),e.remove(h)}catch(t){e.disabled=!0}return e.enabled=!e.disabled,e})},function(t,e,o){(function(t){!function(e,o,n){e.marketplace=function(e,n,i,r,s,a,l,c,u){this.cart=o(".js-marketplace-cart");var h,g;"production"==c?(h="https://mkp-be-prod.spark.autodesk.com/api/v1",g="https://api.acg.autodesk.com/api/v2"):(h="https://mkp-be-beta.spark.autodesk.com/api/v1",g="https://beta-api.acg.autodesk.com/api/v2"),this.urls={session:g+"/session",carts:h+"/carts",cartoverview:h+"/carts/management",managementUrl:h+"/carts/managementUrl",carttransfer:h+"/carts/transfer",checkouturl:h+"/carts/checkoutUrl",pcburl:h+"/carts/pcb",asseturl:h+"/assets"};var p=this;this.tenant=n,this.afc=e,this.user=i,this.session=r,this.secure_session=s,this.coppa=a,this.cs_member_id=u,this.iframe_url=!1,this.iframe_child=!1,this.shop_url=l,this.cartCount=0,0==r?this.getSession(p.getCart):this.getCart(this),this.user||store.set("sparkmarketplace_anonymous_session",this.session);var d=store.get("sparkmarketplace_anonymous_session");return d&&d!=this.session&&o.ajax(p.urls.carttransfer,{method:"POST",headers:{"X-Session":this.session,"X-Tenant":this.tenant},data:{guest_session:d},success:function(t){store.remove("sparkmarketplace_anonymous_session"),p.getCart(p)},error:function(e){console.log(e);var o=t.Event("spark:marketplace:error",{err:e});p.cart.trigger(o)}}),o.extend(this.cart,{addToCart:function(t,e,o,n){p.addToCart(t,e,o,n)},showCart:function(t){p.showCart(t)},getPCBPrice:function(t,e,o,n){p.getPCBPrice(t,e,o,n)},addToCartPCB:function(t,e,o,n,i,r,s,a){p.addToCartPCB(t,e,o,n,i,r,s,a)},getPrice:function(t,e,o){p.getPrice(t,e,o)}})},e.marketplace.prototype.getSession=function(e){var n=this;o.ajax(n.urls.session,{method:"GET",headers:{"X-AFC":this.afc},success:function(t){n.session=t.SESSION,e(n)},error:function(e){console.log(e);var o=t.Event("spark:marketplace:error",{err:e});n.cart.trigger(o)}})},e.marketplace.prototype.getCart=function(e){var n=e;o.ajax(n.urls.cartoverview,{method:"GET",headers:{"X-Session":e.session,"X-Tenant":e.tenant},success:function(e){var i=o.parseJSON(e);i.line_items&&n.updateCartCount(n.cleanCountItems(i.line_items));var r=t.Event("spark:marketplace:loaded");n.cart.trigger(r)},error:function(e){console.log(e);var o=t.Event("spark:marketplace:error",{err:e});n.cart.trigger(o)}})},e.marketplace.prototype.addToCart=function(e,n,i,r){var s=this;n=void 0!==n?n:1,i=void 0!==i?i:"PHYSICAL";var a=t.Event("spark:marketplace:loading");this.cart.trigger(a),console.log("adding to cart item: "+e),o.ajax(s.urls.carts,{method:"PUT",headers:{"X-Session":this.session,"X-Tenant":this.tenant},data:{product_id:e,product_type:i,quantity:n,analytics:JSON.stringify(r)},success:function(e){var n=o.parseJSON(e);s.updateCartCount(s.cleanCountItems(n.cart.line_items));var i=t.Event("spark:marketplace:new");s.cart.trigger(i)},error:function(e){console.log(e);var o=t.Event("spark:marketplace:error",{err:e});s.cart.trigger(o)}})},e.marketplace.prototype.addToCartPCB=function(e,n,i,r,s,a,l,c){var u=this;i=void 0!==i?i:1;var h={thumbnail_url:r,name:n},g={sqin:s,board_type_id:a,board_id:e},p=t.Event("spark:marketplace:loading");this.cart.trigger(p),o.ajax(u.urls.pcburl,{method:"PUT",headers:{"X-Session":this.session,"X-Tenant":this.tenant},data:{quantity:i,check:l,data:JSON.stringify(h),pcb_item_data:JSON.stringify(g),analytics:JSON.stringify(c)},success:function(e){var n=o.parseJSON(e);u.updateCartCount(u.cleanCountItems(n.cart.line_items));var i=t.Event("spark:marketplace:new");u.cart.trigger(i)},error:function(e){console.log(e);var o=t.Event("spark:marketplace:error",{err:e});u.cart.trigger(o)}})},e.marketplace.prototype.cleanCountItems=function(t){var e=0;return o(t).each(function(t,o){o.product_type&&"SHIPPING"!=o.product_type&&(e+=o.quantity)}),e},e.marketplace.prototype.updateCartCount=function(e){this.cartCount=e;var o=t.Event("spark:marketplace:updated",{count:e});this.cart.trigger(o)},e.marketplace.prototype.showCart=function(t){this.iframe=o(t),this.getiframeUrl()},e.marketplace.prototype.getiframeUrl=function(){var e=this,n={"X-Session":this.session,"X-Tenant":this.tenant};this.secure_session&&(n["X-Secure-Session"]=this.secure_session),o.ajax(e.urls.managementUrl,{method:"GET",headers:n,success:function(t){e.iframe_url=t,e.setiframe(t)},error:function(o){console.log(o);var n=t.Event("spark:marketplace:error",{err:o});e.cart.trigger(n)}})},e.marketplace.prototype.setiframe=function(t){var e=this;this.iframe.attr("src",t),this.iframe_child=o(this.iframe).seamless({loading:"Loading shopping cart...",spinner:""}),this.user?this.iframe_child.send({message:"sparkMkp_login",csMemberId:this.cs_member_id,coppaAllowed:this.coppa}):this.iframe_child.send({message:"sparkMkp_logout"}),this.iframe_child.receive(function(t){if(console.log(t),t.type)switch(t.type){case"sparkMkp_updateCartCount":console.log("Now there are "+t.numberOfItems+" items in the cart"),e.updateCartCount(t.numberOfItems);break;case"sparkMkp_editingShippingAddress":console.log("user is editing shipping address");break;case"sparkMkp_login":console.log("User needs to login! He/She is logged out and probably clicked something that needs a logged in user, like edit shipping address"),signin.construct_box();break;case"sparkMkp_goToShopping":window.location=e.shop_url}})},e.marketplace.prototype.getPCBPrice=function(e,n,i,r){var s=this;o.ajax(s.urls.pcburl,{method:"GET",dataType:"json",headers:{"X-Tenant":this.tenant},data:{sqin:e,board_type_id:n},success:function(t){r(i,t.price)},error:function(e){console.log(e);var o=t.Event("spark:marketplace:error",{err:e});s.cart.trigger(o)}})},e.marketplace.prototype.getPrice=function(e,n,i){var r=this;o.ajax(r.urls.asseturl+"/"+e,{method:"GET",dataType:"json",headers:{"X-Session":this.session,"X-Tenant":this.tenant},success:function(t){i(n,t)},error:function(e){console.log(e);var o=t.Event("spark:marketplace:error",{err:e});r.cart.trigger(o)}})}}(window.Spark=window.Spark||{},t)}).call(e,o(0))},function(t,e,o){var n;/*! Hammer.JS - v2.0.4 - 2014-09-28
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2014 Jorik Tangelder;
 * Licensed under the MIT license */
!function(i,r,s,a){"use strict";function l(t,e,o){return setTimeout(d(t,o),e)}function c(t,e,o){return!!Array.isArray(t)&&(u(t,o[e],o),!0)}function u(t,e,o){var n;if(t)if(t.forEach)t.forEach(e,o);else if(t.length!==a)for(n=0;n<t.length;)e.call(o,t[n],n,t),n++;else for(n in t)t.hasOwnProperty(n)&&e.call(o,t[n],n,t)}function h(t,e,o){for(var n=Object.keys(e),i=0;i<n.length;)(!o||o&&t[n[i]]===a)&&(t[n[i]]=e[n[i]]),i++;return t}function g(t,e){return h(t,e,!0)}function p(t,e,o){var n,i=e.prototype;n=t.prototype=Object.create(i),n.constructor=t,n._super=i,o&&h(n,o)}function d(t,e){return function(){return t.apply(e,arguments)}}function f(t,e){return typeof t==dt?t.apply(e?e[0]||a:a,e):t}function m(t,e){return t===a?e:t}function y(t,e,o){u(E(e),function(e){t.addEventListener(e,o,!1)})}function v(t,e,o){u(E(e),function(e){t.removeEventListener(e,o,!1)})}function _(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function b(t,e){return t.indexOf(e)>-1}function E(t){return t.trim().split(/\s+/g)}function x(t,e,o){if(t.indexOf&&!o)return t.indexOf(e);for(var n=0;n<t.length;){if(o&&t[n][o]==e||!o&&t[n]===e)return n;n++}return-1}function S(t){return Array.prototype.slice.call(t,0)}function T(t,e,o){for(var n=[],i=[],r=0;r<t.length;){var s=e?t[r][e]:t[r];x(i,s)<0&&n.push(t[r]),i[r]=s,r++}return o&&(n=e?n.sort(function(t,o){return t[e]>o[e]}):n.sort()),n}function w(t,e){for(var o,n,i=e[0].toUpperCase()+e.slice(1),r=0;r<gt.length;){if(o=gt[r],(n=o?o+i:e)in t)return n;r++}return a}function C(){return vt++}function k(t){var e=t.ownerDocument;return e.defaultView||e.parentWindow}function A(t,e){var o=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){f(t.options.enable,[t])&&o.handler(e)},this.init()}function I(t){var e=t.options.inputClass;return new(e||(Et?V:xt?q:bt?Y:G))(t,B)}function B(t,e,o){var n=o.pointers.length,i=o.changedPointers.length,r=e&Ct&&n-i==0,s=e&(At|It)&&n-i==0;o.isFirst=!!r,o.isFinal=!!s,r&&(t.session={}),o.eventType=e,M(t,o),t.emit("hammer.input",o),t.recognize(o),t.session.prevInput=o}function M(t,e){var o=t.session,n=e.pointers,i=n.length;o.firstInput||(o.firstInput=R(e)),i>1&&!o.firstMultiple?o.firstMultiple=R(e):1===i&&(o.firstMultiple=!1);var r=o.firstInput,s=o.firstMultiple,a=s?s.center:r.center,l=e.center=D(n);e.timeStamp=yt(),e.deltaTime=e.timeStamp-r.timeStamp,e.angle=F(a,l),e.distance=j(a,l),L(o,e),e.offsetDirection=P(e.deltaX,e.deltaY),e.scale=s?U(s.pointers,n):1,e.rotation=s?H(s.pointers,n):0,N(o,e);var c=t.element;_(e.srcEvent.target,c)&&(c=e.srcEvent.target),e.target=c}function L(t,e){var o=e.center,n=t.offsetDelta||{},i=t.prevDelta||{},r=t.prevInput||{};(e.eventType===Ct||r.eventType===At)&&(i=t.prevDelta={x:r.deltaX||0,y:r.deltaY||0},n=t.offsetDelta={x:o.x,y:o.y}),e.deltaX=i.x+(o.x-n.x),e.deltaY=i.y+(o.y-n.y)}function N(t,e){var o,n,i,r,s=t.lastInterval||e,l=e.timeStamp-s.timeStamp;if(e.eventType!=It&&(l>wt||s.velocity===a)){var c=s.deltaX-e.deltaX,u=s.deltaY-e.deltaY,h=O(l,c,u);n=h.x,i=h.y,o=mt(h.x)>mt(h.y)?h.x:h.y,r=P(c,u),t.lastInterval=e}else o=s.velocity,n=s.velocityX,i=s.velocityY,r=s.direction;e.velocity=o,e.velocityX=n,e.velocityY=i,e.direction=r}function R(t){for(var e=[],o=0;o<t.pointers.length;)e[o]={clientX:ft(t.pointers[o].clientX),clientY:ft(t.pointers[o].clientY)},o++;return{timeStamp:yt(),pointers:e,center:D(e),deltaX:t.deltaX,deltaY:t.deltaY}}function D(t){var e=t.length;if(1===e)return{x:ft(t[0].clientX),y:ft(t[0].clientY)};for(var o=0,n=0,i=0;e>i;)o+=t[i].clientX,n+=t[i].clientY,i++;return{x:ft(o/e),y:ft(n/e)}}function O(t,e,o){return{x:e/t||0,y:o/t||0}}function P(t,e){return t===e?Bt:mt(t)>=mt(e)?t>0?Mt:Lt:e>0?Nt:Rt}function j(t,e,o){o||(o=jt);var n=e[o[0]]-t[o[0]],i=e[o[1]]-t[o[1]];return Math.sqrt(n*n+i*i)}function F(t,e,o){o||(o=jt);var n=e[o[0]]-t[o[0]],i=e[o[1]]-t[o[1]];return 180*Math.atan2(i,n)/Math.PI}function H(t,e){return F(e[1],e[0],Ft)-F(t[1],t[0],Ft)}function U(t,e){return j(e[0],e[1],Ft)/j(t[0],t[1],Ft)}function G(){this.evEl=Ut,this.evWin=Gt,this.allow=!0,this.pressed=!1,A.apply(this,arguments)}function V(){this.evEl=zt,this.evWin=qt,A.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function W(){this.evTarget=Yt,this.evWin=Kt,this.started=!1,A.apply(this,arguments)}function z(t,e){var o=S(t.touches),n=S(t.changedTouches);return e&(At|It)&&(o=T(o.concat(n),"identifier",!0)),[o,n]}function q(){this.evTarget=Qt,this.targetIds={},A.apply(this,arguments)}function X(t,e){var o=S(t.touches),n=this.targetIds;if(e&(Ct|kt)&&1===o.length)return n[o[0].identifier]=!0,[o,o];var i,r,s=S(t.changedTouches),a=[],l=this.target;if(r=o.filter(function(t){return _(t.target,l)}),e===Ct)for(i=0;i<r.length;)n[r[i].identifier]=!0,i++;for(i=0;i<s.length;)n[s[i].identifier]&&a.push(s[i]),e&(At|It)&&delete n[s[i].identifier],i++;return a.length?[T(r.concat(a),"identifier",!0),a]:void 0}function Y(){A.apply(this,arguments);var t=d(this.handler,this);this.touch=new q(this.manager,t),this.mouse=new G(this.manager,t)}function K(t,e){this.manager=t,this.set(e)}function $(t){if(b(t,ne))return ne;var e=b(t,ie),o=b(t,re);return e&&o?ie+" "+re:e||o?e?ie:re:b(t,oe)?oe:ee}function Q(t){this.id=C(),this.manager=null,this.options=g(t||{},this.defaults),this.options.enable=m(this.options.enable,!0),this.state=se,this.simultaneous={},this.requireFail=[]}function J(t){return t&he?"cancel":t&ce?"end":t&le?"move":t&ae?"start":""}function Z(t){return t==Rt?"down":t==Nt?"up":t==Mt?"left":t==Lt?"right":""}function tt(t,e){var o=e.manager;return o?o.get(t):t}function et(){Q.apply(this,arguments)}function ot(){et.apply(this,arguments),this.pX=null,this.pY=null}function nt(){et.apply(this,arguments)}function it(){Q.apply(this,arguments),this._timer=null,this._input=null}function rt(){et.apply(this,arguments)}function st(){et.apply(this,arguments)}function at(){Q.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function lt(t,e){return e=e||{},e.recognizers=m(e.recognizers,lt.defaults.preset),new ct(t,e)}function ct(t,e){e=e||{},this.options=g(e,lt.defaults),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.element=t,this.input=I(this),this.touchAction=new K(this,this.options.touchAction),ut(this,!0),u(e.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function ut(t,e){var o=t.element;u(t.options.cssProps,function(t,n){o.style[w(o.style,n)]=e?t:""})}function ht(t,e){var o=r.createEvent("Event");o.initEvent(t,!0,!0),o.gesture=e,e.target.dispatchEvent(o)}var gt=["","webkit","moz","MS","ms","o"],pt=r.createElement("div"),dt="function",ft=Math.round,mt=Math.abs,yt=Date.now,vt=1,_t=/mobile|tablet|ip(ad|hone|od)|android/i,bt="ontouchstart"in i,Et=w(i,"PointerEvent")!==a,xt=bt&&_t.test(navigator.userAgent),St="touch",Tt="mouse",wt=25,Ct=1,kt=2,At=4,It=8,Bt=1,Mt=2,Lt=4,Nt=8,Rt=16,Dt=Mt|Lt,Ot=Nt|Rt,Pt=Dt|Ot,jt=["x","y"],Ft=["clientX","clientY"];A.prototype={handler:function(){},init:function(){this.evEl&&y(this.element,this.evEl,this.domHandler),this.evTarget&&y(this.target,this.evTarget,this.domHandler),this.evWin&&y(k(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&v(this.element,this.evEl,this.domHandler),this.evTarget&&v(this.target,this.evTarget,this.domHandler),this.evWin&&v(k(this.element),this.evWin,this.domHandler)}};var Ht={mousedown:Ct,mousemove:kt,mouseup:At},Ut="mousedown",Gt="mousemove mouseup";p(G,A,{handler:function(t){var e=Ht[t.type];e&Ct&&0===t.button&&(this.pressed=!0),e&kt&&1!==t.which&&(e=At),this.pressed&&this.allow&&(e&At&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:Tt,srcEvent:t}))}});var Vt={pointerdown:Ct,pointermove:kt,pointerup:At,pointercancel:It,pointerout:It},Wt={2:St,3:"pen",4:Tt,5:"kinect"},zt="pointerdown",qt="pointermove pointerup pointercancel";i.MSPointerEvent&&(zt="MSPointerDown",qt="MSPointerMove MSPointerUp MSPointerCancel"),p(V,A,{handler:function(t){var e=this.store,o=!1,n=t.type.toLowerCase().replace("ms",""),i=Vt[n],r=Wt[t.pointerType]||t.pointerType,s=r==St,a=x(e,t.pointerId,"pointerId");i&Ct&&(0===t.button||s)?0>a&&(e.push(t),a=e.length-1):i&(At|It)&&(o=!0),0>a||(e[a]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:r,srcEvent:t}),o&&e.splice(a,1))}});var Xt={touchstart:Ct,touchmove:kt,touchend:At,touchcancel:It},Yt="touchstart",Kt="touchstart touchmove touchend touchcancel";p(W,A,{handler:function(t){var e=Xt[t.type];if(e===Ct&&(this.started=!0),this.started){var o=z.call(this,t,e);e&(At|It)&&o[0].length-o[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:o[0],changedPointers:o[1],pointerType:St,srcEvent:t})}}});var $t={touchstart:Ct,touchmove:kt,touchend:At,touchcancel:It},Qt="touchstart touchmove touchend touchcancel";p(q,A,{handler:function(t){var e=$t[t.type],o=X.call(this,t,e);o&&this.callback(this.manager,e,{pointers:o[0],changedPointers:o[1],pointerType:St,srcEvent:t})}}),p(Y,A,{handler:function(t,e,o){var n=o.pointerType==St,i=o.pointerType==Tt;if(n)this.mouse.allow=!1;else if(i&&!this.mouse.allow)return;e&(At|It)&&(this.mouse.allow=!0),this.callback(t,e,o)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Jt=w(pt.style,"touchAction"),Zt=Jt!==a,te="compute",ee="auto",oe="manipulation",ne="none",ie="pan-x",re="pan-y";K.prototype={set:function(t){t==te&&(t=this.compute()),Zt&&(this.manager.element.style[Jt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return u(this.manager.recognizers,function(e){f(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),$(t.join(" "))},preventDefaults:function(t){if(!Zt){var e=t.srcEvent,o=t.offsetDirection;if(this.manager.session.prevented)return void e.preventDefault();var n=this.actions,i=b(n,ne),r=b(n,re),s=b(n,ie);return i||r&&o&Dt||s&&o&Ot?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var se=1,ae=2,le=4,ce=8,ue=ce,he=16;Q.prototype={defaults:{},set:function(t){return h(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(c(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=tt(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return c(t,"dropRecognizeWith",this)?this:(t=tt(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(c(t,"requireFailure",this))return this;var e=this.requireFail;return t=tt(t,this),-1===x(e,t)&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(c(t,"dropRequireFailure",this))return this;t=tt(t,this);var e=x(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){function e(e){o.manager.emit(o.options.event+(e?J(n):""),t)}var o=this,n=this.state;ce>n&&e(!0),e(),n>=ce&&e(!0)},tryEmit:function(t){return this.canEmit()?this.emit(t):void(this.state=32)},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(32|se)))return!1;t++}return!0},recognize:function(t){var e=h({},t);return f(this.options.enable,[this,e])?(this.state&(ue|he|32)&&(this.state=se),this.state=this.process(e),void(this.state&(ae|le|ce|he)&&this.tryEmit(e))):(this.reset(),void(this.state=32))},process:function(){},getTouchAction:function(){},reset:function(){}},p(et,Q,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,o=t.eventType,n=e&(ae|le),i=this.attrTest(t);return n&&(o&It||!i)?e|he:n||i?o&At?e|ce:e&ae?e|le:ae:32}}),p(ot,et,{defaults:{event:"pan",threshold:10,pointers:1,direction:Pt},getTouchAction:function(){var t=this.options.direction,e=[];return t&Dt&&e.push(re),t&Ot&&e.push(ie),e},directionTest:function(t){var e=this.options,o=!0,n=t.distance,i=t.direction,r=t.deltaX,s=t.deltaY;return i&e.direction||(e.direction&Dt?(i=0===r?Bt:0>r?Mt:Lt,o=r!=this.pX,n=Math.abs(t.deltaX)):(i=0===s?Bt:0>s?Nt:Rt,o=s!=this.pY,n=Math.abs(t.deltaY))),t.direction=i,o&&n>e.threshold&&i&e.direction},attrTest:function(t){return et.prototype.attrTest.call(this,t)&&(this.state&ae||!(this.state&ae)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Z(t.direction);e&&this.manager.emit(this.options.event+e,t),this._super.emit.call(this,t)}}),p(nt,et,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ne]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&ae)},emit:function(t){if(this._super.emit.call(this,t),1!==t.scale){var e=t.scale<1?"in":"out";this.manager.emit(this.options.event+e,t)}}}),p(it,Q,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[ee]},process:function(t){var e=this.options,o=t.pointers.length===e.pointers,n=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!n||!o||t.eventType&(At|It)&&!i)this.reset();else if(t.eventType&Ct)this.reset(),this._timer=l(function(){this.state=ue,this.tryEmit()},e.time,this);else if(t.eventType&At)return ue;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===ue&&(t&&t.eventType&At?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=yt(),this.manager.emit(this.options.event,this._input)))}}),p(rt,et,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ne]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&ae)}}),p(st,et,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:Dt|Ot,pointers:1},getTouchAction:function(){return ot.prototype.getTouchAction.call(this)},attrTest:function(t){var e,o=this.options.direction;return o&(Dt|Ot)?e=t.velocity:o&Dt?e=t.velocityX:o&Ot&&(e=t.velocityY),this._super.attrTest.call(this,t)&&o&t.direction&&t.distance>this.options.threshold&&mt(e)>this.options.velocity&&t.eventType&At},emit:function(t){var e=Z(t.direction);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),p(at,Q,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[oe]},process:function(t){var e=this.options,o=t.pointers.length===e.pointers,n=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),t.eventType&Ct&&0===this.count)return this.failTimeout();if(n&&i&&o){if(t.eventType!=At)return this.failTimeout();var r=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||j(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,s&&r?this.count+=1:this.count=1,this._input=t;if(0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=l(function(){this.state=ue,this.tryEmit()},e.interval,this),ae):ue}return 32},failTimeout:function(){return this._timer=l(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ue&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),lt.VERSION="2.0.4",lt.defaults={domEvents:!1,touchAction:te,enable:!0,inputTarget:null,inputClass:null,preset:[[rt,{enable:!1}],[nt,{enable:!1},["rotate"]],[st,{direction:Dt}],[ot,{direction:Dt},["swipe"]],[at],[at,{event:"doubletap",taps:2},["tap"]],[it]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};ct.prototype={set:function(t){return h(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var o,n=this.recognizers,i=e.curRecognizer;(!i||i&&i.state&ue)&&(i=e.curRecognizer=null);for(var r=0;r<n.length;)o=n[r],2===e.stopped||i&&o!=i&&!o.canRecognizeWith(i)?o.reset():o.recognize(t),!i&&o.state&(ae|le|ce)&&(i=e.curRecognizer=o),r++}},get:function(t){if(t instanceof Q)return t;for(var e=this.recognizers,o=0;o<e.length;o++)if(e[o].options.event==t)return e[o];return null},add:function(t){if(c(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(c(t,"remove",this))return this;var e=this.recognizers;return t=this.get(t),e.splice(x(e,t),1),this.touchAction.update(),this},on:function(t,e){var o=this.handlers;return u(E(t),function(t){o[t]=o[t]||[],o[t].push(e)}),this},off:function(t,e){var o=this.handlers;return u(E(t),function(t){e?o[t].splice(x(o[t],e),1):delete o[t]}),this},emit:function(t,e){this.options.domEvents&&ht(t,e);var o=this.handlers[t]&&this.handlers[t].slice();if(o&&o.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var n=0;n<o.length;)o[n](e),n++}},destroy:function(){this.element&&ut(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},h(lt,{INPUT_START:Ct,INPUT_MOVE:kt,INPUT_END:At,INPUT_CANCEL:It,STATE_POSSIBLE:se,STATE_BEGAN:ae,STATE_CHANGED:le,STATE_ENDED:ce,STATE_RECOGNIZED:ue,STATE_CANCELLED:he,STATE_FAILED:32,DIRECTION_NONE:Bt,DIRECTION_LEFT:Mt,DIRECTION_RIGHT:Lt,DIRECTION_UP:Nt,DIRECTION_DOWN:Rt,DIRECTION_HORIZONTAL:Dt,DIRECTION_VERTICAL:Ot,DIRECTION_ALL:Pt,Manager:ct,Input:A,TouchAction:K,TouchInput:q,MouseInput:G,PointerEventInput:V,TouchMouseInput:Y,SingleTouchInput:W,Recognizer:Q,AttrRecognizer:et,Tap:at,Pan:ot,Swipe:st,Pinch:nt,Rotate:rt,Press:it,on:y,off:v,each:u,merge:g,extend:h,inherit:p,bindFn:d,prefixed:w}),"function"==dt&&o(1)?void 0!==(n=function(){return lt}.call(e,o,e,t))&&(t.exports=n):void 0!==t&&t.exports?t.exports=lt:i.Hammer=lt}(window,document)},function(t,e){!function(){function t(t,e){var o=t.split("."),n=B;o[0]in n||!n.execScript||n.execScript("var "+o[0]);for(var i;o.length&&(i=o.shift());)o.length||void 0===e?n=n[i]?n[i]:n[i]={}:n[i]=e}function e(t,e){function o(){}o.prototype=e.prototype,t.l=e.prototype,t.prototype=new o,t.prototype.constructor=t,t.k=function(t,o,n){for(var i=Array(arguments.length-2),r=2;r<arguments.length;r++)i[r-2]=arguments[r];return e.prototype[o].apply(t,i)}}function o(){}function n(t){this.message=t||""}function i(){}function r(){}function s(t){this.message=t||""}function a(){}function l(){}function c(){}function u(t){this.message=t||""}function h(){}function g(){this.c=[]}function p(t){this.message=t||""}function d(t){this.a=[],t instanceof a&&this.d(t)}function f(t){this.e=t,this.d=0}function m(t){this.a=[],t instanceof a&&this.d(t)}function y(t){this.e=t,this.d=0}function v(){this.b={}}function _(){}function b(t){this.a=[],t instanceof a&&this.d(t)}function E(t){this.e=t,this.d=0}function x(t){return null==t?null:t.parent}function S(t,e){null!==t&&(t.color=e)}function T(t){return null==t?null:t.left}function w(t){return null==t?null:t.right}function C(){this.b=null,this.f=0}function k(t,e){if(null!=e){var o=e.right;e.right=o.left,null!=o.left&&(o.left.parent=e),o.parent=e.parent,null==e.parent?t.b=o:e.parent.left==e?e.parent.left=o:e.parent.right=o,o.left=e,e.parent=o}}function A(t,e){if(null!=e){var o=e.left;e.left=o.right,null!=o.right&&(o.right.parent=e),o.parent=e.parent,null==e.parent?t.b=o:e.parent.right==e?e.parent.right=o:e.parent.left=o,o.right=e,e.parent=o}}function I(t){if(null===t)return null;if(null!==t.right)for(var e=t.right;null!==e.left;)e=e.left;else for(e=t.parent;null!==e&&t===e.right;)t=e,e=e.parent;return e}var B=this;t("javascript.util.Iterator",o),o.prototype.hasNext=o.prototype.b,o.prototype.next=o.prototype.c,o.prototype.remove=o.prototype.a,e(n,Error),t("javascript.util.OperationNotSupported",n),n.prototype.name="OperationNotSupported",t("javascript.util.Map",i),e(r,i),t("javascript.util.SortedMap",r),e(s,Error),t("javascript.util.IndexOutOfBoundsException",s),s.prototype.name="IndexOutOfBoundsException",t("javascript.util.Collection",a),e(l,a),t("javascript.util.Set",l),e(c,l),t("javascript.util.SortedSet",c),e(u,Error),t("javascript.util.EmptyStackException",u),u.prototype.name="EmptyStackException",e(h,a),t("javascript.util.List",h),e(g,h),t("javascript.util.Stack",g),g.prototype.push=function(t){return this.c.push(t),t},g.prototype.push=g.prototype.push,g.prototype.d=function(){if(0===this.c.length)throw new u;return this.c.pop()},g.prototype.pop=g.prototype.d,g.prototype.g=function(){if(0===this.c.length)throw new u;return this.c[this.c.length-1]},g.prototype.peek=g.prototype.g,g.prototype.a=function(){return 0===this.c.length},g.prototype.empty=g.prototype.a,g.prototype.f=function(){return this.a()},g.prototype.isEmpty=g.prototype.f,g.prototype.i=function(t){return this.c.indexOf(t)},g.prototype.search=g.prototype.i,g.prototype.b=function(){return this.c.length},g.prototype.size=g.prototype.b,g.prototype.h=function(){for(var t=[],e=0,o=this.c.length;e<o;e++)t.push(this.c[e]);return t},g.prototype.toArray=g.prototype.h,e(p,Error),t("javascript.util.NoSuchElementException",p),p.prototype.name="NoSuchElementException",e(d,c),t("javascript.util.TreeSet",d),d.prototype.g=function(t){for(var e=0,o=this.a.length;e<o;e++)if(0===this.a[e].compareTo(t))return!0;return!1},d.prototype.contains=d.prototype.g,d.prototype.c=function(t){if(this.g(t))return!1;for(var e=0,o=this.a.length;e<o;e++)if(1===this.a[e].compareTo(t))return this.a.splice(e,0,t),!0;return this.a.push(t),!0},d.prototype.add=d.prototype.c,d.prototype.d=function(t){for(t=t.e();t.b();)this.c(t.c());return!0},d.prototype.addAll=d.prototype.d,d.prototype.i=function(){throw new n},d.prototype.remove=d.prototype.i,d.prototype.b=function(){return this.a.length},d.prototype.size=d.prototype.b,d.prototype.f=function(){return 0===this.a.length},d.prototype.isEmpty=d.prototype.f,d.prototype.h=function(){for(var t=[],e=0,o=this.a.length;e<o;e++)t.push(this.a[e]);return t},d.prototype.toArray=d.prototype.h,d.prototype.e=function(){return new f(this)},d.prototype.iterator=d.prototype.e,t("$jscomp.scope.Iterator_",f),f.prototype.c=function(){if(this.d===this.e.b())throw new p;return this.e.a[this.d++]},f.prototype.next=f.prototype.c,f.prototype.b=function(){return this.d<this.e.b()},f.prototype.hasNext=f.prototype.b,f.prototype.a=function(){throw new n},f.prototype.remove=f.prototype.a,e(m,h),t("javascript.util.ArrayList",m),m.prototype.c=function(t){return this.a.push(t),!0},m.prototype.add=m.prototype.c,m.prototype.d=function(t){for(t=t.e();t.b();)this.c(t.c());return!0},m.prototype.addAll=m.prototype.d,m.prototype.j=function(t,e){var o=this.a[t];return this.a[t]=e,o},m.prototype.set=m.prototype.j,m.prototype.e=function(){return new y(this)},m.prototype.iterator=m.prototype.e,m.prototype.g=function(t){if(0>t||t>=this.b())throw new s;return this.a[t]},m.prototype.get=m.prototype.g,m.prototype.f=function(){return 0===this.a.length},m.prototype.isEmpty=m.prototype.f,m.prototype.b=function(){return this.a.length},m.prototype.size=m.prototype.b,m.prototype.h=function(){for(var t=[],e=0,o=this.a.length;e<o;e++)t.push(this.a[e]);return t},m.prototype.toArray=m.prototype.h,m.prototype.i=function(t){for(var e=!1,o=0,n=this.a.length;o<n;o++)if(this.a[o]===t){this.a.splice(o,1),e=!0;break}return e},m.prototype.remove=m.prototype.i,t("$jscomp.scope.Iterator_$1",y),y.prototype.c=function(){if(this.d===this.e.b())throw new p;return this.e.g(this.d++)},y.prototype.next=y.prototype.c,y.prototype.b=function(){return this.d<this.e.b()},y.prototype.hasNext=y.prototype.b,y.prototype.a=function(){throw new n},y.prototype.remove=y.prototype.a,e(v,i),t("javascript.util.HashMap",v),v.prototype.a=function(t){return this.b[t]||null},v.prototype.get=v.prototype.a,v.prototype.d=function(t,e){return this.b[t]=e},v.prototype.put=v.prototype.d,v.prototype.c=function(){var t,e=new m;for(t in this.b)this.b.hasOwnProperty(t)&&e.c(this.b[t]);return e},v.prototype.values=v.prototype.c,v.prototype.e=function(){return this.c().b()},v.prototype.size=v.prototype.e,t("javascript.util.Arrays",_),_.sort=function(){var t,e,o,n=arguments[0];if(1===arguments.length)n.sort();else if(2===arguments.length)e=arguments[1],o=function(t,o){return e.compare(t,o)},n.sort(o);else if(3===arguments.length)for(t=n.slice(arguments[1],arguments[2]),t.sort(),o=n.slice(0,arguments[1]).concat(t,n.slice(arguments[2],n.length)),n.splice(0,n.length),t=0;t<o.length;t++)n.push(o[t]);else if(4===arguments.length)for(t=n.slice(arguments[1],arguments[2]),e=arguments[3],o=function(t,o){return e.compare(t,o)},t.sort(o),o=n.slice(0,arguments[1]).concat(t,n.slice(arguments[2],n.length)),n.splice(0,n.length),t=0;t<o.length;t++)n.push(o[t])},_.asList=function(t){for(var e=new m,o=0,n=t.length;o<n;o++)e.c(t[o]);return e},e(b,l),t("javascript.util.HashSet",b),b.prototype.g=function(t){for(var e=0,o=this.a.length;e<o;e++)if(this.a[e]===t)return!0;return!1},b.prototype.contains=b.prototype.g,b.prototype.c=function(t){return!this.g(t)&&(this.a.push(t),!0)},b.prototype.add=b.prototype.c,b.prototype.d=function(t){for(t=t.e();t.b();)this.c(t.c());return!0},b.prototype.addAll=b.prototype.d,b.prototype.i=function(){throw new n},b.prototype.remove=b.prototype.i,b.prototype.b=function(){return this.a.length},b.prototype.size=b.prototype.b,b.prototype.f=function(){return 0===this.a.length},b.prototype.isEmpty=b.prototype.f,b.prototype.h=function(){for(var t=[],e=0,o=this.a.length;e<o;e++)t.push(this.a[e]);return t},b.prototype.toArray=b.prototype.h,b.prototype.e=function(){return new E(this)},b.prototype.iterator=b.prototype.e,t("$jscomp.scope.Iterator_$2",E),E.prototype.c=function(){if(this.d===this.e.b())throw new p;return this.e.a[this.d++]},E.prototype.next=E.prototype.c,E.prototype.b=function(){return this.d<this.e.b()},E.prototype.hasNext=E.prototype.b,E.prototype.a=function(){throw new n},E.prototype.remove=E.prototype.a,e(C,r),t("javascript.util.TreeMap",C),C.prototype.a=function(t){for(var e=this.b;null!==e;){var o=t.compareTo(e.key);if(0>o)e=e.left;else{if(!(0<o))return e.value;e=e.right}}return null},C.prototype.get=C.prototype.a,C.prototype.d=function(t,e){if(null===this.b)return this.b={key:t,value:e,left:null,right:null,parent:null,color:0},this.f=1,null;var o,n,i=this.b;do{if(o=i,0>(n=t.compareTo(i.key)))i=i.left;else{if(!(0<n))return o=i.value,i.value=e,o;i=i.right}}while(null!==i);for(i={key:t,left:null,right:null,value:e,parent:o,color:0},0>n?o.left=i:o.right=i,i.color=1;null!=i&&i!=this.b&&1==i.parent.color;)x(i)==T(x(x(i)))?(o=w(x(x(i))),1==(null==o?0:o.color)?(S(x(i),0),S(o,0),S(x(x(i)),1),i=x(x(i))):(i==w(x(i))&&(i=x(i),k(this,i)),S(x(i),0),S(x(x(i)),1),A(this,x(x(i))))):(o=T(x(x(i))),1==(null==o?0:o.color)?(S(x(i),0),S(o,0),S(x(x(i)),1),i=x(x(i))):(i==T(x(i))&&(i=x(i),A(this,i)),S(x(i),0),S(x(x(i)),1),k(this,x(x(i)))));return this.b.color=0,this.f++,null},C.prototype.put=C.prototype.d,C.prototype.c=function(){var t,e=new m;if(null!=(t=this.b))for(;null!=t.left;)t=t.left;if(null!==t)for(e.c(t.value);null!==(t=I(t));)e.c(t.value);return e},C.prototype.values=C.prototype.c,C.prototype.e=function(){return this.f},C.prototype.size=C.prototype.e}()},function(t,e,o){var n,i,r;!function(s){"use strict";i=[o(0),o(5)],n=s,void 0!==(r="function"==typeof n?n.apply(e,i):n)&&(t.exports=r)}(function(t){"use strict";function e(e){var o="dragover"===e;return function(n){n.dataTransfer=n.originalEvent&&n.originalEvent.dataTransfer;var i=n.dataTransfer;i&&-1!==t.inArray("Files",i.types)&&!1!==this._trigger(e,t.Event(e,{delegatedEvent:n}))&&(n.preventDefault(),o&&(i.dropEffect="copy"))}}t.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||t('<input type="file">').prop("disabled")),t.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader),t.support.xhrFormDataFileUpload=!!window.FormData,t.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),t.widget("blueimp.fileupload",{options:{dropZone:t(document),pasteZone:void 0,fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(e,o){return e=this.messages[e]||e.toString(),o&&t.each(o,function(t,o){e=e.replace("{"+t+"}",o)}),e},formData:function(t){return t.serializeArray()},add:function(e,o){if(e.isDefaultPrevented())return!1;(o.autoUpload||!1!==o.autoUpload&&t(this).fileupload("option","autoUpload"))&&o.process().done(function(){o.submit()})},processData:!1,contentType:!1,cache:!1},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:t.support.blobSlice&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(t,e,o){var n=t-this.timestamp;return(!this.bitrate||!o||n>o)&&(this.bitrate=(e-this.loaded)*(1e3/n)*8,this.loaded=e,this.timestamp=t),this.bitrate}},_isXHRUpload:function(e){return!e.forceIframeTransport&&(!e.multipart&&t.support.xhrFileUpload||t.support.xhrFormDataFileUpload)},_getFormData:function(e){var o;return"function"===t.type(e.formData)?e.formData(e.form):t.isArray(e.formData)?e.formData:"object"===t.type(e.formData)?(o=[],t.each(e.formData,function(t,e){o.push({name:t,value:e})}),o):[]},_getTotal:function(e){var o=0;return t.each(e,function(t,e){o+=e.size||1}),o},_initProgressObject:function(e){var o={loaded:0,total:0,bitrate:0};e._progress?t.extend(e._progress,o):e._progress=o},_initResponseObject:function(t){var e;if(t._response)for(e in t._response)t._response.hasOwnProperty(e)&&delete t._response[e];else t._response={}},_onProgress:function(e,o){if(e.lengthComputable){var n,i=Date.now?Date.now():(new Date).getTime();if(o._time&&o.progressInterval&&i-o._time<o.progressInterval&&e.loaded!==e.total)return;o._time=i,n=Math.floor(e.loaded/e.total*(o.chunkSize||o._progress.total))+(o.uploadedBytes||0),this._progress.loaded+=n-o._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(i,this._progress.loaded,o.bitrateInterval),o._progress.loaded=o.loaded=n,o._progress.bitrate=o.bitrate=o._bitrateTimer.getBitrate(i,n,o.bitrateInterval),this._trigger("progress",t.Event("progress",{delegatedEvent:e}),o),this._trigger("progressall",t.Event("progressall",{delegatedEvent:e}),this._progress)}},_initProgressListener:function(e){var o=this,n=e.xhr?e.xhr():t.ajaxSettings.xhr();n.upload&&(t(n.upload).bind("progress",function(t){var n=t.originalEvent;t.lengthComputable=n.lengthComputable,t.loaded=n.loaded,t.total=n.total,o._onProgress(t,e)}),e.xhr=function(){return n})},_isInstanceOf:function(t,e){return Object.prototype.toString.call(e)==="[object "+t+"]"},_initXHRData:function(e){var o,n=this,i=e.files[0],r=e.multipart||!t.support.xhrFileUpload,s="array"===t.type(e.paramName)?e.paramName[0]:e.paramName;e.headers=t.extend({},e.headers),e.contentRange&&(e.headers["Content-Range"]=e.contentRange),r&&!e.blob&&this._isInstanceOf("File",i)||(e.headers["Content-Disposition"]='attachment; filename="'+encodeURI(i.name)+'"'),r?t.support.xhrFormDataFileUpload&&(e.postMessage?(o=this._getFormData(e),e.blob?o.push({name:s,value:e.blob}):t.each(e.files,function(n,i){o.push({name:"array"===t.type(e.paramName)&&e.paramName[n]||s,value:i})})):(n._isInstanceOf("FormData",e.formData)?o=e.formData:(o=new FormData,t.each(this._getFormData(e),function(t,e){o.append(e.name,e.value)})),e.blob?o.append(s,e.blob,i.name):t.each(e.files,function(i,r){(n._isInstanceOf("File",r)||n._isInstanceOf("Blob",r))&&o.append("array"===t.type(e.paramName)&&e.paramName[i]||s,r,r.uploadName||r.name)})),e.data=o):(e.contentType=i.type||"application/octet-stream",e.data=e.blob||i),e.blob=null},_initIframeSettings:function(e){var o=t("<a></a>").prop("href",e.url).prop("host");e.dataType="iframe "+(e.dataType||""),e.formData=this._getFormData(e),e.redirect&&o&&o!==location.host&&e.formData.push({name:e.redirectParamName||"redirect",value:e.redirect})},_initDataSettings:function(t){this._isXHRUpload(t)?(this._chunkedUpload(t,!0)||(t.data||this._initXHRData(t),this._initProgressListener(t)),t.postMessage&&(t.dataType="postmessage "+(t.dataType||""))):this._initIframeSettings(t)},_getParamName:function(e){var o=t(e.fileInput),n=e.paramName;return n?t.isArray(n)||(n=[n]):(n=[],o.each(function(){for(var e=t(this),o=e.prop("name")||"files[]",i=(e.prop("files")||[1]).length;i;)n.push(o),i-=1}),n.length||(n=[o.prop("name")||"files[]"])),n},_initFormSettings:function(e){e.form&&e.form.length||(e.form=t(e.fileInput.prop("form")),e.form.length||(e.form=t(this.options.fileInput.prop("form")))),e.paramName=this._getParamName(e),e.url||(e.url=e.form.prop("action")||location.href),e.type=(e.type||"string"===t.type(e.form.prop("method"))&&e.form.prop("method")||"").toUpperCase(),"POST"!==e.type&&"PUT"!==e.type&&"PATCH"!==e.type&&(e.type="POST"),e.formAcceptCharset||(e.formAcceptCharset=e.form.attr("accept-charset"))},_getAJAXSettings:function(e){var o=t.extend({},this.options,e);return this._initFormSettings(o),this._initDataSettings(o),o},_getDeferredState:function(t){return t.state?t.state():t.isResolved()?"resolved":t.isRejected()?"rejected":"pending"},_enhancePromise:function(t){return t.success=t.done,t.error=t.fail,t.complete=t.always,t},_getXHRPromise:function(e,o,n){var i=t.Deferred(),r=i.promise();return o=o||this.options.context||r,!0===e?i.resolveWith(o,n):!1===e&&i.rejectWith(o,n),r.abort=i.promise,this._enhancePromise(r)},_addConvenienceMethods:function(e,o){var n=this,i=function(e){return t.Deferred().resolveWith(n,e).promise()};o.process=function(e,r){return(e||r)&&(o._processQueue=this._processQueue=(this._processQueue||i([this])).pipe(function(){return o.errorThrown?t.Deferred().rejectWith(n,[o]).promise():i(arguments)}).pipe(e,r)),this._processQueue||i([this])},o.submit=function(){return"pending"!==this.state()&&(o.jqXHR=this.jqXHR=!1!==n._trigger("submit",t.Event("submit",{delegatedEvent:e}),this)&&n._onSend(e,this)),this.jqXHR||n._getXHRPromise()},o.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",n._trigger("fail",null,this),n._getXHRPromise(!1))},o.state=function(){return this.jqXHR?n._getDeferredState(this.jqXHR):this._processQueue?n._getDeferredState(this._processQueue):void 0},o.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===n._getDeferredState(this._processQueue)},o.progress=function(){return this._progress},o.response=function(){return this._response}},_getUploadedBytes:function(t){var e=t.getResponseHeader("Range"),o=e&&e.split("-"),n=o&&o.length>1&&parseInt(o[1],10);return n&&n+1},_chunkedUpload:function(e,o){e.uploadedBytes=e.uploadedBytes||0;var n,i,r=this,s=e.files[0],a=s.size,l=e.uploadedBytes,c=e.maxChunkSize||a,u=this._blobSlice,h=t.Deferred(),g=h.promise();return!(!(this._isXHRUpload(e)&&u&&(l||c<a))||e.data)&&(!!o||(l>=a?(s.error=e.i18n("uploadedBytes"),this._getXHRPromise(!1,e.context,[null,"error",s.error])):(i=function(){var o=t.extend({},e),g=o._progress.loaded;o.blob=u.call(s,l,l+c,s.type),o.chunkSize=o.blob.size,o.contentRange="bytes "+l+"-"+(l+o.chunkSize-1)+"/"+a,r._initXHRData(o),r._initProgressListener(o),n=(!1!==r._trigger("chunksend",null,o)&&t.ajax(o)||r._getXHRPromise(!1,o.context)).done(function(n,s,c){l=r._getUploadedBytes(c)||l+o.chunkSize,g+o.chunkSize-o._progress.loaded&&r._onProgress(t.Event("progress",{lengthComputable:!0,loaded:l-o.uploadedBytes,total:l-o.uploadedBytes}),o),e.uploadedBytes=o.uploadedBytes=l,o.result=n,o.textStatus=s,o.jqXHR=c,r._trigger("chunkdone",null,o),r._trigger("chunkalways",null,o),l<a?i():h.resolveWith(o.context,[n,s,c])}).fail(function(t,e,n){o.jqXHR=t,o.textStatus=e,o.errorThrown=n,r._trigger("chunkfail",null,o),r._trigger("chunkalways",null,o),h.rejectWith(o.context,[t,e,n])})},this._enhancePromise(g),g.abort=function(){return n.abort()},i(),g)))},_beforeSend:function(t,e){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(e),this._initProgressObject(e),e._progress.loaded=e.loaded=e.uploadedBytes||0,e._progress.total=e.total=this._getTotal(e.files)||1,e._progress.bitrate=e.bitrate=0,this._active+=1,this._progress.loaded+=e.loaded,this._progress.total+=e.total},_onDone:function(e,o,n,i){var r=i._progress.total,s=i._response;i._progress.loaded<r&&this._onProgress(t.Event("progress",{lengthComputable:!0,loaded:r,total:r}),i),s.result=i.result=e,s.textStatus=i.textStatus=o,s.jqXHR=i.jqXHR=n,this._trigger("done",null,i)},_onFail:function(t,e,o,n){var i=n._response;n.recalculateProgress&&(this._progress.loaded-=n._progress.loaded,this._progress.total-=n._progress.total),i.jqXHR=n.jqXHR=t,i.textStatus=n.textStatus=e,i.errorThrown=n.errorThrown=o,this._trigger("fail",null,n)},_onAlways:function(t,e,o,n){this._trigger("always",null,n)},_onSend:function(e,o){o.submit||this._addConvenienceMethods(e,o);var n,i,r,s,a=this,l=a._getAJAXSettings(o),c=function(){return a._sending+=1,l._bitrateTimer=new a._BitrateTimer,n=n||((i||!1===a._trigger("send",t.Event("send",{delegatedEvent:e}),l))&&a._getXHRPromise(!1,l.context,i)||a._chunkedUpload(l)||t.ajax(l)).done(function(t,e,o){a._onDone(t,e,o,l)}).fail(function(t,e,o){a._onFail(t,e,o,l)}).always(function(t,e,o){if(a._onAlways(t,e,o,l),a._sending-=1,a._active-=1,l.limitConcurrentUploads&&l.limitConcurrentUploads>a._sending)for(var n=a._slots.shift();n;){if("pending"===a._getDeferredState(n)){n.resolve();break}n=a._slots.shift()}0===a._active&&a._trigger("stop")})};return this._beforeSend(e,l),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(r=t.Deferred(),this._slots.push(r),s=r.pipe(c)):(this._sequence=this._sequence.pipe(c,c),s=this._sequence),s.abort=function(){return i=[void 0,"abort","abort"],n?n.abort():(r&&r.rejectWith(l.context,i),c())},this._enhancePromise(s)):c()},_onAdd:function(e,o){var n,i,r,s,a=this,l=!0,c=t.extend({},this.options,o),u=o.files,h=u.length,g=c.limitMultiFileUploads,p=c.limitMultiFileUploadSize,d=c.limitMultiFileUploadSizeOverhead,f=0,m=this._getParamName(c),y=0;if(!p||h&&void 0!==u[0].size||(p=void 0),(c.singleFileUploads||g||p)&&this._isXHRUpload(c))if(c.singleFileUploads||p||!g)if(!c.singleFileUploads&&p)for(r=[],n=[],s=0;s<h;s+=1)f+=u[s].size+d,(s+1===h||f+u[s+1].size+d>p||g&&s+1-y>=g)&&(r.push(u.slice(y,s+1)),i=m.slice(y,s+1),i.length||(i=m),n.push(i),y=s+1,f=0);else n=m;else for(r=[],n=[],s=0;s<h;s+=g)r.push(u.slice(s,s+g)),i=m.slice(s,s+g),i.length||(i=m),n.push(i);else r=[u],n=[m];return o.originalFiles=u,t.each(r||u,function(i,s){var c=t.extend({},o);return c.files=r?s:[s],c.paramName=n[i],a._initResponseObject(c),a._initProgressObject(c),a._addConvenienceMethods(e,c),l=a._trigger("add",t.Event("add",{delegatedEvent:e}),c)}),l},_replaceFileInput:function(e){var o=e.fileInput,n=o.clone(!0);e.fileInputClone=n,t("<form></form>").append(n)[0].reset(),o.after(n).detach(),t.cleanData(o.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(t,e){return e===o[0]?n[0]:e}),o[0]===this.element[0]&&(this.element=n)},_handleFileTreeEntry:function(e,o){var n,i=this,r=t.Deferred(),s=function(t){t&&!t.entry&&(t.entry=e),r.resolve([t])},a=function(t){i._handleFileTreeEntries(t,o+e.name+"/").done(function(t){r.resolve(t)}).fail(s)},l=function(){n.readEntries(function(t){t.length?(c=c.concat(t),l()):a(c)},s)},c=[];return o=o||"",e.isFile?e._file?(e._file.relativePath=o,r.resolve(e._file)):e.file(function(t){t.relativePath=o,r.resolve(t)},s):e.isDirectory?(n=e.createReader(),l()):r.resolve([]),r.promise()},_handleFileTreeEntries:function(e,o){var n=this;return t.when.apply(t,t.map(e,function(t){return n._handleFileTreeEntry(t,o)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(e){e=e||{};var o=e.items;return o&&o.length&&(o[0].webkitGetAsEntry||o[0].getAsEntry)?this._handleFileTreeEntries(t.map(o,function(t){var e;return t.webkitGetAsEntry?(e=t.webkitGetAsEntry(),e&&(e._file=t.getAsFile()),e):t.getAsEntry()})):t.Deferred().resolve(t.makeArray(e.files)).promise()},_getSingleFileInputFiles:function(e){e=t(e);var o,n,i=e.prop("webkitEntries")||e.prop("entries");if(i&&i.length)return this._handleFileTreeEntries(i);if(o=t.makeArray(e.prop("files")),o.length)void 0===o[0].name&&o[0].fileName&&t.each(o,function(t,e){e.name=e.fileName,e.size=e.fileSize});else{if(!(n=e.prop("value")))return t.Deferred().resolve([]).promise();o=[{name:n.replace(/^.*\\/,"")}]}return t.Deferred().resolve(o).promise()},_getFileInputFiles:function(e){return e instanceof t&&1!==e.length?t.when.apply(t,t.map(e,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(e)},_onChange:function(e){var o=this,n={fileInput:t(e.target),form:t(e.target.form)};this._getFileInputFiles(n.fileInput).always(function(i){n.files=i,o.options.replaceFileInput&&o._replaceFileInput(n),!1!==o._trigger("change",t.Event("change",{delegatedEvent:e}),n)&&o._onAdd(e,n)})},_onPaste:function(e){var o=e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.items,n={files:[]};o&&o.length&&(t.each(o,function(t,e){var o=e.getAsFile&&e.getAsFile();o&&n.files.push(o)}),!1!==this._trigger("paste",t.Event("paste",{delegatedEvent:e}),n)&&this._onAdd(e,n))},_onDrop:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var o=this,n=e.dataTransfer,i={};n&&n.files&&n.files.length&&(e.preventDefault(),this._getDroppedFiles(n).always(function(n){i.files=n,!1!==o._trigger("drop",t.Event("drop",{delegatedEvent:e}),i)&&o._onAdd(e,i)}))},_onDragOver:e("dragover"),_onDragEnter:e("dragenter"),_onDragLeave:e("dragleave"),_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave}),this._on(this.options.pasteZone,{paste:this._onPaste})),t.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(e,o){var n=-1!==t.inArray(e,this._specialOptions);n&&this._destroyEventHandlers(),this._super(e,o),n&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var e=this.options;void 0===e.fileInput?e.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):e.fileInput instanceof t||(e.fileInput=t(e.fileInput)),e.dropZone instanceof t||(e.dropZone=t(e.dropZone)),e.pasteZone instanceof t||(e.pasteZone=t(e.pasteZone))},_getRegExp:function(t){var e=t.split("/"),o=e.pop();return e.shift(),new RegExp(e.join("/"),o)},_isRegExpOption:function(e,o){return"url"!==e&&"string"===t.type(o)&&/^\/.*\/[igm]{0,3}$/.test(o)},_initDataAttributes:function(){var e=this,o=this.options,n=t(this.element[0].cloneNode(!1)),i=n.data();n.remove(),t.each(i,function(t,i){var r="data-"+t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();n.attr(r)&&(e._isRegExpOption(t,i)&&(i=e._getRegExp(i)),o[t]=i)})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(e){var o=this;e&&!this.options.disabled&&(e.fileInput&&!e.files?this._getFileInputFiles(e.fileInput).always(function(t){e.files=t,o._onAdd(null,e)}):(e.files=t.makeArray(e.files),this._onAdd(null,e)))},send:function(e){if(e&&!this.options.disabled){if(e.fileInput&&!e.files){var o,n,i=this,r=t.Deferred(),s=r.promise();return s.abort=function(){return n=!0,o?o.abort():(r.reject(null,"abort","abort"),s)},this._getFileInputFiles(e.fileInput).always(function(t){if(!n){if(!t.length)return void r.reject();e.files=t,o=i._onSend(null,e),o.then(function(t,e,o){r.resolve(t,e,o)},function(t,e,o){r.reject(t,e,o)})}}),this._enhancePromise(s)}if(e.files=t.makeArray(e.files),e.files.length)return this._onSend(null,e)}return this._getXHRPromise(!1,e&&e.context)}})})},function(t,e,o){var n,i,r;/*!
 * jQuery Form Plugin
 * version: 3.51.0-2014.06.20
 * Requires jQuery v1.5 or later
 * Copyright (c) 2014 M. Alsup
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Project repository: https://github.com/malsup/form
 * Dual licensed under the MIT and GPL licenses.
 * https://github.com/malsup/form#copyright-and-license
 */
!function(s){"use strict";i=[o(0)],n=s,void 0!==(r="function"==typeof n?n.apply(e,i):n)&&(t.exports=r)}(function(t){"use strict";function e(e){var o=e.data;e.isDefaultPrevented()||(e.preventDefault(),t(e.target).ajaxSubmit(o))}function o(e){var o=e.target,n=t(o);if(!n.is("[type=submit],[type=image]")){var i=n.closest("[type=submit]");if(0===i.length)return;o=i[0]}var r=this;if(r.clk=o,"image"==o.type)if(void 0!==e.offsetX)r.clk_x=e.offsetX,r.clk_y=e.offsetY;else if("function"==typeof t.fn.offset){var s=n.offset();r.clk_x=e.pageX-s.left,r.clk_y=e.pageY-s.top}else r.clk_x=e.pageX-o.offsetLeft,r.clk_y=e.pageY-o.offsetTop;setTimeout(function(){r.clk=r.clk_x=r.clk_y=null},100)}function n(){if(t.fn.ajaxSubmit.debug){var e="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(e):window.opera&&window.opera.postError&&window.opera.postError(e)}}var i={};i.fileapi=void 0!==t("<input type='file'/>").get(0).files,i.formdata=void 0!==window.FormData;var r=!!t.fn.prop;t.fn.attr2=function(){if(!r)return this.attr.apply(this,arguments);var t=this.prop.apply(this,arguments);return t&&t.jquery||"string"==typeof t?t:this.attr.apply(this,arguments)},t.fn.ajaxSubmit=function(e){function o(o){var n,i,r=t.param(o,e.traditional).split("&"),s=r.length,a=[];for(n=0;n<s;n++)r[n]=r[n].replace(/\+/g," "),i=r[n].split("="),a.push([decodeURIComponent(i[0]),decodeURIComponent(i[1])]);return a}function s(o){function i(t){var e=null;try{t.contentWindow&&(e=t.contentWindow.document)}catch(t){n("cannot get iframe.contentWindow document: "+t)}if(e)return e;try{e=t.contentDocument?t.contentDocument:t.document}catch(o){n("cannot get iframe.contentDocument: "+o),e=t.document}return e}function s(){function e(){try{var t=i(y).readyState;n("state = "+t),t&&"uninitialized"==t.toLowerCase()&&setTimeout(e,50)}catch(t){n("Server abort: ",t," (",t.name,")"),l(C),x&&clearTimeout(x),x=void 0}}var o=u.attr2("target"),r=u.attr2("action"),s=u.attr("enctype")||u.attr("encoding")||"multipart/form-data";S.setAttribute("target",f),a&&!/post/i.test(a)||S.setAttribute("method","POST"),r!=g.url&&S.setAttribute("action",g.url),g.skipEncodingOverride||a&&!/post/i.test(a)||u.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),g.timeout&&(x=setTimeout(function(){E=!0,l(w)},g.timeout));var c=[];try{if(g.extraData)for(var h in g.extraData)g.extraData.hasOwnProperty(h)&&(t.isPlainObject(g.extraData[h])&&g.extraData[h].hasOwnProperty("name")&&g.extraData[h].hasOwnProperty("value")?c.push(t('<input type="hidden" name="'+g.extraData[h].name+'">').val(g.extraData[h].value).appendTo(S)[0]):c.push(t('<input type="hidden" name="'+h+'">').val(g.extraData[h]).appendTo(S)[0]));g.iframeTarget||m.appendTo("body"),y.attachEvent?y.attachEvent("onload",l):y.addEventListener("load",l,!1),setTimeout(e,15);try{S.submit()}catch(t){var p=document.createElement("form").submit;p.apply(S)}}finally{S.setAttribute("action",r),S.setAttribute("enctype",s),o?S.setAttribute("target",o):u.removeAttr("target"),t(c).remove()}}function l(e){if(!v.aborted&&!M){if(B=i(y),B||(n("cannot access response document"),e=C),e===w&&v)return v.abort("timeout"),void T.reject(v,"timeout");if(e==C&&v)return v.abort("server abort"),void T.reject(v,"error","server abort");if(B&&B.location.href!=g.iframeSrc||E){y.detachEvent?y.detachEvent("onload",l):y.removeEventListener("load",l,!1);var o,r="success";try{if(E)throw"timeout";var s="xml"==g.dataType||B.XMLDocument||t.isXMLDoc(B);if(n("isXml="+s),!s&&window.opera&&(null===B.body||!B.body.innerHTML)&&--L)return n("requeing onLoad callback, DOM not available"),void setTimeout(l,250);var a=B.body?B.body:B.documentElement;v.responseText=a?a.innerHTML:null,v.responseXML=B.XMLDocument?B.XMLDocument:B,s&&(g.dataType="xml"),v.getResponseHeader=function(t){return{"content-type":g.dataType}[t.toLowerCase()]},a&&(v.status=Number(a.getAttribute("status"))||v.status,v.statusText=a.getAttribute("statusText")||v.statusText);var c=(g.dataType||"").toLowerCase(),u=/(json|script|text)/.test(c);if(u||g.textarea){var h=B.getElementsByTagName("textarea")[0];if(h)v.responseText=h.value,v.status=Number(h.getAttribute("status"))||v.status,v.statusText=h.getAttribute("statusText")||v.statusText;else if(u){var d=B.getElementsByTagName("pre")[0],f=B.getElementsByTagName("body")[0];d?v.responseText=d.textContent?d.textContent:d.innerText:f&&(v.responseText=f.textContent?f.textContent:f.innerText)}}else"xml"==c&&!v.responseXML&&v.responseText&&(v.responseXML=N(v.responseText));try{I=D(v,c,g)}catch(t){r="parsererror",v.error=o=t||r}}catch(t){n("error caught: ",t),r="error",v.error=o=t||r}v.aborted&&(n("upload aborted"),r=null),v.status&&(r=v.status>=200&&v.status<300||304===v.status?"success":"error"),"success"===r?(g.success&&g.success.call(g.context,I,"success",v),T.resolve(v.responseText,"success",v),p&&t.event.trigger("ajaxSuccess",[v,g])):r&&(void 0===o&&(o=v.statusText),g.error&&g.error.call(g.context,v,r,o),T.reject(v,"error",o),p&&t.event.trigger("ajaxError",[v,g,o])),p&&t.event.trigger("ajaxComplete",[v,g]),p&&!--t.active&&t.event.trigger("ajaxStop"),g.complete&&g.complete.call(g.context,v,r),M=!0,g.timeout&&clearTimeout(x),setTimeout(function(){g.iframeTarget?m.attr("src",g.iframeSrc):m.remove(),v.responseXML=null},100)}}}var c,h,g,p,f,m,y,v,_,b,E,x,S=u[0],T=t.Deferred();if(T.abort=function(t){v.abort(t)},o)for(h=0;h<d.length;h++)c=t(d[h]),r?c.prop("disabled",!1):c.removeAttr("disabled");if(g=t.extend(!0,{},t.ajaxSettings,e),g.context=g.context||g,f="jqFormIO"+(new Date).getTime(),g.iframeTarget?(m=t(g.iframeTarget),b=m.attr2("name"),b?f=b:m.attr2("name",f)):(m=t('<iframe name="'+f+'" src="'+g.iframeSrc+'" />'),m.css({position:"absolute",top:"-1000px",left:"-1000px"})),y=m[0],v={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(e){var o="timeout"===e?"timeout":"aborted";n("aborting upload... "+o),this.aborted=1;try{y.contentWindow.document.execCommand&&y.contentWindow.document.execCommand("Stop")}catch(t){}m.attr("src",g.iframeSrc),v.error=o,g.error&&g.error.call(g.context,v,o,e),p&&t.event.trigger("ajaxError",[v,g,o]),g.complete&&g.complete.call(g.context,v,o)}},p=g.global,p&&0==t.active++&&t.event.trigger("ajaxStart"),p&&t.event.trigger("ajaxSend",[v,g]),g.beforeSend&&!1===g.beforeSend.call(g.context,v,g))return g.global&&t.active--,T.reject(),T;if(v.aborted)return T.reject(),T;(_=S.clk)&&(b=_.name)&&!_.disabled&&(g.extraData=g.extraData||{},g.extraData[b]=_.value,"image"==_.type&&(g.extraData[b+".x"]=S.clk_x,g.extraData[b+".y"]=S.clk_y));var w=1,C=2,k=t('meta[name="csrf-token"]').attr("content");k||document.cookie.split("; ").map(function(t){var e=t.split("=");"csrf-token"===e[0]&&(k=e[1])});var A=t("meta[name=csrf-param]").attr("content");A&&k&&(g.extraData=g.extraData||{},g.extraData[A]=k),g.forceSync?s():setTimeout(s,10);var I,B,M,L=50,N=t.parseXML||function(t,e){return window.ActiveXObject?(e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(t)):e=(new DOMParser).parseFromString(t,"text/xml"),e&&e.documentElement&&"parsererror"!=e.documentElement.nodeName?e:null},R=t.parseJSON||function(t){return window.eval("("+t+")")},D=function(e,o,n){var i=e.getResponseHeader("content-type")||"",r="xml"===o||!o&&i.indexOf("xml")>=0,s=r?e.responseXML:e.responseText;return r&&"parsererror"===s.documentElement.nodeName&&t.error&&t.error("parsererror"),n&&n.dataFilter&&(s=n.dataFilter(s,o)),"string"==typeof s&&("json"===o||!o&&i.indexOf("json")>=0?s=R(s):("script"===o||!o&&i.indexOf("javascript")>=0)&&t.globalEval(s)),s};return T}if(!this.length)return n("ajaxSubmit: skipping submit process - no element selected"),this;var a,l,c,u=this;"function"==typeof e?e={success:e}:void 0===e&&(e={}),a=e.type||this.attr2("method"),l=e.url||this.attr2("action"),c="string"==typeof l?t.trim(l):"",c=c||window.location.href||"",c&&(c=(c.match(/^([^#]+)/)||[])[1]),e=t.extend(!0,{url:c,success:t.ajaxSettings.success,type:a||t.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},e);var h={};if(this.trigger("form-pre-serialize",[this,e,h]),h.veto)return n("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(e.beforeSerialize&&!1===e.beforeSerialize(this,e))return n("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var g=e.traditional;void 0===g&&(g=t.ajaxSettings.traditional);var p,d=[],f=this.formToArray(e.semantic,d);if(e.data&&(e.extraData=e.data,p=t.param(e.data,g)),e.beforeSubmit&&!1===e.beforeSubmit(f,this,e))return n("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[f,this,e,h]),h.veto)return n("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var m=t.param(f,g);p&&(m=m?m+"&"+p:p),"GET"==e.type.toUpperCase()?(e.url+=(e.url.indexOf("?")>=0?"&":"?")+m,e.data=null):e.data=m;var y=[];if(e.resetForm&&y.push(function(){u.resetForm()}),e.clearForm&&y.push(function(){u.clearForm(e.includeHidden)}),!e.dataType&&e.target){var v=e.success||function(){};y.push(function(o){var n=e.replaceTarget?"replaceWith":"html";t(e.target)[n](o).each(v,arguments)})}else e.success&&y.push(e.success);if(e.success=function(t,o,n){for(var i=e.context||this,r=0,s=y.length;r<s;r++)y[r].apply(i,[t,o,n||u,u])},e.error){var _=e.error;e.error=function(t,o,n){var i=e.context||this;_.apply(i,[t,o,n,u])}}if(e.complete){var b=e.complete;e.complete=function(t,o){var n=e.context||this;b.apply(n,[t,o,u])}}var E=t("input[type=file]:enabled",this).filter(function(){return""!==t(this).val()}),x=E.length>0,S="multipart/form-data",T=u.attr("enctype")==S||u.attr("encoding")==S,w=i.fileapi&&i.formdata;n("fileAPI :"+w);var C,k=(x||T)&&!w;!1!==e.iframe&&(e.iframe||k)?e.closeKeepAlive?t.get(e.closeKeepAlive,function(){C=s(f)}):C=s(f):C=(x||T)&&w?function(n){for(var i=new FormData,r=0;r<n.length;r++)i.append(n[r].name,n[r].value);if(e.extraData){var s=o(e.extraData);for(r=0;r<s.length;r++)s[r]&&i.append(s[r][0],s[r][1])}e.data=null;var l=t.extend(!0,{},t.ajaxSettings,e,{contentType:!1,processData:!1,cache:!1,type:a||"POST"});e.uploadProgress&&(l.xhr=function(){var o=t.ajaxSettings.xhr();return o.upload&&o.upload.addEventListener("progress",function(t){var o=0,n=t.loaded||t.position,i=t.total;t.lengthComputable&&(o=Math.ceil(n/i*100)),e.uploadProgress(t,n,i,o)},!1),o}),l.data=null;var c=l.beforeSend;return l.beforeSend=function(t,o){e.formData?o.data=e.formData:o.data=i,c&&c.call(this,t,o)},t.ajax(l)}(f):t.ajax(e),u.removeData("jqxhr").data("jqxhr",C);for(var A=0;A<d.length;A++)d[A]=null;return this.trigger("form-submit-notify",[this,e]),this},t.fn.ajaxForm=function(i){if(i=i||{},i.delegation=i.delegation&&t.isFunction(t.fn.on),!i.delegation&&0===this.length){var r={s:this.selector,c:this.context};return!t.isReady&&r.s?(n("DOM not ready, queuing ajaxForm"),t(function(){t(r.s,r.c).ajaxForm(i)}),this):(n("terminating; zero elements found by selector"+(t.isReady?"":" (DOM not ready)")),this)}return i.delegation?(t(document).off("submit.form-plugin",this.selector,e).off("click.form-plugin",this.selector,o).on("submit.form-plugin",this.selector,i,e).on("click.form-plugin",this.selector,i,o),this):this.ajaxFormUnbind().bind("submit.form-plugin",i,e).bind("click.form-plugin",i,o)},t.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},t.fn.formToArray=function(e,o){var n=[];if(0===this.length)return n;var r,s=this[0],a=this.attr("id"),l=e?s.getElementsByTagName("*"):s.elements;if(l&&!/MSIE [678]/.test(navigator.userAgent)&&(l=t(l).get()),a&&(r=t(':input[form="'+a+'"]').get(),r.length&&(l=(l||[]).concat(r))),!l||!l.length)return n;var c,u,h,g,p,d,f;for(c=0,d=l.length;c<d;c++)if(p=l[c],(h=p.name)&&!p.disabled)if(e&&s.clk&&"image"==p.type)s.clk==p&&(n.push({name:h,value:t(p).val(),type:p.type}),n.push({name:h+".x",value:s.clk_x},{name:h+".y",value:s.clk_y}));else if((g=t.fieldValue(p,!0))&&g.constructor==Array)for(o&&o.push(p),u=0,f=g.length;u<f;u++)n.push({name:h,value:g[u]});else if(i.fileapi&&"file"==p.type){o&&o.push(p);var m=p.files;if(m.length)for(u=0;u<m.length;u++)n.push({name:h,value:m[u],type:p.type});else n.push({name:h,value:"",type:p.type})}else null!==g&&void 0!==g&&(o&&o.push(p),n.push({name:h,value:g,type:p.type,required:p.required}));if(!e&&s.clk){var y=t(s.clk),v=y[0];h=v.name,h&&!v.disabled&&"image"==v.type&&(n.push({name:h,value:y.val()}),n.push({name:h+".x",value:s.clk_x},{name:h+".y",value:s.clk_y}))}return n},t.fn.formSerialize=function(e){return t.param(this.formToArray(e))},t.fn.fieldSerialize=function(e){var o=[];return this.each(function(){var n=this.name;if(n){var i=t.fieldValue(this,e);if(i&&i.constructor==Array)for(var r=0,s=i.length;r<s;r++)o.push({name:n,value:i[r]});else null!==i&&void 0!==i&&o.push({name:this.name,value:i})}}),t.param(o)},t.fn.fieldValue=function(e){for(var o=[],n=0,i=this.length;n<i;n++){var r=this[n],s=t.fieldValue(r,e);null===s||void 0===s||s.constructor==Array&&!s.length||(s.constructor==Array?t.merge(o,s):o.push(s))}return o},t.fieldValue=function(e,o){var n=e.name,i=e.type,r=e.tagName.toLowerCase();if(void 0===o&&(o=!0),o&&(!n||e.disabled||"reset"==i||"button"==i||("checkbox"==i||"radio"==i)&&!e.checked||("submit"==i||"image"==i)&&e.form&&e.form.clk!=e||"select"==r&&-1==e.selectedIndex))return null;if("select"==r){var s=e.selectedIndex;if(s<0)return null;for(var a=[],l=e.options,c="select-one"==i,u=c?s+1:l.length,h=c?s:0;h<u;h++){var g=l[h];if(g.selected){var p=g.value;if(p||(p=g.attributes&&g.attributes.value&&!g.attributes.value.specified?g.text:g.value),c)return p;a.push(p)}}return a}return t(e).val()},t.fn.clearForm=function(e){return this.each(function(){t("input,select,textarea",this).clearFields(e)})},t.fn.clearFields=t.fn.clearInputs=function(e){var o=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var n=this.type,i=this.tagName.toLowerCase();o.test(n)||"textarea"==i?this.value="":"checkbox"==n||"radio"==n?this.checked=!1:"select"==i?this.selectedIndex=-1:"file"==n?/MSIE/.test(navigator.userAgent)?t(this).replaceWith(t(this).clone(!0)):t(this).val(""):e&&(!0===e&&/hidden/.test(n)||"string"==typeof e&&t(this).is(e))&&(this.value="")})},t.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},t.fn.enable=function(t){return void 0===t&&(t=!0),this.each(function(){this.disabled=!t})},t.fn.selected=function(e){return void 0===e&&(e=!0),this.each(function(){var o=this.type;if("checkbox"==o||"radio"==o)this.checked=e;else if("option"==this.tagName.toLowerCase()){var n=t(this).parent("select");e&&n[0]&&"select-one"==n[0].type&&n.find("option").selected(!1),this.selected=e}})},t.fn.ajaxSubmit.debug=!1})},function(t,e,o){var n,i,r;!function(s){"use strict";i=[o(0)],n=s,void 0!==(r="function"==typeof n?n.apply(e,i):n)&&(t.exports=r)}(function(t){"use strict";var e=0;t.ajaxTransport("iframe",function(o){if(o.async){var n,i,r,s=o.initialIframeSrc||"javascript:false;";return{send:function(a,l){n=t('<form style="display:none;"></form>'),n.attr("accept-charset",o.formAcceptCharset),r=/\?/.test(o.url)?"&":"?","DELETE"===o.type?(o.url=o.url+r+"_method=DELETE",o.type="POST"):"PUT"===o.type?(o.url=o.url+r+"_method=PUT",o.type="POST"):"PATCH"===o.type&&(o.url=o.url+r+"_method=PATCH",o.type="POST"),e+=1,i=t('<iframe src="'+s+'" name="iframe-transport-'+e+'"></iframe>').bind("load",function(){var e,r=t.isArray(o.paramName)?o.paramName:[o.paramName];i.unbind("load").bind("load",function(){var e;try{if(e=i.contents(),!e.length||!e[0].firstChild)throw new Error}catch(t){e=void 0}l(200,"success",{iframe:e}),t('<iframe src="'+s+'"></iframe>').appendTo(n),window.setTimeout(function(){n.remove()},0)}),n.prop("target",i.prop("name")).prop("action",o.url).prop("method",o.type),o.formData&&t.each(o.formData,function(e,o){t('<input type="hidden"/>').prop("name",o.name).val(o.value).appendTo(n)}),o.fileInput&&o.fileInput.length&&"POST"===o.type&&(e=o.fileInput.clone(),o.fileInput.after(function(t){return e[t]}),o.paramName&&o.fileInput.each(function(e){t(this).prop("name",r[e]||o.paramName)}),n.append(o.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data"),o.fileInput.removeAttr("form")),n.submit(),e&&e.length&&o.fileInput.each(function(o,n){var i=t(e[o]);t(n).prop("name",i.prop("name")).attr("form",i.attr("form")),i.replaceWith(n)})}),n.append(i).appendTo(document.body)},abort:function(){i&&i.unbind("load").prop("src",s),n&&n.remove()}}}}),t.ajaxSetup({converters:{"iframe text":function(e){return e&&t(e[0].body).text()},"iframe json":function(e){return e&&t.parseJSON(t(e[0].body).text())},"iframe html":function(e){return e&&t(e[0].body).html()},"iframe xml":function(e){var o=e&&e[0];return o&&t.isXMLDoc(o)?o:t.parseXML(o.XMLDocument&&o.XMLDocument.xml||t(o.body).html())},"iframe script":function(e){return e&&t.globalEval(t(e[0].body).text())}}})})},function(t,e,o){var n,i,r;/*! Copyright (c) 2013 Brandon Aaron (http://brandon.aaron.sh)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Version: 3.1.12
 *
 * Requires: jQuery 1.2.2+
 */
!function(s){i=[o(0)],n=s,void 0!==(r="function"==typeof n?n.apply(e,i):n)&&(t.exports=r)}(function(t){function e(e){var s=e||window.event,a=l.call(arguments,1),c=0,h=0,g=0,p=0,d=0,f=0;if(e=t.event.fix(s),e.type="mousewheel","detail"in s&&(g=-1*s.detail),"wheelDelta"in s&&(g=s.wheelDelta),"wheelDeltaY"in s&&(g=s.wheelDeltaY),"wheelDeltaX"in s&&(h=-1*s.wheelDeltaX),"axis"in s&&s.axis===s.HORIZONTAL_AXIS&&(h=-1*g,g=0),c=0===g?h:g,"deltaY"in s&&(g=-1*s.deltaY,c=g),"deltaX"in s&&(h=s.deltaX,0===g&&(c=-1*h)),0!==g||0!==h){if(1===s.deltaMode){var m=t.data(this,"mousewheel-line-height");c*=m,g*=m,h*=m}else if(2===s.deltaMode){var y=t.data(this,"mousewheel-page-height");c*=y,g*=y,h*=y}if(p=Math.max(Math.abs(g),Math.abs(h)),(!r||r>p)&&(r=p,n(s,p)&&(r/=40)),n(s,p)&&(c/=40,h/=40,g/=40),c=Math[c>=1?"floor":"ceil"](c/r),h=Math[h>=1?"floor":"ceil"](h/r),g=Math[g>=1?"floor":"ceil"](g/r),u.settings.normalizeOffset&&this.getBoundingClientRect){var v=this.getBoundingClientRect();d=e.clientX-v.left,f=e.clientY-v.top}return e.deltaX=h,e.deltaY=g,e.deltaFactor=r,e.offsetX=d,e.offsetY=f,e.deltaMode=0,a.unshift(e,c,h,g),i&&clearTimeout(i),i=setTimeout(o,200),(t.event.dispatch||t.event.handle).apply(this,a)}}function o(){r=null}function n(t,e){return u.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}var i,r,s=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],a="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(t.event.fixHooks)for(var c=s.length;c;)t.event.fixHooks[s[--c]]=t.event.mouseHooks;var u=t.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var o=a.length;o;)this.addEventListener(a[--o],e,!1);else this.onmousewheel=e;t.data(this,"mousewheel-line-height",u.getLineHeight(this)),t.data(this,"mousewheel-page-height",u.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var o=a.length;o;)this.removeEventListener(a[--o],e,!1);else this.onmousewheel=null;t.removeData(this,"mousewheel-line-height"),t.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var o=t(e),n=o["offsetParent"in t.fn?"offsetParent":"parent"]();return n.length||(n=t("body")),parseInt(n.css("fontSize"),10)||parseInt(o.css("fontSize"),10)||16},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})})},function(t,e,o){var n,i;!function(r,s){n=[o(0)],void 0!==(i=function(t){return s(r,t)}.apply(e,n))&&(t.exports=i)}("undefined"!=typeof window?window:this,function(t,e){"use strict";function o(t,e){for(var o=t.length;--o;)if(Math.round(+t[o])!==Math.round(+e[o]))return!1;return!0}function n(t){var o={range:!0,animate:!0};return"boolean"==typeof t?o.animate=t:e.extend(o,t),o}function i(t,o,n,i,r,s,a,l,c){"array"===e.type(t)?this.elements=[+t[0],+t[2],+t[4],+t[1],+t[3],+t[5],0,0,1]:this.elements=[t,o,n,i,r,s,a||0,l||0,c||1]}function r(t,e,o){this.elements=[t,e,o]}function s(t,o){if(!(this instanceof s))return new s(t,o);1!==t.nodeType&&e.error("Panzoom called on non-Element node"),e.contains(a,t)||e.error("Panzoom element must be attached to the document");var n=e.data(t,l);if(n)return n;this.options=o=e.extend({},s.defaults,o),this.elem=t;var i=this.$elem=e(t);this.$set=o.$set&&o.$set.length?o.$set:i,this.$doc=e(t.ownerDocument||a),this.$parent=i.parent(),this.isSVG=p.test(t.namespaceURI)&&"svg"!==t.nodeName.toLowerCase(),this.panning=!1,this._buildTransform(),this._transform=e.cssProps.transform.replace(g,"-$1").toLowerCase(),this._buildTransition(),this.resetDimensions();var r=e(),c=this;e.each(["$zoomIn","$zoomOut","$zoomRange","$reset"],function(t,e){c[e]=o[e]||r}),this.enable(),this.scale=this.getMatrix()[0],this._checkPanWhenZoomed(),e.data(t,l,this)}var a=t.document,l="__pz__",c=Array.prototype.slice,u=/trident\/7./i,h=function(){if(u.test(navigator.userAgent))return!1;var t=a.createElement("input");return t.setAttribute("oninput","return"),"function"==typeof t.oninput}(),g=/([A-Z])/g,p=/^http:[\w\.\/]+svg$/,d="(\\-?\\d[\\d\\.e-]*)",f="\\,?\\s*",m=new RegExp("^matrix\\("+d+f+d+f+d+f+d+f+d+f+d+"\\)$");return i.prototype={x:function(t){var e=t instanceof r,o=this.elements,n=t.elements;return e&&3===n.length?new r(o[0]*n[0]+o[1]*n[1]+o[2]*n[2],o[3]*n[0]+o[4]*n[1]+o[5]*n[2],o[6]*n[0]+o[7]*n[1]+o[8]*n[2]):n.length===o.length&&new i(o[0]*n[0]+o[1]*n[3]+o[2]*n[6],o[0]*n[1]+o[1]*n[4]+o[2]*n[7],o[0]*n[2]+o[1]*n[5]+o[2]*n[8],o[3]*n[0]+o[4]*n[3]+o[5]*n[6],o[3]*n[1]+o[4]*n[4]+o[5]*n[7],o[3]*n[2]+o[4]*n[5]+o[5]*n[8],o[6]*n[0]+o[7]*n[3]+o[8]*n[6],o[6]*n[1]+o[7]*n[4]+o[8]*n[7],o[6]*n[2]+o[7]*n[5]+o[8]*n[8])},inverse:function(){var t=1/this.determinant(),e=this.elements;return new i(t*(e[8]*e[4]-e[7]*e[5]),t*-(e[8]*e[1]-e[7]*e[2]),t*(e[5]*e[1]-e[4]*e[2]),t*-(e[8]*e[3]-e[6]*e[5]),t*(e[8]*e[0]-e[6]*e[2]),t*-(e[5]*e[0]-e[3]*e[2]),t*(e[7]*e[3]-e[6]*e[4]),t*-(e[7]*e[0]-e[6]*e[1]),t*(e[4]*e[0]-e[3]*e[1]))},determinant:function(){var t=this.elements;return t[0]*(t[8]*t[4]-t[7]*t[5])-t[3]*(t[8]*t[1]-t[7]*t[2])+t[6]*(t[5]*t[1]-t[4]*t[2])}},r.prototype.e=i.prototype.e=function(t){return this.elements[t]},s.rmatrix=m,s.defaults={eventNamespace:".panzoom",transition:!0,cursor:"move",disablePan:!1,disableZoom:!1,disableXAxis:!1,disableYAxis:!1,which:1,increment:.3,exponential:!0,panOnlyWhenZoomed:!1,minScale:.3,maxScale:6,rangeStep:.05,duration:200,easing:"ease-in-out",contain:!1},s.prototype={constructor:s,instance:function(){return this},enable:function(){this._initStyle(),this._bind(),this.disabled=!1},disable:function(){this.disabled=!0,this._resetStyle(),this._unbind()},isDisabled:function(){return this.disabled},destroy:function(){this.disable(),e.removeData(this.elem,l)},resetDimensions:function(){this.container=this.$parent[0].getBoundingClientRect();var t=this.elem,o=t.getBoundingClientRect(),n=Math.abs(this.scale);this.dimensions={width:o.width,height:o.height,left:e.css(t,"left",!0)||0,top:e.css(t,"top",!0)||0,border:{top:e.css(t,"borderTopWidth",!0)*n||0,bottom:e.css(t,"borderBottomWidth",!0)*n||0,left:e.css(t,"borderLeftWidth",!0)*n||0,right:e.css(t,"borderRightWidth",!0)*n||0},margin:{top:e.css(t,"marginTop",!0)*n||0,left:e.css(t,"marginLeft",!0)*n||0}}},reset:function(t){t=n(t);var e=this.setMatrix(this._origTransform,t);t.silent||this._trigger("reset",e)},resetZoom:function(t){t=n(t);var e=this.getMatrix(this._origTransform);t.dValue=e[3],this.zoom(e[0],t)},resetPan:function(t){var e=this.getMatrix(this._origTransform);this.pan(e[4],e[5],n(t))},setTransform:function(t){for(var o=this.$set,n=o.length;n--;)e.style(o[n],"transform",t),this.isSVG&&o[n].setAttribute("transform",t)},getTransform:function(t){var o=this.$set,n=o[0];return t?this.setTransform(t):(t=e.style(n,"transform"),!this.isSVG||t&&"none"!==t||(t=e.attr(n,"transform")||"none")),"none"===t||m.test(t)||this.setTransform(t=e.css(n,"transform")),t||"none"},getMatrix:function(t){var e=m.exec(t||this.getTransform());return e&&e.shift(),e||[1,0,0,1,0,0]},setMatrix:function(t,e){if(!this.disabled){e||(e={}),"string"==typeof t&&(t=this.getMatrix(t));var o=+t[0],n=void 0!==e.contain?e.contain:this.options.contain;if(n){var i=e.dims;i||(this.resetDimensions(),i=this.dimensions);var r=this.container,s=i.width,a=i.height,l=r.width,c=r.height,u=l/s,h=c/a,g=(s-l)/2,p=(a-c)/2;t[4]="invert"===n||"automatic"===n&&u<1.01?Math.max(Math.min(t[4],g),-g):Math.min(Math.max(t[4],g),-g),t[5]="invert"===n||"automatic"===n&&h<1.01?Math.max(Math.min(t[5],p),-p):Math.min(Math.max(t[5],p),-p)}if("skip"!==e.animate&&this.transition(!e.animate),e.range&&this.$zoomRange.val(o),this.options.disableXAxis||this.options.disableYAxis){var d=this.getMatrix();this.options.disableXAxis&&(t[4]=d[4]),this.options.disableYAxis&&(t[5]=d[5])}return this.setTransform("matrix("+t.join(",")+")"),this.scale=o,this._checkPanWhenZoomed(o),e.silent||this._trigger("change",t),t}},isPanning:function(){return this.panning},transition:function(t){if(this._transition)for(var o=t||!this.options.transition?"none":this._transition,n=this.$set,i=n.length;i--;)e.style(n[i],"transition")!==o&&e.style(n[i],"transition",o)},pan:function(t,e,o){if(!this.options.disablePan){o||(o={});var n=o.matrix;n||(n=this.getMatrix()),o.relative&&(t+=+n[4],e+=+n[5]),n[4]=t,n[5]=e,this.setMatrix(n,o),o.silent||this._trigger("pan",n[4],n[5])}},zoom:function(t,o){"object"==typeof t?(o=t,t=null):o||(o={});var n=e.extend({},this.options,o);if(!n.disableZoom){var s=!1,a=n.matrix||this.getMatrix(),l=+a[0];"number"!=typeof t&&(t=n.exponential&&l-n.increment>=1?Math[t?"sqrt":"pow"](l,2):l+n.increment*(t?-1:1),s=!0),t>n.maxScale?t=n.maxScale:t<n.minScale&&(t=n.minScale);var c=n.focal;if(c&&!n.disablePan){this.resetDimensions();var u=n.dims=this.dimensions,h=c.clientX,g=c.clientY;this.isSVG||(h-=u.width/l/2,g-=u.height/l/2);var p=new r(h,g,1),d=new i(a),f=this.parentOffset||this.$parent.offset(),m=new i(1,0,f.left-this.$doc.scrollLeft(),0,1,f.top-this.$doc.scrollTop()),y=d.inverse().x(m.inverse().x(p)),v=t/a[0];d=d.x(new i([v,0,0,v,0,0])),p=m.x(d.x(y)),a[4]=+a[4]+(h-p.e(0)),a[5]=+a[5]+(g-p.e(1))}a[0]=t,a[3]="number"==typeof n.dValue?n.dValue:t,this.setMatrix(a,{animate:"boolean"==typeof n.animate?n.animate:s,range:!n.noSetRange}),n.silent||this._trigger("zoom",a[0],n)}},option:function(t,o){var n;if(!t)return e.extend({},this.options);if("string"==typeof t){if(1===arguments.length)return void 0!==this.options[t]?this.options[t]:null;n={},n[t]=o}else n=t;this._setOptions(n)},_setOptions:function(t){e.each(t,e.proxy(function(t,o){switch(t){case"disablePan":this._resetStyle();case"$zoomIn":case"$zoomOut":case"$zoomRange":case"$reset":case"disableZoom":case"onStart":case"onChange":case"onZoom":case"onPan":case"onEnd":case"onReset":case"eventNamespace":this._unbind()}switch(this.options[t]=o,t){case"disablePan":this._initStyle();case"$zoomIn":case"$zoomOut":case"$zoomRange":case"$reset":this[t]=o;case"disableZoom":case"onStart":case"onChange":case"onZoom":case"onPan":case"onEnd":case"onReset":case"eventNamespace":this._bind();break;case"cursor":e.style(this.elem,"cursor",o);break;case"minScale":this.$zoomRange.attr("min",o);break;case"maxScale":this.$zoomRange.attr("max",o);break;case"rangeStep":this.$zoomRange.attr("step",o);break;case"startTransform":this._buildTransform();break;case"duration":case"easing":this._buildTransition();case"transition":this.transition();break;case"panOnlyWhenZoomed":this._checkPanWhenZoomed();break;case"$set":o instanceof e&&o.length&&(this.$set=o,this._initStyle(),this._buildTransform())}},this))},_checkPanWhenZoomed:function(t){t||(t=this.getMatrix()[0]);var e=this.options;if(e.panOnlyWhenZoomed){var o=t===e.minScale;e.disablePan!==o&&this.option("disablePan",o)}},_initStyle:function(){var t={"transform-origin":this.isSVG?"0 0":"50% 50%"};this.options.disablePan||(t.cursor=this.options.cursor),this.$set.css(t);var o=this.$parent;o.length&&!e.nodeName(o[0],"body")&&(t={overflow:"hidden"},"static"===o.css("position")&&(t.position="relative"),o.css(t))},_resetStyle:function(){this.$elem.css({cursor:"",transition:""}),this.$parent.css({overflow:"",position:""})},_bind:function(){var t=this,o=this.options,n=o.eventNamespace,i="touchstart"+n+" mousedown"+n,r="touchend"+n+" click"+n,a={},l=this.$reset,c=this.$zoomRange;if(e.each(["Start","Change","Zoom","Pan","End","Reset"],function(){var t=o["on"+this];e.isFunction(t)&&(a["panzoom"+this.toLowerCase()+n]=t)}),o.disablePan&&o.disableZoom||(a[i]=function(e){var n;("touchstart"===e.type?!(n=e.touches||e.originalEvent.touches)||(1!==n.length||o.disablePan)&&2!==n.length:o.disablePan||e.which!==o.which)||(e.preventDefault(),e.stopPropagation(),t._startMove(e,n))},3===o.which&&(a.contextmenu=!1)),this.$elem.on(a),l.length&&l.on(r,function(e){e.preventDefault(),t.reset()}),c.length&&c.attr({step:o.rangeStep===s.defaults.rangeStep&&c.attr("step")||o.rangeStep,min:o.minScale,max:o.maxScale}).prop({value:this.getMatrix()[0]}),!o.disableZoom){var u=this.$zoomIn,g=this.$zoomOut;u.length&&g.length&&(u.on(r,function(e){e.preventDefault(),t.zoom()}),g.on(r,function(e){e.preventDefault(),t.zoom(!0)})),c.length&&(a={},a["mousedown"+n]=function(){t.transition(!0)},a[(h?"input":"change")+n]=function(){t.zoom(+this.value,{noSetRange:!0})},c.on(a))}},_unbind:function(){this.$elem.add(this.$zoomIn).add(this.$zoomOut).add(this.$reset).off(this.options.eventNamespace)},_buildTransform:function(){return this._origTransform=this.getTransform(this.options.startTransform)},_buildTransition:function(){if(this._transform){var t=this.options;this._transition=this._transform+" "+t.duration+"ms "+t.easing}},_getDistance:function(t){var e=t[0],o=t[1];return Math.sqrt(Math.pow(Math.abs(o.clientX-e.clientX),2)+Math.pow(Math.abs(o.clientY-e.clientY),2))},_getMiddle:function(t){var e=t[0],o=t[1];return{clientX:(o.clientX-e.clientX)/2+e.clientX,clientY:(o.clientY-e.clientY)/2+e.clientY}},_trigger:function(t){"string"==typeof t&&(t="panzoom"+t),this.$elem.triggerHandler(t,[this].concat(c.call(arguments,1)))},_startMove:function(t,n){var i,r,s,l,c,u,h,g,p,d=this,f=this.options,m=f.eventNamespace,y=this.getMatrix(),v=y.slice(0),_=+v[4],b=+v[5],E={matrix:y,animate:"skip"};"touchstart"===t.type?(r="touchmove",s="touchend"):(r="mousemove",s="mouseup"),r+=m,s+=m,this.transition(!0),this.panning=!0,this._trigger("start",t,n),n&&2===n.length?(l=this._getDistance(n),c=+y[0],u=this._getMiddle(n),i=function(t){t.preventDefault(),n=t.touches||t.originalEvent.touches;var e=d._getMiddle(n),o=d._getDistance(n)-l;d.zoom(o*(f.increment/100)+c,{focal:e,matrix:y,animate:!1}),d.pan(+y[4]+e.clientX-u.clientX,+y[5]+e.clientY-u.clientY,E),u=e}):(n&&(p=n[0])?(h=p.pageX,g=p.pageY):(h=t.pageX,g=t.pageY),i=function(t){t.preventDefault(),n=t.touches||t.originalEvent.touches;var e;e=n?n[0]||{pageX:0,pageY:0}:t,d.pan(_+e.pageX-h,b+e.pageY-g,E)}),e(a).off(m).on(r,i).on(s,function(t){t.preventDefault(),e(this).off(m),d.panning=!1,t.type="panzoomend",d._trigger(t,y,!o(y,v))})}},e.Panzoom=s,e.fn.panzoom=function(t){var o,n,i,r;return"string"==typeof t?(r=[],n=c.call(arguments,1),this.each(function(){o=e.data(this,l),o?"_"!==t.charAt(0)&&"function"==typeof(i=o[t])&&void 0!==(i=i.apply(o,n))&&r.push(i):r.push(void 0)}),r.length?1===r.length?r[0]:r:this):this.each(function(){new s(this,t)})},s})},function(t,e,o){(function(t){/*!
 * Copyright 2012, Chris Wanstrath
 * Released under the MIT License
 * https://github.com/defunkt/jquery-pjax
 */
!function(t){function e(e,n,i){var r=this;return this.on("click.pjax",e,function(e){var s=t.extend({},p(n,i));s.container||(s.container=t(this).attr("data-pjax")||r),o(e,s)})}function o(e,o,n){n=p(o,n);var r=e.currentTarget;if("A"!==r.tagName.toUpperCase())throw"$.fn.pjax or $.pjax.click requires an anchor element";if(!(e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||location.protocol!==r.protocol||location.hostname!==r.hostname||r.href.indexOf("#")>-1&&g(r)==g(location)||e.isDefaultPrevented())){var s={url:r.href,container:t(r).attr("data-pjax"),target:r},a=t.extend({},s,n),l=t.Event("pjax:click");t(r).trigger(l,[a]),l.isDefaultPrevented()||(i(a),e.preventDefault(),t(r).trigger("pjax:clicked",[a]))}}function n(e,o,n){n=p(o,n);var r=e.currentTarget;if("FORM"!==r.tagName.toUpperCase())throw"$.pjax.submit requires a form element";var s={type:r.method.toUpperCase(),url:r.action,container:t(r).attr("data-pjax"),target:r};if("GET"!==s.type&&void 0!==window.FormData)s.data=new FormData(r),s.processData=!1,s.contentType=!1;else{if(t(r).find(":file").length)return;s.data=t(r).serializeArray()}i(t.extend({},s,n)),e.preventDefault()}function i(e){function o(e,o,i){i||(i={}),i.relatedTarget=n;var r=t.Event(e,i);return a.trigger(r,o),!r.isDefaultPrevented()}e=t.extend(!0,{},t.ajaxSettings,i.defaults,e),t.isFunction(e.url)&&(e.url=e.url());var n=e.target,r=h(e.url).hash,a=e.context=d(e.container);e.data||(e.data={}),t.isArray(e.data)?e.data.push({name:"_pjax",value:a.selector}):e.data._pjax=a.selector;var l;e.beforeSend=function(t,n){if("GET"!==n.type&&(n.timeout=0),t.setRequestHeader("X-PJAX","true"),t.setRequestHeader("X-PJAX-Container",a.selector),!o("pjax:beforeSend",[t,n]))return!1;n.timeout>0&&(l=setTimeout(function(){o("pjax:timeout",[t,e])&&t.abort("timeout")},n.timeout),n.timeout=0),e.requestUrl=h(n.url).href},e.complete=function(t,n){l&&clearTimeout(l),o("pjax:complete",[t,n,e]),o("pjax:end",[t,e])},e.error=function(t,n,i){var r=y("",t,e),a=o("pjax:error",[t,n,i,e]);"GET"==e.type&&"abort"!==n&&a&&s(r.url)},e.success=function(n,l,u){var g=i.state,p="function"==typeof t.pjax.defaults.version?t.pjax.defaults.version():t.pjax.defaults.version,d=u.getResponseHeader("X-PJAX-Version"),f=y(n,u,e);if(p&&d&&p!==d)return void s(f.url);if(!f.contents)return void s(f.url);i.state={id:e.id||c(),url:f.url,title:f.title,container:a.selector,fragment:e.fragment,timeout:e.timeout},(e.push||e.replace)&&window.history.replaceState(i.state,f.title,f.url);try{document.activeElement.blur()}catch(t){}f.title&&(document.title=f.title),o("pjax:beforeReplace",[f.contents,e],{state:i.state,previousState:g}),a.html(f.contents);var m=a.find("input[autofocus], textarea[autofocus]").last()[0];if(m&&document.activeElement!==m&&m.focus(),v(f.scripts),"number"==typeof e.scrollTo&&t(window).scrollTop(e.scrollTo),""!==r){var _=h(f.url);_.hash=r,i.state.url=_.href,window.history.replaceState(i.state,f.title,_.href);var b=document.getElementById(_.hash.slice(1));b&&t(window).scrollTop(t(b).offset().top)}o("pjax:success",[n,l,u,e])},i.state||(i.state={id:c(),url:window.location.href,title:document.title,container:a.selector,fragment:e.fragment,timeout:e.timeout},window.history.replaceState(i.state,document.title));var g=i.xhr;g&&g.readyState<4&&(g.onreadystatechange=t.noop,g.abort()),i.options=e;var g=i.xhr=t.ajax(e);return g.readyState>0&&(e.push&&!e.replace&&(_(i.state.id,a.clone().contents()),window.history.pushState(null,"",u(e.requestUrl))),o("pjax:start",[g,e]),o("pjax:send",[g,e])),i.xhr}function r(e,o){var n={url:window.location.href,push:!1,replace:!0,scrollTo:!1};return i(t.extend(n,p(e,o)))}function s(t){window.history.replaceState(null,"",i.state.url),window.location.replace(t)}function a(e){var o=i.state,n=e.state;if(n&&n.container){if(w&&C==n.url)return;if(i.state&&i.state.id===n.id)return;var r=t(n.container);if(r.length){var a,l=A[n.id];i.state&&(a=i.state.id<n.id?"forward":"back",b(a,i.state.id,r.clone().contents()));var c=t.Event("pjax:popstate",{state:n,direction:a});r.trigger(c);var u={id:n.id,url:n.url,container:r,push:!1,fragment:n.fragment,timeout:n.timeout,scrollTo:!1};if(l){r.trigger("pjax:start",[null,u]),i.state=n,n.title&&(document.title=n.title);var h=t.Event("pjax:beforeReplace",{state:n,previousState:o});r.trigger(h,[l,u]),r.html(l),r.trigger("pjax:end",[null,u])}else i(u);r[0].offsetHeight}else s(location.href)}w=!1}function l(e){var o=t.isFunction(e.url)?e.url():e.url,n=e.type?e.type.toUpperCase():"GET",i=t("<form>",{method:"GET"===n?"GET":"POST",action:o,style:"display:none"});"GET"!==n&&"POST"!==n&&i.append(t("<input>",{type:"hidden",name:"_method",value:n.toLowerCase()}));var r=e.data;if("string"==typeof r)t.each(r.split("&"),function(e,o){var n=o.split("=");i.append(t("<input>",{type:"hidden",name:n[0],value:n[1]}))});else if("object"==typeof r)for(key in r)i.append(t("<input>",{type:"hidden",name:key,value:r[key]}));t(document.body).append(i),i.submit()}function c(){return(new Date).getTime()}function u(t){return t.replace(/\?_pjax=[^&]+&?/,"?").replace(/_pjax=[^&]+&?/,"").replace(/[\?&]$/,"")}function h(t){var e=document.createElement("a");return e.href=t,e}function g(t){return t.href.replace(/#.*/,"")}function p(e,o){return e&&o?o.container=e:o=t.isPlainObject(e)?e:{container:e},o.container&&(o.container=d(o.container)),o}function d(e){if(e=t(e),e.length){if(""!==e.selector&&e.context===document)return e;if(e.attr("id"))return t("#"+e.attr("id"));throw"cant get selector for pjax container!"}throw"no pjax container for "+e.selector}function f(t,e){return t.filter(e).add(t.find(e))}function m(e){return t.parseHTML(e,document,!0)}function y(e,o,n){var i={},r=/<html/i.test(e);if(i.url=u(o.getResponseHeader("X-PJAX-URL")||n.requestUrl),r)var s=t(m(e.match(/<head[^>]*>([\s\S.]*)<\/head>/i)[0])),a=t(m(e.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0]));else var s=a=t(m(e));if(0===a.length)return i;if(i.title=f(s,"title").last().text(),n.fragment){if("body"===n.fragment)var l=a;else var l=f(a,n.fragment).first();l.length&&(i.contents="body"===n.fragment?l:l.contents(),i.title||(i.title=l.attr("title")||l.data("title")))}else r||(i.contents=a);return i.contents&&(i.contents=i.contents.not(function(){return t(this).is("title")}),i.contents.find("title").remove(),i.scripts=f(i.contents,"script[src]").remove(),i.contents=i.contents.not(i.scripts)),i.title&&(i.title=t.trim(i.title)),i}function v(e){if(e){var o=t("script[src]");e.each(function(){var e=this.src;if(!o.filter(function(){return this.src===e}).length){var n=document.createElement("script"),i=t(this).attr("type");i&&(n.type=i),n.src=t(this).attr("src"),document.head.appendChild(n)}})}}function _(t,e){A[t]=e,B.push(t),E(I,0),E(B,i.defaults.maxCacheLength)}function b(t,e,o){var n,r;A[e]=o,"forward"===t?(n=B,r=I):(n=I,r=B),n.push(e),(e=r.pop())&&delete A[e],E(n,i.defaults.maxCacheLength)}function E(t,e){for(;t.length>e;)delete A[t.shift()]}function x(){return t("meta").filter(function(){var e=t(this).attr("http-equiv");return e&&"X-PJAX-VERSION"===e.toUpperCase()}).attr("content")}function S(){t.fn.pjax=e,t.pjax=i,t.pjax.enable=t.noop,t.pjax.disable=T,t.pjax.click=o,t.pjax.submit=n,t.pjax.reload=r,t.pjax.defaults={timeout:650,push:!0,replace:!1,type:"GET",dataType:"html",scrollTo:0,maxCacheLength:20,version:x},t(window).on("popstate.pjax",a)}function T(){t.fn.pjax=function(){return this},t.pjax=l,t.pjax.enable=S,t.pjax.disable=t.noop,t.pjax.click=t.noop,t.pjax.submit=t.noop,t.pjax.reload=function(){window.location.reload()},t(window).off("popstate.pjax",a)}var w=!0,C=window.location.href,k=window.history.state;k&&k.container&&(i.state=k),"state"in window.history&&(w=!1);var A={},I=[],B=[];t.inArray("state",t.event.props)<0&&t.event.props.push("state"),t.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]\D|WebApps\/.+CFNetwork)/),t.support.pjax?S():T()}(t)}).call(e,o(0))},function(t,e,o){(function(t){!function(e){var o=new Array,n=new Array;e.fn.doAutosize=function(t){var o=e(this).data("minwidth"),n=e(this).data("maxwidth"),i="",r=e(this),s=e("#"+e(this).data("tester_id"));if(i!==(i=r.val())){var a=i.replace(/&/g,"&").replace(/\s/g," ").replace(/</g,"<").replace(/>/g,">");s.html(a);var l=s.width(),c=l+t.comfortZone>=o?l+t.comfortZone:o;(c<r.width()&&c>=o||c>o&&c<n)&&r.width(c)}},e.fn.resetAutosize=function(t){var o=e(this).data("minwidth")||t.minInputWidth||e(this).width(),n=e(this).data("maxwidth")||t.maxInputWidth||e(this).closest(".tagsinput").width()-t.inputPadding,i=e(this),r=e("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:i.css("fontSize"),fontFamily:i.css("fontFamily"),fontWeight:i.css("fontWeight"),letterSpacing:i.css("letterSpacing"),whiteSpace:"nowrap"}),s=e(this).attr("id")+"_autosize_tester";!e("#"+s).length>0&&(r.attr("id",s),r.appendTo("body")),i.data("minwidth",o),i.data("maxwidth",n),i.data("tester_id",s),i.css("width",o)},e.fn.addTag=function(i,r){return r=t.extend({focus:!1,callback:!0},r),this.each(function(){var s=e(this).attr("id"),a=e(this).val().split(o[s]);if(""==a[0]&&(a=new Array),i=t.trim(i),r.unique){var l=e(a).tagExist(i);1==l&&e("#"+s+"_tag").addClass("not_valid")}else var l=!1;if(""!=i&&1!=l){if(e("<span>").addClass("tag").append(e("<span>").text(i).append("  "),e("<a>",{href:"#",title:"Removing tag",text:"x"}).click(function(){return e("#"+s).removeTag(escape(i))})).insertBefore("#"+s+"_addTag"),a.push(i),e("#"+s+"_tag").val(""),r.focus?e("#"+s+"_tag").focus():e("#"+s+"_tag").blur(),e.fn.tagsInput.updateTagsField(this,a),r.callback&&n[s]&&n[s].onAddTag){var c=n[s].onAddTag;c.call(this,i)}if(n[s]&&n[s].onChange){var u=a.length,c=n[s].onChange;c.call(this,e(this),a[u-1])}}}),!1},e.fn.removeTag=function(t){return t=unescape(t),this.each(function(){var r=e(this).attr("id"),s=e(this).val().split(o[r]);for(e("#"+r+"_tagsinput .tag").remove(),str="",i=0;i<s.length;i++)s[i]!=t&&(str=str+o[r]+s[i]);if(e.fn.tagsInput.importTags(this,str),n[r]&&n[r].onRemoveTag){n[r].onRemoveTag.call(this,t)}}),!1},e.fn.tagExist=function(o){return t.inArray(o,e(this))>=0},e.fn.importTags=function(t){id=e(this).attr("id"),e("#"+id+"_tagsinput .tag").remove(),e.fn.tagsInput.importTags(this,t)},e.fn.tagsInput=function(i){var r=t.extend({interactive:!0,defaultText:"add a tag",minChars:0,width:"300px",height:"100px",autocomplete:{selectFirst:!1},hide:!0,delimiter:",",unique:!0,removeWithBackspace:!0,placeholderColor:"#666666",autosize:!0,comfortZone:20,inputPadding:12},i);return this.each(function(){r.hide&&e(this).hide();var i=e(this).attr("id");i&&!o[e(this).attr("id")]||(i=e(this).attr("id","tags"+(new Date).getTime()).attr("id"));var s=t.extend({pid:i,real_input:"#"+i,holder:"#"+i+"_tagsinput",input_wrapper:"#"+i+"_addTag",fake_input:"#"+i+"_tag"},r);o[i]=s.delimiter,(r.onAddTag||r.onRemoveTag||r.onChange)&&(n[i]=new Array,n[i].onAddTag=r.onAddTag,n[i].onRemoveTag=r.onRemoveTag,n[i].onChange=r.onChange);var a='<div id="'+i+'_tagsinput" class="tagsinput"><div id="'+i+'_addTag">';if(r.interactive&&(a=a+'<input id="'+i+'_tag" value="" data-default="'+r.defaultText+'" />'),a+='</div><div class="tags_clear"></div></div>',e(a).insertAfter(this),e(s.holder).css("width",r.width),e(s.holder).css("height",r.height),""!=e(s.real_input).val()&&e.fn.tagsInput.importTags(e(s.real_input),e(s.real_input).val()),r.interactive){if(e(s.fake_input).val(e(s.fake_input).attr("data-default")),e(s.fake_input).css("color",r.placeholderColor),e(s.fake_input).resetAutosize(r),e(s.holder).bind("click",s,function(t){e(t.data.fake_input).focus()}),e(s.fake_input).bind("focus",s,function(t){e(t.data.fake_input).val()==e(t.data.fake_input).attr("data-default")&&e(t.data.fake_input).val(""),e(t.data.fake_input).css("color","#000000")}),void 0!=r.autocomplete_url){autocomplete_options={source:r.autocomplete_url};for(attrname in r.autocomplete)autocomplete_options[attrname]=r.autocomplete[attrname];void 0!==t.Autocompleter?(e(s.fake_input).autocomplete(r.autocomplete_url,r.autocomplete),e(s.fake_input).bind("result",s,function(t,o,n){o&&e("#"+i).addTag(o[0]+"",{focus:!0,unique:r.unique})})):void 0!==t.ui.autocomplete&&(e(s.fake_input).autocomplete(autocomplete_options),e(s.fake_input).bind("autocompleteselect",s,function(t,o){return e(t.data.real_input).addTag(o.item.value,{focus:!0,unique:r.unique}),!1}))}else e(s.fake_input).bind("blur",s,function(t){var o=e(this).attr("data-default");return""!=e(t.data.fake_input).val()&&e(t.data.fake_input).val()!=o?t.data.minChars<=e(t.data.fake_input).val().length&&(!t.data.maxChars||t.data.maxChars>=e(t.data.fake_input).val().length)&&e(t.data.real_input).addTag(e(t.data.fake_input).val(),{focus:!0,unique:r.unique}):(e(t.data.fake_input).val(e(t.data.fake_input).attr("data-default")),e(t.data.fake_input).css("color",r.placeholderColor)),!1});e(s.fake_input).bind("keypress",s,function(t){if(t.which==t.data.delimiter.charCodeAt(0)||13==t.which)return t.preventDefault(),t.data.minChars<=e(t.data.fake_input).val().length&&(!t.data.maxChars||t.data.maxChars>=e(t.data.fake_input).val().length)&&e(t.data.real_input).addTag(e(t.data.fake_input).val(),{focus:!0,unique:r.unique}),e(t.data.fake_input).resetAutosize(r),!1;t.data.autosize&&e(t.data.fake_input).doAutosize(r)}),s.removeWithBackspace&&e(s.fake_input).bind("keydown",function(t){if(8==t.keyCode&&""==e(this).val()){t.preventDefault();var o=e(this).closest(".tagsinput").find(".tag:last").text(),n=e(this).attr("id").replace(/_tag$/,"");o=o.replace(/[\s]+x$/,""),e("#"+n).removeTag(escape(o)),e(this).trigger("focus")}}),e(s.fake_input).blur(),s.unique&&e(s.fake_input).keydown(function(t){(8==t.keyCode||String.fromCharCode(t.which).match(/\w+|[,\/]+/))&&e(this).removeClass("not_valid")})}}),this},e.fn.tagsInput.updateTagsField=function(t,n){var i=e(t).attr("id");e(t).val(n.join(o[i]))},e.fn.tagsInput.importTags=function(t,r){e(t).val("");var s=e(t).attr("id"),a=r.split(o[s]);for(i=0;i<a.length;i++)e(t).addTag(a[i],{focus:!1,callback:!1});if(n[s]&&n[s].onChange){n[s].onChange.call(t,t,a[i])}}}(t)}).call(e,o(0))},function(t,e,o){var n,i,r;/*! jQuery UI - v1.11.2 - 2014-12-03
* http://jqueryui.com
* Includes: core.js, widget.js, mouse.js, position.js, draggable.js, resizable.js, sortable.js, autocomplete.js, menu.js, effect.js
* Copyright 2014 jQuery Foundation and other contributors; Licensed MIT */
!function(s){i=[o(0)],n=s,void 0!==(r="function"==typeof n?n.apply(e,i):n)&&(t.exports=r)}(function(t){function e(e,n){var i,r,s,a=e.nodeName.toLowerCase();return"area"===a?(i=e.parentNode,r=i.name,!(!e.href||!r||"map"!==i.nodeName.toLowerCase())&&(!!(s=t("img[usemap='#"+r+"']")[0])&&o(s))):(/input|select|textarea|button|object/.test(a)?!e.disabled:"a"===a?e.href||n:n)&&o(e)}function o(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return"hidden"===t.css(this,"visibility")}).length}t.ui=t.ui||{},t.extend(t.ui,{version:"1.11.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({scrollParent:function(e){var o=this.css("position"),n="absolute"===o,i=e?/(auto|scroll|hidden)/:/(auto|scroll)/,r=this.parents().filter(function(){var e=t(this);return(!n||"static"!==e.css("position"))&&i.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==o&&r.length?r:t(this[0].ownerDocument||document)},uniqueId:function(){var t=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++t)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(o){return!!t.data(o,e)}}):function(e,o,n){return!!t.data(e,n[3])},focusable:function(o){return e(o,!isNaN(t.attr(o,"tabindex")))},tabbable:function(o){var n=t.attr(o,"tabindex"),i=isNaN(n);return(i||n>=0)&&e(o,!i)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(e,o){function n(e,o,n,r){return t.each(i,function(){o-=parseFloat(t.css(e,"padding"+this))||0,n&&(o-=parseFloat(t.css(e,"border"+this+"Width"))||0),r&&(o-=parseFloat(t.css(e,"margin"+this))||0)}),o}var i="Width"===o?["Left","Right"]:["Top","Bottom"],r=o.toLowerCase(),s={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+o]=function(e){return void 0===e?s["inner"+o].call(this):this.each(function(){t(this).css(r,n(this,e)+"px")})},t.fn["outer"+o]=function(e,i){return"number"!=typeof e?s["outer"+o].call(this,e):this.each(function(){t(this).css(r,n(this,e,!0,i)+"px")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(o){return arguments.length?e.call(this,t.camelCase(o)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.fn.extend({focus:function(e){return function(o,n){return"number"==typeof o?this.each(function(){var e=this;setTimeout(function(){t(e).focus(),n&&n.call(e)},o)}):e.apply(this,arguments)}}(t.fn.focus),disableSelection:function(){var t="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(t+".ui-disableSelection",function(t){t.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var o,n,i=t(this[0]);i.length&&i[0]!==document;){if(("absolute"===(o=i.css("position"))||"relative"===o||"fixed"===o)&&(n=parseInt(i.css("zIndex"),10),!isNaN(n)&&0!==n))return n;i=i.parent()}return 0}}),t.ui.plugin={add:function(e,o,n){var i,r=t.ui[e].prototype;for(i in n)r.plugins[i]=r.plugins[i]||[],r.plugins[i].push([o,n[i]])},call:function(t,e,o,n){var i,r=t.plugins[e];if(r&&(n||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(i=0;r.length>i;i++)t.options[r[i][0]]&&r[i][1].apply(t.element,o)}};var n=0,i=Array.prototype.slice;t.cleanData=function(e){return function(o){var n,i,r;for(r=0;null!=(i=o[r]);r++)try{(n=t._data(i,"events"))&&n.remove&&t(i).triggerHandler("remove")}catch(t){}e(o)}}(t.cleanData),t.widget=function(e,o,n){var i,r,s,a,l={},c=e.split(".")[0];return e=e.split(".")[1],i=c+"-"+e,n||(n=o,o=t.Widget),t.expr[":"][i.toLowerCase()]=function(e){return!!t.data(e,i)},t[c]=t[c]||{},r=t[c][e],s=t[c][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new s(t,e)},t.extend(s,r,{version:n.version,_proto:t.extend({},n),_childConstructors:[]}),a=new o,a.options=t.widget.extend({},a.options),t.each(n,function(e,n){return t.isFunction(n)?void(l[e]=function(){var t=function(){return o.prototype[e].apply(this,arguments)},i=function(t){return o.prototype[e].apply(this,t)};return function(){var e,o=this._super,r=this._superApply;return this._super=t,this._superApply=i,e=n.apply(this,arguments),this._super=o,this._superApply=r,e}}()):void(l[e]=n)}),s.prototype=t.widget.extend(a,{widgetEventPrefix:r?a.widgetEventPrefix||e:e},l,{constructor:s,namespace:c,widgetName:e,widgetFullName:i}),r?(t.each(r._childConstructors,function(e,o){var n=o.prototype;t.widget(n.namespace+"."+n.widgetName,s,o._proto)}),delete r._childConstructors):o._childConstructors.push(s),t.widget.bridge(e,s),s},t.widget.extend=function(e){for(var o,n,r=i.call(arguments,1),s=0,a=r.length;a>s;s++)for(o in r[s])n=r[s][o],r[s].hasOwnProperty(o)&&void 0!==n&&(e[o]=t.isPlainObject(n)?t.isPlainObject(e[o])?t.widget.extend({},e[o],n):t.widget.extend({},n):n);return e},t.widget.bridge=function(e,o){var n=o.prototype.widgetFullName||e;t.fn[e]=function(r){var s="string"==typeof r,a=i.call(arguments,1),l=this;return r=!s&&a.length?t.widget.extend.apply(null,[r].concat(a)):r,s?this.each(function(){var o,i=t.data(this,n);return"instance"===r?(l=i,!1):i?t.isFunction(i[r])&&"_"!==r.charAt(0)?(o=i[r].apply(i,a),o!==i&&void 0!==o?(l=o&&o.jquery?l.pushStack(o.get()):o,!1):void 0):t.error("no such method '"+r+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+r+"'")}):this.each(function(){var e=t.data(this,n);e?(e.option(r||{}),e._init&&e._init()):t.data(this,n,new o(r,this))}),l}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,o){o=t(o||this.defaultElement||this)[0],this.element=t(o),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),o!==this&&(t.data(o,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===o&&this.destroy()}}),this.document=t(o.style?o.ownerDocument:o.document||o),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(e,o){var n,i,r,s=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(s={},n=e.split("."),e=n.shift(),n.length){for(i=s[e]=t.widget.extend({},this.options[e]),r=0;n.length-1>r;r++)i[n[r]]=i[n[r]]||{},i=i[n[r]];if(e=n.pop(),1===arguments.length)return void 0===i[e]?null:i[e];i[e]=o}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];s[e]=o}return this._setOptions(s),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!e),e&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(e,o,n){var i,r=this;"boolean"!=typeof e&&(n=o,o=e,e=!1),n?(o=i=t(o),this.bindings=this.bindings.add(o)):(n=o,o=this.element,i=this.widget()),t.each(n,function(n,s){function a(){return e||!0!==r.options.disabled&&!t(this).hasClass("ui-state-disabled")?("string"==typeof s?r[s]:s).apply(r,arguments):void 0}"string"!=typeof s&&(a.guid=s.guid=s.guid||a.guid||t.guid++);var l=n.match(/^([\w:-]*)\s*(.*)$/),c=l[1]+r.eventNamespace,u=l[2];u?i.delegate(u,c,a):o.bind(c,a)})},_off:function(e,o){o=(o||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(o).undelegate(o),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){function o(){return("string"==typeof t?n[t]:t).apply(n,arguments)}var n=this;return setTimeout(o,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,o,n){var i,r,s=this.options[e];if(n=n||{},o=t.Event(o),o.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),o.target=this.element[0],r=o.originalEvent)for(i in r)i in o||(o[i]=r[i]);return this.element.trigger(o,n),!(t.isFunction(s)&&!1===s.apply(this.element[0],[o].concat(n))||o.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,o){t.Widget.prototype["_"+e]=function(n,i,r){"string"==typeof i&&(i={effect:i});var s,a=i?!0===i||"number"==typeof i?o:i.effect||o:e;i=i||{},"number"==typeof i&&(i={duration:i}),s=!t.isEmptyObject(i),i.complete=r,i.delay&&n.delay(i.delay),s&&t.effects&&t.effects.effect[a]?n[e](i):a!==e&&n[a]?n[a](i.duration,i.easing,r):n.queue(function(o){t(this)[e](),r&&r.call(n[0]),o()})}}),t.widget;var r=!1;t(document).mouseup(function(){r=!1}),t.widget("ui.mouse",{version:"1.11.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(o){return!0===t.data(o.target,e.widgetName+".preventClickEvent")?(t.removeData(o.target,e.widgetName+".preventClickEvent"),o.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!r){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var o=this,n=1===e.which,i=!("string"!=typeof this.options.cancel||!e.target.nodeName)&&t(e.target).closest(this.options.cancel).length;return!(n&&!i&&this._mouseCapture(e))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){o.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(e),!this._mouseStarted)?(e.preventDefault(),!0):(!0===t.data(e.target,this.widgetName+".preventClickEvent")&&t.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return o._mouseMove(t)},this._mouseUpDelegate=function(t){return o._mouseUp(t)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),r=!0,!0))}},_mouseMove:function(e){if(this._mouseMoved){if(t.ui.ie&&(!document.documentMode||9>document.documentMode)&&!e.button)return this._mouseUp(e);if(!e.which)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,e),this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),r=!1,!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),function(){function e(t,e,o){return[parseFloat(t[0])*(p.test(t[0])?e/100:1),parseFloat(t[1])*(p.test(t[1])?o/100:1)]}function o(e,o){return parseInt(t.css(e,o),10)||0}function n(e){var o=e[0];return 9===o.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(o)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:o.preventDefault?{width:0,height:0,offset:{top:o.pageY,left:o.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}t.ui=t.ui||{};var i,r,s=Math.max,a=Math.abs,l=Math.round,c=/left|center|right/,u=/top|center|bottom/,h=/[\+\-]\d+(\.[\d]+)?%?/,g=/^\w+/,p=/%$/,d=t.fn.position;t.position={scrollbarWidth:function(){if(void 0!==i)return i;var e,o,n=t("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),r=n.children()[0];return t("body").append(n),e=r.offsetWidth,n.css("overflow","scroll"),o=r.offsetWidth,e===o&&(o=n[0].clientWidth),n.remove(),i=e-o},getScrollInfo:function(e){var o=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),n=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),i="scroll"===o||"auto"===o&&e.width<e.element[0].scrollWidth;return{width:"scroll"===n||"auto"===n&&e.height<e.element[0].scrollHeight?t.position.scrollbarWidth():0,height:i?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var o=t(e||window),n=t.isWindow(o[0]),i=!!o[0]&&9===o[0].nodeType;return{element:o,isWindow:n,isDocument:i,offset:o.offset()||{left:0,top:0},scrollLeft:o.scrollLeft(),scrollTop:o.scrollTop(),width:n||i?o.width():o.outerWidth(),height:n||i?o.height():o.outerHeight()}}},t.fn.position=function(i){if(!i||!i.of)return d.apply(this,arguments);i=t.extend({},i);var p,f,m,y,v,_,b=t(i.of),E=t.position.getWithinInfo(i.within),x=t.position.getScrollInfo(E),S=(i.collision||"flip").split(" "),T={};return _=n(b),b[0].preventDefault&&(i.at="left top"),f=_.width,m=_.height,y=_.offset,v=t.extend({},y),t.each(["my","at"],function(){var t,e,o=(i[this]||"").split(" ");1===o.length&&(o=c.test(o[0])?o.concat(["center"]):u.test(o[0])?["center"].concat(o):["center","center"]),o[0]=c.test(o[0])?o[0]:"center",o[1]=u.test(o[1])?o[1]:"center",t=h.exec(o[0]),e=h.exec(o[1]),T[this]=[t?t[0]:0,e?e[0]:0],i[this]=[g.exec(o[0])[0],g.exec(o[1])[0]]}),1===S.length&&(S[1]=S[0]),"right"===i.at[0]?v.left+=f:"center"===i.at[0]&&(v.left+=f/2),"bottom"===i.at[1]?v.top+=m:"center"===i.at[1]&&(v.top+=m/2),p=e(T.at,f,m),v.left+=p[0],v.top+=p[1],this.each(function(){var n,c,u=t(this),h=u.outerWidth(),g=u.outerHeight(),d=o(this,"marginLeft"),_=o(this,"marginTop"),w=h+d+o(this,"marginRight")+x.width,C=g+_+o(this,"marginBottom")+x.height,k=t.extend({},v),A=e(T.my,u.outerWidth(),u.outerHeight());"right"===i.my[0]?k.left-=h:"center"===i.my[0]&&(k.left-=h/2),"bottom"===i.my[1]?k.top-=g:"center"===i.my[1]&&(k.top-=g/2),k.left+=A[0],k.top+=A[1],r||(k.left=l(k.left),k.top=l(k.top)),n={marginLeft:d,marginTop:_},t.each(["left","top"],function(e,o){t.ui.position[S[e]]&&t.ui.position[S[e]][o](k,{targetWidth:f,targetHeight:m,elemWidth:h,elemHeight:g,collisionPosition:n,collisionWidth:w,collisionHeight:C,offset:[p[0]+A[0],p[1]+A[1]],my:i.my,at:i.at,within:E,elem:u})}),i.using&&(c=function(t){var e=y.left-k.left,o=e+f-h,n=y.top-k.top,r=n+m-g,l={target:{element:b,left:y.left,top:y.top,width:f,height:m},element:{element:u,left:k.left,top:k.top,width:h,height:g},horizontal:0>o?"left":e>0?"right":"center",vertical:0>r?"top":n>0?"bottom":"middle"};h>f&&f>a(e+o)&&(l.horizontal="center"),g>m&&m>a(n+r)&&(l.vertical="middle"),l.important=s(a(e),a(o))>s(a(n),a(r))?"horizontal":"vertical",i.using.call(this,t,l)}),u.offset(t.extend(k,{using:c}))})},t.ui.position={fit:{left:function(t,e){var o,n=e.within,i=n.isWindow?n.scrollLeft:n.offset.left,r=n.width,a=t.left-e.collisionPosition.marginLeft,l=i-a,c=a+e.collisionWidth-r-i;e.collisionWidth>r?l>0&&0>=c?(o=t.left+l+e.collisionWidth-r-i,t.left+=l-o):t.left=c>0&&0>=l?i:l>c?i+r-e.collisionWidth:i:l>0?t.left+=l:c>0?t.left-=c:t.left=s(t.left-a,t.left)},top:function(t,e){var o,n=e.within,i=n.isWindow?n.scrollTop:n.offset.top,r=e.within.height,a=t.top-e.collisionPosition.marginTop,l=i-a,c=a+e.collisionHeight-r-i;e.collisionHeight>r?l>0&&0>=c?(o=t.top+l+e.collisionHeight-r-i,t.top+=l-o):t.top=c>0&&0>=l?i:l>c?i+r-e.collisionHeight:i:l>0?t.top+=l:c>0?t.top-=c:t.top=s(t.top-a,t.top)}},flip:{left:function(t,e){var o,n,i=e.within,r=i.offset.left+i.scrollLeft,s=i.width,l=i.isWindow?i.scrollLeft:i.offset.left,c=t.left-e.collisionPosition.marginLeft,u=c-l,h=c+e.collisionWidth-s-l,g="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,p="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,d=-2*e.offset[0];0>u?(0>(o=t.left+g+p+d+e.collisionWidth-s-r)||a(u)>o)&&(t.left+=g+p+d):h>0&&((n=t.left-e.collisionPosition.marginLeft+g+p+d-l)>0||h>a(n))&&(t.left+=g+p+d)},top:function(t,e){var o,n,i=e.within,r=i.offset.top+i.scrollTop,s=i.height,l=i.isWindow?i.scrollTop:i.offset.top,c=t.top-e.collisionPosition.marginTop,u=c-l,h=c+e.collisionHeight-s-l,g="top"===e.my[1],p=g?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,d="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,f=-2*e.offset[1];0>u?(n=t.top+p+d+f+e.collisionHeight-s-r,t.top+p+d+f>u&&(0>n||a(u)>n)&&(t.top+=p+d+f)):h>0&&(o=t.top-e.collisionPosition.marginTop+p+d+f-l,t.top+p+d+f>h&&(o>0||h>a(o))&&(t.top+=p+d+f))}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}},function(){var e,o,n,i,s,a=document.getElementsByTagName("body")[0],l=document.createElement("div");e=document.createElement(a?"div":"body"),n={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},a&&t.extend(n,{position:"absolute",left:"-1000px",top:"-1000px"});for(s in n)e.style[s]=n[s];e.appendChild(l),o=a||document.documentElement,o.insertBefore(e,o.firstChild),l.style.cssText="position: absolute; left: 10.7432222px;",i=t(l).offset().left,r=i>10&&11>i,e.innerHTML="",o.removeChild(e)}()}(),t.ui.position,t.widget("ui.draggable",t.ui.mouse,{version:"1.11.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),"handle"===t&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(e){var o=this.options;return this._blurActiveElement(e),!(this.helper||o.disabled||t(e.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(e),!!this.handle&&(this._blockFrames(!0===o.iframeFix?"iframe":o.iframeFix),!0))},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map(function(){var e=t(this);return t("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var o=this.document[0];if(this.handleElement.is(e.target))try{o.activeElement&&"body"!==o.activeElement.nodeName.toLowerCase()&&t(o.activeElement).blur()}catch(t){}},_mouseStart:function(e){var o=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===t(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this._setContainment(),!1===this._trigger("start",e)?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!o.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._normalizeRightBottom(),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(e,o){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!o){var n=this._uiHash();if(!1===this._trigger("drag",e,n))return this._mouseUp({}),!1;this.position=n.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var o=this,n=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(n=t.ui.ddmanager.drop(this,e)),this.dropped&&(n=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!n||"valid"===this.options.revert&&n||!0===this.options.revert||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==o._trigger("stop",e)&&o._clear()}):!1!==this._trigger("stop",e)&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.focus(),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return!this.options.handle||!!t(e.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(e){var o=this.options,n=t.isFunction(o.helper),i=n?t(o.helper.apply(this.element[0],[e])):"clone"===o.helper?this.element.clone().removeAttr("id"):this.element;return i.parents("body").length||i.appendTo("parent"===o.appendTo?this.element[0].parentNode:o.appendTo),n&&i[0]===this.element[0]&&this._setPositionRelative(),i[0]===this.element[0]||/(fixed|absolute)/.test(i.css("position"))||i.css("position","absolute"),i},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),o=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==o&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,o,n,i=this.options,r=this.document[0];return this.relativeContainer=null,i.containment?"window"===i.containment?void(this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||r.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===i.containment?void(this.containment=[0,0,t(r).width()-this.helperProportions.width-this.margins.left,(t(r).height()||r.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):i.containment.constructor===Array?void(this.containment=i.containment):("parent"===i.containment&&(i.containment=this.helper[0].parentNode),o=t(i.containment),void((n=o[0])&&(e=/(scroll|auto)/.test(o.css("overflow")),this.containment=[(parseInt(o.css("borderLeftWidth"),10)||0)+(parseInt(o.css("paddingLeft"),10)||0),(parseInt(o.css("borderTopWidth"),10)||0)+(parseInt(o.css("paddingTop"),10)||0),(e?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(o.css("borderRightWidth"),10)||0)-(parseInt(o.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(o.css("borderBottomWidth"),10)||0)-(parseInt(o.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=o))):void(this.containment=null)},_convertPositionTo:function(t,e){e||(e=this.position);var o="absolute"===t?1:-1,n=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*o+this.offset.parent.top*o-("fixed"===this.cssPosition?-this.offset.scroll.top:n?0:this.offset.scroll.top)*o,left:e.left+this.offset.relative.left*o+this.offset.parent.left*o-("fixed"===this.cssPosition?-this.offset.scroll.left:n?0:this.offset.scroll.left)*o}},_generatePosition:function(t,e){var o,n,i,r,s=this.options,a=this._isRootNode(this.scrollParent[0]),l=t.pageX,c=t.pageY;return a&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(this.relativeContainer?(n=this.relativeContainer.offset(),o=[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):o=this.containment,t.pageX-this.offset.click.left<o[0]&&(l=o[0]+this.offset.click.left),t.pageY-this.offset.click.top<o[1]&&(c=o[1]+this.offset.click.top),t.pageX-this.offset.click.left>o[2]&&(l=o[2]+this.offset.click.left),t.pageY-this.offset.click.top>o[3]&&(c=o[3]+this.offset.click.top)),s.grid&&(i=s.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/s.grid[1])*s.grid[1]:this.originalPageY,c=o?i-this.offset.click.top>=o[1]||i-this.offset.click.top>o[3]?i:i-this.offset.click.top>=o[1]?i-s.grid[1]:i+s.grid[1]:i,r=s.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/s.grid[0])*s.grid[0]:this.originalPageX,l=o?r-this.offset.click.left>=o[0]||r-this.offset.click.left>o[2]?r:r-this.offset.click.left>=o[0]?r-s.grid[0]:r+s.grid[0]:r),"y"===s.axis&&(l=this.originalPageX),"x"===s.axis&&(c=this.originalPageY)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:a?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:a?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(e,o,n){return n=n||this._uiHash(),t.ui.plugin.call(this,e,[o,n,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),n.offset=this.positionAbs),t.Widget.prototype._trigger.call(this,e,o,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,o,n){var i=t.extend({},o,{item:n.element});n.sortables=[],t(n.options.connectToSortable).each(function(){var o=t(this).sortable("instance");o&&!o.options.disabled&&(n.sortables.push(o),o.refreshPositions(),o._trigger("activate",e,i))})},stop:function(e,o,n){var i=t.extend({},o,{item:n.element});n.cancelHelperRemoval=!1,t.each(n.sortables,function(){var t=this;t.isOver?(t.isOver=0,n.cancelHelperRemoval=!0,t.cancelHelperRemoval=!1,t._storedCSS={position:t.placeholder.css("position"),top:t.placeholder.css("top"),left:t.placeholder.css("left")},t._mouseStop(e),t.options.helper=t.options._helper):(t.cancelHelperRemoval=!0,t._trigger("deactivate",e,i))})},drag:function(e,o,n){t.each(n.sortables,function(){var i=!1,r=this;r.positionAbs=n.positionAbs,r.helperProportions=n.helperProportions,r.offset.click=n.offset.click,r._intersectsWith(r.containerCache)&&(i=!0,t.each(n.sortables,function(){return this.positionAbs=n.positionAbs,this.helperProportions=n.helperProportions,this.offset.click=n.offset.click,this!==r&&this._intersectsWith(this.containerCache)&&t.contains(r.element[0],this.element[0])&&(i=!1),i})),i?(r.isOver||(r.isOver=1,r.currentItem=o.helper.appendTo(r.element).data("ui-sortable-item",!0),r.options._helper=r.options.helper,r.options.helper=function(){return o.helper[0]},e.target=r.currentItem[0],r._mouseCapture(e,!0),r._mouseStart(e,!0,!0),r.offset.click.top=n.offset.click.top,r.offset.click.left=n.offset.click.left,r.offset.parent.left-=n.offset.parent.left-r.offset.parent.left,r.offset.parent.top-=n.offset.parent.top-r.offset.parent.top,n._trigger("toSortable",e),n.dropped=r.element,t.each(n.sortables,function(){this.refreshPositions()}),n.currentItem=n.element,r.fromOutside=n),r.currentItem&&(r._mouseDrag(e),o.position=r.position)):r.isOver&&(r.isOver=0,r.cancelHelperRemoval=!0,r.options._revert=r.options.revert,r.options.revert=!1,r._trigger("out",e,r._uiHash(r)),r._mouseStop(e,!0),r.options.revert=r.options._revert,r.options.helper=r.options._helper,r.placeholder&&r.placeholder.remove(),n._refreshOffsets(e),o.position=n._generatePosition(e,!0),n._trigger("fromSortable",e),n.dropped=!1,t.each(n.sortables,function(){this.refreshPositions()}))})}}),t.ui.plugin.add("draggable","cursor",{start:function(e,o,n){var i=t("body"),r=n.options;i.css("cursor")&&(r._cursor=i.css("cursor")),i.css("cursor",r.cursor)},stop:function(e,o,n){var i=n.options;i._cursor&&t("body").css("cursor",i._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,o,n){var i=t(o.helper),r=n.options;i.css("opacity")&&(r._opacity=i.css("opacity")),i.css("opacity",r.opacity)},stop:function(e,o,n){var i=n.options;i._opacity&&t(o.helper).css("opacity",i._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(t,e,o){o.scrollParentNotHidden||(o.scrollParentNotHidden=o.helper.scrollParent(!1)),o.scrollParentNotHidden[0]!==o.document[0]&&"HTML"!==o.scrollParentNotHidden[0].tagName&&(o.overflowOffset=o.scrollParentNotHidden.offset())},drag:function(e,o,n){var i=n.options,r=!1,s=n.scrollParentNotHidden[0],a=n.document[0];s!==a&&"HTML"!==s.tagName?(i.axis&&"x"===i.axis||(n.overflowOffset.top+s.offsetHeight-e.pageY<i.scrollSensitivity?s.scrollTop=r=s.scrollTop+i.scrollSpeed:e.pageY-n.overflowOffset.top<i.scrollSensitivity&&(s.scrollTop=r=s.scrollTop-i.scrollSpeed)),i.axis&&"y"===i.axis||(n.overflowOffset.left+s.offsetWidth-e.pageX<i.scrollSensitivity?s.scrollLeft=r=s.scrollLeft+i.scrollSpeed:e.pageX-n.overflowOffset.left<i.scrollSensitivity&&(s.scrollLeft=r=s.scrollLeft-i.scrollSpeed))):(i.axis&&"x"===i.axis||(e.pageY-t(a).scrollTop()<i.scrollSensitivity?r=t(a).scrollTop(t(a).scrollTop()-i.scrollSpeed):t(window).height()-(e.pageY-t(a).scrollTop())<i.scrollSensitivity&&(r=t(a).scrollTop(t(a).scrollTop()+i.scrollSpeed))),i.axis&&"y"===i.axis||(e.pageX-t(a).scrollLeft()<i.scrollSensitivity?r=t(a).scrollLeft(t(a).scrollLeft()-i.scrollSpeed):t(window).width()-(e.pageX-t(a).scrollLeft())<i.scrollSensitivity&&(r=t(a).scrollLeft(t(a).scrollLeft()+i.scrollSpeed)))),!1!==r&&t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(n,e)}}),t.ui.plugin.add("draggable","snap",{start:function(e,o,n){var i=n.options;n.snapElements=[],t(i.snap.constructor!==String?i.snap.items||":data(ui-draggable)":i.snap).each(function(){var e=t(this),o=e.offset();this!==n.element[0]&&n.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:o.top,left:o.left})})},drag:function(e,o,n){var i,r,s,a,l,c,u,h,g,p,d=n.options,f=d.snapTolerance,m=o.offset.left,y=m+n.helperProportions.width,v=o.offset.top,_=v+n.helperProportions.height;for(g=n.snapElements.length-1;g>=0;g--)l=n.snapElements[g].left-n.margins.left,c=l+n.snapElements[g].width,u=n.snapElements[g].top-n.margins.top,h=u+n.snapElements[g].height,l-f>y||m>c+f||u-f>_||v>h+f||!t.contains(n.snapElements[g].item.ownerDocument,n.snapElements[g].item)?(n.snapElements[g].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,e,t.extend(n._uiHash(),{snapItem:n.snapElements[g].item})),n.snapElements[g].snapping=!1):("inner"!==d.snapMode&&(i=f>=Math.abs(u-_),r=f>=Math.abs(h-v),s=f>=Math.abs(l-y),a=f>=Math.abs(c-m),i&&(o.position.top=n._convertPositionTo("relative",{top:u-n.helperProportions.height,left:0}).top),r&&(o.position.top=n._convertPositionTo("relative",{top:h,left:0}).top),s&&(o.position.left=n._convertPositionTo("relative",{top:0,left:l-n.helperProportions.width}).left),a&&(o.position.left=n._convertPositionTo("relative",{top:0,left:c}).left)),p=i||r||s||a,"outer"!==d.snapMode&&(i=f>=Math.abs(u-v),r=f>=Math.abs(h-_),s=f>=Math.abs(l-m),a=f>=Math.abs(c-y),i&&(o.position.top=n._convertPositionTo("relative",{top:u,left:0}).top),r&&(o.position.top=n._convertPositionTo("relative",{top:h-n.helperProportions.height,left:0}).top),s&&(o.position.left=n._convertPositionTo("relative",{top:0,left:l}).left),a&&(o.position.left=n._convertPositionTo("relative",{top:0,left:c-n.helperProportions.width}).left)),!n.snapElements[g].snapping&&(i||r||s||a||p)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,e,t.extend(n._uiHash(),{snapItem:n.snapElements[g].item})),n.snapElements[g].snapping=i||r||s||a||p)}}),t.ui.plugin.add("draggable","stack",{start:function(e,o,n){var i,r=n.options,s=t.makeArray(t(r.stack)).sort(function(e,o){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(o).css("zIndex"),10)||0)});s.length&&(i=parseInt(t(s[0]).css("zIndex"),10)||0,t(s).each(function(e){t(this).css("zIndex",i+e)}),this.css("zIndex",i+s.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,o,n){var i=t(o.helper),r=n.options;i.css("zIndex")&&(r._zIndex=i.css("zIndex")),i.css("zIndex",r.zIndex)},stop:function(e,o,n){var i=n.options;i._zIndex&&t(o.helper).css("zIndex",i._zIndex)}}),t.ui.draggable,t.widget("ui.resizable",t.ui.mouse,{version:"1.11.2",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(t){return parseInt(t,10)||0},_isNumber:function(t){return!isNaN(parseInt(t,10))},_hasScroll:function(e,o){if("hidden"===t(e).css("overflow"))return!1;var n=o&&"left"===o?"scrollLeft":"scrollTop",i=!1;return e[n]>0||(e[n]=1,i=e[n]>0,e[n]=0,i)},_create:function(){var e,o,n,i,r,s=this,a=this.options;if(this.element.addClass("ui-resizable"),t.extend(this,{_aspectRatio:!!a.aspectRatio,aspectRatio:a.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:a.helper||a.ghost||a.animate?a.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(t("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=a.handles||(t(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),e=this.handles.split(","),this.handles={},o=0;e.length>o;o++)n=t.trim(e[o]),r="ui-resizable-"+n,i=t("<div class='ui-resizable-handle "+r+"'></div>"),i.css({zIndex:a.zIndex}),"se"===n&&i.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[n]=".ui-resizable-"+n,this.element.append(i);this._renderAxis=function(e){var o,n,i,r;e=e||this.element;for(o in this.handles)this.handles[o].constructor===String&&(this.handles[o]=this.element.children(this.handles[o]).first().show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(n=t(this.handles[o],this.element),r=/sw|ne|nw|se|n|s/.test(o)?n.outerHeight():n.outerWidth(),i=["padding",/ne|nw|n/.test(o)?"Top":/se|sw|s/.test(o)?"Bottom":/^e$/.test(o)?"Right":"Left"].join(""),e.css(i,r),this._proportionallyResize()),t(this.handles[o]).length},this._renderAxis(this.element),this._handles=t(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){s.resizing||(this.className&&(i=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),s.axis=i&&i[1]?i[1]:"se")}),a.autoHide&&(this._handles.hide(),t(this.element).addClass("ui-resizable-autohide").mouseenter(function(){a.disabled||(t(this).removeClass("ui-resizable-autohide"),s._handles.show())}).mouseleave(function(){a.disabled||s.resizing||(t(this).addClass("ui-resizable-autohide"),s._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var e,o=function(e){t(e).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(o(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),o(this.originalElement),this},_mouseCapture:function(e){var o,n,i=!1;for(o in this.handles)((n=t(this.handles[o])[0])===e.target||t.contains(n,e.target))&&(i=!0);return!this.options.disabled&&i},_mouseStart:function(e){var o,n,i,r=this.options,s=this.element;return this.resizing=!0,this._renderProxy(),o=this._num(this.helper.css("left")),n=this._num(this.helper.css("top")),r.containment&&(o+=t(r.containment).scrollLeft()||0,n+=t(r.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:o,top:n},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:s.width(),height:s.height()},this.originalSize=this._helper?{width:s.outerWidth(),height:s.outerHeight()}:{width:s.width(),height:s.height()},this.sizeDiff={width:s.outerWidth()-s.width(),height:s.outerHeight()-s.height()},this.originalPosition={left:o,top:n},this.originalMousePosition={left:e.pageX,top:e.pageY},this.aspectRatio="number"==typeof r.aspectRatio?r.aspectRatio:this.originalSize.width/this.originalSize.height||1,i=t(".ui-resizable-"+this.axis).css("cursor"),t("body").css("cursor","auto"===i?this.axis+"-resize":i),s.addClass("ui-resizable-resizing"),this._propagate("start",e),!0},_mouseDrag:function(e){var o,n,i=this.originalMousePosition,r=this.axis,s=e.pageX-i.left||0,a=e.pageY-i.top||0,l=this._change[r];return this._updatePrevProperties(),!!l&&(o=l.apply(this,[e,s,a]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(o=this._updateRatio(o,e)),o=this._respectSize(o,e),this._updateCache(o),this._propagate("resize",e),n=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),t.isEmptyObject(n)||(this._updatePrevProperties(),this._trigger("resize",e,this.ui()),this._applyChanges()),!1)},_mouseStop:function(e){this.resizing=!1;var o,n,i,r,s,a,l,c=this.options,u=this;return this._helper&&(o=this._proportionallyResizeElements,n=o.length&&/textarea/i.test(o[0].nodeName),i=n&&this._hasScroll(o[0],"left")?0:u.sizeDiff.height,r=n?0:u.sizeDiff.width,s={width:u.helper.width()-r,height:u.helper.height()-i},a=parseInt(u.element.css("left"),10)+(u.position.left-u.originalPosition.left)||null,l=parseInt(u.element.css("top"),10)+(u.position.top-u.originalPosition.top)||null,c.animate||this.element.css(t.extend(s,{top:l,left:a})),u.helper.height(u.size.height),u.helper.width(u.size.width),this._helper&&!c.animate&&this._proportionallyResize()),t("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var t={};return this.position.top!==this.prevPosition.top&&(t.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(t.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(t.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(t.height=this.size.height+"px"),this.helper.css(t),t},_updateVirtualBoundaries:function(t){var e,o,n,i,r,s=this.options;r={minWidth:this._isNumber(s.minWidth)?s.minWidth:0,maxWidth:this._isNumber(s.maxWidth)?s.maxWidth:1/0,minHeight:this._isNumber(s.minHeight)?s.minHeight:0,maxHeight:this._isNumber(s.maxHeight)?s.maxHeight:1/0},(this._aspectRatio||t)&&(e=r.minHeight*this.aspectRatio,n=r.minWidth/this.aspectRatio,o=r.maxHeight*this.aspectRatio,i=r.maxWidth/this.aspectRatio,e>r.minWidth&&(r.minWidth=e),n>r.minHeight&&(r.minHeight=n),r.maxWidth>o&&(r.maxWidth=o),r.maxHeight>i&&(r.maxHeight=i)),this._vBoundaries=r},_updateCache:function(t){this.offset=this.helper.offset(),this._isNumber(t.left)&&(this.position.left=t.left),this._isNumber(t.top)&&(this.position.top=t.top),this._isNumber(t.height)&&(this.size.height=t.height),this._isNumber(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=this.position,o=this.size,n=this.axis;return this._isNumber(t.height)?t.width=t.height*this.aspectRatio:this._isNumber(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===n&&(t.left=e.left+(o.width-t.width),t.top=null),"nw"===n&&(t.top=e.top+(o.height-t.height),t.left=e.left+(o.width-t.width)),t},_respectSize:function(t){var e=this._vBoundaries,o=this.axis,n=this._isNumber(t.width)&&e.maxWidth&&e.maxWidth<t.width,i=this._isNumber(t.height)&&e.maxHeight&&e.maxHeight<t.height,r=this._isNumber(t.width)&&e.minWidth&&e.minWidth>t.width,s=this._isNumber(t.height)&&e.minHeight&&e.minHeight>t.height,a=this.originalPosition.left+this.originalSize.width,l=this.position.top+this.size.height,c=/sw|nw|w/.test(o),u=/nw|ne|n/.test(o);return r&&(t.width=e.minWidth),s&&(t.height=e.minHeight),n&&(t.width=e.maxWidth),i&&(t.height=e.maxHeight),r&&c&&(t.left=a-e.minWidth),n&&c&&(t.left=a-e.maxWidth),s&&u&&(t.top=l-e.minHeight),i&&u&&(t.top=l-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_getPaddingPlusBorderDimensions:function(t){for(var e=0,o=[],n=[t.css("borderTopWidth"),t.css("borderRightWidth"),t.css("borderBottomWidth"),t.css("borderLeftWidth")],i=[t.css("paddingTop"),t.css("paddingRight"),t.css("paddingBottom"),t.css("paddingLeft")];4>e;e++)o[e]=parseInt(n[e],10)||0,o[e]+=parseInt(i[e],10)||0;return{height:o[0]+o[2],width:o[1]+o[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t,e=0,o=this.helper||this.element;this._proportionallyResizeElements.length>e;e++)t=this._proportionallyResizeElements[e],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(t)),t.css({height:o.height()-this.outerDimensions.height||0,width:o.width()-this.outerDimensions.width||0})},_renderProxy:function(){var e=this.element,o=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||t("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++o.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var o=this.originalSize;return{left:this.originalPosition.left+e,width:o.width-e}},n:function(t,e,o){var n=this.originalSize;return{top:this.originalPosition.top+o,height:n.height-o}},s:function(t,e,o){return{height:this.originalSize.height+o}},se:function(e,o,n){return t.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,o,n]))},sw:function(e,o,n){return t.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,o,n]))},ne:function(e,o,n){return t.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,o,n]))},nw:function(e,o,n){return t.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,o,n]))}},_propagate:function(e,o){t.ui.plugin.call(this,e,[o,this.ui()]),"resize"!==e&&this._trigger(e,o,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),t.ui.plugin.add("resizable","animate",{stop:function(e){var o=t(this).resizable("instance"),n=o.options,i=o._proportionallyResizeElements,r=i.length&&/textarea/i.test(i[0].nodeName),s=r&&o._hasScroll(i[0],"left")?0:o.sizeDiff.height,a=r?0:o.sizeDiff.width,l={width:o.size.width-a,height:o.size.height-s},c=parseInt(o.element.css("left"),10)+(o.position.left-o.originalPosition.left)||null,u=parseInt(o.element.css("top"),10)+(o.position.top-o.originalPosition.top)||null;o.element.animate(t.extend(l,u&&c?{top:u,left:c}:{}),{duration:n.animateDuration,easing:n.animateEasing,step:function(){var n={width:parseInt(o.element.css("width"),10),height:parseInt(o.element.css("height"),10),top:parseInt(o.element.css("top"),10),left:parseInt(o.element.css("left"),10)};i&&i.length&&t(i[0]).css({width:n.width,height:n.height}),o._updateCache(n),o._propagate("resize",e)}})}}),t.ui.plugin.add("resizable","containment",{start:function(){var e,o,n,i,r,s,a,l=t(this).resizable("instance"),c=l.options,u=l.element,h=c.containment,g=h instanceof t?h.get(0):/parent/.test(h)?u.parent().get(0):h;g&&(l.containerElement=t(g),/document/.test(h)||h===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:t(document),left:0,top:0,width:t(document).width(),height:t(document).height()||document.body.parentNode.scrollHeight}):(e=t(g),o=[],t(["Top","Right","Left","Bottom"]).each(function(t,n){o[t]=l._num(e.css("padding"+n))}),l.containerOffset=e.offset(),l.containerPosition=e.position(),l.containerSize={height:e.innerHeight()-o[3],width:e.innerWidth()-o[1]},n=l.containerOffset,i=l.containerSize.height,r=l.containerSize.width,s=l._hasScroll(g,"left")?g.scrollWidth:r,a=l._hasScroll(g)?g.scrollHeight:i,l.parentData={element:g,left:n.left,top:n.top,width:s,height:a}))},resize:function(e){var o,n,i,r,s=t(this).resizable("instance"),a=s.options,l=s.containerOffset,c=s.position,u=s._aspectRatio||e.shiftKey,h={top:0,left:0},g=s.containerElement,p=!0;g[0]!==document&&/static/.test(g.css("position"))&&(h=l),c.left<(s._helper?l.left:0)&&(s.size.width=s.size.width+(s._helper?s.position.left-l.left:s.position.left-h.left),u&&(s.size.height=s.size.width/s.aspectRatio,p=!1),s.position.left=a.helper?l.left:0),c.top<(s._helper?l.top:0)&&(s.size.height=s.size.height+(s._helper?s.position.top-l.top:s.position.top),u&&(s.size.width=s.size.height*s.aspectRatio,p=!1),s.position.top=s._helper?l.top:0),i=s.containerElement.get(0)===s.element.parent().get(0),r=/relative|absolute/.test(s.containerElement.css("position")),i&&r?(s.offset.left=s.parentData.left+s.position.left,s.offset.top=s.parentData.top+s.position.top):(s.offset.left=s.element.offset().left,s.offset.top=s.element.offset().top),o=Math.abs(s.sizeDiff.width+(s._helper?s.offset.left-h.left:s.offset.left-l.left)),n=Math.abs(s.sizeDiff.height+(s._helper?s.offset.top-h.top:s.offset.top-l.top)),o+s.size.width>=s.parentData.width&&(s.size.width=s.parentData.width-o,u&&(s.size.height=s.size.width/s.aspectRatio,p=!1)),n+s.size.height>=s.parentData.height&&(s.size.height=s.parentData.height-n,u&&(s.size.width=s.size.height*s.aspectRatio,p=!1)),p||(s.position.left=s.prevPosition.left,s.position.top=s.prevPosition.top,s.size.width=s.prevSize.width,s.size.height=s.prevSize.height)},stop:function(){var e=t(this).resizable("instance"),o=e.options,n=e.containerOffset,i=e.containerPosition,r=e.containerElement,s=t(e.helper),a=s.offset(),l=s.outerWidth()-e.sizeDiff.width,c=s.outerHeight()-e.sizeDiff.height;e._helper&&!o.animate&&/relative/.test(r.css("position"))&&t(this).css({left:a.left-i.left-n.left,width:l,height:c}),e._helper&&!o.animate&&/static/.test(r.css("position"))&&t(this).css({left:a.left-i.left-n.left,width:l,height:c})}}),t.ui.plugin.add("resizable","alsoResize",{start:function(){var e=t(this).resizable("instance"),o=e.options,n=function(e){t(e).each(function(){var e=t(this);e.data("ui-resizable-alsoresize",{width:parseInt(e.width(),10),height:parseInt(e.height(),10),left:parseInt(e.css("left"),10),top:parseInt(e.css("top"),10)})})};"object"!=typeof o.alsoResize||o.alsoResize.parentNode?n(o.alsoResize):o.alsoResize.length?(o.alsoResize=o.alsoResize[0],n(o.alsoResize)):t.each(o.alsoResize,function(t){n(t)})},resize:function(e,o){var n=t(this).resizable("instance"),i=n.options,r=n.originalSize,s=n.originalPosition,a={height:n.size.height-r.height||0,width:n.size.width-r.width||0,top:n.position.top-s.top||0,left:n.position.left-s.left||0},l=function(e,n){t(e).each(function(){var e=t(this),i=t(this).data("ui-resizable-alsoresize"),r={},s=n&&n.length?n:e.parents(o.originalElement[0]).length?["width","height"]:["width","height","top","left"];t.each(s,function(t,e){var o=(i[e]||0)+(a[e]||0);o&&o>=0&&(r[e]=o||null)}),e.css(r)})};"object"!=typeof i.alsoResize||i.alsoResize.nodeType?l(i.alsoResize):t.each(i.alsoResize,function(t,e){l(t,e)})},stop:function(){t(this).removeData("resizable-alsoresize")}}),t.ui.plugin.add("resizable","ghost",{start:function(){var e=t(this).resizable("instance"),o=e.options,n=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:n.height,width:n.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof o.ghost?o.ghost:""),e.ghost.appendTo(e.helper)},resize:function(){var e=t(this).resizable("instance");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=t(this).resizable("instance");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),t.ui.plugin.add("resizable","grid",{resize:function(){var e,o=t(this).resizable("instance"),n=o.options,i=o.size,r=o.originalSize,s=o.originalPosition,a=o.axis,l="number"==typeof n.grid?[n.grid,n.grid]:n.grid,c=l[0]||1,u=l[1]||1,h=Math.round((i.width-r.width)/c)*c,g=Math.round((i.height-r.height)/u)*u,p=r.width+h,d=r.height+g,f=n.maxWidth&&p>n.maxWidth,m=n.maxHeight&&d>n.maxHeight,y=n.minWidth&&n.minWidth>p,v=n.minHeight&&n.minHeight>d;n.grid=l,y&&(p+=c),v&&(d+=u),f&&(p-=c),m&&(d-=u),/^(se|s|e)$/.test(a)?(o.size.width=p,o.size.height=d):/^(ne)$/.test(a)?(o.size.width=p,o.size.height=d,o.position.top=s.top-g):/^(sw)$/.test(a)?(o.size.width=p,o.size.height=d,o.position.left=s.left-h):((0>=d-u||0>=p-c)&&(e=o._getPaddingPlusBorderDimensions(this)),d-u>0?(o.size.height=d,o.position.top=s.top-g):(d=u-e.height,o.size.height=d,o.position.top=s.top+r.height-d),p-c>0?(o.size.width=p,o.position.left=s.left-h):(p=u-e.height,o.size.width=p,o.position.left=s.left+r.width-p))}}),t.ui.resizable,t.widget("ui.sortable",t.ui.mouse,{version:"1.11.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,o){return t>=e&&e+o>t},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){var t=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=!!this.items.length&&("x"===t.axis||this._isFloating(this.items[0].item)),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(t,e){this._super(t,e),"handle"===t&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),t.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(e,o){var n=null,i=!1,r=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(e),t(e.target).parents().each(function(){return t.data(this,r.widgetName+"-item")===r?(n=t(this),!1):void 0}),t.data(e.target,r.widgetName+"-item")===r&&(n=t(e.target)),!!n&&(!(this.options.handle&&!o&&(t(this.options.handle,n).find("*").addBack().each(function(){this===e.target&&(i=!0)}),!i))&&(this.currentItem=n,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(e,o,n){var i,r,s=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,s.cursorAt&&this._adjustOffsetFromHelper(s.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),s.containment&&this._setContainment(),s.cursor&&"auto"!==s.cursor&&(r=this.document.find("body"),this.storedCursor=r.css("cursor"),r.css("cursor",s.cursor),this.storedStylesheet=t("<style>*{ cursor: "+s.cursor+" !important; }</style>").appendTo(r)),s.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",s.opacity)),s.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",s.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!n)for(i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!s.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var o,n,i,r,s=this.options,a=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<s.scrollSensitivity?this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop+s.scrollSpeed:e.pageY-this.overflowOffset.top<s.scrollSensitivity&&(this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop-s.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<s.scrollSensitivity?this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft+s.scrollSpeed:e.pageX-this.overflowOffset.left<s.scrollSensitivity&&(this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft-s.scrollSpeed)):(e.pageY-t(document).scrollTop()<s.scrollSensitivity?a=t(document).scrollTop(t(document).scrollTop()-s.scrollSpeed):t(window).height()-(e.pageY-t(document).scrollTop())<s.scrollSensitivity&&(a=t(document).scrollTop(t(document).scrollTop()+s.scrollSpeed)),e.pageX-t(document).scrollLeft()<s.scrollSensitivity?a=t(document).scrollLeft(t(document).scrollLeft()-s.scrollSpeed):t(window).width()-(e.pageX-t(document).scrollLeft())<s.scrollSensitivity&&(a=t(document).scrollLeft(t(document).scrollLeft()+s.scrollSpeed))),!1!==a&&t.ui.ddmanager&&!s.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),o=this.items.length-1;o>=0;o--)if(n=this.items[o],i=n.item[0],(r=this._intersectsWithPointer(n))&&n.instance===this.currentContainer&&i!==this.currentItem[0]&&this.placeholder[1===r?"next":"prev"]()[0]!==i&&!t.contains(this.placeholder[0],i)&&("semi-dynamic"!==this.options.type||!t.contains(this.element[0],i))){if(this.direction=1===r?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(n))break;this._rearrange(e,n),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,o){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var n=this,i=this.placeholder.offset(),r=this.options.axis,s={};r&&"x"!==r||(s.left=i.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),r&&"y"!==r||(s.top=i.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(s,parseInt(this.options.revert,10)||500,function(){n._clear(e)})}else this._clear(e,o);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var o=this._getItemsAsjQuery(e&&e.connected),n=[];return e=e||{},t(o).each(function(){var o=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);o&&n.push((e.key||o[1]+"[]")+"="+(e.key&&e.expression?o[1]:o[2]))}),!n.length&&e.key&&n.push(e.key+"="),n.join("&")},toArray:function(e){var o=this._getItemsAsjQuery(e&&e.connected),n=[];return e=e||{},o.each(function(){n.push(t(e.item||this).attr(e.attribute||"id")||"")}),n},_intersectsWith:function(t){var e=this.positionAbs.left,o=e+this.helperProportions.width,n=this.positionAbs.top,i=n+this.helperProportions.height,r=t.left,s=r+t.width,a=t.top,l=a+t.height,c=this.offset.click.top,u=this.offset.click.left,h="x"===this.options.axis||n+c>a&&l>n+c,g="y"===this.options.axis||e+u>r&&s>e+u,p=h&&g;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?p:e+this.helperProportions.width/2>r&&s>o-this.helperProportions.width/2&&n+this.helperProportions.height/2>a&&l>i-this.helperProportions.height/2},_intersectsWithPointer:function(t){var e="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),o="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),n=e&&o,i=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return!!n&&(this.floating?r&&"right"===r||"down"===i?2:1:i&&("down"===i?2:1))},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),o=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),n=this._getDragVerticalDirection(),i=this._getDragHorizontalDirection();return this.floating&&i?"right"===i&&o||"left"===i&&!o:n&&("down"===n&&e||"up"===n&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){function o(){a.push(this)}var n,i,r,s,a=[],l=[],c=this._connectWith();if(c&&e)for(n=c.length-1;n>=0;n--)for(r=t(c[n]),i=r.length-1;i>=0;i--)(s=t.data(r[i],this.widgetFullName))&&s!==this&&!s.options.disabled&&l.push([t.isFunction(s.options.items)?s.options.items.call(s.element):t(s.options.items,s.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),s]);for(l.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=l.length-1;n>=0;n--)l[n][0].each(o);return t(a)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,function(t){for(var o=0;e.length>o;o++)if(e[o]===t.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var o,n,i,r,s,a,l,c,u=this.items,h=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],g=this._connectWith();if(g&&this.ready)for(o=g.length-1;o>=0;o--)for(i=t(g[o]),n=i.length-1;n>=0;n--)(r=t.data(i[n],this.widgetFullName))&&r!==this&&!r.options.disabled&&(h.push([t.isFunction(r.options.items)?r.options.items.call(r.element[0],e,{item:this.currentItem}):t(r.options.items,r.element),r]),this.containers.push(r));for(o=h.length-1;o>=0;o--)for(s=h[o][1],a=h[o][0],n=0,c=a.length;c>n;n++)l=t(a[n]),l.data(this.widgetName+"-item",s),u.push({item:l,instance:s,width:0,height:0,left:0,top:0})},refreshPositions:function(e){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var o,n,i,r;for(o=this.items.length-1;o>=0;o--)n=this.items[o],n.instance!==this.currentContainer&&this.currentContainer&&n.item[0]!==this.currentItem[0]||(i=this.options.toleranceElement?t(this.options.toleranceElement,n.item):n.item,e||(n.width=i.outerWidth(),n.height=i.outerHeight()),r=i.offset(),n.left=r.left,n.top=r.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(o=this.containers.length-1;o>=0;o--)r=this.containers[o].element.offset(),this.containers[o].containerCache.left=r.left,this.containers[o].containerCache.top=r.top,this.containers[o].containerCache.width=this.containers[o].element.outerWidth(),this.containers[o].containerCache.height=this.containers[o].element.outerHeight();return this},_createPlaceholder:function(e){e=e||this;var o,n=e.options;n.placeholder&&n.placeholder.constructor!==String||(o=n.placeholder,n.placeholder={element:function(){var n=e.currentItem[0].nodeName.toLowerCase(),i=t("<"+n+">",e.document[0]).addClass(o||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===n?e.currentItem.children().each(function(){t("<td>&#160;</td>",e.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(i)}):"img"===n&&i.attr("src",e.currentItem.attr("src")),o||i.css("visibility","hidden"),i},update:function(t,i){(!o||n.forcePlaceholderSize)&&(i.height()||i.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),i.width()||i.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(n.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),n.placeholder.update(e,e.placeholder)},_contactContainers:function(e){var o,n,i,r,s,a,l,c,u,h,g=null,p=null;for(o=this.containers.length-1;o>=0;o--)if(!t.contains(this.currentItem[0],this.containers[o].element[0]))if(this._intersectsWith(this.containers[o].containerCache)){if(g&&t.contains(this.containers[o].element[0],g.element[0]))continue;g=this.containers[o],p=o}else this.containers[o].containerCache.over&&(this.containers[o]._trigger("out",e,this._uiHash(this)),this.containers[o].containerCache.over=0);if(g)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(i=1e4,r=null,u=g.floating||this._isFloating(this.currentItem),s=u?"left":"top",a=u?"width":"height",h=u?"clientX":"clientY",n=this.items.length-1;n>=0;n--)t.contains(this.containers[p].element[0],this.items[n].item[0])&&this.items[n].item[0]!==this.currentItem[0]&&(l=this.items[n].item.offset()[s],c=!1,e[h]-l>this.items[n][a]/2&&(c=!0),i>Math.abs(e[h]-l)&&(i=Math.abs(e[h]-l),r=this.items[n],this.direction=c?"up":"down"));if(!r&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return void(this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash()),this.currentContainer.containerCache.over=1));r?this._rearrange(e,r,null,!0):this._rearrange(e,null,this.containers[p].element,!0),this._trigger("change",e,this._uiHash()),this.containers[p]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(e){var o=this.options,n=t.isFunction(o.helper)?t(o.helper.apply(this.element[0],[e,this.currentItem])):"clone"===o.helper?this.currentItem.clone():this.currentItem;return n.parents("body").length||t("parent"!==o.appendTo?o.appendTo:this.currentItem[0].parentNode)[0].appendChild(n[0]),n[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!n[0].style.width||o.forceHelperSize)&&n.width(this.currentItem.width()),(!n[0].style.height||o.forceHelperSize)&&n.height(this.currentItem.height()),n},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,o,n,i=this.options;"parent"===i.containment&&(i.containment=this.helper[0].parentNode),("document"===i.containment||"window"===i.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,t("document"===i.containment?document:window).width()-this.helperProportions.width-this.margins.left,(t("document"===i.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(i.containment)||(e=t(i.containment)[0],o=t(i.containment).offset(),n="hidden"!==t(e).css("overflow"),this.containment=[o.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,o.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,o.left+(n?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,o.top+(n?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,o){o||(o=this.position);var n="absolute"===e?1:-1,i="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,r=/(html|body)/i.test(i[0].tagName);return{top:o.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():r?0:i.scrollTop())*n,left:o.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():r?0:i.scrollLeft())*n}},_generatePosition:function(e){var o,n,i=this.options,r=e.pageX,s=e.pageY,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(a[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(r=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(s=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(r=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(s=this.containment[3]+this.offset.click.top)),i.grid&&(o=this.originalPageY+Math.round((s-this.originalPageY)/i.grid[1])*i.grid[1],s=this.containment?o-this.offset.click.top>=this.containment[1]&&o-this.offset.click.top<=this.containment[3]?o:o-this.offset.click.top>=this.containment[1]?o-i.grid[1]:o+i.grid[1]:o,n=this.originalPageX+Math.round((r-this.originalPageX)/i.grid[0])*i.grid[0],r=this.containment?n-this.offset.click.left>=this.containment[0]&&n-this.offset.click.left<=this.containment[2]?n:n-this.offset.click.left>=this.containment[0]?n-i.grid[0]:n+i.grid[0]:n)),{top:s-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:a.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:a.scrollLeft())}},_rearrange:function(t,e,o,n){o?o[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var i=this.counter;this._delay(function(){i===this.counter&&this.refreshPositions(!n)})},_clear:function(t,e){function o(t,e,o){return function(n){o._trigger(t,n,e._uiHash(e))}}this.reverting=!1;var n,i=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)("auto"===this._storedCSS[n]||"static"===this._storedCSS[n])&&(this._storedCSS[n]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&i.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||i.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(i.push(function(t){this._trigger("remove",t,this._uiHash())}),i.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),i.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),n=this.containers.length-1;n>=0;n--)e||i.push(o("deactivate",this,this.containers[n])),this.containers[n].containerCache.over&&(i.push(o("out",this,this.containers[n])),this.containers[n].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!e){for(n=0;i.length>n;n++)i[n].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===t.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(e){var o=e||this;return{helper:o.helper,placeholder:o.placeholder||t([]),position:o.position,originalPosition:o.originalPosition,offset:o.positionAbs,item:o.currentItem,sender:e?e.element:null}}}),t.widget("ui.menu",{version:"1.11.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(t){t.preventDefault()},"click .ui-menu-item":function(e){var o=t(e.target);!this.mouseHandled&&o.not(".ui-state-disabled").length&&(this.select(e),e.isPropagationStopped()||(this.mouseHandled=!0),o.has(".ui-menu").length?this.expand(e):!this.element.is(":focus")&&t(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){if(!this.previousFilter){var o=t(e.currentTarget);o.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(e,o)}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(t,e){var o=this.active||this.element.find(this.options.items).eq(0);e||this.focus(t,o)},blur:function(e){this._delay(function(){t.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(e)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){this._closeOnDocumentClick(t)&&this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var e=t(this);e.data("ui-menu-submenu-carat")&&e.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(e){var o,n,i,r,s=!0;switch(e.keyCode){case t.ui.keyCode.PAGE_UP:this.previousPage(e);break;case t.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case t.ui.keyCode.HOME:this._move("first","first",e);break;case t.ui.keyCode.END:this._move("last","last",e);break;case t.ui.keyCode.UP:this.previous(e);break;case t.ui.keyCode.DOWN:this.next(e);break;case t.ui.keyCode.LEFT:this.collapse(e);break;case t.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case t.ui.keyCode.ENTER:case t.ui.keyCode.SPACE:this._activate(e);break;case t.ui.keyCode.ESCAPE:this.collapse(e);break;default:s=!1,n=this.previousFilter||"",i=String.fromCharCode(e.keyCode),r=!1,clearTimeout(this.filterTimer),i===n?r=!0:i=n+i,o=this._filterMenuItems(i),o=r&&-1!==o.index(this.active.next())?this.active.nextAll(".ui-menu-item"):o,o.length||(i=String.fromCharCode(e.keyCode),o=this._filterMenuItems(i)),o.length?(this.focus(e,o),this.previousFilter=i,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}s&&e.preventDefault()},_activate:function(t){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(t):this.select(t))},refresh:function(){var e,o,n=this,i=this.options.icons.submenu,r=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),r.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=t(this),o=e.parent(),n=t("<span>").addClass("ui-menu-icon ui-icon "+i).data("ui-menu-submenu-carat",!0);o.attr("aria-haspopup","true").prepend(n),e.attr("aria-labelledby",o.attr("id"))}),e=r.add(this.element),o=e.find(this.options.items),o.not(".ui-menu-item").each(function(){var e=t(this);n._isDivider(e)&&e.addClass("ui-widget-content ui-menu-divider")}),o.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),o.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!t.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(t,e){"icons"===t&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(e.submenu),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!e).attr("aria-disabled",e),this._super(t,e)},focus:function(t,e){var o,n;this.blur(t,t&&"focus"===t.type),this._scrollIntoView(e),this.active=e.first(),n=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",n.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),t&&"keydown"===t.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),o=e.children(".ui-menu"),o.length&&t&&/^mouse/.test(t.type)&&this._startOpening(o),this.activeMenu=e.parent(),this._trigger("focus",t,{item:e})},_scrollIntoView:function(e){var o,n,i,r,s,a;this._hasScroll()&&(o=parseFloat(t.css(this.activeMenu[0],"borderTopWidth"))||0,n=parseFloat(t.css(this.activeMenu[0],"paddingTop"))||0,i=e.offset().top-this.activeMenu.offset().top-o-n,r=this.activeMenu.scrollTop(),s=this.activeMenu.height(),a=e.outerHeight(),0>i?this.activeMenu.scrollTop(r+i):i+a>s&&this.activeMenu.scrollTop(r+i-s+a))},blur:function(t,e){e||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",t,{item:this.active}))},_startOpening:function(t){clearTimeout(this.timer),"true"===t.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(t)},this.delay))},_open:function(e){var o=t.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(o)},collapseAll:function(e,o){clearTimeout(this.timer),this.timer=this._delay(function(){var n=o?this.element:t(e&&e.target).closest(this.element.find(".ui-menu"));n.length||(n=this.element),this._close(n),this.blur(e),this.activeMenu=n},this.delay)},_close:function(t){t||(t=this.active?this.active.parent():this.element),t.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(e){return!t(e.target).closest(".ui-menu").length},_isDivider:function(t){return!/[^\-\u2014\u2013\s]/.test(t.text())},collapse:function(t){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();e&&e.length&&(this._open(e.parent()),this._delay(function(){this.focus(t,e)}))},next:function(t){this._move("next","first",t)},previous:function(t){this._move("prev","last",t)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(t,e,o){var n;this.active&&(n="first"===t||"last"===t?this.active["first"===t?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[t+"All"](".ui-menu-item").eq(0)),n&&n.length&&this.active||(n=this.activeMenu.find(this.options.items)[e]()),this.focus(o,n)},nextPage:function(e){var o,n,i;return this.active?void(this.isLastItem()||(this._hasScroll()?(n=this.active.offset().top,i=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return o=t(this),0>o.offset().top-n-i}),this.focus(e,o)):this.focus(e,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))):void this.next(e)},previousPage:function(e){var o,n,i;return this.active?void(this.isFirstItem()||(this._hasScroll()?(n=this.active.offset().top,i=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return o=t(this),o.offset().top-n+i>0}),this.focus(e,o)):this.focus(e,this.activeMenu.find(this.options.items).first()))):void this.next(e)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||t(e.target).closest(".ui-menu-item");var o={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,o)},_filterMenuItems:function(e){var o=e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),n=RegExp("^"+o,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return n.test(t.trim(t(this).text()))})}}),t.widget("ui.autocomplete",{version:"1.11.2",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var e,o,n,i=this.element[0].nodeName.toLowerCase(),r="textarea"===i,s="input"===i;this.isMultiLine=!!r||!s&&this.element.prop("isContentEditable"),this.valueMethod=this.element[r||s?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(i){if(this.element.prop("readOnly"))return e=!0,n=!0,void(o=!0);e=!1,n=!1,o=!1;var r=t.ui.keyCode;switch(i.keyCode){case r.PAGE_UP:e=!0,this._move("previousPage",i);break;case r.PAGE_DOWN:e=!0,this._move("nextPage",i);break;case r.UP:e=!0,this._keyEvent("previous",i);break;case r.DOWN:e=!0,this._keyEvent("next",i);break;case r.ENTER:this.menu.active&&(e=!0,i.preventDefault(),this.menu.select(i));break;case r.TAB:this.menu.active&&this.menu.select(i);break;case r.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(i),i.preventDefault());break;default:o=!0,this._searchTimeout(i)}},keypress:function(n){if(e)return e=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&n.preventDefault());if(!o){var i=t.ui.keyCode;switch(n.keyCode){case i.PAGE_UP:this._move("previousPage",n);break;case i.PAGE_DOWN:this._move("nextPage",n);break;case i.UP:this._keyEvent("previous",n);break;case i.DOWN:this._keyEvent("next",n)}}},input:function(t){return n?(n=!1,void t.preventDefault()):void this._searchTimeout(t)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(t){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(t),void this._change(t))}}),this._initSource(),this.menu=t("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var o=this.menu.element[0];t(e.target).closest(".ui-menu-item").length||this._delay(function(){var e=this;this.document.one("mousedown",function(n){n.target===e.element[0]||n.target===o||t.contains(o,n.target)||e.close()})})},menufocus:function(e,o){var n,i;return this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type))?(this.menu.blur(),void this.document.one("mousemove",function(){t(e.target).trigger(e.originalEvent)})):(i=o.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",e,{item:i})&&e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(i.value),void((n=o.item.attr("aria-label")||i.value)&&t.trim(n).length&&(this.liveRegion.children().hide(),t("<div>").text(n).appendTo(this.liveRegion))))},menuselect:function(t,e){var o=e.item.data("ui-autocomplete-item"),n=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n,this.selectedItem=o})),!1!==this._trigger("select",t,{item:o})&&this._value(o.value),this.term=this._value(),this.close(t),this.selectedItem=o}}),this.liveRegion=t("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(t,e){this._super(t,e),"source"===t&&this._initSource(),"appendTo"===t&&this.menu.element.appendTo(this._appendTo()),"disabled"===t&&e&&this.xhr&&this.xhr.abort()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(".ui-front")),e.length||(e=this.document[0].body),e},_initSource:function(){var e,o,n=this;t.isArray(this.options.source)?(e=this.options.source,this.source=function(o,n){n(t.ui.autocomplete.filter(e,o.term))}):"string"==typeof this.options.source?(o=this.options.source,this.source=function(e,i){n.xhr&&n.xhr.abort(),n.xhr=t.ajax({url:o,data:e,dataType:"json",success:function(t){i(t)},error:function(){i([])}})}):this.source=this.options.source},_searchTimeout:function(t){clearTimeout(this.searching),this.searching=this._delay(function(){var e=this.term===this._value(),o=this.menu.element.is(":visible"),n=t.altKey||t.ctrlKey||t.metaKey||t.shiftKey;(!e||e&&!o&&!n)&&(this.selectedItem=null,this.search(null,t))},this.options.delay)},search:function(t,e){return t=null!=t?t:this._value(),this.term=this._value(),t.length<this.options.minLength?this.close(e):!1!==this._trigger("search",e)?this._search(t):void 0},_search:function(t){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:t},this._response())},_response:function(){var e=++this.requestIndex;return t.proxy(function(t){e===this.requestIndex&&this.__response(t),--this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(t){t&&(t=this._normalize(t)),this._trigger("response",null,{content:t}),!this.options.disabled&&t&&t.length&&!this.cancelSearch?(this._suggest(t),this._trigger("open")):this._close()},close:function(t){this.cancelSearch=!0,this._close(t)},_close:function(t){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",t))},_change:function(t){this.previous!==this._value()&&this._trigger("change",t,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:t.map(e,function(e){return"string"==typeof e?{label:e,value:e}:t.extend({},e,{label:e.label||e.value,value:e.value||e.label})})},_suggest:function(e){var o=this.menu.element.empty();this._renderMenu(o,e),this.isNewMenu=!0,this.menu.refresh(),o.show(),this._resizeMenu(),o.position(t.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var t=this.menu.element;t.outerWidth(Math.max(t.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(e,o){var n=this;t.each(o,function(t,o){n._renderItemData(e,o)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-autocomplete-item",e)},_renderItem:function(e,o){return t("<li>").text(o.label).appendTo(e)},_move:function(t,e){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(t)||this.menu.isLastItem()&&/^next/.test(t)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[t](e):void this.search(null,e)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(t,e){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(t,e),e.preventDefault())}}),t.extend(t.ui.autocomplete,{escapeRegex:function(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,o){var n=RegExp(t.ui.autocomplete.escapeRegex(o),"i");return t.grep(e,function(t){return n.test(t.label||t.value||t)})}}),t.widget("ui.autocomplete",t.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(t){return t+(t>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var o;this._superApply(arguments),this.options.disabled||this.cancelSearch||(o=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.children().hide(),t("<div>").text(o).appendTo(this.liveRegion))}}),t.ui.autocomplete;var s="ui-effects-",a=t;t.effects={effect:{}},function(t,e){function o(t,e,o){var n=u[e.type]||{};return null==t?o||!e.def?null:e.def:(t=n.floor?~~t:parseFloat(t),isNaN(t)?e.def:n.mod?(t+n.mod)%n.mod:0>t?0:t>n.max?n.max:t)}function n(o){var n=l(),i=n._rgba=[];return o=o.toLowerCase(),p(a,function(t,r){var s,a=r.re.exec(o),l=a&&r.parse(a),u=r.space||"rgba";return l?(s=n[u](l),n[c[u].cache]=s[c[u].cache],i=n._rgba=s._rgba,!1):e}),i.length?("0,0,0,0"===i.join()&&t.extend(i,r.transparent),n):r[o]}function i(t,e,o){return o=(o+1)%1,1>6*o?t+6*(e-t)*o:1>2*o?e:2>3*o?t+6*(e-t)*(2/3-o):t}var r,s=/^([\-+])=\s*(\d+\.?\d*)/,a=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(t){return[t[1],t[2]/100,t[3]/100,t[4]]}}],l=t.Color=function(e,o,n,i){return new t.Color.fn.parse(e,o,n,i)},c={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},u={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},h=l.support={},g=t("<p>")[0],p=t.each;g.style.cssText="background-color:rgba(1,1,1,.5)",h.rgba=g.style.backgroundColor.indexOf("rgba")>-1,p(c,function(t,e){e.cache="_"+t,e.props.alpha={idx:3,type:"percent",def:1}}),l.fn=t.extend(l.prototype,{parse:function(i,s,a,u){if(i===e)return this._rgba=[null,null,null,null],this;(i.jquery||i.nodeType)&&(i=t(i).css(s),s=e);var h=this,g=t.type(i),d=this._rgba=[];return s!==e&&(i=[i,s,a,u],g="array"),"string"===g?this.parse(n(i)||r._default):"array"===g?(p(c.rgba.props,function(t,e){d[e.idx]=o(i[e.idx],e)}),this):"object"===g?(i instanceof l?p(c,function(t,e){i[e.cache]&&(h[e.cache]=i[e.cache].slice())}):p(c,function(e,n){var r=n.cache;p(n.props,function(t,e){if(!h[r]&&n.to){if("alpha"===t||null==i[t])return;h[r]=n.to(h._rgba)}h[r][e.idx]=o(i[t],e,!0)}),h[r]&&0>t.inArray(null,h[r].slice(0,3))&&(h[r][3]=1,n.from&&(h._rgba=n.from(h[r])))}),this):e},is:function(t){var o=l(t),n=!0,i=this;return p(c,function(t,r){var s,a=o[r.cache];return a&&(s=i[r.cache]||r.to&&r.to(i._rgba)||[],p(r.props,function(t,o){return null!=a[o.idx]?n=a[o.idx]===s[o.idx]:e})),n}),n},_space:function(){var t=[],e=this;return p(c,function(o,n){e[n.cache]&&t.push(o)}),t.pop()},transition:function(t,e){var n=l(t),i=n._space(),r=c[i],s=0===this.alpha()?l("transparent"):this,a=s[r.cache]||r.to(s._rgba),h=a.slice();return n=n[r.cache],p(r.props,function(t,i){var r=i.idx,s=a[r],l=n[r],c=u[i.type]||{};null!==l&&(null===s?h[r]=l:(c.mod&&(l-s>c.mod/2?s+=c.mod:s-l>c.mod/2&&(s-=c.mod)),h[r]=o((l-s)*e+s,i)))}),this[i](h)},blend:function(e){if(1===this._rgba[3])return this;var o=this._rgba.slice(),n=o.pop(),i=l(e)._rgba;return l(t.map(o,function(t,e){return(1-n)*i[e]+n*t}))},toRgbaString:function(){var e="rgba(",o=t.map(this._rgba,function(t,e){return null==t?e>2?1:0:t});return 1===o[3]&&(o.pop(),e="rgb("),e+o.join()+")"},toHslaString:function(){var e="hsla(",o=t.map(this.hsla(),function(t,e){return null==t&&(t=e>2?1:0),e&&3>e&&(t=Math.round(100*t)+"%"),t});return 1===o[3]&&(o.pop(),e="hsl("),e+o.join()+")"},toHexString:function(e){var o=this._rgba.slice(),n=o.pop();return e&&o.push(~~(255*n)),"#"+t.map(o,function(t){return t=(t||0).toString(16),1===t.length?"0"+t:t}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),l.fn.parse.prototype=l.fn,c.hsla.to=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e,o,n=t[0]/255,i=t[1]/255,r=t[2]/255,s=t[3],a=Math.max(n,i,r),l=Math.min(n,i,r),c=a-l,u=a+l,h=.5*u;return e=l===a?0:n===a?60*(i-r)/c+360:i===a?60*(r-n)/c+120:60*(n-i)/c+240,o=0===c?0:.5>=h?c/u:c/(2-u),[Math.round(e)%360,o,h,null==s?1:s]},c.hsla.from=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/360,o=t[1],n=t[2],r=t[3],s=.5>=n?n*(1+o):n+o-n*o,a=2*n-s;return[Math.round(255*i(a,s,e+1/3)),Math.round(255*i(a,s,e)),Math.round(255*i(a,s,e-1/3)),r]},p(c,function(n,i){var r=i.props,a=i.cache,c=i.to,u=i.from;l.fn[n]=function(n){if(c&&!this[a]&&(this[a]=c(this._rgba)),n===e)return this[a].slice();var i,s=t.type(n),h="array"===s||"object"===s?n:arguments,g=this[a].slice();return p(r,function(t,e){var n=h["object"===s?t:e.idx];null==n&&(n=g[e.idx]),g[e.idx]=o(n,e)}),u?(i=l(u(g)),i[a]=g,i):l(g)},p(r,function(e,o){l.fn[e]||(l.fn[e]=function(i){var r,a=t.type(i),l="alpha"===e?this._hsla?"hsla":"rgba":n,c=this[l](),u=c[o.idx];return"undefined"===a?u:("function"===a&&(i=i.call(this,u),a=t.type(i)),null==i&&o.empty?this:("string"===a&&(r=s.exec(i))&&(i=u+parseFloat(r[2])*("+"===r[1]?1:-1)),c[o.idx]=i,this[l](c)))})})}),l.hook=function(e){var o=e.split(" ");p(o,function(e,o){t.cssHooks[o]={set:function(e,i){var r,s,a="";if("transparent"!==i&&("string"!==t.type(i)||(r=n(i)))){if(i=l(r||i),!h.rgba&&1!==i._rgba[3]){for(s="backgroundColor"===o?e.parentNode:e;(""===a||"transparent"===a)&&s&&s.style;)try{a=t.css(s,"backgroundColor"),s=s.parentNode}catch(t){}i=i.blend(a&&"transparent"!==a?a:"_default")}i=i.toRgbaString()}try{e.style[o]=i}catch(t){}}},t.fx.step[o]=function(e){e.colorInit||(e.start=l(e.elem,o),e.end=l(e.end),e.colorInit=!0),t.cssHooks[o].set(e.elem,e.start.transition(e.end,e.pos))}})},l.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor"),t.cssHooks.borderColor={expand:function(t){var e={};return p(["Top","Right","Bottom","Left"],function(o,n){e["border"+n+"Color"]=t}),e}},r=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(a),function(){function e(e){var o,n,i=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,r={};if(i&&i.length&&i[0]&&i[i[0]])for(n=i.length;n--;)o=i[n],"string"==typeof i[o]&&(r[t.camelCase(o)]=i[o]);else for(o in i)"string"==typeof i[o]&&(r[o]=i[o]);return r}function o(e,o){var n,r,s={};for(n in o)r=o[n],e[n]!==r&&(i[n]||(t.fx.step[n]||!isNaN(parseFloat(r)))&&(s[n]=r));return s}var n=["add","remove","toggle"],i={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};t.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(e,o){t.fx.step[o]=function(t){("none"!==t.end&&!t.setAttr||1===t.pos&&!t.setAttr)&&(a.style(t.elem,o,t.end),t.setAttr=!0)}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t.effects.animateClass=function(i,r,s,a){var l=t.speed(r,s,a);return this.queue(function(){var r,s=t(this),a=s.attr("class")||"",c=l.children?s.find("*").addBack():s;c=c.map(function(){return{el:t(this),start:e(this)}}),r=function(){t.each(n,function(t,e){i[e]&&s[e+"Class"](i[e])})},r(),c=c.map(function(){return this.end=e(this.el[0]),this.diff=o(this.start,this.end),this}),s.attr("class",a),c=c.map(function(){var e=this,o=t.Deferred(),n=t.extend({},l,{queue:!1,complete:function(){o.resolve(e)}});return this.el.animate(this.diff,n),o.promise()}),t.when.apply(t,c.get()).done(function(){r(),t.each(arguments,function(){var e=this.el;t.each(this.diff,function(t){e.css(t,"")})}),l.complete.call(s[0])})})},t.fn.extend({addClass:function(e){return function(o,n,i,r){return n?t.effects.animateClass.call(this,{add:o},n,i,r):e.apply(this,arguments)}}(t.fn.addClass),removeClass:function(e){return function(o,n,i,r){return arguments.length>1?t.effects.animateClass.call(this,{remove:o},n,i,r):e.apply(this,arguments)}}(t.fn.removeClass),toggleClass:function(e){return function(o,n,i,r,s){return"boolean"==typeof n||void 0===n?i?t.effects.animateClass.call(this,n?{add:o}:{remove:o},i,r,s):e.apply(this,arguments):t.effects.animateClass.call(this,{toggle:o},n,i,r)}}(t.fn.toggleClass),switchClass:function(e,o,n,i,r){return t.effects.animateClass.call(this,{add:o,remove:e},n,i,r)}})}(),function(){function e(e,o,n,i){return t.isPlainObject(e)&&(o=e,e=e.effect),e={effect:e},null==o&&(o={}),t.isFunction(o)&&(i=o,n=null,o={}),("number"==typeof o||t.fx.speeds[o])&&(i=n,n=o,o={}),t.isFunction(n)&&(i=n,n=null),o&&t.extend(e,o),n=n||o.duration,e.duration=t.fx.off?0:"number"==typeof n?n:n in t.fx.speeds?t.fx.speeds[n]:t.fx.speeds._default,e.complete=i||o.complete,e}function o(e){return!(e&&"number"!=typeof e&&!t.fx.speeds[e])||("string"==typeof e&&!t.effects.effect[e]||(!!t.isFunction(e)||"object"==typeof e&&!e.effect))}t.extend(t.effects,{version:"1.11.2",save:function(t,e){for(var o=0;e.length>o;o++)null!==e[o]&&t.data(s+e[o],t[0].style[e[o]])},restore:function(t,e){var o,n;for(n=0;e.length>n;n++)null!==e[n]&&(o=t.data(s+e[n]),void 0===o&&(o=""),t.css(e[n],o))},setMode:function(t,e){return"toggle"===e&&(e=t.is(":hidden")?"show":"hide"),e},getBaseline:function(t,e){var o,n;switch(t[0]){case"top":o=0;break;case"middle":o=.5;break;case"bottom":o=1;break;default:o=t[0]/e.height}switch(t[1]){case"left":n=0;break;case"center":n=.5;break;case"right":n=1;break;default:n=t[1]/e.width}return{x:n,y:o}},createWrapper:function(e){if(e.parent().is(".ui-effects-wrapper"))return e.parent();var o={width:e.outerWidth(!0),height:e.outerHeight(!0),float:e.css("float")},n=t("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),i={width:e.width(),height:e.height()},r=document.activeElement;try{r.id}catch(t){r=document.body}return e.wrap(n),(e[0]===r||t.contains(e[0],r))&&t(r).focus(),n=e.parent(),"static"===e.css("position")?(n.css({position:"relative"}),e.css({position:"relative"})):(t.extend(o,{position:e.css("position"),zIndex:e.css("z-index")}),t.each(["top","left","bottom","right"],function(t,n){o[n]=e.css(n),isNaN(parseInt(o[n],10))&&(o[n]="auto")}),e.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),e.css(i),n.css(o).show()},removeWrapper:function(e){var o=document.activeElement;return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),(e[0]===o||t.contains(e[0],o))&&t(o).focus()),e},setTransition:function(e,o,n,i){return i=i||{},t.each(o,function(t,o){var r=e.cssUnit(o);r[0]>0&&(i[o]=r[0]*n+r[1])}),i}}),t.fn.extend({effect:function(){function o(e){function o(){t.isFunction(r)&&r.call(i[0]),t.isFunction(e)&&e()}var i=t(this),r=n.complete,a=n.mode;(i.is(":hidden")?"hide"===a:"show"===a)?(i[a](),o()):s.call(i[0],n,o)}var n=e.apply(this,arguments),i=n.mode,r=n.queue,s=t.effects.effect[n.effect];return t.fx.off||!s?i?this[i](n.duration,n.complete):this.each(function(){n.complete&&n.complete.call(this)}):!1===r?this.each(o):this.queue(r||"fx",o)},show:function(t){return function(n){if(o(n))return t.apply(this,arguments);var i=e.apply(this,arguments);return i.mode="show",this.effect.call(this,i)}}(t.fn.show),hide:function(t){return function(n){if(o(n))return t.apply(this,arguments);var i=e.apply(this,arguments);return i.mode="hide",this.effect.call(this,i)}}(t.fn.hide),toggle:function(t){return function(n){if(o(n)||"boolean"==typeof n)return t.apply(this,arguments);var i=e.apply(this,arguments);return i.mode="toggle",this.effect.call(this,i)}}(t.fn.toggle),cssUnit:function(e){var o=this.css(e),n=[];return t.each(["em","px","%","pt"],function(t,e){o.indexOf(e)>0&&(n=[parseFloat(o),e])}),n}})}(),function(){var e={};t.each(["Quad","Cubic","Quart","Quint","Expo"],function(t,o){e[o]=function(e){return Math.pow(e,t+2)}}),t.extend(e,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,o=4;((e=Math.pow(2,--o))-1)/11>t;);return 1/Math.pow(4,3-o)-7.5625*Math.pow((3*e-2)/22-t,2)}}),t.each(e,function(e,o){t.easing["easeIn"+e]=o,t.easing["easeOut"+e]=function(t){return 1-o(1-t)},t.easing["easeInOut"+e]=function(t){return.5>t?o(2*t)/2:1-o(-2*t+2)/2}})}(),t.effects})},function(t,e,o){(function(n){var i,r,i,s,r;/*!
* Velocity.js: Accelerated JavaScript animation.
* @version 0.11.2
* @docs http://VelocityJS.org
* @license Copyright 2014 Julian Shapiro. MIT License: http://en.wikipedia.org/wiki/MIT_License
*/
!function(n){window.Velocity?(i=n,void 0!==(r="function"==typeof i?i.call(e,o,e,t):i)&&(t.exports=r)):(s=[o(0)],i=n,void 0!==(r="function"==typeof i?i.apply(e,s):i)&&(t.exports=r))}(function(t){return function(e,o,n,i){function r(t){for(var e=-1,o=t?t.length:0,n=[];++e<o;){var i=t[e];i&&n.push(i)}return n}function s(t){var e=h.data(t,g);return null===e?i:e}function a(t){return function(e){return Math.round(e*t)*(1/t)}}function l(t,e){var o=t;return v.isString(t)?_.Easings[t]||(o=!1):o=v.isArray(t)&&1===t.length?a.apply(null,t):v.isArray(t)&&2===t.length?E.apply(null,t.concat([e])):!(!v.isArray(t)||4!==t.length)&&b.apply(null,t),!1===o&&(o=_.Easings[_.defaults.easing]?_.defaults.easing:d),o}function c(t){if(t)for(var e=(new Date).getTime(),o=0,n=_.State.calls.length;n>o;o++)if(_.State.calls[o]){var r=_.State.calls[o],a=r[0],l=r[2],h=r[3];h||(h=_.State.calls[o][3]=e-16);for(var g=Math.min((e-h)/l.duration,1),p=0,d=a.length;d>p;p++){var f=a[p],m=f.element;if(s(m)){var b=!1;l.display&&"none"!==l.display&&x.setPropertyValue(m,"display",l.display),l.visibility&&"hidden"!==l.visibility&&x.setPropertyValue(m,"visibility",l.visibility);for(var E in f)if("element"!==E){var S,T=f[E],w=v.isString(T.easing)?_.Easings[T.easing]:T.easing;if(S=1===g?T.endValue:T.startValue+(T.endValue-T.startValue)*w(g),T.currentValue=S,x.Hooks.registered[E]){var C=x.Hooks.getRoot(E),k=s(m).rootPropertyValueCache[C];k&&(T.rootPropertyValue=k)}var A=x.setPropertyValue(m,E,T.currentValue+(0===parseFloat(S)?"":T.unitType),T.rootPropertyValue,T.scrollData);x.Hooks.registered[E]&&(s(m).rootPropertyValueCache[C]=x.Normalizations.registered[C]?x.Normalizations.registered[C]("extract",null,A[1]):A[1]),"transform"===A[0]&&(b=!0)}l.mobileHA&&s(m).transformCache.translate3d===i&&(s(m).transformCache.translate3d="(0px, 0px, 0px)",b=!0),b&&x.flushTransformCache(m)}}l.display&&"none"!==l.display&&(_.State.calls[o][2].display=!1),l.visibility&&"hidden"!==l.visibility&&(_.State.calls[o][2].visibility=!1),l.progress&&l.progress.call(r[1],r[1],g,Math.max(0,h+l.duration-e),h),1===g&&u(o)}_.State.isTicking&&(_.mock?c(!0):y(c))}function u(t,e){if(!_.State.calls[t])return!1;for(var o=_.State.calls[t][0],n=_.State.calls[t][1],r=_.State.calls[t][2],a=_.State.calls[t][4],l=!1,c=0,u=o.length;u>c;c++){var g=o[c].element;if(e||r.loop||("none"===r.display&&x.setPropertyValue(g,"display",r.display),"hidden"===r.visibility&&x.setPropertyValue(g,"visibility",r.visibility)),(h.queue(g)[1]===i||!/\.velocityQueueEntryFlag/i.test(h.queue(g)[1]))&&s(g)){s(g).isAnimating=!1,s(g).rootPropertyValueCache={};var p=!1;h.each(s(g).transformCache,function(t,e){var o=/^scale/.test(t)?1:0;new RegExp("^\\("+o+"[^.]").test(e)&&(p=!0,delete s(g).transformCache[t])}),r.mobileHA&&(p=!0,delete s(g).transformCache.translate3d),p&&x.flushTransformCache(g),x.Values.removeClass(g,"velocity-animating")}if(!e&&r.complete&&!r.loop&&c===u-1)try{r.complete.call(n,n)}catch(t){setTimeout(function(){throw t},1)}a&&!0!==r.loop&&a(n),!0!==r.loop||e||_.animate(g,"reverse",{loop:!0,delay:r.delay}),!1!==r.queue&&h.dequeue(g,r.queue)}_.State.calls[t]=!1;for(var d=0,f=_.State.calls.length;f>d;d++)if(!1!==_.State.calls[d]){l=!0;break}!1===l&&(_.State.isTicking=!1,delete _.State.calls,_.State.calls=[])}var h,g="velocity",p=400,d="swing",f=function(){if(n.documentMode)return n.documentMode;for(var t=7;t>4;t--){var e=n.createElement("div");if(e.innerHTML="\x3c!--[if IE "+t+"]><span></span><![endif]--\x3e",e.getElementsByTagName("span").length)return e=null,t}return i}(),m=function(){var t=0;return o.webkitRequestAnimationFrame||o.mozRequestAnimationFrame||function(e){var o,n=(new Date).getTime();return o=Math.max(0,16-(n-t)),t=n+o,setTimeout(function(){e(n+o)},o)}}(),y=o.requestAnimationFrame||m,v={isString:function(t){return"string"==typeof t},isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)},isNode:function(t){return t&&t.nodeType},isNodeList:function(t){return"object"==typeof t&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(Object.prototype.toString.call(t))&&t.length!==i&&(0===t.length||"object"==typeof t[0]&&t[0].nodeType>0)},isWrapped:function(t){return t&&(t.jquery||o.Zepto&&o.Zepto.zepto.isZ(t))},isSVG:function(t){return o.SVGElement&&t instanceof SVGElement},isEmptyObject:function(t){var e;for(e in t)return!1;return!0}};if(t&&t.fn!==i?h=t:o.Velocity&&o.Velocity.Utilities&&(h=o.Velocity.Utilities),!h)throw new Error("Velocity: Either jQuery or Velocity's jQuery shim must first be loaded.");if(e.Velocity!==i&&e.Velocity.Utilities==i)throw new Error("Velocity: Namespace is occupied.");if(7>=f){if(t)return void(t.fn.velocity=t.fn.animate);throw new Error("Velocity: For IE<=7, Velocity falls back to jQuery, which must first be loaded.")}if(8===f&&!t)throw new Error("Velocity: For IE8, Velocity requires jQuery proper to be loaded; Velocity's jQuery shim does not work with IE8.");var _={State:{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isAndroid:/Android/i.test(navigator.userAgent),isGingerbread:/Android 2\.3\.[3-7]/i.test(navigator.userAgent),isChrome:o.chrome,isFirefox:/Firefox/i.test(navigator.userAgent),prefixElement:n.createElement("div"),prefixMatches:{},scrollAnchor:null,scrollPropertyLeft:null,scrollPropertyTop:null,isTicking:!1,calls:[]},CSS:{},Utilities:h,Sequences:{},Easings:{},Promise:o.Promise,defaults:{queue:"",duration:p,easing:d,begin:null,complete:null,progress:null,display:null,loop:!1,delay:!1,mobileHA:!0,_cacheValues:!0},init:function(t){h.data(t,g,{isSVG:v.isSVG(t),isAnimating:!1,computedStyle:null,tweensContainer:null,rootPropertyValueCache:{},transformCache:{}})},animate:function(){},hook:function(t,e,o){var n=i;return v.isWrapped(t)&&(t=[].slice.call(t)),h.each(v.isNode(t)?[t]:t,function(t,r){if(s(r)===i&&_.init(r),o===i)n===i&&(n=_.CSS.getPropertyValue(r,e));else{var a=_.CSS.setPropertyValue(r,e,o);"transform"===a[0]&&_.CSS.flushTransformCache(r),n=a}}),n},mock:!1,version:{major:0,minor:11,patch:2},debug:!1};o.pageYOffset!==i?(_.State.scrollAnchor=o,_.State.scrollPropertyLeft="pageXOffset",_.State.scrollPropertyTop="pageYOffset"):(_.State.scrollAnchor=n.documentElement||n.body.parentNode||n.body,_.State.scrollPropertyLeft="scrollLeft",_.State.scrollPropertyTop="scrollTop");var b=function(){function t(t,e){return 1-3*e+3*t}function e(t,e){return 3*e-6*t}function o(t){return 3*t}function n(n,i,r){return((t(i,r)*n+e(i,r))*n+o(i))*n}function i(n,i,r){return 3*t(i,r)*n*n+2*e(i,r)*n+o(i)}return function(t,e,o,r){function s(e){for(var r=e,s=0;8>s;++s){var a=i(r,t,o);if(0===a)return r;r-=(n(r,t,o)-e)/a}return r}if(4!==arguments.length)return!1;for(var a=0;4>a;++a)if("number"!=typeof arguments[a]||isNaN(arguments[a])||!isFinite(arguments[a]))return!1;return t=Math.min(t,1),o=Math.min(o,1),t=Math.max(t,0),o=Math.max(o,0),function(i){return t===e&&o===r?i:n(s(i),e,r)}}}(),E=function(){function t(t){return-t.tension*t.x-t.friction*t.v}function e(e,o,n){var i={x:e.x+n.dx*o,v:e.v+n.dv*o,tension:e.tension,friction:e.friction};return{dx:i.v,dv:t(i)}}function o(o,n){var i={dx:o.v,dv:t(o)},r=e(o,.5*n,i),s=e(o,.5*n,r),a=e(o,n,s),l=1/6*(i.dx+2*(r.dx+s.dx)+a.dx),c=1/6*(i.dv+2*(r.dv+s.dv)+a.dv);return o.x=o.x+l*n,o.v=o.v+c*n,o}return function t(e,n,i){var r,s,a,l={x:-1,v:0,tension:null,friction:null},c=[0],u=0;for(e=parseFloat(e)||500,n=parseFloat(n)||20,i=i||null,l.tension=e,l.friction=n,r=null!==i,r?(u=t(e,n),s=u/i*.016):s=.016;a=o(a||l,s),c.push(1+a.x),u+=16,Math.abs(a.x)>1e-4&&Math.abs(a.v)>1e-4;);return r?function(t){return c[t*(c.length-1)|0]}:u}}();!function(){_.Easings.linear=function(t){return t},_.Easings.swing=function(t){return.5-Math.cos(t*Math.PI)/2},_.Easings.spring=function(t){return 1-Math.cos(4.5*t*Math.PI)*Math.exp(6*-t)},_.Easings.ease=b(.25,.1,.25,1),_.Easings["ease-in"]=b(.42,0,1,1),_.Easings["ease-out"]=b(0,0,.58,1),_.Easings["ease-in-out"]=b(.42,0,.58,1);var t={};h.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,o){t[o]=function(t){return Math.pow(t,e+2)}}),h.extend(t,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,o=4;t<((e=Math.pow(2,--o))-1)/11;);return 1/Math.pow(4,3-o)-7.5625*Math.pow((3*e-2)/22-t,2)}}),h.each(t,function(t,e){_.Easings["easeIn"+t]=e,_.Easings["easeOut"+t]=function(t){return 1-e(1-t)},_.Easings["easeInOut"+t]=function(t){return.5>t?e(2*t)/2:1-e(-2*t+2)/2}})}();var x=_.CSS={RegEx:{isHex:/^#([A-f\d]{3}){1,2}$/i,valueUnwrap:/^[A-z]+\((.*)\)$/i,wrappedValueAlreadyExtracted:/[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,valueSplit:/([A-z]+\(.+\))|(([A-z0-9#-.]+?)(?=\s|$))/gi},Lists:{colors:["fill","stroke","stopColor","color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","outlineColor"],transformsBase:["translateX","translateY","scale","scaleX","scaleY","skewX","skewY","rotateZ"],transforms3D:["transformPerspective","translateZ","scaleZ","rotateX","rotateY"]},Hooks:{templates:{textShadow:["Color X Y Blur","black 0px 0px 0px"],boxShadow:["Color X Y Blur Spread","black 0px 0px 0px 0px"],clip:["Top Right Bottom Left","0px 0px 0px 0px"],backgroundPosition:["X Y","0% 0%"],transformOrigin:["X Y Z","50% 50% 0px"],perspectiveOrigin:["X Y","50% 50%"]},registered:{},register:function(){for(var t=0;t<x.Lists.colors.length;t++)x.Hooks.templates[x.Lists.colors[t]]=["Red Green Blue Alpha","255 255 255 1"];var e,o,n;if(f)for(e in x.Hooks.templates){o=x.Hooks.templates[e],n=o[0].split(" ");var i=o[1].match(x.RegEx.valueSplit);"Color"===n[0]&&(n.push(n.shift()),i.push(i.shift()),x.Hooks.templates[e]=[n.join(" "),i.join(" ")])}for(e in x.Hooks.templates){o=x.Hooks.templates[e],n=o[0].split(" ");for(var t in n){var r=e+n[t],s=t;x.Hooks.registered[r]=[e,s]}}},getRoot:function(t){var e=x.Hooks.registered[t];return e?e[0]:t},cleanRootPropertyValue:function(t,e){return x.RegEx.valueUnwrap.test(e)&&(e=e.match(x.Hooks.RegEx.valueUnwrap)[1]),x.Values.isCSSNullValue(e)&&(e=x.Hooks.templates[t][1]),e},extractValue:function(t,e){var o=x.Hooks.registered[t];if(o){var n=o[0],i=o[1];return e=x.Hooks.cleanRootPropertyValue(n,e),e.toString().match(x.RegEx.valueSplit)[i]}return e},injectValue:function(t,e,o){var n=x.Hooks.registered[t];if(n){var i,r=n[0],s=n[1];return o=x.Hooks.cleanRootPropertyValue(r,o),i=o.toString().match(x.RegEx.valueSplit),i[s]=e,i.join(" ")}return o}},Normalizations:{registered:{clip:function(t,e,o){switch(t){case"name":return"clip";case"extract":var n;return x.RegEx.wrappedValueAlreadyExtracted.test(o)?n=o:(n=o.toString().match(x.RegEx.valueUnwrap),n=n?n[1].replace(/,(\s+)?/g," "):o),n;case"inject":return"rect("+o+")"}},opacity:function(t,e,o){if(8>=f)switch(t){case"name":return"filter";case"extract":var n=o.toString().match(/alpha\(opacity=(.*)\)/i);return o=n?n[1]/100:1;case"inject":return e.style.zoom=1,parseFloat(o)>=1?"":"alpha(opacity="+parseInt(100*parseFloat(o),10)+")"}else switch(t){case"name":return"opacity";case"extract":case"inject":return o}}},register:function(){9>=f||_.State.isGingerbread||(x.Lists.transformsBase=x.Lists.transformsBase.concat(x.Lists.transforms3D));for(var t=0;t<x.Lists.transformsBase.length;t++)!function(){var e=x.Lists.transformsBase[t];x.Normalizations.registered[e]=function(t,o,n){switch(t){case"name":return"transform";case"extract":return s(o)===i||s(o).transformCache[e]===i?/^scale/i.test(e)?1:0:s(o).transformCache[e].replace(/[()]/g,"");case"inject":var r=!1;switch(e.substr(0,e.length-1)){case"translate":r=!/(%|px|em|rem|vw|vh|\d)$/i.test(n);break;case"scal":case"scale":_.State.isAndroid&&s(o).transformCache[e]===i&&1>n&&(n=1),r=!/(\d)$/i.test(n);break;case"skew":r=!/(deg|\d)$/i.test(n);break;case"rotate":r=!/(deg|\d)$/i.test(n)}return r||(s(o).transformCache[e]="("+n+")"),s(o).transformCache[e]}}}();for(var t=0;t<x.Lists.colors.length;t++)!function(){var e=x.Lists.colors[t];x.Normalizations.registered[e]=function(t,o,n){switch(t){case"name":return e;case"extract":var r;if(x.RegEx.wrappedValueAlreadyExtracted.test(n))r=n;else{var s,a={black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",red:"rgb(255, 0, 0)",white:"rgb(255, 255, 255)"};/^[A-z]+$/i.test(n)?s=a[n]!==i?a[n]:a.black:x.RegEx.isHex.test(n)?s="rgb("+x.Values.hexToRgb(n).join(" ")+")":/^rgba?\(/i.test(n)||(s=a.black),r=(s||n).toString().match(x.RegEx.valueUnwrap)[1].replace(/,(\s+)?/g," ")}return 8>=f||3!==r.split(" ").length||(r+=" 1"),r;case"inject":return 8>=f?4===n.split(" ").length&&(n=n.split(/\s+/).slice(0,3).join(" ")):3===n.split(" ").length&&(n+=" 1"),(8>=f?"rgb":"rgba")+"("+n.replace(/\s+/g,",").replace(/\.(\d)+(?=,)/g,"")+")"}}}()}},Names:{camelCase:function(t){return t.replace(/-(\w)/g,function(t,e){return e.toUpperCase()})},SVGAttribute:function(t){var e="width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2";return(f||_.State.isAndroid&&!_.State.isChrome)&&(e+="|transform"),new RegExp("^("+e+")$","i").test(t)},prefixCheck:function(t){if(_.State.prefixMatches[t])return[_.State.prefixMatches[t],!0];for(var e=["","Webkit","Moz","ms","O"],o=0,n=e.length;n>o;o++){var i;if(i=0===o?t:e[o]+t.replace(/^\w/,function(t){return t.toUpperCase()}),v.isString(_.State.prefixElement.style[i]))return _.State.prefixMatches[t]=i,[i,!0]}return[t,!1]}},Values:{hexToRgb:function(t){var e,o=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;return t=t.replace(o,function(t,e,o,n){return e+e+o+o+n+n}),e=n.exec(t),e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[0,0,0]},isCSSNullValue:function(t){return 0==t||/^(none|auto|transparent|(rgba\(0, ?0, ?0, ?0\)))$/i.test(t)},getUnitType:function(t){return/^(rotate|skew)/i.test(t)?"deg":/(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(t)?"":"px"},getDisplayType:function(t){var e=t.tagName.toString().toLowerCase();return/^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(e)?"inline":/^(li)$/i.test(e)?"list-item":/^(tr)$/i.test(e)?"table-row":"block"},addClass:function(t,e){t.classList?t.classList.add(e):t.className+=(t.className.length?" ":"")+e},removeClass:function(t,e){t.classList?t.classList.remove(e):t.className=t.className.toString().replace(new RegExp("(^|\\s)"+e.split(" ").join("|")+"(\\s|$)","gi")," ")}},getPropertyValue:function(t,e,n,r){function a(t,e){function n(){c&&x.setPropertyValue(t,"display","none")}var l=0;if(8>=f)l=h.css(t,e);else{var c=!1;if(/^(width|height)$/.test(e)&&0===x.getPropertyValue(t,"display")&&(c=!0,x.setPropertyValue(t,"display",x.Values.getDisplayType(t))),!r){if("height"===e&&"border-box"!==x.getPropertyValue(t,"boxSizing").toString().toLowerCase()){var u=t.offsetHeight-(parseFloat(x.getPropertyValue(t,"borderTopWidth"))||0)-(parseFloat(x.getPropertyValue(t,"borderBottomWidth"))||0)-(parseFloat(x.getPropertyValue(t,"paddingTop"))||0)-(parseFloat(x.getPropertyValue(t,"paddingBottom"))||0);return n(),u}if("width"===e&&"border-box"!==x.getPropertyValue(t,"boxSizing").toString().toLowerCase()){var g=t.offsetWidth-(parseFloat(x.getPropertyValue(t,"borderLeftWidth"))||0)-(parseFloat(x.getPropertyValue(t,"borderRightWidth"))||0)-(parseFloat(x.getPropertyValue(t,"paddingLeft"))||0)-(parseFloat(x.getPropertyValue(t,"paddingRight"))||0);return n(),g}}var p;p=s(t)===i?o.getComputedStyle(t,null):s(t).computedStyle?s(t).computedStyle:s(t).computedStyle=o.getComputedStyle(t,null),(f||_.State.isFirefox)&&"borderColor"===e&&(e="borderTopColor"),l=9===f&&"filter"===e?p.getPropertyValue(e):p[e],(""===l||null===l)&&(l=t.style[e]),n()}if("auto"===l&&/^(top|right|bottom|left)$/i.test(e)){var d=a(t,"position");("fixed"===d||"absolute"===d&&/top|left/i.test(e))&&(l=h(t).position()[e]+"px")}return l}var l;if(x.Hooks.registered[e]){var c=e,u=x.Hooks.getRoot(c);n===i&&(n=x.getPropertyValue(t,x.Names.prefixCheck(u)[0])),x.Normalizations.registered[u]&&(n=x.Normalizations.registered[u]("extract",t,n)),l=x.Hooks.extractValue(c,n)}else if(x.Normalizations.registered[e]){var g,p;g=x.Normalizations.registered[e]("name",t),"transform"!==g&&(p=a(t,x.Names.prefixCheck(g)[0]),x.Values.isCSSNullValue(p)&&x.Hooks.templates[e]&&(p=x.Hooks.templates[e][1])),l=x.Normalizations.registered[e]("extract",t,p)}return/^[\d-]/.test(l)||(l=s(t)&&s(t).isSVG&&x.Names.SVGAttribute(e)?/^(height|width)$/i.test(e)?t.getBBox()[e]:t.getAttribute(e):a(t,x.Names.prefixCheck(e)[0])),x.Values.isCSSNullValue(l)&&(l=0),_.debug>=2&&console.log("Get "+e+": "+l),l},setPropertyValue:function(t,e,n,i,r){var a=e;if("scroll"===e)r.container?r.container["scroll"+r.direction]=n:"Left"===r.direction?o.scrollTo(n,r.alternateValue):o.scrollTo(r.alternateValue,n);else if(x.Normalizations.registered[e]&&"transform"===x.Normalizations.registered[e]("name",t))x.Normalizations.registered[e]("inject",t,n),a="transform",n=s(t).transformCache[e];else{if(x.Hooks.registered[e]){var l=e,c=x.Hooks.getRoot(e);i=i||x.getPropertyValue(t,c),n=x.Hooks.injectValue(l,n,i),e=c}if(x.Normalizations.registered[e]&&(n=x.Normalizations.registered[e]("inject",t,n),e=x.Normalizations.registered[e]("name",t)),a=x.Names.prefixCheck(e)[0],8>=f)try{t.style[a]=n}catch(t){_.debug&&console.log("Browser does not support ["+n+"] for ["+a+"]")}else s(t)&&s(t).isSVG&&x.Names.SVGAttribute(e)?t.setAttribute(e,n):t.style[a]=n;_.debug>=2&&console.log("Set "+e+" ("+a+"): "+n)}return[a,n]},flushTransformCache:function(t){function e(e){return parseFloat(x.getPropertyValue(t,e))}var o="";if((f||_.State.isAndroid&&!_.State.isChrome)&&s(t).isSVG){var n={translate:[e("translateX"),e("translateY")],skewX:[e("skewX")],skewY:[e("skewY")],scale:1!==e("scale")?[e("scale"),e("scale")]:[e("scaleX"),e("scaleY")],rotate:[e("rotateZ"),0,0]};h.each(s(t).transformCache,function(t){/^translate/i.test(t)?t="translate":/^scale/i.test(t)?t="scale":/^rotate/i.test(t)&&(t="rotate"),n[t]&&(o+=t+"("+n[t].join(" ")+") ",delete n[t])})}else{var i,r;h.each(s(t).transformCache,function(e){return i=s(t).transformCache[e],"transformPerspective"===e?(r=i,!0):(9===f&&"rotateZ"===e&&(e="rotate"),void(o+=e+i+" "))}),r&&(o="perspective"+r+" "+o)}x.setPropertyValue(t,"transform",o)}};x.Hooks.register(),x.Normalizations.register(),_.animate=function(){function t(){return a?C.promise||null:g}function e(){function t(t){function p(t,e){var o=i,n=i,r=i;return v.isArray(t)?(o=t[0],!v.isArray(t[1])&&/^[\d-]/.test(t[1])||v.isFunction(t[1])||x.RegEx.isHex.test(t[1])?r=t[1]:(v.isString(t[1])&&!x.RegEx.isHex.test(t[1])||v.isArray(t[1]))&&(n=e?t[1]:l(t[1],u.duration),t[2]!==i&&(r=t[2]))):o=t,e||(n=n||u.easing),v.isFunction(o)&&(o=o.call(a,S,E)),v.isFunction(r)&&(r=r.call(a,S,E)),[o||0,n,r]}function d(t,e){var o,n;return n=(e||0).toString().toLowerCase().replace(/[%A-z]+$/,function(t){return o=t,""}),o||(o=x.Values.getUnitType(t)),[n,o]}if(u.begin&&0===S)try{u.begin.call(f,f)}catch(t){setTimeout(function(){throw t},1)}if("scroll"===k){var b,T,w,A=/^x$/i.test(u.axis)?"Left":"Top",I=parseFloat(u.offset)||0;u.container?v.isWrapped(u.container)||v.isNode(u.container)?(u.container=u.container[0]||u.container,b=u.container["scroll"+A],w=b+h(a).position()[A.toLowerCase()]+I):u.container=null:(b=_.State.scrollAnchor[_.State["scrollProperty"+A]],T=_.State.scrollAnchor[_.State["scrollProperty"+("Left"===A?"Top":"Left")]],w=h(a).offset()[A.toLowerCase()]+I),g={scroll:{rootPropertyValue:!1,startValue:b,currentValue:b,endValue:w,unitType:"",easing:u.easing,scrollData:{container:u.container,direction:A,alternateValue:T}},element:a},_.debug&&console.log("tweensContainer (scroll): ",g.scroll,a)}else if("reverse"===k){if(!s(a).tweensContainer)return void h.dequeue(a,u.queue);"none"===s(a).opts.display&&(s(a).opts.display="block"),"hidden"===s(a).opts.visibility&&(s(a).opts.visibility="visible"),s(a).opts.loop=!1,s(a).opts.begin=null,s(a).opts.complete=null,y.easing||delete u.easing,y.duration||delete u.duration,u=h.extend({},s(a).opts,u);var B=h.extend(!0,{},s(a).tweensContainer);for(var M in B)if("element"!==M){var R=B[M].startValue;B[M].startValue=B[M].currentValue=B[M].endValue,B[M].endValue=R,v.isEmptyObject(y)||(B[M].easing=u.easing),_.debug&&console.log("reverse tweensContainer ("+M+"): "+JSON.stringify(B[M]),a)}g=B}else if("start"===k){var B;s(a).tweensContainer&&!0===s(a).isAnimating&&(B=s(a).tweensContainer),h.each(m,function(t,e){if(RegExp("^"+x.Lists.colors.join("$|^")+"$").test(t)){var o=p(e,!0),n=o[0],r=o[1],s=o[2];if(x.RegEx.isHex.test(n)){for(var a=["Red","Green","Blue"],l=x.Values.hexToRgb(n),c=s?x.Values.hexToRgb(s):i,u=0;u<a.length;u++)m[t+a[u]]=[l[u],r,c?c[u]:c];delete m[t]}}});for(var D in m){var O=p(m[D]),P=O[0],j=O[1],F=O[2];D=x.Names.camelCase(D);var H=x.Hooks.getRoot(D),U=!1;if(s(a).isSVG||!1!==x.Names.prefixCheck(H)[1]||x.Normalizations.registered[H]!==i){(u.display&&"none"!==u.display||u.visibility&&"hidden"!==u.visibility)&&/opacity|filter/.test(D)&&!F&&0!==P&&(F=0),u._cacheValues&&B&&B[D]?(F===i&&(F=B[D].endValue+B[D].unitType),U=s(a).rootPropertyValueCache[H]):x.Hooks.registered[D]?F===i?(U=x.getPropertyValue(a,H),F=x.getPropertyValue(a,D,U)):U=x.Hooks.templates[H][1]:F===i&&(F=x.getPropertyValue(a,D));var G,V,W,z=!1;if(G=d(D,F),F=G[0],W=G[1],G=d(D,P),P=G[0].replace(/^([+-\/*])=/,function(t,e){return z=e,""}),V=G[1],F=parseFloat(F)||0,P=parseFloat(P)||0,"%"===V&&(/^(fontSize|lineHeight)$/.test(D)?(P/=100,V="em"):/^scale/.test(D)?(P/=100,V=""):/(Red|Green|Blue)$/i.test(D)&&(P=P/100*255,V="")),/[\/*]/.test(z))V=W;else if(W!==V&&0!==F)if(0===P)V=W;else{e=e||function(){var t={myParent:a.parentNode||n.body,position:x.getPropertyValue(a,"position"),fontSize:x.getPropertyValue(a,"fontSize")},e=t.position===L.lastPosition&&t.myParent===L.lastParent,i=t.fontSize===L.lastFontSize;L.lastParent=t.myParent,L.lastPosition=t.position,L.lastFontSize=t.fontSize;var r=100,l={};if(i&&e)l.emToPx=L.lastEmToPx,l.percentToPxWidth=L.lastPercentToPxWidth,l.percentToPxHeight=L.lastPercentToPxHeight;else{var c=s(a).isSVG?n.createElementNS("http://www.w3.org/2000/svg","rect"):n.createElement("div");_.init(c),t.myParent.appendChild(c),_.CSS.setPropertyValue(c,"position",t.position),_.CSS.setPropertyValue(c,"fontSize",t.fontSize),_.CSS.setPropertyValue(c,"overflow","hidden"),_.CSS.setPropertyValue(c,"overflowX","hidden"),_.CSS.setPropertyValue(c,"overflowY","hidden"),_.CSS.setPropertyValue(c,"boxSizing","content-box"),_.CSS.setPropertyValue(c,"paddingLeft",r+"em"),_.CSS.setPropertyValue(c,"minWidth",r+"%"),_.CSS.setPropertyValue(c,"maxWidth",r+"%"),_.CSS.setPropertyValue(c,"width",r+"%"),_.CSS.setPropertyValue(c,"minHeight",r+"%"),_.CSS.setPropertyValue(c,"maxHeight",r+"%"),_.CSS.setPropertyValue(c,"height",r+"%"),l.percentToPxWidth=L.lastPercentToPxWidth=(parseFloat(x.getPropertyValue(c,"width",null,!0))||1)/r,l.percentToPxHeight=L.lastPercentToPxHeight=(parseFloat(x.getPropertyValue(c,"height",null,!0))||1)/r,l.emToPx=L.lastEmToPx=(parseFloat(x.getPropertyValue(c,"paddingLeft"))||1)/r,t.myParent.removeChild(c)}return null===L.remToPx&&(L.remToPx=parseFloat(x.getPropertyValue(n.body,"fontSize"))||16),null===L.vwToPx&&(L.vwToPx=parseFloat(o.innerWidth)/100,L.vhToPx=parseFloat(o.innerHeight)/100),l.remToPx=L.remToPx,l.vwToPx=L.vwToPx,l.vhToPx=L.vhToPx,_.debug>=1&&console.log("Unit ratios: "+JSON.stringify(l),a),l}();var q=/margin|padding|left|right|width|text|word|letter/i.test(D)||/X$/.test(D)?"x":"y";switch(W){case"%":F*="x"===q?e.percentToPxWidth:e.percentToPxHeight;break;case"px":break;default:F*=e[W+"ToPx"]}switch(V){case"%":F*=1/("x"===q?e.percentToPxWidth:e.percentToPxHeight);break;case"px":break;default:F*=1/e[V+"ToPx"]}}switch(z){case"+":P=F+P;break;case"-":P=F-P;break;case"*":P*=F;break;case"/":P=F/P}g[D]={rootPropertyValue:U,startValue:F,currentValue:F,endValue:P,unitType:V,easing:j},_.debug&&console.log("tweensContainer ("+D+"): "+JSON.stringify(g[D]),a)}else _.debug&&console.log("Skipping ["+H+"] due to a lack of browser support.")}g.element=a}g.element&&(x.Values.addClass(a,"velocity-animating"),N.push(g),s(a).tweensContainer=g,s(a).opts=u,s(a).isAnimating=!0,S===E-1?(_.State.calls.length>1e4&&(_.State.calls=r(_.State.calls)),_.State.calls.push([N,f,u,null,C.resolver]),!1===_.State.isTicking&&(_.State.isTicking=!0,c())):S++)}var e,a=this,u=h.extend({},_.defaults,y),g={};if(s(a)===i&&_.init(a),parseFloat(u.delay)&&!1!==u.queue&&h.queue(a,u.queue,function(t){_.velocityQueueEntryFlag=!0,s(a).delayTimer={setTimeout:setTimeout(t,parseFloat(u.delay)),next:t}}),!0===_.mock)u.duration=1;else switch(u.duration.toString().toLowerCase()){case"fast":u.duration=200;break;case"normal":u.duration=p;break;case"slow":u.duration=600;break;default:u.duration=parseFloat(u.duration)||1}u.easing=l(u.easing,u.duration),u.begin&&!v.isFunction(u.begin)&&(u.begin=null),u.progress&&!v.isFunction(u.progress)&&(u.progress=null),u.complete&&!v.isFunction(u.complete)&&(u.complete=null),u.display&&(u.display=u.display.toString().toLowerCase(),"auto"===u.display&&(u.display=_.CSS.Values.getDisplayType(a))),u.visibility&&(u.visibility=u.visibility.toString().toLowerCase()),u.mobileHA=u.mobileHA&&_.State.isMobile&&!_.State.isGingerbread,!1===u.queue?u.delay?setTimeout(t,u.delay):t():h.queue(a,u.queue,function(e,o){return!0===o?(C.promise&&C.resolver(f),!0):(_.velocityQueueEntryFlag=!0,void t(e))}),""!==u.queue&&"fx"!==u.queue||"inprogress"===h.queue(a)[0]||h.dequeue(a)}var a,g,d,f,m,y,b=arguments[0]&&(h.isPlainObject(arguments[0].properties)&&!arguments[0].properties.names||v.isString(arguments[0].properties));if(v.isWrapped(this)?(a=!1,d=0,f=this,g=this):(a=!0,d=1,f=b?arguments[0].elements:arguments[0]),f=v.isWrapped(f)?[].slice.call(f):f){b?(m=arguments[0].properties,y=arguments[0].options):(m=arguments[d],y=arguments[d+1]);var E=v.isArray(f)||v.isNodeList(f)?f.length:1,S=0;if("stop"!==m&&!h.isPlainObject(y)){var T=d+1;y={};for(var w=T;w<arguments.length;w++)!v.isArray(arguments[w])&&/^\d/.test(arguments[w])?y.duration=parseFloat(arguments[w]):v.isString(arguments[w])||v.isArray(arguments[w])?y.easing=arguments[w]:v.isFunction(arguments[w])&&(y.complete=arguments[w])}var C={promise:null,resolver:null,rejecter:null};a&&_.Promise&&(C.promise=new _.Promise(function(t,e){C.resolver=t,C.rejecter=e}));var k;switch(m){case"scroll":k="scroll";break;case"reverse":k="reverse";break;case"stop":h.each(v.isNode(f)?[f]:f,function(t,e){s(e)&&s(e).delayTimer&&(clearTimeout(s(e).delayTimer.setTimeout),s(e).delayTimer.next&&s(e).delayTimer.next(),delete s(e).delayTimer)});var A=[];return h.each(_.State.calls,function(t,e){e&&h.each(v.isNode(e[1])?[e[1]]:e[1],function(e,o){h.each(v.isNode(f)?[f]:f,function(e,n){if(n===o){if(s(n)&&h.each(s(n).tweensContainer,function(t,e){e.endValue=e.currentValue}),!0===y||v.isString(y)){var i=v.isString(y)?y:"";h.each(h.queue(n,i),function(t,e){v.isFunction(e)&&e(null,!0)}),h.queue(n,i,[])}A.push(t)}})})}),h.each(A,function(t,e){u(e,!0)}),C.promise&&C.resolver(f),t();default:if(!h.isPlainObject(m)||v.isEmptyObject(m)){if(v.isString(m)&&_.Sequences[m]){var I=y.duration,B=y.delay||0;return!0===y.backwards&&(f=(v.isWrapped(f)?[].slice.call(f):f).reverse()),h.each(f,function(t,e){parseFloat(y.stagger)?y.delay=B+parseFloat(y.stagger)*t:v.isFunction(y.stagger)&&(y.delay=B+y.stagger.call(e,t,E)),y.drag&&(y.duration=parseFloat(I)||(/^(callout|transition)/.test(m)?1e3:p),y.duration=Math.max(y.duration*(y.backwards?1-t/E:(t+1)/E),.75*y.duration,200)),_.Sequences[m].call(e,e,y||{},t,E,f,C.promise?C:i)}),t()}var M="Velocity: First argument ("+m+") was not a property map, a known action, or a registered sequence. Aborting.";return C.promise?C.rejecter(new Error(M)):console.log(M),t()}k="start"}var L={lastParent:null,lastPosition:null,lastFontSize:null,lastPercentToPxWidth:null,lastPercentToPxHeight:null,lastEmToPx:null,remToPx:null,vwToPx:null,vhToPx:null},N=[];h.each(v.isNode(f)?[f]:f,function(t,o){v.isNode(o)&&e.call(o)});var R,D=h.extend({},_.defaults,y);if(D.loop=parseInt(D.loop),R=2*D.loop-1,D.loop)for(var O=0;R>O;O++){var P={delay:D.delay};O===R-1&&(P.display=D.display,P.visibility=D.visibility,P.complete=D.complete),_.animate(f,"reverse",P)}return t()}},_.State.isMobile||n.hidden===i||n.addEventListener("visibilitychange",function(){n.hidden?(y=function(t){return setTimeout(function(){t(!0)},16)},c()):y=o.requestAnimationFrame||m});var S;return t&&t.fn?S=t:o.Zepto&&(S=o.Zepto),(S||o).Velocity=_,S&&(S.fn.velocity=_.animate,S.fn.velocity.defaults=_.defaults),h.each(["Down","Up"],function(t,e){_.Sequences["slide"+e]=function(t,o,n,i,r,s){var a=h.extend({},o),l={height:null,marginTop:null,marginBottom:null,paddingTop:null,paddingBottom:null,overflow:null,overflowX:null,overflowY:null},c=a.begin,u=a.complete,g=!1;null!==a.display&&(a.display="Down"===e?a.display||"auto":a.display||"none"),a.begin=function(){function o(){l.height=parseFloat(_.CSS.getPropertyValue(t,"height")),t.style.height="auto",parseFloat(_.CSS.getPropertyValue(t,"height"))===l.height&&(g=!0),_.CSS.setPropertyValue(t,"height",l.height+"px")}if("Down"===e){l.overflow=[_.CSS.getPropertyValue(t,"overflow"),0],l.overflowX=[_.CSS.getPropertyValue(t,"overflowX"),0],l.overflowY=[_.CSS.getPropertyValue(t,"overflowY"),0],t.style.overflow="hidden",t.style.overflowX="visible",t.style.overflowY="hidden",o();for(var n in l)if(!/^overflow/.test(n)){var i=_.CSS.getPropertyValue(t,n);"height"===n&&(i=parseFloat(i)),l[n]=[i,0]}}else{o();for(var n in l){var i=_.CSS.getPropertyValue(t,n);"height"===n&&(i=parseFloat(i)),l[n]=[0,i]}t.style.overflow="hidden",t.style.overflowX="visible",t.style.overflowY="hidden"}c&&c.call(t,t)},a.complete=function(t){var o="Down"===e?0:1;!0===g?l.height[o]="auto":l.height[o]+="px";for(var n in l)t.style[n]=l[n][o];u&&u.call(t,t),s&&s.resolver(r||t)},_.animate(t,l,a)}}),h.each(["In","Out"],function(t,e){_.Sequences["fade"+e]=function(t,o,n,i,r,s){var a=h.extend({},o),l={opacity:"In"===e?1:0};if(n!==i-1)a.complete=a.begin=null;else{var c=a.complete;a.complete=function(){c&&c.call(t,t),s&&s.resolver(r||t)}}null!==a.display&&(a.display=a.display||("In"===e?"auto":"none")),_.animate(this,l,a)}}),_}(t||window,window,document)})}).call(e,o(0))},function(t,e){/*!
Waypoints Sticky Element Shortcut - 3.1.1
Copyright  2011-2015 Caleb Troughton
Licensed under the MIT license.
https://github.com/imakewebthings/waypoints/blog/master/licenses.txt
*/
!function(){"use strict";function t(n){this.options=e.extend({},o.defaults,t.defaults,n),this.element=this.options.element,this.$element=e(this.element),this.createWrapper(),this.createWaypoint()}var e=window.jQuery,o=window.Waypoint;t.prototype.createWaypoint=function(){var t=this.options.handler;this.waypoint=new o(e.extend({},this.options,{element:this.wrapper,handler:e.proxy(function(e){var o=this.options.direction.indexOf(e)>-1,n=o?this.$element.outerHeight(!0):"";this.$wrapper.height(n),this.$element.toggleClass(this.options.stuckClass,o),t&&t.call(this,e)},this)}))},t.prototype.createWrapper=function(){this.$element.wrap(this.options.wrapper),this.$wrapper=this.$element.parent(),this.wrapper=this.$wrapper[0]},t.prototype.destroy=function(){this.$element.parent()[0]===this.wrapper&&(this.waypoint.destroy(),this.$element.removeClass(this.options.stuckClass).unwrap())},t.defaults={wrapper:'<div class="sticky-wrapper" />',stuckClass:"stuck",direction:"down right"},o.Sticky=t}()},function(t,e){/*!
Waypoints - 3.1.1
Copyright  2011-2015 Caleb Troughton
Licensed under the MIT license.
https://github.com/imakewebthings/waypoints/blog/master/licenses.txt
*/
!function(){"use strict";function t(n){if(!n)throw new Error("No options passed to Waypoint constructor");if(!n.element)throw new Error("No element option passed to Waypoint constructor");if(!n.handler)throw new Error("No handler option passed to Waypoint constructor");this.key="waypoint-"+e,this.options=t.Adapter.extend({},t.defaults,n),this.element=this.options.element,this.adapter=new t.Adapter(this.element),this.callback=n.handler,this.axis=this.options.horizontal?"horizontal":"vertical",this.enabled=this.options.enabled,this.triggerPoint=null,this.group=t.Group.findOrCreate({name:this.options.group,axis:this.axis}),this.context=t.Context.findOrCreateByElement(this.options.context),t.offsetAliases[this.options.offset]&&(this.options.offset=t.offsetAliases[this.options.offset]),this.group.add(this),this.context.add(this),o[this.key]=this,e+=1}var e=0,o={};t.prototype.queueTrigger=function(t){this.group.queueTrigger(this,t)},t.prototype.trigger=function(t){this.enabled&&this.callback&&this.callback.apply(this,t)},t.prototype.destroy=function(){this.context.remove(this),this.group.remove(this),delete o[this.key]},t.prototype.disable=function(){return this.enabled=!1,this},t.prototype.enable=function(){return this.context.refresh(),this.enabled=!0,this},t.prototype.next=function(){return this.group.next(this)},t.prototype.previous=function(){return this.group.previous(this)},t.invokeAll=function(t){var e=[];for(var n in o)e.push(o[n]);for(var i=0,r=e.length;r>i;i++)e[i][t]()},t.destroyAll=function(){t.invokeAll("destroy")},t.disableAll=function(){t.invokeAll("disable")},t.enableAll=function(){t.invokeAll("enable")},t.refreshAll=function(){t.Context.refreshAll()},t.viewportHeight=function(){return window.innerHeight||document.documentElement.clientHeight},t.viewportWidth=function(){return document.documentElement.clientWidth},t.adapters=[],t.defaults={context:window,continuous:!0,enabled:!0,group:"default",horizontal:!1,offset:0},t.offsetAliases={"bottom-in-view":function(){return this.context.innerHeight()-this.adapter.outerHeight()},"right-in-view":function(){return this.context.innerWidth()-this.adapter.outerWidth()}},window.Waypoint=t}(),function(){"use strict";function t(t){window.setTimeout(t,1e3/60)}function e(t){this.element=t,this.Adapter=i.Adapter,this.adapter=new this.Adapter(t),this.key="waypoint-context-"+o,this.didScroll=!1,this.didResize=!1,this.oldScroll={x:this.adapter.scrollLeft(),y:this.adapter.scrollTop()},this.waypoints={vertical:{},horizontal:{}},t.waypointContextKey=this.key,n[t.waypointContextKey]=this,o+=1,this.createThrottledScrollHandler(),this.createThrottledResizeHandler()}var o=0,n={},i=window.Waypoint,r=window.onload;e.prototype.add=function(t){var e=t.options.horizontal?"horizontal":"vertical";this.waypoints[e][t.key]=t,this.refresh()},e.prototype.checkEmpty=function(){var t=this.Adapter.isEmptyObject(this.waypoints.horizontal),e=this.Adapter.isEmptyObject(this.waypoints.vertical);t&&e&&(this.adapter.off(".waypoints"),delete n[this.key])},e.prototype.createThrottledResizeHandler=function(){function t(){e.handleResize(),e.didResize=!1}var e=this;this.adapter.on("resize.waypoints",function(){e.didResize||(e.didResize=!0,i.requestAnimationFrame(t))})},e.prototype.createThrottledScrollHandler=function(){function t(){e.handleScroll(),e.didScroll=!1}var e=this;this.adapter.on("scroll.waypoints",function(){(!e.didScroll||i.isTouch)&&(e.didScroll=!0,i.requestAnimationFrame(t))})},e.prototype.handleResize=function(){i.Context.refreshAll()},e.prototype.handleScroll=function(){var t={},e={horizontal:{newScroll:this.adapter.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.adapter.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}};for(var o in e){var n=e[o],i=n.newScroll>n.oldScroll,r=i?n.forward:n.backward;for(var s in this.waypoints[o]){var a=this.waypoints[o][s],l=n.oldScroll<a.triggerPoint,c=n.newScroll>=a.triggerPoint,u=l&&c,h=!l&&!c;(u||h)&&(a.queueTrigger(r),t[a.group.id]=a.group)}}for(var g in t)t[g].flushTriggers();this.oldScroll={x:e.horizontal.newScroll,y:e.vertical.newScroll}},e.prototype.innerHeight=function(){return this.element==this.element.window?i.viewportHeight():this.adapter.innerHeight()},e.prototype.remove=function(t){delete this.waypoints[t.axis][t.key],this.checkEmpty()},e.prototype.innerWidth=function(){return this.element==this.element.window?i.viewportWidth():this.adapter.innerWidth()},e.prototype.destroy=function(){var t=[];for(var e in this.waypoints)for(var o in this.waypoints[e])t.push(this.waypoints[e][o]);for(var n=0,i=t.length;i>n;n++)t[n].destroy()},e.prototype.refresh=function(){var t,e=this.element==this.element.window,o=this.adapter.offset(),n={};this.handleScroll(),t={horizontal:{contextOffset:e?0:o.left,contextScroll:e?0:this.oldScroll.x,contextDimension:this.innerWidth(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:e?0:o.top,contextScroll:e?0:this.oldScroll.y,contextDimension:this.innerHeight(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}};for(var i in t){var r=t[i];for(var s in this.waypoints[i]){var a,l,c,u,h,g=this.waypoints[i][s],p=g.options.offset,d=g.triggerPoint,f=0,m=null==d;g.element!==g.element.window&&(f=g.adapter.offset()[r.offsetProp]),"function"==typeof p?p=p.apply(g):"string"==typeof p&&(p=parseFloat(p),g.options.offset.indexOf("%")>-1&&(p=Math.ceil(r.contextDimension*p/100))),a=r.contextScroll-r.contextOffset,g.triggerPoint=f+a-p,l=d<r.oldScroll,c=g.triggerPoint>=r.oldScroll,u=l&&c,h=!l&&!c,!m&&u?(g.queueTrigger(r.backward),n[g.group.id]=g.group):!m&&h?(g.queueTrigger(r.forward),n[g.group.id]=g.group):m&&r.oldScroll>=g.triggerPoint&&(g.queueTrigger(r.forward),n[g.group.id]=g.group)}}for(var y in n)n[y].flushTriggers();return this},e.findOrCreateByElement=function(t){return e.findByElement(t)||new e(t)},e.refreshAll=function(){for(var t in n)n[t].refresh()},e.findByElement=function(t){return n[t.waypointContextKey]},window.onload=function(){r&&r(),e.refreshAll()},i.requestAnimationFrame=function(e){(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||t).call(window,e)},i.Context=e}(),function(){"use strict";function t(t,e){return t.triggerPoint-e.triggerPoint}function e(t,e){return e.triggerPoint-t.triggerPoint}function o(t){this.name=t.name,this.axis=t.axis,this.id=this.name+"-"+this.axis,this.waypoints=[],this.clearTriggerQueues(),n[this.axis][this.name]=this}var n={vertical:{},horizontal:{}},i=window.Waypoint;o.prototype.add=function(t){this.waypoints.push(t)},o.prototype.clearTriggerQueues=function(){this.triggerQueues={up:[],down:[],left:[],right:[]}},o.prototype.flushTriggers=function(){for(var o in this.triggerQueues){var n=this.triggerQueues[o],i="up"===o||"left"===o;n.sort(i?e:t);for(var r=0,s=n.length;s>r;r+=1){var a=n[r];(a.options.continuous||r===n.length-1)&&a.trigger([o])}}this.clearTriggerQueues()},o.prototype.next=function(e){this.waypoints.sort(t);var o=i.Adapter.inArray(e,this.waypoints);return o===this.waypoints.length-1?null:this.waypoints[o+1]},o.prototype.previous=function(e){this.waypoints.sort(t);var o=i.Adapter.inArray(e,this.waypoints);return o?this.waypoints[o-1]:null},o.prototype.queueTrigger=function(t,e){this.triggerQueues[e].push(t)},o.prototype.remove=function(t){var e=i.Adapter.inArray(t,this.waypoints);e>-1&&this.waypoints.splice(e,1)},o.prototype.first=function(){return this.waypoints[0]},o.prototype.last=function(){return this.waypoints[this.waypoints.length-1]},o.findOrCreate=function(t){return n[t.axis][t.name]||new o(t)},i.Group=o}(),function(){"use strict";function t(t){this.$element=e(t)}var e=window.jQuery,o=window.Waypoint;e.each(["innerHeight","innerWidth","off","offset","on","outerHeight","outerWidth","scrollLeft","scrollTop"],function(e,o){t.prototype[o]=function(){var t=Array.prototype.slice.call(arguments);return this.$element[o].apply(this.$element,t)}}),e.each(["extend","inArray","isEmptyObject"],function(o,n){t[n]=e[n]}),o.adapters.push({name:"jquery",Adapter:t}),o.Adapter=t}(),function(){"use strict";function t(t){return function(){var o=[],n=arguments[0];return t.isFunction(arguments[0])&&(n=t.extend({},arguments[1]),n.handler=arguments[0]),this.each(function(){var i=t.extend({},n,{element:this});"string"==typeof i.context&&(i.context=t(this).closest(i.context)[0]),o.push(new e(i))}),o}}var e=window.Waypoint;window.jQuery&&(window.jQuery.fn.waypoint=t(window.jQuery)),window.Zepto&&(window.Zepto.fn.waypoint=t(window.Zepto))}()},function(t,e,o){jsts={version:"0.13.2",algorithm:{distance:{},locate:{}},error:{},geom:{util:{}},geomgraph:{index:{}},index:{bintree:{},chain:{},kdtree:{},quadtree:{},strtree:{}},io:{},noding:{snapround:{}},operation:{buffer:{},distance:{},overlay:{snap:{}},polygonize:{},relate:{},union:{},valid:{}},planargraph:{},simplify:{},triangulate:{quadedge:{}},util:{}},"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),jsts.abstractFunc=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.error={},jsts.error.IllegalArgumentError=function(t){this.name="IllegalArgumentError",this.message=t},jsts.error.IllegalArgumentError.prototype=new Error,jsts.error.TopologyError=function(t,e){this.name="TopologyError",this.message=e?t+" [ "+e+" ]":t},jsts.error.TopologyError.prototype=new Error,jsts.error.AbstractMethodInvocationError=function(){this.name="AbstractMethodInvocationError",this.message="Abstract method called, should be implemented in subclass."},jsts.error.AbstractMethodInvocationError.prototype=new Error,jsts.error.NotImplementedError=function(){this.name="NotImplementedError",this.message="This method has not yet been implemented."},jsts.error.NotImplementedError.prototype=new Error,jsts.error.NotRepresentableError=function(t){this.name="NotRepresentableError",this.message=t},jsts.error.NotRepresentableError.prototype=new Error,jsts.error.LocateFailureError=function(t){this.name="LocateFailureError",this.message=t},jsts.error.LocateFailureError.prototype=new Error,t.exports=jsts,jsts.geom.GeometryFilter=function(){},jsts.geom.GeometryFilter.prototype.filter=function(t){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.util.PolygonExtracter=function(t){this.comps=t},jsts.geom.util.PolygonExtracter.prototype=new jsts.geom.GeometryFilter,jsts.geom.util.PolygonExtracter.prototype.comps=null,jsts.geom.util.PolygonExtracter.getPolygons=function(t,e){return void 0===e&&(e=[]),t instanceof jsts.geom.Polygon?e.push(t):t instanceof jsts.geom.GeometryCollection&&t.apply(new jsts.geom.util.PolygonExtracter(e)),e},jsts.geom.util.PolygonExtracter.prototype.filter=function(t){t instanceof jsts.geom.Polygon&&this.comps.push(t)},jsts.io.WKTParser=function(t){this.geometryFactory=t||new jsts.geom.GeometryFactory,this.regExes={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/}},jsts.io.WKTParser.prototype.read=function(t){var e,o,n;t=t.replace(/[\n\r]/g," ");var i=this.regExes.typeStr.exec(t);if(-1!==t.search("EMPTY")&&(i=this.regExes.emptyTypeStr.exec(t),i[2]=void 0),i&&(o=i[1].toLowerCase(),n=i[2],this.parse[o]&&(e=this.parse[o].apply(this,[n]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},jsts.io.WKTParser.prototype.write=function(t){return this.extractGeometry(t)},jsts.io.WKTParser.prototype.extractGeometry=function(t){var e=t.CLASS_NAME.split(".")[2].toLowerCase();if(!this.extract[e])return null;var o=e.toUpperCase();return t.isEmpty()?o+" EMPTY":o+"("+this.extract[e].apply(this,[t])+")"},jsts.io.WKTParser.prototype.extract={coordinate:function(t){return t.x+" "+t.y},point:function(t){return t.coordinate.x+" "+t.coordinate.y},multipoint:function(t){for(var e=[],o=0,n=t.geometries.length;o<n;++o)e.push("("+this.extract.point.apply(this,[t.geometries[o]])+")");return e.join(",")},linestring:function(t){for(var e=[],o=0,n=t.points.length;o<n;++o)e.push(this.extract.coordinate.apply(this,[t.points[o]]));return e.join(",")},multilinestring:function(t){for(var e=[],o=0,n=t.geometries.length;o<n;++o)e.push("("+this.extract.linestring.apply(this,[t.geometries[o]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+this.extract.linestring.apply(this,[t.shell])+")");for(var o=0,n=t.holes.length;o<n;++o)e.push("("+this.extract.linestring.apply(this,[t.holes[o]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],o=0,n=t.geometries.length;o<n;++o)e.push("("+this.extract.polygon.apply(this,[t.geometries[o]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],o=0,n=t.geometries.length;o<n;++o)e.push(this.extractGeometry.apply(this,[t.geometries[o]]));return e.join(",")}},jsts.io.WKTParser.prototype.parse={point:function(t){if(void 0===t)return this.geometryFactory.createPoint(null);var e=t.trim().split(this.regExes.spaces);return this.geometryFactory.createPoint(new jsts.geom.Coordinate(e[0],e[1]))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint(null);for(var e,o=t.trim().split(","),n=[],i=0,r=o.length;i<r;++i)e=o[i].replace(this.regExes.trimParens,"$1"),n.push(this.parse.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(n)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString(null);for(var e,o=t.trim().split(","),n=[],i=0,r=o.length;i<r;++i)e=o[i].trim().split(this.regExes.spaces),n.push(new jsts.geom.Coordinate(e[0],e[1]));return this.geometryFactory.createLineString(n)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing(null);for(var e,o=t.trim().split(","),n=[],i=0,r=o.length;i<r;++i)e=o[i].trim().split(this.regExes.spaces),n.push(new jsts.geom.Coordinate(e[0],e[1]));return this.geometryFactory.createLinearRing(n)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString(null);for(var e,o=t.trim().split(this.regExes.parenComma),n=[],i=0,r=o.length;i<r;++i)e=o[i].replace(this.regExes.trimParens,"$1"),n.push(this.parse.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(n)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon(null);for(var e,o,n,i,r=t.trim().split(this.regExes.parenComma),s=[],a=0,l=r.length;a<l;++a)e=r[a].replace(this.regExes.trimParens,"$1"),o=this.parse.linestring.apply(this,[e]),n=this.geometryFactory.createLinearRing(o.points),0===a?i=n:s.push(n);return this.geometryFactory.createPolygon(i,s)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon(null);for(var e,o=t.trim().split(this.regExes.doubleParenComma),n=[],i=0,r=o.length;i<r;++i)e=o[i].replace(this.regExes.trimParens,"$1"),n.push(this.parse.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(n)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection(null);t=t.replace(/,\s*([A-Za-z])/g,"|$1");for(var e=t.trim().split("|"),o=[],n=0,i=e.length;n<i;++n)o.push(jsts.io.WKTParser.prototype.read.apply(this,[e[n]]));return this.geometryFactory.createGeometryCollection(o)}},jsts.index.ItemVisitor=function(){},jsts.index.ItemVisitor.prototype.visitItem=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.algorithm.CGAlgorithms=function(){},jsts.algorithm.CGAlgorithms.CLOCKWISE=-1,jsts.algorithm.CGAlgorithms.RIGHT=jsts.algorithm.CGAlgorithms.CLOCKWISE,jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE=1,jsts.algorithm.CGAlgorithms.LEFT=jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE,jsts.algorithm.CGAlgorithms.COLLINEAR=0,jsts.algorithm.CGAlgorithms.STRAIGHT=jsts.algorithm.CGAlgorithms.COLLINEAR,jsts.algorithm.CGAlgorithms.orientationIndex=function(t,e,o){var n,i,r,s;return n=e.x-t.x,i=e.y-t.y,r=o.x-e.x,s=o.y-e.y,jsts.algorithm.RobustDeterminant.signOfDet2x2(n,i,r,s)},jsts.algorithm.CGAlgorithms.isPointInRing=function(t,e){return jsts.algorithm.CGAlgorithms.locatePointInRing(t,e)!==jsts.geom.Location.EXTERIOR},jsts.algorithm.CGAlgorithms.locatePointInRing=function(t,e){return jsts.algorithm.RayCrossingCounter.locatePointInRing(t,e)},jsts.algorithm.CGAlgorithms.isOnLine=function(t,e){var o,n,i,r,s;for(o=new jsts.algorithm.RobustLineIntersector,n=1,i=e.length;n<i;n++)if(r=e[n-1],s=e[n],o.computeIntersection(t,r,s),o.hasIntersection())return!0;return!1},jsts.algorithm.CGAlgorithms.isCCW=function(t){var e,o,n,i,r,s,a,l,c,u;if((e=t.length-1)<3)throw new jsts.IllegalArgumentError("Ring has fewer than 3 points, so orientation cannot be determined");for(o=t[0],n=0,c=1;c<=e;c++)i=t[c],i.y>o.y&&(o=i,n=c);r=n;do{(r-=1)<0&&(r=e)}while(t[r].equals2D(o)&&r!==n);s=n;do{s=(s+1)%e}while(t[s].equals2D(o)&&s!==n);return a=t[r],l=t[s],!(a.equals2D(o)||l.equals2D(o)||a.equals2D(l))&&(u=jsts.algorithm.CGAlgorithms.computeOrientation(a,o,l),!1,0===u?a.x>l.x:u>0)},jsts.algorithm.CGAlgorithms.computeOrientation=function(t,e,o){return jsts.algorithm.CGAlgorithms.orientationIndex(t,e,o)},jsts.algorithm.CGAlgorithms.distancePointLine=function(t,e,o){if(e instanceof jsts.geom.Coordinate||jsts.algorithm.CGAlgorithms.distancePointLine2.apply(this,arguments),e.x===o.x&&e.y===o.y)return t.distance(e);var n,i;return(n=((t.x-e.x)*(o.x-e.x)+(t.y-e.y)*(o.y-e.y))/((o.x-e.x)*(o.x-e.x)+(o.y-e.y)*(o.y-e.y)))<=0?t.distance(e):n>=1?t.distance(o):(i=((e.y-t.y)*(o.x-e.x)-(e.x-t.x)*(o.y-e.y))/((o.x-e.x)*(o.x-e.x)+(o.y-e.y)*(o.y-e.y)),Math.abs(i)*Math.sqrt((o.x-e.x)*(o.x-e.x)+(o.y-e.y)*(o.y-e.y)))},jsts.algorithm.CGAlgorithms.distancePointLinePerpendicular=function(t,e,o){var n=((e.y-t.y)*(o.x-e.x)-(e.x-t.x)*(o.y-e.y))/((o.x-e.x)*(o.x-e.x)+(o.y-e.y)*(o.y-e.y));return Math.abs(n)*Math.sqrt((o.x-e.x)*(o.x-e.x)+(o.y-e.y)*(o.y-e.y))},jsts.algorithm.CGAlgorithms.distancePointLine2=function(t,e){var o,n,i,r;if(0===e.length)throw new jsts.error.IllegalArgumentError("Line array must contain at least one vertex");for(o=t.distance(e[0]),n=0,i=e.length-1;n<i;n++)(r=jsts.algorithm.CGAlgorithms.distancePointLine(t,e[n],e[n+1]))<o&&(o=r);return o},jsts.algorithm.CGAlgorithms.distanceLineLine=function(t,e,o,n){if(t.equals(e))return jsts.algorithm.CGAlgorithms.distancePointLine(t,o,n);if(o.equals(n))return jsts.algorithm.CGAlgorithms.distancePointLine(n,t,e);var i,r,s,a,l,c;return i=(t.y-o.y)*(n.x-o.x)-(t.x-o.x)*(n.y-o.y),r=(e.x-t.x)*(n.y-o.y)-(e.y-t.y)*(n.x-o.x),s=(t.y-o.y)*(e.x-t.x)-(t.x-o.x)*(e.y-t.y),a=(e.x-t.x)*(n.y-o.y)-(e.y-t.y)*(n.x-o.x),0===r||0===a?Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(t,o,n),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(e,o,n),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(o,t,e),jsts.algorithm.CGAlgorithms.distancePointLine(n,t,e)))):(l=s/a,c=i/r,c<0||c>1||l<0||l>1?Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(t,o,n),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(e,o,n),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(o,t,e),jsts.algorithm.CGAlgorithms.distancePointLine(n,t,e)))):0)},jsts.algorithm.CGAlgorithms.signedArea=function(t){if(t.length<3)return 0;var e,o,n,i,r,s,a;for(e=0,o=0,n=t.length-1;o<n;o++)i=t[o].x,r=t[o].y,s=t[o+1].x,a=t[o+1].y,e+=(i+s)*(a-r);return-e/2},jsts.algorithm.CGAlgorithms.signedArea=function(t){var e,o,n,i,r,s,a,l;if((e=t.length)<3)return 0;for(o=0,n=t[0],i=n.x,r=n.y,s=1;s<e;s++)n=t[s],a=n.x,l=n.y,o+=(i+a)*(l-r),i=a,r=l;return-o/2},jsts.algorithm.CGAlgorithms.computeLength=function(t){var e,o,n,i,r,s,a,l,c,u=t.length;if(u<=1)return 0;for(e=0,l=t[0],o=l.x,n=l.y,c=1,u,c;c<u;c++)l=t[c],i=l.x,r=l.y,s=i-o,a=r-n,e+=Math.sqrt(s*s+a*a),o=i,n=r;return e},jsts.algorithm.CGAlgorithms.length=function(){},jsts.algorithm.Angle=function(){},jsts.algorithm.Angle.PI_TIMES_2=2*Math.PI,jsts.algorithm.Angle.PI_OVER_2=Math.PI/2,jsts.algorithm.Angle.PI_OVER_4=Math.PI/4,jsts.algorithm.Angle.COUNTERCLOCKWISE=jsts.algorithm.CGAlgorithms.prototype.COUNTERCLOCKWISE,jsts.algorithm.Angle.CLOCKWISE=jsts.algorithm.CGAlgorithms.prototype.CLOCKWISE,jsts.algorithm.Angle.NONE=jsts.algorithm.CGAlgorithms.prototype.COLLINEAR,jsts.algorithm.Angle.toDegrees=function(t){return 180*t/Math.PI},jsts.algorithm.Angle.toRadians=function(t){return t*Math.PI/180},jsts.algorithm.Angle.angle=function(){return 1===arguments.length?jsts.algorithm.Angle.angleFromOrigo(arguments[0]):jsts.algorithm.Angle.angleBetweenCoords(arguments[0],arguments[1])},jsts.algorithm.Angle.angleBetweenCoords=function(t,e){var o,n;return o=e.x-t.x,n=e.y-t.y,Math.atan2(n,o)},jsts.algorithm.Angle.angleFromOrigo=function(t){return Math.atan2(t.y,t.x)},jsts.algorithm.Angle.isAcute=function(t,e,o){var n,i,r,s;return n=t.x-e.x,i=t.y-e.y,r=o.x-e.x,s=o.y-e.y,n*r+i*s>0},jsts.algorithm.Angle.isObtuse=function(t,e,o){var n,i,r,s;return n=t.x-e.x,i=t.y-e.y,r=o.x-e.x,s=o.y-e.y,n*r+i*s<0},jsts.algorithm.Angle.angleBetween=function(t,e,o){var n,i;return n=jsts.algorithm.Angle.angle(e,t),i=jsts.algorithm.Angle.angle(e,o),jsts.algorithm.Angle.diff(n,i)},jsts.algorithm.Angle.angleBetweenOriented=function(t,e,o){var n,i,r;return n=jsts.algorithm.Angle.angle(e,t),i=jsts.algorithm.Angle.angle(e,o),r=i-n,r<=-Math.PI?r+jsts.algorithm.Angle.PI_TIMES_2:r>Math.PI?r-jsts.algorithm.Angle.PI_TIMES_2:r},jsts.algorithm.Angle.interiorAngle=function(t,e,o){var n,i;return n=jsts.algorithm.Angle.angle(e,t),i=jsts.algorithm.Angle.angle(e,o),Math.abs(i-n)},jsts.algorithm.Angle.getTurn=function(t,e){var o=Math.sin(e-t);return o>0?jsts.algorithm.Angle.COUNTERCLOCKWISE:o<0?jsts.algorithm.Angle.CLOCKWISE:jsts.algorithm.Angle.NONE},jsts.algorithm.Angle.normalize=function(t){for(;t>Math.PI;)t-=jsts.algorithm.Angle.PI_TIMES_2;for(;t<=-Math.PI;)t+=jsts.algorithm.Angle.PI_TIMES_2;return t},jsts.algorithm.Angle.normalizePositive=function(t){if(t<0){for(;t<0;)t+=jsts.algorithm.Angle.PI_TIMES_2;t>=jsts.algorithm.Angle.PI_TIMES_2&&(t=0)}else{for(;t>=jsts.algorithm.Angle.PI_TIMES_2;)t-=jsts.algorithm.Angle.PI_TIMES_2;t<0&&(t=0)}return t},jsts.algorithm.Angle.diff=function(t,e){var o;return o=t<e?e-t:t-e,o>Math.PI&&(o=2*Math.PI-o),o},jsts.geom.GeometryComponentFilter=function(){},jsts.geom.GeometryComponentFilter.prototype.filter=function(t){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.util.LinearComponentExtracter=function(t,e){this.lines=t,this.isForcedToLineString=e},jsts.geom.util.LinearComponentExtracter.prototype=new jsts.geom.GeometryComponentFilter,jsts.geom.util.LinearComponentExtracter.prototype.lines=null,jsts.geom.util.LinearComponentExtracter.prototype.isForcedToLineString=!1,jsts.geom.util.LinearComponentExtracter.getLines=function(t,e){if(1==arguments.length)return jsts.geom.util.LinearComponentExtracter.getLines5.apply(this,arguments);if(2==arguments.length&&"boolean"==typeof e)return jsts.geom.util.LinearComponentExtracter.getLines6.apply(this,arguments);if(2==arguments.length&&t instanceof jsts.geom.Geometry)return jsts.geom.util.LinearComponentExtracter.getLines3.apply(this,arguments);if(3==arguments.length&&t instanceof jsts.geom.Geometry)return jsts.geom.util.LinearComponentExtracter.getLines4.apply(this,arguments);if(3==arguments.length)return jsts.geom.util.LinearComponentExtracter.getLines2.apply(this,arguments);for(var o=0;o<t.length;o++){var n=t[o];jsts.geom.util.LinearComponentExtracter.getLines3(n,e)}return e},jsts.geom.util.LinearComponentExtracter.getLines2=function(t,e,o){for(var n=0;n<t.length;n++){var i=t[n];jsts.geom.util.LinearComponentExtracter.getLines4(i,e,o)}return e},jsts.geom.util.LinearComponentExtracter.getLines3=function(t,e){return t instanceof LineString?e.add(t):t.apply(new jsts.geom.util.LinearComponentExtracter(e)),e},jsts.geom.util.LinearComponentExtracter.getLines4=function(t,e,o){return t.apply(new jsts.geom.util.LinearComponentExtracter(e,o)),e},jsts.geom.util.LinearComponentExtracter.getLines5=function(t){return jsts.geom.util.LinearComponentExtracter.getLines6(t,!1)},jsts.geom.util.LinearComponentExtracter.getLines6=function(t,e){var o=[];return t.apply(new jsts.geom.util.LinearComponentExtracter(o,e)),o},jsts.geom.util.LinearComponentExtracter.prototype.setForceToLineString=function(t){this.isForcedToLineString=t},jsts.geom.util.LinearComponentExtracter.prototype.filter=function(t){if(this.isForcedToLineString&&t instanceof jsts.geom.LinearRing){var e=t.getFactory().createLineString(t.getCoordinateSequence());return void this.lines.push(e)}(t instanceof jsts.geom.LineString||t instanceof jsts.geom.LinearRing)&&this.lines.push(t)},jsts.geom.Location=function(){},jsts.geom.Location.INTERIOR=0,jsts.geom.Location.BOUNDARY=1,jsts.geom.Location.EXTERIOR=2,jsts.geom.Location.NONE=-1,jsts.geom.Location.toLocationSymbol=function(t){switch(t){case jsts.geom.Location.EXTERIOR:return"e";case jsts.geom.Location.BOUNDARY:return"b";case jsts.geom.Location.INTERIOR:return"i";case jsts.geom.Location.NONE:return"-"}throw new jsts.IllegalArgumentError("Unknown location value: "+t)},function(){jsts.io.GeoJSONReader=function(t){this.geometryFactory=t||new jsts.geom.GeometryFactory,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new jsts.io.GeoJSONParser(this.geometryFactory)},jsts.io.GeoJSONReader.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===jsts.geom.PrecisionModel.FIXED&&this.reducePrecision(e),e},jsts.io.GeoJSONReader.prototype.reducePrecision=function(t){var e,o;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,o=t.points.length;e<o;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,o=t.geometries.length;e<o;e++)this.reducePrecision(t.geometries[e])}}(),jsts.geom.Geometry=function(t){this.factory=t},jsts.geom.Geometry.prototype.envelope=null,jsts.geom.Geometry.prototype.factory=null,jsts.geom.Geometry.prototype.getGeometryType=function(){return"Geometry"},jsts.geom.Geometry.hasNonEmptyElements=function(t){var e;for(e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},jsts.geom.Geometry.hasNullElements=function(t){var e;for(e=0;e<t.length;e++)if(null===t[e])return!0;return!1},jsts.geom.Geometry.prototype.getFactory=function(){return null!==this.factory&&void 0!==this.factory||(this.factory=new jsts.geom.GeometryFactory),this.factory},jsts.geom.Geometry.prototype.getNumGeometries=function(){return 1},jsts.geom.Geometry.prototype.getGeometryN=function(t){return this},jsts.geom.Geometry.prototype.getPrecisionModel=function(){return this.getFactory().getPrecisionModel()},jsts.geom.Geometry.prototype.getCoordinate=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.getCoordinates=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.getNumPoints=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.isSimple=function(){return this.checkNotGeometryCollection(this),new jsts.operation.IsSimpleOp(this).isSimple()},jsts.geom.Geometry.prototype.isValid=function(){return new jsts.operation.valid.IsValidOp(this).isValid()},jsts.geom.Geometry.prototype.isEmpty=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.distance=function(t){return jsts.operation.distance.DistanceOp.distance(this,t)},jsts.geom.Geometry.prototype.isWithinDistance=function(t,e){return!(this.getEnvelopeInternal().distance(t.getEnvelopeInternal())>e)&&DistanceOp.isWithinDistance(this,t,e)},jsts.geom.Geometry.prototype.isRectangle=function(){return!1},jsts.geom.Geometry.prototype.getArea=function(){return 0},jsts.geom.Geometry.prototype.getLength=function(){return 0},jsts.geom.Geometry.prototype.getCentroid=function(){if(this.isEmpty())return null;var t,e=null,o=this.getDimension();return 0===o?(t=new jsts.algorithm.CentroidPoint,t.add(this),e=t.getCentroid()):1===o?(t=new jsts.algorithm.CentroidLine,t.add(this),e=t.getCentroid()):(t=new jsts.algorithm.CentroidArea,t.add(this),e=t.getCentroid()),this.createPointFromInternalCoord(e,this)},jsts.geom.Geometry.prototype.getInteriorPoint=function(){var t,e=null,o=this.getDimension();return 0===o?(t=new InteriorPointPoint(this),e=t.getInteriorPoint()):1===o?(t=new InteriorPointLine(this),e=t.getInteriorPoint()):(t=new InteriorPointArea(this),e=t.getInteriorPoint()),this.createPointFromInternalCoord(e,this)},jsts.geom.Geometry.prototype.getDimension=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.getBoundary=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.getBoundaryDimension=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},jsts.geom.Geometry.prototype.getEnvelopeInternal=function(){return null===this.envelope&&(this.envelope=this.computeEnvelopeInternal()),this.envelope},jsts.geom.Geometry.prototype.disjoint=function(t){return!this.intersects(t)},jsts.geom.Geometry.prototype.touches=function(t){return!!this.getEnvelopeInternal().intersects(t.getEnvelopeInternal())&&this.relate(t).isTouches(this.getDimension(),t.getDimension())},jsts.geom.Geometry.prototype.intersects=function(t){return!!this.getEnvelopeInternal().intersects(t.getEnvelopeInternal())&&(this.isRectangle()?RectangleIntersects.intersects(this,t):t.isRectangle()?RectangleIntersects.intersects(t,this):this.relate(t).isIntersects())},jsts.geom.Geometry.prototype.crosses=function(t){return!!this.getEnvelopeInternal().intersects(t.getEnvelopeInternal())&&this.relate(t).isCrosses(this.getDimension(),t.getDimension())},jsts.geom.Geometry.prototype.within=function(t){return t.contains(this)},jsts.geom.Geometry.prototype.contains=function(t){return!!this.getEnvelopeInternal().contains(t.getEnvelopeInternal())&&(this.isRectangle()?RectangleContains.contains(this,t):this.relate(t).isContains())},jsts.geom.Geometry.prototype.overlaps=function(t){return!!this.getEnvelopeInternal().intersects(t.getEnvelopeInternal())&&this.relate(t).isOverlaps(this.getDimension(),t.getDimension())},jsts.geom.Geometry.prototype.covers=function(t){return!!this.getEnvelopeInternal().covers(t.getEnvelopeInternal())&&(!!this.isRectangle()||this.relate(t).isCovers())},jsts.geom.Geometry.prototype.coveredBy=function(t){return t.covers(this)},jsts.geom.Geometry.prototype.relate=function(t,e){return 1===arguments.length?this.relate2.apply(this,arguments):this.relate2(t).matches(e)},jsts.geom.Geometry.prototype.relate2=function(t){return this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),jsts.operation.relate.RelateOp.relate(this,t)},jsts.geom.Geometry.prototype.equalsTopo=function(t){return!!this.getEnvelopeInternal().equals(t.getEnvelopeInternal())&&this.relate(t).isEquals(this.getDimension(),t.getDimension())},jsts.geom.Geometry.prototype.equals=function(t){return(t instanceof jsts.geom.Geometry||t instanceof jsts.geom.LinearRing||t instanceof jsts.geom.Polygon||t instanceof jsts.geom.GeometryCollection||t instanceof jsts.geom.MultiPoint||t instanceof jsts.geom.MultiLineString||t instanceof jsts.geom.MultiPolygon)&&this.equalsExact(t)},jsts.geom.Geometry.prototype.buffer=function(t,e,o){var n=new jsts.operation.buffer.BufferParameters(e,o);return jsts.operation.buffer.BufferOp.bufferOp2(this,t,n)},jsts.geom.Geometry.prototype.convexHull=function(){return new jsts.algorithm.ConvexHull(this).getConvexHull()},jsts.geom.Geometry.prototype.intersection=function(t){if(this.isEmpty())return this.getFactory().createGeometryCollection(null);if(t.isEmpty())return this.getFactory().createGeometryCollection(null);if(this.isGeometryCollection(this));return this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,t,jsts.operation.overlay.OverlayOp.INTERSECTION)},jsts.geom.Geometry.prototype.union=function(t){return 0===arguments.length?jsts.operation.union.UnaryUnionOp.union(this):this.isEmpty()?t.clone():t.isEmpty()?this.clone():(this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,t,jsts.operation.overlay.OverlayOp.UNION))},jsts.geom.Geometry.prototype.difference=function(t){return this.isEmpty()?this.getFactory().createGeometryCollection(null):t.isEmpty()?this.clone():(this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,t,jsts.operation.overlay.OverlayOp.DIFFERENCE))},jsts.geom.Geometry.prototype.symDifference=function(t){return this.isEmpty()?t.clone():t.isEmpty()?this.clone():(this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,t,jsts.operation.overlay.OverlayOp.SYMDIFFERENCE))},jsts.geom.Geometry.prototype.equalsExact=function(t,e){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.equalsNorm=function(t){return null!==t&&void 0!==t&&this.norm().equalsExact(t.norm())},jsts.geom.Geometry.prototype.apply=function(t){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.clone=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.normalize=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.norm=function(){var t=this.clone();return t.normalize(),t},jsts.geom.Geometry.prototype.compareTo=function(t){var e=t;return this.getClassSortIndex()!==e.getClassSortIndex()?this.getClassSortIndex()-e.getClassSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)},jsts.geom.Geometry.prototype.isEquivalentClass=function(t){return this instanceof jsts.geom.Point&&t instanceof jsts.geom.Point||(!!(this instanceof jsts.geom.LineString&&t instanceof jsts.geom.LineString|t instanceof jsts.geom.LinearRing)||(!!(this instanceof jsts.geom.LinearRing&&t instanceof jsts.geom.LineString|t instanceof jsts.geom.LinearRing)||(this instanceof jsts.geom.Polygon&&t instanceof jsts.geom.Polygon||(this instanceof jsts.geom.MultiPoint&&t instanceof jsts.geom.MultiPoint||(this instanceof jsts.geom.MultiLineString&&t instanceof jsts.geom.MultiLineString||(this instanceof jsts.geom.MultiPolygon&&t instanceof jsts.geom.MultiPolygon||this instanceof jsts.geom.GeometryCollection&&t instanceof jsts.geom.GeometryCollection))))))},jsts.geom.Geometry.prototype.checkNotGeometryCollection=function(t){if(t.isGeometryCollectionBase())throw new jsts.error.IllegalArgumentError("This method does not support GeometryCollection")},jsts.geom.Geometry.prototype.isGeometryCollection=function(){return this instanceof jsts.geom.GeometryCollection},jsts.geom.Geometry.prototype.isGeometryCollectionBase=function(){return"jsts.geom.GeometryCollection"===this.CLASS_NAME},jsts.geom.Geometry.prototype.computeEnvelopeInternal=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.compareToSameClass=function(t){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.compare=function(t,e){for(var o=t.iterator(),n=e.iterator();o.hasNext()&&n.hasNext();){var i=o.next(),r=n.next(),s=i.compareTo(r);if(0!==s)return s}return o.hasNext()?1:n.hasNext()?-1:0},jsts.geom.Geometry.prototype.equal=function(t,e,o){return void 0===o||null===o||0===o?t.equals(e):t.distance(e)<=o},jsts.geom.Geometry.prototype.getClassSortIndex=function(){for(var t=[jsts.geom.Point,jsts.geom.MultiPoint,jsts.geom.LineString,jsts.geom.LinearRing,jsts.geom.MultiLineString,jsts.geom.Polygon,jsts.geom.MultiPolygon,jsts.geom.GeometryCollection],e=0;e<t.length;e++)if(this instanceof t[e])return e;return jsts.util.Assert.shouldNeverReachHere("Class not supported: "+this),-1},jsts.geom.Geometry.prototype.toString=function(){return(new jsts.io.WKTWriter).write(this)},jsts.geom.Geometry.prototype.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},function(){jsts.geom.Coordinate=function(t,e){"number"==typeof t?(this.x=t,this.y=e):t instanceof jsts.geom.Coordinate?(this.x=parseFloat(t.x),this.y=parseFloat(t.y)):void 0===t||null===t?(this.x=0,this.y=0):"string"==typeof t&&(this.x=parseFloat(t),this.y=parseFloat(e))},jsts.geom.Coordinate.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y},jsts.geom.Coordinate.prototype.clone=function(){return new jsts.geom.Coordinate(this.x,this.y)},jsts.geom.Coordinate.prototype.distance=function(t){var e=this.x-t.x,o=this.y-t.y;return Math.sqrt(e*e+o*o)},jsts.geom.Coordinate.prototype.equals2D=function(t){return this.x===t.x&&this.y===t.y},jsts.geom.Coordinate.prototype.equals=function(t){return!(!t instanceof jsts.geom.Coordinate||void 0===t)&&this.equals2D(t)},jsts.geom.Coordinate.prototype.compareTo=function(t){return this.x<t.x?-1:this.x>t.x?1:this.y<t.y?-1:this.y>t.y?1:0},jsts.geom.Coordinate.prototype.toString=function(){return"("+this.x+", "+this.y+")"}}(),jsts.geom.Envelope=function(){jsts.geom.Envelope.prototype.init.apply(this,arguments)},jsts.geom.Envelope.prototype.minx=null,jsts.geom.Envelope.prototype.maxx=null,jsts.geom.Envelope.prototype.miny=null,jsts.geom.Envelope.prototype.maxy=null,jsts.geom.Envelope.prototype.init=function(){"number"==typeof arguments[0]&&4===arguments.length?this.initFromValues(arguments[0],arguments[1],arguments[2],arguments[3]):arguments[0]instanceof jsts.geom.Coordinate&&1===arguments.length?this.initFromCoordinate(arguments[0]):arguments[0]instanceof jsts.geom.Coordinate&&2===arguments.length?this.initFromCoordinates(arguments[0],arguments[1]):arguments[0]instanceof jsts.geom.Envelope&&1===arguments.length?this.initFromEnvelope(arguments[0]):this.setToNull()},jsts.geom.Envelope.prototype.initFromValues=function(t,e,o,n){t<e?(this.minx=t,this.maxx=e):(this.minx=e,this.maxx=t),o<n?(this.miny=o,this.maxy=n):(this.miny=n,this.maxy=o)},jsts.geom.Envelope.prototype.initFromCoordinates=function(t,e){this.initFromValues(t.x,e.x,t.y,e.y)},jsts.geom.Envelope.prototype.initFromCoordinate=function(t){this.initFromValues(t.x,t.x,t.y,t.y)},jsts.geom.Envelope.prototype.initFromEnvelope=function(t){this.minx=t.minx,this.maxx=t.maxx,this.miny=t.miny,this.maxy=t.maxy},jsts.geom.Envelope.prototype.setToNull=function(){this.minx=0,this.maxx=-1,this.miny=0,this.maxy=-1},jsts.geom.Envelope.prototype.isNull=function(){return this.maxx<this.minx},jsts.geom.Envelope.prototype.getHeight=function(){return this.isNull()?0:this.maxy-this.miny},jsts.geom.Envelope.prototype.getWidth=function(){return this.isNull()?0:this.maxx-this.minx},jsts.geom.Envelope.prototype.getMinX=function(){return this.minx},jsts.geom.Envelope.prototype.getMaxX=function(){return this.maxx},jsts.geom.Envelope.prototype.getMinY=function(){return this.miny},jsts.geom.Envelope.prototype.getMaxY=function(){return this.maxy},jsts.geom.Envelope.prototype.getArea=function(){return this.getWidth()*this.getHeight()},jsts.geom.Envelope.prototype.expandToInclude=function(){arguments[0]instanceof jsts.geom.Coordinate?this.expandToIncludeCoordinate(arguments[0]):arguments[0]instanceof jsts.geom.Envelope?this.expandToIncludeEnvelope(arguments[0]):this.expandToIncludeValues(arguments[0],arguments[1])},jsts.geom.Envelope.prototype.expandToIncludeCoordinate=function(t){this.expandToIncludeValues(t.x,t.y)},jsts.geom.Envelope.prototype.expandToIncludeValues=function(t,e){this.isNull()?(this.minx=t,this.maxx=t,this.miny=e,this.maxy=e):(t<this.minx&&(this.minx=t),t>this.maxx&&(this.maxx=t),e<this.miny&&(this.miny=e),e>this.maxy&&(this.maxy=e))},jsts.geom.Envelope.prototype.expandToIncludeEnvelope=function(t){t.isNull()||(this.isNull()?(this.minx=t.getMinX(),this.maxx=t.getMaxX(),this.miny=t.getMinY(),this.maxy=t.getMaxY()):(t.minx<this.minx&&(this.minx=t.minx),t.maxx>this.maxx&&(this.maxx=t.maxx),t.miny<this.miny&&(this.miny=t.miny),t.maxy>this.maxy&&(this.maxy=t.maxy)))},jsts.geom.Envelope.prototype.expandBy=function(){1===arguments.length?this.expandByDistance(arguments[0]):this.expandByDistances(arguments[0],arguments[1])},jsts.geom.Envelope.prototype.expandByDistance=function(t){this.expandByDistances(t,t)},jsts.geom.Envelope.prototype.expandByDistances=function(t,e){this.isNull()||(this.minx-=t,this.maxx+=t,this.miny-=e,this.maxy+=e,(this.minx>this.maxx||this.miny>this.maxy)&&this.setToNull())},jsts.geom.Envelope.prototype.translate=function(t,e){this.isNull()||this.init(this.minx+t,this.maxx+t,this.miny+e,this.maxy+e)},jsts.geom.Envelope.prototype.centre=function(){return this.isNull()?null:new jsts.geom.Coordinate((this.minx+this.maxx)/2,(this.miny+this.maxy)/2)},jsts.geom.Envelope.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new jsts.geom.Envelope;var e=this.minx>t.minx?this.minx:t.minx,o=this.miny>t.miny?this.miny:t.miny,n=this.maxx<t.maxx?this.maxx:t.maxx,i=this.maxy<t.maxy?this.maxy:t.maxy;return new jsts.geom.Envelope(e,n,o,i)},jsts.geom.Envelope.prototype.intersects=function(){return arguments[0]instanceof jsts.geom.Envelope?this.intersectsEnvelope(arguments[0]):arguments[0]instanceof jsts.geom.Coordinate?this.intersectsCoordinate(arguments[0]):this.intersectsValues(arguments[0],arguments[1])},jsts.geom.Envelope.prototype.intersectsEnvelope=function(t){return!this.isNull()&&!t.isNull()&&!(t.minx>this.maxx||t.maxx<this.minx||t.miny>this.maxy||t.maxy<this.miny)},jsts.geom.Envelope.prototype.intersectsCoordinate=function(t){return this.intersectsValues(t.x,t.y)},jsts.geom.Envelope.prototype.intersectsValues=function(t,e){return!this.isNull()&&!(t>this.maxx||t<this.minx||e>this.maxy||e<this.miny)},jsts.geom.Envelope.prototype.contains=function(){return arguments[0]instanceof jsts.geom.Envelope?this.containsEnvelope(arguments[0]):arguments[0]instanceof jsts.geom.Coordinate?this.containsCoordinate(arguments[0]):this.containsValues(arguments[0],arguments[1])},jsts.geom.Envelope.prototype.containsEnvelope=function(t){return this.coversEnvelope(t)},jsts.geom.Envelope.prototype.containsCoordinate=function(t){return this.coversCoordinate(t)},jsts.geom.Envelope.prototype.containsValues=function(t,e){return this.coversValues(t,e)},jsts.geom.Envelope.prototype.covers=function(t){return t instanceof jsts.geom.Envelope?this.coversEnvelope(arguments[0]):t instanceof jsts.geom.Coordinate?this.coversCoordinate(arguments[0]):this.coversValues(arguments[0],arguments[1])},jsts.geom.Envelope.prototype.coversValues=function(t,e){return!this.isNull()&&(t>=this.minx&&t<=this.maxx&&e>=this.miny&&e<=this.maxy)};jsts.geom.Envelope.prototype.coversCoordinate=function(t){return this.coversValues(t.x,t.y)},jsts.geom.Envelope.prototype.coversEnvelope=function(t){return!this.isNull()&&!t.isNull()&&(t.minx>=this.minx&&t.maxx<=this.maxx&&t.miny>=this.miny&&t.maxy<=this.maxy)},jsts.geom.Envelope.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this.maxx<t.minx&&(e=t.minx-this.maxx),this.minx>t.maxx&&(e=this.minx-t.maxx);var o=0;return this.maxy<t.miny&&(o=t.miny-this.maxy),this.miny>t.maxy&&(o=this.miny-t.maxy),0===e?o:0===o?e:Math.sqrt(e*e+o*o)},jsts.geom.Envelope.prototype.equals=function(t){return this.isNull()?t.isNull():this.maxx===t.maxx&&this.maxy===t.maxy&&this.minx===t.minx&&this.miny===t.miny},jsts.geom.Envelope.prototype.toString=function(){return"Env["+this.minx+" : "+this.maxx+", "+this.miny+" : "+this.maxy+"]"},jsts.geom.Envelope.intersects=function(t,e,o){if(4===arguments.length)return jsts.geom.Envelope.intersectsEnvelope(arguments[0],arguments[1],arguments[2],arguments[3]);var n=t.x<e.x?t.x:e.x,i=t.x>e.x?t.x:e.x,r=t.y<e.y?t.y:e.y,s=t.y>e.y?t.y:e.y;return o.x>=n&&o.x<=i&&o.y>=r&&o.y<=s},jsts.geom.Envelope.intersectsEnvelope=function(t,e,o,n){var i=Math.min(o.x,n.x),r=Math.max(o.x,n.x),s=Math.min(t.x,e.x),a=Math.max(t.x,e.x);return!(s>r)&&(!(a<i)&&(i=Math.min(o.y,n.y),r=Math.max(o.y,n.y),s=Math.min(t.y,e.y),a=Math.max(t.y,e.y),!(s>r)&&!(a<i)))},jsts.geom.Envelope.prototype.clone=function(){return new jsts.geom.Envelope(this.minx,this.maxx,this.miny,this.maxy)},jsts.geom.util.GeometryCombiner=function(t){this.geomFactory=jsts.geom.util.GeometryCombiner.extractFactory(t),this.inputGeoms=t},jsts.geom.util.GeometryCombiner.combine=function(t){return arguments.length>1?this.combine2.apply(this,arguments):new jsts.geom.util.GeometryCombiner(t).combine()},jsts.geom.util.GeometryCombiner.combine2=function(){var t=new javascript.util.ArrayList;for(var e in arguments)t.add(arguments[e]);return new jsts.geom.util.GeometryCombiner(t).combine()},jsts.geom.util.GeometryCombiner.prototype.geomFactory=null,jsts.geom.util.GeometryCombiner.prototype.skipEmpty=!1,jsts.geom.util.GeometryCombiner.prototype.inputGeoms,jsts.geom.util.GeometryCombiner.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},jsts.geom.util.GeometryCombiner.prototype.combine=function(){var t,e=new javascript.util.ArrayList;for(t=this.inputGeoms.iterator();t.hasNext();){var o=t.next();this.extractElements(o,e)}return 0===e.size()?null!==this.geomFactory?geomFactory.createGeometryCollection(null):null:this.geomFactory.buildGeometry(e)},jsts.geom.util.GeometryCombiner.prototype.extractElements=function(t,e){if(null!==t)for(var o=0;o<t.getNumGeometries();o++){var n=t.getGeometryN(o);this.skipEmpty&&n.isEmpty()||e.add(n)}},jsts.geom.PrecisionModel=function(t){if("number"==typeof t)return this.modelType=jsts.geom.PrecisionModel.FIXED,void(this.scale=t);this.modelType=t||jsts.geom.PrecisionModel.FLOATING,this.modelType===jsts.geom.PrecisionModel.FIXED&&(this.scale=1)},jsts.geom.PrecisionModel.FLOATING="FLOATING",jsts.geom.PrecisionModel.FIXED="FIXED",jsts.geom.PrecisionModel.FLOATING_SINGLE="FLOATING_SINGLE",jsts.geom.PrecisionModel.prototype.scale=null,jsts.geom.PrecisionModel.prototype.modelType=null,jsts.geom.PrecisionModel.prototype.isFloating=function(){return this.modelType===jsts.geom.PrecisionModel.FLOATING||this.modelType===jsts.geom.PrecisionModel.FLOATING_SINLGE},jsts.geom.PrecisionModel.prototype.getScale=function(){return this.scale},jsts.geom.PrecisionModel.prototype.getType=function(){return this.modelType},jsts.geom.PrecisionModel.prototype.equals=function(t){return!0},jsts.geom.PrecisionModel.prototype.makePrecise=function(t){return t instanceof jsts.geom.Coordinate?void this.makePrecise2(t):isNaN(t)?t:this.modelType===jsts.geom.PrecisionModel.FIXED?Math.round(t*this.scale)/this.scale:t},jsts.geom.PrecisionModel.prototype.makePrecise2=function(t){this.modelType!==jsts.geom.PrecisionModel.FLOATING&&(t.x=this.makePrecise(t.x),t.y=this.makePrecise(t.y))},jsts.geom.PrecisionModel.prototype.compareTo=function(t){return 0},jsts.geom.CoordinateFilter=function(){},jsts.geom.CoordinateFilter.prototype.filter=function(t){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Point=function(t,e){this.factory=e,void 0!==t&&(this.coordinate=t)},jsts.geom.Point.prototype=new jsts.geom.Geometry,jsts.geom.Point.constructor=jsts.geom.Point,jsts.geom.Point.CLASS_NAME="jsts.geom.Point",jsts.geom.Point.prototype.coordinate=null,jsts.geom.Point.prototype.getX=function(){return this.coordinate.x},jsts.geom.Point.prototype.getY=function(){return this.coordinate.y},jsts.geom.Point.prototype.getCoordinate=function(){return this.coordinate},jsts.geom.Point.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.coordinate]},jsts.geom.Point.prototype.isEmpty=function(){return null===this.coordinate},jsts.geom.Point.prototype.equalsExact=function(t,e){return!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.equal(t.getCoordinate(),this.getCoordinate(),e))},jsts.geom.Point.prototype.getNumPoints=function(){return this.isEmpty()?0:1},jsts.geom.Point.prototype.isSimple=function(){return!0},jsts.geom.Point.prototype.getBoundary=function(){return new jsts.geom.GeometryCollection(null)},jsts.geom.Point.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new jsts.geom.Envelope:new jsts.geom.Envelope(this.coordinate)},jsts.geom.Point.prototype.apply=function(t){if(t instanceof jsts.geom.GeometryFilter||t instanceof jsts.geom.GeometryComponentFilter)t.filter(this);else if(t instanceof jsts.geom.CoordinateFilter){if(this.isEmpty())return;t.filter(this.getCoordinate())}},jsts.geom.Point.prototype.clone=function(){return new jsts.geom.Point(this.coordinate.clone(),this.factory)},jsts.geom.Point.prototype.getDimension=function(){return 0},jsts.geom.Point.prototype.getBoundaryDimension=function(){return jsts.geom.Dimension.FALSE},jsts.geom.Point.prototype.reverse=function(){return this.clone()},jsts.geom.Point.prototype.isValid=function(){return!!jsts.operation.valid.IsValidOp.isValid(this.getCoordinate())},jsts.geom.Point.prototype.normalize=function(){},jsts.geom.Point.prototype.compareToSameClass=function(t){var e=t;return this.getCoordinate().compareTo(e.getCoordinate())},jsts.geom.Point.prototype.getGeometryType=function(){return"Point"},jsts.geom.Point.prototype.hashCode=function(){return"Point_"+this.coordinate.hashCode()},jsts.geom.Point.prototype.CLASS_NAME="jsts.geom.Point",jsts.geomgraph.EdgeIntersection=function(t,e,o){this.coord=new jsts.geom.Coordinate(t),this.segmentIndex=e,this.dist=o},jsts.geomgraph.EdgeIntersection.prototype.coord=null,jsts.geomgraph.EdgeIntersection.prototype.segmentIndex=null,jsts.geomgraph.EdgeIntersection.prototype.dist=null,jsts.geomgraph.EdgeIntersection.prototype.getCoordinate=function(){return this.coord},jsts.geomgraph.EdgeIntersection.prototype.getSegmentIndex=function(){return this.segmentIndex},jsts.geomgraph.EdgeIntersection.prototype.getDistance=function(){return this.dist},jsts.geomgraph.EdgeIntersection.prototype.compareTo=function(t){return this.compare(t.segmentIndex,t.dist)},jsts.geomgraph.EdgeIntersection.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},jsts.geomgraph.EdgeIntersection.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},jsts.geomgraph.EdgeIntersection.prototype.toString=function(){return""+this.segmentIndex+this.dist},function(){var t=jsts.geomgraph.EdgeIntersection,e=javascript.util.TreeMap;jsts.geomgraph.EdgeIntersectionList=function(t){this.nodeMap=new e,this.edge=t},jsts.geomgraph.EdgeIntersectionList.prototype.nodeMap=null,jsts.geomgraph.EdgeIntersectionList.prototype.edge=null,jsts.geomgraph.EdgeIntersectionList.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();){if(e.next().coord.equals(t))return!0}return!1},jsts.geomgraph.EdgeIntersectionList.prototype.add=function(e,o,n){var i=new t(e,o,n),r=this.nodeMap.get(i);return null!==r?r:(this.nodeMap.put(i,i),i)},jsts.geomgraph.EdgeIntersectionList.prototype.iterator=function(){return this.nodeMap.values().iterator()},jsts.geomgraph.EdgeIntersectionList.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},jsts.geomgraph.EdgeIntersectionList.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),o=e.next();e.hasNext();){var n=e.next(),i=this.createSplitEdge(o,n);t.add(i),o=n}},jsts.geomgraph.EdgeIntersectionList.prototype.createSplitEdge=function(t,e){var o=e.segmentIndex-t.segmentIndex+2,n=this.edge.pts[e.segmentIndex],i=e.dist>0||!e.coord.equals2D(n);i||o--;var r=[],s=0;r[s++]=new jsts.geom.Coordinate(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)r[s++]=this.edge.pts[a];return i&&(r[s]=e.coord),new jsts.geomgraph.Edge(r,new jsts.geomgraph.Label(this.edge.label))}}(),function(){var t=function(t){this.message=t};t.prototype=new Error,t.prototype.name="AssertionFailedException",jsts.util.AssertionFailedException=t}(),function(){var t=jsts.util.AssertionFailedException;jsts.util.Assert=function(){},jsts.util.Assert.isTrue=function(e,o){if(!e)throw null===o?new t:new t(o)},jsts.util.Assert.equals=function(e,o,n){if(!o.equals(e))throw new t("Expected "+e+" but encountered "+o+(null!=n?": "+n:""))},jsts.util.Assert.shouldNeverReachHere=function(e){throw new t("Should never reach here"+(null!=e?": "+e:""))}}(),function(){var t=jsts.geom.Location,e=jsts.util.Assert,o=javascript.util.ArrayList;jsts.operation.relate.RelateComputer=function(t){this.li=new jsts.algorithm.RobustLineIntersector,this.ptLocator=new jsts.algorithm.PointLocator,this.nodes=new jsts.geomgraph.NodeMap(new jsts.operation.relate.RelateNodeFactory),this.isolatedEdges=new o,this.arg=t},jsts.operation.relate.RelateComputer.prototype.li=null,jsts.operation.relate.RelateComputer.prototype.ptLocator=null,jsts.operation.relate.RelateComputer.prototype.arg=null,jsts.operation.relate.RelateComputer.prototype.nodes=null,jsts.operation.relate.RelateComputer.prototype.im=null,jsts.operation.relate.RelateComputer.prototype.isolatedEdges=null,jsts.operation.relate.RelateComputer.prototype.invalidPoint=null,jsts.operation.relate.RelateComputer.prototype.computeIM=function(){var e=new jsts.geom.IntersectionMatrix;if(e.set(t.EXTERIOR,t.EXTERIOR,2),!this.arg[0].getGeometry().getEnvelopeInternal().intersects(this.arg[1].getGeometry().getEnvelopeInternal()))return this.computeDisjointIM(e),e;this.arg[0].computeSelfNodes(this.li,!1),this.arg[1].computeSelfNodes(this.li,!1);var o=this.arg[0].computeEdgeIntersections(this.arg[1],this.li,!1);this.computeIntersectionNodes(0),this.computeIntersectionNodes(1),this.copyNodesAndLabels(0),this.copyNodesAndLabels(1),this.labelIsolatedNodes(),this.computeProperIntersectionIM(o,e);var n=new jsts.operation.relate.EdgeEndBuilder,i=n.computeEdgeEnds(this.arg[0].getEdgeIterator());this.insertEdgeEnds(i);var r=n.computeEdgeEnds(this.arg[1].getEdgeIterator());return this.insertEdgeEnds(r),this.labelNodeEdges(),this.labelIsolatedEdges(0,1),this.labelIsolatedEdges(1,0),this.updateIM(e),e},jsts.operation.relate.RelateComputer.prototype.insertEdgeEnds=function(t){for(var e=t.iterator();e.hasNext();){var o=e.next();this.nodes.add(o)}},jsts.operation.relate.RelateComputer.prototype.computeProperIntersectionIM=function(t,e){var o=this.arg[0].getGeometry().getDimension(),n=this.arg[1].getGeometry().getDimension(),i=t.hasProperIntersection(),r=t.hasProperInteriorIntersection();2===o&&2===n?i&&e.setAtLeast("212101212"):2===o&&1===n?(i&&e.setAtLeast("FFF0FFFF2"),r&&e.setAtLeast("1FFFFF1FF")):1===o&&2===n?(i&&e.setAtLeast("F0FFFFFF2"),r&&e.setAtLeast("1F1FFFFFF")):1===o&&1===n&&r&&e.setAtLeast("0FFFFFFFF")},jsts.operation.relate.RelateComputer.prototype.copyNodesAndLabels=function(t){for(var e=this.arg[t].getNodeIterator();e.hasNext();){var o=e.next();this.nodes.addNode(o.getCoordinate()).setLabel(t,o.getLabel().getLocation(t))}},jsts.operation.relate.RelateComputer.prototype.computeIntersectionNodes=function(e){for(var o=this.arg[e].getEdgeIterator();o.hasNext();)for(var n=o.next(),i=n.getLabel().getLocation(e),r=n.getEdgeIntersectionList().iterator();r.hasNext();){var s=r.next(),a=this.nodes.addNode(s.coord);i===t.BOUNDARY?a.setLabelBoundary(e):a.getLabel().isNull(e)&&a.setLabel(e,t.INTERIOR)}},jsts.operation.relate.RelateComputer.prototype.labelIntersectionNodes=function(e){for(var o=this.arg[e].getEdgeIterator();o.hasNext();)for(var n=o.next(),i=n.getLabel().getLocation(e),r=n.getEdgeIntersectionList().iterator();r.hasNext();){var s=r.next(),a=this.nodes.find(s.coord);a.getLabel().isNull(e)&&(i===t.BOUNDARY?a.setLabelBoundary(e):a.setLabel(e,t.INTERIOR))}},jsts.operation.relate.RelateComputer.prototype.computeDisjointIM=function(e){var o=this.arg[0].getGeometry();o.isEmpty()||(e.set(t.INTERIOR,t.EXTERIOR,o.getDimension()),e.set(t.BOUNDARY,t.EXTERIOR,o.getBoundaryDimension()));var n=this.arg[1].getGeometry();n.isEmpty()||(e.set(t.EXTERIOR,t.INTERIOR,n.getDimension()),e.set(t.EXTERIOR,t.BOUNDARY,n.getBoundaryDimension()))},jsts.operation.relate.RelateComputer.prototype.labelNodeEdges=function(){for(var t=this.nodes.iterator();t.hasNext();){t.next().getEdges().computeLabelling(this.arg)}},jsts.operation.relate.RelateComputer.prototype.updateIM=function(t){for(var e=this.isolatedEdges.iterator();e.hasNext();){e.next().updateIM(t)}for(var o=this.nodes.iterator();o.hasNext();){var n=o.next();n.updateIM(t),n.updateIMFromEdges(t)}},jsts.operation.relate.RelateComputer.prototype.labelIsolatedEdges=function(t,e){for(var o=this.arg[t].getEdgeIterator();o.hasNext();){var n=o.next();n.isIsolated()&&(this.labelIsolatedEdge(n,e,this.arg[e].getGeometry()),this.isolatedEdges.add(n))}},jsts.operation.relate.RelateComputer.prototype.labelIsolatedEdge=function(e,o,n){if(n.getDimension()>0){var i=this.ptLocator.locate(e.getCoordinate(),n);e.getLabel().setAllLocations(o,i)}else e.getLabel().setAllLocations(o,t.EXTERIOR)},jsts.operation.relate.RelateComputer.prototype.labelIsolatedNodes=function(){for(var t=this.nodes.iterator();t.hasNext();){var o=t.next(),n=o.getLabel();e.isTrue(n.getGeometryCount()>0,"node with empty label found"),o.isIsolated()&&(n.isNull(0)?this.labelIsolatedNode(o,0):this.labelIsolatedNode(o,1))}},jsts.operation.relate.RelateComputer.prototype.labelIsolatedNode=function(t,e){var o=this.ptLocator.locate(t.getCoordinate(),this.arg[e].getGeometry());t.getLabel().setAllLocations(e,o)}}(),function(){jsts.io.GeoJSONWriter=function(){this.parser=new jsts.io.GeoJSONParser(this.geometryFactory)},jsts.io.GeoJSONWriter.prototype.write=function(t){return this.parser.write(t)}}(),function(){var t=jsts.util.Assert;jsts.geomgraph.GraphComponent=function(t){this.label=t},jsts.geomgraph.GraphComponent.prototype.label=null,jsts.geomgraph.GraphComponent.prototype._isInResult=!1,jsts.geomgraph.GraphComponent.prototype._isCovered=!1,jsts.geomgraph.GraphComponent.prototype._isCoveredSet=!1,jsts.geomgraph.GraphComponent.prototype._isVisited=!1,jsts.geomgraph.GraphComponent.prototype.getLabel=function(){return this.label},jsts.geomgraph.GraphComponent.prototype.setLabel=function(t){if(2===arguments.length)return void this.setLabel2.apply(this,arguments);this.label=t},jsts.geomgraph.GraphComponent.prototype.setInResult=function(t){this._isInResult=t},jsts.geomgraph.GraphComponent.prototype.isInResult=function(){return this._isInResult},jsts.geomgraph.GraphComponent.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},jsts.geomgraph.GraphComponent.prototype.isCovered=function(){return this._isCovered},jsts.geomgraph.GraphComponent.prototype.isCoveredSet=function(){return this._isCoveredSet},jsts.geomgraph.GraphComponent.prototype.isVisited=function(){return this._isVisited},jsts.geomgraph.GraphComponent.prototype.setVisited=function(t){this._isVisited=t},jsts.geomgraph.GraphComponent.prototype.getCoordinate=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geomgraph.GraphComponent.prototype.computeIM=function(t){throw new jsts.error.AbstractMethodInvocationError},jsts.geomgraph.GraphComponent.prototype.isIsolated=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geomgraph.GraphComponent.prototype.updateIM=function(e){t.isTrue(this.label.getGeometryCount()>=2,"found partial label"),this.computeIM(e)}}(),jsts.geomgraph.Node=function(t,e){this.coord=t,this.edges=e,this.label=new jsts.geomgraph.Label(0,jsts.geom.Location.NONE)},jsts.geomgraph.Node.prototype=new jsts.geomgraph.GraphComponent,jsts.geomgraph.Node.prototype.coord=null,jsts.geomgraph.Node.prototype.edges=null,jsts.geomgraph.Node.prototype.isIsolated=function(){return 1==this.label.getGeometryCount()},jsts.geomgraph.Node.prototype.setLabel2=function(t,e){null===this.label?this.label=new jsts.geomgraph.Label(t,e):this.label.setLocation(t,e)},jsts.geomgraph.Node.prototype.setLabelBoundary=function(t){var e=jsts.geom.Location.NONE;null!==this.label&&(e=this.label.getLocation(t));var o;switch(e){case jsts.geom.Location.BOUNDARY:o=jsts.geom.Location.INTERIOR;break;case jsts.geom.Location.INTERIOR:default:o=jsts.geom.Location.BOUNDARY}this.label.setLocation(t,o)},jsts.geomgraph.Node.prototype.add=function(t){this.edges.insert(t),t.setNode(this)},jsts.geomgraph.Node.prototype.getCoordinate=function(){return this.coord},jsts.geomgraph.Node.prototype.getEdges=function(){return this.edges},jsts.geomgraph.Node.prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();){if(t.next().getEdge().isInResult())return!0}return!1},function(){var t=function(t){this.deList=new javascript.util.ArrayList,this.factory=t};t.findEdgeRingContaining=function(t,e){for(var o=t.getRing(),n=o.getEnvelopeInternal(),i=o.getCoordinateN(0),r=null,s=null,a=e.iterator();a.hasNext();){var l=a.next(),c=l.getRing(),u=c.getEnvelopeInternal();null!=r&&(s=r.getRing().getEnvelopeInternal());var h=!1;u.equals(n)||(i=jsts.geom.CoordinateArrays.ptNotInList(o.getCoordinates(),c.getCoordinates()),u.contains(n)&&jsts.algorithm.CGAlgorithms.isPointInRing(i,c.getCoordinates())&&(h=!0),h&&(null==r||s.contains(u))&&(r=l))}return r},t.ptNotInList=function(t,e){for(var o=0;o<t.length;o++){var n=t[o];if(!isInList(n,e))return n}return null},t.isInList=function(t,e){for(var o=0;o<e.length;o++)if(t.equals(e[o]))return!0;return!1},t.prototype.factory=null,t.prototype.deList=null,t.prototype.ring=null,t.prototype.ringPts=null,t.prototype.holes=null,t.prototype.add=function(t){this.deList.add(t)},t.prototype.isHole=function(){var t=this.getRing();return jsts.algorithm.CGAlgorithms.isCCW(t.getCoordinates())},t.prototype.addHole=function(t){null==this.holes&&(this.holes=new javascript.util.ArrayList),this.holes.add(t)},t.prototype.getPolygon=function(){var t=null;if(null!=this.holes){t=[];for(var e=0;e<this.holes.size();e++)t[e]=this.holes.get(e)}return this.factory.createPolygon(this.ring,t)},t.prototype.isValid=function(){return this.getCoordinates(),!(this.ringPts.length<=3)&&(this.getRing(),this.ring.isValid())},t.prototype.getCoordinates=function(){if(null==this.ringPts){for(var e=new jsts.geom.CoordinateList,o=this.deList.iterator();o.hasNext();){var n=o.next(),i=n.getEdge();t.addEdge(i.getLine().getCoordinates(),n.getEdgeDirection(),e)}this.ringPts=e.toCoordinateArray()}return this.ringPts},t.prototype.getLineString=function(){return this.getCoordinates(),this.factory.createLineString(this.ringPts)},t.prototype.getRing=function(){if(null!=this.ring)return this.ring;this.getCoordinates(),this.ringPts.length<3&&console.log(this.ringPts);try{this.ring=this.factory.createLinearRing(this.ringPts)}catch(t){console.log(this.ringPts)}return this.ring},t.addEdge=function(t,e,o){if(e)for(var n=0;n<t.length;n++)o.add(t[n],!1);else for(var n=t.length-1;n>=0;n--)o.add(t[n],!1)},jsts.operation.polygonize.EdgeRing=t}(),function(){var t=function(){};t.setVisited=function(t,e){for(;t.hasNext();){t.next().setVisited(e)}},t.setMarked=function(t,e){for(;t.hasNext();){t.next().setMarked(e)}},t.getComponentWithVisitedState=function(t,e){for(;t.hasNext();){var o=t.next();if(o.isVisited()==e)return o}return null},t.prototype._isMarked=!1,t.prototype._isVisited=!1,t.prototype.data,t.prototype.isVisited=function(){return this._isVisited},t.prototype.setVisited=function(t){this._isVisited=t},t.prototype.isMarked=function(){return this._isMarked},t.prototype.setMarked=function(t){this._isMarked=t},t.prototype.setContext=function(t){this.data=t},t.prototype.getContext=function(){return data},t.prototype.setData=function(t){this.data=t},t.prototype.getData=function(){return data},t.prototype.isRemoved=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.planargraph.GraphComponent=t}(),function(){var t=jsts.planargraph.GraphComponent,e=function(t,e){void 0!==t&&this.setDirectedEdges(t,e)};e.prototype=new t,e.prototype.dirEdge=null,e.prototype.setDirectedEdges=function(t,e){this.dirEdge=[t,e],t.setEdge(this),e.setEdge(this),t.setSym(e),e.setSym(t),t.getFromNode().addOutEdge(t),e.getFromNode().addOutEdge(e)},e.prototype.getDirEdge=function(t){return t instanceof jsts.planargraph.Node&&this.getDirEdge2(t),this.dirEdge[t]},e.prototype.getDirEdge2=function(t){return this.dirEdge[0].getFromNode()==t?this.dirEdge[0]:this.dirEdge[1].getFromNode()==t?this.dirEdge[1]:null},e.prototype.getOppositeNode=function(t){return this.dirEdge[0].getFromNode()==t?this.dirEdge[0].getToNode():this.dirEdge[1].getFromNode()==t?this.dirEdge[1].getToNode():null},e.prototype.remove=function(){this.dirEdge=null},e.prototype.isRemoved=function(){return null==dirEdge},jsts.planargraph.Edge=e}(),jsts.operation.polygonize.PolygonizeEdge=function(t){this.line=t},jsts.operation.polygonize.PolygonizeEdge.prototype=new jsts.planargraph.Edge,jsts.operation.polygonize.PolygonizeEdge.prototype.line=null,jsts.operation.polygonize.PolygonizeEdge.prototype.getLine=function(){return this.line},function(){var t=javascript.util.ArrayList,e=jsts.planargraph.GraphComponent,o=function(t,e,o,n){if(void 0!==t){this.from=t,this.to=e,this.edgeDirection=n,this.p0=t.getCoordinate(),this.p1=o;var i=this.p1.x-this.p0.x,r=this.p1.y-this.p0.y;this.quadrant=jsts.geomgraph.Quadrant.quadrant(i,r),this.angle=Math.atan2(r,i)}};o.prototype=new e,o.toEdges=function(e){for(var o=new t,n=e.iterator();n.hasNext();)o.add(n.next().parentEdge);return o},o.prototype.parentEdge=null,o.prototype.from=null,o.prototype.to=null,o.prototype.p0=null,o.prototype.p1=null,o.prototype.sym=null,o.prototype.edgeDirection=null,o.prototype.quadrant=null,o.prototype.angle=null,o.prototype.getEdge=function(){return this.parentEdge},o.prototype.setEdge=function(t){this.parentEdge=t},o.prototype.getQuadrant=function(){return this.quadrant},o.prototype.getDirectionPt=function(){return this.p1},o.prototype.getEdgeDirection=function(){return this.edgeDirection},o.prototype.getFromNode=function(){return this.from},o.prototype.getToNode=function(){return this.to},o.prototype.getCoordinate=function(){return this.from.getCoordinate()},o.prototype.getAngle=function(){return this.angle},o.prototype.getSym=function(){return this.sym},o.prototype.setSym=function(t){this.sym=t},o.prototype.remove=function(){this.sym=null,this.parentEdge=null},o.prototype.isRemoved=function(){return null==this.parentEdge},o.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)},o.prototype.compareDirection=function(t){return this.quadrant>t.quadrant?1:this.quadrant<t.quadrant?-1:jsts.algorithm.CGAlgorithms.computeOrientation(t.p0,t.p1,this.p1)},jsts.planargraph.DirectedEdge=o}(),function(){var t=jsts.planargraph.DirectedEdge,e=function(e,o,n,i){t.apply(this,arguments)};e.prototype=new t,e.prototype.edgeRing=null,e.prototype.next=null,e.prototype.label=-1,e.prototype.getLabel=function(){return this.label},e.prototype.setLabel=function(t){this.label=t},e.prototype.getNext=function(){return this.next},e.prototype.setNext=function(t){this.next=t},e.prototype.isInRing=function(){return null!=this.edgeRing},e.prototype.setRing=function(t){this.edgeRing=t},jsts.operation.polygonize.PolygonizeDirectedEdge=e}(),function(){var t=javascript.util.ArrayList,e=function(){this.outEdges=new t};e.prototype.outEdges=null,e.prototype.sorted=!1,e.prototype.add=function(t){this.outEdges.add(t),this.sorted=!1},e.prototype.remove=function(t){this.outEdges.remove(t)},e.prototype.iterator=function(){return this.sortEdges(),this.outEdges.iterator()},e.prototype.getDegree=function(){return this.outEdges.size()},e.prototype.getCoordinate=function(){var t=iterator();return t.hasNext()?t.next().getCoordinate():null},e.prototype.getEdges=function(){return this.sortEdges(),this.outEdges},e.prototype.sortEdges=function(){if(!this.sorted){var t=this.outEdges.toArray();t.sort(function(t,e){return t.compareTo(e)}),this.outEdges=javascript.util.Arrays.asList(t),this.sorted=!0}},e.prototype.getIndex=function(t){if(t instanceof jsts.planargraph.DirectedEdge)return this.getIndex2(t);if("number"==typeof t)return this.getIndex3(t);this.sortEdges();for(var e=0;e<this.outEdges.size();e++){if(this.outEdges.get(e).getEdge()==t)return e}return-1},e.prototype.getIndex2=function(t){this.sortEdges();for(var e=0;e<this.outEdges.size();e++){if(this.outEdges.get(e)==t)return e}return-1},e.prototype.getIndex3=function(t){var e=toInt(t%this.outEdges.size());return e<0&&(e+=this.outEdges.size()),e},e.prototype.getNextEdge=function(t){var e=this.getIndex(t);return this.outEdges.get(getIndex(e+1))},e.prototype.getNextCWEdge=function(t){var e=this.getIndex(t);return this.outEdges.get(getIndex(e-1))},jsts.planargraph.DirectedEdgeStar=e}(),function(){var t=jsts.planargraph.GraphComponent,e=jsts.planargraph.DirectedEdgeStar,o=function(t,o){this.pt=t,this.deStar=o||new e};o.prototype=new t,o.getEdgesBetween=function(t,e){var o=DirectedEdge.toEdges(t.getOutEdges().getEdges()),n=new javascript.util.HashSet(o),i=DirectedEdge.toEdges(e.getOutEdges().getEdges());return n.retainAll(i),n},o.prototype.pt=null,o.prototype.deStar=null,o.prototype.getCoordinate=function(){return this.pt},o.prototype.addOutEdge=function(t){this.deStar.add(t)},o.prototype.getOutEdges=function(){return this.deStar},o.prototype.getDegree=function(){return this.deStar.getDegree()},o.prototype.getIndex=function(t){return this.deStar.getIndex(t)},o.prototype.remove=function(t){if(void 0===t)return this.remove2();this.deStar.remove(t)},o.prototype.remove2=function(){this.pt=null},o.prototype.isRemoved=function(){return null==this.pt},jsts.planargraph.Node=o}(),function(){var t=function(){this.nodeMap=new javascript.util.TreeMap};t.prototype.nodeMap=null,t.prototype.add=function(t){return this.nodeMap.put(t.getCoordinate(),t),t},t.prototype.remove=function(t){return this.nodeMap.remove(t)},t.prototype.find=function(t){return this.nodeMap.get(t)},t.prototype.iterator=function(){return this.nodeMap.values().iterator()},t.prototype.values=function(){return this.nodeMap.values()},jsts.planargraph.NodeMap=t}(),function(){var t=javascript.util.ArrayList,e=function(){this.edges=new javascript.util.HashSet,this.dirEdges=new javascript.util.HashSet,this.nodeMap=new jsts.planargraph.NodeMap};e.prototype.edges=null,e.prototype.dirEdges=null,e.prototype.nodeMap=null,e.prototype.findNode=function(t){return this.nodeMap.find(t)},e.prototype.add=function(t){return t instanceof jsts.planargraph.Edge?this.add2(t):t instanceof jsts.planargraph.DirectedEdge?this.add3(t):void this.nodeMap.add(t)},e.prototype.add2=function(t){this.edges.add(t),this.add(t.getDirEdge(0)),this.add(t.getDirEdge(1))},e.prototype.add3=function(t){this.dirEdges.add(t)},e.prototype.nodeIterator=function(){return this.nodeMap.iterator()},e.prototype.contains=function(t){return t instanceof jsts.planargraph.DirectedEdge?this.contains2(t):this.edges.contains(t)},e.prototype.contains2=function(t){return this.dirEdges.contains(t)},e.prototype.getNodes=function(){return this.nodeMap.values()},e.prototype.dirEdgeIterator=function(){return this.dirEdges.iterator()},e.prototype.edgeIterator=function(){return this.edges.iterator()},e.prototype.getEdges=function(){return this.edges},e.prototype.remove=function(t){if(t instanceof jsts.planargraph.DirectedEdge)return this.remove2(t);this.remove(t.getDirEdge(0)),this.remove(t.getDirEdge(1)),this.edges.remove(t),this.edge.remove()},e.prototype.remove2=function(t){if(t instanceof jsts.planargraph.Node)return this.remove3(t);var e=t.getSym();null!=e&&e.setSym(null),t.getFromNode().remove(t),t.remove(),this.dirEdges.remove(t)},e.prototype.remove3=function(t){for(var e=t.getOutEdges().getEdges(),o=e.iterator();o.hasNext();){var n=o.next(),i=n.getSym();null!=i&&this.remove(i),this.dirEdges.remove(n);var r=n.getEdge();null!=r&&this.edges.remove(r)}this.nodeMap.remove(t.getCoordinate()),t.remove()},e.prototype.findNodesOfDegree=function(e){for(var o=new t,n=this.nodeIterator();n.hasNext();){var i=n.next();i.getDegree()==e&&o.add(i)}return o},jsts.planargraph.PlanarGraph=e}(),function(){var t=javascript.util.ArrayList,e=javascript.util.Stack,o=javascript.util.HashSet,n=jsts.util.Assert,i=jsts.operation.polygonize.EdgeRing,r=jsts.operation.polygonize.PolygonizeEdge,s=jsts.operation.polygonize.PolygonizeDirectedEdge,a=jsts.planargraph.PlanarGraph,l=jsts.planargraph.Node,c=function(t){a.apply(this),this.factory=t};c.prototype=new a,c.getDegreeNonDeleted=function(t){for(var e=t.getOutEdges().getEdges(),o=0,n=e.iterator();n.hasNext();){n.next().isMarked()||o++}return o},c.getDegree=function(t,e){for(var o=t.getOutEdges().getEdges(),n=0,i=o.iterator();i.hasNext();){i.next().getLabel()==e&&n++}return n},c.deleteAllEdges=function(t){for(var e=t.getOutEdges().getEdges(),o=e.iterator();o.hasNext();){var n=o.next();n.setMarked(!0);var i=n.getSym();null!=i&&i.setMarked(!0)}},c.prototype.factory=null,c.prototype.addEdge=function(t){if(!t.isEmpty()){var e=jsts.geom.CoordinateArrays.removeRepeatedPoints(t.getCoordinates());if(!(e.length<2)){var o=e[0],n=e[e.length-1],i=this.getNode(o),a=this.getNode(n),l=new s(i,a,e[1],!0),c=new s(a,i,e[e.length-2],!1),u=new r(t);u.setDirectedEdges(l,c),this.add(u)}}},c.prototype.getNode=function(t){var e=this.findNode(t);return null==e&&(e=new l(t),this.add(e)),e},c.prototype.computeNextCWEdges=function(){for(var t=this.nodeIterator();t.hasNext();){var e=t.next();c.computeNextCWEdges(e)}},c.prototype.convertMaximalToMinimalEdgeRings=function(t){for(var e=t.iterator();e.hasNext();){var o=e.next(),n=o.getLabel(),i=c.findIntersectionNodes(o,n);if(null!=i)for(var r=i.iterator();r.hasNext();){var s=r.next();c.computeNextCCWEdges(s,n)}}},c.findIntersectionNodes=function(e,o){var i=e,r=null;do{var s=i.getFromNode();c.getDegree(s,o)>1&&(null==r&&(r=new t),r.add(s)),i=i.getNext(),n.isTrue(null!=i,"found null DE in ring"),n.isTrue(i==e||!i.isInRing(),"found DE already in ring")}while(i!=e);return r},c.prototype.getEdgeRings=function(){this.computeNextCWEdges(),c.label(this.dirEdges,-1);var e=c.findLabeledEdgeRings(this.dirEdges);this.convertMaximalToMinimalEdgeRings(e);for(var o=new t,n=this.dirEdges.iterator();n.hasNext();){var i=n.next();if(!i.isMarked()&&!i.isInRing()){var r=this.findEdgeRing(i);o.add(r)}}return o},c.findLabeledEdgeRings=function(e){for(var o=new t,n=1,i=e.iterator();i.hasNext();){var r=i.next();if(!r.isMarked()&&!(r.getLabel()>=0)){o.add(r);var s=c.findDirEdgesInRing(r);c.label(s,n),n++}}return o},c.prototype.deleteCutEdges=function(){this.computeNextCWEdges(),c.findLabeledEdgeRings(this.dirEdges);for(var e=new t,o=this.dirEdges.iterator();o.hasNext();){var n=o.next();if(!n.isMarked()){var i=n.getSym();if(n.getLabel()==i.getLabel()){n.setMarked(!0),i.setMarked(!0);var r=n.getEdge();e.add(r.getLine())}}}return e},c.label=function(t,e){for(var o=t.iterator();o.hasNext();){o.next().setLabel(e)}},c.computeNextCWEdges=function(t){for(var e=t.getOutEdges(),o=null,n=null,i=e.getEdges().iterator();i.hasNext();){var r=i.next();if(!r.isMarked()){if(null==o&&(o=r),null!=n){var s=n.getSym();s.setNext(r)}n=r}}if(null!=n){var s=n.getSym();s.setNext(o)}},c.computeNextCCWEdges=function(t,e){for(var o=t.getOutEdges(),i=null,r=null,s=o.getEdges(),a=s.size()-1;a>=0;a--){var l=s.get(a),c=l.getSym(),u=null;l.getLabel()==e&&(u=l);var h=null;c.getLabel()==e&&(h=c),null==u&&null==h||(null!=h&&(r=h),null!=u&&(null!=r&&(r.setNext(u),r=null),null==i&&(i=u)))}null!=r&&(n.isTrue(null!=i),r.setNext(i))},c.findDirEdgesInRing=function(e){var o=e,i=new t;do{i.add(o),o=o.getNext(),n.isTrue(null!=o,"found null DE in ring"),n.isTrue(o==e||!o.isInRing(),"found DE already in ring")}while(o!=e);return i},c.prototype.findEdgeRing=function(t){var e=t,o=new i(this.factory);do{o.add(e),e.setRing(o),e=e.getNext(),n.isTrue(null!=e,"found null DE in ring"),n.isTrue(e==t||!e.isInRing(),"found DE already in ring")}while(e!=t);return o},c.prototype.deleteDangles=function(){for(var t=this.findNodesOfDegree(1),n=new o,i=new e,r=t.iterator();r.hasNext();)i.push(r.next());for(;!i.isEmpty();){var s=i.pop();c.deleteAllEdges(s);for(var a=s.getOutEdges().getEdges(),r=a.iterator();r.hasNext();){var l=r.next();l.setMarked(!0);var u=l.getSym();null!=u&&u.setMarked(!0);var h=l.getEdge();n.add(h.getLine());var g=l.getToNode();1==c.getDegreeNonDeleted(g)&&i.push(g)}}return n},c.prototype.computeDepthParity=function(){for(;;){return}},c.prototype.computeDepthParity=function(t){},jsts.operation.polygonize.PolygonizeGraph=c}(),jsts.index.strtree.Interval=function(){var t;if(1===arguments.length)return t=arguments[0],jsts.index.strtree.Interval(t.min,t.max);2===arguments.length&&(jsts.util.Assert.isTrue(this.min<=this.max),this.min=arguments[0],this.max=arguments[1])},jsts.index.strtree.Interval.prototype.min=null,jsts.index.strtree.Interval.prototype.max=null,jsts.index.strtree.Interval.prototype.getCentre=function(){return(this.min+this.max)/2},jsts.index.strtree.Interval.prototype.expandToInclude=function(t){return this.max=Math.max(this.max,t.max),this.min=Math.min(this.min,t.min),this},jsts.index.strtree.Interval.prototype.intersects=function(t){return!(t.min>this.max||t.max<this.min)},jsts.index.strtree.Interval.prototype.equals=function(t){return t instanceof jsts.index.strtree.Interval&&(other=t,this.min===other.min&&this.max===other.max)},jsts.geom.GeometryFactory=function(t){this.precisionModel=t||new jsts.geom.PrecisionModel},jsts.geom.GeometryFactory.prototype.precisionModel=null,jsts.geom.GeometryFactory.prototype.getPrecisionModel=function(){return this.precisionModel},jsts.geom.GeometryFactory.prototype.createPoint=function(t){return new jsts.geom.Point(t,this)},jsts.geom.GeometryFactory.prototype.createLineString=function(t){return new jsts.geom.LineString(t,this)},jsts.geom.GeometryFactory.prototype.createLinearRing=function(t){return new jsts.geom.LinearRing(t,this)},jsts.geom.GeometryFactory.prototype.createPolygon=function(t,e){return new jsts.geom.Polygon(t,e,this)},jsts.geom.GeometryFactory.prototype.createMultiPoint=function(t){if(t&&t[0]instanceof jsts.geom.Coordinate){var e,o=[];for(e=0;e<t.length;e++)o.push(this.createPoint(t[e]));t=o}return new jsts.geom.MultiPoint(t,this)},jsts.geom.GeometryFactory.prototype.createMultiLineString=function(t){return new jsts.geom.MultiLineString(t,this)},jsts.geom.GeometryFactory.prototype.createMultiPolygon=function(t){return new jsts.geom.MultiPolygon(t,this)},jsts.geom.GeometryFactory.prototype.buildGeometry=function(t){for(var e=null,o=!1,n=!1,i=t.iterator();i.hasNext();){var r=i.next(),s=r.CLASS_NAME;null===e&&(e=s),s!==e&&(o=!0),r.isGeometryCollectionBase()&&(n=!0)}if(null===e)return this.createGeometryCollection(null);if(o||n)return this.createGeometryCollection(t.toArray());var a=t.get(0);if(t.size()>1){if(a instanceof jsts.geom.Polygon)return this.createMultiPolygon(t.toArray());if(a instanceof jsts.geom.LineString)return this.createMultiLineString(t.toArray());if(a instanceof jsts.geom.Point)return this.createMultiPoint(t.toArray());jsts.util.Assert.shouldNeverReachHere("Unhandled class: "+a)}return a},jsts.geom.GeometryFactory.prototype.createGeometryCollection=function(t){return new jsts.geom.GeometryCollection(t,this)},jsts.geom.GeometryFactory.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new jsts.geom.Coordinate(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new jsts.geom.Coordinate(t.getMinX(),t.getMinY()),new jsts.geom.Coordinate(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new jsts.geom.Coordinate(t.getMinX(),t.getMinY()),new jsts.geom.Coordinate(t.getMinX(),t.getMaxY()),new jsts.geom.Coordinate(t.getMaxX(),t.getMaxY()),new jsts.geom.Coordinate(t.getMaxX(),t.getMinY()),new jsts.geom.Coordinate(t.getMinX(),t.getMinY())]),null)},jsts.geomgraph.NodeFactory=function(){},jsts.geomgraph.NodeFactory.prototype.createNode=function(t){return new jsts.geomgraph.Node(t,null)},function(){jsts.geomgraph.Position=function(){},jsts.geomgraph.Position.ON=0,jsts.geomgraph.Position.LEFT=1,jsts.geomgraph.Position.RIGHT=2,jsts.geomgraph.Position.opposite=function(t){return t===jsts.geomgraph.Position.LEFT?jsts.geomgraph.Position.RIGHT:t===jsts.geomgraph.Position.RIGHT?jsts.geomgraph.Position.LEFT:t}}(),jsts.geomgraph.TopologyLocation=function(){if(this.location=[],3===arguments.length){var t=arguments[0],e=arguments[1],o=arguments[2];this.init(3),this.location[jsts.geomgraph.Position.ON]=t,this.location[jsts.geomgraph.Position.LEFT]=e,this.location[jsts.geomgraph.Position.RIGHT]=o}else if(arguments[0]instanceof jsts.geomgraph.TopologyLocation){var n=arguments[0];if(this.init(n.location.length),null!=n)for(var i=0;i<this.location.length;i++)this.location[i]=n.location[i]}else if("number"==typeof arguments[0]){var t=arguments[0];this.init(1),this.location[jsts.geomgraph.Position.ON]=t}else if(arguments[0]instanceof Array){var r=arguments[0];this.init(r.length)}},jsts.geomgraph.TopologyLocation.prototype.location=null,jsts.geomgraph.TopologyLocation.prototype.init=function(t){this.location[t-1]=null,this.setAllLocations(jsts.geom.Location.NONE)},jsts.geomgraph.TopologyLocation.prototype.get=function(t){return t<this.location.length?this.location[t]:jsts.geom.Location.NONE},jsts.geomgraph.TopologyLocation.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==jsts.geom.Location.NONE)return!1;return!0},jsts.geomgraph.TopologyLocation.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===jsts.geom.Location.NONE)return!0;return!1},jsts.geomgraph.TopologyLocation.prototype.isEqualOnSide=function(t,e){return this.location[e]==t.location[e]},jsts.geomgraph.TopologyLocation.prototype.isArea=function(){return this.location.length>1},jsts.geomgraph.TopologyLocation.prototype.isLine=function(){return 1===this.location.length},jsts.geomgraph.TopologyLocation.prototype.flip=function(){if(!(this.location.length<=1)){var t=this.location[jsts.geomgraph.Position.LEFT];this.location[jsts.geomgraph.Position.LEFT]=this.location[jsts.geomgraph.Position.RIGHT],this.location[jsts.geomgraph.Position.RIGHT]=t}},jsts.geomgraph.TopologyLocation.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},jsts.geomgraph.TopologyLocation.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===jsts.geom.Location.NONE&&(this.location[e]=t)},jsts.geomgraph.TopologyLocation.prototype.setLocation=function(t,e){void 0!==e?this.location[t]=e:this.setLocation(jsts.geomgraph.Position.ON,t)},jsts.geomgraph.TopologyLocation.prototype.getLocations=function(){return location},jsts.geomgraph.TopologyLocation.prototype.setLocations=function(t,e,o){this.location[jsts.geomgraph.Position.ON]=t,this.location[jsts.geomgraph.Position.LEFT]=e,this.location[jsts.geomgraph.Position.RIGHT]=o},jsts.geomgraph.TopologyLocation.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},jsts.geomgraph.TopologyLocation.prototype.merge=function(t){if(t.location.length>this.location.length){var e=[];e[jsts.geomgraph.Position.ON]=this.location[jsts.geomgraph.Position.ON],e[jsts.geomgraph.Position.LEFT]=jsts.geom.Location.NONE,e[jsts.geomgraph.Position.RIGHT]=jsts.geom.Location.NONE,this.location=e}for(var o=0;o<this.location.length;o++)this.location[o]===jsts.geom.Location.NONE&&o<t.location.length&&(this.location[o]=t.location[o])},jsts.geomgraph.Label=function(){this.elt=[];var t,e,o,n,i;4===arguments.length?(t=arguments[0],e=arguments[1],o=arguments[2],i=arguments[3],this.elt[0]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE,jsts.geom.Location.NONE,jsts.geom.Location.NONE),this.elt[1]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE,jsts.geom.Location.NONE,jsts.geom.Location.NONE),this.elt[t].setLocations(e,o,i)):3===arguments.length?(e=arguments[0],o=arguments[1],i=arguments[2],this.elt[0]=new jsts.geomgraph.TopologyLocation(e,o,i),this.elt[1]=new jsts.geomgraph.TopologyLocation(e,o,i)):2===arguments.length?(t=arguments[0],e=arguments[1],this.elt[0]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE),this.elt[1]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE),this.elt[t].setLocation(e)):arguments[0]instanceof jsts.geomgraph.Label?(n=arguments[0],this.elt[0]=new jsts.geomgraph.TopologyLocation(n.elt[0]),this.elt[1]=new jsts.geomgraph.TopologyLocation(n.elt[1])):"number"==typeof arguments[0]&&(e=arguments[0],this.elt[0]=new jsts.geomgraph.TopologyLocation(e),this.elt[1]=new jsts.geomgraph.TopologyLocation(e))},jsts.geomgraph.Label.toLineLabel=function(t){var e,o=new jsts.geomgraph.Label(jsts.geom.Location.NONE);for(e=0;e<2;e++)o.setLocation(e,t.getLocation(e));return o},jsts.geomgraph.Label.prototype.elt=null,jsts.geomgraph.Label.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},jsts.geomgraph.Label.prototype.getLocation=function(t,e){return 1==arguments.length?this.getLocation2.apply(this,arguments):this.elt[t].get(e)},jsts.geomgraph.Label.prototype.getLocation2=function(t){return this.elt[t].get(jsts.geomgraph.Position.ON)},jsts.geomgraph.Label.prototype.setLocation=function(t,e,o){if(2==arguments.length)return void this.setLocation2.apply(this,arguments);this.elt[t].setLocation(e,o)},jsts.geomgraph.Label.prototype.setLocation2=function(t,e){this.elt[t].setLocation(jsts.geomgraph.Position.ON,e)},jsts.geomgraph.Label.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)},jsts.geomgraph.Label.prototype.setAllLocationsIfNull=function(t,e){if(1==arguments.length)return void this.setAllLocationsIfNull2.apply(this,arguments);this.elt[t].setAllLocationsIfNull(e)},jsts.geomgraph.Label.prototype.setAllLocationsIfNull2=function(t){this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)},jsts.geomgraph.Label.prototype.merge=function(t){var e;for(e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new jsts.geomgraph.TopologyLocation(t.elt[e]):this.elt[e].merge(t.elt[e])},jsts.geomgraph.Label.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},jsts.geomgraph.Label.prototype.isNull=function(t){return this.elt[t].isNull()},jsts.geomgraph.Label.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},jsts.geomgraph.Label.prototype.isArea=function(){return 1==arguments.length?this.isArea2(arguments[0]):this.elt[0].isArea()||this.elt[1].isArea()},jsts.geomgraph.Label.prototype.isArea2=function(t){return this.elt[t].isArea()},jsts.geomgraph.Label.prototype.isLine=function(t){return this.elt[t].isLine()},jsts.geomgraph.Label.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},jsts.geomgraph.Label.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},jsts.geomgraph.Label.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new jsts.geomgraph.TopologyLocation(this.elt[t].location[0]))},jsts.geomgraph.EdgeRing=function(t,e){this.edges=[],this.pts=[],this.holes=[],this.label=new jsts.geomgraph.Label(jsts.geom.Location.NONE),this.geometryFactory=e,t&&(this.computePoints(t),this.computeRing())},jsts.geomgraph.EdgeRing.prototype.startDe=null,jsts.geomgraph.EdgeRing.prototype.maxNodeDegree=-1,jsts.geomgraph.EdgeRing.prototype.edges=null,jsts.geomgraph.EdgeRing.prototype.pts=null,jsts.geomgraph.EdgeRing.prototype.label=null,jsts.geomgraph.EdgeRing.prototype.ring=null,jsts.geomgraph.EdgeRing.prototype._isHole=null,jsts.geomgraph.EdgeRing.prototype.shell=null,jsts.geomgraph.EdgeRing.prototype.holes=null,jsts.geomgraph.EdgeRing.prototype.geometryFactory=null,jsts.geomgraph.EdgeRing.prototype.isIsolated=function(){return 1==this.label.getGeometryCount()},jsts.geomgraph.EdgeRing.prototype.isHole=function(){return this._isHole},jsts.geomgraph.EdgeRing.prototype.getCoordinate=function(t){return this.pts[t]},jsts.geomgraph.EdgeRing.prototype.getLinearRing=function(){return this.ring},jsts.geomgraph.EdgeRing.prototype.getLabel=function(){return this.label},jsts.geomgraph.EdgeRing.prototype.isShell=function(){return null===this.shell},jsts.geomgraph.EdgeRing.prototype.getShell=function(){return this.shell},jsts.geomgraph.EdgeRing.prototype.setShell=function(t){this.shell=t,null!==t&&t.addHole(this)},jsts.geomgraph.EdgeRing.prototype.addHole=function(t){this.holes.push(t)},jsts.geomgraph.EdgeRing.prototype.toPolygon=function(t){for(var e=[],o=0;o<this.holes.length;o++)e[o]=this.holes[o].getLinearRing();return this.geometryFactory.createPolygon(this.getLinearRing(),e)},jsts.geomgraph.EdgeRing.prototype.computeRing=function(){if(null===this.ring){for(var t=[],e=0;e<this.pts.length;e++)t[e]=this.pts[e];this.ring=this.geometryFactory.createLinearRing(t),this._isHole=jsts.algorithm.CGAlgorithms.isCCW(this.ring.getCoordinates())}},jsts.geomgraph.EdgeRing.prototype.getNext=function(t){throw new jsts.error.AbstractInvocationError},jsts.geomgraph.EdgeRing.prototype.setEdgeRing=function(t,e){throw new jsts.error.AbstractInvocationError},jsts.geomgraph.EdgeRing.prototype.getEdges=function(){return this.edges},jsts.geomgraph.EdgeRing.prototype.computePoints=function(t){this.startDe=t;var e=t,o=!0;do{if(null===e)throw new jsts.error.TopologyError("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new jsts.error.TopologyError("Directed Edge visited twice during ring-building at "+e.getCoordinate());this.edges.push(e);var n=e.getLabel();jsts.util.Assert.isTrue(n.isArea()),this.mergeLabel(n),this.addPoints(e.getEdge(),e.isForward(),o),o=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this.startDe)},jsts.geomgraph.EdgeRing.prototype.getMaxNodeDegree=function(){return this.maxNodeDegree<0&&this.computeMaxNodeDegree(),this.maxNodeDegree},jsts.geomgraph.EdgeRing.prototype.computeMaxNodeDegree=function(){this.maxNodeDegree=0;var t=this.startDe;do{var e=t.getNode(),o=e.getEdges().getOutgoingDegree(this);o>this.maxNodeDegree&&(this.maxNodeDegree=o),t=this.getNext(t)}while(t!==this.startDe);this.maxNodeDegree*=2},jsts.geomgraph.EdgeRing.prototype.setInResult=function(){var t=this.startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!=this.startDe)},jsts.geomgraph.EdgeRing.prototype.mergeLabel=function(t){this.mergeLabel2(t,0),this.mergeLabel2(t,1)},jsts.geomgraph.EdgeRing.prototype.mergeLabel2=function(t,e){var o=t.getLocation(e,jsts.geomgraph.Position.RIGHT);if(o!=jsts.geom.Location.NONE)return this.label.getLocation(e)===jsts.geom.Location.NONE?void this.label.setLocation(e,o):void 0},jsts.geomgraph.EdgeRing.prototype.addPoints=function(t,e,o){var n=t.getCoordinates();if(e){var i=1;o&&(i=0);for(var r=i;r<n.length;r++)this.pts.push(n[r])}else{var i=n.length-2;o&&(i=n.length-1);for(var r=i;r>=0;r--)this.pts.push(n[r])}},jsts.geomgraph.EdgeRing.prototype.containsPoint=function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!jsts.algorithm.CGAlgorithms.isPointInRing(t,e.getCoordinates()))return!1;for(var o=0;o<this.holes.length;o++){if(this.holes[o].containsPoint(t))return!1}return!0},jsts.geom.Dimension=function(){},jsts.geom.Dimension.P=0,jsts.geom.Dimension.L=1,jsts.geom.Dimension.A=2,jsts.geom.Dimension.FALSE=-1,jsts.geom.Dimension.TRUE=-2;jsts.geom.Dimension.DONTCARE=-3,jsts.geom.Dimension.toDimensionSymbol=function(t){switch(t){case jsts.geom.Dimension.FALSE:return"F";case jsts.geom.Dimension.TRUE:return"T";case jsts.geom.Dimension.DONTCARE:return"*";case jsts.geom.Dimension.P:return"0";case jsts.geom.Dimension.L:return"1";case jsts.geom.Dimension.A:return"2"}throw new jsts.IllegalArgumentError("Unknown dimension value: "+t)},jsts.geom.Dimension.toDimensionValue=function(t){switch(t.toUpperCase()){case"F":return jsts.geom.Dimension.FALSE;case"T":return jsts.geom.Dimension.TRUE;case"*":return jsts.geom.Dimension.DONTCARE;case"0":return jsts.geom.Dimension.P;case"1":return jsts.geom.Dimension.L;case"2":return jsts.geom.Dimension.A}throw new jsts.error.IllegalArgumentError("Unknown dimension symbol: "+t)},function(){var t=jsts.geom.Dimension;jsts.geom.LineString=function(t,e){this.factory=e,this.points=t||[]},jsts.geom.LineString.prototype=new jsts.geom.Geometry,jsts.geom.LineString.constructor=jsts.geom.LineString,jsts.geom.LineString.prototype.points=null,jsts.geom.LineString.prototype.getCoordinates=function(){return this.points},jsts.geom.LineString.prototype.getCoordinateSequence=function(){return this.points},jsts.geom.LineString.prototype.getCoordinateN=function(t){return this.points[t]},jsts.geom.LineString.prototype.getCoordinate=function(){return this.isEmpty()?null:this.getCoordinateN(0)},jsts.geom.LineString.prototype.getDimension=function(){return 1},jsts.geom.LineString.prototype.getBoundaryDimension=function(){return this.isClosed()?t.FALSE:0},jsts.geom.LineString.prototype.isEmpty=function(){return 0===this.points.length},jsts.geom.LineString.prototype.getNumPoints=function(){return this.points.length},jsts.geom.LineString.prototype.getPointN=function(t){return this.getFactory().createPoint(this.points[t])},jsts.geom.LineString.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},jsts.geom.LineString.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},jsts.geom.LineString.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.points.length-1))},jsts.geom.LineString.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},jsts.geom.LineString.prototype.getGeometryType=function(){return"LineString"},jsts.geom.LineString.prototype.getLength=function(){return jsts.algorithm.CGAlgorithms.computeLength(this.points)},jsts.geom.LineString.prototype.getBoundary=function(){return new jsts.operation.BoundaryOp(this).getBoundary()},jsts.geom.LineString.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new jsts.geom.Envelope;var t=new jsts.geom.Envelope;return this.points.forEach(function(e){t.expandToInclude(e)}),t},jsts.geom.LineString.prototype.equalsExact=function(t,e){return!!this.isEquivalentClass(t)&&(this.points.length===t.points.length&&(!(!this.isEmpty()||!t.isEmpty())||this.points.reduce(function(o,n,i){return o&&jsts.geom.Geometry.prototype.equal(n,t.points[i],e)})))},jsts.geom.LineString.prototype.isEquivalentClass=function(t){return t instanceof jsts.geom.LineString},jsts.geom.LineString.prototype.compareToSameClass=function(t){for(var e=t,o=0,n=this.points.length,i=0,r=e.points.length;o<n&&i<r;){var s=this.points[o].compareTo(e.points[i]);if(0!==s)return s;o++,i++}return o<n?1:i<r?-1:0},jsts.geom.LineString.prototype.apply=function(t){if(t instanceof jsts.geom.GeometryFilter||t instanceof jsts.geom.GeometryComponentFilter)t.filter(this);else if(t instanceof jsts.geom.CoordinateFilter)for(var e=0,o=this.points.length;e<o;e++)t.filter(this.points[e]);else t instanceof jsts.geom.CoordinateSequenceFilter&&this.apply2.apply(this,arguments)},jsts.geom.LineString.prototype.apply2=function(t){if(0!==this.points.length){for(var e=0;e<this.points.length&&(t.filter(this.points,e),!t.isDone());e++);t.isGeometryChanged()}},jsts.geom.LineString.prototype.clone=function(){for(var t=[],e=0,o=this.points.length;e<o;e++)t.push(this.points[e].clone());return this.factory.createLineString(t)},jsts.geom.LineString.prototype.normalize=function(){var t,e,o,n,i,r;for(r=this.points.length,e=parseInt(r/2),t=0;t<e;t++)if(o=r-1-t,n=this.points[t],i=this.points[o],!n.equals(i))return void(n.compareTo(i)>0&&this.points.reverse())},jsts.geom.LineString.prototype.CLASS_NAME="jsts.geom.LineString"}(),function(){jsts.geom.LinearRing=function(t,e){jsts.geom.LineString.apply(this,arguments)},jsts.geom.LinearRing.prototype=new jsts.geom.LineString,jsts.geom.LinearRing.constructor=jsts.geom.LinearRing,jsts.geom.LinearRing.prototype.getBoundaryDimension=function(){return jsts.geom.Dimension.FALSE},jsts.geom.LinearRing.prototype.isSimple=function(){return!0},jsts.geom.LinearRing.prototype.getGeometryType=function(){return"LinearRing"},jsts.geom.LinearRing.MINIMUM_VALID_SIZE=4,jsts.geom.LinearRing.prototype.CLASS_NAME="jsts.geom.LinearRing"}(),jsts.index.strtree.Boundable=function(){},jsts.index.strtree.Boundable.prototype.getBounds=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.index.strtree.AbstractNode=function(t){this.level=t,this.childBoundables=[]},jsts.index.strtree.AbstractNode.prototype=new jsts.index.strtree.Boundable,jsts.index.strtree.AbstractNode.constructor=jsts.index.strtree.AbstractNode,jsts.index.strtree.AbstractNode.prototype.childBoundables=null,jsts.index.strtree.AbstractNode.prototype.bounds=null,jsts.index.strtree.AbstractNode.prototype.level=null,jsts.index.strtree.AbstractNode.prototype.getChildBoundables=function(){return this.childBoundables},jsts.index.strtree.AbstractNode.prototype.computeBounds=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.index.strtree.AbstractNode.prototype.getBounds=function(){return null===this.bounds&&(this.bounds=this.computeBounds()),this.bounds},jsts.index.strtree.AbstractNode.prototype.getLevel=function(){return this.level},jsts.index.strtree.AbstractNode.prototype.addChildBoundable=function(t){this.childBoundables.push(t)},jsts.operation.buffer.SubgraphDepthLocater=function(t){this.subgraphs=[],this.seg=new jsts.geom.LineSegment,this.subgraphs=t},jsts.operation.buffer.SubgraphDepthLocater.prototype.subgraphs=null,jsts.operation.buffer.SubgraphDepthLocater.prototype.seg=null,jsts.operation.buffer.SubgraphDepthLocater.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);return 0===e.length?0:(e.sort(),e[0].leftDepth)},jsts.operation.buffer.SubgraphDepthLocater.prototype.findStabbedSegments=function(t){if(3===arguments.length)return void this.findStabbedSegments2.apply(this,arguments);for(var e=[],o=0;o<this.subgraphs.length;o++){var n=this.subgraphs[o],i=n.getEnvelope();t.y<i.getMinY()||t.y>i.getMaxY()||this.findStabbedSegments2(t,n.getDirectedEdges(),e)}return e},jsts.operation.buffer.SubgraphDepthLocater.prototype.findStabbedSegments2=function(t,e,o){if(arguments[1]instanceof jsts.geomgraph.DirectedEdge)return void this.findStabbedSegments3(t,e,o);for(var n=e.iterator();n.hasNext();){var i=n.next();i.isForward()&&this.findStabbedSegments3(t,i,o)}},jsts.operation.buffer.SubgraphDepthLocater.prototype.findStabbedSegments3=function(t,e,o){for(var n=e.getEdge().getCoordinates(),i=0;i<n.length-1;i++){this.seg.p0=n[i],this.seg.p1=n[i+1],this.seg.p0.y>this.seg.p1.y&&this.seg.reverse();if(!(Math.max(this.seg.p0.x,this.seg.p1.x)<t.x)&&!(this.seg.isHorizontal()||t.y<this.seg.p0.y||t.y>this.seg.p1.y||jsts.algorithm.CGAlgorithms.computeOrientation(this.seg.p0,this.seg.p1,t)===jsts.algorithm.CGAlgorithms.RIGHT)){var r=e.getDepth(jsts.geomgraph.Position.LEFT);this.seg.p0.equals(n[i])||(r=e.getDepth(jsts.geomgraph.Position.RIGHT));var s=new jsts.operation.buffer.SubgraphDepthLocater.DepthSegment(this.seg,r);o.push(s)}}},jsts.operation.buffer.SubgraphDepthLocater.DepthSegment=function(t,e){this.upwardSeg=new jsts.geom.LineSegment(t),this.leftDepth=e},jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.upwardSeg=null,jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.leftDepth=null,jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.compareTo=function(t){var e=t,o=this.upwardSeg.orientationIndex(e.upwardSeg);return 0===o&&(o=-1*e.upwardSeg.orientationIndex(upwardSeg)),0!==o?o:this.compareX(this.upwardSeg,e.upwardSeg)},jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.compareX=function(t,e){var o=t.p0.compareTo(e.p0);return 0!==o?o:t.p1.compareTo(e.p1)},jsts.simplify.LineSegmentIndex=function(){this.index=new jsts.index.quadtree.Quadtree},jsts.simplify.LineSegmentIndex.prototype.index=null,jsts.simplify.LineSegmentIndex.prototype.add=function(t){if(t instanceof jsts.geom.LineSegment)return void this.add2(t);for(var e=t.getSegments(),o=0;o<e.length;o++){var n=e[o];this.add2(n)}},jsts.simplify.LineSegmentIndex.prototype.add2=function(t){this.index.insert(new jsts.geom.Envelope(t.p0,t.p1),t)},jsts.simplify.LineSegmentIndex.prototype.remove=function(t){this.index.remove(new jsts.geom.Envelope(t.p0,t.p1),t)},jsts.simplify.LineSegmentIndex.prototype.query=function(t){var e=new jsts.geom.Envelope(t.p0,t.p1),o=new jsts.simplify.LineSegmentIndex.LineSegmentVisitor(t);return this.index.query(e,o),o.getItems()},jsts.simplify.LineSegmentIndex.LineSegmentVisitor=function(t){this.items=[],this.querySeg=t},jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype=new jsts.index.ItemVisitor,jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.querySeg=null,jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.items=null,jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.visitItem=function(t){var e=t;jsts.geom.Envelope.intersects(e.p0,e.p1,this.querySeg.p0,this.querySeg.p1)&&this.items.push(t)},jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.getItems=function(){return this.items},jsts.geomgraph.EdgeEndStar=function(){this.edgeMap=new javascript.util.TreeMap,this.edgeList=null,this.ptInAreaLocation=[jsts.geom.Location.NONE,jsts.geom.Location.NONE]},jsts.geomgraph.EdgeEndStar.prototype.edgeMap=null,jsts.geomgraph.EdgeEndStar.prototype.edgeList=null,jsts.geomgraph.EdgeEndStar.prototype.ptInAreaLocation=null,jsts.geomgraph.EdgeEndStar.prototype.insert=function(t){throw new jsts.error.AbstractMethodInvocationError},jsts.geomgraph.EdgeEndStar.prototype.insertEdgeEnd=function(t,e){this.edgeMap.put(t,e),this.edgeList=null},jsts.geomgraph.EdgeEndStar.prototype.getCoordinate=function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},jsts.geomgraph.EdgeEndStar.prototype.getDegree=function(){return this.edgeMap.size()},jsts.geomgraph.EdgeEndStar.prototype.iterator=function(){return this.getEdges().iterator()},jsts.geomgraph.EdgeEndStar.prototype.getEdges=function(){return null===this.edgeList&&(this.edgeList=new javascript.util.ArrayList(this.edgeMap.values())),this.edgeList},jsts.geomgraph.EdgeEndStar.prototype.getNextCW=function(t){this.getEdges();var e=this.edgeList.indexOf(t),o=e-1;return 0===e&&(o=this.edgeList.length-1),this.edgeList[o]},jsts.geomgraph.EdgeEndStar.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],o=this.iterator();o.hasNext();)for(var n=o.next(),i=n.getLabel(),r=0;r<2;r++)i.isLine(r)&&i.getLocation(r)===jsts.geom.Location.BOUNDARY&&(e[r]=!0);for(var o=this.iterator();o.hasNext();)for(var n=o.next(),i=n.getLabel(),r=0;r<2;r++)if(i.isAnyNull(r)){var s=jsts.geom.Location.NONE;if(e[r])s=jsts.geom.Location.EXTERIOR;else{var a=n.getCoordinate();s=this.getLocation(r,a,t)}i.setAllLocationsIfNull(r,s)}},jsts.geomgraph.EdgeEndStar.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();){e.next().computeLabel(t)}},jsts.geomgraph.EdgeEndStar.prototype.getLocation=function(t,e,o){return this.ptInAreaLocation[t]===jsts.geom.Location.NONE&&(this.ptInAreaLocation[t]=jsts.algorithm.locate.SimplePointInAreaLocator.locate(e,o[t].getGeometry())),this.ptInAreaLocation[t]},jsts.geomgraph.EdgeEndStar.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},jsts.geomgraph.EdgeEndStar.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var o=e.size()-1,n=e.get(o).getLabel(),i=n.getLocation(t,jsts.geomgraph.Position.LEFT);jsts.util.Assert.isTrue(i!=jsts.geom.Location.NONE,"Found unlabelled area edge");for(var r=i,s=this.iterator();s.hasNext();){var a=s.next(),l=a.getLabel();jsts.util.Assert.isTrue(l.isArea(t),"Found non-area edge");var c=l.getLocation(t,jsts.geomgraph.Position.LEFT),u=l.getLocation(t,jsts.geomgraph.Position.RIGHT);if(c===u)return!1;if(u!==r)return!1;r=c}return!0},jsts.geomgraph.EdgeEndStar.prototype.propagateSideLabels=function(t){for(var e=jsts.geom.Location.NONE,o=this.iterator();o.hasNext();){var n=o.next(),i=n.getLabel();i.isArea(t)&&i.getLocation(t,jsts.geomgraph.Position.LEFT)!==jsts.geom.Location.NONE&&(e=i.getLocation(t,jsts.geomgraph.Position.LEFT))}if(e!==jsts.geom.Location.NONE)for(var r=e,o=this.iterator();o.hasNext();){var n=o.next(),i=n.getLabel();if(i.getLocation(t,jsts.geomgraph.Position.ON)===jsts.geom.Location.NONE&&i.setLocation(t,jsts.geomgraph.Position.ON,r),i.isArea(t)){var s=i.getLocation(t,jsts.geomgraph.Position.LEFT),a=i.getLocation(t,jsts.geomgraph.Position.RIGHT);if(a!==jsts.geom.Location.NONE){if(a!==r)throw new jsts.error.TopologyError("side location conflict",n.getCoordinate());s===jsts.geom.Location.NONE&&jsts.util.Assert.shouldNeverReachHere("found single null side (at "+n.getCoordinate()+")"),r=s}else jsts.util.Assert.isTrue(i.getLocation(t,jsts.geomgraph.Position.LEFT)===jsts.geom.Location.NONE,"found single null side"),i.setLocation(t,jsts.geomgraph.Position.RIGHT,r),i.setLocation(t,jsts.geomgraph.Position.LEFT,r)}}},jsts.geomgraph.EdgeEndStar.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this.edgeList.size();e++){if(this.edgeList.get(e)===t)return e}return-1},jsts.operation.relate.EdgeEndBundleStar=function(){jsts.geomgraph.EdgeEndStar.apply(this,arguments)},jsts.operation.relate.EdgeEndBundleStar.prototype=new jsts.geomgraph.EdgeEndStar,jsts.operation.relate.EdgeEndBundleStar.prototype.insert=function(t){var e=this.edgeMap.get(t);null===e?(e=new jsts.operation.relate.EdgeEndBundle(t),this.insertEdgeEnd(t,e)):e.insert(t)},jsts.operation.relate.EdgeEndBundleStar.prototype.updateIM=function(t){for(var e=this.iterator();e.hasNext();){e.next().updateIM(t)}},function(){jsts.geom.Polygon=function(t,e,o){this.shell=t||o.createLinearRing(null),this.holes=e||[],this.factory=o},jsts.geom.Polygon.prototype=new jsts.geom.Geometry,jsts.geom.Polygon.constructor=jsts.geom.Polygon,jsts.geom.Polygon.prototype.getCoordinate=function(){return this.shell.getCoordinate()},jsts.geom.Polygon.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=[],e=-1,o=this.shell.getCoordinates(),n=0;n<o.length;n++)e++,t[e]=o[n];for(var i=0;i<this.holes.length;i++)for(var r=this.holes[i].getCoordinates(),s=0;s<r.length;s++)e++,t[e]=r[s];return t},jsts.geom.Polygon.prototype.isEmpty=function(){return this.shell.isEmpty()},jsts.geom.Polygon.prototype.getExteriorRing=function(){return this.shell},jsts.geom.Polygon.prototype.getInteriorRingN=function(t){return this.holes[t]},jsts.geom.Polygon.prototype.getNumInteriorRing=function(){return this.holes.length},jsts.geom.Polygon.prototype.getArea=function(){var t=0;t+=Math.abs(jsts.algorithm.CGAlgorithms.signedArea(this.shell.getCoordinateSequence()));for(var e=0;e<this.holes.length;e++)t-=Math.abs(jsts.algorithm.CGAlgorithms.signedArea(this.holes[e].getCoordinateSequence()));return t},jsts.geom.Polygon.prototype.getLength=function(){var t=0;t+=this.shell.getLength();for(var e=0;e<this.holes.length;e++)t+=this.holes[e].getLength();return t},jsts.geom.Polygon.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString(null);var t=[];t[0]=this.shell.clone();for(var e=0,o=this.holes.length;e<o;e++)t[e+1]=this.holes[e].clone();return t.length<=1?t[0]:this.getFactory().createMultiLineString(t)},jsts.geom.Polygon.prototype.computeEnvelopeInternal=function(){return this.shell.getEnvelopeInternal()},jsts.geom.Polygon.prototype.getDimension=function(){return 2},jsts.geom.Polygon.prototype.getBoundaryDimension=function(){return 1},jsts.geom.Polygon.prototype.equalsExact=function(t,e){if(!this.isEquivalentClass(t))return!1;if(this.isEmpty()&&t.isEmpty())return!0;if(this.isEmpty()!==t.isEmpty())return!1;if(!this.shell.equalsExact(t.shell,e))return!1;if(this.holes.length!==t.holes.length)return!1;if(this.holes.length!==t.holes.length)return!1;for(var o=0;o<this.holes.length;o++)if(!this.holes[o].equalsExact(t.holes[o],e))return!1;return!0},jsts.geom.Polygon.prototype.compareToSameClass=function(t){return this.shell.compareToSameClass(t.shell)},jsts.geom.Polygon.prototype.apply=function(t){if(t instanceof jsts.geom.GeometryComponentFilter){t.filter(this),this.shell.apply(t);for(var e=0,o=this.holes.length;e<o;e++)this.holes[e].apply(t)}else if(t instanceof jsts.geom.GeometryFilter)t.filter(this);else if(t instanceof jsts.geom.CoordinateFilter){this.shell.apply(t);for(var e=0,o=this.holes.length;e<o;e++)this.holes[e].apply(t)}else t instanceof jsts.geom.CoordinateSequenceFilter&&this.apply2.apply(this,arguments)},jsts.geom.Polygon.prototype.apply2=function(t){if(this.shell.apply(t),!t.isDone())for(var e=0;e<this.holes.length&&(this.holes[e].apply(t),!t.isDone());e++);t.isGeometryChanged()},jsts.geom.Polygon.prototype.clone=function(){for(var t=[],e=0,o=this.holes.length;e<o;e++)t.push(this.holes[e].clone());return this.factory.createPolygon(this.shell.clone(),t)},jsts.geom.Polygon.prototype.normalize=function(){this.normalize2(this.shell,!0);for(var t=0,e=this.holes.length;t<e;t++)this.normalize2(this.holes[t],!1);this.holes.sort()},jsts.geom.Polygon.prototype.normalize2=function(t,e){if(!t.isEmpty()){var o=t.points.slice(0,t.points.length-1),n=jsts.geom.CoordinateArrays.minCoordinate(t.points);jsts.geom.CoordinateArrays.scroll(o,n),t.points=o.concat(),t.points[o.length]=o[0],jsts.algorithm.CGAlgorithms.isCCW(t.points)===e&&t.points.reverse()}},jsts.geom.Polygon.prototype.CLASS_NAME="jsts.geom.Polygon"}(),jsts.algorithm.distance.DistanceToPoint=function(){},jsts.algorithm.distance.DistanceToPoint.computeDistance=function(t,e,o){if(t instanceof jsts.geom.LineString)jsts.algorithm.distance.DistanceToPoint.computeDistance2(t,e,o);else if(t instanceof jsts.geom.Polygon)jsts.algorithm.distance.DistanceToPoint.computeDistance4(t,e,o);else if(t instanceof jsts.geom.GeometryCollection)for(var n=t,i=0;i<n.getNumGeometries();i++){var r=n.getGeometryN(i);jsts.algorithm.distance.DistanceToPoint.computeDistance(r,e,o)}else o.setMinimum(t.getCoordinate(),e)},jsts.algorithm.distance.DistanceToPoint.computeDistance2=function(t,e,o){for(var n=new jsts.geom.LineSegment,i=t.getCoordinates(),r=0;r<i.length-1;r++){n.setCoordinates(i[r],i[r+1]);var s=n.closestPoint(e);o.setMinimum(s,e)}},jsts.algorithm.distance.DistanceToPoint.computeDistance3=function(t,e,o){var n=t.closestPoint(e);o.setMinimum(n,e)},jsts.algorithm.distance.DistanceToPoint.computeDistance4=function(t,e,o){jsts.algorithm.distance.DistanceToPoint.computeDistance2(t.getExteriorRing(),e,o);for(var n=0;n<t.getNumInteriorRing();n++)jsts.algorithm.distance.DistanceToPoint.computeDistance2(t.getInteriorRingN(n),e,o)},jsts.index.strtree.ItemBoundable=function(t,e){this.bounds=t,this.item=e},jsts.index.strtree.ItemBoundable.prototype=new jsts.index.strtree.Boundable,jsts.index.strtree.ItemBoundable.constructor=jsts.index.strtree.ItemBoundable,jsts.index.strtree.ItemBoundable.prototype.bounds=null,jsts.index.strtree.ItemBoundable.prototype.item=null,jsts.index.strtree.ItemBoundable.prototype.getBounds=function(){return this.bounds},jsts.index.strtree.ItemBoundable.prototype.getItem=function(){return this.item},function(){var t=javascript.util.ArrayList,e=javascript.util.TreeMap;jsts.geomgraph.EdgeList=function(){this.edges=new t,this.ocaMap=new e},jsts.geomgraph.EdgeList.prototype.edges=null,jsts.geomgraph.EdgeList.prototype.ocaMap=null,jsts.geomgraph.EdgeList.prototype.add=function(t){this.edges.add(t);var e=new jsts.noding.OrientedCoordinateArray(t.getCoordinates());this.ocaMap.put(e,t)},jsts.geomgraph.EdgeList.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},jsts.geomgraph.EdgeList.prototype.getEdges=function(){return this.edges},jsts.geomgraph.EdgeList.prototype.findEqualEdge=function(t){var e=new jsts.noding.OrientedCoordinateArray(t.getCoordinates());return this.ocaMap.get(e)},jsts.geomgraph.EdgeList.prototype.getEdges=function(){return this.edges},jsts.geomgraph.EdgeList.prototype.iterator=function(){return this.edges.iterator()},jsts.geomgraph.EdgeList.prototype.get=function(t){return this.edges.get(t)},jsts.geomgraph.EdgeList.prototype.findEdgeIndex=function(t){for(var e=0;e<this.edges.size();e++)if(this.edges.get(e).equals(t))return e;return-1}}(),jsts.operation.IsSimpleOp=function(t){this.geom=t},jsts.operation.IsSimpleOp.prototype.geom=null,jsts.operation.IsSimpleOp.prototype.isClosedEndpointsInInterior=!0,jsts.operation.IsSimpleOp.prototype.nonSimpleLocation=null,jsts.operation.IsSimpleOp.prototype.IsSimpleOp=function(t){this.geom=t},jsts.operation.IsSimpleOp.prototype.isSimple=function(){return this.nonSimpleLocation=null,this.geom instanceof jsts.geom.LineString?this.isSimpleLinearGeometry(this.geom):this.geom instanceof jsts.geom.MultiLineString?this.isSimpleLinearGeometry(this.geom):!(this.geom instanceof jsts.geom.MultiPoint)||this.isSimpleMultiPoint(this.geom)},jsts.operation.IsSimpleOp.prototype.isSimpleMultiPoint=function(t){if(t.isEmpty())return!0;for(var e=[],o=0;o<t.getNumGeometries();o++){for(var n=t.getGeometryN(o),i=n.getCoordinate(),r=0;r<e.length;r++){var s=e[r];if(i.equals2D(s))return this.nonSimpleLocation=i,!1}e.push(i)}return!0},jsts.operation.IsSimpleOp.prototype.isSimpleLinearGeometry=function(t){if(t.isEmpty())return!0;var e=new jsts.geomgraph.GeometryGraph(0,t),o=new jsts.algorithm.RobustLineIntersector,n=e.computeSelfNodes(o,!0);return!n.hasIntersection()||(n.hasProperIntersection()?(this.nonSimpleLocation=n.getProperIntersectionPoint(),!1):!this.hasNonEndpointIntersection(e)&&(!this.isClosedEndpointsInInterior||!this.hasClosedEndpointIntersection(e)))},jsts.operation.IsSimpleOp.prototype.hasNonEndpointIntersection=function(t){for(var e=t.getEdgeIterator();e.hasNext();)for(var o=e.next(),n=o.getMaximumSegmentIndex(),i=o.getEdgeIntersectionList().iterator();i.hasNext();){var r=i.next();if(!r.isEndPoint(n))return this.nonSimpleLocation=r.getCoordinate(),!0}return!1},jsts.operation.IsSimpleOp.prototype.hasClosedEndpointIntersection=function(t){for(var e=new javascript.util.TreeMap,o=t.getEdgeIterator();o.hasNext();){var n=o.next(),i=(n.getMaximumSegmentIndex(),n.isClosed()),r=n.getCoordinate(0);this.addEndpoint(e,r,i);var s=n.getCoordinate(n.getNumPoints()-1);this.addEndpoint(e,s,i)}for(var o=e.values().iterator();o.hasNext();){var a=o.next();if(a.isClosed&&2!=a.degree)return this.nonSimpleLocation=a.getCoordinate(),!0}return!1},jsts.operation.IsSimpleOp.EndpointInfo=function(t){this.pt=t,this.isClosed=!1,this.degree=0},jsts.operation.IsSimpleOp.EndpointInfo.prototype.pt=null,jsts.operation.IsSimpleOp.EndpointInfo.prototype.isClosed=null,jsts.operation.IsSimpleOp.EndpointInfo.prototype.degree=null,jsts.operation.IsSimpleOp.EndpointInfo.prototype.getCoordinate=function(){return this.pt},jsts.operation.IsSimpleOp.EndpointInfo.prototype.addEndpoint=function(t){this.degree++,this.isClosed=this.isClosed||t},jsts.operation.IsSimpleOp.prototype.addEndpoint=function(t,e,o){var n=t.get(e);null===n&&(n=new jsts.operation.IsSimpleOp.EndpointInfo(e),t.put(e,n)),n.addEndpoint(o)},function(){var t=function(){this.snapTolerance=0,this.seg=new jsts.geom.LineSegment,this.allowSnappingToSourceVertices=!1,this.isClosed=!1,this.srcPts=[],arguments[0]instanceof jsts.geom.LineString?this.initFromLine.apply(this,arguments):this.initFromPoints.apply(this,arguments)};t.prototype.initFromLine=function(t,e){this.initFromPoints(t.getCoordinates(),e)},t.prototype.initFromPoints=function(t,e){this.srcPts=t,this.isClosed=this.calcIsClosed(t),this.snapTolerance=e},t.prototype.setAllowSnappingToSourceVertices=function(t){this.allowSnappingToSourceVertices=t},t.prototype.calcIsClosed=function(t){return!(t.length<=1)&&t[0].equals(t[t.length-1])},t.prototype.snapTo=function(t){var e=new jsts.geom.CoordinateList(this.srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},t.prototype.snapVertices=function(t,e){var o,n,i=this.isClosed?t.size()-1:t.size(),r=0;for(r;r<i;r++)o=t.get(r),null!==(n=this.findSnapForVertex(o,e))&&(t.set(r,new jsts.geom.Coordinate(n)),0===r&&this.isClosed&&t.set(t.size()-1,new jsts.geom.Coordinate(n)))},t.prototype.findSnapForVertex=function(t,e){var o=0,n=e.length;for(o=0;o<n;o++){if(t.equals(e[o]))return null;if(t.distance(e[o])<this.snapTolerance)return e[o]}return null},t.prototype.snapSegments=function(t,e){if(0!==e.length){var o,n,i,r=e.length;for(e.length>1&&e[0].equals2D(e[e.length-1])&&(r=e.length-1),o=0;o<r;o++)n=e[o],(i=this.findSegmentIndexToSnap(n,t))>=0&&t.add(i+1,new jsts.geom.Coordinate(n),!1)}},t.prototype.findSegmentIndexToSnap=function(t,e){var o,n=Number.MAX_VALUE,i=-1,r=0;for(r;r<e.size()-1;r++){if(this.seg.p0=e.get(r),this.seg.p1=e.get(r+1),this.seg.p0.equals(t)||this.seg.p1.equals(t)){if(this.allowSnappingToSourceVertices)continue;return-1}o=this.seg.distance(t),o<this.snapTolerance&&o<n&&(n=o,i=r)}return i},jsts.operation.overlay.snap.LineStringSnapper=t}(),jsts.operation.buffer.BufferOp=function(t,e){this.argGeom=t,this.bufParams=e||new jsts.operation.buffer.BufferParameters},jsts.operation.buffer.BufferOp.MAX_PRECISION_DIGITS=12,jsts.operation.buffer.BufferOp.precisionScaleFactor=function(t,e,o){var n=t.getEnvelopeInternal(),i=Math.max(n.getHeight(),n.getWidth()),r=e>0?e:0,s=i+2*r,a=Math.log(s)/Math.log(10)+1,l=a-o;return Math.pow(10,-l)},jsts.operation.buffer.BufferOp.bufferOp=function(t,e){return arguments.length>2?jsts.operation.buffer.BufferOp.bufferOp2.apply(this,arguments):new jsts.operation.buffer.BufferOp(t).getResultGeometry(e)},jsts.operation.buffer.BufferOp.bufferOp2=function(t,e,o){return arguments.length>3?jsts.operation.buffer.BufferOp.bufferOp3.apply(this,arguments):new jsts.operation.buffer.BufferOp(t,o).getResultGeometry(e)},jsts.operation.buffer.BufferOp.bufferOp3=function(t,e,o){if(arguments.length>4)return jsts.operation.buffer.BufferOp.bufferOp4.apply(this,arguments);var n=new jsts.operation.buffer.BufferOp(t);return n.setQuadrantSegments(o),n.getResultGeometry(e)},jsts.operation.buffer.BufferOp.bufferOp4=function(t,e,o,n){var i=new jsts.operation.buffer.BufferOp(t);return i.setQuadrantSegments(o),i.setEndCapStyle(n),i.getResultGeometry(e)},jsts.operation.buffer.BufferOp.prototype.argGeom=null,jsts.operation.buffer.BufferOp.prototype.distance=null,jsts.operation.buffer.BufferOp.prototype.bufParams=null,jsts.operation.buffer.BufferOp.prototype.resultGeometry=null,jsts.operation.buffer.BufferOp.prototype.setEndCapStyle=function(t){this.bufParams.setEndCapStyle(t)},jsts.operation.buffer.BufferOp.prototype.setQuadrantSegments=function(t){this.bufParams.setQuadrantSegments(t)},jsts.operation.buffer.BufferOp.prototype.getResultGeometry=function(t){return this.distance=t,this.computeGeometry(),this.resultGeometry},jsts.operation.buffer.BufferOp.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null===this.resultGeometry){var t=this.argGeom.getPrecisionModel();t.getType()===jsts.geom.PrecisionModel.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()}},jsts.operation.buffer.BufferOp.prototype.bufferReducedPrecision=function(){var t,e=null;for(t=jsts.operation.buffer.BufferOp.MAX_PRECISION_DIGITS;t>=0;t--){try{this.bufferReducedPrecision2(t)}catch(t){e=t}if(null!==this.resultGeometry)return}throw e},jsts.operation.buffer.BufferOp.prototype.bufferOriginalPrecision=function(){try{var t=new jsts.operation.buffer.BufferBuilder(this.bufParams);this.resultGeometry=t.buffer(this.argGeom,this.distance)}catch(t){}},jsts.operation.buffer.BufferOp.prototype.bufferReducedPrecision2=function(t){var e=jsts.operation.buffer.BufferOp.precisionScaleFactor(this.argGeom,this.distance,t),o=new jsts.geom.PrecisionModel(e);this.bufferFixedPrecision(o)},jsts.operation.buffer.BufferOp.prototype.bufferFixedPrecision=function(t){var e=new jsts.noding.ScaledNoder(new jsts.noding.snapround.MCIndexSnapRounder(new jsts.geom.PrecisionModel(1)),t.getScale()),o=new jsts.operation.buffer.BufferBuilder(this.bufParams);o.setWorkingPrecisionModel(t),o.setNoder(e),this.resultGeometry=o.buffer(this.argGeom,this.distance)},jsts.geomgraph.index.EdgeSetIntersector=function(){},jsts.geomgraph.index.EdgeSetIntersector.prototype.computeIntersections=function(t,e,o){throw new jsts.error.AbstractMethodInvocationError},jsts.geomgraph.index.EdgeSetIntersector.prototype.computeIntersections2=function(t,e,o){throw new jsts.error.AbstractMethodInvocationError},jsts.geomgraph.index.SimpleMCSweepLineIntersector=function(){throw new jsts.error.NotImplementedError},jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype=new jsts.geomgraph.index.EdgeSetIntersector,jsts.algorithm.locate.SimplePointInAreaLocator=function(t){this.geom=t},jsts.algorithm.locate.SimplePointInAreaLocator.locate=function(t,e){return e.isEmpty()?jsts.geom.Location.EXTERIOR:jsts.algorithm.locate.SimplePointInAreaLocator.containsPoint(t,e)?jsts.geom.Location.INTERIOR:jsts.geom.Location.EXTERIOR},jsts.algorithm.locate.SimplePointInAreaLocator.containsPoint=function(t,e){if(e instanceof jsts.geom.Polygon)return jsts.algorithm.locate.SimplePointInAreaLocator.containsPointInPolygon(t,e);if(e instanceof jsts.geom.GeometryCollection||e instanceof jsts.geom.MultiPoint||e instanceof jsts.geom.MultiLineString||e instanceof jsts.geom.MultiPolygon)for(var o=0;o<e.geometries.length;o++){var n=e.geometries[o];if(n!==e&&jsts.algorithm.locate.SimplePointInAreaLocator.containsPoint(t,n))return!0}return!1},jsts.algorithm.locate.SimplePointInAreaLocator.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var o=e.getExteriorRing();if(!jsts.algorithm.locate.SimplePointInAreaLocator.isPointInRing(t,o))return!1;for(var n=0;n<e.getNumInteriorRing();n++){var i=e.getInteriorRingN(n);if(jsts.algorithm.locate.SimplePointInAreaLocator.isPointInRing(t,i))return!1}return!0},jsts.algorithm.locate.SimplePointInAreaLocator.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&jsts.algorithm.CGAlgorithms.isPointInRing(t,e.getCoordinates())},jsts.algorithm.locate.SimplePointInAreaLocator.prototype.geom=null,jsts.algorithm.locate.SimplePointInAreaLocator.prototype.locate=function(t){return jsts.algorithm.locate.SimplePointInAreaLocator.locate(t,geom)},jsts.io.WKTWriter=function(){this.parser=new jsts.io.WKTParser(this.geometryFactory)},jsts.io.WKTWriter.prototype.write=function(t){return this.parser.write(t)},jsts.io.WKTWriter.toLineString=function(t,e){if(2!==arguments.length)throw new jsts.error.NotImplementedError;return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"},jsts.algorithm.CentroidLine=function(){this.centSum=new jsts.geom.Coordinate},jsts.algorithm.CentroidLine.prototype.centSum=null,jsts.algorithm.CentroidLine.prototype.totalLength=0,jsts.algorithm.CentroidLine.prototype.add=function(t){if(t instanceof Array)return void this.add2.apply(this,arguments);if(t instanceof jsts.geom.LineString)this.add(t.getCoordinates());else if(t instanceof jsts.geom.Polygon){var e=t;this.add(e.getExteriorRing().getCoordinates());for(var o=0;o<e.getNumInteriorRing();o++)this.add(e.getInteriorRingN(o).getCoordinates())}else if(t instanceof jsts.geom.GeometryCollection||t instanceof jsts.geom.MultiPoint||t instanceof jsts.geom.MultiLineString||t instanceof jsts.geom.MultiPolygon)for(var n=t,o=0;o<n.getNumGeometries();o++)this.add(n.getGeometryN(o))},jsts.algorithm.CentroidLine.prototype.getCentroid=function(){var t=new jsts.geom.Coordinate;return t.x=this.centSum.x/this.totalLength,t.y=this.centSum.y/this.totalLength,t},jsts.algorithm.CentroidLine.prototype.add2=function(t){for(var e=0;e<t.length-1;e++){var o=t[e].distance(t[e+1]);this.totalLength+=o;var n=(t[e].x+t[e+1].x)/2;this.centSum.x+=o*n;var i=(t[e].y+t[e+1].y)/2;this.centSum.y+=o*i}},jsts.algorithm.PointLocator=function(t){this.boundaryRule=t||jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE},jsts.algorithm.PointLocator.prototype.boundaryRule=null,jsts.algorithm.PointLocator.prototype.isIn=null,jsts.algorithm.PointLocator.prototype.numBoundaries=null,jsts.algorithm.PointLocator.prototype.intersects=function(t,e){return this.locate(t,e)!==jsts.geom.Location.EXTERIOR},jsts.algorithm.PointLocator.prototype.locate=function(t,e){return e.isEmpty()?jsts.geom.Location.EXTERIOR:e instanceof jsts.geom.Point?this.locate2(t,e):e instanceof jsts.geom.LineString?this.locate3(t,e):e instanceof jsts.geom.Polygon?this.locate4(t,e):(this.isIn=!1,this.numBoundaries=0,this.computeLocation(t,e),this.boundaryRule.isInBoundary(this.numBoundaries)?jsts.geom.Location.BOUNDARY:this.numBoundaries>0||this.isIn?jsts.geom.Location.INTERIOR:jsts.geom.Location.EXTERIOR)},jsts.algorithm.PointLocator.prototype.computeLocation=function(t,e){if(e instanceof jsts.geom.Point||e instanceof jsts.geom.LineString||e instanceof jsts.geom.Polygon)this.updateLocationInfo(this.locate(t,e));else if(e instanceof jsts.geom.MultiLineString)for(var o=e,n=0;n<o.getNumGeometries();n++){var i=o.getGeometryN(n);this.updateLocationInfo(this.locate(t,i))}else if(e instanceof jsts.geom.MultiPolygon)for(var r=e,n=0;n<r.getNumGeometries();n++){var s=r.getGeometryN(n);this.updateLocationInfo(this.locate(t,s))}else if(e instanceof jsts.geom.MultiPoint||e instanceof jsts.geom.GeometryCollection)for(var n=0;n<e.getNumGeometries();n++){var a=e.getGeometryN(n);a!==e&&this.computeLocation(t,a)}},jsts.algorithm.PointLocator.prototype.updateLocationInfo=function(t){t===jsts.geom.Location.INTERIOR&&(this.isIn=!0),t===jsts.geom.Location.BOUNDARY&&this.numBoundaries++},jsts.algorithm.PointLocator.prototype.locate2=function(t,e){return e.getCoordinate().equals2D(t)?jsts.geom.Location.INTERIOR:jsts.geom.Location.EXTERIOR},jsts.algorithm.PointLocator.prototype.locate3=function(t,e){if(!e.getEnvelopeInternal().intersects(t))return jsts.geom.Location.EXTERIOR;var o=e.getCoordinates();return e.isClosed()||!t.equals(o[0])&&!t.equals(o[o.length-1])?jsts.algorithm.CGAlgorithms.isOnLine(t,o)?jsts.geom.Location.INTERIOR:jsts.geom.Location.EXTERIOR:jsts.geom.Location.BOUNDARY},jsts.algorithm.PointLocator.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?jsts.algorithm.CGAlgorithms.locatePointInRing(t,e.getCoordinates()):jsts.geom.Location.EXTERIOR},jsts.algorithm.PointLocator.prototype.locate4=function(t,e){if(e.isEmpty())return jsts.geom.Location.EXTERIOR;var o=e.getExteriorRing(),n=this.locateInPolygonRing(t,o);if(n===jsts.geom.Location.EXTERIOR)return jsts.geom.Location.EXTERIOR;if(n===jsts.geom.Location.BOUNDARY)return jsts.geom.Location.BOUNDARY;for(var i=0;i<e.getNumInteriorRing();i++){var r=e.getInteriorRingN(i),s=this.locateInPolygonRing(t,r);if(s===jsts.geom.Location.INTERIOR)return jsts.geom.Location.EXTERIOR;if(s===jsts.geom.Location.BOUNDARY)return jsts.geom.Location.BOUNDARY}return jsts.geom.Location.INTERIOR},function(){var t=jsts.geom.Location,e=javascript.util.ArrayList,o=javascript.util.TreeMap;jsts.geomgraph.NodeMap=function(t){this.nodeMap=new o,this.nodeFact=t},jsts.geomgraph.NodeMap.prototype.nodeMap=null,jsts.geomgraph.NodeMap.prototype.nodeFact=null,jsts.geomgraph.NodeMap.prototype.addNode=function(t){var e,o;if(t instanceof jsts.geom.Coordinate)return o=t,e=this.nodeMap.get(o),null===e&&(e=this.nodeFact.createNode(o),this.nodeMap.put(o,e)),e;if(t instanceof jsts.geomgraph.Node){var n=t;return o=n.getCoordinate(),null===(e=this.nodeMap.get(o))?(this.nodeMap.put(o,n),n):(e.mergeLabel(n),e)}},jsts.geomgraph.NodeMap.prototype.add=function(t){var e=t.getCoordinate();this.addNode(e).add(t)},jsts.geomgraph.NodeMap.prototype.find=function(t){return this.nodeMap.get(t)},jsts.geomgraph.NodeMap.prototype.values=function(){return this.nodeMap.values()},jsts.geomgraph.NodeMap.prototype.iterator=function(){return this.values().iterator()},jsts.geomgraph.NodeMap.prototype.getBoundaryNodes=function(o){for(var n=new e,i=this.iterator();i.hasNext();){var r=i.next();r.getLabel().getLocation(o)===t.BOUNDARY&&n.add(r)}return n}}(),function(){var t=javascript.util.ArrayList;jsts.geomgraph.PlanarGraph=function(e){this.edges=new t,this.edgeEndList=new t,this.nodes=new jsts.geomgraph.NodeMap(e||new jsts.geomgraph.NodeFactory)},jsts.geomgraph.PlanarGraph.prototype.edges=null,jsts.geomgraph.PlanarGraph.prototype.nodes=null,jsts.geomgraph.PlanarGraph.prototype.edgeEndList=null,jsts.geomgraph.PlanarGraph.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();){e.next().getEdges().linkResultDirectedEdges()}},jsts.geomgraph.PlanarGraph.prototype.getEdgeIterator=function(){return this.edges.iterator()},jsts.geomgraph.PlanarGraph.prototype.getEdgeEnds=function(){return this.edgeEndList},jsts.geomgraph.PlanarGraph.prototype.isBoundaryNode=function(t,e){var o=this.nodes.find(e);if(null===o)return!1;var n=o.getLabel();return null!==n&&n.getLocation(t)===jsts.geom.Location.BOUNDARY},jsts.geomgraph.PlanarGraph.prototype.insertEdge=function(t){this.edges.add(t)},jsts.geomgraph.PlanarGraph.prototype.add=function(t){this.nodes.add(t),this.edgeEndList.add(t)},jsts.geomgraph.PlanarGraph.prototype.getNodeIterator=function(){return this.nodes.iterator()},jsts.geomgraph.PlanarGraph.prototype.getNodes=function(){return this.nodes.values()},jsts.geomgraph.PlanarGraph.prototype.addNode=function(t){return this.nodes.addNode(t)},jsts.geomgraph.PlanarGraph.prototype.addEdges=function(t){for(var e=t.iterator();e.hasNext();){var o=e.next();this.edges.add(o);var n=new jsts.geomgraph.DirectedEdge(o,!0),i=new jsts.geomgraph.DirectedEdge(o,!1);n.setSym(i),i.setSym(n),this.add(n),this.add(i)}},jsts.geomgraph.PlanarGraph.prototype.linkResultDirectedEdges=function(){for(var t=this.nodes.iterator();t.hasNext();){t.next().getEdges().linkResultDirectedEdges()}},jsts.geomgraph.PlanarGraph.prototype.findEdgeInSameDirection=function(t,e){var o,n,i=0,r=this.edges.size();for(i;i<r;i++){if(o=this.edges.get(i),n=o.getCoordinates(),this.matchInSameDirection(t,e,n[0],n[1]))return o;if(this.matchInSameDirection(t,e,n[n.length-1],n[n.length-2]))return o}return null},jsts.geomgraph.PlanarGraph.prototype.matchInSameDirection=function(t,e,o,n){return!!t.equals(o)&&(jsts.algorithm.CGAlgorithms.computeOrientation(t,e,n)===jsts.algorithm.CGAlgorithms.COLLINEAR&&jsts.geomgraph.Quadrant.quadrant(t,e)===jsts.geomgraph.Quadrant.quadrant(o,n))},jsts.geomgraph.PlanarGraph.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var o=e.next();if(o.getEdge()===t)return o}return null}}(),jsts.algorithm.LineIntersector=function(){this.inputLines=[[],[]],this.intPt=[null,null],this.pa=this.intPt[0],this.pb=this.intPt[1],this.result=jsts.algorithm.LineIntersector.NO_INTERSECTION},jsts.algorithm.LineIntersector.NO_INTERSECTION=0,jsts.algorithm.LineIntersector.POINT_INTERSECTION=1,jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION=2,jsts.algorithm.LineIntersector.prototype.setPrecisionModel=function(t){this.precisionModel=t},jsts.algorithm.LineIntersector.prototype.getEndpoint=function(t,e){return this.inputLines[t][e]},jsts.algorithm.LineIntersector.computeEdgeDistance=function(t,e,o){var n=Math.abs(o.x-e.x),i=Math.abs(o.y-e.y),r=-1;if(t.equals(e))r=0;else if(t.equals(o))r=n>i?n:i;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);r=n>i?s:a,0!==r||t.equals(e)||(r=Math.max(s,a))}if(0===r&&!t.equals(e))throw new jsts.error.IllegalArgumentError("Bad distance calculation");return r},jsts.algorithm.LineIntersector.nonRobustComputeEdgeDistance=function(t,e,o){var n=t.x-e.x,i=t.y-e.y,r=Math.sqrt(n*n+i*i);if(0!==r||t.equals(e))throw new jsts.error.IllegalArgumentError("Invalid distance calculation");return r},jsts.algorithm.LineIntersector.prototype.result=null,jsts.algorithm.LineIntersector.prototype.inputLines=null,jsts.algorithm.LineIntersector.prototype.intPt=null,jsts.algorithm.LineIntersector.prototype.intLineIndex=null,jsts.algorithm.LineIntersector.prototype._isProper=null,jsts.algorithm.LineIntersector.prototype.pa=null,jsts.algorithm.LineIntersector.prototype.pb=null,jsts.algorithm.LineIntersector.prototype.precisionModel=null,jsts.algorithm.LineIntersector.prototype.computeIntersection=function(t,e,o){throw new jsts.error.AbstractMethodInvocationError},jsts.algorithm.LineIntersector.prototype.isCollinear=function(){return this.result===jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION},jsts.algorithm.LineIntersector.prototype.computeIntersection=function(t,e,o,n){this.inputLines[0][0]=t,this.inputLines[0][1]=e,this.inputLines[1][0]=o,this.inputLines[1][1]=n,this.result=this.computeIntersect(t,e,o,n)},jsts.algorithm.LineIntersector.prototype.computeIntersect=function(t,e,o,n){throw new jsts.error.AbstractMethodInvocationError},jsts.algorithm.LineIntersector.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},jsts.algorithm.LineIntersector.prototype.hasIntersection=function(){return this.result!==jsts.algorithm.LineIntersector.NO_INTERSECTION},jsts.algorithm.LineIntersector.prototype.getIntersectionNum=function(){return this.result},jsts.algorithm.LineIntersector.prototype.getIntersection=function(t){return this.intPt[t]},jsts.algorithm.LineIntersector.prototype.computeIntLineIndex=function(){null===this.intLineIndex&&(this.intLineIndex=[[],[]],this.computeIntLineIndex(0),this.computeIntLineIndex(1))},jsts.algorithm.LineIntersector.prototype.isIntersection=function(t){var e;for(e=0;e<this.result;e++)if(this.intPt[e].equals2D(t))return!0;return!1},jsts.algorithm.LineIntersector.prototype.isInteriorIntersection=function(){return 1===arguments.length?this.isInteriorIntersection2.apply(this,arguments):!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1)},jsts.algorithm.LineIntersector.prototype.isInteriorIntersection2=function(t){var e;for(e=0;e<this.result;e++)if(!this.intPt[e].equals2D(this.inputLines[t][0])&&!this.intPt[e].equals2D(this.inputLines[t][1]))return!0;return!1},jsts.algorithm.LineIntersector.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},jsts.algorithm.LineIntersector.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this.intPt[intLineIndex[t][e]]},jsts.algorithm.LineIntersector.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this.intLineIndex[t][e]},jsts.algorithm.LineIntersector.prototype.computeIntLineIndex=function(t){this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this.intLineIndex[t][0]=0,this.intLineIndex[t][1]=1):(this.intLineIndex[t][0]=1,this.intLineIndex[t][1]=0)},jsts.algorithm.LineIntersector.prototype.getEdgeDistance=function(t,e){return jsts.algorithm.LineIntersector.computeEdgeDistance(this.intPt[e],this.inputLines[t][0],this.inputLines[t][1])},jsts.algorithm.RobustLineIntersector=function(){jsts.algorithm.RobustLineIntersector.prototype.constructor.call(this)},jsts.algorithm.RobustLineIntersector.prototype=new jsts.algorithm.LineIntersector,jsts.algorithm.RobustLineIntersector.prototype.computeIntersection=function(t,e,o){return 4===arguments.length?void jsts.algorithm.LineIntersector.prototype.computeIntersection.apply(this,arguments):(this._isProper=!1,jsts.geom.Envelope.intersects(e,o,t)&&0===jsts.algorithm.CGAlgorithms.orientationIndex(e,o,t)&&0===jsts.algorithm.CGAlgorithms.orientationIndex(o,e,t)?(this._isProper=!0,(t.equals(e)||t.equals(o))&&(this._isProper=!1),void(this.result=jsts.algorithm.LineIntersector.POINT_INTERSECTION)):void(this.result=jsts.algorithm.LineIntersector.NO_INTERSECTION))},jsts.algorithm.RobustLineIntersector.prototype.computeIntersect=function(t,e,o,n){if(this._isProper=!1,!jsts.geom.Envelope.intersects(t,e,o,n))return jsts.algorithm.LineIntersector.NO_INTERSECTION;var i=jsts.algorithm.CGAlgorithms.orientationIndex(t,e,o),r=jsts.algorithm.CGAlgorithms.orientationIndex(t,e,n);if(i>0&&r>0||i<0&&r<0)return jsts.algorithm.LineIntersector.NO_INTERSECTION;var s=jsts.algorithm.CGAlgorithms.orientationIndex(o,n,t),a=jsts.algorithm.CGAlgorithms.orientationIndex(o,n,e);return s>0&&a>0||s<0&&a<0?jsts.algorithm.LineIntersector.NO_INTERSECTION:0===i&&0===r&&0===s&&0===a?this.computeCollinearIntersection(t,e,o,n):(0===i||0===r||0===s||0===a?(this._isProper=!1,t.equals2D(o)||t.equals2D(n)?this.intPt[0]=t:e.equals2D(o)||e.equals2D(n)?this.intPt[0]=e:0===i?this.intPt[0]=new jsts.geom.Coordinate(o):0===r?this.intPt[0]=new jsts.geom.Coordinate(n):0===s?this.intPt[0]=new jsts.geom.Coordinate(t):0===a&&(this.intPt[0]=new jsts.geom.Coordinate(e))):(this._isProper=!0,this.intPt[0]=this.intersection(t,e,o,n)),jsts.algorithm.LineIntersector.POINT_INTERSECTION)},jsts.algorithm.RobustLineIntersector.prototype.computeCollinearIntersection=function(t,e,o,n){var i=jsts.geom.Envelope.intersects(t,e,o),r=jsts.geom.Envelope.intersects(t,e,n),s=jsts.geom.Envelope.intersects(o,n,t),a=jsts.geom.Envelope.intersects(o,n,e);return i&&r?(this.intPt[0]=o,this.intPt[1]=n,jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION):s&&a?(this.intPt[0]=t,this.intPt[1]=e,jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION):i&&s?(this.intPt[0]=o,this.intPt[1]=t,!o.equals(t)||r||a?jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION:jsts.algorithm.LineIntersector.POINT_INTERSECTION):i&&a?(this.intPt[0]=o,this.intPt[1]=e,!o.equals(e)||r||s?jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION:jsts.algorithm.LineIntersector.POINT_INTERSECTION):r&&s?(this.intPt[0]=n,this.intPt[1]=t,!n.equals(t)||i||a?jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION:jsts.algorithm.LineIntersector.POINT_INTERSECTION):r&&a?(this.intPt[0]=n,this.intPt[1]=e,!n.equals(e)||i||s?jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION:jsts.algorithm.LineIntersector.POINT_INTERSECTION):jsts.algorithm.LineIntersector.NO_INTERSECTION},jsts.algorithm.RobustLineIntersector.prototype.intersection=function(t,e,o,n){var i=this.intersectionWithNormalization(t,e,o,n);return this.isInSegmentEnvelopes(i)||(i=jsts.algorithm.CentralEndpointIntersector.getIntersection(t,e,o,n)),null!==this.precisionModel&&this.precisionModel.makePrecise(i),i},jsts.algorithm.RobustLineIntersector.prototype.intersectionWithNormalization=function(t,e,o,n){var i=new jsts.geom.Coordinate(t),r=new jsts.geom.Coordinate(e),s=new jsts.geom.Coordinate(o),a=new jsts.geom.Coordinate(n),l=new jsts.geom.Coordinate;this.normalizeToEnvCentre(i,r,s,a,l);var c=this.safeHCoordinateIntersection(i,r,s,a);return c.x+=l.x,c.y+=l.y,c},jsts.algorithm.RobustLineIntersector.prototype.safeHCoordinateIntersection=function(t,e,o,n){var i=null;try{i=jsts.algorithm.HCoordinate.intersection(t,e,o,n)}catch(r){if(!(r instanceof jsts.error.NotRepresentableError))throw r;i=jsts.algorithm.CentralEndpointIntersector.getIntersection(t,e,o,n)}return i},jsts.algorithm.RobustLineIntersector.prototype.normalizeToMinimum=function(t,e,o,n,i){i.x=this.smallestInAbsValue(t.x,e.x,o.x,n.x),i.y=this.smallestInAbsValue(t.y,e.y,o.y,n.y),t.x-=i.x,t.y-=i.y,e.x-=i.x,e.y-=i.y,o.x-=i.x,o.y-=i.y,n.x-=i.x,n.y-=i.y},jsts.algorithm.RobustLineIntersector.prototype.normalizeToEnvCentre=function(t,e,o,n,i){var r=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,l=t.y>e.y?t.y:e.y,c=o.x<n.x?o.x:n.x,u=o.y<n.y?o.y:n.y,h=o.x>n.x?o.x:n.x,g=o.y>n.y?o.y:n.y,p=r>c?r:c,d=a<h?a:h,f=s>u?s:u,m=l<g?l:g,y=(p+d)/2,v=(f+m)/2;i.x=y,i.y=v,t.x-=i.x,t.y-=i.y,e.x-=i.x,e.y-=i.y,o.x-=i.x,o.y-=i.y,n.x-=i.x,n.y-=i.y},jsts.algorithm.RobustLineIntersector.prototype.smallestInAbsValue=function(t,e,o,n){var i=t,r=Math.abs(i);return Math.abs(e)<r&&(i=e,r=Math.abs(e)),Math.abs(o)<r&&(i=o,r=Math.abs(o)),Math.abs(n)<r&&(i=n),i},jsts.algorithm.RobustLineIntersector.prototype.isInSegmentEnvelopes=function(t){var e=new jsts.geom.Envelope(this.inputLines[0][0],this.inputLines[0][1]),o=new jsts.geom.Envelope(this.inputLines[1][0],this.inputLines[1][1]);return e.contains(t)&&o.contains(t)},jsts.noding.SegmentIntersector=function(){},jsts.noding.SegmentIntersector.prototype.processIntersections=jsts.abstractFunc,jsts.noding.SegmentIntersector.prototype.isDone=jsts.abstractFunc,function(){var t=jsts.noding.SegmentIntersector,e=javascript.util.ArrayList;jsts.noding.InteriorIntersectionFinder=function(t){this.li=t,this.intersections=new e,this.interiorIntersection=null},jsts.noding.InteriorIntersectionFinder.prototype=new t,jsts.noding.InteriorIntersectionFinder.constructor=jsts.noding.InteriorIntersectionFinder,jsts.noding.InteriorIntersectionFinder.prototype.findAllIntersections=!1,jsts.noding.InteriorIntersectionFinder.prototype.isCheckEndSegmentsOnly=!1,jsts.noding.InteriorIntersectionFinder.prototype.li=null,jsts.noding.InteriorIntersectionFinder.prototype.interiorIntersection=null,jsts.noding.InteriorIntersectionFinder.prototype.intSegments=null,jsts.noding.InteriorIntersectionFinder.prototype.intersections=null,jsts.noding.InteriorIntersectionFinder.prototype.setFindAllIntersections=function(t){this.findAllIntersections=t},jsts.noding.InteriorIntersectionFinder.prototype.getIntersections=function(){return intersections},jsts.noding.InteriorIntersectionFinder.prototype.setCheckEndSegmentsOnly=function(t){this.isCheckEndSegmentsOnly=t},jsts.noding.InteriorIntersectionFinder.prototype.hasIntersection=function(){return null!=this.interiorIntersection},jsts.noding.InteriorIntersectionFinder.prototype.getInteriorIntersection=function(){return this.interiorIntersection},jsts.noding.InteriorIntersectionFinder.prototype.getIntersectionSegments=function(){return this.intSegments},jsts.noding.InteriorIntersectionFinder.prototype.processIntersections=function(t,e,o,n){if(!this.hasIntersection()&&(t!=o||e!=n)){if(this.isCheckEndSegmentsOnly){if(!(this.isEndSegment(t,e)||isEndSegment(o,n)))return}var i=t.getCoordinates()[e],r=t.getCoordinates()[e+1],s=o.getCoordinates()[n],a=o.getCoordinates()[n+1];this.li.computeIntersection(i,r,s,a),this.li.hasIntersection()&&this.li.isInteriorIntersection()&&(this.intSegments=[],this.intSegments[0]=i,this.intSegments[1]=r,this.intSegments[2]=s,this.intSegments[3]=a,this.interiorIntersection=this.li.getIntersection(0),this.intersections.add(this.interiorIntersection))}},jsts.noding.InteriorIntersectionFinder.prototype.isEndSegment=function(t,e){return 0==e||e>=t.size()-2},jsts.noding.InteriorIntersectionFinder.prototype.isDone=function(){return!this.findAllIntersections&&null!=this.interiorIntersection}}(),function(){jsts.noding.Noder=function(){},jsts.noding.Noder.prototype.computeNodes=jsts.abstractFunc,jsts.noding.Noder.prototype.getNodedSubstrings=jsts.abstractFunc}();!function(){var t=jsts.noding.Noder;jsts.noding.SinglePassNoder=function(){},jsts.noding.SinglePassNoder.prototype=new t,jsts.noding.SinglePassNoder.constructor=jsts.noding.SinglePassNoder,jsts.noding.SinglePassNoder.prototype.segInt=null,jsts.noding.SinglePassNoder.prototype.setSegmentIntersector=function(t){this.segInt=t}}(),jsts.index.SpatialIndex=function(){},jsts.index.SpatialIndex.prototype.insert=function(t,e){throw new jsts.error.AbstractMethodInvocationError},jsts.index.SpatialIndex.prototype.query=function(t,e){throw new jsts.error.AbstractMethodInvocationError},jsts.index.SpatialIndex.prototype.remove=function(t,e){throw new jsts.error.AbstractMethodInvocationError},jsts.index.strtree.AbstractSTRtree=function(t){void 0!==t&&(this.itemBoundables=[],jsts.util.Assert.isTrue(t>1,"Node capacity must be greater than 1"),this.nodeCapacity=t)},jsts.index.strtree.AbstractSTRtree.IntersectsOp=function(){},jsts.index.strtree.AbstractSTRtree.IntersectsOp.prototype.intersects=function(t,e){throw new jsts.error.AbstractMethodInvocationError},jsts.index.strtree.AbstractSTRtree.prototype.root=null,jsts.index.strtree.AbstractSTRtree.prototype.built=!1,jsts.index.strtree.AbstractSTRtree.prototype.itemBoundables=null,jsts.index.strtree.AbstractSTRtree.prototype.nodeCapacity=null,jsts.index.strtree.AbstractSTRtree.prototype.build=function(){jsts.util.Assert.isTrue(!this.built),this.root=0===this.itemBoundables.length?this.createNode(0):this.createHigherLevels(this.itemBoundables,-1),this.built=!0},jsts.index.strtree.AbstractSTRtree.prototype.createNode=function(t){throw new jsts.error.AbstractMethodInvocationError},jsts.index.strtree.AbstractSTRtree.prototype.createParentBoundables=function(t,e){jsts.util.Assert.isTrue(!(0===t.length));var o=[];o.push(this.createNode(e));for(var n=[],i=0;i<t.length;i++)n.push(t[i]);n.sort(this.getComparator());for(var i=0;i<n.length;i++){var r=n[i];this.lastNode(o).getChildBoundables().length===this.getNodeCapacity()&&o.push(this.createNode(e)),this.lastNode(o).addChildBoundable(r)}return o},jsts.index.strtree.AbstractSTRtree.prototype.lastNode=function(t){return t[t.length-1]},jsts.index.strtree.AbstractSTRtree.prototype.compareDoubles=function(t,e){return t>e?1:t<e?-1:0},jsts.index.strtree.AbstractSTRtree.prototype.createHigherLevels=function(t,e){jsts.util.Assert.isTrue(!(0===t.length));var o=this.createParentBoundables(t,e+1);return 1===o.length?o[0]:this.createHigherLevels(o,e+1)},jsts.index.strtree.AbstractSTRtree.prototype.getRoot=function(){return this.built||this.build(),this.root},jsts.index.strtree.AbstractSTRtree.prototype.getNodeCapacity=function(){return this.nodeCapacity},jsts.index.strtree.AbstractSTRtree.prototype.size=function(){return 1===arguments.length?this.size2(arguments[0]):(this.built||this.build(),0===this.itemBoundables.length?0:this.size2(root))},jsts.index.strtree.AbstractSTRtree.prototype.size2=function(t){for(var e=0,o=t.getChildBoundables(),n=0;n<o.length;n++){var i=o[n];i instanceof jsts.index.strtree.AbstractNode?e+=this.size(i):i instanceof jsts.index.strtree.ItemBoundable&&(e+=1)}return e},jsts.index.strtree.AbstractSTRtree.prototype.depth=function(){return 1===arguments.length?this.depth2(arguments[0]):(this.built||this.build(),0===this.itemBoundables.length?0:this.depth2(root))},jsts.index.strtree.AbstractSTRtree.prototype.depth2=function(){for(var t=0,e=node.getChildBoundables(),o=0;o<e.length;o++){var n=e[o];if(n instanceof jsts.index.strtree.AbstractNode){var i=this.depth(n);i>t&&(t=i)}}return t+1},jsts.index.strtree.AbstractSTRtree.prototype.insert=function(t,e){jsts.util.Assert.isTrue(!this.built,"Cannot insert items into an STR packed R-tree after it has been built."),this.itemBoundables.push(new jsts.index.strtree.ItemBoundable(t,e))},jsts.index.strtree.AbstractSTRtree.prototype.query=function(t){arguments.length>1&&this.query2.apply(this,arguments),this.built||this.build();var e=[];return 0===this.itemBoundables.length?(jsts.util.Assert.isTrue(null===this.root.getBounds()),e):(this.getIntersectsOp().intersects(this.root.getBounds(),t)&&this.query3(t,this.root,e),e)},jsts.index.strtree.AbstractSTRtree.prototype.query2=function(t,e){arguments.length>2&&this.query3.apply(this,arguments),this.built||this.build(),0===this.itemBoundables.length&&jsts.util.Assert.isTrue(null===this.root.getBounds()),this.getIntersectsOp().intersects(this.root.getBounds(),t)&&this.query4(t,this.root,e)},jsts.index.strtree.AbstractSTRtree.prototype.query3=function(t,e,o){arguments[2]instanceof Array||this.query4.apply(this,arguments);for(var n=e.getChildBoundables(),i=0;i<n.length;i++){var r=n[i];this.getIntersectsOp().intersects(r.getBounds(),t)&&(r instanceof jsts.index.strtree.AbstractNode?this.query3(t,r,o):r instanceof jsts.index.strtree.ItemBoundable?o.push(r.getItem()):jsts.util.Assert.shouldNeverReachHere())}},jsts.index.strtree.AbstractSTRtree.prototype.query4=function(t,e,o){for(var n=e.getChildBoundables(),i=0;i<n.length;i++){var r=n[i];this.getIntersectsOp().intersects(r.getBounds(),t)&&(r instanceof jsts.index.strtree.AbstractNode?this.query4(t,r,o):r instanceof jsts.index.strtree.ItemBoundable?o.visitItem(r.getItem()):jsts.util.Assert.shouldNeverReachHere())}},jsts.index.strtree.AbstractSTRtree.prototype.getIntersectsOp=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.index.strtree.AbstractSTRtree.prototype.itemsTree=function(){if(1===arguments.length)return this.itemsTree2.apply(this,arguments);this.built||this.build();var t=this.itemsTree2(this.root);return null===t?[]:t},jsts.index.strtree.AbstractSTRtree.prototype.itemsTree2=function(t){for(var e=[],o=t.getChildBoundables(),n=0;n<o.length;n++){var i=o[n];if(i instanceof jsts.index.strtree.AbstractNode){var r=this.itemsTree(i);null!=r&&e.push(r)}else i instanceof jsts.index.strtree.ItemBoundable?e.push(i.getItem()):jsts.util.Assert.shouldNeverReachHere()}return e.length<=0?null:e},jsts.index.strtree.AbstractSTRtree.prototype.remove=function(t,e){return this.built||this.build(),0===this.itemBoundables.length&&jsts.util.Assert.isTrue(null==this.root.getBounds()),!!this.getIntersectsOp().intersects(this.root.getBounds(),t)&&this.remove2(t,this.root,e)},jsts.index.strtree.AbstractSTRtree.prototype.remove2=function(t,e,o){var n=this.removeItem(e,o);if(n)return!0;for(var i=null,r=e.getChildBoundables(),s=0;s<r.length;s++){var a=r[s];if(this.getIntersectsOp().intersects(a.getBounds(),t)&&(a instanceof jsts.index.strtree.AbstractNode&&(n=this.remove(t,a,o)))){i=a;break}}return null!=i&&0===i.getChildBoundables().length&&r.splice(r.indexOf(i),1),n},jsts.index.strtree.AbstractSTRtree.prototype.removeItem=function(t,e){for(var o=null,n=t.getChildBoundables(),i=0;i<n.length;i++){var r=n[i];r instanceof jsts.index.strtree.ItemBoundable&&r.getItem()===e&&(o=r)}return null!==o&&(n.splice(n.indexOf(o),1),!0)},jsts.index.strtree.AbstractSTRtree.prototype.boundablesAtLevel=function(t){if(arguments.length>1)return void this.boundablesAtLevel2.apply(this,arguments);var e=[];return this.boundablesAtLevel2(t,this.root,e),e},jsts.index.strtree.AbstractSTRtree.prototype.boundablesAtLevel2=function(t,e,o){if(jsts.util.Assert.isTrue(t>-2),e.getLevel()===t)return void o.add(e);for(var n=node.getChildBoundables(),i=0;i<n.length;i++){var r=n[i];r instanceof jsts.index.strtree.AbstractNode?this.boundablesAtLevel(t,r,o):(jsts.util.Assert.isTrue(r instanceof jsts.index.strtree.ItemBoundable),-1===t&&o.add(r))}},jsts.index.strtree.AbstractSTRtree.prototype.getComparator=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.index.strtree.STRtree=function(t){t=t||jsts.index.strtree.STRtree.DEFAULT_NODE_CAPACITY,jsts.index.strtree.AbstractSTRtree.call(this,t)},jsts.index.strtree.STRtree.prototype=new jsts.index.strtree.AbstractSTRtree,jsts.index.strtree.STRtree.constructor=jsts.index.strtree.STRtree,jsts.index.strtree.STRtree.prototype.xComparator=function(t,e){return jsts.index.strtree.AbstractSTRtree.prototype.compareDoubles(jsts.index.strtree.STRtree.prototype.centreX(t.getBounds()),jsts.index.strtree.STRtree.prototype.centreX(e.getBounds()))},jsts.index.strtree.STRtree.prototype.yComparator=function(t,e){return jsts.index.strtree.AbstractSTRtree.prototype.compareDoubles(jsts.index.strtree.STRtree.prototype.centreY(t.getBounds()),jsts.index.strtree.STRtree.prototype.centreY(e.getBounds()))},jsts.index.strtree.STRtree.prototype.centreX=function(t){return jsts.index.strtree.STRtree.prototype.avg(t.getMinX(),t.getMaxX())},jsts.index.strtree.STRtree.prototype.centreY=function(t){return jsts.index.strtree.STRtree.prototype.avg(t.getMinY(),t.getMaxY())},jsts.index.strtree.STRtree.prototype.avg=function(t,e){return(t+e)/2},jsts.index.strtree.STRtree.prototype.intersectsOp={intersects:function(t,e){return t.intersects(e)}},jsts.index.strtree.STRtree.prototype.createParentBoundables=function(t,e){jsts.util.Assert.isTrue(!(0===t.length));for(var o=Math.ceil(t.length/this.getNodeCapacity()),n=[],i=0;i<t.length;i++)n.push(t[i]);n.sort(this.xComparator);var r=this.verticalSlices(n,Math.ceil(Math.sqrt(o)));return this.createParentBoundablesFromVerticalSlices(r,e)},jsts.index.strtree.STRtree.prototype.createParentBoundablesFromVerticalSlices=function(t,e){jsts.util.Assert.isTrue(t.length>0);for(var o=[],n=0;n<t.length;n++)o=o.concat(this.createParentBoundablesFromVerticalSlice(t[n],e));return o},jsts.index.strtree.STRtree.prototype.createParentBoundablesFromVerticalSlice=function(t,e){return jsts.index.strtree.AbstractSTRtree.prototype.createParentBoundables.call(this,t,e)},jsts.index.strtree.STRtree.prototype.verticalSlices=function(t,e){for(var o,n,i=Math.ceil(t.length/e),r=[],s=0,a=0;a<e;a++)for(r[a]=[],o=0;s<t.length&&o<i;)n=t[s++],r[a].push(n),o++;return r},jsts.index.strtree.STRtree.DEFAULT_NODE_CAPACITY=10,jsts.index.strtree.STRtree.prototype.createNode=function(t){var e=new jsts.index.strtree.AbstractNode(t);return e.computeBounds=function(){for(var t=null,e=this.getChildBoundables(),o=0;o<e.length;o++){var n=e[o];null===t?t=new jsts.geom.Envelope(n.getBounds()):t.expandToInclude(n.getBounds())}return t},e},jsts.index.strtree.STRtree.prototype.getIntersectsOp=function(){return this.intersectsOp},jsts.index.strtree.STRtree.prototype.insert=function(t,e){t.isNull()||jsts.index.strtree.AbstractSTRtree.prototype.insert.call(this,t,e)},jsts.index.strtree.STRtree.prototype.query=function(t,e){return jsts.index.strtree.AbstractSTRtree.prototype.query.apply(this,arguments)},jsts.index.strtree.STRtree.prototype.remove=function(t,e){return jsts.index.strtree.AbstractSTRtree.prototype.remove.call(this,t,e)},jsts.index.strtree.STRtree.prototype.size=function(){return jsts.index.strtree.AbstractSTRtree.prototype.size.call(this)},jsts.index.strtree.STRtree.prototype.depth=function(){return jsts.index.strtree.AbstractSTRtree.prototype.depth.call(this)},jsts.index.strtree.STRtree.prototype.getComparator=function(){return this.yComparator},jsts.index.strtree.STRtree.prototype.nearestNeighbour=function(t){var e=new jsts.index.strtree.BoundablePair(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour4(e)},jsts.index.strtree.STRtree.prototype.nearestNeighbour2=function(t,e,o){var n=new jsts.index.strtree.ItemBoundable(t,e),i=new jsts.index.strtree.BoundablePair(this.getRoot(),n,o);return this.nearestNeighbour4(i)[0]},jsts.index.strtree.STRtree.prototype.nearestNeighbour3=function(t,e){var o=new jsts.index.strtree.BoundablePair(this.getRoot(),t.getRoot(),e);return this.nearestNeighbour4(o)},jsts.index.strtree.STRtree.prototype.nearestNeighbour4=function(t){return this.nearestNeighbour5(t,Double.POSITIVE_INFINITY)},jsts.index.strtree.STRtree.prototype.nearestNeighbour5=function(t,e){var o=e,n=null,i=[];for(i.push(t);!i.isEmpty()&&o>0;){var r=i.pop(),s=r.getDistance();if(s>=o)break;r.isLeaves()?(o=s,n=r):r.expandToQueue(i,o)}return[n.getBoundable(0).getItem(),n.getBoundable(1).getItem()]},jsts.noding.SegmentString=function(){},jsts.noding.SegmentString.prototype.getData=jsts.abstractFunc,jsts.noding.SegmentString.prototype.setData=jsts.abstractFunc,jsts.noding.SegmentString.prototype.size=jsts.abstractFunc,jsts.noding.SegmentString.prototype.getCoordinate=jsts.abstractFunc,jsts.noding.SegmentString.prototype.getCoordinates=jsts.abstractFunc,jsts.noding.SegmentString.prototype.isClosed=jsts.abstractFunc,jsts.noding.NodableSegmentString=function(){},jsts.noding.NodableSegmentString.prototype=new jsts.noding.SegmentString,jsts.noding.NodableSegmentString.prototype.addIntersection=jsts.abstractFunc,jsts.noding.NodedSegmentString=function(t,e){this.nodeList=new jsts.noding.SegmentNodeList(this),this.pts=t,this.data=e},jsts.noding.NodedSegmentString.prototype=new jsts.noding.NodableSegmentString,jsts.noding.NodedSegmentString.constructor=jsts.noding.NodedSegmentString,jsts.noding.NodedSegmentString.getNodedSubstrings=function(t){if(2===arguments.length)return void jsts.noding.NodedSegmentString.getNodedSubstrings2.apply(this,arguments);var e=new javascript.util.ArrayList;return jsts.noding.NodedSegmentString.getNodedSubstrings2(t,e),e},jsts.noding.NodedSegmentString.getNodedSubstrings2=function(t,e){for(var o=t.iterator();o.hasNext();){o.next().getNodeList().addSplitEdges(e)}},jsts.noding.NodedSegmentString.prototype.nodeList=null,jsts.noding.NodedSegmentString.prototype.pts=null,jsts.noding.NodedSegmentString.prototype.data=null,jsts.noding.NodedSegmentString.prototype.getData=function(){return this.data},jsts.noding.NodedSegmentString.prototype.setData=function(t){this.data=t},jsts.noding.NodedSegmentString.prototype.getNodeList=function(){return this.nodeList},jsts.noding.NodedSegmentString.prototype.size=function(){return this.pts.length},jsts.noding.NodedSegmentString.prototype.getCoordinate=function(t){return this.pts[t]},jsts.noding.NodedSegmentString.prototype.getCoordinates=function(){return this.pts},jsts.noding.NodedSegmentString.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},jsts.noding.NodedSegmentString.prototype.getSegmentOctant=function(t){return t===this.pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},jsts.noding.NodedSegmentString.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:jsts.noding.Octant.octant(t,e)},jsts.noding.NodedSegmentString.prototype.addIntersections=function(t,e,o){for(var n=0;n<t.getIntersectionNum();n++)this.addIntersection(t,e,o,n)},jsts.noding.NodedSegmentString.prototype.addIntersection=function(t,e,o,n){if(t instanceof jsts.geom.Coordinate)return void this.addIntersection2.apply(this,arguments);var i=new jsts.geom.Coordinate(t.getIntersection(n));this.addIntersection2(i,e)},jsts.noding.NodedSegmentString.prototype.addIntersection2=function(t,e){this.addIntersectionNode(t,e)},jsts.noding.NodedSegmentString.prototype.addIntersectionNode=function(t,e){var o=e,n=o+1;if(n<this.pts.length){var i=this.pts[n];t.equals2D(i)&&(o=n)}return this.nodeList.add(t,o)},jsts.noding.NodedSegmentString.prototype.toString=function(){var t=new jsts.geom.GeometryFactory;return(new jsts.io.WKTWriter).write(t.createLineString(this.pts))},jsts.index.chain.MonotoneChainBuilder=function(){},jsts.index.chain.MonotoneChainBuilder.toIntArray=function(t){for(var e=[],o=0;o<t.length;o++)e[o]=t[o];return e},jsts.index.chain.MonotoneChainBuilder.getChains=function(t){return 2===arguments.length?jsts.index.chain.MonotoneChainBuilder.getChains2.apply(this,arguments):jsts.index.chain.MonotoneChainBuilder.getChains2(t,null)},jsts.index.chain.MonotoneChainBuilder.getChains2=function(t,e){for(var o=[],n=jsts.index.chain.MonotoneChainBuilder.getChainStartIndices(t),i=0;i<n.length-1;i++){var r=new jsts.index.chain.MonotoneChain(t,n[i],n[i+1],e);o.push(r)}return o},jsts.index.chain.MonotoneChainBuilder.getChainStartIndices=function(t){var e=0,o=[];o.push(e);do{var n=jsts.index.chain.MonotoneChainBuilder.findChainEnd(t,e);o.push(n),e=n}while(e<t.length-1);return jsts.index.chain.MonotoneChainBuilder.toIntArray(o)},jsts.index.chain.MonotoneChainBuilder.findChainEnd=function(t,e){for(var o=e;o<t.length-1&&t[o].equals2D(t[o+1]);)o++;if(o>=t.length-1)return t.length-1;for(var n=jsts.geomgraph.Quadrant.quadrant(t[o],t[o+1]),i=e+1;i<t.length;){if(!t[i-1].equals2D(t[i])){if(jsts.geomgraph.Quadrant.quadrant(t[i-1],t[i])!==n)break}i++}return i-1},jsts.geom.LineSegment=function(t,e){if(void 0===t)return this.p0=new jsts.geom.Coordinate,void(this.p1=new jsts.geom.Coordinate);this.p0=t,this.p1=e},jsts.geom.LineSegment.prototype.p0=null,jsts.geom.LineSegment.prototype.p1=null,jsts.geom.LineSegment.prototype.getLength=function(){return this.p0.distance(p1)},jsts.geom.LineSegment.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},jsts.geom.LineSegment.prototype.isVertical=function(){return this.p0.x===this.p1.x},jsts.geom.LineSegment.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},jsts.geom.LineSegment.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,n=e*e+o*o;return((t.x-this.p0.x)*e+(t.y-this.p0.y)*o)/n},jsts.geom.LineSegment.prototype.closestPoint=function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},jsts.geom.LineSegment.prototype.closestPoints=function(t){var e=this.intersection(t);if(null!==e)return[e,e];var o,n=[],i=Number.MAX_VALUE,r=this.closestPoint(t.p0);i=r.distance(t.p0),n[0]=r,n[1]=t.p0;var s=this.closestPoint(t.p1);(o=s.distance(t.p1))<i&&(i=o,n[0]=s,n[1]=t.p1);var a=t.closestPoint(this.p0);(o=a.distance(this.p0))<i&&(i=o,n[0]=this.p0,n[1]=a);var l=t.closestPoint(this.p1);return o=l.distance(this.p1),o<i&&(i=o,n[0]=this.p1,n[1]=l),n},jsts.geom.LineSegment.prototype.intersection=function(t){var e=new jsts.algorithm.RobustLineIntersector;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},jsts.geom.LineSegment.prototype.project=function(t){if(t.equals(this.p0)||t.equals(this.p1))return new jsts.geom.Coordinate(t);var e=this.projectionFactor(t),o=new jsts.geom.Coordinate;return o.x=this.p0.x+e*(this.p1.x-this.p0.x),o.y=this.p0.y+e*(this.p1.y-this.p0.y),o},jsts.geom.LineSegment.prototype.setCoordinates=function(t){if(t instanceof jsts.geom.Coordinate)return void this.setCoordinates2.apply(this,arguments);this.setCoordinates2(t.p0,t.p1)},jsts.geom.LineSegment.prototype.setCoordinates2=function(t,e){this.p0.x=t.x,this.p0.y=t.y,this.p1.x=e.x,this.p1.y=e.y},jsts.geom.LineSegment.prototype.distance=function(t){return jsts.algorithm.CGAlgorithms.distancePointLine(t,this.p0,this.p1)},jsts.index.chain.MonotoneChainOverlapAction=function(){this.tempEnv1=new jsts.geom.Envelope,this.tempEnv2=new jsts.geom.Envelope,this.overlapSeg1=new jsts.geom.LineSegment,this.overlapSeg2=new jsts.geom.LineSegment},jsts.index.chain.MonotoneChainOverlapAction.prototype.tempEnv1=null,jsts.index.chain.MonotoneChainOverlapAction.prototype.tempEnv2=null,jsts.index.chain.MonotoneChainOverlapAction.prototype.overlapSeg1=null,jsts.index.chain.MonotoneChainOverlapAction.prototype.overlapSeg2=null,jsts.index.chain.MonotoneChainOverlapAction.prototype.overlap=function(t,e,o,n){this.mc1.getLineSegment(e,this.overlapSeg1),this.mc2.getLineSegment(n,this.overlapSeg2),this.overlap2(this.overlapSeg1,this.overlapSeg2)},jsts.index.chain.MonotoneChainOverlapAction.prototype.overlap2=function(t,e){},function(){var t=jsts.index.chain.MonotoneChainOverlapAction,e=jsts.noding.SinglePassNoder,o=jsts.index.strtree.STRtree,n=jsts.noding.NodedSegmentString,i=jsts.index.chain.MonotoneChainBuilder,r=function(t){this.si=t};r.prototype=new t,r.constructor=r,r.prototype.si=null,r.prototype.overlap=function(t,e,o,n){var i=t.getContext(),r=o.getContext();this.si.processIntersections(i,e,r,n)},jsts.noding.MCIndexNoder=function(){this.monoChains=[],this.index=new o},jsts.noding.MCIndexNoder.prototype=new e,jsts.noding.MCIndexNoder.constructor=jsts.noding.MCIndexNoder,jsts.noding.MCIndexNoder.prototype.monoChains=null,jsts.noding.MCIndexNoder.prototype.index=null,jsts.noding.MCIndexNoder.prototype.idCounter=0,jsts.noding.MCIndexNoder.prototype.nodedSegStrings=null,jsts.noding.MCIndexNoder.prototype.nOverlaps=0,jsts.noding.MCIndexNoder.prototype.getMonotoneChains=function(){return this.monoChains},jsts.noding.MCIndexNoder.prototype.getIndex=function(){return this.index},jsts.noding.MCIndexNoder.prototype.getNodedSubstrings=function(){return n.getNodedSubstrings(this.nodedSegStrings)},jsts.noding.MCIndexNoder.prototype.computeNodes=function(t){this.nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},jsts.noding.MCIndexNoder.prototype.intersectChains=function(){for(var t=new r(this.segInt),e=0;e<this.monoChains.length;e++)for(var o=this.monoChains[e],n=this.index.query(o.getEnvelope()),i=0;i<n.length;i++){var s=n[i];if(s.getId()>o.getId()&&(o.computeOverlaps(s,t),this.nOverlaps++),this.segInt.isDone())return}},jsts.noding.MCIndexNoder.prototype.add=function(t){for(var e=i.getChains(t.getCoordinates(),t),o=0;o<e.length;o++){var n=e[o];n.setId(this.idCounter++),this.index.insert(n.getEnvelope(),n),this.monoChains.push(n)}}}(),function(){var t=jsts.algorithm.RobustLineIntersector,e=jsts.noding.InteriorIntersectionFinder,o=jsts.noding.MCIndexNoder;jsts.noding.FastNodingValidator=function(e){this.li=new t,this.segStrings=e},jsts.noding.FastNodingValidator.prototype.li=null,jsts.noding.FastNodingValidator.prototype.segStrings=null,jsts.noding.FastNodingValidator.prototype.findAllIntersections=!1,jsts.noding.FastNodingValidator.prototype.segInt=null,jsts.noding.FastNodingValidator.prototype._isValid=!0,jsts.noding.FastNodingValidator.prototype.setFindAllIntersections=function(t){this.findAllIntersections=t},jsts.noding.FastNodingValidator.prototype.getIntersections=function(){return segInt.getIntersections()},jsts.noding.FastNodingValidator.prototype.isValid=function(){return this.execute(),this._isValid},jsts.noding.FastNodingValidator.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this.segInt.getIntersectionSegments();return"found non-noded intersection between "+jsts.io.WKTWriter.toLineString(t[0],t[1])+" and "+jsts.io.WKTWriter.toLineString(t[2],t[3])},jsts.noding.FastNodingValidator.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new jsts.error.TopologyError(this.getErrorMessage(),this.segInt.getInteriorIntersection())},jsts.noding.FastNodingValidator.prototype.execute=function(){null==this.segInt&&this.checkInteriorIntersections()},jsts.noding.FastNodingValidator.prototype.checkInteriorIntersections=function(){this._isValid=!0,this.segInt=new e(this.li),this.segInt.setFindAllIntersections(this.findAllIntersections);var t=new o;if(t.setSegmentIntersector(this.segInt),t.computeNodes(this.segStrings),this.segInt.hasIntersection())return void(this._isValid=!1)}}(),function(){jsts.noding.BasicSegmentString=function(t,e){this.pts=t,this.data=e},jsts.noding.BasicSegmentString.prototype=new jsts.noding.SegmentString,jsts.noding.BasicSegmentString.prototype.pts=null,jsts.noding.BasicSegmentString.prototype.data=null,jsts.noding.BasicSegmentString.prototype.getData=function(){return this.data},jsts.noding.BasicSegmentString.prototype.setData=function(t){this.data=t},jsts.noding.BasicSegmentString.prototype.size=function(){return this.pts.length},jsts.noding.BasicSegmentString.prototype.getCoordinate=function(t){return this.pts[t]},jsts.noding.BasicSegmentString.prototype.getCoordinates=function(){return this.pts},jsts.noding.BasicSegmentString.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},jsts.noding.BasicSegmentString.prototype.getSegmentOctant=function(t){return t==this.pts.length-1?-1:jsts.noding.Octant.octant(this.getCoordinate(t),this.getCoordinate(t+1))}}(),function(){var t=jsts.noding.FastNodingValidator,e=jsts.noding.BasicSegmentString,o=javascript.util.ArrayList;jsts.geomgraph.EdgeNodingValidator=function(e){this.nv=new t(jsts.geomgraph.EdgeNodingValidator.toSegmentStrings(e))},jsts.geomgraph.EdgeNodingValidator.checkValid=function(t){new jsts.geomgraph.EdgeNodingValidator(t).checkValid()},jsts.geomgraph.EdgeNodingValidator.toSegmentStrings=function(t){for(var n=new o,i=t.iterator();i.hasNext();){var r=i.next();n.add(new e(r.getCoordinates(),r))}return n},jsts.geomgraph.EdgeNodingValidator.prototype.nv=null,jsts.geomgraph.EdgeNodingValidator.prototype.checkValid=function(){this.nv.checkValid()}}(),jsts.operation.GeometryGraphOperation=function(t,e,o){if(this.li=new jsts.algorithm.RobustLineIntersector,this.arg=[],void 0!==t){if(void 0===e)return this.setComputationPrecision(t.getPrecisionModel()),void(this.arg[0]=new jsts.geomgraph.GeometryGraph(0,t));o=o||jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE,t.getPrecisionModel().compareTo(e.getPrecisionModel())>=0?this.setComputationPrecision(t.getPrecisionModel()):this.setComputationPrecision(e.getPrecisionModel()),this.arg[0]=new jsts.geomgraph.GeometryGraph(0,t,o),this.arg[1]=new jsts.geomgraph.GeometryGraph(1,e,o)}},jsts.operation.GeometryGraphOperation.prototype.li=null,jsts.operation.GeometryGraphOperation.prototype.resultPrecisionModel=null,jsts.operation.GeometryGraphOperation.prototype.arg=null,jsts.operation.GeometryGraphOperation.prototype.getArgGeometry=function(t){return arg[t].getGeometry()},jsts.operation.GeometryGraphOperation.prototype.setComputationPrecision=function(t){this.resultPrecisionModel=t,this.li.setPrecisionModel(this.resultPrecisionModel)},jsts.operation.overlay.OverlayNodeFactory=function(){},jsts.operation.overlay.OverlayNodeFactory.prototype=new jsts.geomgraph.NodeFactory,jsts.operation.overlay.OverlayNodeFactory.constructor=jsts.operation.overlay.OverlayNodeFactory,jsts.operation.overlay.OverlayNodeFactory.prototype.createNode=function(t){return new jsts.geomgraph.Node(t,new jsts.geomgraph.DirectedEdgeStar)},jsts.operation.overlay.PolygonBuilder=function(t){this.shellList=[],this.geometryFactory=t},jsts.operation.overlay.PolygonBuilder.prototype.geometryFactory=null,jsts.operation.overlay.PolygonBuilder.prototype.shellList=null,jsts.operation.overlay.PolygonBuilder.prototype.add=function(t){if(2===arguments.length)return void this.add2.apply(this,arguments);this.add2(t.getEdgeEnds(),t.getNodes())},jsts.operation.overlay.PolygonBuilder.prototype.add2=function(t,e){jsts.geomgraph.PlanarGraph.linkResultDirectedEdges(e);var o=this.buildMaximalEdgeRings(t),n=[],i=this.buildMinimalEdgeRings(o,this.shellList,n);this.sortShellsAndHoles(i,this.shellList,n),this.placeFreeHoles(this.shellList,n)},jsts.operation.overlay.PolygonBuilder.prototype.getPolygons=function(){return this.computePolygons(this.shellList)},jsts.operation.overlay.PolygonBuilder.prototype.buildMaximalEdgeRings=function(t){for(var e=[],o=t.iterator();o.hasNext();){var n=o.next();if(n.isInResult()&&n.getLabel().isArea()&&null==n.getEdgeRing()){var i=new jsts.operation.overlay.MaximalEdgeRing(n,this.geometryFactory);e.push(i),i.setInResult()}}return e},jsts.operation.overlay.PolygonBuilder.prototype.buildMinimalEdgeRings=function(t,e,o){for(var n=[],i=0;i<t.length;i++){var r=t[i];if(r.getMaxNodeDegree()>2){r.linkDirectedEdgesForMinimalEdgeRings();var s=r.buildMinimalRings(),a=this.findShell(s);null!==a?(this.placePolygonHoles(a,s),e.push(a)):o=o.concat(s)}else n.push(r)}return n},jsts.operation.overlay.PolygonBuilder.prototype.findShell=function(t){for(var e=0,o=null,n=0;n<t.length;n++){var i=t[n];i.isHole()||(o=i,e++)}return jsts.util.Assert.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),o},jsts.operation.overlay.PolygonBuilder.prototype.placePolygonHoles=function(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.isHole()&&n.setShell(t)}},jsts.operation.overlay.PolygonBuilder.prototype.sortShellsAndHoles=function(t,e,o){for(var n=0;n<t.length;n++){var i=t[n];i.isHole()?o.push(i):e.push(i)}},jsts.operation.overlay.PolygonBuilder.prototype.placeFreeHoles=function(t,e){for(var o=0;o<e.length;o++){var n=e[o];if(null==n.getShell()){var i=this.findEdgeRingContaining(n,t);if(null===i)throw new jsts.error.TopologyError("unable to assign hole to a shell",n.getCoordinate(0));n.setShell(i)}}},jsts.operation.overlay.PolygonBuilder.prototype.findEdgeRingContaining=function(t,e){for(var o=t.getLinearRing(),n=o.getEnvelopeInternal(),i=o.getCoordinateN(0),r=null,s=null,a=0;a<e.length;a++){var l=e[a],c=l.getLinearRing(),u=c.getEnvelopeInternal();null!==r&&(s=r.getLinearRing().getEnvelopeInternal());var h=!1;u.contains(n)&&jsts.algorithm.CGAlgorithms.isPointInRing(i,c.getCoordinates())&&(h=!0),h&&(null==r||s.contains(u))&&(r=l)}return r},jsts.operation.overlay.PolygonBuilder.prototype.computePolygons=function(t){for(var e=new javascript.util.ArrayList,o=0;o<t.length;o++){var n=t[o],i=n.toPolygon(this.geometryFactory);e.add(i)}return e},jsts.operation.overlay.PolygonBuilder.prototype.containsPoint=function(t){for(var e=0;e<this.shellList.length;e++){if(this.shellList[e].containsPoint(t))return!0}return!1},function(){var t=jsts.util.Assert,e=javascript.util.ArrayList,o=function(t,o,n){this.lineEdgesList=new e,this.resultLineList=new e,this.op=t,this.geometryFactory=o,this.ptLocator=n};o.prototype.op=null,o.prototype.geometryFactory=null,o.prototype.ptLocator=null,o.prototype.lineEdgesList=null,o.prototype.resultLineList=null,o.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this.resultLineList},o.prototype.findCoveredLineEdges=function(){for(var t=this.op.getGraph().getNodes().iterator();t.hasNext();){t.next().getEdges().findCoveredLineEdges()}for(var e=this.op.getGraph().getEdgeEnds().iterator();e.hasNext();){var o=e.next(),n=o.getEdge();if(o.isLineEdge()&&!n.isCoveredSet()){var i=this.op.isCoveredByA(o.getCoordinate());n.setCovered(i)}}},o.prototype.collectLines=function(t){for(var e=this.op.getGraph().getEdgeEnds().iterator();e.hasNext();){var o=e.next();this.collectLineEdge(o,t,this.lineEdgesList),this.collectBoundaryTouchEdge(o,t,this.lineEdgesList)}},o.prototype.collectLineEdge=function(t,e,o){var n=t.getLabel(),i=t.getEdge();t.isLineEdge()&&(t.isVisited()||!jsts.operation.overlay.OverlayOp.isResultOfOp(n,e)||i.isCovered()||(o.add(i),t.setVisitedEdge(!0)))},o.prototype.collectBoundaryTouchEdge=function(e,o,n){var i=e.getLabel();e.isLineEdge()||e.isVisited()||e.isInteriorAreaEdge()||e.getEdge().isInResult()||(t.isTrue(!(e.isInResult()||e.getSym().isInResult())||!e.getEdge().isInResult()),jsts.operation.overlay.OverlayOp.isResultOfOp(i,o)&&o===jsts.operation.overlay.OverlayOp.INTERSECTION&&(n.add(e.getEdge()),e.setVisitedEdge(!0)))},o.prototype.buildLines=function(t){for(var e=this.lineEdgesList.iterator();e.hasNext();){var o=e.next(),n=(o.getLabel(),this.geometryFactory.createLineString(o.getCoordinates()));this.resultLineList.add(n),o.setInResult(!0)}},o.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var o=e.next(),n=o.getLabel();o.isIsolated()&&(n.isNull(0)?this.labelIsolatedLine(o,0):this.labelIsolatedLine(o,1))}},o.prototype.labelIsolatedLine=function(t,e){var o=ptLocator.locate(t.getCoordinate(),op.getArgGeometry(e));t.getLabel().setLocation(e,o)},jsts.operation.overlay.LineBuilder=o}(),function(){var t=javascript.util.ArrayList,e=function(e,o,n){this.resultPointList=new t,this.op=e,this.geometryFactory=o};e.prototype.op=null,e.prototype.geometryFactory=null,e.prototype.resultPointList=null,e.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this.resultPointList},e.prototype.extractNonCoveredResultNodes=function(t){for(var e=this.op.getGraph().getNodes().iterator();e.hasNext();){var o=e.next();if(!o.isInResult()&&(!o.isIncidentEdgeInResult()&&(0===o.getEdges().getDegree()||t===jsts.operation.overlay.OverlayOp.INTERSECTION))){var n=o.getLabel();jsts.operation.overlay.OverlayOp.isResultOfOp(n,t)&&this.filterCoveredNodeToPoint(o)}}},e.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this.op.isCoveredByLA(e)){var o=this.geometryFactory.createPoint(e);this.resultPointList.add(o)}},jsts.operation.overlay.PointBuilder=e}(),function(){var t=jsts.algorithm.PointLocator,e=jsts.geom.Location,o=jsts.geomgraph.EdgeList,n=jsts.geomgraph.Label,i=jsts.geomgraph.PlanarGraph,r=jsts.geomgraph.Position,s=jsts.geomgraph.EdgeNodingValidator,a=jsts.operation.GeometryGraphOperation,l=jsts.operation.overlay.OverlayNodeFactory,c=jsts.operation.overlay.PolygonBuilder,u=jsts.operation.overlay.LineBuilder,h=jsts.operation.overlay.PointBuilder,g=jsts.util.Assert,p=javascript.util.ArrayList;jsts.operation.overlay.OverlayOp=function(e,n){this.ptLocator=new t,this.edgeList=new o,this.resultPolyList=new p,this.resultLineList=new p,this.resultPointList=new p,a.call(this,e,n),this.graph=new i(new l),this.geomFact=e.getFactory()},jsts.operation.overlay.OverlayOp.prototype=new a,jsts.operation.overlay.OverlayOp.constructor=jsts.operation.overlay.OverlayOp,jsts.operation.overlay.OverlayOp.INTERSECTION=1,jsts.operation.overlay.OverlayOp.UNION=2,jsts.operation.overlay.OverlayOp.DIFFERENCE=3,jsts.operation.overlay.OverlayOp.SYMDIFFERENCE=4,jsts.operation.overlay.OverlayOp.overlayOp=function(t,e,o){return new jsts.operation.overlay.OverlayOp(t,e).getResultGeometry(o)},jsts.operation.overlay.OverlayOp.isResultOfOp=function(t,e){if(3===arguments.length)return jsts.operation.overlay.OverlayOp.isResultOfOp2.apply(this,arguments);var o=t.getLocation(0),n=t.getLocation(1);return jsts.operation.overlay.OverlayOp.isResultOfOp2(o,n,e)},jsts.operation.overlay.OverlayOp.isResultOfOp2=function(t,o,n){switch(t==e.BOUNDARY&&(t=e.INTERIOR),o==e.BOUNDARY&&(o=e.INTERIOR),n){case jsts.operation.overlay.OverlayOp.INTERSECTION:return t==e.INTERIOR&&o==e.INTERIOR;case jsts.operation.overlay.OverlayOp.UNION:return t==e.INTERIOR||o==e.INTERIOR;case jsts.operation.overlay.OverlayOp.DIFFERENCE:return t==e.INTERIOR&&o!=e.INTERIOR;case jsts.operation.overlay.OverlayOp.SYMDIFFERENCE:return t==e.INTERIOR&&o!=e.INTERIOR||t!=e.INTERIOR&&o==e.INTERIOR}return!1},jsts.operation.overlay.OverlayOp.prototype.ptLocator=null,jsts.operation.overlay.OverlayOp.prototype.geomFact=null,jsts.operation.overlay.OverlayOp.prototype.resultGeom=null,jsts.operation.overlay.OverlayOp.prototype.graph=null,jsts.operation.overlay.OverlayOp.prototype.edgeList=null,jsts.operation.overlay.OverlayOp.prototype.resultPolyList=null,jsts.operation.overlay.OverlayOp.prototype.resultLineList=null,jsts.operation.overlay.OverlayOp.prototype.resultPointList=null,jsts.operation.overlay.OverlayOp.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this.resultGeom},jsts.operation.overlay.OverlayOp.prototype.getGraph=function(){return this.graph},jsts.operation.overlay.OverlayOp.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this.arg[0].computeSelfNodes(this.li,!1),this.arg[1].computeSelfNodes(this.li,!1),this.arg[0].computeEdgeIntersections(this.arg[1],this.li,!0);var e=new p;this.arg[0].computeSplitEdges(e),this.arg[1].computeSplitEdges(e);this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),s.checkValid(this.edgeList.getEdges()),this.graph.addEdges(this.edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var o=new c(this.geomFact);o.add(this.graph),this.resultPolyList=o.getPolygons();var n=new u(this,this.geomFact,this.ptLocator);this.resultLineList=n.build(t);var i=new h(this,this.geomFact,this.ptLocator);this.resultPointList=i.build(t),this.resultGeom=this.computeGeometry(this.resultPointList,this.resultLineList,this.resultPolyList,t)},jsts.operation.overlay.OverlayOp.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var o=e.next();this.insertUniqueEdge(o)}},jsts.operation.overlay.OverlayOp.prototype.insertUniqueEdge=function(t){var e=this.edgeList.findEqualEdge(t);if(null!==e){var o=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new n(t.getLabel()),i.flip());var r=e.getDepth();r.isNull()&&r.add(o),r.add(i),o.merge(i)}else this.edgeList.add(t)},jsts.operation.overlay.OverlayOp.prototype.computeLabelsFromDepths=function(){for(var t=this.edgeList.iterator();t.hasNext();){var e=t.next(),o=e.getLabel(),n=e.getDepth();if(!n.isNull()){n.normalize();for(var i=0;i<2;i++)o.isNull(i)||!o.isArea()||n.isNull(i)||(0==n.getDelta(i)?o.toLine(i):(g.isTrue(!n.isNull(i,r.LEFT),"depth of LEFT side has not been initialized"),o.setLocation(i,r.LEFT,n.getLocation(i,r.LEFT)),g.isTrue(!n.isNull(i,r.RIGHT),"depth of RIGHT side has not been initialized"),o.setLocation(i,r.RIGHT,n.getLocation(i,r.RIGHT))))}}},jsts.operation.overlay.OverlayOp.prototype.replaceCollapsedEdges=function(){for(var t=new p,e=this.edgeList.iterator();e.hasNext();){var o=e.next();o.isCollapsed()&&(e.remove(),t.add(o.getCollapsedEdge()))}this.edgeList.addAll(t)},jsts.operation.overlay.OverlayOp.prototype.copyPoints=function(t){for(var e=this.arg[t].getNodeIterator();e.hasNext();){var o=e.next();this.graph.addNode(o.getCoordinate()).setLabel(t,o.getLabel().getLocation(t))}},jsts.operation.overlay.OverlayOp.prototype.computeLabelling=function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){t.next().getEdges().computeLabelling(this.arg)}this.mergeSymLabels(),this.updateNodeLabelling()},jsts.operation.overlay.OverlayOp.prototype.mergeSymLabels=function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){t.next().getEdges().mergeSymLabels()}},jsts.operation.overlay.OverlayOp.prototype.updateNodeLabelling=function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next(),o=e.getEdges().getLabel();e.getLabel().merge(o)}},jsts.operation.overlay.OverlayOp.prototype.labelIncompleteNodes=function(){for(var t=0,e=this.graph.getNodes().iterator();e.hasNext();){var o=e.next(),n=o.getLabel();o.isIsolated()&&(t++,n.isNull(0)?this.labelIncompleteNode(o,0):this.labelIncompleteNode(o,1)),o.getEdges().updateLabelling(n)}},jsts.operation.overlay.OverlayOp.prototype.labelIncompleteNode=function(t,e){var o=this.ptLocator.locate(t.getCoordinate(),this.arg[e].getGeometry());t.getLabel().setLocation(e,o)},jsts.operation.overlay.OverlayOp.prototype.findResultAreaEdges=function(t){for(var e=this.graph.getEdgeEnds().iterator();e.hasNext();){var o=e.next(),n=o.getLabel();n.isArea()&&!o.isInteriorAreaEdge()&&jsts.operation.overlay.OverlayOp.isResultOfOp(n.getLocation(0,r.RIGHT),n.getLocation(1,r.RIGHT),t)&&o.setInResult(!0)}},jsts.operation.overlay.OverlayOp.prototype.cancelDuplicateResultEdges=function(){for(var t=this.graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),o=e.getSym();e.isInResult()&&o.isInResult()&&(e.setInResult(!1),o.setInResult(!1))}},jsts.operation.overlay.OverlayOp.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this.resultLineList)||!!this.isCovered(t,this.resultPolyList)},jsts.operation.overlay.OverlayOp.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this.resultPolyList)},jsts.operation.overlay.OverlayOp.prototype.isCovered=function(t,o){for(var n=o.iterator();n.hasNext();){var i=n.next();if(this.ptLocator.locate(t,i)!=e.EXTERIOR)return!0}return!1},jsts.operation.overlay.OverlayOp.prototype.computeGeometry=function(t,e,o,n){var i=new p;return i.addAll(t),i.addAll(e),i.addAll(o),this.geomFact.buildGeometry(i)},jsts.operation.overlay.OverlayOp.prototype.createEmptyResult=function(t){var e=null;switch(resultDimension(t,this.arg[0].getGeometry(),this.arg[1].getGeometry())){case-1:e=geomFact.createGeometryCollection();break;case 0:e=geomFact.createPoint(null);break;case 1:e=geomFact.createLineString(null);break;case 2:e=geomFact.createPolygon(null,null)}return e},jsts.operation.overlay.OverlayOp.prototype.resultDimension=function(t,e,o){var n=e.getDimension(),i=o.getDimension(),r=-1;switch(t){case jsts.operation.overlay.OverlayOp.INTERSECTION:r=Math.min(n,i);break;case jsts.operation.overlay.OverlayOp.UNION:r=Math.max(n,i);break;case jsts.operation.overlay.OverlayOp.DIFFERENCE:r=n;break;case jsts.operation.overlay.OverlayOp.SYMDIFFERENCE:r=Math.max(n,i)}return r}}(),function(){var t=function(){this.items=new javascript.util.ArrayList,this.subnode=[null,null]};t.getSubnodeIndex=function(t,e){var o=-1;return t.min>=e&&(o=1),t.max<=e&&(o=0),o},t.prototype.getItems=function(){return this.items},t.prototype.add=function(t){this.items.add(t)},t.prototype.addAllItems=function(t){t.addAll(this.items);var e=0;for(e;e<2;e++)null!==this.subnode[e]&&this.subnode[e].addAllItems(t);return t},t.prototype.addAllItemsFromOverlapping=function(t,e){(null===t||this.isSearchMatch(t))&&(e.addAll(this.items),null!==this.subnode[0]&&this.subnode[0].addAllItemsFromOverlapping(t,e),null!==this.subnode[1]&&this.subnode[1].addAllItemsFromOverlapping(t,e))},t.prototype.remove=function(t,e){if(!this.isSearchMatch(t))return!1;var o=!1,n=0;for(n;n<2;n++)if(null!==this.subnode[n]&&(o=this.subnode[n].remove(t,e))){this.subnode[n].isPrunable()&&(this.subnode[n]=null);break}return o||(o=this.items.remove(e))},t.prototype.isPrunable=function(){return!(this.hasChildren()||this.hasItems())},t.prototype.hasChildren=function(){var t=0;for(t;t<2;t++)if(null!==this.subnode[t])return!0;return!1},t.prototype.hasItems=function(){return!this.items.isEmpty()},t.prototype.depth=function(){var t,e=0,o=0;for(o;o<2;o++)null!==this.subnode[o]&&(t=this.subnode[o].depth())>e&&(e=t);return e+1},t.prototype.size=function(){var t=0,e=0;for(e;e<2;e++)null!==this.subnode[e]&&(t+=this.subnode[e].size());return t+this.items.size()},t.prototype.nodeSize=function(){var t=0,e=0;for(e;e<2;e++)null!==this.subnode[e]&&(t+=this.subnode[e].nodeSize());return t+1},jsts.index.bintree.NodeBase=t}(),function(){var t=function(){if(this.min=0,this.max=0,1===arguments.length){var t=arguments[0];this.init(t.min,t.max)}else 2===arguments.length&&this.init(arguments[0],arguments[1])};t.prototype.init=function(t,e){this.min=t,this.max=e,t>e&&(this.min=e,this.max=t)},t.prototype.getMin=function(){return this.min},t.prototype.getMax=function(){return this.max},t.prototype.getWidth=function(){return this.max-this.min},t.prototype.expandToInclude=function(t){t.max>this.max&&(this.max=t.max),t.min<this.min&&(this.min=t.min)},t.prototype.overlaps=function(){return 1===arguments.length?this.overlapsInterval.apply(this,arguments):this.overlapsMinMax.apply(this,arguments)},t.prototype.overlapsInterval=function(t){return this.overlaps(t.min,t.max)},t.prototype.overlapsMinMax=function(t,e){return!(this.min>e||this.max<t)},t.prototype.contains=function(){var t;return arguments[0]instanceof jsts.index.bintree.Interval?(t=arguments[0],this.containsMinMax(t.min,t.max)):1===arguments.length?this.containsPoint(arguments[0]):this.containsMinMax(arguments[0],arguments[1])},t.prototype.containsMinMax=function(t,e){return t>=this.min&&e<=this.max},t.prototype.containsPoint=function(t){return t>=this.min&&t<=this.max},jsts.index.bintree.Interval=t}(),jsts.index.DoubleBits=function(){},jsts.index.DoubleBits.powerOf2=function(t){return Math.pow(2,t)},jsts.index.DoubleBits.exponent=function(t){return jsts.index.DoubleBits.CVTFWD(64,t)-1023},jsts.index.DoubleBits.CVTFWD=function(t,e){var o,n,i,r,s={32:{d:127,c:128,b:0,a:0},64:{d:32752,c:0,b:0,a:0}},a={32:8,64:11}[t];if(r||(o=e<0||1/e<0,isFinite(e)||(r=s[t],o&&(r.d+=1<<t/4-1),n=Math.pow(2,a)-1,i=0)),!r){for(n={32:127,64:1023}[t],i=Math.abs(e);i>=2;)n++,i/=2;for(;i<1&&n>0;)n--,i*=2;n<=0&&(i/=2,"Zero or Denormal"),32===t&&n>254&&("Too big for Single",r={d:o?255:127,c:128,b:0,a:0},n=Math.pow(2,a)-1,i=0)}return n},function(){var t=jsts.index.DoubleBits,e=jsts.index.bintree.Interval,o=function(t){this.pt=0,this.level=0,this.computeKey(t)};o.computeLevel=function(e){var o=e.getWidth();return t.exponent(o)+1},o.prototype.getPoint=function(){return this.pt},o.prototype.getLevel=function(){return this.level},o.prototype.getInterval=function(){return this.interval},o.prototype.computeKey=function(t){for(this.level=o.computeLevel(t),this.interval=new e,this.computeInterval(this.level,t);!this.interval.contains(t);)this.level+=1,this.computeInterval(this.level,t)},o.prototype.computeInterval=function(e,o){var n=t.powerOf2(e);this.pt=Math.floor(o.getMin()/n)*n,this.interval.init(this.pt,this.pt+n)},jsts.index.bintree.Key=o}(),function(){var t=jsts.index.bintree.NodeBase,e=jsts.index.bintree.Key,o=jsts.index.bintree.Interval,n=function(t,e){this.items=new javascript.util.ArrayList,this.subnode=[null,null],this.interval=t,this.level=e,this.centre=(t.getMin()+t.getMax())/2};n.prototype=new t,n.constructor=n,n.createNode=function(t){var o;return o=new e(t),new n(o.getInterval(),o.getLevel())},n.createExpanded=function(t,e){var i,r;return i=new o(e),null!==t&&i.expandToInclude(t.interval),r=n.createNode(i),null!==t&&r.insert(t),r},n.prototype.getInterval=function(){return this.interval},n.prototype.isSearchMatch=function(t){return t.overlaps(this.interval)},n.prototype.getNode=function(e){var o,n=t.getSubnodeIndex(e,this.centre);return-1!=n?(o=this.getSubnode(n),o.getNode(e)):this},n.prototype.find=function(e){var o,n=t.getSubnodeIndex(e,this.centre);return-1===n?this:null!==this.subnode[n]?(o=this.subnode[n],o.find(e)):this},n.prototype.insert=function(e){var o,n=t.getSubnodeIndex(e.interval,this.centre);e.level===this.level-1?this.subnode[n]=e:(o=this.createSubnode(n),o.insert(e),this.subnode[n]=o)},n.prototype.getSubnode=function(t){return null===this.subnode[t]&&(this.subnode[t]=this.createSubnode(t)),this.subnode[t]},n.prototype.createSubnode=function(t){var e,i,r;switch(e=0,i=0,t){case 0:e=this.interval.getMin(),i=this.centre;break;case 1:e=this.centre,i=this.interval.getMax()}return r=new o(e,i),new n(r,this.level-1)},jsts.index.bintree.Node=n}(),function(){var t=jsts.index.bintree.Node,e=jsts.index.bintree.NodeBase,o=function(){this.subnode=[null,null],this.items=new javascript.util.ArrayList};o.prototype=new jsts.index.bintree.NodeBase,o.constructor=o,o.origin=0,o.prototype.insert=function(n,i){var r,s,a=e.getSubnodeIndex(n,o.origin);if(-1===a)return void this.add(i);r=this.subnode[a],null!==r&&r.getInterval().contains(n)||(s=t.createExpanded(r,n),this.subnode[a]=s),this.insertContained(this.subnode[a],n,i)},o.prototype.insertContained=function(t,e,o){var n,i;n=jsts.index.IntervalSize.isZeroWidth(e.getMin(),e.getMax()),i=n?t.find(e):t.getNode(e),i.add(o)},o.prototype.isSearchMatch=function(t){return!0},jsts.index.bintree.Root=o}(),function(){var t=jsts.index.bintree.Interval,e=jsts.index.bintree.Root,o=function(){this.root=new e,this.minExtent=1};o.ensureExtent=function(e,o){var n,i;return n=e.getMin(),i=e.getMax(),n!==i?e:(n===i&&(n-=o/2,i=n+o/2),new t(n,i))},o.prototype.depth=function(){return null!==this.root?this.root.depth():0},o.prototype.size=function(){return null!==this.root?this.root.size():0},o.prototype.nodeSize=function(){return null!==this.root?this.root.nodeSize():0},o.prototype.insert=function(t,e){this.collectStats(t);var n=o.ensureExtent(t,this.minExtent);this.root.insert(n,e)},o.prototype.remove=function(t,e){var n=o.ensureExtent(t,this.minExtent);return this.root.remove(n,e)},o.prototype.iterator=function(){var t=new javascript.util.ArrayList;return this.root.addAllItems(t),t.iterator()},o.prototype.query=function(){if(2!==arguments.length){var e=arguments[0];return!e instanceof t&&(e=new t(e,e)),this.queryInterval(e)}this.queryAndAdd(arguments[0],arguments[1])},o.prototype.queryInterval=function(t){var e=new javascript.util.ArrayList;return this.query(t,e),e},o.prototype.queryAndAdd=function(t,e){this.root.addAllItemsFromOverlapping(t,e)},o.prototype.collectStats=function(t){var e=t.getWidth();e<this.minExtent&&e>0&&(this.minExtent=e)},jsts.index.bintree.Bintree=o}(),jsts.index.IntervalSize=function(){},jsts.index.IntervalSize.MIN_BINARY_EXPONENT=-50,jsts.index.IntervalSize.isZeroWidth=function(t,e){var o=e-t;if(0===o)return!0;var n,i;return n=Math.max(Math.abs(t),Math.abs(e)),i=o/n,jsts.index.DoubleBits.exponent(i)<=jsts.index.IntervalSize.MIN_BINARY_EXPONENT},jsts.geomgraph.index.SimpleEdgeSetIntersector=function(){},jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype=new jsts.geomgraph.index.EdgeSetIntersector,jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.nOverlaps=0,jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.computeIntersections=function(t,e,o){if(e instanceof javascript.util.List)return void this.computeIntersections2.apply(this,arguments);this.nOverlaps=0;for(var n=t.iterator();n.hasNext();)for(var i=n.next(),r=t.iterator();r.hasNext();){var s=r.next();(o||i!=s)&&this.computeIntersects(i,s,e)}},jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.computeIntersections2=function(t,e,o){this.nOverlaps=0;for(var n=t.iterator();n.hasNext();)for(var i=n.next(),r=e.iterator();r.hasNext();){var s=r.next();this.computeIntersects(i,s,o)}},jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.computeIntersects=function(t,e,o){var n,i,r=t.getCoordinates(),s=e.getCoordinates();for(n=0;n<r.length-1;n++)for(i=0;i<s.length-1;i++)o.addIntersections(t,n,e,i)},jsts.index.ArrayListVisitor=function(){this.items=[]},jsts.index.ArrayListVisitor.prototype.visitItem=function(t){this.items.push(t)},jsts.index.ArrayListVisitor.prototype.getItems=function(){return this.items},jsts.noding.Octant=function(){throw jsts.error.AbstractMethodInvocationError()},jsts.noding.Octant.octant=function(t,e){if(t instanceof jsts.geom.Coordinate)return jsts.noding.Octant.octant2.apply(this,arguments);if(0===t&&0===e)throw new jsts.error.IllegalArgumentError("Cannot compute the octant for point ( "+t+", "+e+" )");var o=Math.abs(t),n=Math.abs(e);return t>=0?e>=0?o>=n?0:1:o>=n?7:6:e>=0?o>=n?3:2:o>=n?4:5},jsts.noding.Octant.octant2=function(t,e){var o=e.x-t.x,n=e.y-t.y;if(0===o&&0===n)throw new jsts.error.IllegalArgumentError("Cannot compute the octant for two identical points "+t);return jsts.noding.Octant.octant(o,n)},jsts.operation.union.UnionInteracting=function(t,e){this.g0=t,this.g1=e,this.geomFactory=t.getFactory(),this.interacts0=[],this.interacts1=[]},jsts.operation.union.UnionInteracting.union=function(t,e){return new jsts.operation.union.UnionInteracting(t,e).union()},jsts.operation.union.UnionInteracting.prototype.geomFactory=null,jsts.operation.union.UnionInteracting.prototype.g0=null,jsts.operation.union.UnionInteracting.prototype.g1=null,jsts.operation.union.UnionInteracting.prototype.interacts0=null,jsts.operation.union.UnionInteracting.prototype.interacts1=null,jsts.operation.union.UnionInteracting.prototype.union=function(){this.computeInteracting();var t=this.extractElements(this.g0,this.interacts0,!0),e=this.extractElements(this.g1,this.interacts1,!0);t.isEmpty()||e.isEmpty();var o=in0.union(e),n=this.extractElements(this.g0,this.interacts0,!1),i=this.extractElements(this.g1,this.interacts1,!1);return jsts.geom.util.GeometryCombiner.combine(o,n,i)},jsts.operation.union.UnionInteracting.prototype.bufferUnion=function(t,e){return t.getFactory().createGeometryCollection([t,e]).buffer(0)},jsts.operation.union.UnionInteracting.prototype.computeInteracting=function(t){if(t){for(var e=!1,o=0,n=g1.getNumGeometries();o<n;o++){this.g1.getGeometryN(o).getEnvelopeInternal().intersects(t.getEnvelopeInternal())&&(this.interacts1[o]=!0,e=!0)}return e}for(var o=0,n=this.g0.getNumGeometries();o<n;o++){var i=this.g0.getGeometryN(o);this.interacts0[o]=this.computeInteracting(i)}},jsts.operation.union.UnionInteracting.prototype.extractElements=function(t,e,o){for(var n=[],i=0,r=t.getNumGeometries();i<r;i++){var s=t.getGeometryN(i);e[i]===o&&n.push(s)}return this.geomFactory.buildGeometry(n)},jsts.io.OpenLayersParser=function(t){this.geometryFactory=t||new jsts.geom.GeometryFactory},jsts.io.OpenLayersParser.prototype.read=function(t){return"OpenLayers.Geometry.Point"===t.CLASS_NAME?this.convertFromPoint(t):"OpenLayers.Geometry.LineString"===t.CLASS_NAME?this.convertFromLineString(t):"OpenLayers.Geometry.LinearRing"===t.CLASS_NAME?this.convertFromLinearRing(t):"OpenLayers.Geometry.Polygon"===t.CLASS_NAME?this.convertFromPolygon(t):"OpenLayers.Geometry.MultiPoint"===t.CLASS_NAME?this.convertFromMultiPoint(t):"OpenLayers.Geometry.MultiLineString"===t.CLASS_NAME?this.convertFromMultiLineString(t):"OpenLayers.Geometry.MultiPolygon"===t.CLASS_NAME?this.convertFromMultiPolygon(t):"OpenLayers.Geometry.Collection"===t.CLASS_NAME?this.convertFromCollection(t):void 0},jsts.io.OpenLayersParser.prototype.convertFromPoint=function(t){return this.geometryFactory.createPoint(new jsts.geom.Coordinate(t.x,t.y))},jsts.io.OpenLayersParser.prototype.convertFromLineString=function(t){var e,o=[];for(e=0;e<t.components.length;e++)o.push(new jsts.geom.Coordinate(t.components[e].x,t.components[e].y));return this.geometryFactory.createLineString(o)},jsts.io.OpenLayersParser.prototype.convertFromLinearRing=function(t){var e,o=[];for(e=0;e<t.components.length;e++)o.push(new jsts.geom.Coordinate(t.components[e].x,t.components[e].y));return this.geometryFactory.createLinearRing(o)},jsts.io.OpenLayersParser.prototype.convertFromPolygon=function(t){var e,o=null,n=[];for(e=0;e<t.components.length;e++){var i=this.convertFromLinearRing(t.components[e]);0===e?o=i:n.push(i)}return this.geometryFactory.createPolygon(o,n)},jsts.io.OpenLayersParser.prototype.convertFromMultiPoint=function(t){var e,o=[];for(e=0;e<t.components.length;e++)o.push(this.convertFromPoint(t.components[e]));return this.geometryFactory.createMultiPoint(o)};jsts.io.OpenLayersParser.prototype.convertFromMultiLineString=function(t){var e,o=[];for(e=0;e<t.components.length;e++)o.push(this.convertFromLineString(t.components[e]));return this.geometryFactory.createMultiLineString(o)},jsts.io.OpenLayersParser.prototype.convertFromMultiPolygon=function(t){var e,o=[];for(e=0;e<t.components.length;e++)o.push(this.convertFromPolygon(t.components[e]));return this.geometryFactory.createMultiPolygon(o)},jsts.io.OpenLayersParser.prototype.convertFromCollection=function(t){var e,o=[];for(e=0;e<t.components.length;e++)o.push(this.convertFrom(t.components[e]));return this.geometryFactory.createGeometryCollection(o)},jsts.io.OpenLayersParser.prototype.write=function(t){return"jsts.geom.Point"===t.CLASS_NAME?this.convertToPoint(t.coordinate):"jsts.geom.LineString"===t.CLASS_NAME?this.convertToLineString(t):"jsts.geom.LinearRing"===t.CLASS_NAME?this.convertToLinearRing(t):"jsts.geom.Polygon"===t.CLASS_NAME?this.convertToPolygon(t):"jsts.geom.MultiPoint"===t.CLASS_NAME?this.convertToMultiPoint(t):"jsts.geom.MultiLineString"===t.CLASS_NAME?this.convertToMultiLineString(t):"jsts.geom.MultiPolygon"===t.CLASS_NAME?this.convertToMultiPolygon(t):"jsts.geom.GeometryCollection"===t.CLASS_NAME?this.convertToCollection(t):void 0},jsts.io.OpenLayersParser.prototype.convertToPoint=function(t){return new OpenLayers.Geometry.Point(t.x,t.y)},jsts.io.OpenLayersParser.prototype.convertToLineString=function(t){var e,o=[];for(e=0;e<t.points.length;e++){var n=t.points[e];o.push(this.convertToPoint(n))}return new OpenLayers.Geometry.LineString(o)},jsts.io.OpenLayersParser.prototype.convertToLinearRing=function(t){var e,o=[];for(e=0;e<t.points.length;e++){var n=t.points[e];o.push(this.convertToPoint(n))}return new OpenLayers.Geometry.LinearRing(o)},jsts.io.OpenLayersParser.prototype.convertToPolygon=function(t){var e,o=[];for(o.push(this.convertToLinearRing(t.shell)),e=0;e<t.holes.length;e++){var n=t.holes[e];o.push(this.convertToLinearRing(n))}return new OpenLayers.Geometry.Polygon(o)},jsts.io.OpenLayersParser.prototype.convertToMultiPoint=function(t){var e,o=[];for(e=0;e<t.geometries.length;e++){var n=t.geometries[e].coordinate;o.push(new OpenLayers.Geometry.Point(n.x,n.y))}return new OpenLayers.Geometry.MultiPoint(o)},jsts.io.OpenLayersParser.prototype.convertToMultiLineString=function(t){var e,o=[];for(e=0;e<t.geometries.length;e++)o.push(this.convertToLineString(t.geometries[e]));return new OpenLayers.Geometry.MultiLineString(o)},jsts.io.OpenLayersParser.prototype.convertToMultiPolygon=function(t){var e,o=[];for(e=0;e<t.geometries.length;e++)o.push(this.convertToPolygon(t.geometries[e]));return new OpenLayers.Geometry.MultiPolygon(o)},jsts.io.OpenLayersParser.prototype.convertToCollection=function(t){var e,o=[];for(e=0;e<t.geometries.length;e++){var n=t.geometries[e],i=this.write(n);o.push(i)}return new OpenLayers.Geometry.Collection(o)},jsts.operation.union.PointGeometryUnion=function(t,e){this.pointGeom=t,this.otherGeom=e,this.geomFact=e.getFactory()},jsts.operation.union.PointGeometryUnion.union=function(t,e){return new jsts.operation.union.PointGeometryUnion(t,e).union()},jsts.operation.union.PointGeometryUnion.prototype.pointGeom=null,jsts.operation.union.PointGeometryUnion.prototype.otherGeom=null,jsts.operation.union.PointGeometryUnion.prototype.geomFact=null,jsts.operation.union.PointGeometryUnion.prototype.union=function(){for(var t=new jsts.algorithm.PointLocator,e=[],o=0,n=this.pointGeom.getNumGeometries();o<n;o++){var i=this.pointGeom.getGeometryN(o),r=i.getCoordinate();if(t.locate(r,this.otherGeom)===jsts.geom.Location.EXTERIOR){for(var s=!0,a=e.length;o--;)if(e[a].equals(r)){s=!1;break}s&&e.push(r)}}if(e.sort(function(t,e){return t.compareTo(e)}),0===e.length)return this.otherGeom;var l=null,c=jsts.geom.CoordinateArrays.toCoordinateArray(e);return l=1===c.length?this.geomFact.createPoint(c[0]):this.geomFact.createMultiPoint(c),jsts.geom.util.GeometryCombiner.combine(l,this.otherGeom)},jsts.noding.IntersectionFinderAdder=function(t){this.li=t,this.interiorIntersections=new javascript.util.ArrayList},jsts.noding.IntersectionFinderAdder.prototype=new jsts.noding.SegmentIntersector,jsts.noding.IntersectionFinderAdder.constructor=jsts.noding.IntersectionFinderAdder,jsts.noding.IntersectionFinderAdder.prototype.li=null,jsts.noding.IntersectionFinderAdder.prototype.interiorIntersections=null,jsts.noding.IntersectionFinderAdder.prototype.getInteriorIntersections=function(){return this.interiorIntersections},jsts.noding.IntersectionFinderAdder.prototype.processIntersections=function(t,e,o,n){if(t!==o||e!==n){var i=t.getCoordinates()[e],r=t.getCoordinates()[e+1],s=o.getCoordinates()[n],a=o.getCoordinates()[n+1];if(this.li.computeIntersection(i,r,s,a),this.li.hasIntersection()&&this.li.isInteriorIntersection()){for(var l=0;l<this.li.getIntersectionNum();l++)this.interiorIntersections.add(this.li.getIntersection(l));t.addIntersections(this.li,e,0),o.addIntersections(this.li,n,1)}}},jsts.noding.IntersectionFinderAdder.prototype.isDone=function(){return!1},jsts.operation.valid.ConnectedInteriorTester=function(t){this.geomGraph=t,this.geometryFactory=new jsts.geom.GeometryFactory,this.disconnectedRingcoord=null},jsts.operation.valid.ConnectedInteriorTester.findDifferentPoint=function(t,e){var o=0,n=t.length;for(o;o<n;o++)if(!t[o].equals(e))return t[o];return null},jsts.operation.valid.ConnectedInteriorTester.prototype.getCoordinate=function(){return this.disconnectedRingcoord},jsts.operation.valid.ConnectedInteriorTester.prototype.isInteriorsConnected=function(){var t=new javascript.util.ArrayList;this.geomGraph.computeSplitEdges(t);var e=new jsts.geomgraph.PlanarGraph(new jsts.operation.overlay.OverlayNodeFactory);e.addEdges(t),this.setInteriorEdgesInResult(e),e.linkResultDirectedEdges();var o=this.buildEdgeRings(e.getEdgeEnds());return this.visitShellInteriors(this.geomGraph.getGeometry(),e),!this.hasUnvisitedShellEdge(o)},jsts.operation.valid.ConnectedInteriorTester.prototype.setInteriorEdgesInResult=function(t){for(var e,o=t.getEdgeEnds().iterator();o.hasNext();)e=o.next(),e.getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)==jsts.geom.Location.INTERIOR&&e.setInResult(!0)},jsts.operation.valid.ConnectedInteriorTester.prototype.buildEdgeRings=function(t){for(var e=new javascript.util.ArrayList,o=t.iterator();o.hasNext();){var n=o.next();if(n.isInResult()&&null==n.getEdgeRing()){var i=new jsts.operation.overlay.MaximalEdgeRing(n,this.geometryFactory);i.linkDirectedEdgesForMinimalEdgeRings();var r=i.buildMinimalRings(),s=0,a=r.length;for(s;s<a;s++)e.add(r[s])}}return e},jsts.operation.valid.ConnectedInteriorTester.prototype.visitShellInteriors=function(t,e){if(t instanceof jsts.geom.Polygon){var o=t;this.visitInteriorRing(o.getExteriorRing(),e)}if(t instanceof jsts.geom.MultiPolygon)for(var n=t,i=0;i<n.getNumGeometries();i++){var o=n.getGeometryN(i);this.visitInteriorRing(o.getExteriorRing(),e)}},jsts.operation.valid.ConnectedInteriorTester.prototype.visitInteriorRing=function(t,e){var o=t.getCoordinates(),n=o[0],i=jsts.operation.valid.ConnectedInteriorTester.findDifferentPoint(o,n),r=e.findEdgeInSameDirection(n,i),s=e.findEdgeEnd(r),a=null;s.getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)==jsts.geom.Location.INTERIOR?a=s:s.getSym().getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)==jsts.geom.Location.INTERIOR&&(a=s.getSym()),this.visitLinkedDirectedEdges(a)},jsts.operation.valid.ConnectedInteriorTester.prototype.visitLinkedDirectedEdges=function(t){var e=t,o=t;do{o.setVisited(!0),o=o.getNext()}while(o!=e)},jsts.operation.valid.ConnectedInteriorTester.prototype.hasUnvisitedShellEdge=function(t){for(var e=0;e<t.size();e++){var o=t.get(e);if(!o.isHole()){var n=o.getEdges(),i=n[0];if(i.getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)==jsts.geom.Location.INTERIOR)for(var r=0;r<n.length;r++)if(i=n[r],!i.isVisited())return disconnectedRingcoord=i.getCoordinate(),!0}}return!1},jsts.index.chain.MonotoneChainSelectAction=function(){this.tempEnv1=new jsts.geom.Envelope,this.selectedSegment=new jsts.geom.LineSegment},jsts.index.chain.MonotoneChainSelectAction.prototype.tempEnv1=null,jsts.index.chain.MonotoneChainSelectAction.prototype.selectedSegment=null,jsts.index.chain.MonotoneChainSelectAction.prototype.select=function(t,e){t.getLineSegment(e,this.selectedSegment),this.select2(this.selectedSegment)},jsts.index.chain.MonotoneChainSelectAction.prototype.select2=function(t){},jsts.algorithm.MCPointInRing=function(t){this.ring=t,this.tree=null,this.crossings=0,this.interval=new jsts.index.bintree.Interval,this.buildIndex()},jsts.algorithm.MCPointInRing.MCSelecter=function(t,e){this.parent=e,this.p=t},jsts.algorithm.MCPointInRing.MCSelecter.prototype=new jsts.index.chain.MonotoneChainSelectAction,jsts.algorithm.MCPointInRing.MCSelecter.prototype.constructor=jsts.algorithm.MCPointInRing.MCSelecter,jsts.algorithm.MCPointInRing.MCSelecter.prototype.select2=function(t){this.parent.testLineSegment.apply(this.parent,[this.p,t])},jsts.algorithm.MCPointInRing.prototype.buildIndex=function(){this.tree=new jsts.index.bintree.Bintree;for(var t=jsts.geom.CoordinateArrays.removeRepeatedPoints(this.ring.getCoordinates()),e=jsts.index.chain.MonotoneChainBuilder.getChains(t),o=0;o<e.length;o++){var n=e[o],i=n.getEnvelope();this.interval.min=i.getMinY(),this.interval.max=i.getMaxY(),this.tree.insert(this.interval,n)}},jsts.algorithm.MCPointInRing.prototype.isInside=function(t){this.crossings=0;var e=new jsts.geom.Envelope(-Number.MAX_VALUE,Number.MAX_VALUE,t.y,t.y);this.interval.min=t.y,this.interval.max=t.y;for(var o=this.tree.query(this.interval),n=new jsts.algorithm.MCPointInRing.MCSelecter(t,this),i=o.iterator();i.hasNext();){var r=i.next();this.testMonotoneChain(e,n,r)}return this.crossings%2==1},jsts.algorithm.MCPointInRing.prototype.testMonotoneChain=function(t,e,o){o.select(t,e)},jsts.algorithm.MCPointInRing.prototype.testLineSegment=function(t,e){var o,n,i,r,s,a;s=e.p0,a=e.p1,o=s.x-t.x,n=s.y-t.y,i=a.x-t.x,r=a.y-t.y,(n>0&&r<=0||r>0&&n<=0)&&0<jsts.algorithm.RobustDeterminant.signOfDet2x2(o,n,i,r)/(r-n)&&this.crossings++},jsts.operation.valid.TopologyValidationError=function(t,e){this.errorType=t,this.pt=null,null!=e&&(this.pt=e.clone())},jsts.operation.valid.TopologyValidationError.HOLE_OUTSIDE_SHELL=2,jsts.operation.valid.TopologyValidationError.NESTED_HOLES=3,jsts.operation.valid.TopologyValidationError.DISCONNECTED_INTERIOR=4,jsts.operation.valid.TopologyValidationError.SELF_INTERSECTION=5,jsts.operation.valid.TopologyValidationError.RING_SELF_INTERSECTION=6,jsts.operation.valid.TopologyValidationError.NESTED_SHELLS=7,jsts.operation.valid.TopologyValidationError.DUPLICATE_RINGS=8,jsts.operation.valid.TopologyValidationError.TOO_FEW_POINTS=9,jsts.operation.valid.TopologyValidationError.INVALID_COORDINATE=10,jsts.operation.valid.TopologyValidationError.RING_NOT_CLOSED=11,jsts.operation.valid.TopologyValidationError.prototype.errMsg=["Topology Validation Error","Repeated Point","Hole lies outside shell","Holes are nested","Interior is disconnected","Self-intersection","Ring Self-intersection","Nested shells","Duplicate Rings","Too few distinct points in geometry component","Invalid Coordinate","Ring is not closed"],jsts.operation.valid.TopologyValidationError.prototype.getCoordinate=function(){return this.pt},jsts.operation.valid.TopologyValidationError.prototype.getErrorType=function(){return this.errorType},jsts.operation.valid.TopologyValidationError.prototype.getMessage=function(){return this.errMsg[this.errorType]},jsts.operation.valid.TopologyValidationError.prototype.toString=function(){var t="";return null!=this.pt?(t=" at or near point "+this.pt,this.getMessage()+t):t},function(){var t=jsts.geom.Geometry,e=javascript.util.TreeSet,o=javascript.util.Arrays;jsts.geom.GeometryCollection=function(t,e){this.geometries=t||[],this.factory=e},jsts.geom.GeometryCollection.prototype=new t,jsts.geom.GeometryCollection.constructor=jsts.geom.GeometryCollection,jsts.geom.GeometryCollection.prototype.isEmpty=function(){for(var t=0,e=this.geometries.length;t<e;t++){if(!this.getGeometryN(t).isEmpty())return!1}return!0},jsts.geom.Geometry.prototype.getArea=function(){for(var t=0,e=0,o=this.geometries.length;e<o;e++)t+=this.getGeometryN(e).getArea();return t},jsts.geom.Geometry.prototype.getLength=function(){for(var t=0,e=0,o=this.geometries.length;e<o;e++)t+=this.getGeometryN(e).getLength();return t},jsts.geom.GeometryCollection.prototype.getCoordinate=function(){return this.isEmpty()?null:this.getGeometryN(0).getCoordinate()},jsts.geom.GeometryCollection.prototype.getCoordinates=function(){for(var t=[],e=-1,o=0,n=this.geometries.length;o<n;o++)for(var i=this.getGeometryN(o),r=i.getCoordinates(),s=0;s<r.length;s++)e++,t[e]=r[s];return t},jsts.geom.GeometryCollection.prototype.getNumGeometries=function(){return this.geometries.length},jsts.geom.GeometryCollection.prototype.getGeometryN=function(t){var e=this.geometries[t];return e instanceof jsts.geom.Coordinate&&(e=new jsts.geom.Point(e)),e},jsts.geom.GeometryCollection.prototype.equalsExact=function(t,e){if(!this.isEquivalentClass(t))return!1;if(this.geometries.length!==t.geometries.length)return!1;for(var o=0,n=this.geometries.length;o<n;o++){if(!this.getGeometryN(o).equalsExact(t.getGeometryN(o),e))return!1}return!0},jsts.geom.GeometryCollection.prototype.clone=function(){for(var t=[],e=0,o=this.geometries.length;e<o;e++)t.push(this.geometries[e].clone());return this.factory.createGeometryCollection(t)},jsts.geom.GeometryCollection.prototype.normalize=function(){for(var t=0,e=this.geometries.length;t<e;t++)this.getGeometryN(t).normalize();this.geometries.sort()},jsts.geom.GeometryCollection.prototype.compareToSameClass=function(t){var n=new e(o.asList(this.geometries)),i=new e(o.asList(t.geometries));return this.compare(n,i)},jsts.geom.GeometryCollection.prototype.apply=function(t){if(t instanceof jsts.geom.GeometryFilter||t instanceof jsts.geom.GeometryComponentFilter){t.filter(this);for(var e=0,o=this.geometries.length;e<o;e++)this.getGeometryN(e).apply(t)}else if(t instanceof jsts.geom.CoordinateFilter)for(var e=0,o=this.geometries.length;e<o;e++)this.getGeometryN(e).apply(t);else t instanceof jsts.geom.CoordinateSequenceFilter&&this.apply2.apply(this,arguments)},jsts.geom.GeometryCollection.prototype.apply2=function(t){if(0!=this.geometries.length){for(var e=0;e<this.geometries.length&&(this.geometries[e].apply(t),!t.isDone());e++);t.isGeometryChanged()}},jsts.geom.GeometryCollection.prototype.getDimension=function(){for(var t=jsts.geom.Dimension.FALSE,e=0,o=this.geometries.length;e<o;e++){var n=this.getGeometryN(e);t=Math.max(t,n.getDimension())}return t},jsts.geom.GeometryCollection.prototype.computeEnvelopeInternal=function(){for(var t=new jsts.geom.Envelope,e=0,o=this.geometries.length;e<o;e++){var n=this.getGeometryN(e);t.expandToInclude(n.getEnvelopeInternal())}return t},jsts.geom.GeometryCollection.prototype.CLASS_NAME="jsts.geom.GeometryCollection"}(),function(){jsts.geom.MultiPolygon=function(t,e){this.geometries=t||[],this.factory=e},jsts.geom.MultiPolygon.prototype=new jsts.geom.GeometryCollection,jsts.geom.MultiPolygon.constructor=jsts.geom.MultiPolygon,jsts.geom.MultiPolygon.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString(null);for(var t=[],e=0;e<this.geometries.length;e++)for(var o=this.geometries[e],n=o.getBoundary(),i=0;i<n.getNumGeometries();i++)t.push(n.getGeometryN(i));return this.getFactory().createMultiLineString(t)},jsts.geom.MultiPolygon.prototype.equalsExact=function(t,e){return!!this.isEquivalentClass(t)&&jsts.geom.GeometryCollection.prototype.equalsExact.call(this,t,e)},jsts.geom.MultiPolygon.prototype.CLASS_NAME="jsts.geom.MultiPolygon"}(),function(){var t=javascript.util.ArrayList,e=function(){};e.prototype.inputGeom=null,e.prototype.factory=null,e.prototype.pruneEmptyGeometry=!0,e.prototype.preserveGeometryCollectionType=!0,e.prototype.preserveCollections=!1,e.prototype.reserveType=!1,e.prototype.getInputGeometry=function(){return this.inputGeom},e.prototype.transform=function(t){if(this.inputGeom=t,this.factory=t.getFactory(),t instanceof jsts.geom.Point)return this.transformPoint(t,null);if(t instanceof jsts.geom.MultiPoint)return this.transformMultiPoint(t,null);if(t instanceof jsts.geom.LinearRing)return this.transformLinearRing(t,null);if(t instanceof jsts.geom.LineString)return this.transformLineString(t,null);if(t instanceof jsts.geom.MultiLineString)return this.transformMultiLineString(t,null);if(t instanceof jsts.geom.Polygon)return this.transformPolygon(t,null);if(t instanceof jsts.geom.MultiPolygon)return this.transformMultiPolygon(t,null);if(t instanceof jsts.geom.GeometryCollection)return this.transformGeometryCollection(t,null);throw new jsts.error.IllegalArgumentException("Unknown Geometry subtype: "+t.getClass().getName())},e.prototype.createCoordinateSequence=function(t){return this.factory.getCoordinateSequenceFactory().create(t)},e.prototype.copy=function(t){return t.clone()},e.prototype.transformCoordinates=function(t,e){return this.copy(t)},e.prototype.transformPoint=function(t,e){return this.factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},e.prototype.transformMultiPoint=function(e,o){for(var n=new t,i=0;i<e.getNumGeometries();i++){var r=this.transformPoint(e.getGeometryN(i),e);null!=r&&(r.isEmpty()||n.add(r))}return this.factory.buildGeometry(n)},e.prototype.transformLinearRing=function(t,e){var o=this.transformCoordinates(t.getCoordinateSequence(),t),n=o.length;return n>0&&n<4&&!this.preserveType?this.factory.createLineString(o):this.factory.createLinearRing(o)},e.prototype.transformLineString=function(t,e){return this.factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},e.prototype.transformMultiLineString=function(e,o){for(var n=new t,i=0;i<e.getNumGeometries();i++){var r=this.transformLineString(e.getGeometryN(i),e);null!=r&&(r.isEmpty()||n.add(r))}return this.factory.buildGeometry(n)},e.prototype.transformPolygon=function(e,o){var n=!0,i=this.transformLinearRing(e.getExteriorRing(),e);null!=i&&i instanceof jsts.geom.LinearRing&&!i.isEmpty()||(n=!1);for(var r=new t,s=0;s<e.getNumInteriorRing();s++){var a=this.transformLinearRing(e.getInteriorRingN(s),e);null==a||a.isEmpty()||(a instanceof jsts.geom.LinearRing||(n=!1),r.add(a))}if(n)return this.factory.createPolygon(i,r.toArray());var l=new t;return null!=i&&l.add(i),l.addAll(r),this.factory.buildGeometry(l)},e.prototype.transformMultiPolygon=function(e,o){for(var n=new t,i=0;i<e.getNumGeometries();i++){var r=this.transformPolygon(e.getGeometryN(i),e);null!=r&&(r.isEmpty()||n.add(r))}return this.factory.buildGeometry(n)},e.prototype.transformGeometryCollection=function(e,o){for(var n=new t,i=0;i<e.getNumGeometries();i++){var r=this.transform(e.getGeometryN(i));null!=r&&(this.pruneEmptyGeometry&&r.isEmpty()||n.add(r))}return this.preserveGeometryCollectionType?this.factory.createGeometryCollection(GeometryFactory.toGeometryArray(n)):this.factory.buildGeometry(n)},jsts.geom.util.GeometryTransformer=e}(),function(){var t=jsts.operation.overlay.snap.LineStringSnapper,e=jsts.geom.PrecisionModel,o=javascript.util.TreeSet,n=function(t,e,o){this.snapTolerance=t,this.snapPts=e,this.isSelfSnap=o||!1};n.prototype=new jsts.geom.util.GeometryTransformer,n.prototype.snapTolerance=null,n.prototype.snapPts=null,n.prototype.isSelfSnap=!1,n.prototype.transformCoordinates=function(t,e){var o=t;return this.snapLine(o,this.snapPts)},n.prototype.snapLine=function(e,o){var n=new t(e,this.snapTolerance);return n.setAllowSnappingToSourceVertices(this.isSelfSnap),n.snapTo(o)};var i=function(t){this.srcGeom=t};i.SNAP_PRECISION_FACTOR=1e-9,i.computeOverlaySnapTolerance=function(t){if(2===arguments.length)return i.computeOverlaySnapTolerance2.apply(this,arguments);var o=this.computeSizeBasedSnapTolerance(t),n=t.getPrecisionModel();if(n.getType()==e.FIXED){var r=1/n.getScale()*2/1.415;r>o&&(o=r)}return o},i.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*i.SNAP_PRECISION_FACTOR},i.computeOverlaySnapTolerance2=function(t,e){return Math.min(this.computeOverlaySnapTolerance(t),this.computeOverlaySnapTolerance(e))},i.snap=function(t,e,o){var n=[],r=new i(t);n[0]=r.snapTo(e,o);var s=new i(e);return n[1]=s.snapTo(n[0],o),n},i.snapToSelf=function(t,e,o){return new i(t).snapToSelf(e,o)},i.prototype.srcGeom=null,i.prototype.snapTo=function(t,e){var o=this.extractTargetCoordinates(t);return new n(e,o).transform(this.srcGeom)},i.prototype.snapToSelf=function(t,e){var o=this.extractTargetCoordinates(srcGeom),i=new n(t,o,!0),r=i.transform(srcGeom),s=r;return e&&s instanceof Polygonal&&(s=r.buffer(0)),s},i.prototype.extractTargetCoordinates=function(t){for(var e=new o,n=t.getCoordinates(),i=0;i<n.length;i++)e.add(n[i]);return e.toArray()},i.prototype.computeSnapTolerance=function(t){return this.computeMinimumSegmentLength(t)/10},i.prototype.computeMinimumSegmentLength=function(t){for(var e=Number.MAX_VALUE,o=0;o<t.length-1;o++){var n=t[o].distance(t[o+1]);n<e&&(e=n)}return e},jsts.operation.overlay.snap.GeometrySnapper=i}(),function(){var t=jsts.operation.overlay.OverlayOp,e=jsts.operation.overlay.snap.GeometrySnapper,o=function(t,e){this.geom=[],this.geom[0]=t,this.geom[1]=e,this.computeSnapTolerance()};o.overlayOp=function(t,e,n){return new o(t,e).getResultGeometry(n)},o.intersection=function(e,o){return this.overlayOp(e,o,t.INTERSECTION)},o.union=function(e,o){return this.overlayOp(e,o,t.UNION)},o.difference=function(e,o){return overlayOp(e,o,t.DIFFERENCE)},o.symDifference=function(e,o){return overlayOp(e,o,t.SYMDIFFERENCE)},o.prototype.geom=null,o.prototype.snapTolerance=null,o.prototype.computeSnapTolerance=function(){this.snapTolerance=e.computeOverlaySnapTolerance(this.geom[0],this.geom[1])},o.prototype.getResultGeometry=function(e){var o=this.snap(this.geom),n=t.overlayOp(o[0],o[1],e);return this.prepareResult(n)},o.prototype.selfSnap=function(t){return new e(t).snapTo(t,this.snapTolerance)},o.prototype.snap=function(t){var o=t;return e.snap(o[0],o[1],this.snapTolerance)},o.prototype.prepareResult=function(t){return t},o.prototype.cbr=null,o.prototype.removeCommonBits=function(t){this.cbr=new jsts.precision.CommonBitsRemover,this.cbr.add(this.geom[0]),this.cbr.add(this.geom[1]);var e=[];return e[0]=cbr.removeCommonBits(this.geom[0].clone()),e[1]=cbr.removeCommonBits(this.geom[1].clone()),e},jsts.operation.overlay.snap.SnapOverlayOp=o}(),jsts.noding.snapround.HotPixel=function(t,e,o){this.corner=[],this.originalPt=t,this.pt=t,this.scaleFactor=e,this.li=o,1!==this.scaleFactor&&(this.pt=new jsts.geom.Coordinate(this.scale(t.x),this.scale(t.y)),this.p0Scaled=new jsts.geom.Coordinate,this.p1Scaled=new jsts.geom.Coordinate),this.initCorners(this.pt)},jsts.noding.snapround.HotPixel.prototype.li=null,jsts.noding.snapround.HotPixel.prototype.pt=null,jsts.noding.snapround.HotPixel.prototype.originalPt=null,jsts.noding.snapround.HotPixel.prototype.ptScaled=null,jsts.noding.snapround.HotPixel.prototype.p0Scaled=null,jsts.noding.snapround.HotPixel.prototype.p1Scaled=null,jsts.noding.snapround.HotPixel.prototype.scaleFactor=void 0,jsts.noding.snapround.HotPixel.prototype.minx=void 0,jsts.noding.snapround.HotPixel.prototype.maxx=void 0,jsts.noding.snapround.HotPixel.prototype.miny=void 0,jsts.noding.snapround.HotPixel.prototype.maxy=void 0,jsts.noding.snapround.HotPixel.prototype.corner=null,jsts.noding.snapround.HotPixel.prototype.safeEnv=null,jsts.noding.snapround.HotPixel.prototype.getCoordinate=function(){return this.originalPt},jsts.noding.snapround.HotPixel.SAFE_ENV_EXPANSION_FACTOR=.75,jsts.noding.snapround.HotPixel.prototype.getSafeEnvelope=function(){if(null===this.safeEnv){var t=jsts.noding.snapround.HotPixel.SAFE_ENV_EXPANSION_FACTOR/this.scaleFactor;this.safeEnv=new jsts.geom.Envelope(this.originalPt.x-t,this.originalPt.x+t,this.originalPt.y-t,this.originalPt.y+t)}return this.safeEnv},jsts.noding.snapround.HotPixel.prototype.initCorners=function(t){this.minx=t.x-.5,this.maxx=t.x+.5,this.miny=t.y-.5,this.maxy=t.y+.5,this.corner[0]=new jsts.geom.Coordinate(this.maxx,this.maxy),this.corner[1]=new jsts.geom.Coordinate(this.minx,this.maxy),this.corner[2]=new jsts.geom.Coordinate(this.minx,this.miny),this.corner[3]=new jsts.geom.Coordinate(this.maxx,this.miny)},jsts.noding.snapround.HotPixel.prototype.scale=function(t){return Math.round(t*this.scaleFactor)},jsts.noding.snapround.HotPixel.prototype.intersects=function(t,e){return 1===this.scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this.p0Scaled),this.copyScaled(e,this.p1Scaled),this.intersectsScaled(this.p0Scaled,this.p1Scaled))},jsts.noding.snapround.HotPixel.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},jsts.noding.snapround.HotPixel.prototype.intersectsScaled=function(t,e){var o=Math.min(t.x,e.x),n=Math.max(t.x,e.x),i=Math.min(t.y,e.y),r=Math.max(t.y,e.y),s=this.maxx<o||this.minx>n||this.maxy<i||this.miny>r;if(s)return!1;var a=this.intersectsToleranceSquare(t,e);return jsts.util.Assert.isTrue(!(s&&a),"Found bad envelope test"),a},jsts.noding.snapround.HotPixel.prototype.intersectsToleranceSquare=function(t,e){var o=!1,n=!1;return this.li.computeIntersection(t,e,this.corner[0],this.corner[1]),!!this.li.isProper()||(this.li.computeIntersection(t,e,this.corner[1],this.corner[2]),!!this.li.isProper()||(this.li.hasIntersection()&&(o=!0),this.li.computeIntersection(t,e,this.corner[2],this.corner[3]),!!this.li.isProper()||(this.li.hasIntersection()&&(n=!0),this.li.computeIntersection(t,e,this.corner[3],this.corner[0]),!!this.li.isProper()||(!(!o||!n)||(!!t.equals(this.pt)||!!e.equals(this.pt))))))},jsts.noding.snapround.HotPixel.prototype.intersectsPixelClosure=function(t,e){return this.li.computeIntersection(t,e,this.corner[0],this.corner[1]),!!this.li.hasIntersection()||(this.li.computeIntersection(t,e,this.corner[1],this.corner[2]),!!this.li.hasIntersection()||(this.li.computeIntersection(t,e,this.corner[2],this.corner[3]),!!this.li.hasIntersection()||(this.li.computeIntersection(t,e,this.corner[3],this.corner[0]),!!this.li.hasIntersection())))},jsts.noding.snapround.HotPixel.prototype.addSnappedNode=function(t,e){var o=t.getCoordinate(e),n=t.getCoordinate(e+1);return!!this.intersects(o,n)&&(t.addIntersection(this.getCoordinate(),e),!0)},jsts.operation.buffer.BufferInputLineSimplifier=function(t){this.inputLine=t},jsts.operation.buffer.BufferInputLineSimplifier.simplify=function(t,e){return new jsts.operation.buffer.BufferInputLineSimplifier(t).simplify(e)},jsts.operation.buffer.BufferInputLineSimplifier.INIT=0,jsts.operation.buffer.BufferInputLineSimplifier.DELETE=1,jsts.operation.buffer.BufferInputLineSimplifier.KEEP=1,jsts.operation.buffer.BufferInputLineSimplifier.prototype.inputLine=null,jsts.operation.buffer.BufferInputLineSimplifier.prototype.distanceTol=null,jsts.operation.buffer.BufferInputLineSimplifier.prototype.isDeleted=null,jsts.operation.buffer.BufferInputLineSimplifier.prototype.angleOrientation=jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE,jsts.operation.buffer.BufferInputLineSimplifier.prototype.simplify=function(t){this.distanceTol=Math.abs(t),t<0&&(this.angleOrientation=jsts.algorithm.CGAlgorithms.CLOCKWISE),this.isDeleted=[],this.isDeleted.length=this.inputLine.length;var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()},jsts.operation.buffer.BufferInputLineSimplifier.prototype.deleteShallowConcavities=function(){for(var t=1,e=(this.inputLine.length,this.findNextNonDeletedIndex(t)),o=this.findNextNonDeletedIndex(e),n=!1;o<this.inputLine.length;){var i=!1;this.isDeletable(t,e,o,this.distanceTol)&&(this.isDeleted[e]=jsts.operation.buffer.BufferInputLineSimplifier.DELETE,i=!0,n=!0),t=i?o:e,e=this.findNextNonDeletedIndex(t),o=this.findNextNonDeletedIndex(e)}return n},jsts.operation.buffer.BufferInputLineSimplifier.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this.inputLine.length&&this.isDeleted[e]===jsts.operation.buffer.BufferInputLineSimplifier.DELETE;)e++;return e},jsts.operation.buffer.BufferInputLineSimplifier.prototype.collapseLine=function(){for(var t=[],e=0;e<this.inputLine.length;e++)this.isDeleted[e]!==jsts.operation.buffer.BufferInputLineSimplifier.DELETE&&t.push(this.inputLine[e]);return t},jsts.operation.buffer.BufferInputLineSimplifier.prototype.isDeletable=function(t,e,o,n){var i=this.inputLine[t],r=this.inputLine[e],s=this.inputLine[o];return!!this.isConcave(i,r,s)&&(!!this.isShallow(i,r,s,n)&&this.isShallowSampled(i,r,t,o,n))},jsts.operation.buffer.BufferInputLineSimplifier.prototype.isShallowConcavity=function(t,e,o,n){return jsts.algorithm.CGAlgorithms.computeOrientation(t,e,o)===this.angleOrientation&&jsts.algorithm.CGAlgorithms.distancePointLine(e,t,o)<n},jsts.operation.buffer.BufferInputLineSimplifier.NUM_PTS_TO_CHECK=10,jsts.operation.buffer.BufferInputLineSimplifier.prototype.isShallowSampled=function(t,e,o,n,i){var r=parseInt((n-o)/jsts.operation.buffer.BufferInputLineSimplifier.NUM_PTS_TO_CHECK);r<=0&&(r=1);for(var s=o;s<n;s+=r)if(!this.isShallow(t,e,this.inputLine[s],i))return!1;return!0},jsts.operation.buffer.BufferInputLineSimplifier.prototype.isShallow=function(t,e,o,n){return jsts.algorithm.CGAlgorithms.distancePointLine(e,t,o)<n},jsts.operation.buffer.BufferInputLineSimplifier.prototype.isConcave=function(t,e,o){return jsts.algorithm.CGAlgorithms.computeOrientation(t,e,o)===this.angleOrientation},jsts.geom.CoordinateList=function(t,e){javascript.util.ArrayList.apply(this,arguments),e=void 0===e||e,void 0!==t&&this.add(t,e)},jsts.geom.CoordinateList.prototype=new javascript.util.ArrayList,jsts.geom.CoordinateList.prototype.add=function(){return arguments.length>1?this.addCoordinates.apply(this,arguments):javascript.util.ArrayList.prototype.add.apply(this,arguments)},jsts.geom.CoordinateList.prototype.addCoordinates=function(t,e,o){if(t instanceof jsts.geom.Coordinate)return this.addCoordinate.apply(this,arguments);if("number"==typeof t)return this.insertCoordinate.apply(this,arguments);if(o=o||!0)for(var n=0;n<t.length;n++)this.addCoordinate(t[n],e);else for(var n=t.length-1;n>=0;n--)this.addCoordinate(t[n],e);return!0},jsts.geom.CoordinateList.prototype.addCoordinate=function(t,e){if(!e&&this.size()>=1){if(this.get(this.size()-1).equals2D(t))return}this.add(t)},jsts.geom.CoordinateList.prototype.insertCoordinate=function(t,e,o){if(!o){var n=t>0?t-1:-1;if(-1!==n&&this.get(n).equals2D(e))return;var i=t<this.size()-1?t+1:-1;if(-1!==i&&this.get(i).equals2D(e))return}this.array.splice(t,0,e)},jsts.geom.CoordinateList.prototype.closeRing=function(){this.size()>0&&this.addCoordinate(new jsts.geom.Coordinate(this.get(0)),!1)},jsts.geom.CoordinateList.prototype.toArray=function(){var t,e,o;for(t=0,e=this.size(),o=[],t;t<e;t++)o[t]=this.get(t);return o},jsts.geom.CoordinateList.prototype.toCoordinateArray=function(){return this.toArray()},jsts.operation.buffer.OffsetSegmentGenerator=function(t,e,o){this.seg0=new jsts.geom.LineSegment,this.seg1=new jsts.geom.LineSegment,this.offset0=new jsts.geom.LineSegment,this.offset1=new jsts.geom.LineSegment,this.precisionModel=t,this.bufParams=e,this.li=new jsts.algorithm.RobustLineIntersector,this.filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),this.bufParams.getQuadrantSegments()>=8&&this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_ROUND&&(this.closingSegLengthFactor=jsts.operation.buffer.OffsetSegmentGenerator.MAX_CLOSING_SEG_LEN_FACTOR),this.init(o)},jsts.operation.buffer.OffsetSegmentGenerator.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,jsts.operation.buffer.OffsetSegmentGenerator.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,jsts.operation.buffer.OffsetSegmentGenerator.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,jsts.operation.buffer.OffsetSegmentGenerator.MAX_CLOSING_SEG_LEN_FACTOR=80,jsts.operation.buffer.OffsetSegmentGenerator.prototype.maxCurveSegmentError=0,jsts.operation.buffer.OffsetSegmentGenerator.prototype.filletAngleQuantum=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.closingSegLengthFactor=1,jsts.operation.buffer.OffsetSegmentGenerator.prototype.segList=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.distance=0,jsts.operation.buffer.OffsetSegmentGenerator.prototype.precisionModel=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.bufParams=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.li=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.s0=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.s1=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.s2=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.seg0=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.seg1=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.offset0=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.offset1=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.side=0,jsts.operation.buffer.OffsetSegmentGenerator.prototype.hasNarrowConcaveAngle=!1,jsts.operation.buffer.OffsetSegmentGenerator.prototype.hasNarrowConcaveAngle=function(){return this.hasNarrowConcaveAngle},jsts.operation.buffer.OffsetSegmentGenerator.prototype.init=function(t){this.distance=t,this.maxCurveSegmentError=this.distance*(1-Math.cos(this.filletAngleQuantum/2)),this.segList=new jsts.operation.buffer.OffsetSegmentString,this.segList.setPrecisionModel(this.precisionModel),this.segList.setMinimumVertexDistance(this.distance*jsts.operation.buffer.OffsetSegmentGenerator.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},jsts.operation.buffer.OffsetSegmentGenerator.prototype.initSideSegments=function(t,e,o){this.s1=t,this.s2=e,this.side=o,this.seg1.setCoordinates(this.s1,this.s2),this.computeOffsetSegment(this.seg1,this.side,this.distance,this.offset1)},jsts.operation.buffer.OffsetSegmentGenerator.prototype.getCoordinates=function(){return this.segList.getCoordinates()},jsts.operation.buffer.OffsetSegmentGenerator.prototype.closeRing=function(){this.segList.closeRing()},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addSegments=function(t,e){this.segList.addPts(t,e)},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addFirstSegment=function(){this.segList.addPt(this.offset1.p0)},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addLastSegment=function(){this.segList.addPt(this.offset1.p1)},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addNextSegment=function(t,e){if(this.s0=this.s1,this.s1=this.s2,this.s2=t,this.seg0.setCoordinates(this.s0,this.s1),this.computeOffsetSegment(this.seg0,this.side,this.distance,this.offset0),this.seg1.setCoordinates(this.s1,this.s2),this.computeOffsetSegment(this.seg1,this.side,this.distance,this.offset1),!this.s1.equals(this.s2)){var o=jsts.algorithm.CGAlgorithms.computeOrientation(this.s0,this.s1,this.s2),n=o===jsts.algorithm.CGAlgorithms.CLOCKWISE&&this.side===jsts.geomgraph.Position.LEFT||o===jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE&&this.side===jsts.geomgraph.Position.RIGHT;0==o?this.addCollinear(e):n?this.addOutsideTurn(o,e):this.addInsideTurn(o,e)}},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addCollinear=function(t){this.li.computeIntersection(this.s0,this.s1,this.s1,this.s2),this.li.getIntersectionNum()>=2&&(this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_BEVEL||this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_MITRE?(t&&this.segList.addPt(this.offset0.p1),this.segList.addPt(this.offset1.p0)):this.addFillet(this.s1,this.offset0.p1,this.offset1.p0,jsts.algorithm.CGAlgorithms.CLOCKWISE,this.distance))},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addOutsideTurn=function(t,e){if(this.offset0.p1.distance(this.offset1.p0)<this.distance*jsts.operation.buffer.OffsetSegmentGenerator.OFFSET_SEGMENT_SEPARATION_FACTOR)return void this.segList.addPt(this.offset0.p1);this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_MITRE?this.addMitreJoin(this.s1,this.offset0,this.offset1,this.distance):this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_BEVEL?this.addBevelJoin(this.offset0,this.offset1):(e&&this.segList.addPt(this.offset0.p1),this.addFillet(this.s1,this.offset0.p1,this.offset1.p0,t,this.distance),this.segList.addPt(this.offset1.p0))},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addInsideTurn=function(t,e){if(this.li.computeIntersection(this.offset0.p0,this.offset0.p1,this.offset1.p0,this.offset1.p1),this.li.hasIntersection())this.segList.addPt(this.li.getIntersection(0));else if(this.hasNarrowConcaveAngle=!0,this.offset0.p1.distance(this.offset1.p0)<this.distance*jsts.operation.buffer.OffsetSegmentGenerator.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this.segList.addPt(this.offset0.p1);else{if(this.segList.addPt(this.offset0.p1),this.closingSegLengthFactor>0){var o=new jsts.geom.Coordinate((this.closingSegLengthFactor*this.offset0.p1.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset0.p1.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(o);var n=new jsts.geom.Coordinate((this.closingSegLengthFactor*this.offset1.p0.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset1.p0.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(n)}else this.segList.addPt(this.s1);this.segList.addPt(this.offset1.p0)}},jsts.operation.buffer.OffsetSegmentGenerator.prototype.computeOffsetSegment=function(t,e,o,n){var i=e===jsts.geomgraph.Position.LEFT?1:-1,r=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(r*r+s*s),l=i*o*r/a,c=i*o*s/a;n.p0.x=t.p0.x-c,n.p0.y=t.p0.y+l,n.p1.x=t.p1.x-c,n.p1.y=t.p1.y+l},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addLineEndCap=function(t,e){var o=new jsts.geom.LineSegment(t,e),n=new jsts.geom.LineSegment;this.computeOffsetSegment(o,jsts.geomgraph.Position.LEFT,this.distance,n);var i=new jsts.geom.LineSegment;this.computeOffsetSegment(o,jsts.geomgraph.Position.RIGHT,this.distance,i);var r=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,r);switch(this.bufParams.getEndCapStyle()){case jsts.operation.buffer.BufferParameters.CAP_ROUND:this.segList.addPt(n.p1),this.addFillet(e,a+Math.PI/2,a-Math.PI/2,jsts.algorithm.CGAlgorithms.CLOCKWISE,this.distance),this.segList.addPt(i.p1);break;case jsts.operation.buffer.BufferParameters.CAP_FLAT:this.segList.addPt(n.p1),this.segList.addPt(i.p1);break;case jsts.operation.buffer.BufferParameters.CAP_SQUARE:var l=new jsts.geom.Coordinate;l.x=Math.abs(this.distance)*Math.cos(a),l.y=Math.abs(this.distance)*Math.sin(a);var c=new jsts.geom.Coordinate(n.p1.x+l.x,n.p1.y+l.y),u=new jsts.geom.Coordinate(i.p1.x+l.x,i.p1.y+l.y);this.segList.addPt(c),this.segList.addPt(u)}},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addMitreJoin=function(t,e,o,n){var i=null;try{i=jsts.algorithm.HCoordinate.intersection(e.p0,e.p1,o.p0,o.p1);(n<=0?1:i.distance(t)/Math.abs(n))>this.bufParams.getMitreLimit()&&(this.isMitreWithinLimit=!1)}catch(t){t instanceof jsts.error.NotRepresentableError&&(i=new jsts.geom.Coordinate(0,0),this.isMitreWithinLimit=!1)}this.segList.addPt(i)},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addLimitedMitreJoin=function(t,e,o,n){var i=this.seg0.p1,r=jsts.algorithm.Angle.angle(i,this.seg0.p0),s=(jsts.algorithm.Angle.angle(i,this.seg1.p1),jsts.algorithm.Angle.angleBetweenOriented(this.seg0.p0,i,this.seg1.p1)),a=s/2,l=jsts.algorithm.Angle.normalize(r+a),c=jsts.algorithm.Angle.normalize(l+Math.PI),u=n*o,h=u*Math.abs(Math.sin(a)),g=o-h,p=i.x+u*Math.cos(c),d=i.y+u*Math.sin(c),f=new jsts.geom.Coordinate(p,d),m=new jsts.geom.LineSegment(i,f),y=m.pointAlongOffset(1,g),v=m.pointAlongOffset(1,-g);this.side==jsts.geomgraph.Position.LEFT?(this.segList.addPt(y),this.segList.addPt(v)):(this.segList.addPt(v),this.segList.addPt(y))},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addBevelJoin=function(t,e){this.segList.addPt(t.p1),this.segList.addPt(e.p0)},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addFillet=function(t,e,o,n,i){if(!(o instanceof jsts.geom.Coordinate))return void this.addFillet2.apply(this,arguments);var r=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,r),l=o.x-t.x,c=o.y-t.y,u=Math.atan2(c,l);n===jsts.algorithm.CGAlgorithms.CLOCKWISE?a<=u&&(a+=2*Math.PI):a>=u&&(a-=2*Math.PI),this.segList.addPt(e),this.addFillet(t,a,u,n,i),this.segList.addPt(o)},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addFillet2=function(t,e,o,n,i){var r=n===jsts.algorithm.CGAlgorithms.CLOCKWISE?-1:1,s=Math.abs(e-o),a=parseInt(s/this.filletAngleQuantum+.5);if(!(a<1)){var l,c;l=0,c=s/a;for(var u=l,h=new jsts.geom.Coordinate;u<s;){var g=e+r*u;h.x=t.x+i*Math.cos(g),h.y=t.y+i*Math.sin(g),this.segList.addPt(h),u+=c}}},jsts.operation.buffer.OffsetSegmentGenerator.prototype.createCircle=function(t){var e=new jsts.geom.Coordinate(t.x+this.distance,t.y);this.segList.addPt(e),this.addFillet(t,0,2*Math.PI,-1,this.distance),this.segList.closeRing()},jsts.operation.buffer.OffsetSegmentGenerator.prototype.createSquare=function(t){this.segList.addPt(new jsts.geom.Coordinate(t.x+distance,t.y+distance)),this.segList.addPt(new jsts.geom.Coordinate(t.x+distance,t.y-distance)),this.segList.addPt(new jsts.geom.Coordinate(t.x-distance,t.y-distance)),this.segList.addPt(new jsts.geom.Coordinate(t.x-distance,t.y+distance)),this.segList.closeRing()},jsts.operation.overlay.MaximalEdgeRing=function(t,e){jsts.geomgraph.EdgeRing.call(this,t,e)},jsts.operation.overlay.MaximalEdgeRing.prototype=new jsts.geomgraph.EdgeRing,jsts.operation.overlay.MaximalEdgeRing.constructor=jsts.operation.overlay.MaximalEdgeRing,jsts.operation.overlay.MaximalEdgeRing.prototype.getNext=function(t){return t.getNext()},jsts.operation.overlay.MaximalEdgeRing.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},jsts.operation.overlay.MaximalEdgeRing.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var t=this.startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!=this.startDe)},jsts.operation.overlay.MaximalEdgeRing.prototype.buildMinimalRings=function(){var t=[],e=this.startDe;do{if(null===e.getMinEdgeRing()){var o=new jsts.operation.overlay.MinimalEdgeRing(e,this.geometryFactory);t.push(o)}e=e.getNext()}while(e!=this.startDe);return t},jsts.algorithm.CentroidPoint=function(){this.centSum=new jsts.geom.Coordinate},jsts.algorithm.CentroidPoint.prototype.ptCount=0,jsts.algorithm.CentroidPoint.prototype.centSum=null,jsts.algorithm.CentroidPoint.prototype.add=function(t){if(t instanceof jsts.geom.Point)this.add2(t.getCoordinate());else if(t instanceof jsts.geom.GeometryCollection||t instanceof jsts.geom.MultiPoint||t instanceof jsts.geom.MultiLineString||t instanceof jsts.geom.MultiPolygon)for(var e=t,o=0;o<e.getNumGeometries();o++)this.add(e.getGeometryN(o))},jsts.algorithm.CentroidPoint.prototype.add2=function(t){this.ptCount+=1,this.centSum.x+=t.x,this.centSum.y+=t.y},jsts.algorithm.CentroidPoint.prototype.getCentroid=function(){var t=new jsts.geom.Coordinate;return t.x=this.centSum.x/this.ptCount,t.y=this.centSum.y/this.ptCount,t},jsts.operation.distance.ConnectedElementLocationFilter=function(t){this.locations=t},jsts.operation.distance.ConnectedElementLocationFilter.prototype=new jsts.geom.GeometryFilter,jsts.operation.distance.ConnectedElementLocationFilter.prototype.locations=null,jsts.operation.distance.ConnectedElementLocationFilter.getLocations=function(t){var e=[];return t.apply(new jsts.operation.distance.ConnectedElementLocationFilter(e)),e},jsts.operation.distance.ConnectedElementLocationFilter.prototype.filter=function(t){(t instanceof jsts.geom.Point||t instanceof jsts.geom.LineString||t instanceof jsts.geom.Polygon)&&this.locations.push(new jsts.operation.distance.GeometryLocation(t,0,t.getCoordinate()))},function(){var t=javascript.util.ArrayList;jsts.operation.relate.EdgeEndBuilder=function(){},jsts.operation.relate.EdgeEndBuilder.prototype.computeEdgeEnds=function(e){if(2==arguments.length)return void this.computeEdgeEnds2.apply(this,arguments);for(var o=new t,n=e;n.hasNext();){var i=n.next();this.computeEdgeEnds2(i,o)}return o},jsts.operation.relate.EdgeEndBuilder.prototype.computeEdgeEnds2=function(t,e){var o=t.getEdgeIntersectionList();o.addEndpoints();var n=o.iterator(),i=null,r=null;if(n.hasNext()){var s=n.next();do{i=r,r=s,s=null,n.hasNext()&&(s=n.next()),null!==r&&(this.createEdgeEndForPrev(t,e,r,i),this.createEdgeEndForNext(t,e,r,s))}while(null!==r)}},jsts.operation.relate.EdgeEndBuilder.prototype.createEdgeEndForPrev=function(t,e,o,n){var i=o.segmentIndex;if(0===o.dist){if(0===i)return;i--}var r=t.getCoordinate(i);null!==n&&n.segmentIndex>=i&&(r=n.coord);var s=new jsts.geomgraph.Label(t.getLabel());s.flip();var a=new jsts.geomgraph.EdgeEnd(t,o.coord,r,s);e.add(a)},jsts.operation.relate.EdgeEndBuilder.prototype.createEdgeEndForNext=function(t,e,o,n){var i=o.segmentIndex+1;if(!(i>=t.getNumPoints()&&null===n)){var r=t.getCoordinate(i);null!==n&&n.segmentIndex===o.segmentIndex&&(r=n.coord);var s=new jsts.geomgraph.EdgeEnd(t,o.coord,r,new jsts.geomgraph.Label(t.getLabel()));e.add(s)}}}(),jsts.geomgraph.Edge=function(t,e){this.pts=t,this.label=e,this.eiList=new jsts.geomgraph.EdgeIntersectionList(this),this.depth=new jsts.geomgraph.Depth},jsts.geomgraph.Edge.prototype=new jsts.geomgraph.GraphComponent,jsts.geomgraph.Edge.constructor=jsts.geomgraph.Edge,jsts.geomgraph.Edge.updateIM=function(t,e){e.setAtLeastIfValid(t.getLocation(0,jsts.geomgraph.Position.ON),t.getLocation(1,jsts.geomgraph.Position.ON),1),t.isArea()&&(e.setAtLeastIfValid(t.getLocation(0,jsts.geomgraph.Position.LEFT),t.getLocation(1,jsts.geomgraph.Position.LEFT),2),e.setAtLeastIfValid(t.getLocation(0,jsts.geomgraph.Position.RIGHT),t.getLocation(1,jsts.geomgraph.Position.RIGHT),2))},jsts.geomgraph.Edge.prototype.pts=null,jsts.geomgraph.Edge.prototype.env=null,jsts.geomgraph.Edge.prototype.name=null,jsts.geomgraph.Edge.prototype.mce=null,jsts.geomgraph.Edge.prototype._isIsolated=!0,jsts.geomgraph.Edge.prototype.depth=null,jsts.geomgraph.Edge.prototype.depthDelta=0,jsts.geomgraph.Edge.prototype.eiList=null,jsts.geomgraph.Edge.prototype.getNumPoints=function(){return this.pts.length},jsts.geomgraph.Edge.prototype.getEnvelope=function(){if(null===this.env){this.env=new jsts.geom.Envelope;for(var t=0;t<this.pts.length;t++)this.env.expandToInclude(pts[t])}return env};jsts.geomgraph.Edge.prototype.getDepth=function(){return this.depth},jsts.geomgraph.Edge.prototype.getDepthDelta=function(){return this.depthDelta},jsts.geomgraph.Edge.prototype.setDepthDelta=function(t){this.depthDelta=t},jsts.geomgraph.Edge.prototype.getCoordinates=function(){return this.pts},jsts.geomgraph.Edge.prototype.getCoordinate=function(t){return void 0===t?this.pts.length>0?this.pts[0]:null:this.pts[t]},jsts.geomgraph.Edge.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},jsts.geomgraph.Edge.prototype.setIsolated=function(t){this._isIsolated=t},jsts.geomgraph.Edge.prototype.isIsolated=function(){return this._isIsolated},jsts.geomgraph.Edge.prototype.addIntersections=function(t,e,o){for(var n=0;n<t.getIntersectionNum();n++)this.addIntersection(t,e,o,n)},jsts.geomgraph.Edge.prototype.addIntersection=function(t,e,o,n){var i=new jsts.geom.Coordinate(t.getIntersection(n)),r=e,s=t.getEdgeDistance(o,n),a=r+1;if(a<this.pts.length){var l=this.pts[a];i.equals2D(l)&&(r=a,s=0)}this.eiList.add(i,r,s)},jsts.geomgraph.Edge.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},jsts.geomgraph.Edge.prototype.getEdgeIntersectionList=function(){return this.eiList},jsts.geomgraph.Edge.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},jsts.geomgraph.Edge.prototype.isCollapsed=function(){return!!this.label.isArea()&&(3==this.pts.length&&!!this.pts[0].equals(this.pts[2]))},jsts.geomgraph.Edge.prototype.getCollapsedEdge=function(){var t=[];return t[0]=this.pts[0],t[1]=this.pts[1],new jsts.geomgraph.Edge(t,jsts.geomgraph.Label.toLineLabel(this.label))},jsts.geomgraph.Edge.prototype.computeIM=function(t){jsts.geomgraph.Edge.updateIM(this.label,t)},jsts.geomgraph.Edge.prototype.isPointwiseEqual=function(t){if(this.pts.length!=t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},jsts.operation.valid.IsValidOp=function(t){this.parentGeometry=t,this.isSelfTouchingRingFormingHoleValid=!1,this.validErr=null},jsts.operation.valid.IsValidOp.isValid=function(t){return arguments[0]instanceof jsts.geom.Coordinate?!isNaN(t.x)&&(!(!isFinite(t.x)&&!isNaN(t.x))&&(!isNaN(t.y)&&!(!isFinite(t.y)&&!isNaN(t.y)))):new jsts.operation.valid.IsValidOp(t).isValid()},jsts.operation.valid.IsValidOp.findPtNotNode=function(t,e,o){for(var n=o.findEdge(e),i=n.getEdgeIntersectionList(),r=0;r<t.length;r++){var s=t[r];if(!i.isIntersection(s))return s}return null},jsts.operation.valid.IsValidOp.prototype.setSelfTouchingRingFormingHoleValid=function(t){this.isSelfTouchingRingFormingHoleValid=t},jsts.operation.valid.IsValidOp.prototype.isValid=function(){return this.checkValid(this.parentGeometry),null==this.validErr},jsts.operation.valid.IsValidOp.prototype.getValidationError=function(){return this.checkValid(this.parentGeometry),this.validErr},jsts.operation.valid.IsValidOp.prototype.checkValid=function(t){if(this.validErr=null,!t.isEmpty())if(t instanceof jsts.geom.Point)this.checkValidPoint(t);else if(t instanceof jsts.geom.MultiPoint)this.checkValidMultiPoint(t);else if(t instanceof jsts.geom.LinearRing)this.checkValidLinearRing(t);else if(t instanceof jsts.geom.LineString)this.checkValidLineString(t);else if(t instanceof jsts.geom.Polygon)this.checkValidPolygon(t);else if(t instanceof jsts.geom.MultiPolygon)this.checkValidMultiPolygon(t);else{if(!(t instanceof jsts.geom.GeometryCollection))throw t.constructor;this.checkValidGeometryCollection(t)}},jsts.operation.valid.IsValidOp.prototype.checkValidPoint=function(t){this.checkInvalidCoordinates(t.getCoordinates())},jsts.operation.valid.IsValidOp.prototype.checkValidMultiPoint=function(t){this.checkInvalidCoordinates(t.getCoordinates())},jsts.operation.valid.IsValidOp.prototype.checkValidLineString=function(t){if(this.checkInvalidCoordinates(t.getCoordinates()),null==this.validErr){var e=new jsts.geomgraph.GeometryGraph(0,t);this.checkTooFewPoints(e)}},jsts.operation.valid.IsValidOp.prototype.checkValidLinearRing=function(t){if(this.checkInvalidCoordinates(t.getCoordinates()),null==this.validErr&&(this.checkClosedRing(t),null==this.validErr)){var e=new jsts.geomgraph.GeometryGraph(0,t);if(this.checkTooFewPoints(e),null==this.validErr){var o=new jsts.algorithm.RobustLineIntersector;e.computeSelfNodes(o,!0),this.checkNoSelfIntersectingRings(e)}}},jsts.operation.valid.IsValidOp.prototype.checkValidPolygon=function(t){if(this.checkInvalidCoordinates(t),null==this.validErr&&(this.checkClosedRings(t),null==this.validErr)){var e=new jsts.geomgraph.GeometryGraph(0,t);this.checkTooFewPoints(e),null==this.validErr&&(this.checkConsistentArea(e),null==this.validErr&&(this.isSelfTouchingRingFormingHoleValid||(this.checkNoSelfIntersectingRings(e),null==this.validErr))&&(this.checkHolesInShell(t,e),null==this.validErr&&(this.checkHolesNotNested(t,e),null==this.validErr&&this.checkConnectedInteriors(e))))}},jsts.operation.valid.IsValidOp.prototype.checkValidMultiPolygon=function(t){for(var e=t.getNumGeometries(),o=0;o<e;o++){var n=t.getGeometryN(o);if(this.checkInvalidCoordinates(n),null!=this.validErr)return;if(this.checkClosedRings(n),null!=this.validErr)return}var i=new jsts.geomgraph.GeometryGraph(0,t);if(this.checkTooFewPoints(i),null==this.validErr&&(this.checkConsistentArea(i),null==this.validErr&&(this.isSelfTouchingRingFormingHoleValid||(this.checkNoSelfIntersectingRings(i),null==this.validErr)))){for(var o=0;o<t.getNumGeometries();o++){var n=t.getGeometryN(o);if(this.checkHolesInShell(n,i),null!=this.validErr)return}for(var o=0;o<t.getNumGeometries();o++){var n=t.getGeometryN(o);if(this.checkHolesNotNested(n,i),null!=this.validErr)return}this.checkShellsNotNested(t,i),null==this.validErr&&this.checkConnectedInteriors(i)}},jsts.operation.valid.IsValidOp.prototype.checkValidGeometryCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var o=t.getGeometryN(e);if(this.checkValid(o),null!=this.validErr)return}},jsts.operation.valid.IsValidOp.prototype.checkInvalidCoordinates=function(t){if(t instanceof jsts.geom.Polygon){var e=t;if(this.checkInvalidCoordinates(e.getExteriorRing().getCoordinates()),null!=this.validErr)return;for(var o=0;o<e.getNumInteriorRing();o++)if(this.checkInvalidCoordinates(e.getInteriorRingN(o).getCoordinates()),null!=this.validErr)return}else for(var n=t,o=0;o<n.length;o++)if(!jsts.operation.valid.IsValidOp.isValid(n[o]))return void(this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.INVALID_COORDINATE,n[o]))},jsts.operation.valid.IsValidOp.prototype.checkClosedRings=function(t){if(this.checkClosedRing(t.getExteriorRing()),null==this.validErr)for(var e=0;e<t.getNumInteriorRing();e++)if(this.checkClosedRing(t.getInteriorRingN(e)),null!=this.validErr)return},jsts.operation.valid.IsValidOp.prototype.checkClosedRing=function(t){if(!t.isClosed()){var e=null;t.getNumPoints()>=1&&(e=t.getCoordinateN(0)),this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.RING_NOT_CLOSED,e)}},jsts.operation.valid.IsValidOp.prototype.checkTooFewPoints=function(t){if(t.hasTooFewPoints)return void(this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.TOO_FEW_POINTS,t.getInvalidPoint()))},jsts.operation.valid.IsValidOp.prototype.checkConsistentArea=function(t){var e=new jsts.operation.valid.ConsistentAreaTester(t);if(!e.isNodeConsistentArea())return void(this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.SELF_INTERSECTION,e.getInvalidPoint()));e.hasDuplicateRings()&&(this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.DUPLICATE_RINGS,e.getInvalidPoint()))},jsts.operation.valid.IsValidOp.prototype.checkNoSelfIntersectingRings=function(t){for(var e=t.getEdgeIterator();e.hasNext();){var o=e.next();if(this.checkNoSelfIntersectingRing(o.getEdgeIntersectionList()),null!=this.validErr)return}},jsts.operation.valid.IsValidOp.prototype.checkNoSelfIntersectingRing=function(t){for(var e=[],o=!0,n=t.iterator();n.hasNext();){var i=n.next();if(o)o=!1;else{if(e.indexOf(i.coord)>=0)return void(this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.RING_SELF_INTERSECTION,i.coord));e.push(i.coord)}}},jsts.operation.valid.IsValidOp.prototype.checkHolesInShell=function(t,e){for(var o=t.getExteriorRing(),n=new jsts.algorithm.MCPointInRing(o),i=0;i<t.getNumInteriorRing();i++){var r=t.getInteriorRingN(i),s=jsts.operation.valid.IsValidOp.findPtNotNode(r.getCoordinates(),o,e);if(null==s)return;if(!n.isInside(s))return void(this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.HOLE_OUTSIDE_SHELL,s))}},jsts.operation.valid.IsValidOp.prototype.checkHolesNotNested=function(t,e){for(var o=new jsts.operation.valid.IndexedNestedRingTester(e),n=0;n<t.getNumInteriorRing();n++){var i=t.getInteriorRingN(n);o.add(i)}o.isNonNested()||(this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.NESTED_HOLES,o.getNestedPoint()))},jsts.operation.valid.IsValidOp.prototype.checkShellsNotNested=function(t,e){for(var o=0;o<t.getNumGeometries();o++)for(var n=t.getGeometryN(o),i=n.getExteriorRing(),r=0;r<t.getNumGeometries();r++)if(o!=r){var s=t.getGeometryN(r);if(this.checkShellNotNested(i,s,e),null!=this.validErr)return}},jsts.operation.valid.IsValidOp.prototype.checkShellNotNested=function(t,e,o){var n=t.getCoordinates(),i=e.getExteriorRing(),r=i.getCoordinates(),s=jsts.operation.valid.IsValidOp.findPtNotNode(n,i,o);if(null!=s){if(jsts.algorithm.CGAlgorithms.isPointInRing(s,r)){if(e.getNumInteriorRing()<=0)return void(this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.NESTED_SHELLS,s));for(var a=null,l=0;l<e.getNumInteriorRing();l++){var c=e.getInteriorRingN(l);if(null==(a=this.checkShellInsideHole(t,c,o)))return}this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.NESTED_SHELLS,a)}}},jsts.operation.valid.IsValidOp.prototype.checkShellInsideHole=function(t,e,o){var n=t.getCoordinates(),i=e.getCoordinates(),r=jsts.operation.valid.IsValidOp.findPtNotNode(n,e,o);if(null!=r){if(!jsts.algorithm.CGAlgorithms.isPointInRing(r,i))return r}var s=jsts.operation.valid.IsValidOp.findPtNotNode(i,t,o);if(null!=s){return jsts.algorithm.CGAlgorithms.isPointInRing(s,n)?s:null}return jsts.util.Assert.shouldNeverReachHere("points in shell and hole appear to be equal"),null},jsts.operation.valid.IsValidOp.prototype.checkConnectedInteriors=function(t){var e=new jsts.operation.valid.ConnectedInteriorTester(t);e.isInteriorsConnected()||(this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.DISCONNECTED_INTERIOR,e.getCoordinate()))},jsts.algorithm.RobustDeterminant=function(){},jsts.algorithm.RobustDeterminant.signOfDet2x2=function(t,e,o,n){var i,r,s,a;if(a=0,i=1,0===t||0===n)return 0===e||0===o?0:e>0?o>0?-i:i:o>0?i:-i;if(0===e||0===o)return n>0?t>0?i:-i:t>0?-i:i;if(0<e?0<n?e>n&&(i=-i,r=t,t=o,o=r,r=e,e=n,n=r):e<=-n?(i=-i,o=-o,n=-n):(r=t,t=-o,o=r,r=e,e=-n,n=r):0<n?-e<=n?(i=-i,t=-t,e=-e):(r=-t,t=o,o=r,r=-e,e=n,n=r):e>=n?(t=-t,e=-e,o=-o,n=-n):(i=-i,r=-t,t=-o,o=r,r=-e,e=-n,n=r),0<t){if(!(0<o))return i;if(t>o)return i}else{if(0<o)return-i;if(!(t>=o))return-i;i=-i,t=-t,o=-o}for(;;){if(a+=1,s=Math.floor(o/t),o-=s*t,(n-=s*e)<0)return-i;if(n>e)return i;if(t>o+o){if(e<n+n)return i}else{if(e>n+n)return-i;o=t-o,n=e-n,i=-i}if(0===n)return 0===o?0:-i;if(0===o)return i;if(s=Math.floor(t/o),t-=s*o,(e-=s*n)<0)return i;if(e>n)return-i;if(o>t+t){if(n<e+e)return-i}else{if(n>e+e)return i;t=o-t,e=n-e,i=-i}if(0===e)return 0===t?0:i;if(0===t)return-i}},jsts.algorithm.RobustDeterminant.orientationIndex=function(t,e,o){var n=e.x-t.x,i=e.y-t.y,r=o.x-e.x,s=o.y-e.y;return jsts.algorithm.RobustDeterminant.signOfDet2x2(n,i,r,s)},jsts.index.quadtree.NodeBase=function(){this.subnode=new Array(4),this.subnode[0]=null,this.subnode[1]=null,this.subnode[2]=null,this.subnode[3]=null,this.items=[]},jsts.index.quadtree.NodeBase.prototype.getSubnodeIndex=function(t,e){var o=-1;return t.getMinX()>=e.x&&(t.getMinY()>=e.y&&(o=3),t.getMaxY()<=e.y&&(o=1)),t.getMaxX()<=e.x&&(t.getMinY()>=e.y&&(o=2),t.getMaxY()<=e.y&&(o=0)),o},jsts.index.quadtree.NodeBase.prototype.getItems=function(){return this.items},jsts.index.quadtree.NodeBase.prototype.hasItems=function(){return this.items.length>0},jsts.index.quadtree.NodeBase.prototype.add=function(t){this.items.push(t)},jsts.index.quadtree.NodeBase.prototype.remove=function(t,e){if(!this.isSearchMatch(t))return!1;var o=!1,n=0;for(n;n<4;n++)if(null!==this.subnode[n]&&(o=this.subnode[n].remove(t,e))){this.subnode[n].isPrunable()&&(this.subnode[n]=null);break}if(o)return o;if(-1!==this.items.indexOf(e)){for(var n=this.items.length-1;n>=0;n--)this.items[n]===e&&this.items.splice(n,1);o=!0}return o},jsts.index.quadtree.NodeBase.prototype.isPrunable=function(){return!(this.hasChildren()||this.hasItems())},jsts.index.quadtree.NodeBase.prototype.hasChildren=function(){var t=0;for(t;t<4;t++)if(null!==this.subnode[t])return!0;return!1},jsts.index.quadtree.NodeBase.prototype.isEmpty=function(){var t=!0;this.items.length>0&&(t=!1);var e=0;for(e;e<4;e++)null!==this.subnode[e]&&(this.subnode[e].isEmpty()||(t=!1));return t},jsts.index.quadtree.NodeBase.prototype.addAllItems=function(t){t=t.concat(this.items);var e=0;for(e;e<4;e++)null!==this.subnode[e]&&(t=this.subnode[e].addAllItems(t));return t},jsts.index.quadtree.NodeBase.prototype.addAllItemsFromOverlapping=function(t,e){if(this.isSearchMatch(t)){e=e.concat(this.items);var o=0;for(o;o<4;o++)null!==this.subnode[o]&&(e=this.subnode[o].addAllItemsFromOverlapping(t,e))}},jsts.index.quadtree.NodeBase.prototype.visit=function(t,e){if(this.isSearchMatch(t)){this.visitItems(t,e);var o=0;for(o;o<4;o++)null!==this.subnode[o]&&this.subnode[o].visit(t,e)}},jsts.index.quadtree.NodeBase.prototype.visitItems=function(t,e){var o=0,n=this.items.length;for(o;o<n;o++)e.visitItem(this.items[o])},jsts.index.quadtree.NodeBase.prototype.depth=function(){var t,e=0,o=0;for(o;o<4;o++)null!==this.subnode[o]&&(t=this.subnode[o].depth())>e&&(e=t);return e+1},jsts.index.quadtree.NodeBase.prototype.size=function(){var t=0,e=0;for(e;e<4;e++)null!==this.subnode[e]&&(t+=this.subnode[e].size());return t+this.items.length},jsts.index.quadtree.NodeBase.prototype.getNodeCount=function(){var t=0,e=0;for(e;e<4;e++)null!==this.subnode[e]&&(t+=this.subnode[e].size());return t+1},jsts.index.quadtree.Node=function(t,e){jsts.index.quadtree.NodeBase.prototype.constructor.apply(this,arguments),this.env=t,this.level=e,this.centre=new jsts.geom.Coordinate,this.centre.x=(t.getMinX()+t.getMaxX())/2,this.centre.y=(t.getMinY()+t.getMaxY())/2},jsts.index.quadtree.Node.prototype=new jsts.index.quadtree.NodeBase,jsts.index.quadtree.Node.createNode=function(t){var e;return e=new jsts.index.quadtree.Key(t),new jsts.index.quadtree.Node(e.getEnvelope(),e.getLevel())},jsts.index.quadtree.Node.createExpanded=function(t,e){var o,n=new jsts.geom.Envelope(e);return null!==t&&n.expandToInclude(t.env),o=jsts.index.quadtree.Node.createNode(n),null!==t&&o.insertNode(t),o},jsts.index.quadtree.Node.prototype.getEnvelope=function(){return this.env},jsts.index.quadtree.Node.prototype.isSearchMatch=function(t){return this.env.intersects(t)},jsts.index.quadtree.Node.prototype.getNode=function(t){var e,o=this.getSubnodeIndex(t,this.centre);return-1!==o?(e=this.getSubnode(o),e.getNode(t)):this},jsts.index.quadtree.Node.prototype.find=function(t){var e,o=this.getSubnodeIndex(t,this.centre);return-1===o?this:null!==this.subnode[o]?(e=this.subnode[o],e.find(t)):this},jsts.index.quadtree.Node.prototype.insertNode=function(t){var e,o=this.getSubnodeIndex(t.env,this.centre);t.level===this.level-1?this.subnode[o]=t:(e=this.createSubnode(o),e.insertNode(t),this.subnode[o]=e)},jsts.index.quadtree.Node.prototype.getSubnode=function(t){return null===this.subnode[t]&&(this.subnode[t]=this.createSubnode(t)),this.subnode[t]},jsts.index.quadtree.Node.prototype.createSubnode=function(t){var e,o=0,n=0,i=0,r=0;switch(t){case 0:o=this.env.getMinX(),n=this.centre.x,i=this.env.getMinY(),r=this.centre.y;break;case 1:o=this.centre.x,n=this.env.getMaxX(),i=this.env.getMinY(),r=this.centre.y;break;case 2:o=this.env.getMinX(),n=this.centre.x,i=this.centre.y,r=this.env.getMaxY();break;case 3:o=this.centre.x,n=this.env.getMaxX(),i=this.centre.y,r=this.env.getMaxY()}return e=new jsts.geom.Envelope(o,n,i,r),new jsts.index.quadtree.Node(e,this.level-1)},function(){jsts.triangulate.quadedge.QuadEdge=function(){this.rot=null,this.vertex=null,this.next=null,this.data=null};var t=jsts.triangulate.quadedge.QuadEdge;jsts.triangulate.quadedge.QuadEdge.makeEdge=function(e,o){var n,i,r,s,a;return n=new t,i=new t,r=new t,s=new t,n.rot=i,i.rot=r,r.rot=s,s.rot=n,n.setNext(n),i.setNext(s),r.setNext(r),s.setNext(i),a=n,a.setOrig(e),a.setDest(o),a},jsts.triangulate.quadedge.QuadEdge.connect=function(e,o){var n=t.makeEdge(e.dest(),o.orig());return t.splice(n,e.lNext()),t.splice(n.sym(),o),n},jsts.triangulate.quadedge.QuadEdge.splice=function(t,e){var o,n,i,r,s,a;o=t.oNext().rot,n=e.oNext().rot,i=e.oNext(),r=t.oNext(),s=n.oNext(),a=o.oNext(),t.setNext(i),e.setNext(r),o.setNext(s),n.setNext(a)},jsts.triangulate.quadedge.QuadEdge.swap=function(e){var o,n;o=e.oPrev(),n=e.sym().oPrev(),t.splice(e,o),t.splice(e.sym(),n),t.splice(e,o.lNext()),t.splice(e.sym(),n.lNext()),e.setOrig(o.dest()),e.setDest(n.dest())},jsts.triangulate.quadedge.QuadEdge.prototype.getPrimary=function(){return this.orig().getCoordinate().compareTo(this.dest().getCoordinate())<=0?this:this.sym()},jsts.triangulate.quadedge.QuadEdge.prototype.setData=function(t){this.data=t},jsts.triangulate.quadedge.QuadEdge.prototype.getData=function(){return this.data},jsts.triangulate.quadedge.QuadEdge.prototype.delete_jsts=function(){this.rot=null},jsts.triangulate.quadedge.QuadEdge.prototype.isLive=function(){return null!==this.rot},jsts.triangulate.quadedge.QuadEdge.prototype.setNext=function(t){this.next=t},jsts.triangulate.quadedge.QuadEdge.prototype.invRot=function(){return this.rot.sym()},jsts.triangulate.quadedge.QuadEdge.prototype.sym=function(){return this.rot.rot},jsts.triangulate.quadedge.QuadEdge.prototype.oNext=function(){return this.next},jsts.triangulate.quadedge.QuadEdge.prototype.oPrev=function(){return this.rot.next.rot},jsts.triangulate.quadedge.QuadEdge.prototype.dNext=function(){return this.sym().oNext().sym()},jsts.triangulate.quadedge.QuadEdge.prototype.dPrev=function(){return this.invRot().oNext().invRot()},jsts.triangulate.quadedge.QuadEdge.prototype.lNext=function(){return this.invRot().oNext().rot},jsts.triangulate.quadedge.QuadEdge.prototype.lPrev=function(){return this.next.sym()},jsts.triangulate.quadedge.QuadEdge.prototype.rNext=function(){return this.rot.next.invRot()},jsts.triangulate.quadedge.QuadEdge.prototype.rPrev=function(){return this.sym().oNext()},jsts.triangulate.quadedge.QuadEdge.prototype.setOrig=function(t){this.vertex=t},jsts.triangulate.quadedge.QuadEdge.prototype.setDest=function(t){this.sym().setOrig(t)},jsts.triangulate.quadedge.QuadEdge.prototype.orig=function(){return this.vertex},jsts.triangulate.quadedge.QuadEdge.prototype.dest=function(){return this.sym().orig()},jsts.triangulate.quadedge.QuadEdge.prototype.getLength=function(){return this.orig().getCoordinate().distance(dest().getCoordinate())},jsts.triangulate.quadedge.QuadEdge.prototype.equalsNonOriented=function(t){return!!this.equalsOriented(t)||!!this.equalsOriented(t.sym())},jsts.triangulate.quadedge.QuadEdge.prototype.equalsOriented=function(t){return!(!this.orig().getCoordinate().equals2D(t.orig().getCoordinate())||!this.dest().getCoordinate().equals2D(t.dest().getCoordinate()))},jsts.triangulate.quadedge.QuadEdge.prototype.toLineSegment=function(){return new jsts.geom.LineSegment(this.vertex.getCoordinate(),this.dest().getCoordinate())},jsts.triangulate.quadedge.QuadEdge.prototype.toString=function(){var t,e;return t=this.vertex.getCoordinate(),e=this.dest().getCoordinate(),jsts.io.WKTWriter.toLineString(t,e)}}(),function(){var t=jsts.util.Assert;jsts.geomgraph.EdgeEnd=function(t,e,o,n){this.edge=t,e&&o&&this.init(e,o),n&&(this.label=n||null)},jsts.geomgraph.EdgeEnd.prototype.edge=null,jsts.geomgraph.EdgeEnd.prototype.label=null,jsts.geomgraph.EdgeEnd.prototype.node=null,jsts.geomgraph.EdgeEnd.prototype.p0=null,jsts.geomgraph.EdgeEnd.prototype.p1=null,jsts.geomgraph.EdgeEnd.prototype.dx=null,jsts.geomgraph.EdgeEnd.prototype.dy=null,jsts.geomgraph.EdgeEnd.prototype.quadrant=null,jsts.geomgraph.EdgeEnd.prototype.init=function(e,o){this.p0=e,this.p1=o,this.dx=o.x-e.x,this.dy=o.y-e.y,this.quadrant=jsts.geomgraph.Quadrant.quadrant(this.dx,this.dy),t.isTrue(!(0===this.dx&&0===this.dy),"EdgeEnd with identical endpoints found")},jsts.geomgraph.EdgeEnd.prototype.getEdge=function(){return this.edge},jsts.geomgraph.EdgeEnd.prototype.getLabel=function(){return this.label},jsts.geomgraph.EdgeEnd.prototype.getCoordinate=function(){return this.p0},jsts.geomgraph.EdgeEnd.prototype.getDirectedCoordinate=function(){return this.p1},jsts.geomgraph.EdgeEnd.prototype.getQuadrant=function(){return this.quadrant},jsts.geomgraph.EdgeEnd.prototype.getDx=function(){return this.dx},jsts.geomgraph.EdgeEnd.prototype.getDy=function(){return this.dy},jsts.geomgraph.EdgeEnd.prototype.setNode=function(t){this.node=t},jsts.geomgraph.EdgeEnd.prototype.getNode=function(){return this.node},jsts.geomgraph.EdgeEnd.prototype.compareTo=function(t){return this.compareDirection(t)},jsts.geomgraph.EdgeEnd.prototype.compareDirection=function(t){return this.dx===t.dx&&this.dy===t.dy?0:this.quadrant>t.quadrant?1:this.quadrant<t.quadrant?-1:jsts.algorithm.CGAlgorithms.computeOrientation(t.p0,t.p1,this.p1)},jsts.geomgraph.EdgeEnd.prototype.computeLabel=function(t){}}(),jsts.triangulate.quadedge.TrianglePredicate=function(){},jsts.triangulate.quadedge.TrianglePredicate.isInCircleNonRobust=function(t,e,o,n){return(t.x*t.x+t.y*t.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(e,o,n)-(e.x*e.x+e.y*e.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(t,o,n)+(o.x*o.x+o.y*o.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(t,e,n)-(n.x*n.x+n.y*n.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(t,e,o)>0},jsts.triangulate.quadedge.TrianglePredicate.isInCircleNormalized=function(t,e,o,n){var i,r,s,a,l,c,u,h,g,p,d,f;return i=t.x-n.x,r=t.y-n.y,s=e.x-n.x,a=e.y-n.y,l=o.x-n.x,c=o.y-n.y,u=i*a-s*r,h=s*c-l*a,g=l*r-i*c,p=i*i+r*r,d=s*s+a*a,f=l*l+c*c,p*h+d*g+f*u>0},jsts.triangulate.quadedge.TrianglePredicate.triArea=function(t,e,o){return(e.x-t.x)*(o.y-t.y)-(e.y-t.y)*(o.x-t.x)},jsts.triangulate.quadedge.TrianglePredicate.isInCircleRobust=function(t,e,o,n){return jsts.triangulate.quadedge.TrianglePredicate.isInCircleNormalized(t,e,o,n)},jsts.triangulate.quadedge.TrianglePredicate.isInCircleDDSlow=function(t,e,o,n){var i,r,s,a,l,c,u,h,g,p,d,f,m;return i=jsts.math.DD.valueOf(n.x),r=jsts.math.DD.valueOf(n.y),s=jsts.math.DD.valueOf(t.x),a=jsts.math.DD.valueOf(t.y),l=jsts.math.DD.valueOf(e.x),c=jsts.math.DD.valueOf(e.y),u=jsts.math.DD.valueOf(o.x),h=jsts.math.DD.valueOf(o.y),g=s.multiply(s).add(a.multiply(a)).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(l,c,u,h,i,r)),p=l.multiply(l).add(c.multiply(c)).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(s,a,u,h,i,r)),d=u.multiply(u).add(h.multiply(h)).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(s,a,l,c,i,r)),f=i.multiply(i).add(r.multiply(r)).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(s,a,l,c,u,h)),m=g.subtract(p).add(d).subtract(f),m.doubleValue()>0},jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow=function(t,e,o,n,i,r){return o.subtract(t).multiply(r.subtract(e)).subtract(n.subtract(e).multiply(i.subtract(t)))},jsts.triangulate.quadedge.TrianglePredicate.isInCircleDDFast=function(t,e,o,n){var i,r,s,a,l;return i=jsts.math.DD.sqr(t.x).selfAdd(jsts.math.DD.sqr(t.y)).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(e,o,n)),r=jsts.math.DD.sqr(e.x).selfAdd(jsts.math.DD.sqr(e.y)).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(t,o,n)),s=jsts.math.DD.sqr(o.x).selfAdd(jsts.math.DD.sqr(o.y)).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(t,e,n)),a=jsts.math.DD.sqr(n.x).selfAdd(jsts.math.DD.sqr(n.y)).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(t,e,o)),l=i.selfSubtract(r).selfAdd(s).selfSubtract(a),l.doubleValue()>0},jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast=function(t,e,o){var n,i;return n=jsts.math.DD.valueOf(e.x).selfSubtract(t.x).selfMultiply(jsts.math.DD.valueOf(o.y).selfSubtract(t.y)),i=jsts.math.DD.valueOf(e.y).selSubtract(t.y).selfMultiply(jsts.math.DD.valueOf(o.x).selfSubtract(t.x)),n.selfSubtract(i)},jsts.triangulate.quadedge.TrianglePredicate.isInCircleDDNormalized=function(t,e,o,n){var i,r,s,a,l,c,u,h,g,p,d,f,m;return i=jsts.math.DD.valueOf(t.x).selfSubtract(n.x),r=jsts.math.DD.valueOf(t.y).selfSubtract(n.y),s=jsts.math.DD.valueOf(e.x).selfSubtract(n.x),s=jsts.math.DD.valueOf(e.y).selfSubtract(n.y),l=jsts.math.DD.valueOf(o.x).selfSubtract(n.x),l=jsts.math.DD.valueOf(o.y).selfSubtract(n.y),u=i.multiply(a).selfSubtract(s.multiply(r)),h=s.multiply(c).selfSubtract(l.multiply(a)),g=l.multiply(r).selfSubtract(i.multiply(c)),p=i.multiply(i).selfAdd(r.multiply(r)),d=s.multiply(s).selfAdd(a.multiply(a)),f=l.multiply(l).selfAdd(c.multiply(c)),m=p.selfMultiply(h).selfAdd(d.selfMultiply(g)).selfAdd(f.selfMultiply(u)),m.doubleValue()>0},jsts.triangulate.quadedge.TrianglePredicate.isInCircleCC=function(t,e,o,n){var i,r;return i=jsts.geom.Triangle.circumcentre(t,e,o),r=t.distance(i),n.distance(i)-r<=0},jsts.operation.buffer.RightmostEdgeFinder=function(){},jsts.operation.buffer.RightmostEdgeFinder.prototype.minIndex=-1,jsts.operation.buffer.RightmostEdgeFinder.prototype.minCoord=null,jsts.operation.buffer.RightmostEdgeFinder.prototype.minDe=null,jsts.operation.buffer.RightmostEdgeFinder.prototype.orientedDe=null,jsts.operation.buffer.RightmostEdgeFinder.prototype.getEdge=function(){return this.orientedDe},jsts.operation.buffer.RightmostEdgeFinder.prototype.getCoordinate=function(){return this.minCoord},jsts.operation.buffer.RightmostEdgeFinder.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var o=e.next();o.isForward()&&this.checkForRightmostCoordinate(o)}jsts.util.Assert.isTrue(0!==this.minIndex||this.minCoord.equals(this.minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this.minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this.orientedDe=this.minDe,this.getRightmostSide(this.minDe,this.minIndex)==jsts.geomgraph.Position.LEFT&&(this.orientedDe=this.minDe.getSym())},jsts.operation.buffer.RightmostEdgeFinder.prototype.findRightmostEdgeAtNode=function(){var t=this.minDe.getNode(),e=t.getEdges();this.minDe=e.getRightmostEdge(),this.minDe.isForward()||(this.minDe=this.minDe.getSym(),this.minIndex=this.minDe.getEdge().getCoordinates().length-1)},jsts.operation.buffer.RightmostEdgeFinder.prototype.findRightmostEdgeAtVertex=function(){var t=this.minDe.getEdge().getCoordinates();jsts.util.Assert.isTrue(this.minIndex>0&&this.minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this.minIndex-1],o=t[this.minIndex+1],n=jsts.algorithm.CGAlgorithms.computeOrientation(this.minCoord,o,e),i=!1;e.y<this.minCoord.y&&o.y<this.minCoord.y&&n===jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE?i=!0:e.y>this.minCoord.y&&o.y>this.minCoord.y&&n===jsts.algorithm.CGAlgorithms.CLOCKWISE&&(i=!0),i&&(this.minIndex=this.minIndex-1)},jsts.operation.buffer.RightmostEdgeFinder.prototype.checkForRightmostCoordinate=function(t){for(var e=t.getEdge().getCoordinates(),o=0;o<e.length-1;o++)(null===this.minCoord||e[o].x>this.minCoord.x)&&(this.minDe=t,this.minIndex=o,this.minCoord=e[o])},jsts.operation.buffer.RightmostEdgeFinder.prototype.getRightmostSide=function(t,e){var o=this.getRightmostSideOfSegment(t,e);return o<0&&(o=this.getRightmostSideOfSegment(t,e-1)),o<0&&(this.minCoord=null,this.checkForRightmostCoordinate(t)),o},jsts.operation.buffer.RightmostEdgeFinder.prototype.getRightmostSideOfSegment=function(t,e){var o=t.getEdge(),n=o.getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y==n[e+1].y)return-1;var i=jsts.geomgraph.Position.LEFT;return n[e].y<n[e+1].y&&(i=jsts.geomgraph.Position.RIGHT),i},function(){jsts.triangulate.IncrementalDelaunayTriangulator=function(t){this.subdiv=t,this.isUsingTolerance=t.getTolerance()>0},jsts.triangulate.IncrementalDelaunayTriangulator.prototype.insertSites=function(t){var e,o=0,n=t.length;for(o;o<n;o++)e=t[o],this.insertSite(e)},jsts.triangulate.IncrementalDelaunayTriangulator.prototype.insertSite=function(t){var e,o,n,i;if(e=this.subdiv.locate(t),this.subdiv.isVertexOfEdge(e,t))return e;this.subdiv.isOnEdge(e,t.getCoordinate())&&(e=e.oPrev(),this.subdiv.delete_jsts(e.oNext())),o=this.subdiv.makeEdge(e.orig(),t),jsts.triangulate.quadedge.QuadEdge.splice(o,e),n=o;do{o=this.subdiv.connect(e,o.sym()),e=o.oPrev()}while(e.lNext()!=n);for(;;)if(i=e.oPrev(),i.dest().rightOf(e)&&t.isInCircle(e.orig(),i.dest(),e.dest()))jsts.triangulate.quadedge.QuadEdge.swap(e),e=e.oPrev();else{if(e.oNext()==n)return o;e=e.oNext().lPrev()}}}(),jsts.noding.OrientedCoordinateArray=function(t){this.pts=t,this._orientation=jsts.noding.OrientedCoordinateArray.orientation(t)},jsts.noding.OrientedCoordinateArray.prototype.pts=null,jsts.noding.OrientedCoordinateArray.prototype._orientation=void 0,jsts.noding.OrientedCoordinateArray.orientation=function(t){return 1===jsts.geom.CoordinateArrays.increasingDirection(t)},jsts.noding.OrientedCoordinateArray.prototype.compareTo=function(t){var e=t;return jsts.noding.OrientedCoordinateArray.compareOriented(this.pts,this._orientation,e.pts,e._orientation)},jsts.noding.OrientedCoordinateArray.compareOriented=function(t,e,o,n){for(var i=e?1:-1,r=n?1:-1,s=e?t.length:-1,a=n?o.length:-1,l=e?0:t.length-1,c=n?0:o.length-1;;){var u=t[l].compareTo(o[c]);if(0!==u)return u;l+=i,c+=r;var h=l===s,g=c===a;if(h&&!g)return-1;if(!h&&g)return 1;if(h&&g)return 0}},jsts.index.quadtree.Root=function(){jsts.index.quadtree.NodeBase.prototype.constructor.apply(this,arguments),this.origin=new jsts.geom.Coordinate(0,0)},jsts.index.quadtree.Root.prototype=new jsts.index.quadtree.NodeBase,jsts.index.quadtree.Root.prototype.insert=function(t,e){var o=this.getSubnodeIndex(t,this.origin);if(-1===o)return void this.add(e);var n=this.subnode[o];if(null===n||!n.getEnvelope().contains(t)){var i=jsts.index.quadtree.Node.createExpanded(n,t);this.subnode[o]=i}this.insertContained(this.subnode[o],t,e)},jsts.index.quadtree.Root.prototype.insertContained=function(t,e,o){var n,i,r;n=jsts.index.IntervalSize.isZeroWidth(e.getMinX(),e.getMaxX()),i=jsts.index.IntervalSize.isZeroWidth(e.getMinY(),e.getMaxY()),r=n||i?t.find(e):t.getNode(e),r.add(o)},jsts.index.quadtree.Root.prototype.isSearchMatch=function(t){return!0},jsts.triangulate.quadedge.Vertex=function(){1===arguments.length?this.initFromCoordinate(arguments[0]):this.initFromXY(arguments[0],arguments[1])},jsts.triangulate.quadedge.Vertex.LEFT=0,jsts.triangulate.quadedge.Vertex.RIGHT=1,jsts.triangulate.quadedge.Vertex.BEYOND=2,jsts.triangulate.quadedge.Vertex.BEHIND=3,jsts.triangulate.quadedge.Vertex.BETWEEN=4,jsts.triangulate.quadedge.Vertex.ORIGIN=5,jsts.triangulate.quadedge.Vertex.DESTINATION=6,jsts.triangulate.quadedge.Vertex.prototype.initFromXY=function(t,e){this.p=new jsts.geom.Coordinate(t,e)},jsts.triangulate.quadedge.Vertex.prototype.initFromCoordinate=function(t){this.p=new jsts.geom.Coordinate(t)},jsts.triangulate.quadedge.Vertex.prototype.getX=function(){return this.p.x},jsts.triangulate.quadedge.Vertex.prototype.getY=function(){return this.p.y},jsts.triangulate.quadedge.Vertex.prototype.getZ=function(){return this.p.z},jsts.triangulate.quadedge.Vertex.prototype.setZ=function(t){this.p.z=t},jsts.triangulate.quadedge.Vertex.prototype.getCoordinate=function(){return this.p},jsts.triangulate.quadedge.Vertex.prototype.toString=function(){return"POINT ("+this.p.x+" "+this.p.y+")"},jsts.triangulate.quadedge.Vertex.prototype.equals=function(){return 1===arguments.length?this.equalsExact(arguments[0]):this.equalsWithTolerance(arguments[0],arguments[1])},jsts.triangulate.quadedge.Vertex.prototype.equalsExact=function(t){return this.p.x===t.getX()&&this.p.y===t.getY()},jsts.triangulate.quadedge.Vertex.prototype.equalsWithTolerance=function(t,e){return this.p.distance(t.getCoordinate())<e},jsts.triangulate.quadedge.Vertex.prototype.classify=function(t,e){var o,n,i,r;return o=this,n=e.sub(t),i=o.sub(t),r=n.crossProduct(i),r>0?jsts.triangulate.quadedge.Vertex.LEFT:r<0?jsts.triangulate.quadedge.Vertex.RIGHT:n.getX()*i.getX()<0||n.getY()*i.getY()<0?jsts.triangulate.quadedge.Vertex.BEHIND:n.magn()<i.magn()?jsts.triangulate.quadedge.Vertex.BEYOND:t.equals(o)?jsts.triangulate.quadedge.Vertex.ORIGIN:e.equals(o)?jsts.triangulate.quadedge.Vertex.DESTINATION:jsts.triangulate.quadedge.Vertex.BETWEEN},jsts.triangulate.quadedge.Vertex.prototype.crossProduct=function(t){return this.p.x*t.getY()-this.p.y*t.getX()},jsts.triangulate.quadedge.Vertex.prototype.dot=function(t){return this.p.x*t.getX()+this.p.y*t.getY()},jsts.triangulate.quadedge.Vertex.prototype.times=function(t){return new jsts.triangulate.quadedge.Vertex(t*this.p.x,t*this.p.y)},jsts.triangulate.quadedge.Vertex.prototype.sum=function(t){return new jsts.triangulate.quadedge.Vertex(this.p.x+t.getX(),this.p.y+t.getY())},jsts.triangulate.quadedge.Vertex.prototype.sub=function(t){return new jsts.triangulate.quadedge.Vertex(this.p.x-t.getX(),this.p.y-t.getY())},jsts.triangulate.quadedge.Vertex.prototype.magn=function(){return Math.sqrt(this.p.x*this.p.x+this.p.y*this.p.y)},jsts.triangulate.quadedge.Vertex.prototype.cross=function(){return new Vertex(this.p.y,-this.p.x)},jsts.triangulate.quadedge.Vertex.prototype.isInCircle=function(t,e,o){return jsts.triangulate.quadedge.TrianglePredicate.isInCircleRobust(t.p,e.p,o.p,this.p)},jsts.triangulate.quadedge.Vertex.prototype.isCCW=function(t,e){return(t.p.x-this.p.x)*(e.p.y-this.p.y)-(t.p.y-this.p.y)*(e.p.x-this.p.x)>0},jsts.triangulate.quadedge.Vertex.prototype.rightOf=function(t){return this.isCCW(t.dest(),t.orig())},jsts.triangulate.quadedge.Vertex.prototype.leftOf=function(t){return this.isCCW(t.orig(),t.dest())},jsts.triangulate.quadedge.Vertex.prototype.bisector=function(t,e){var o,n,i,r;return o=e.getX()-t.getX(),n=e.getY()-t.getY(),i=new jsts.algorithm.HCoordinate(t.getX()+o/2,t.getY()+n/2,1),r=new jsts.algorithm.HCoordinate(t.getX()-n+o/2,t.getY()+o+n/2,1),new jsts.algorithm.HCoordinate(i,r)},jsts.triangulate.quadedge.Vertex.prototype.distance=function(t,e){return t.p.distance(e.p)},jsts.triangulate.quadedge.Vertex.prototype.circumRadiusRatio=function(t,e){var o,n,i,r;return o=this.circleCenter(t,e),n=this.distance(o,t),i=this.distance(this,t),r=this.distance(t,e),r<i&&(i=r),r=this.distance(e,this),r<i&&(i=r),n/i},jsts.triangulate.quadedge.Vertex.prototype.midPoint=function(t){var e,o;return e=(this.p.x+t.getX())/2,o=(this.p.y+t.getY())/2,new jsts.triangulate.quadedge.Vertex(e,o)},jsts.triangulate.quadedge.Vertex.prototype.circleCenter=function(t,e){var o,n,i,r,s;o=new jsts.triangulate.quadedge.Vertex(this.getX(),this.getY()),n=this.bisector(o,t),i=this.bisector(t,e),r=new jsts.algorithm.HCoordinate(n,i),s=null;try{s=new jsts.triangulate.quadedge.Vertex(r.getX(),r.getY())}catch(t){}return s},jsts.noding.SegmentNodeList=function(t){this.nodeMap=new javascript.util.TreeMap,this.edge=t},jsts.noding.SegmentNodeList.prototype.nodeMap=null,jsts.noding.SegmentNodeList.prototype.iterator=function(){return this.nodeMap.values().iterator()},jsts.noding.SegmentNodeList.prototype.edge=null,jsts.noding.SegmentNodeList.prototype.getEdge=function(){return this.edge},jsts.noding.SegmentNodeList.prototype.add=function(t,e){var o=new jsts.noding.SegmentNode(this.edge,t,e,this.edge.getSegmentOctant(e)),n=this.nodeMap.get(o);return null!==n?(jsts.util.Assert.isTrue(n.coord.equals2D(t),"Found equal nodes with different coordinates"),n):(this.nodeMap.put(o,o),o)},jsts.noding.SegmentNodeList.prototype.addEndpoints=function(){var t=this.edge.size()-1;this.add(this.edge.getCoordinate(0),0),this.add(this.edge.getCoordinate(t),t)},jsts.noding.SegmentNodeList.prototype.addCollapsedNodes=function(){var t=[];this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=0;e<t.length;e++){var o=t[e];this.add(this.edge.getCoordinate(o),o)}},jsts.noding.SegmentNodeList.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this.edge.size()-2;e++){var o=this.edge.getCoordinate(e),n=(this.edge.getCoordinate(e+1),this.edge.getCoordinate(e+2));o.equals2D(n)&&t.push(e+1)}},jsts.noding.SegmentNodeList.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=[null],o=this.iterator(),n=o.next();o.hasNext();){var i=o.next();this.findCollapseIndex(n,i,e)&&t.push(e[0]),n=i}},jsts.noding.SegmentNodeList.prototype.findCollapseIndex=function(t,e,o){if(!t.coord.equals2D(e.coord))return!1;var n=e.segmentIndex-t.segmentIndex;return e.isInterior()||n--,1===n&&(o[0]=t.segmentIndex+1,!0)},jsts.noding.SegmentNodeList.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),o=e.next();e.hasNext();){var n=e.next(),i=this.createSplitEdge(o,n);t.add(i),o=n}},jsts.noding.SegmentNodeList.prototype.checkSplitEdgesCorrectness=function(t){var e=edge.getCoordinates(),o=t[0],n=o.getCoordinate(0);if(!n.equals2D(e[0]))throw new Error("bad split edge start point at "+n);var i=t[t.length-1],r=i.getCoordinates(),s=r[r.length-1];if(!s.equals2D(e[e.length-1]))throw new Error("bad split edge end point at "+s)},jsts.noding.SegmentNodeList.prototype.createSplitEdge=function(t,e){var o=e.segmentIndex-t.segmentIndex+2,n=this.edge.getCoordinate(e.segmentIndex),i=e.isInterior()||!e.coord.equals2D(n);i||o--;var r=[],s=0;r[s++]=new jsts.geom.Coordinate(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)r[s++]=this.edge.getCoordinate(a);return i&&(r[s]=e.coord),new jsts.noding.NodedSegmentString(r,this.edge.getData())},jsts.operation.union.CascadedPolygonUnion=function(t){this.inputPolys=t},jsts.operation.union.CascadedPolygonUnion.union=function(t){return new jsts.operation.union.CascadedPolygonUnion(t).union()},jsts.operation.union.CascadedPolygonUnion.prototype.inputPolys,jsts.operation.union.CascadedPolygonUnion.prototype.geomFactory=null,jsts.operation.union.CascadedPolygonUnion.prototype.STRTREE_NODE_CAPACITY=4,jsts.operation.union.CascadedPolygonUnion.prototype.union=function(){if(0===this.inputPolys.length)return null;this.geomFactory=this.inputPolys[0].getFactory();for(var t=new jsts.index.strtree.STRtree(this.STRTREE_NODE_CAPACITY),e=0,o=this.inputPolys.length;e<o;e++){var n=this.inputPolys[e];t.insert(n.getEnvelopeInternal(),n)}var i=t.itemsTree();return this.unionTree(i)},jsts.operation.union.CascadedPolygonUnion.prototype.unionTree=function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},jsts.operation.union.CascadedPolygonUnion.prototype.binaryUnion=function(t,e,o){if(e=e||0,(o=o||t.length)-e<=1){var n=this.getGeometry(t,e);return this.unionSafe(n,null)}if(o-e==2)return this.unionSafe(this.getGeometry(t,e),this.getGeometry(t,e+1));var i=parseInt((o+e)/2),n=this.binaryUnion(t,e,i),r=this.binaryUnion(t,i,o);return this.unionSafe(n,r)},jsts.operation.union.CascadedPolygonUnion.prototype.getGeometry=function(t,e){return e>=t.length?null:t[e]},jsts.operation.union.CascadedPolygonUnion.prototype.reduceToGeometries=function(t){for(var e=[],o=0,n=t.length;o<n;o++){var i=t[o],r=null;i instanceof Array?r=this.unionTree(i):i instanceof jsts.geom.Geometry&&(r=i),e.push(r)}return e},jsts.operation.union.CascadedPolygonUnion.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.clone():null===e?t.clone():this.unionOptimized(t,e)},jsts.operation.union.CascadedPolygonUnion.prototype.unionOptimized=function(t,e){var o=t.getEnvelopeInternal(),n=e.getEnvelopeInternal();if(!o.intersects(n)){return jsts.geom.util.GeometryCombiner.combine(t,e)}if(t.getNumGeometries<=1&&e.getNumGeometries<=1)return this.unionActual(t,e);var i=o.intersection(n);return this.unionUsingEnvelopeIntersection(t,e,i)},jsts.operation.union.CascadedPolygonUnion.prototype.unionUsingEnvelopeIntersection=function(t,e,o){var n=new javascript.util.ArrayList,i=this.extractByEnvelope(o,t,n),r=this.extractByEnvelope(o,e,n),s=this.unionActual(i,r);return n.add(s),jsts.geom.util.GeometryCombiner.combine(n)},jsts.operation.union.CascadedPolygonUnion.prototype.extractByEnvelope=function(t,e,o){for(var n=new javascript.util.ArrayList,i=0;i<e.getNumGeometries();i++){var r=e.getGeometryN(i);r.getEnvelopeInternal().intersects(t)?n.add(r):o.add(r)}return this.geomFactory.buildGeometry(n)},jsts.operation.union.CascadedPolygonUnion.prototype.unionActual=function(t,e){return t.union(e)},function(){jsts.geom.MultiPoint=function(t,e){this.geometries=t||[],this.factory=e},jsts.geom.MultiPoint.prototype=new jsts.geom.GeometryCollection,jsts.geom.MultiPoint.constructor=jsts.geom.MultiPoint,jsts.geom.MultiPoint.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},jsts.geom.MultiPoint.prototype.getGeometryN=function(t){return this.geometries[t]},jsts.geom.MultiPoint.prototype.equalsExact=function(t,e){return!!this.isEquivalentClass(t)&&jsts.geom.GeometryCollection.prototype.equalsExact.call(this,t,e)},jsts.geom.MultiPoint.prototype.CLASS_NAME="jsts.geom.MultiPoint"}(),jsts.operation.distance.DistanceOp=function(t,e,o){this.ptLocator=new jsts.algorithm.PointLocator,this.geom=[],this.geom[0]=t,this.geom[1]=e,this.terminateDistance=o},jsts.operation.distance.DistanceOp.prototype.geom=null,jsts.operation.distance.DistanceOp.prototype.terminateDistance=0,jsts.operation.distance.DistanceOp.prototype.ptLocator=null,jsts.operation.distance.DistanceOp.prototype.minDistanceLocation=null,jsts.operation.distance.DistanceOp.prototype.minDistance=Number.MAX_VALUE,jsts.operation.distance.DistanceOp.distance=function(t,e){return new jsts.operation.distance.DistanceOp(t,e,0).distance()},jsts.operation.distance.DistanceOp.isWithinDistance=function(t,e,o){return new jsts.operation.distance.DistanceOp(t,e,o).distance()<=o},jsts.operation.distance.DistanceOp.nearestPoints=function(t,e){return new jsts.operation.distance.DistanceOp(t,e,0).nearestPoints()},jsts.operation.distance.DistanceOp.prototype.distance=function(){if(null===this.geom[0]||null===this.geom[1])throw new jsts.error.IllegalArgumentError("null geometries are not supported");return this.geom[0].isEmpty()||this.geom[1].isEmpty()?0:(this.computeMinDistance(),this.minDistance)},jsts.operation.distance.DistanceOp.prototype.nearestPoints=function(){return this.computeMinDistance(),[this.minDistanceLocation[0].getCoordinate(),this.minDistanceLocation[1].getCoordinate()]},jsts.operation.distance.DistanceOp.prototype.nearestLocations=function(){return this.computeMinDistance(),this.minDistanceLocation},jsts.operation.distance.DistanceOp.prototype.updateMinDistance=function(t,e){null!==t[0]&&(e?(this.minDistanceLocation[0]=t[1],this.minDistanceLocation[1]=t[0]):(this.minDistanceLocation[0]=t[0],this.minDistanceLocation[1]=t[1]))},jsts.operation.distance.DistanceOp.prototype.computeMinDistance=function(){if(arguments.length>0)return void this.computeMinDistance2.apply(this,arguments);null===this.minDistanceLocation&&(this.minDistanceLocation=[],this.computeContainmentDistance(),this.minDistance<=this.terminateDistance||this.computeFacetDistance())},jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance=function(){if(2===arguments.length)return void this.computeContainmentDistance2.apply(this,arguments);if(3===arguments.length&&!arguments[0]instanceof jsts.operation.distance.GeometryLocation)return void this.computeContainmentDistance3.apply(this,arguments);if(3===arguments.length)return void this.computeContainmentDistance4.apply(this,arguments);var t=[];this.computeContainmentDistance2(0,t),this.minDistance<=this.terminateDistance||this.computeContainmentDistance2(1,t)},jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance2=function(t,e){var o=1-t,n=jsts.geom.util.PolygonExtracter.getPolygons(this.geom[t]);if(n.length>0){var i=jsts.operation.distance.ConnectedElementLocationFilter.getLocations(this.geom[o]);if(this.computeContainmentDistance3(i,n,e),this.minDistance<=this.terminateDistance)return this.minDistanceLocation[o]=e[0],void(this.minDistanceLocation[t]=e[1])}},jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance3=function(t,e,o){for(var n=0;n<t.length;n++)for(var i=t[n],r=0;r<e.length;r++)if(this.computeContainmentDistance4(i,e[r],o),this.minDistance<=this.terminateDistance)return},jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance4=function(t,e,o){var n=t.getCoordinate();if(jsts.geom.Location.EXTERIOR!==this.ptLocator.locate(n,e))return this.minDistance=0,o[0]=t,void(o[1]=new jsts.operation.distance.GeometryLocation(e,n))},jsts.operation.distance.DistanceOp.prototype.computeFacetDistance=function(){var t=[],e=jsts.geom.util.LinearComponentExtracter.getLines(this.geom[0]),o=jsts.geom.util.LinearComponentExtracter.getLines(this.geom[1]),n=jsts.geom.util.PointExtracter.getPoints(this.geom[0]),i=jsts.geom.util.PointExtracter.getPoints(this.geom[1]);this.computeMinDistanceLines(e,o,t),this.updateMinDistance(t,!1),this.minDistance<=this.terminateDistance||(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,i,t),this.updateMinDistance(t,!1),this.minDistance<=this.terminateDistance||(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(o,n,t),this.updateMinDistance(t,!0),this.minDistance<=this.terminateDistance||(t[0]=null,t[1]=null,this.computeMinDistancePoints(n,i,t),this.updateMinDistance(t,!1))))},jsts.operation.distance.DistanceOp.prototype.computeMinDistanceLines=function(t,e,o){for(var n=0;n<t.length;n++)for(var i=t[n],r=0;r<e.length;r++){var s=e[r];if(this.computeMinDistance(i,s,o),this.minDistance<=this.terminateDistance)return}},jsts.operation.distance.DistanceOp.prototype.computeMinDistancePoints=function(t,e,o){for(var n=0;n<t.length;n++)for(var i=t[n],r=0;r<e.length;r++){var s=e[r],a=i.getCoordinate().distance(s.getCoordinate());if(a<this.minDistance&&(this.minDistance=a,o[0]=new jsts.operation.distance.GeometryLocation(i,0,i.getCoordinate()),o[1]=new jsts.operation.distance.GeometryLocation(s,0,s.getCoordinate())),this.minDistance<=this.terminateDistance)return}},jsts.operation.distance.DistanceOp.prototype.computeMinDistanceLinesPoints=function(t,e,o){for(var n=0;n<t.length;n++)for(var i=t[n],r=0;r<e.length;r++){var s=e[r];if(this.computeMinDistance(i,s,o),this.minDistance<=this.terminateDistance)return}};jsts.operation.distance.DistanceOp.prototype.computeMinDistance2=function(t,e,o){if(e instanceof jsts.geom.Point)return void this.computeMinDistance3(t,e,o);if(!(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this.minDistance))for(var n=t.getCoordinates(),i=e.getCoordinates(),r=0;r<n.length-1;r++)for(var s=0;s<i.length-1;s++){var a=jsts.algorithm.CGAlgorithms.distanceLineLine(n[r],n[r+1],i[s],i[s+1]);if(a<this.minDistance){this.minDistance=a;var l=new jsts.geom.LineSegment(n[r],n[r+1]),c=new jsts.geom.LineSegment(i[s],i[s+1]),u=l.closestPoints(c);o[0]=new jsts.operation.distance.GeometryLocation(t,r,u[0]),o[1]=new jsts.operation.distance.GeometryLocation(e,s,u[1])}if(this.minDistance<=this.terminateDistance)return}},jsts.operation.distance.DistanceOp.prototype.computeMinDistance3=function(t,e,o){if(!(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this.minDistance))for(var n=t.getCoordinates(),i=e.getCoordinate(),r=0;r<n.length-1;r++){var s=jsts.algorithm.CGAlgorithms.distancePointLine(i,n[r],n[r+1]);if(s<this.minDistance){this.minDistance=s;var a=new jsts.geom.LineSegment(n[r],n[r+1]),l=a.closestPoint(i);o[0]=new jsts.operation.distance.GeometryLocation(t,r,l),o[1]=new jsts.operation.distance.GeometryLocation(e,0,i)}if(this.minDistance<=this.terminateDistance)return}},function(){var t=function(t,e,o){this.hotPixel=t,this.parentEdge=e,this.vertexIndex=o};t.prototype=new jsts.index.chain.MonotoneChainSelectAction,t.constructor=t,t.prototype.hotPixel=null,t.prototype.parentEdge=null,t.prototype.vertexIndex=null,t.prototype._isNodeAdded=!1,t.prototype.isNodeAdded=function(){return this._isNodeAdded},t.prototype.select=function(t,e){var o=t.getContext();null!==this.parentEdge&&o===this.parentEdge&&e===this.vertexIndex||(this._isNodeAdded=this.hotPixel.addSnappedNode(o,e))},jsts.noding.snapround.MCIndexPointSnapper=function(t){this.index=t},jsts.noding.snapround.MCIndexPointSnapper.prototype.index=null,jsts.noding.snapround.MCIndexPointSnapper.prototype.snap=function(e,o,n){if(1===arguments.length)return void this.snap2.apply(this,arguments);var i=e.getSafeEnvelope(),r=new t(e,o,n);return this.index.query(i,{visitItem:function(t){t.select(i,r)}}),r.isNodeAdded()},jsts.noding.snapround.MCIndexPointSnapper.prototype.snap2=function(t){return this.snap(t,null,-1)}}(),jsts.noding.snapround.MCIndexSnapRounder=function(t){this.pm=t,this.li=new jsts.algorithm.RobustLineIntersector,this.li.setPrecisionModel(t),this.scaleFactor=t.getScale()},jsts.noding.snapround.MCIndexSnapRounder.prototype=new jsts.noding.Noder,jsts.noding.snapround.MCIndexSnapRounder.constructor=jsts.noding.snapround.MCIndexSnapRounder,jsts.noding.snapround.MCIndexSnapRounder.prototype.pm=null,jsts.noding.snapround.MCIndexSnapRounder.prototype.li=null,jsts.noding.snapround.MCIndexSnapRounder.prototype.scaleFactor=null,jsts.noding.snapround.MCIndexSnapRounder.prototype.noder=null,jsts.noding.snapround.MCIndexSnapRounder.prototype.pointSnapper=null,jsts.noding.snapround.MCIndexSnapRounder.prototype.nodedSegStrings=null,jsts.noding.snapround.MCIndexSnapRounder.prototype.getNodedSubstrings=function(){return jsts.noding.NodedSegmentString.getNodedSubstrings(this.nodedSegStrings)},jsts.noding.snapround.MCIndexSnapRounder.prototype.computeNodes=function(t){this.nodedSegStrings=t,this.noder=new jsts.noding.MCIndexNoder,this.pointSnapper=new jsts.noding.snapround.MCIndexPointSnapper(this.noder.getIndex()),this.snapRound(t,this.li)},jsts.noding.snapround.MCIndexSnapRounder.prototype.snapRound=function(t,e){var o=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(o),this.computeVertexSnaps(t)},jsts.noding.snapround.MCIndexSnapRounder.prototype.findInteriorIntersections=function(t,e){var o=new jsts.noding.IntersectionFinderAdder(e);return this.noder.setSegmentIntersector(o),this.noder.computeNodes(t),o.getInteriorIntersections()},jsts.noding.snapround.MCIndexSnapRounder.prototype.computeIntersectionSnaps=function(t){for(var e=t.iterator();e.hasNext();){var o=e.next(),n=new jsts.noding.snapround.HotPixel(o,this.scaleFactor,this.li);this.pointSnapper.snap(n)}},jsts.noding.snapround.MCIndexSnapRounder.prototype.computeVertexSnaps=function(t){if(t instanceof jsts.noding.NodedSegmentString)return void this.computeVertexSnaps2.apply(this,arguments);for(var e=t.iterator();e.hasNext();){var o=e.next();this.computeVertexSnaps(o)}},jsts.noding.snapround.MCIndexSnapRounder.prototype.computeVertexSnaps2=function(t){for(var e=t.getCoordinates(),o=0;o<e.length-1;o++){var n=new jsts.noding.snapround.HotPixel(e[o],this.scaleFactor,this.li);this.pointSnapper.snap(n,t,o)&&t.addIntersection(e[o],o)}},jsts.geomgraph.Quadrant=function(){},jsts.geomgraph.Quadrant.NE=0,jsts.geomgraph.Quadrant.NW=1,jsts.geomgraph.Quadrant.SW=2,jsts.geomgraph.Quadrant.SE=3,jsts.geomgraph.Quadrant.quadrant=function(t,e){if(t instanceof jsts.geom.Coordinate)return jsts.geomgraph.Quadrant.quadrant2.apply(this,arguments);if(0===t&&0===e)throw new jsts.error.IllegalArgumentError("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?jsts.geomgraph.Quadrant.NE:jsts.geomgraph.Quadrant.SE:e>=0?jsts.geomgraph.Quadrant.NW:jsts.geomgraph.Quadrant.SW},jsts.geomgraph.Quadrant.quadrant2=function(t,e){if(e.x===t.x&&e.y===t.y)throw new jsts.error.IllegalArgumentError("Cannot compute the quadrant for two identical points "+t);return e.x>=t.x?e.y>=t.y?jsts.geomgraph.Quadrant.NE:jsts.geomgraph.Quadrant.SE:e.y>=t.y?jsts.geomgraph.Quadrant.NW:jsts.geomgraph.Quadrant.SW},jsts.geomgraph.Quadrant.isOpposite=function(t,e){return t!==e&&2==(t-e+4)%4},jsts.geomgraph.Quadrant.commonHalfPlane=function(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var o=t<e?t:e,n=t>e?t:e;return 0===o&&3===n?3:o},jsts.geomgraph.Quadrant.isInHalfPlane=function(t,e){return e===jsts.geomgraph.Quadrant.SE?t===jsts.geomgraph.Quadrant.SE||t===jsts.geomgraph.Quadrant.SW:t===e||t===e+1},jsts.geomgraph.Quadrant.isNorthern=function(t){return t===jsts.geomgraph.Quadrant.NE||t===jsts.geomgraph.Quadrant.NW},jsts.operation.valid.ConsistentAreaTester=function(t){this.geomGraph=t,this.li=new jsts.algorithm.RobustLineIntersector,this.nodeGraph=new jsts.operation.relate.RelateNodeGraph,this.invalidPoint=null},jsts.operation.valid.ConsistentAreaTester.prototype.getInvalidPoint=function(){return this.invalidPoint},jsts.operation.valid.ConsistentAreaTester.prototype.isNodeConsistentArea=function(){var t=this.geomGraph.computeSelfNodes(this.li,!0);return t.hasProperIntersection()?(this.invalidPoint=t.getProperIntersectionPoint(),!1):(this.nodeGraph.build(this.geomGraph),this.isNodeEdgeAreaLabelsConsistent())},jsts.operation.valid.ConsistentAreaTester.prototype.isNodeEdgeAreaLabelsConsistent=function(){for(var t=this.nodeGraph.getNodeIterator();t.hasNext();){var e=t.next();if(!e.getEdges().isAreaLabelsConsistent(this.geomGraph))return this.invalidPoint=e.getCoordinate().clone(),!1}return!0},jsts.operation.valid.ConsistentAreaTester.prototype.hasDuplicateRings=function(){for(var t=this.nodeGraph.getNodeIterator();t.hasNext();)for(var e=t.next(),o=e.getEdges().iterator();o.hasNext();){var n=o.next();if(n.getEdgeEnds().length>1)return invalidPoint=n.getEdge().getCoordinate(0),!0}return!1},jsts.operation.relate.RelateNode=function(t,e){jsts.geomgraph.Node.apply(this,arguments)},jsts.operation.relate.RelateNode.prototype=new jsts.geomgraph.Node,jsts.operation.relate.RelateNode.prototype.computeIM=function(t){t.setAtLeastIfValid(this.label.getLocation(0),this.label.getLocation(1),0)},jsts.operation.relate.RelateNode.prototype.updateIMFromEdges=function(t){this.edges.updateIM(t)},function(){var t=jsts.geom.Location,e=jsts.geomgraph.Position,o=jsts.geomgraph.EdgeEnd;jsts.geomgraph.DirectedEdge=function(t,e){if(o.call(this,t),this.depth=[0,-999,-999],this._isForward=e,e)this.init(t.getCoordinate(0),t.getCoordinate(1));else{var n=t.getNumPoints()-1;this.init(t.getCoordinate(n),t.getCoordinate(n-1))}this.computeDirectedLabel()},jsts.geomgraph.DirectedEdge.prototype=new o,jsts.geomgraph.DirectedEdge.constructor=jsts.geomgraph.DirectedEdge,jsts.geomgraph.DirectedEdge.depthFactor=function(e,o){return e===t.EXTERIOR&&o===t.INTERIOR?1:e===t.INTERIOR&&o===t.EXTERIOR?-1:0},jsts.geomgraph.DirectedEdge.prototype._isForward=null,jsts.geomgraph.DirectedEdge.prototype._isInResult=!1,jsts.geomgraph.DirectedEdge.prototype._isVisited=!1,jsts.geomgraph.DirectedEdge.prototype.sym=null,jsts.geomgraph.DirectedEdge.prototype.next=null,jsts.geomgraph.DirectedEdge.prototype.nextMin=null,jsts.geomgraph.DirectedEdge.prototype.edgeRing=null,jsts.geomgraph.DirectedEdge.prototype.minEdgeRing=null,jsts.geomgraph.DirectedEdge.prototype.depth=null,jsts.geomgraph.DirectedEdge.prototype.getEdge=function(){return this.edge},jsts.geomgraph.DirectedEdge.prototype.setInResult=function(t){this._isInResult=t},jsts.geomgraph.DirectedEdge.prototype.isInResult=function(){return this._isInResult},jsts.geomgraph.DirectedEdge.prototype.isVisited=function(){return this._isVisited},jsts.geomgraph.DirectedEdge.prototype.setVisited=function(t){this._isVisited=t},jsts.geomgraph.DirectedEdge.prototype.setEdgeRing=function(t){this.edgeRing=t},jsts.geomgraph.DirectedEdge.prototype.getEdgeRing=function(){return this.edgeRing},jsts.geomgraph.DirectedEdge.prototype.setMinEdgeRing=function(t){this.minEdgeRing=t},jsts.geomgraph.DirectedEdge.prototype.getMinEdgeRing=function(){return this.minEdgeRing},jsts.geomgraph.DirectedEdge.prototype.getDepth=function(t){return this.depth[t]},jsts.geomgraph.DirectedEdge.prototype.setDepth=function(t,e){if(-999!==this.depth[t]&&this.depth[t]!==e)throw new jsts.error.TopologyError("assigned depths do not match",this.getCoordinate());this.depth[t]=e},jsts.geomgraph.DirectedEdge.prototype.getDepthDelta=function(){var t=this.edge.getDepthDelta();return this._isForward||(t=-t),t},jsts.geomgraph.DirectedEdge.prototype.setVisitedEdge=function(t){this.setVisited(t),this.sym.setVisited(t)},jsts.geomgraph.DirectedEdge.prototype.getSym=function(){return this.sym},jsts.geomgraph.DirectedEdge.prototype.isForward=function(){return this._isForward},jsts.geomgraph.DirectedEdge.prototype.setSym=function(t){this.sym=t},jsts.geomgraph.DirectedEdge.prototype.getNext=function(){return this.next},jsts.geomgraph.DirectedEdge.prototype.setNext=function(t){this.next=t},jsts.geomgraph.DirectedEdge.prototype.getNextMin=function(){return this.nextMin},jsts.geomgraph.DirectedEdge.prototype.setNextMin=function(t){this.nextMin=t},jsts.geomgraph.DirectedEdge.prototype.isLineEdge=function(){var e=this.label.isLine(0)||this.label.isLine(1),o=!this.label.isArea(0)||this.label.allPositionsEqual(0,t.EXTERIOR),n=!this.label.isArea(1)||this.label.allPositionsEqual(1,t.EXTERIOR);return e&&o&&n},jsts.geomgraph.DirectedEdge.prototype.isInteriorAreaEdge=function(){for(var o=!0,n=0;n<2;n++)this.label.isArea(n)&&this.label.getLocation(n,e.LEFT)===t.INTERIOR&&this.label.getLocation(n,e.RIGHT)===t.INTERIOR||(o=!1);return o},jsts.geomgraph.DirectedEdge.prototype.computeDirectedLabel=function(){this.label=new jsts.geomgraph.Label(this.edge.getLabel()),this._isForward||this.label.flip()},jsts.geomgraph.DirectedEdge.prototype.setEdgeDepths=function(t,o){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var i=1;t===e.LEFT&&(i=-1);var r=e.opposite(t),s=n*i,a=o+s;this.setDepth(t,o),this.setDepth(r,a)}}(),jsts.operation.buffer.OffsetCurveBuilder=function(t,e){this.precisionModel=t,this.bufParams=e},jsts.operation.buffer.OffsetCurveBuilder.prototype.distance=0,jsts.operation.buffer.OffsetCurveBuilder.prototype.precisionModel=null,jsts.operation.buffer.OffsetCurveBuilder.prototype.bufParams=null,jsts.operation.buffer.OffsetCurveBuilder.prototype.getBufferParameters=function(){return this.bufParams},jsts.operation.buffer.OffsetCurveBuilder.prototype.getLineCurve=function(t,e){if(this.distance=e,this.distance<0&&!this.bufParams.isSingleSided())return null;if(0==this.distance)return null;var o=Math.abs(this.distance),n=this.getSegGen(o);if(t.length<=1)this.computePointCurve(t[0],n);else if(this.bufParams.isSingleSided()){var i=e<0;this.computeSingleSidedBufferCurve(t,i,n)}else this.computeLineBufferCurve(t,n);return n.getCoordinates()},jsts.operation.buffer.OffsetCurveBuilder.prototype.getRingCurve=function(t,e,o){if(this.distance=o,t.length<=2)return this.getLineCurve(t,o);if(0==this.distance)return jsts.operation.buffer.OffsetCurveBuilder.copyCoordinates(t);var n=this.getSegGen(this.distance);return this.computeRingBufferCurve(t,e,n),n.getCoordinates()},jsts.operation.buffer.OffsetCurveBuilder.prototype.getOffsetCurve=function(t,e){if(this.distance=e,0===this.distance)return null;var o=this.distance<0,n=Math.abs(this.distance),i=this.getSegGen(n);t.length<=1?this.computePointCurve(t[0],i):this.computeOffsetCurve(t,o,i);var r=i.getCoordinates();return o&&r.reverse(),r},jsts.operation.buffer.OffsetCurveBuilder.copyCoordinates=function(t){for(var e=[],o=0;o<t.length;o++)e.push(t[o].clone());return e},jsts.operation.buffer.OffsetCurveBuilder.prototype.getSegGen=function(t){return new jsts.operation.buffer.OffsetSegmentGenerator(this.precisionModel,this.bufParams,t)},jsts.operation.buffer.OffsetCurveBuilder.SIMPLIFY_FACTOR=100,jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance=function(t){return t/jsts.operation.buffer.OffsetCurveBuilder.SIMPLIFY_FACTOR},jsts.operation.buffer.OffsetCurveBuilder.prototype.computePointCurve=function(t,e){switch(this.bufParams.getEndCapStyle()){case jsts.operation.buffer.BufferParameters.CAP_ROUND:e.createCircle(t);break;case jsts.operation.buffer.BufferParameters.CAP_SQUARE:e.createSquare(t)}},jsts.operation.buffer.OffsetCurveBuilder.prototype.computeLineBufferCurve=function(t,e){var o=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance),n=jsts.operation.buffer.BufferInputLineSimplifier.simplify(t,o),i=n.length-1;e.initSideSegments(n[0],n[1],jsts.geomgraph.Position.LEFT);for(var r=2;r<=i;r++)e.addNextSegment(n[r],!0);e.addLastSegment(),e.addLineEndCap(n[i-1],n[i]);var s=jsts.operation.buffer.BufferInputLineSimplifier.simplify(t,-o),a=s.length-1;e.initSideSegments(s[a],s[a-1],jsts.geomgraph.Position.LEFT);for(var r=a-2;r>=0;r--)e.addNextSegment(s[r],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()},jsts.operation.buffer.OffsetCurveBuilder.prototype.computeSingleSidedBufferCurve=function(t,e,o){var n=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance);if(e){o.addSegments(t,!0);var i=jsts.operation.buffer.BufferInputLineSimplifier.simplify(t,-n),r=i.length-1;o.initSideSegments(i[r],i[r-1],jsts.geomgraph.Position.LEFT),o.addFirstSegment();for(var s=r-2;s>=0;s--)o.addNextSegment(i[s],!0)}else{o.addSegments(t,!1);var a=jsts.operation.buffer.BufferInputLineSimplifier.simplify(t,n),l=a.length-1;o.initSideSegments(a[0],a[1],jsts.geomgraph.Position.LEFT),o.addFirstSegment();for(var s=2;s<=l;s++)o.addNextSegment(a[s],!0)}o.addLastSegment(),o.closeRing()},jsts.operation.buffer.OffsetCurveBuilder.prototype.computeOffsetCurve=function(t,e,o){var n=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance);if(e){var i=jsts.operation.buffer.BufferInputLineSimplifier.simplify(t,-n),r=i.length-1;o.initSideSegments(i[r],i[r-1],jsts.geomgraph.Position.LEFT),o.addFirstSegment();for(var s=r-2;s>=0;s--)o.addNextSegment(i[s],!0)}else{var a=jsts.operation.buffer.BufferInputLineSimplifier.simplify(t,n),l=a.length-1;o.initSideSegments(a[0],a[1],jsts.geomgraph.Position.LEFT),o.addFirstSegment();for(var s=2;s<=l;s++)o.addNextSegment(a[s],!0)}o.addLastSegment()},jsts.operation.buffer.OffsetCurveBuilder.prototype.computeRingBufferCurve=function(t,e,o){var n=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance);e===jsts.geomgraph.Position.RIGHT&&(n=-n);var i=jsts.operation.buffer.BufferInputLineSimplifier.simplify(t,n),r=i.length-1;o.initSideSegments(i[r-1],i[0],e);for(var s=1;s<=r;s++){var a=1!==s;o.addNextSegment(i[s],a)}o.closeRing()},jsts.index.strtree.SIRtree=function(t){t=t||10,jsts.index.strtree.AbstractSTRtree.call(this,t)},jsts.index.strtree.SIRtree.prototype=new jsts.index.strtree.AbstractSTRtree,jsts.index.strtree.SIRtree.constructor=jsts.index.strtree.SIRtree,jsts.index.strtree.SIRtree.prototype.comperator={compare:function(t,e){return t.getBounds().getCentre()-e.getBounds().getCentre()}},jsts.index.strtree.SIRtree.prototype.intersectionOp={intersects:function(t,e){return t.intersects(e)}},jsts.index.strtree.SIRtree.prototype.createNode=function(t){var e=function(t){jsts.index.strtree.AbstractNode.apply(this,arguments)};return e.prototype=new jsts.index.strtree.AbstractNode,e.constructor=e,e.prototype.computeBounds=function(){for(var t,e=null,o=this.getChildBoundables(),n=0,i=o.length;n<i;n++)t=o[n],null===e?e=new jsts.index.strtree.Interval(t.getBounds()):e.expandToInclude(t.getBounds());return e},e},jsts.index.strtree.SIRtree.prototype.insert=function(t,e,o){jsts.index.strtree.AbstractSTRtree.prototype.insert(new jsts.index.strtree.Interval(Math.min(t,e),Math.max(t,e)),o)},jsts.index.strtree.SIRtree.prototype.query=function(t,e){e=e||t,jsts.index.strtree.AbstractSTRtree.prototype.query(new jsts.index.strtree.Interval(Math.min(t,e),Math.max(t,e)))},jsts.index.strtree.SIRtree.prototype.getIntersectsOp=function(){return this.intersectionOp},jsts.index.strtree.SIRtree.prototype.getComparator=function(){return this.comperator},function(){var t=jsts.geom.Location;jsts.operation.relate.RelateNodeGraph=function(){this.nodes=new jsts.geomgraph.NodeMap(new jsts.operation.relate.RelateNodeFactory)},jsts.operation.relate.RelateNodeGraph.prototype.nodes=null,jsts.operation.relate.RelateNodeGraph.prototype.build=function(t){this.computeIntersectionNodes(t,0),this.copyNodesAndLabels(t,0);var e=new jsts.operation.relate.EdgeEndBuilder,o=e.computeEdgeEnds(t.getEdgeIterator());this.insertEdgeEnds(o)},jsts.operation.relate.RelateNodeGraph.prototype.computeIntersectionNodes=function(e,o){for(var n=e.getEdgeIterator();n.hasNext();)for(var i=n.next(),r=i.getLabel().getLocation(o),s=i.getEdgeIntersectionList().iterator();s.hasNext();){var a=s.next(),l=this.nodes.addNode(a.coord);r===t.BOUNDARY?l.setLabelBoundary(o):l.getLabel().isNull(o)&&l.setLabel(o,t.INTERIOR)}},jsts.operation.relate.RelateNodeGraph.prototype.copyNodesAndLabels=function(t,e){for(var o=t.getNodeIterator();o.hasNext();){var n=o.next();this.nodes.addNode(n.getCoordinate()).setLabel(e,n.getLabel().getLocation(e))}},jsts.operation.relate.RelateNodeGraph.prototype.insertEdgeEnds=function(t){for(var e=t.iterator();e.hasNext();){var o=e.next();this.nodes.add(o)}},jsts.operation.relate.RelateNodeGraph.prototype.getNodeIterator=function(){return this.nodes.iterator()}}(),function(){var t=jsts.geom.Location,e=jsts.geomgraph.Position;jsts.geomgraph.Depth=function(){this.depth=[[],[]];for(var t=0;t<2;t++)for(var e=0;e<3;e++)this.depth[t][e]=jsts.geomgraph.Depth.NULL_VALUE},jsts.geomgraph.Depth.NULL_VALUE=-1,jsts.geomgraph.Depth.depthAtLocation=function(e){return e===t.EXTERIOR?0:e===t.INTERIOR?1:jsts.geomgraph.Depth.NULL_VALUE},jsts.geomgraph.Depth.prototype.depth=null,jsts.geomgraph.Depth.prototype.getDepth=function(t,e){return this.depth[t][e]},jsts.geomgraph.Depth.prototype.setDepth=function(t,e,o){this.depth[t][e]=o},jsts.geomgraph.Depth.prototype.getLocation=function(e,o){return this.depth[e][o]<=0?t.EXTERIOR:t.INTERIOR},jsts.geomgraph.Depth.prototype.add=function(e,o,n){n===t.INTERIOR&&this.depth[e][o]++},jsts.geomgraph.Depth.prototype.isNull=function(){if(arguments.length>0)return this.isNull2.apply(this,arguments);for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this.depth[t][e]!==jsts.geomgraph.Depth.NULL_VALUE)return!1;return!0},jsts.geomgraph.Depth.prototype.isNull2=function(t){return arguments.length>1?this.isNull3.apply(this,arguments):this.depth[t][1]==jsts.geomgraph.Depth.NULL_VALUE},jsts.geomgraph.Depth.prototype.isNull3=function(t,e){return this.depth[t][e]==jsts.geomgraph.Depth.NULL_VALUE},jsts.geomgraph.Depth.prototype.add=function(e){for(var o=0;o<2;o++)for(var n=1;n<3;n++){var i=e.getLocation(o,n);i!==t.EXTERIOR&&i!==t.INTERIOR||(this.isNull(o,n)?this.depth[o][n]=jsts.geomgraph.Depth.depthAtLocation(i):this.depth[o][n]+=jsts.geomgraph.Depth.depthAtLocation(i))}},jsts.geomgraph.Depth.prototype.getDelta=function(t){return this.depth[t][e.RIGHT]-this.depth[t][e.LEFT]},jsts.geomgraph.Depth.prototype.normalize=function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this.depth[t][1];this.depth[t][2]<e&&(e=this.depth[t][2]),e<0&&(e=0);for(var o=1;o<3;o++){var n=0;this.depth[t][o]>e&&(n=1),this.depth[t][o]=n}}},jsts.geomgraph.Depth.prototype.toString=function(){return"A: "+this.depth[0][1]+","+this.depth[0][2]+" B: "+this.depth[1][1]+","+this.depth[1][2]}}(),jsts.algorithm.BoundaryNodeRule=function(){},jsts.algorithm.BoundaryNodeRule.prototype.isInBoundary=function(t){throw new jsts.error.AbstractMethodInvocationError},jsts.algorithm.Mod2BoundaryNodeRule=function(){},jsts.algorithm.Mod2BoundaryNodeRule.prototype=new jsts.algorithm.BoundaryNodeRule,jsts.algorithm.Mod2BoundaryNodeRule.prototype.isInBoundary=function(t){return t%2==1},jsts.algorithm.BoundaryNodeRule.MOD2_BOUNDARY_RULE=new jsts.algorithm.Mod2BoundaryNodeRule,jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE=jsts.algorithm.BoundaryNodeRule.MOD2_BOUNDARY_RULE,jsts.geom.CoordinateSequenceFilter=function(){},jsts.geom.CoordinateSequenceFilter.prototype.filter=jsts.abstractFunc,jsts.geom.CoordinateSequenceFilter.prototype.isDone=jsts.abstractFunc,jsts.geom.CoordinateSequenceFilter.prototype.isGeometryChanged=jsts.abstractFunc,jsts.algorithm.distance.PointPairDistance=function(){this.pt=[new jsts.geom.Coordinate,new jsts.geom.Coordinate]},jsts.algorithm.distance.PointPairDistance.prototype.pt=null,jsts.algorithm.distance.PointPairDistance.prototype.distance=NaN,jsts.algorithm.distance.PointPairDistance.prototype.isNull=!0,jsts.algorithm.distance.PointPairDistance.prototype.initialize=function(t,e,o){if(void 0===t)return void(this.isNull=!0);this.pt[0].setCoordinate(t),this.pt[1].setCoordinate(e),this.distance=void 0!==o?o:t.distance(e),this.isNull=!1},jsts.algorithm.distance.PointPairDistance.prototype.getDistance=function(){return this.distance},jsts.algorithm.distance.PointPairDistance.prototype.getCoordinates=function(){return this.pt},jsts.algorithm.distance.PointPairDistance.prototype.getCoordinate=function(t){return this.pt[t]},jsts.algorithm.distance.PointPairDistance.prototype.setMaximum=function(t){if(2===arguments.length)return void this.setMaximum2.apply(this,arguments);this.setMaximum(t.pt[0],t.pt[1])},jsts.algorithm.distance.PointPairDistance.prototype.setMaximum2=function(t,e){if(this.isNull)return void this.initialize(t,e);var o=t.distance(e);o>this.distance&&this.initialize(t,e,o)},jsts.algorithm.distance.PointPairDistance.prototype.setMinimum=function(t){if(2===arguments.length)return void this.setMinimum2.apply(this,arguments);this.setMinimum(t.pt[0],t.pt[1])},jsts.algorithm.distance.PointPairDistance.prototype.setMinimum2=function(t,e){if(this.isNull)return void this.initialize(t,e);var o=t.distance(e);o<this.distance&&this.initialize(t,e,o)},function(){var t=jsts.algorithm.distance.PointPairDistance,e=jsts.algorithm.distance.DistanceToPoint,o=function(o){this.maxPtDist=new t,this.minPtDist=new t,this.euclideanDist=new e,this.geom=o};o.prototype=new jsts.geom.CoordinateFilter,o.prototype.maxPtDist=new t,o.prototype.minPtDist=new t,o.prototype.euclideanDist=new e,o.prototype.geom,o.prototype.filter=function(t){this.minPtDist.initialize(),e.computeDistance(this.geom,t,this.minPtDist),this.maxPtDist.setMaximum(this.minPtDist)},o.prototype.getMaxPointDistance=function(){return this.maxPtDist};var n=function(e,o){this.maxPtDist=new t,this.minPtDist=new t,this.geom=e,this.numSubSegs=Math.round(1/o)};n.prototype=new jsts.geom.CoordinateSequenceFilter,n.prototype.maxPtDist=new t,n.prototype.minPtDist=new t,n.prototype.geom,n.prototype.numSubSegs=0,n.prototype.filter=function(t,o){if(0!=o)for(var n=t[o-1],i=t[o],r=(i.x-n.x)/this.numSubSegs,s=(i.y-n.y)/this.numSubSegs,a=0;a<this.numSubSegs;a++){var l=n.x+a*r,c=n.y+a*s,u=new jsts.geom.Coordinate(l,c);this.minPtDist.initialize(),e.computeDistance(this.geom,u,this.minPtDist),this.maxPtDist.setMaximum(this.minPtDist)}},n.prototype.isGeometryChanged=function(){return!1},n.prototype.isDone=function(){return!1},n.prototype.getMaxPointDistance=function(){return this.maxPtDist},jsts.algorithm.distance.DiscreteHausdorffDistance=function(t,e){this.g0=t,this.g1=e,this.ptDist=new jsts.algorithm.distance.PointPairDistance},jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.g0=null,jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.g1=null,jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.ptDist=null,jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.densifyFrac=0,jsts.algorithm.distance.DiscreteHausdorffDistance.distance=function(t,e,o){var n=new jsts.algorithm.distance.DiscreteHausdorffDistance(t,e);return void 0!==o&&n.setDensifyFraction(o),n.distance()},jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new jsts.error.IllegalArgumentError("Fraction is not in range (0.0 - 1.0]");this.densifyFrac=t},jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.distance=function(){return this.compute(this.g0,this.g1),ptDist.getDistance()},jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.orientedDistance=function(){return this.computeOrientedDistance(this.g0,this.g1,this.ptDist),this.ptDist.getDistance()},jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.getCoordinates=function(){return ptDist.getCoordinates()},jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this.ptDist),this.computeOrientedDistance(e,t,this.ptDist)},jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.computeOrientedDistance=function(t,e,i){var r=new o(e);if(t.apply(r),i.setMaximum(r.getMaxPointDistance()),this.densifyFrac>0){var s=new n(e,this.densifyFrac);t.apply(s),i.setMaximum(s.getMaxPointDistance())}}}(),jsts.operation.distance.GeometryLocation=function(t,e,o){this.component=t,this.segIndex=e,this.pt=o},jsts.operation.distance.GeometryLocation.INSIDE_AREA=-1,jsts.operation.distance.GeometryLocation.prototype.component=null,jsts.operation.distance.GeometryLocation.prototype.segIndex=null,jsts.operation.distance.GeometryLocation.prototype.pt=null,jsts.operation.distance.GeometryLocation.prototype.getGeometryComponent=function(){return this.component},jsts.operation.distance.GeometryLocation.prototype.getSegmentIndex=function(){return this.segIndex},jsts.operation.distance.GeometryLocation.prototype.getCoordinate=function(){return this.pt},jsts.operation.distance.GeometryLocation.prototype.isInsideArea=function(){return this.segIndex===jsts.operation.distance.GeometryLocation.INSIDE_AREA},jsts.geom.util.PointExtracter=function(t){this.pts=t},jsts.geom.util.PointExtracter.prototype=new jsts.geom.GeometryFilter,jsts.geom.util.PointExtracter.prototype.pts=null,jsts.geom.util.PointExtracter.getPoints=function(t,e){return void 0===e&&(e=[]),t instanceof jsts.geom.Point?e.push(t):(t instanceof jsts.geom.GeometryCollection||t instanceof jsts.geom.MultiPoint||t instanceof jsts.geom.MultiLineString||t instanceof jsts.geom.MultiPolygon)&&t.apply(new jsts.geom.util.PointExtracter(e)),e},jsts.geom.util.PointExtracter.prototype.filter=function(t){t instanceof jsts.geom.Point&&this.pts.push(t)},jsts.noding.ScaledNoder=function(t,e,o,n){this.offsetX=o||0,this.offsetY=n||0,this.noder=t,this.scaleFactor=e,this.isScaled=!this.isIntegerPrecision()},jsts.noding.ScaledNoder.prototype=new jsts.noding.Noder,jsts.noding.ScaledNoder.constructor=jsts.noding.ScaledNoder,jsts.noding.ScaledNoder.prototype.noder=null,jsts.noding.ScaledNoder.prototype.scaleFactor=void 0,jsts.noding.ScaledNoder.prototype.offsetX=void 0,jsts.noding.ScaledNoder.prototype.offsetY=void 0,jsts.noding.ScaledNoder.prototype.isScaled=!1,jsts.noding.ScaledNoder.prototype.isIntegerPrecision=function(){return 1===this.scaleFactor},jsts.noding.ScaledNoder.prototype.getNodedSubstrings=function(){var t=this.noder.getNodedSubstrings();return this.isScaled&&this.rescale(t),t},jsts.noding.ScaledNoder.prototype.computeNodes=function(t){var e=t;this.isScaled&&(e=this.scale(t)),this.noder.computeNodes(e)},jsts.noding.ScaledNoder.prototype.scale=function(t){if(t instanceof Array)return this.scale2(t);for(var e=new javascript.util.ArrayList,o=t.iterator();o.hasNext();){var n=o.next();e.add(new jsts.noding.NodedSegmentString(this.scale(n.getCoordinates()),n.getData()))}return e},jsts.noding.ScaledNoder.prototype.scale2=function(t){for(var e=[],o=0;o<t.length;o++)e[o]=new jsts.geom.Coordinate(Math.round((t[o].x-this.offsetX)*this.scaleFactor),Math.round((t[o].y-this.offsetY)*this.scaleFactor));return jsts.geom.CoordinateArrays.removeRepeatedPoints(e)},jsts.noding.ScaledNoder.prototype.rescale=function(t){if(t instanceof Array)return void this.rescale2(t);for(var e=t.iterator();e.hasNext();){var o=e.next();this.rescale(o.getCoordinates())}},jsts.noding.ScaledNoder.prototype.rescale2=function(t){for(var e=0;e<t.length;e++)t[e].x=t[e].x/this.scaleFactor+this.offsetX,t[e].y=t[e].y/this.scaleFactor+this.offsetY},jsts.noding.IntersectionAdder=function(t){this.li=t},jsts.noding.IntersectionAdder.prototype=new jsts.noding.SegmentIntersector,jsts.noding.IntersectionAdder.constructor=jsts.noding.IntersectionAdder,jsts.noding.IntersectionAdder.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)},jsts.noding.IntersectionAdder.prototype._hasIntersection=!1,jsts.noding.IntersectionAdder.prototype.hasProper=!1,jsts.noding.IntersectionAdder.prototype.hasProperInterior=!1,jsts.noding.IntersectionAdder.prototype.hasInterior=!1,jsts.noding.IntersectionAdder.prototype.properIntersectionPoint=null,jsts.noding.IntersectionAdder.prototype.li=null,jsts.noding.IntersectionAdder.prototype.isSelfIntersection=null,jsts.noding.IntersectionAdder.prototype.numIntersections=0,jsts.noding.IntersectionAdder.prototype.numInteriorIntersections=0,jsts.noding.IntersectionAdder.prototype.numProperIntersections=0,jsts.noding.IntersectionAdder.prototype.numTests=0,jsts.noding.IntersectionAdder.prototype.getLineIntersector=function(){return this.li},jsts.noding.IntersectionAdder.prototype.getProperIntersectionPoint=function(){return this.properIntersectionPoint},jsts.noding.IntersectionAdder.prototype.hasIntersection=function(){return this._hasIntersection},jsts.noding.IntersectionAdder.prototype.hasProperIntersection=function(){return this.hasProper},jsts.noding.IntersectionAdder.prototype.hasProperInteriorIntersection=function(){return this.hasProperInterior},jsts.noding.IntersectionAdder.prototype.hasInteriorIntersection=function(){return this.hasInterior},jsts.noding.IntersectionAdder.prototype.isTrivialIntersection=function(t,e,o,n){if(t==o&&1==this.li.getIntersectionNum()){if(jsts.noding.IntersectionAdder.isAdjacentSegments(e,n))return!0;if(t.isClosed()){var i=t.size()-1;if(0===e&&n===i||0===n&&e===i)return!0}}return!1},jsts.noding.IntersectionAdder.prototype.processIntersections=function(t,e,o,n){if(t!==o||e!==n){this.numTests++;var i=t.getCoordinates()[e],r=t.getCoordinates()[e+1],s=o.getCoordinates()[n],a=o.getCoordinates()[n+1];this.li.computeIntersection(i,r,s,a),this.li.hasIntersection()&&(this.numIntersections++,this.li.isInteriorIntersection()&&(this.numInteriorIntersections++,this.hasInterior=!0),this.isTrivialIntersection(t,e,o,n)||(this._hasIntersection=!0,t.addIntersections(this.li,e,0),o.addIntersections(this.li,n,1),this.li.isProper()&&(this.numProperIntersections++,this.hasProper=!0,this.hasProperInterior=!0)))}},jsts.noding.IntersectionAdder.prototype.isDone=function(){return!1},jsts.triangulate.VoronoiDiagramBuilder=function(){this.siteCoords=null,this.tolerance=0,this.subdiv=null,this.clipEnv=null,this.diagramEnv=null},jsts.triangulate.VoronoiDiagramBuilder.prototype.setSites=function(){var t=arguments[0];t instanceof jsts.geom.Geometry||t instanceof jsts.geom.Coordinate||t instanceof jsts.geom.Point||t instanceof jsts.geom.MultiPoint||t instanceof jsts.geom.LineString||t instanceof jsts.geom.MultiLineString||t instanceof jsts.geom.LinearRing||t instanceof jsts.geom.Polygon||t instanceof jsts.geom.MultiPolygon?this.setSitesByGeometry(t):this.setSitesByArray(t)},jsts.triangulate.VoronoiDiagramBuilder.prototype.setSitesByGeometry=function(t){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.extractUniqueCoordinates(t)},jsts.triangulate.VoronoiDiagramBuilder.prototype.setSitesByArray=function(t){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.unique(t)},jsts.triangulate.VoronoiDiagramBuilder.prototype.setClipEnvelope=function(t){this.clipEnv=t},jsts.triangulate.VoronoiDiagramBuilder.prototype.setTolerance=function(t){this.tolerance=t},jsts.triangulate.VoronoiDiagramBuilder.prototype.create=function(){if(null===this.subdiv){var t,e,o,n;t=jsts.triangulate.DelaunayTriangulationBuilder.envelope(this.siteCoords),this.diagramEnv=t,e=Math.max(this.diagramEnv.getWidth(),this.diagramEnv.getHeight()),this.diagramEnv.expandBy(e),null!==this.clipEnv&&this.diagramEnv.expandToInclude(this.clipEnv),o=jsts.triangulate.DelaunayTriangulationBuilder.toVertices(this.siteCoords),this.subdiv=new jsts.triangulate.quadedge.QuadEdgeSubdivision(t,this.tolerance),n=new jsts.triangulate.IncrementalDelaunayTriangulator(this.subdiv),n.insertSites(o)}},jsts.triangulate.VoronoiDiagramBuilder.prototype.getSubdivision=function(){return this.create(),this.subdiv},jsts.triangulate.VoronoiDiagramBuilder.prototype.getDiagram=function(t){this.create();var e=this.subdiv.getVoronoiDiagram(t);return this.clipGeometryCollection(e,this.diagramEnv)},jsts.triangulate.VoronoiDiagramBuilder.prototype.clipGeometryCollection=function(t,e){var o,n,i,r,s,a;for(o=t.getFactory().toGeometry(e),n=[],i=0,r=t.getNumGeometries(),i;i<r;i++)s=t.getGeometryN(i),a=null,e.contains(s.getEnvelopeInternal())?a=s:e.intersects(s.getEnvelopeInternal())&&(a=o.intersection(s)),null===a||a.isEmpty()||n.push(a);return t.getFactory().createGeometryCollection(n)},jsts.operation.valid.IndexedNestedRingTester=function(t){this.graph=t,this.rings=new javascript.util.ArrayList,this.totalEnv=new jsts.geom.Envelope,this.index=null,this.nestedPt=null},jsts.operation.valid.IndexedNestedRingTester.prototype.getNestedPoint=function(){return this.nestedPt},jsts.operation.valid.IndexedNestedRingTester.prototype.add=function(t){this.rings.add(t),this.totalEnv.expandToInclude(t.getEnvelopeInternal())},jsts.operation.valid.IndexedNestedRingTester.prototype.isNonNested=function(){this.buildIndex();for(var t=0;t<this.rings.size();t++)for(var e=this.rings.get(t),o=e.getCoordinates(),n=this.index.query(e.getEnvelopeInternal()),i=0;i<n.length;i++){var r=n[i],s=r.getCoordinates();if(e!=r&&e.getEnvelopeInternal().intersects(r.getEnvelopeInternal())){var a=jsts.operation.valid.IsValidOp.findPtNotNode(o,r,this.graph);if(null!=a){var l=jsts.algorithm.CGAlgorithms.isPointInRing(a,s);if(l)return this.nestedPt=a,!1}}}return!0},jsts.operation.valid.IndexedNestedRingTester.prototype.buildIndex=function(){this.index=new jsts.index.strtree.STRtree;for(var t=0;t<this.rings.size();t++){var e=this.rings.get(t),o=e.getEnvelopeInternal();this.index.insert(o,e)}},jsts.noding.SegmentNode=function(t,e,o,n){this.segString=t,this.coord=new jsts.geom.Coordinate(e),this.segmentIndex=o,this.segmentOctant=n,this._isInterior=!e.equals2D(t.getCoordinate(o))},jsts.noding.SegmentNode.prototype.segString=null,jsts.noding.SegmentNode.prototype.coord=null,jsts.noding.SegmentNode.prototype.segmentIndex=null,jsts.noding.SegmentNode.prototype.segmentOctant=null,jsts.noding.SegmentNode.prototype._isInterior=null,jsts.noding.SegmentNode.prototype.getCoordinate=function(){return this.coord},jsts.noding.SegmentNode.prototype.isInterior=function(){return this._isInterior},jsts.noding.SegmentNode.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===this.maxSegmentIndex},jsts.noding.SegmentNode.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:jsts.noding.SegmentPointComparator.compare(this.segmentOctant,this.coord,e.coord)},function(){jsts.io.GeoJSONParser=function(t){this.geometryFactory=t||new jsts.geom.GeometryFactory,this.geometryTypes=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"]},jsts.io.GeoJSONParser.prototype.read=function(t){var e;e="string"==typeof t?JSON.parse(t):t;var o=e.type;if(!this.parse[o])throw new Error("Unknown GeoJSON type: "+e.type);return-1!=this.geometryTypes.indexOf(o)?this.parse[o].apply(this,[e.coordinates]):"GeometryCollection"===o?this.parse[o].apply(this,[e.geometries]):this.parse[o].apply(this,[e])},jsts.io.GeoJSONParser.prototype.parse={Feature:function(t){var e={};for(var o in t)e[o]=t[o];if(t.geometry){var n=t.geometry.type;if(!this.parse[n])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var o=0;o<t.features.length;++o)e.features.push(this.read(t.features[o]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],o=0;o<t.length;++o){var n=t[o];e.push(new jsts.geom.Coordinate(n[0],n[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new jsts.geom.Coordinate(t[0],t[1]),new jsts.geom.Coordinate(t[2],t[1]),new jsts.geom.Coordinate(t[2],t[3]),new jsts.geom.Coordinate(t[0],t[3]),new jsts.geom.Coordinate(t[0],t[1])])},Point:function(t){var e=new jsts.geom.Coordinate(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],o=0;o<t.length;++o)e.push(this.parse.Point.apply(this,[t[o]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=this.parse.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],o=0;o<t.length;++o)e.push(this.parse.LineString.apply(this,[t[o]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=this.parse.coordinates.apply(this,[t[0]]),o=this.geometryFactory.createLinearRing(e),n=[],i=1;i<t.length;++i){var r=t[i],s=this.parse.coordinates.apply(this,[r]),a=this.geometryFactory.createLinearRing(s);n.push(a)}return this.geometryFactory.createPolygon(o,n)},MultiPolygon:function(t){for(var e=[],o=0;o<t.length;++o){var n=t[o];e.push(this.parse.Polygon.apply(this,[n]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],o=0;o<t.length;++o){var n=t[o];e.push(this.read(n))}return this.geometryFactory.createGeometryCollection(e)}},jsts.io.GeoJSONParser.prototype.write=function(t){var e=t.CLASS_NAME.slice(10);if(!this.extract[e])throw new Error("Geometry is not supported");return this.extract[e].apply(this,[t])},jsts.io.GeoJSONParser.prototype.extract={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:this.extract.coordinate.apply(this,[t.coordinate])}},MultiPoint:function(t){for(var e=[],o=0;o<t.geometries.length;++o){var n=t.geometries[o],i=this.extract.Point.apply(this,[n]);e.push(i.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],o=0;o<t.points.length;++o){var n=t.points[o];e.push(this.extract.coordinate.apply(this,[n]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],o=0;o<t.geometries.length;++o){var n=t.geometries[o],i=this.extract.LineString.apply(this,[n]);e.push(i.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],o=this.extract.LineString.apply(this,[t.shell]);e.push(o.coordinates);for(var n=0;n<t.holes.length;++n){var i=t.holes[n],r=this.extract.LineString.apply(this,[i]);e.push(r.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],o=0;o<t.geometries.length;++o){var n=t.geometries[o],i=this.extract.Polygon.apply(this,[n]);e.push(i.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],o=0;o<t.geometries.length;++o){var n=t.geometries[o],i=n.CLASS_NAME.slice(10);e.push(this.extract[i].apply(this,[n]))}return{type:"GeometryCollection",geometries:e}}}}(),jsts.index.quadtree.Quadtree=function(){this.root=new jsts.index.quadtree.Root,this.minExtent=1},jsts.index.quadtree.Quadtree.ensureExtent=function(t,e){var o,n,i,r;return o=t.getMinX(),n=t.getMaxX(),i=t.getMinY(),r=t.getMaxY(),o!==n&&i!==r?t:(o===n&&(o-=e/2,n=o+e/2),i===r&&(i-=e/2,r=i+e/2),new jsts.geom.Envelope(o,n,i,r))},jsts.index.quadtree.Quadtree.prototype.depth=function(){return this.root.depth()},jsts.index.quadtree.Quadtree.prototype.size=function(){return this.root.size()},jsts.index.quadtree.Quadtree.prototype.insert=function(t,e){this.collectStats(t);var o=jsts.index.quadtree.Quadtree.ensureExtent(t,this.minExtent);this.root.insert(o,e)},jsts.index.quadtree.Quadtree.prototype.remove=function(t,e){var o=jsts.index.quadtree.Quadtree.ensureExtent(t,this.minExtent);return this.root.remove(o,e)},jsts.index.quadtree.Quadtree.prototype.query=function(){if(1===arguments.length)return jsts.index.quadtree.Quadtree.prototype.queryByEnvelope.apply(this,arguments);jsts.index.quadtree.Quadtree.prototype.queryWithVisitor.apply(this,arguments)},jsts.index.quadtree.Quadtree.prototype.queryByEnvelope=function(t){var e=new jsts.index.ArrayListVisitor;return this.query(t,e),e.getItems()},jsts.index.quadtree.Quadtree.prototype.queryWithVisitor=function(t,e){this.root.visit(t,e)},jsts.index.quadtree.Quadtree.prototype.queryAll=function(){var t=[];return t=this.root.addAllItems(t)},jsts.index.quadtree.Quadtree.prototype.collectStats=function(t){var e=t.getWidth();e<this.minExtent&&e>0&&(this.minExtent=e);var o=t.getHeight();o<this.minExtent&&o>0&&(this.minExtent=o)},jsts.operation.relate.RelateNodeFactory=function(){},jsts.operation.relate.RelateNodeFactory.prototype=new jsts.geomgraph.NodeFactory,jsts.operation.relate.RelateNodeFactory.prototype.createNode=function(t){return new jsts.operation.relate.RelateNode(t,new jsts.operation.relate.EdgeEndBundleStar)},jsts.index.quadtree.Key=function(t){this.pt=new jsts.geom.Coordinate,this.level=0,this.env=null,this.computeKey(t)},jsts.index.quadtree.Key.computeQuadLevel=function(t){var e,o,n;return e=t.getWidth(),o=t.getHeight(),n=e>o?e:o,jsts.index.DoubleBits.exponent(n)+1},jsts.index.quadtree.Key.prototype.getPoint=function(){return this.pt},jsts.index.quadtree.Key.prototype.getLevel=function(){return this.level},jsts.index.quadtree.Key.prototype.getEnvelope=function(){return this.env},jsts.index.quadtree.Key.prototype.getCentre=function(){var t,e;return t=(this.env.getMinX()+this.env.getMaxX())/2,e=(this.env.getMinY()+this.env.getMaxY())/2,new jsts.geom.Coordinate(t,e)},jsts.index.quadtree.Key.prototype.computeKey=function(){arguments[0]instanceof jsts.geom.Envelope?this.computeKeyFromEnvelope(arguments[0]):this.computeKeyFromLevel(arguments[0],arguments[1])},jsts.index.quadtree.Key.prototype.computeKeyFromEnvelope=function(t){for(this.level=jsts.index.quadtree.Key.computeQuadLevel(t),this.env=new jsts.geom.Envelope,this.computeKey(this.level,t);!this.env.contains(t);)this.level+=1,this.computeKey(this.level,t)},jsts.index.quadtree.Key.prototype.computeKeyFromLevel=function(t,e){var o=jsts.index.DoubleBits.powerOf2(t);this.pt.x=Math.floor(e.getMinX()/o)*o,this.pt.y=Math.floor(e.getMinY()/o)*o,this.env.init(this.pt.x,this.pt.x+o,this.pt.y,this.pt.y+o)},jsts.geom.CoordinateArrays=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.CoordinateArrays.removeRepeatedPoints=function(t){var e;return this.hasRepeatedPoints(t)?(e=new jsts.geom.CoordinateList(t,!1),e.toCoordinateArray()):t},jsts.geom.CoordinateArrays.hasRepeatedPoints=function(t){var e;for(e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},jsts.geom.CoordinateArrays.ptNotInList=function(t,e){for(var o=0;o<t.length;o++){var n=t[o];if(jsts.geom.CoordinateArrays.indexOf(n,e)<0)return n}return null},jsts.geom.CoordinateArrays.increasingDirection=function(t){for(var e=0;e<parseInt(t.length/2);e++){var o=t.length-1-e,n=t[e].compareTo(t[o]);if(0!=n)return n}return 1};jsts.geom.CoordinateArrays.minCoordinate=function(t){for(var e=null,o=0;o<t.length;o++)(null===e||e.compareTo(t[o])>0)&&(e=t[o]);return e},jsts.geom.CoordinateArrays.scroll=function(t,e){var o=jsts.geom.CoordinateArrays.indexOf(e,t);if(!(o<0)){var n=t.slice(o).concat(t.slice(0,o));for(o=0;o<n.length;o++)t[o]=n[o]}},jsts.geom.CoordinateArrays.indexOf=function(t,e){for(var o=0;o<e.length;o++)if(t.equals(e[o]))return o;return-1},jsts.operation.overlay.MinimalEdgeRing=function(t,e){jsts.geomgraph.EdgeRing.call(this,t,e)},jsts.operation.overlay.MinimalEdgeRing.prototype=new jsts.geomgraph.EdgeRing,jsts.operation.overlay.MinimalEdgeRing.constructor=jsts.operation.overlay.MinimalEdgeRing,jsts.operation.overlay.MinimalEdgeRing.prototype.getNext=function(t){return t.getNextMin()},jsts.operation.overlay.MinimalEdgeRing.prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},jsts.triangulate.DelaunayTriangulationBuilder=function(){this.siteCoords=null,this.tolerance=0,this.subdiv=null},jsts.triangulate.DelaunayTriangulationBuilder.extractUniqueCoordinates=function(t){if(void 0===t||null===t)return new jsts.geom.CoordinateList([],!1).toArray();var e=t.getCoordinates();return jsts.triangulate.DelaunayTriangulationBuilder.unique(e)},jsts.triangulate.DelaunayTriangulationBuilder.unique=function(t){return t.sort(function(t,e){return t.compareTo(e)}),new jsts.geom.CoordinateList(t,!1).toArray()},jsts.triangulate.DelaunayTriangulationBuilder.toVertices=function(t){var e,o=new Array(t.length),n=0,i=t.length;for(n;n<i;n++)e=t[n],o[n]=new jsts.triangulate.quadedge.Vertex(e);return o},jsts.triangulate.DelaunayTriangulationBuilder.envelope=function(t){var e=new jsts.geom.Envelope,o=0,n=t.length;for(o;o<n;o++)e.expandToInclude(t[o]);return e},jsts.triangulate.DelaunayTriangulationBuilder.prototype.setSites=function(){var t=arguments[0];t instanceof jsts.geom.Geometry||t instanceof jsts.geom.Coordinate||t instanceof jsts.geom.Point||t instanceof jsts.geom.MultiPoint||t instanceof jsts.geom.LineString||t instanceof jsts.geom.MultiLineString||t instanceof jsts.geom.LinearRing||t instanceof jsts.geom.Polygon||t instanceof jsts.geom.MultiPolygon?this.setSitesFromGeometry(t):this.setSitesFromCollection(t)},jsts.triangulate.DelaunayTriangulationBuilder.prototype.setSitesFromGeometry=function(t){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.extractUniqueCoordinates(t)},jsts.triangulate.DelaunayTriangulationBuilder.prototype.setSitesFromCollection=function(t){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.unique(t)},jsts.triangulate.DelaunayTriangulationBuilder.prototype.setTolerance=function(t){this.tolerance=t},jsts.triangulate.DelaunayTriangulationBuilder.prototype.create=function(){if(null===this.subdiv){var t,e,o;t=jsts.triangulate.DelaunayTriangulationBuilder.envelope(this.siteCoords),e=jsts.triangulate.DelaunayTriangulationBuilder.toVertices(this.siteCoords),this.subdiv=new jsts.triangulate.quadedge.QuadEdgeSubdivision(t,this.tolerance),o=new jsts.triangulate.IncrementalDelaunayTriangulator(this.subdiv),o.insertSites(e)}},jsts.triangulate.DelaunayTriangulationBuilder.prototype.getSubdivision=function(){return this.create(),this.subdiv},jsts.triangulate.DelaunayTriangulationBuilder.prototype.getEdges=function(t){return this.create(),this.subdiv.getEdges(t)},jsts.triangulate.DelaunayTriangulationBuilder.prototype.getTriangles=function(t){return this.create(),this.subdiv.getTriangles(t)},jsts.algorithm.RayCrossingCounter=function(t){this.p=t},jsts.algorithm.RayCrossingCounter.locatePointInRing=function(t,e){for(var o=new jsts.algorithm.RayCrossingCounter(t),n=1;n<e.length;n++){var i=e[n],r=e[n-1];if(o.countSegment(i,r),o.isOnSegment())return o.getLocation()}return o.getLocation()},jsts.algorithm.RayCrossingCounter.prototype.p=null,jsts.algorithm.RayCrossingCounter.prototype.crossingCount=0,jsts.algorithm.RayCrossingCounter.prototype.isPointOnSegment=!1,jsts.algorithm.RayCrossingCounter.prototype.countSegment=function(t,e){if(!(t.x<this.p.x&&e.x<this.p.x)){if(this.p.x==e.x&&this.p.y===e.y)return void(this.isPointOnSegment=!0);if(t.y===this.p.y&&e.y===this.p.y){var o=t.x,n=e.x;return o>n&&(o=e.x,n=t.x),void(this.p.x>=o&&this.p.x<=n&&(this.isPointOnSegment=!0))}if(t.y>this.p.y&&e.y<=this.p.y||e.y>this.p.y&&t.y<=this.p.y){var i=t.x-this.p.x,r=t.y-this.p.y,s=e.x-this.p.x,a=e.y-this.p.y,l=jsts.algorithm.RobustDeterminant.signOfDet2x2(i,r,s,a);if(0===l)return void(this.isPointOnSegment=!0);a<r&&(l=-l),l>0&&this.crossingCount++}}},jsts.algorithm.RayCrossingCounter.prototype.isOnSegment=function(){return jsts.geom.isPointOnSegment},jsts.algorithm.RayCrossingCounter.prototype.getLocation=function(){return this.isPointOnSegment?jsts.geom.Location.BOUNDARY:this.crossingCount%2==1?jsts.geom.Location.INTERIOR:jsts.geom.Location.EXTERIOR},jsts.algorithm.RayCrossingCounter.prototype.isPointInPolygon=function(){return this.getLocation()!==jsts.geom.Location.EXTERIOR},jsts.operation.BoundaryOp=function(t,e){this.geom=t,this.geomFact=t.getFactory(),this.bnRule=e||jsts.algorithm.BoundaryNodeRule.MOD2_BOUNDARY_RULE},jsts.operation.BoundaryOp.prototype.geom=null,jsts.operation.BoundaryOp.prototype.geomFact=null,jsts.operation.BoundaryOp.prototype.bnRule=null,jsts.operation.BoundaryOp.prototype.getBoundary=function(){return this.geom instanceof jsts.geom.LineString?this.boundaryLineString(this.geom):this.geom instanceof jsts.geom.MultiLineString?this.boundaryMultiLineString(this.geom):this.geom.getBoundary()},jsts.operation.BoundaryOp.prototype.getEmptyMultiPoint=function(){return this.geomFact.createMultiPoint(null)},jsts.operation.BoundaryOp.prototype.boundaryMultiLineString=function(t){if(this.geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1==e.length?this.geomFact.createPoint(e[0]):this.geomFact.createMultiPoint(e)},jsts.operation.BoundaryOp.prototype.endpoints=null,jsts.operation.BoundaryOp.prototype.computeBoundaryCoordinates=function(t){var e,o,n,i=[];for(this.endpoints=[],e=0;e<t.getNumGeometries();e++)o=t.getGeometryN(e),0!=o.getNumPoints()&&(this.addEndpoint(o.getCoordinateN(0)),this.addEndpoint(o.getCoordinateN(o.getNumPoints()-1)));for(e=0;e<this.endpoints.length;e++)n=this.endpoints[e],this.bnRule.isInBoundary(n.count)&&i.push(n.coordinate);return i},jsts.operation.BoundaryOp.prototype.addEndpoint=function(t){var e,o,n=!1;for(e=0;e<this.endpoints.length;e++)if(o=this.endpoints[e],o.coordinate.equals(t)){n=!0;break}n||(o={},o.coordinate=t,o.count=0,this.endpoints.push(o)),o.count++},jsts.operation.BoundaryOp.prototype.boundaryLineString=function(t){if(this.geom.isEmpty())return this.getEmptyMultiPoint();if(t.isClosed()){return this.bnRule.isInBoundary(2)?t.getStartPoint():this.geomFact.createMultiPoint(null)}return this.geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},jsts.operation.buffer.OffsetCurveSetBuilder=function(t,e,o){this.inputGeom=t,this.distance=e,this.curveBuilder=o,this.curveList=new javascript.util.ArrayList},jsts.operation.buffer.OffsetCurveSetBuilder.prototype.inputGeom=null,jsts.operation.buffer.OffsetCurveSetBuilder.prototype.distance=null,jsts.operation.buffer.OffsetCurveSetBuilder.prototype.curveBuilder=null,jsts.operation.buffer.OffsetCurveSetBuilder.prototype.curveList=null,jsts.operation.buffer.OffsetCurveSetBuilder.prototype.getCurves=function(){return this.add(this.inputGeom),this.curveList},jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addCurve=function(t,e,o){if(!(null==t||t.length<2)){var n=new jsts.noding.NodedSegmentString(t,new jsts.geomgraph.Label(0,jsts.geom.Location.BOUNDARY,e,o));this.curveList.add(n)}},jsts.operation.buffer.OffsetCurveSetBuilder.prototype.add=function(t){if(!t.isEmpty())if(t instanceof jsts.geom.Polygon)this.addPolygon(t);else if(t instanceof jsts.geom.LineString)this.addLineString(t);else if(t instanceof jsts.geom.Point)this.addPoint(t);else if(t instanceof jsts.geom.MultiPoint)this.addCollection(t);else if(t instanceof jsts.geom.MultiLineString)this.addCollection(t);else if(t instanceof jsts.geom.MultiPolygon)this.addCollection(t);else{if(!(t instanceof jsts.geom.GeometryCollection))throw new jsts.error.IllegalArgumentError;this.addCollection(t)}},jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var o=t.getGeometryN(e);this.add(o)}},jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addPoint=function(t){if(!(this.distance<=0)){var e=t.getCoordinates(),o=this.curveBuilder.getLineCurve(e,this.distance);this.addCurve(o,jsts.geom.Location.EXTERIOR,jsts.geom.Location.INTERIOR)}},jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addLineString=function(t){if(!(this.distance<=0)||this.curveBuilder.getBufferParameters().isSingleSided()){var e=jsts.geom.CoordinateArrays.removeRepeatedPoints(t.getCoordinates()),o=this.curveBuilder.getLineCurve(e,this.distance);this.addCurve(o,jsts.geom.Location.EXTERIOR,jsts.geom.Location.INTERIOR)}},jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addPolygon=function(t){var e=this.distance,o=jsts.geomgraph.Position.LEFT;this.distance<0&&(e=-this.distance,o=jsts.geomgraph.Position.RIGHT);var n=t.getExteriorRing(),i=jsts.geom.CoordinateArrays.removeRepeatedPoints(n.getCoordinates());if(!(this.distance<0&&this.isErodedCompletely(n,this.distance)||this.distance<=0&&i.length<3)){this.addPolygonRing(i,e,o,jsts.geom.Location.EXTERIOR,jsts.geom.Location.INTERIOR);for(var r=0;r<t.getNumInteriorRing();r++){var s=t.getInteriorRingN(r),a=jsts.geom.CoordinateArrays.removeRepeatedPoints(s.getCoordinates());this.distance>0&&this.isErodedCompletely(s,-this.distance)||this.addPolygonRing(a,e,jsts.geomgraph.Position.opposite(o),jsts.geom.Location.INTERIOR,jsts.geom.Location.EXTERIOR)}}},jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addPolygonRing=function(t,e,o,n,i){if(!(0==e&&t.length<jsts.geom.LinearRing.MINIMUM_VALID_SIZE)){var r=n,s=i;t.length>=jsts.geom.LinearRing.MINIMUM_VALID_SIZE&&jsts.algorithm.CGAlgorithms.isCCW(t)&&(r=i,s=n,o=jsts.geomgraph.Position.opposite(o));var a=this.curveBuilder.getRingCurve(t,o,e);this.addCurve(a,r,s)}},jsts.operation.buffer.OffsetCurveSetBuilder.prototype.isErodedCompletely=function(t,e){var o=t.getCoordinates();if(o.length<4)return e<0;if(4==o.length)return this.isTriangleErodedCompletely(o,e);var n=t.getEnvelopeInternal(),i=Math.min(n.getHeight(),n.getWidth());return e<0&&2*Math.abs(e)>i},jsts.operation.buffer.OffsetCurveSetBuilder.prototype.isTriangleErodedCompletely=function(t,e){var o=new jsts.geom.Triangle(t[0],t[1],t[2]),n=o.inCentre();return jsts.algorithm.CGAlgorithms.distancePointLine(n,o.p0,o.p1)<Math.abs(e)},jsts.operation.buffer.BufferSubgraph=function(){this.dirEdgeList=new javascript.util.ArrayList,this.nodes=new javascript.util.ArrayList,this.finder=new jsts.operation.buffer.RightmostEdgeFinder},jsts.operation.buffer.BufferSubgraph.prototype.finder=null,jsts.operation.buffer.BufferSubgraph.prototype.dirEdgeList=null,jsts.operation.buffer.BufferSubgraph.prototype.nodes=null,jsts.operation.buffer.BufferSubgraph.prototype.rightMostCoord=null,jsts.operation.buffer.BufferSubgraph.prototype.env=null,jsts.operation.buffer.BufferSubgraph.prototype.getDirectedEdges=function(){return this.dirEdgeList},jsts.operation.buffer.BufferSubgraph.prototype.getNodes=function(){return this.nodes},jsts.operation.buffer.BufferSubgraph.prototype.getEnvelope=function(){if(null===this.env){for(var t=new jsts.geom.Envelope,e=this.dirEdgeList.iterator();e.hasNext();)for(var o=e.next(),n=o.getEdge().getCoordinates(),i=0;i<n.length-1;i++)t.expandToInclude(n[i]);this.env=t}return this.env},jsts.operation.buffer.BufferSubgraph.prototype.getRightmostCoordinate=function(){return this.rightMostCoord},jsts.operation.buffer.BufferSubgraph.prototype.create=function(t){this.addReachable(t),this.finder.findEdge(this.dirEdgeList),this.rightMostCoord=this.finder.getCoordinate()},jsts.operation.buffer.BufferSubgraph.prototype.addReachable=function(t){var e=[];for(e.push(t);0!==e.length;){var o=e.pop();this.add(o,e)}},jsts.operation.buffer.BufferSubgraph.prototype.add=function(t,e){t.setVisited(!0),this.nodes.add(t);for(var o=t.getEdges().iterator();o.hasNext();){var n=o.next();this.dirEdgeList.add(n);var i=n.getSym(),r=i.getNode();r.isVisited()||e.push(r)}},jsts.operation.buffer.BufferSubgraph.prototype.clearVisitedEdges=function(){for(var t=this.dirEdgeList.iterator();t.hasNext();){t.next().setVisited(!1)}},jsts.operation.buffer.BufferSubgraph.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this.finder.getEdge();e.getNode(),e.getLabel();e.setEdgeDepths(jsts.geomgraph.Position.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},jsts.operation.buffer.BufferSubgraph.prototype.computeDepths=function(t){var e=[],o=[],n=t.getNode();for(o.push(n),e.push(n),t.setVisited(!0);0!==o.length;){var i=o.shift();e.push(i),this.computeNodeDepth(i);for(var r=i.getEdges().iterator();r.hasNext();){var s=r.next(),a=s.getSym();if(!a.isVisited()){var l=a.getNode();-1===e.indexOf(l)&&(o.push(l),e.push(l))}}}},jsts.operation.buffer.BufferSubgraph.prototype.computeNodeDepth=function(t){for(var e=null,o=t.getEdges().iterator();o.hasNext();){var n=o.next();if(n.isVisited()||n.getSym().isVisited()){e=n;break}}if(null==e)throw new jsts.error.TopologyError("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var o=t.getEdges().iterator();o.hasNext();){var n=o.next();n.setVisited(!0),this.copySymDepths(n)}},jsts.operation.buffer.BufferSubgraph.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(jsts.geomgraph.Position.LEFT,t.getDepth(jsts.geomgraph.Position.RIGHT)),e.setDepth(jsts.geomgraph.Position.RIGHT,t.getDepth(jsts.geomgraph.Position.LEFT))},jsts.operation.buffer.BufferSubgraph.prototype.findResultEdges=function(){for(var t=this.dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(jsts.geomgraph.Position.RIGHT)>=1&&e.getDepth(jsts.geomgraph.Position.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},jsts.operation.buffer.BufferSubgraph.prototype.compareTo=function(t){var e=t;return this.rightMostCoord.x<e.rightMostCoord.x?-1:this.rightMostCoord.x>e.rightMostCoord.x?1:0},jsts.geom.util.GeometryExtracter=function(t,e){this.clz=t,this.comps=e},jsts.geom.util.GeometryExtracter.prototype=new jsts.geom.GeometryFilter,jsts.geom.util.GeometryExtracter.prototype.clz=null,jsts.geom.util.GeometryExtracter.prototype.comps=null,jsts.geom.util.GeometryExtracter.extract=function(t,e,o){return o=o||new javascript.util.ArrayList,t instanceof e?o.add(t):(t instanceof jsts.geom.GeometryCollection||t instanceof jsts.geom.MultiPoint||t instanceof jsts.geom.MultiLineString||t instanceof jsts.geom.MultiPolygon)&&t.apply(new jsts.geom.util.GeometryExtracter(e,o)),o},jsts.geom.util.GeometryExtracter.prototype.filter=function(t){(null===this.clz||t instanceof this.clz)&&this.comps.add(t)},function(){var t=jsts.operation.overlay.OverlayOp,e=jsts.operation.overlay.snap.SnapOverlayOp,o=function(t,e){this.geom=[],this.geom[0]=t,this.geom[1]=e};o.overlayOp=function(t,e,n){return new o(t,e).getResultGeometry(n)},o.intersection=function(e,o){return overlayOp(e,o,t.INTERSECTION)},o.union=function(e,o){return overlayOp(e,o,t.UNION)},o.difference=function(e,o){return overlayOp(e,o,t.DIFFERENCE)},o.symDifference=function(e,o){return overlayOp(e,o,t.SYMDIFFERENCE)},o.prototype.geom=null,o.prototype.getResultGeometry=function(o){var n=null,i=!1,r=null;try{n=t.overlayOp(this.geom[0],this.geom[1],o);i=!0}catch(t){r=t}if(!i)try{n=e.overlayOp(this.geom[0],this.geom[1],o)}catch(t){throw r}return n},jsts.operation.overlay.snap.SnapIfNeededOverlayOp=o}(),function(){var t=jsts.geom.util.GeometryExtracter,e=jsts.operation.union.CascadedPolygonUnion,o=jsts.operation.union.PointGeometryUnion,n=jsts.operation.overlay.OverlayOp,i=jsts.operation.overlay.snap.SnapIfNeededOverlayOp,r=javascript.util.ArrayList;jsts.operation.union.UnaryUnionOp=function(t,e){this.polygons=new r,this.lines=new r,this.points=new r,e&&(this.geomFact=e),this.extract(t)},jsts.operation.union.UnaryUnionOp.union=function(t,e){return new jsts.operation.union.UnaryUnionOp(t,e).union()},jsts.operation.union.UnaryUnionOp.prototype.polygons=null,jsts.operation.union.UnaryUnionOp.prototype.lines=null,jsts.operation.union.UnaryUnionOp.prototype.points=null,jsts.operation.union.UnaryUnionOp.prototype.geomFact=null,jsts.operation.union.UnaryUnionOp.prototype.extract=function(e){if(e instanceof r)for(var o=e.iterator();o.hasNext();){var n=o.next();this.extract(n)}else null===this.geomFact&&(this.geomFact=e.getFactory()),t.extract(e,jsts.geom.Polygon,this.polygons),t.extract(e,jsts.geom.LineString,this.lines),t.extract(e,jsts.geom.Point,this.points)},jsts.operation.union.UnaryUnionOp.prototype.union=function(){if(null===this.geomFact)return null;var t=null;if(this.points.size()>0){var n=this.geomFact.buildGeometry(this.points);t=this.unionNoOpt(n)}var i=null;if(this.lines.size()>0){var r=this.geomFact.buildGeometry(this.lines);i=this.unionNoOpt(r)}var s=null;this.polygons.size()>0&&(s=e.union(this.polygons));var a=this.unionWithNull(i,s),l=null;return l=null===t?a:null===a?t:o(t,a),null===l?this.geomFact.createGeometryCollection(null):l},jsts.operation.union.UnaryUnionOp.prototype.unionWithNull=function(t,e){return null===t&&null===e?null:null===e?t:null===t?e:t.union(e)},jsts.operation.union.UnaryUnionOp.prototype.unionNoOpt=function(t){var e=this.geomFact.createPoint(null);return i.overlayOp(t,e,n.UNION)}}(),jsts.index.kdtree.KdNode=function(){this.left=null,this.right=null,this.count=1,2===arguments.length?this.initializeFromCoordinate.apply(this,arguments[0],arguments[1]):3===arguments.length&&this.initializeFromXY.apply(this,arguments[0],arguments[1],arguments[2])},jsts.index.kdtree.KdNode.prototype.initializeFromXY=function(t,e,o){this.p=new jsts.geom.Coordinate(t,e),this.data=o},jsts.index.kdtree.KdNode.prototype.initializeFromCoordinate=function(t,e){this.p=t,this.data=e},jsts.index.kdtree.KdNode.prototype.getX=function(){return this.p.x},jsts.index.kdtree.KdNode.prototype.getY=function(){return this.p.y},jsts.index.kdtree.KdNode.prototype.getCoordinate=function(){return this.p},jsts.index.kdtree.KdNode.prototype.getData=function(){return this.data},jsts.index.kdtree.KdNode.prototype.getLeft=function(){return this.left},jsts.index.kdtree.KdNode.prototype.getRight=function(){return this.right},jsts.index.kdtree.KdNode.prototype.increment=function(){this.count+=1},jsts.index.kdtree.KdNode.prototype.getCount=function(){return this.count},jsts.index.kdtree.KdNode.prototype.isRepeated=function(){return count>1},jsts.index.kdtree.KdNode.prototype.setLeft=function(t){this.left=t},jsts.index.kdtree.KdNode.prototype.setRight=function(t){this.right=t},function(){jsts.geom.MultiLineString=function(t,e){this.geometries=t||[],this.factory=e},jsts.geom.MultiLineString.prototype=new jsts.geom.GeometryCollection,jsts.geom.MultiLineString.constructor=jsts.geom.MultiLineString,jsts.geom.MultiLineString.prototype.getBoundary=function(){return new jsts.operation.BoundaryOp(this).getBoundary()},jsts.geom.MultiLineString.prototype.equalsExact=function(t,e){return!!this.isEquivalentClass(t)&&jsts.geom.GeometryCollection.prototype.equalsExact.call(this,t,e)},jsts.geom.MultiLineString.prototype.CLASS_NAME="jsts.geom.MultiLineString"}(),jsts.operation.buffer.BufferParameters=function(t,e,o,n){t&&this.setQuadrantSegments(t),e&&this.setEndCapStyle(e),o&&this.setJoinStyle(o),n&&this.setMitreLimit(n)},jsts.operation.buffer.BufferParameters.CAP_ROUND=1,jsts.operation.buffer.BufferParameters.CAP_FLAT=2,jsts.operation.buffer.BufferParameters.CAP_SQUARE=3,jsts.operation.buffer.BufferParameters.JOIN_ROUND=1,jsts.operation.buffer.BufferParameters.JOIN_MITRE=2,jsts.operation.buffer.BufferParameters.JOIN_BEVEL=3,jsts.operation.buffer.BufferParameters.DEFAULT_QUADRANT_SEGMENTS=8,jsts.operation.buffer.BufferParameters.DEFAULT_MITRE_LIMIT=5,jsts.operation.buffer.BufferParameters.prototype.quadrantSegments=jsts.operation.buffer.BufferParameters.DEFAULT_QUADRANT_SEGMENTS,jsts.operation.buffer.BufferParameters.prototype.endCapStyle=jsts.operation.buffer.BufferParameters.CAP_ROUND,jsts.operation.buffer.BufferParameters.prototype.joinStyle=jsts.operation.buffer.BufferParameters.JOIN_ROUND,jsts.operation.buffer.BufferParameters.prototype.mitreLimit=jsts.operation.buffer.BufferParameters.DEFAULT_MITRE_LIMIT,jsts.operation.buffer.BufferParameters.prototype._isSingleSided=!1,jsts.operation.buffer.BufferParameters.prototype.getQuadrantSegments=function(){return this.quadrantSegments},jsts.operation.buffer.BufferParameters.prototype.setQuadrantSegments=function(t){this.quadrantSegments=t},jsts.operation.buffer.BufferParameters.prototype.setQuadrantSegments=function(t){this.quadrantSegments=t,0===this.quadrantSegments&&(this.joinStyle=jsts.operation.buffer.BufferParameters.JOIN_BEVEL),this.quadrantSegments<0&&(this.joinStyle=jsts.operation.buffer.BufferParameters.JOIN_MITRE,this.mitreLimit=Math.abs(this.quadrantSegments)),t<=0&&(this.quadrantSegments=1),this.joinStyle!==jsts.operation.buffer.BufferParameters.JOIN_ROUND&&(this.quadrantSegments=jsts.operation.buffer.BufferParameters.DEFAULT_QUADRANT_SEGMENTS)},jsts.operation.buffer.BufferParameters.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},jsts.operation.buffer.BufferParameters.prototype.getEndCapStyle=function(){return this.endCapStyle},jsts.operation.buffer.BufferParameters.prototype.setEndCapStyle=function(t){this.endCapStyle=t},jsts.operation.buffer.BufferParameters.prototype.getJoinStyle=function(){return this.joinStyle},jsts.operation.buffer.BufferParameters.prototype.setJoinStyle=function(t){this.joinStyle=t},jsts.operation.buffer.BufferParameters.prototype.getMitreLimit=function(){return this.mitreLimit},jsts.operation.buffer.BufferParameters.prototype.setMitreLimit=function(t){this.mitreLimit=t},jsts.operation.buffer.BufferParameters.prototype.setSingleSided=function(t){this._isSingleSided=t},jsts.operation.buffer.BufferParameters.prototype.isSingleSided=function(){return this._isSingleSided},jsts.operation.buffer.BufferBuilder=function(t){this.bufParams=t,this.edgeList=new jsts.geomgraph.EdgeList},jsts.operation.buffer.BufferBuilder.depthDelta=function(t){var e=t.getLocation(0,jsts.geomgraph.Position.LEFT),o=t.getLocation(0,jsts.geomgraph.Position.RIGHT);return e===jsts.geom.Location.INTERIOR&&o===jsts.geom.Location.EXTERIOR?1:e===jsts.geom.Location.EXTERIOR&&o===jsts.geom.Location.INTERIOR?-1:0},jsts.operation.buffer.BufferBuilder.prototype.bufParams=null,jsts.operation.buffer.BufferBuilder.prototype.workingPrecisionModel=null,jsts.operation.buffer.BufferBuilder.prototype.workingNoder=null,jsts.operation.buffer.BufferBuilder.prototype.geomFact=null,jsts.operation.buffer.BufferBuilder.prototype.graph=null,jsts.operation.buffer.BufferBuilder.prototype.edgeList=null,jsts.operation.buffer.BufferBuilder.prototype.setWorkingPrecisionModel=function(t){this.workingPrecisionModel=t},jsts.operation.buffer.BufferBuilder.prototype.setNoder=function(t){this.workingNoder=t},jsts.operation.buffer.BufferBuilder.prototype.buffer=function(t,e){var o=this.workingPrecisionModel;null===o&&(o=t.getPrecisionModel()),this.geomFact=t.getFactory();var n=new jsts.operation.buffer.OffsetCurveBuilder(o,this.bufParams),i=new jsts.operation.buffer.OffsetCurveSetBuilder(t,e,n),r=i.getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,o),this.graph=new jsts.geomgraph.PlanarGraph(new jsts.operation.overlay.OverlayNodeFactory),this.graph.addEdges(this.edgeList.getEdges());var s=this.createSubgraphs(this.graph),a=new jsts.operation.overlay.PolygonBuilder(this.geomFact);this.buildSubgraphs(s,a);var l=a.getPolygons();return l.size()<=0?this.createEmptyResultGeometry():this.geomFact.buildGeometry(l)},jsts.operation.buffer.BufferBuilder.prototype.getNoder=function(t){if(null!==this.workingNoder)return this.workingNoder;var e=new jsts.noding.MCIndexNoder,o=new jsts.algorithm.RobustLineIntersector;return o.setPrecisionModel(t),e.setSegmentIntersector(new jsts.noding.IntersectionAdder(o)),e},jsts.operation.buffer.BufferBuilder.prototype.computeNodedEdges=function(t,e){var o=this.getNoder(e);o.computeNodes(t);for(var n=o.getNodedSubstrings(),i=n.iterator();i.hasNext();){var r=i.next(),s=r.getData(),a=new jsts.geomgraph.Edge(r.getCoordinates(),new jsts.geomgraph.Label(s));this.insertUniqueEdge(a)}},jsts.operation.buffer.BufferBuilder.prototype.insertUniqueEdge=function(t){var e=this.edgeList.findEqualEdge(t);if(null!=e){var o=e.getLabel(),n=t.getLabel();e.isPointwiseEqual(t)||(n=new jsts.geomgraph.Label(t.getLabel()),n.flip()),o.merge(n);var i=jsts.operation.buffer.BufferBuilder.depthDelta(n),r=e.getDepthDelta(),s=r+i;e.setDepthDelta(s)}else this.edgeList.add(t),t.setDepthDelta(jsts.operation.buffer.BufferBuilder.depthDelta(t.getLabel()))},jsts.operation.buffer.BufferBuilder.prototype.createSubgraphs=function(t){for(var e=[],o=t.getNodes().iterator();o.hasNext();){var n=o.next();if(!n.isVisited()){var i=new jsts.operation.buffer.BufferSubgraph;i.create(n),e.push(i)}}var r=function(t,e){return t.compareTo(e)};return e.sort(r),e.reverse(),e},jsts.operation.buffer.BufferBuilder.prototype.buildSubgraphs=function(t,e){for(var o=[],n=0;n<t.length;n++){var i=t[n],r=i.getRightmostCoordinate(),s=new jsts.operation.buffer.SubgraphDepthLocater(o),a=s.getDepth(r);i.computeDepth(a),i.findResultEdges(),o.push(i),e.add(i.getDirectedEdges(),i.getNodes())}},jsts.operation.buffer.BufferBuilder.convertSegStrings=function(t){for(var e=new jsts.geom.GeometryFactory,o=new javascript.util.ArrayList;t.hasNext();){var n=t.next(),i=e.createLineString(n.getCoordinates());o.add(i)}return e.buildGeometry(o)},jsts.operation.buffer.BufferBuilder.prototype.createEmptyResultGeometry=function(){return this.geomFact.createPolygon(null,null)},jsts.noding.SegmentPointComparator=function(){},jsts.noding.SegmentPointComparator.compare=function(t,e,o){if(e.equals2D(o))return 0;var n=jsts.noding.SegmentPointComparator.relativeSign(e.x,o.x),i=jsts.noding.SegmentPointComparator.relativeSign(e.y,o.y);switch(t){case 0:return jsts.noding.SegmentPointComparator.compareValue(n,i);case 1:return jsts.noding.SegmentPointComparator.compareValue(i,n);case 2:return jsts.noding.SegmentPointComparator.compareValue(i,-n);case 3:return jsts.noding.SegmentPointComparator.compareValue(-n,i);case 4:return jsts.noding.SegmentPointComparator.compareValue(-n,-i);case 5:return jsts.noding.SegmentPointComparator.compareValue(-i,-n);case 6:return jsts.noding.SegmentPointComparator.compareValue(-i,n);case 7:return jsts.noding.SegmentPointComparator.compareValue(n,-i)}return 0},jsts.noding.SegmentPointComparator.relativeSign=function(t,e){return t<e?-1:t>e?1:0},jsts.noding.SegmentPointComparator.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0},jsts.operation.relate.EdgeEndBundle=function(){this.edgeEnds=[];var t=arguments[0]instanceof jsts.geomgraph.EdgeEnd?arguments[0]:arguments[1],e=t.getEdge(),o=t.getCoordinate(),n=t.getDirectedCoordinate(),i=new jsts.geomgraph.Label(t.getLabel());jsts.geomgraph.EdgeEnd.call(this,e,o,n,i),this.insert(t)},jsts.operation.relate.EdgeEndBundle.prototype=new jsts.geomgraph.EdgeEnd,jsts.operation.relate.EdgeEndBundle.prototype.edgeEnds=null,jsts.operation.relate.EdgeEndBundle.prototype.getLabel=function(){return this.label},jsts.operation.relate.EdgeEndBundle.prototype.getEdgeEnds=function(){return this.edgeEnds},jsts.operation.relate.EdgeEndBundle.prototype.insert=function(t){this.edgeEnds.push(t)},jsts.operation.relate.EdgeEndBundle.prototype.computeLabel=function(t){for(var e=!1,o=0;o<this.edgeEnds.length;o++){this.edgeEnds[o].getLabel().isArea()&&(e=!0)}this.label=e?new jsts.geomgraph.Label(jsts.geom.Location.NONE,jsts.geom.Location.NONE,jsts.geom.Location.NONE):new jsts.geomgraph.Label(jsts.geom.Location.NONE);for(var o=0;o<2;o++)this.computeLabelOn(o,t),e&&this.computeLabelSides(o)},jsts.operation.relate.EdgeEndBundle.prototype.computeLabelOn=function(t,e){for(var o=0,n=!1,i=0;i<this.edgeEnds.length;i++){var r=this.edgeEnds[i],s=r.getLabel().getLocation(t);s==jsts.geom.Location.BOUNDARY&&o++,s==jsts.geom.Location.INTERIOR&&(n=!0)}var s=jsts.geom.Location.NONE;n&&(s=jsts.geom.Location.INTERIOR),o>0&&(s=jsts.geomgraph.GeometryGraph.determineBoundary(e,o)),this.label.setLocation(t,s)},jsts.operation.relate.EdgeEndBundle.prototype.computeLabelSides=function(t){this.computeLabelSide(t,jsts.geomgraph.Position.LEFT),this.computeLabelSide(t,jsts.geomgraph.Position.RIGHT)},jsts.operation.relate.EdgeEndBundle.prototype.computeLabelSide=function(t,e){for(var o=0;o<this.edgeEnds.length;o++){var n=this.edgeEnds[o];if(n.getLabel().isArea()){var i=n.getLabel().getLocation(t,e);if(i===jsts.geom.Location.INTERIOR)return void this.label.setLocation(t,e,jsts.geom.Location.INTERIOR);i===jsts.geom.Location.EXTERIOR&&this.label.setLocation(t,e,jsts.geom.Location.EXTERIOR)}}},jsts.operation.relate.EdgeEndBundle.prototype.updateIM=function(t){jsts.geomgraph.Edge.updateIM(this.label,t)},jsts.index.chain.MonotoneChain=function(t,e,o,n){this.pts=t,this.start=e,this.end=o,this.context=n},jsts.index.chain.MonotoneChain.prototype.pts=null,jsts.index.chain.MonotoneChain.prototype.start=null,jsts.index.chain.MonotoneChain.prototype.end=null,jsts.index.chain.MonotoneChain.prototype.env=null,jsts.index.chain.MonotoneChain.prototype.context=null,jsts.index.chain.MonotoneChain.prototype.id=null,jsts.index.chain.MonotoneChain.prototype.setId=function(t){this.id=t},jsts.index.chain.MonotoneChain.prototype.getId=function(){return this.id},jsts.index.chain.MonotoneChain.prototype.getContext=function(){return this.context},jsts.index.chain.MonotoneChain.prototype.getEnvelope=function(){if(null==this.env){var t=this.pts[this.start],e=this.pts[this.end];this.env=new jsts.geom.Envelope(t,e)}return this.env},jsts.index.chain.MonotoneChain.prototype.getStartIndex=function(){return this.start},jsts.index.chain.MonotoneChain.prototype.getEndIndex=function(){return this.end},jsts.index.chain.MonotoneChain.prototype.getLineSegment=function(t,e){e.p0=this.pts[t],e.p1=this.pts[t+1]},jsts.index.chain.MonotoneChain.prototype.getCoordinates=function(){for(var t=[],e=0,o=this.start;o<=this.end;o++)t[e++]=this.pts[o];return t},jsts.index.chain.MonotoneChain.prototype.select=function(t,e){this.computeSelect2(t,this.start,this.end,e)},jsts.index.chain.MonotoneChain.prototype.computeSelect2=function(t,e,o,n){var i=this.pts[e],r=this.pts[o];if(n.tempEnv1.init(i,r),o-e==1)return void n.select(this,e);if(t.intersects(n.tempEnv1)){var s=parseInt((e+o)/2);e<s&&this.computeSelect2(t,e,s,n),s<o&&this.computeSelect2(t,s,o,n)}},jsts.index.chain.MonotoneChain.prototype.computeOverlaps=function(t,e){if(6===arguments.length)return this.computeOverlaps2.apply(this,arguments);this.computeOverlaps2(this.start,this.end,t,t.start,t.end,e)},jsts.index.chain.MonotoneChain.prototype.computeOverlaps2=function(t,e,o,n,i,r){var s=this.pts[t],a=this.pts[e],l=o.pts[n],c=o.pts[i];if(e-t==1&&i-n==1)return void r.overlap(this,t,o,n);if(r.tempEnv1.init(s,a),r.tempEnv2.init(l,c),r.tempEnv1.intersects(r.tempEnv2)){var u=parseInt((t+e)/2),h=parseInt((n+i)/2);t<u&&(n<h&&this.computeOverlaps2(t,u,o,n,h,r),h<i&&this.computeOverlaps2(t,u,o,h,i,r)),u<e&&(n<h&&this.computeOverlaps2(u,e,o,n,h,r),h<i&&this.computeOverlaps2(u,e,o,h,i,r))}},jsts.algorithm.HCoordinate=function(){this.x=0,this.y=0,this.w=1,1===arguments.length?this.initFrom1Coordinate(arguments[0]):2===arguments.length&&arguments[0]instanceof jsts.geom.Coordinate?this.initFrom2Coordinates(arguments[0],arguments[1]):2===arguments.length&&arguments[0]instanceof jsts.algorithm.HCoordinate?this.initFrom2HCoordinates(arguments[0],arguments[1]):2===arguments.length?this.initFromXY(arguments[0],arguments[1]):3===arguments.length?this.initFromXYW(arguments[0],arguments[1],arguments[2]):4===arguments.length&&this.initFromXYW(arguments[0],arguments[1],arguments[2],arguments[3])},jsts.algorithm.HCoordinate.intersection=function(t,e,o,n){var i,r,s,a,l,c,u,h,g,p,d;if(i=t.y-e.y,r=e.x-t.x,s=t.x*e.y-e.x*t.y,a=o.y-n.y,l=n.x-o.x,c=o.x*n.y-n.x*o.y,u=r*c-l*s,h=a*s-i*c,g=i*l-a*r,p=u/g,d=h/g,!isFinite(p)||!isFinite(d))throw new jsts.error.NotRepresentableError;return new jsts.geom.Coordinate(p,d)},jsts.algorithm.HCoordinate.prototype.initFrom1Coordinate=function(t){this.x=t.x,this.y=t.y,this.w=1},jsts.algorithm.HCoordinate.prototype.initFrom2Coordinates=function(t,e){this.x=t.y-e.y,this.y=e.x-t.x,this.w=t.x*e.y-e.x*t.y},jsts.algorithm.HCoordinate.prototype.initFrom2HCoordinates=function(t,e){this.x=t.y*e.w-e.y*t.w,this.y=e.x*t.w-t.x*e.w,this.w=t.x*e.y-e.x*t.y},jsts.algorithm.HCoordinate.prototype.initFromXYW=function(t,e,o){this.x=t,this.y=e,this.w=o},jsts.algorithm.HCoordinate.prototype.initFromXY=function(t,e){this.x=t,this.y=e,this.w=1},jsts.algorithm.HCoordinate.prototype.initFrom4Coordinates=function(t,e,o,n){var i,r,s,a,l,c;i=t.y-e.y,r=e.x-t.x,s=t.x*e.y-e.x*t.y,a=o.y-n.y,l=n.x-o.x,c=o.x*n.y-n.x*o.y,this.x=r*c-l*s,this.y=a*s-i*c,this.w=i*l-a*r},jsts.algorithm.HCoordinate.prototype.getX=function(){var t=this.x/this.w;if(!isFinite(t))throw new jsts.error.NotRepresentableError;return t},jsts.algorithm.HCoordinate.prototype.getY=function(){var t=this.y/this.w;if(!isFinite(t))throw new jsts.error.NotRepresentableError;return t},jsts.algorithm.HCoordinate.prototype.getCoordinate=function(){var t=new jsts.geom.Coordinate;return t.x=this.getX(),t.y=this.getY(),t},function(){var t=jsts.geom.Location,e=jsts.geom.Dimension;jsts.geom.IntersectionMatrix=function(o){var n=o;void 0===o||null===o?(this.matrix=[[],[],[]],this.setAll(e.FALSE)):"string"==typeof o?this.set(o):n instanceof jsts.geom.IntersectionMatrix&&(this.matrix[t.INTERIOR][t.INTERIOR]=n.matrix[t.INTERIOR][t.INTERIOR],this.matrix[t.INTERIOR][t.BOUNDARY]=n.matrix[t.INTERIOR][t.BOUNDARY],this.matrix[t.INTERIOR][t.EXTERIOR]=n.matrix[t.INTERIOR][t.EXTERIOR],this.matrix[t.BOUNDARY][t.INTERIOR]=n.matrix[t.BOUNDARY][t.INTERIOR],this.matrix[t.BOUNDARY][t.BOUNDARY]=n.matrix[t.BOUNDARY][t.BOUNDARY],this.matrix[t.BOUNDARY][t.EXTERIOR]=n.matrix[t.BOUNDARY][t.EXTERIOR],this.matrix[t.EXTERIOR][t.INTERIOR]=n.matrix[t.EXTERIOR][t.INTERIOR],this.matrix[t.EXTERIOR][t.BOUNDARY]=n.matrix[t.EXTERIOR][t.BOUNDARY],this.matrix[t.EXTERIOR][t.EXTERIOR]=n.matrix[t.EXTERIOR][t.EXTERIOR])},jsts.geom.IntersectionMatrix.prototype.matrix=null,jsts.geom.IntersectionMatrix.prototype.add=function(t){var e,o;for(e=0;e<3;e++)for(o=0;o<3;o++)this.setAtLeast(e,o,t.get(e,o))},jsts.geom.IntersectionMatrix.matches=function(t,o){return"string"==typeof t?jsts.geom.IntersectionMatrix.matches2.call(this,arguments):"*"===o||("T"===o&&(t>=0||t===e.TRUE)||("F"===o&&t===e.FALSE||("0"===o&&t===e.P||("1"===o&&t===e.L||"2"===o&&t===e.A))))},jsts.geom.IntersectionMatrix.matches2=function(t,e){return new jsts.geom.IntersectionMatrix(t).matches(e)},jsts.geom.IntersectionMatrix.prototype.set=function(t,e,o){if("string"==typeof t)return void this.set2(t);this.matrix[t][e]=o},jsts.geom.IntersectionMatrix.prototype.set2=function(t){for(var o=0;o<t.length();o++){var n=o/3,i=o%3;this.matrix[n][i]=e.toDimensionValue(t.charAt(o))}},jsts.geom.IntersectionMatrix.prototype.setAtLeast=function(t,e,o){if(1===arguments.length)return void this.setAtLeast2(arguments[0]);this.matrix[t][e]<o&&(this.matrix[t][e]=o)},jsts.geom.IntersectionMatrix.prototype.setAtLeastIfValid=function(t,e,o){t>=0&&e>=0&&this.setAtLeast(t,e,o)},jsts.geom.IntersectionMatrix.prototype.setAtLeast2=function(t){var e;for(e=0;e<t.length;e++){var o=parseInt(e/3),n=parseInt(e%3);this.setAtLeast(o,n,jsts.geom.Dimension.toDimensionValue(t.charAt(e)))}},jsts.geom.IntersectionMatrix.prototype.setAll=function(t){var e,o;for(e=0;e<3;e++)for(o=0;o<3;o++)this.matrix[e][o]=t},jsts.geom.IntersectionMatrix.prototype.get=function(t,e){return this.matrix[t][e]},jsts.geom.IntersectionMatrix.prototype.isDisjoint=function(){return this.matrix[t.INTERIOR][t.INTERIOR]===e.FALSE&&this.matrix[t.INTERIOR][t.BOUNDARY]===e.FALSE&&this.matrix[t.BOUNDARY][t.INTERIOR]===e.FALSE&&this.matrix[t.BOUNDARY][t.BOUNDARY]===e.FALSE},jsts.geom.IntersectionMatrix.prototype.isIntersects=function(){return!this.isDisjoint()},jsts.geom.IntersectionMatrix.prototype.isTouches=function(o,n){return o>n?this.isTouches(n,o):(o==e.A&&n==e.A||o==e.L&&n==e.L||o==e.L&&n==e.A||o==e.P&&n==e.A||o==e.P&&n==e.L)&&(this.matrix[t.INTERIOR][t.INTERIOR]===e.FALSE&&(jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.BOUNDARY],"T")||jsts.geom.IntersectionMatrix.matches(this.matrix[t.BOUNDARY][t.INTERIOR],"T")||jsts.geom.IntersectionMatrix.matches(this.matrix[t.BOUNDARY][t.BOUNDARY],"T")))},jsts.geom.IntersectionMatrix.prototype.isCrosses=function(o,n){return o==e.P&&n==e.L||o==e.P&&n==e.A||o==e.L&&n==e.A?jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.INTERIOR],"T")&&jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.EXTERIOR],"T"):o==e.L&&n==e.P||o==e.A&&n==e.P||o==e.A&&n==e.L?jsts.geom.IntersectionMatrix.matches(matrix[t.INTERIOR][t.INTERIOR],"T")&&jsts.geom.IntersectionMatrix.matches(this.matrix[t.EXTERIOR][t.INTERIOR],"T"):o===e.L&&n===e.L&&0===this.matrix[t.INTERIOR][t.INTERIOR]},jsts.geom.IntersectionMatrix.prototype.isWithin=function(){return jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.INTERIOR],"T")&&this.matrix[t.INTERIOR][t.EXTERIOR]==e.FALSE&&this.matrix[t.BOUNDARY][t.EXTERIOR]==e.FALSE},jsts.geom.IntersectionMatrix.prototype.isContains=function(){return jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.INTERIOR],"T")&&this.matrix[t.EXTERIOR][t.INTERIOR]==e.FALSE&&this.matrix[t.EXTERIOR][t.BOUNDARY]==e.FALSE},jsts.geom.IntersectionMatrix.prototype.isCovers=function(){return(jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.INTERIOR],"T")||jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.BOUNDARY],"T")||jsts.geom.IntersectionMatrix.matches(this.matrix[t.BOUNDARY][t.INTERIOR],"T")||jsts.geom.IntersectionMatrix.matches(this.matrix[t.BOUNDARY][t.BOUNDARY],"T"))&&this.matrix[t.EXTERIOR][t.INTERIOR]==e.FALSE&&this.matrix[t.EXTERIOR][t.BOUNDARY]==e.FALSE},jsts.geom.IntersectionMatrix.prototype.isCoveredBy=function(){return(jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.INTERIOR],"T")||jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.BOUNDARY],"T")||jsts.geom.IntersectionMatrix.matches(this.matrix[t.BOUNDARY][t.INTERIOR],"T")||jsts.geom.IntersectionMatrix.matches(this.matrix[t.BOUNDARY][t.BOUNDARY],"T"))&&this.matrix[t.INTERIOR][t.EXTERIOR]===e.FALSE&&this.matrix[t.BOUNDARY][t.EXTERIOR]===e.FALSE},jsts.geom.IntersectionMatrix.prototype.isEquals=function(o,n){return o===n&&(jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.INTERIOR],"T")&&this.matrix[t.EXTERIOR][t.INTERIOR]===e.FALSE&&this.matrix[t.INTERIOR][t.EXTERIOR]===e.FALSE&&this.matrix[t.EXTERIOR][t.BOUNDARY]===e.FALSE&&this.matrix[t.BOUNDARY][t.EXTERIOR]===e.FALSE)},jsts.geom.IntersectionMatrix.prototype.isOverlaps=function(o,n){return o==e.P&&n===e.P||o==e.A&&n===e.A?jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.INTERIOR],"T")&&jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.EXTERIOR],"T")&&jsts.geom.IntersectionMatrix.matches(this.matrix[t.EXTERIOR][t.INTERIOR],"T"):o===e.L&&n===e.L&&(1==this.matrix[t.INTERIOR][t.INTERIOR]&&jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.EXTERIOR],"T")&&jsts.geom.IntersectionMatrix.matches(this.matrix[t.EXTERIOR][t.INTERIOR],"T"))},jsts.geom.IntersectionMatrix.prototype.matches=function(t){if(9!=t.length)throw new jsts.error.IllegalArgumentException("Should be length 9: "+t);for(var e=0;e<3;e++)for(var o=0;o<3;o++)if(!jsts.geom.IntersectionMatrix.matches(this.matrix[e][o],t.charAt(3*e+o)))return!1;return!0},jsts.geom.IntersectionMatrix.prototype.transpose=function(){var t=matrix[1][0];return this.matrix[1][0]=this.matrix[0][1],this.matrix[0][1]=t,t=this.matrix[2][0],this.matrix[2][0]=this.matrix[0][2],this.matrix[0][2]=t,t=this.matrix[2][1],this.matrix[2][1]=this.matrix[1][2],this.matrix[1][2]=t,this},jsts.geom.IntersectionMatrix.prototype.toString=function(){var t,o,n="";for(t=0;t<3;t++)for(o=0;o<3;o++)n+=e.toDimensionSymbol(this.matrix[t][o]);return n}}(),jsts.triangulate.quadedge.LastFoundQuadEdgeLocator=function(t){this.subdiv=t,this.lastEdge=null,this.init()},jsts.triangulate.quadedge.LastFoundQuadEdgeLocator.prototype.init=function(){this.lastEdge=this.findEdge()},jsts.triangulate.quadedge.LastFoundQuadEdgeLocator.prototype.findEdge=function(){return this.subdiv.getEdges()[0]},jsts.triangulate.quadedge.LastFoundQuadEdgeLocator.prototype.locate=function(t){this.lastEdge.isLive()||this.init();var e=this.subdiv.locateFromEdge(t,this.lastEdge);return this.lastEdge=e,e},function(){var t=jsts.geom.Location,e=jsts.geomgraph.Position,o=jsts.geomgraph.EdgeEndStar,n=jsts.util.Assert;jsts.geomgraph.DirectedEdgeStar=function(){jsts.geomgraph.EdgeEndStar.call(this)},jsts.geomgraph.DirectedEdgeStar.prototype=new o,jsts.geomgraph.DirectedEdgeStar.constructor=jsts.geomgraph.DirectedEdgeStar,jsts.geomgraph.DirectedEdgeStar.prototype.resultAreaEdgeList=null,jsts.geomgraph.DirectedEdgeStar.prototype.label=null,jsts.geomgraph.DirectedEdgeStar.prototype.insert=function(t){var e=t;this.insertEdgeEnd(e,e)},jsts.geomgraph.DirectedEdgeStar.prototype.getLabel=function(){return this.label},jsts.geomgraph.DirectedEdgeStar.prototype.getOutgoingDegree=function(){for(var t=0,e=this.iterator();e.hasNext();){e.next().isInResult()&&t++}return t},jsts.geomgraph.DirectedEdgeStar.prototype.getOutgoingDegree=function(t){for(var e=0,o=this.iterator();o.hasNext();){o.next().getEdgeRing()===t&&e++}return e},jsts.geomgraph.DirectedEdgeStar.prototype.getRightmostEdge=function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var o=t.get(0);if(1==e)return o;var i=t.get(e-1),r=o.getQuadrant(),s=i.getQuadrant();if(jsts.geomgraph.Quadrant.isNorthern(r)&&jsts.geomgraph.Quadrant.isNorthern(s))return o;if(!jsts.geomgraph.Quadrant.isNorthern(r)&&!jsts.geomgraph.Quadrant.isNorthern(s))return i;return 0!=o.getDy()?o:0!=i.getDy()?i:(n.shouldNeverReachHere("found two horizontal edges incident on node"),null)},jsts.geomgraph.DirectedEdgeStar.prototype.computeLabelling=function(e){o.prototype.computeLabelling.call(this,e),this.label=new jsts.geomgraph.Label(t.NONE);for(var n=this.iterator();n.hasNext();)for(var i=n.next(),r=i.getEdge(),s=r.getLabel(),a=0;a<2;a++){var l=s.getLocation(a);l!==t.INTERIOR&&l!==t.BOUNDARY||this.label.setLocation(a,t.INTERIOR)}},jsts.geomgraph.DirectedEdgeStar.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},jsts.geomgraph.DirectedEdgeStar.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var o=e.next(),n=o.getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}},jsts.geomgraph.DirectedEdgeStar.prototype.getResultAreaEdges=function(){if(null!==this.resultAreaEdgeList)return this.resultAreaEdgeList;this.resultAreaEdgeList=new javascript.util.ArrayList;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this.resultAreaEdgeList.add(e)}return this.resultAreaEdgeList},jsts.geomgraph.DirectedEdgeStar.prototype.SCANNING_FOR_INCOMING=1,jsts.geomgraph.DirectedEdgeStar.prototype.LINKING_TO_OUTGOING=2,jsts.geomgraph.DirectedEdgeStar.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var t=null,e=null,o=this.SCANNING_FOR_INCOMING,i=0;i<this.resultAreaEdgeList.size();i++){var r=this.resultAreaEdgeList.get(i),s=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),o){case this.SCANNING_FOR_INCOMING:if(!s.isInResult())continue;e=s,o=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),o=this.SCANNING_FOR_INCOMING}}if(o===this.LINKING_TO_OUTGOING){if(null===t)throw new jsts.error.TopologyError("no outgoing dirEdge found",this.getCoordinate());n.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},jsts.geomgraph.DirectedEdgeStar.prototype.linkMinimalDirectedEdges=function(t){for(var e=null,o=null,i=this.SCANNING_FOR_INCOMING,r=this.resultAreaEdgeList.size()-1;r>=0;r--){var s=this.resultAreaEdgeList.get(r),a=s.getSym();switch(null===e&&s.getEdgeRing()===t&&(e=s),i){case this.SCANNING_FOR_INCOMING:if(a.getEdgeRing()!=t)continue;o=a,i=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(s.getEdgeRing()!==t)continue;o.setNextMin(s),i=this.SCANNING_FOR_INCOMING}}i===this.LINKING_TO_OUTGOING&&(n.isTrue(null!==e,"found null for first outgoing dirEdge"),n.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),o.setNextMin(e))},jsts.geomgraph.DirectedEdgeStar.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,o=this.edgeList.size()-1;o>=0;o--){var n=this.edgeList.get(o),i=n.getSym();null===e&&(e=i),null!==t&&i.setNext(t),t=n}e.setNext(t)},jsts.geomgraph.DirectedEdgeStar.prototype.findCoveredLineEdges=function(){for(var e=t.NONE,o=this.iterator();o.hasNext();){var n=o.next(),i=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){e=t.INTERIOR;break}if(i.isInResult()){e=t.EXTERIOR;break}}}if(e!==t.NONE)for(var r=e,o=this.iterator();o.hasNext();){var n=o.next(),i=n.getSym();n.isLineEdge()?n.getEdge().setCovered(r===t.INTERIOR):(n.isInResult()&&(r=t.EXTERIOR),i.isInResult()&&(r=t.INTERIOR))}},jsts.geomgraph.DirectedEdgeStar.prototype.computeDepths=function(t){if(2===arguments.length)return void this.computeDepths2.apply(this,arguments);var o=this.findIndex(t),n=(t.getLabel(),t.getDepth(e.LEFT)),i=t.getDepth(e.RIGHT),r=this.computeDepths2(o+1,this.edgeList.size(),n);if(this.computeDepths2(0,o,r)!=i)throw new jsts.error.TopologyError("depth mismatch at "+t.getCoordinate())},jsts.geomgraph.DirectedEdgeStar.prototype.computeDepths2=function(t,o,n){for(var i=n,r=t;r<o;r++){var s=this.edgeList.get(r);s.getLabel();s.setEdgeDepths(e.RIGHT,i),i=s.getDepth(e.LEFT)}return i}}(),jsts.io.WKTReader=function(t){this.geometryFactory=t||new jsts.geom.GeometryFactory,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new jsts.io.WKTParser(this.geometryFactory)},jsts.io.WKTReader.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===jsts.geom.PrecisionModel.FIXED&&this.reducePrecision(e),e},jsts.io.WKTReader.prototype.reducePrecision=function(t){var e,o;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,o=t.points.length;e<o;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,o=t.geometries.length;e<o;e++)this.reducePrecision(t.geometries[e])},jsts.triangulate.quadedge.QuadEdgeSubdivision=function(t,e){this.tolerance=e,this.edgeCoincidenceTolerance=e/jsts.triangulate.quadedge.QuadEdgeSubdivision.EDGE_COINCIDENCE_TOL_FACTOR,this.visitedKey=0,this.quadEdges=[],this.startingEdge,this.tolerance,this.edgeCoincidenceTolerance,this.frameEnv,this.locator=null,this.seg=new jsts.geom.LineSegment,this.triEdges=new Array(3),this.frameVertex=new Array(3),this.createFrame(t),this.startingEdge=this.initSubdiv(),this.locator=new jsts.triangulate.quadedge.LastFoundQuadEdgeLocator(this)},jsts.triangulate.quadedge.QuadEdgeSubdivision.EDGE_COINCIDENCE_TOL_FACTOR=1e3,jsts.triangulate.quadedge.QuadEdgeSubdivision.getTriangleEdges=function(t,e){if(e[0]=t,e[1]=e[0].lNext(),e[2]=e[1].lNext(),e[2].lNext()!=e[0])throw new jsts.IllegalArgumentError("Edges do not form a triangle")};jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.createFrame=function(t){var e,o,n;e=t.getWidth(),o=t.getHeight(),n=0,n=e>o?10*e:10*o,this.frameVertex[0]=new jsts.triangulate.quadedge.Vertex((t.getMaxX()+t.getMinX())/2,t.getMaxY()+n),this.frameVertex[1]=new jsts.triangulate.quadedge.Vertex(t.getMinX()-n,t.getMinY()-n),this.frameVertex[2]=new jsts.triangulate.quadedge.Vertex(t.getMaxX()+n,t.getMinY()-n),this.frameEnv=new jsts.geom.Envelope(this.frameVertex[0].getCoordinate(),this.frameVertex[1].getCoordinate()),this.frameEnv.expandToInclude(this.frameVertex[2].getCoordinate())},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.initSubdiv=function(){var t,e,o;return t=this.makeEdge(this.frameVertex[0],this.frameVertex[1]),e=this.makeEdge(this.frameVertex[1],this.frameVertex[2]),jsts.triangulate.quadedge.QuadEdge.splice(t.sym(),e),o=this.makeEdge(this.frameVertex[2],this.frameVertex[0]),jsts.triangulate.quadedge.QuadEdge.splice(e.sym(),o),jsts.triangulate.quadedge.QuadEdge.splice(o.sym(),t),t},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTolerance=function(){return this.tolerance},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getEnvelope=function(){return new jsts.geom.Envelope(this.frameEnv)},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getEdges=function(){return arguments.length>0?this.getEdgesByFactory(arguments[0]):this.quadEdges},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.setLocator=function(t){this.locator=t},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.makeEdge=function(t,e){var o=jsts.triangulate.quadedge.QuadEdge.makeEdge(t,e);return this.quadEdges.push(o),o},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.connect=function(t,e){var o=jsts.triangulate.quadedge.QuadEdge.connect(t,e);return this.quadEdges.push(o),o},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.delete_jsts=function(t){jsts.triangulate.quadedge.QuadEdge.splice(t,t.oPrev()),jsts.triangulate.quadedge.QuadEdge.splice(t.sym(),t.sym().oPrev());var e,o,n;t.eSym=t.sym(),o=t.rot,n=t.rot.sym();var i=this.quadEdges.indexOf(t);-1!==i&&this.quadEdges.splice(i,1),i=this.quadEdges.indexOf(e),-1!==i&&this.quadEdges.splice(i,1),i=this.quadEdges.indexOf(o),-1!==i&&this.quadEdges.splice(i,1),i=this.quadEdges.indexOf(n),-1!==i&&this.quadEdges.splice(i,1),t.delete_jsts(),e.delete_jsts(),o.delete_jsts(),n.delete_jsts()},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateFromEdge=function(t,e){var o,n=0,i=this.quadEdges.length;for(o=e;;){if(++n>i)throw new jsts.error.LocateFailureError(o.toLineSegment());if(t.equals(o.orig())||t.equals(o.dest()))break;if(t.rightOf(o))o=o.sym();else if(t.rightOf(o.oNext())){if(t.rightOf(o.dPrev()))break;o=o.dPrev()}else o=o.oNext()}return o},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locate=function(){return 1===arguments.length?arguments[0]instanceof jsts.triangulate.quadedge.Vertex?this.locateByVertex(arguments[0]):this.locateByCoordinate(arguments[0]):this.locateByCoordinates(arguments[0],arguments[1])},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateByVertex=function(t){return this.locator.locate(t)},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateByCoordinate=function(t){return this.locator.locate(new jsts.triangulate.quadedge.Vertex(t))},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateByCoordinates=function(t,e){var o,n,i,o=this.locator.locate(new jsts.triangulate.quadedge.Vertex(t));if(null===o)return null;n=o,o.dest().getCoordinate().equals2D(t)&&(n=o.sym()),i=n;do{if(i.dest().getCoordinate().equals2D(e))return i;i=i.oNext()}while(i!=n);return null},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.insertSite=function(t){var e,o,n;if(e=this.locate(t),t.equals(e.orig(),this.tolerance)||t.equals(e.dest(),this.tolerance))return e;o=this.makeEdge(e.orig(),t),jsts.triangulate.quadedge.QuadEdge.splice(o,e),n=o;do{o=this.connect(e,o.sym()),e=o.oPrev()}while(e.lNext()!=n);return n},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isFrameEdge=function(t){return!(!this.isFrameVertex(t.orig())&&!this.isFrameVertex(t.dest()))},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isFrameBorderEdge=function(t){var e,o,n,i;return e=new Array(3),this.getTriangleEdges(t,e),o=new Array(3),this.getTriangleEdges(t.sym(),o),n=t.lNext().dest(),!!this.isFrameVertex(n)||(i=t.sym().lNext().dest(),!!this.isFrameVertex(i))},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isFrameVertex=function(t){return!!t.equals(this.frameVertex[0])||(!!t.equals(this.frameVertex[1])||!!t.equals(this.frameVertex[2]))},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isOnEdge=function(t,e){return this.seg.setCoordinates(t.orig().getCoordinate(),t.dest().getCoordinate()),this.seg.distance(e)<this.edgeCoincidenceTolerance},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isVertexOfEdge=function(t,e){return!(!e.equals(t.orig(),this.tolerance)&&!e.equals(t.dest(),this.tolerance))},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVertices=function(t){var e,o,n,i,r,s=[];for(e=0,o=this.quadEdges.length,e;e<o;e++)n=this.quadEdges[e],i=n.orig(),!t&&this.isFrameVertex(i)||s.push(i),r=n.dest(),!t&&this.isFrameVertex(r)||s.push(r);return s},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVertexUniqueEdges=function(t){var e,o,n,i,r,s,a,l;for(e=[],o=[],n=0,i=this.quadEdges.length,n;n<i;n++)r=this.quadEdges[n],s=r.orig(),-1===o.indexOf(s)&&(o.push(s),!t&&this.isFrameVertex(s)||e.push(r)),a=r.sym(),l=a.orig(),-1===o.indexOf(l)&&(o.push(l),!t&&this.isFrameVertex(l)||e.push(a));return e},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getPrimaryEdges=function(t){this.visitedKey++;var e,o,n,i,r;for(e=[],o=[],o.push(this.startingEdge),n=[];o.length>0;)i=o.pop(),-1===n.indexOf(i)&&(r=i.getPrimary(),!t&&this.isFrameEdge(r)||e.push(r),o.push(i.oNext()),o.push(i.sym().oNext()),n.push(i),n.push(i.sym()));return e},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.visitTriangles=function(t,e){this.visitedKey++;var o,n,i,r;for(o=[],o.push(this.startingEdge),n=[];o.length>0;)i=o.pop(),-1===n.indexOf(i)&&null!==(r=this.fetchTriangleToVisit(i,o,e,n))&&t.visit(r)},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.fetchTriangleToVisit=function(t,e,o,n){var i,r,s,a;i=t,r=0,s=!1;do{this.triEdges[r]=i,this.isFrameEdge(i)&&(s=!0),a=i.sym(),-1===n.indexOf(a)&&e.push(a),n.push(i),r++,i=i.lNext()}while(i!==t);return s&&!o?null:this.triEdges},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangleEdges=function(t){var e=new jsts.triangulate.quadedge.TriangleEdgesListVisitor;return this.visitTriangles(e,t),e.getTriangleEdges()},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangleVertices=function(t){var e=new TriangleVertexListVisitor;return this.visitTriangles(e,t),e.getTriangleVertices()},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangleCoordinates=function(t){var e=new jsts.triangulate.quadedge.TriangleCoordinatesVisitor;return this.visitTriangles(e,t),e.getTriangles()},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getEdgesByFactory=function(t){var e,o,n,i,r,s;for(e=this.getPrimaryEdges(!1),o=[],n=0,i=e.length,n;n<i;n++)r=e[n],s=[],s[0]=r.orig().getCoordinate(),s[1]=r.dest().getCoordinate(),o[n]=t.createLineString(s);return t.createMultiLineString(o)},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangles=function(t){var e,o,n,i,r;for(e=this.getTriangleCoordinates(!1),o=new Array(e.length),i=0,r=e.length,i;i<r;i++)n=e[i],o[i]=t.createPolygon(t.createLinearRing(n,null));return t.createGeometryCollection(o)},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVoronoiDiagram=function(t){var e=this.getVoronoiCellPolygons(t);return t.createGeometryCollection(e)},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVoronoiCellPolygons=function(t){this.visitTriangles(new jsts.triangulate.quadedge.TriangleCircumcentreVisitor,!0);var e,o,n,i,r;for(e=[],o=this.getVertexUniqueEdges(!1),n=0,i=o.length,n;n<i;n++)r=o[n],e.push(this.getVoronoiCellPolygon(r,t));return e},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVoronoiCellPolygon=function(t,e){var o,n,i,r;o=[],startQE=t;do{n=t.rot.orig().getCoordinate(),o.push(n),t=t.oPrev()}while(t!==startQE);return i=new jsts.geom.CoordinateList([],!1),i.add(o,!1),i.closeRing(),i.size()<4&&i.add(i.get(i.size()-1),!0),r=e.createPolygon(e.createLinearRing(i.toArray()),null),startQE.orig(),r},jsts.triangulate.quadedge.TriangleCircumcentreVisitor=function(){},jsts.triangulate.quadedge.TriangleCircumcentreVisitor.prototype.visit=function(t){var e,o,n,i,r,s;for(e=t[0].orig().getCoordinate(),o=t[1].orig().getCoordinate(),n=t[2].orig().getCoordinate(),i=jsts.geom.Triangle.circumcentre(e,o,n),r=new jsts.triangulate.quadedge.Vertex(i),s=0;s<3;s++)t[s].rot.setOrig(r)},jsts.triangulate.quadedge.TriangleEdgesListVisitor=function(){this.triList=[]},jsts.triangulate.quadedge.TriangleEdgesListVisitor.prototype.visit=function(t){var e=t.concat();this.triList.push(e)},jsts.triangulate.quadedge.TriangleEdgesListVisitor.prototype.getTriangleEdges=function(){return this.triList},jsts.triangulate.quadedge.TriangleVertexListVisitor=function(){this.triList=[]},jsts.triangulate.quadedge.TriangleVertexListVisitor.prototype.visit=function(t){var e=[];e.push(trieEdges[0].orig()),e.push(trieEdges[1].orig()),e.push(trieEdges[2].orig()),this.triList.push(e)},jsts.triangulate.quadedge.TriangleVertexListVisitor.prototype.getTriangleVertices=function(){return this.triList},jsts.triangulate.quadedge.TriangleCoordinatesVisitor=function(){this.coordList=new jsts.geom.CoordinateList([],!1),this.triCoords=[]},jsts.triangulate.quadedge.TriangleCoordinatesVisitor.prototype.visit=function(t){this.coordList=new jsts.geom.CoordinateList([],!1);var e,o,n=0;for(n;n<3;n++)e=t[n].orig(),this.coordList.add(e.getCoordinate());if(this.coordList.size()>0){if(this.coordList.closeRing(),o=this.coordList.toArray(),4!==o.length)return;this.triCoords.push(o)}},jsts.triangulate.quadedge.TriangleCoordinatesVisitor.prototype.getTriangles=function(){return this.triCoords},jsts.index.kdtree.KdTree=function(t){var e=0;void 0!==t&&(e=t),this.root=null,this.last=null,this.numberOfNodes=0,this.tolerance=e},jsts.index.kdtree.KdTree.prototype.insert=function(){return 1===arguments.length?this.insertCoordinate.apply(this,arguments[0]):this.insertWithData.apply(this,arguments[0],arguments[1])},jsts.index.kdtree.KdTree.prototype.insertCoordinate=function(t){return this.insertWithData(t,null)},jsts.index.kdtree.KdTree.prototype.insertWithData=function(t,e){if(null===this.root)return this.root=new jsts.index.kdtree.KdNode(t,e),this.root;for(var o=this.root,n=this.root,i=!0,r=!0;o!==last;){if(r=i?t.x<o.getX():t.y<o.getY(),n=o,null!==(o=r?o.getLeft():o.getRight())){if(t.distance(o.getCoordinate())<=this.tolerance)return o.increment(),o}i=!i}this.numberOfNodes=numberOfNodes+1;var s=new jsts.index.kdtree.KdNode(t,e);return s.setLeft(this.last),s.setRight(this.last),r?n.setLeft(s):n.setRight(s),s},jsts.index.kdtree.KdTree.prototype.queryNode=function(t,e,o,n,i){if(t!==e){var r,s,a;n?(r=o.getMinX(),s=o.getMaxX(),a=t.getX()):(r=o.getMinY(),s=o.getMaxY(),a=t.getY());var l=r<a,c=a<=s;l&&this.queryNode(t.getLeft(),e,o,!n,i),o.contains(t.getCoordinate())&&i.add(t),c&&this.queryNode(t.getRight(),e,o,!n,i)}},jsts.index.kdtree.KdTree.prototype.query=function(){return 1===arguments.length?this.queryByEnvelope.apply(this,arguments[0]):this.queryWithArray.apply(this,arguments[0],arguments[1])},jsts.index.kdtree.KdTree.prototype.queryByEnvelope=function(t){var e=[];return this.queryNode(this.root,this.last,t,!0,e),e},jsts.index.kdtree.KdTree.prototype.queryWithArray=function(t,e){this.queryNode(this.root,this.last,t,!0,e)},jsts.operation.relate.RelateOp=function(){jsts.operation.GeometryGraphOperation.apply(this,arguments),this._relate=new jsts.operation.relate.RelateComputer(this.arg)},jsts.operation.relate.RelateOp.prototype=new jsts.operation.GeometryGraphOperation,jsts.operation.relate.RelateOp.relate=function(t,e,o){return new jsts.operation.relate.RelateOp(t,e,o).getIntersectionMatrix()},jsts.operation.relate.RelateOp.prototype._relate=null,jsts.operation.relate.RelateOp.prototype.getIntersectionMatrix=function(){return this._relate.computeIM()},jsts.geom.Triangle=function(t,e,o){this.p0=t,this.p1=e,this.p2=o},jsts.geom.Triangle.isAcute=function(t,e,o){return!!jsts.algorithm.Angle.isAcute(t,e,o)&&(!!jsts.algorithm.Angle.isAcute(e,o,t)&&!!jsts.algorithm.Angle.isAcute(o,t,e))},jsts.geom.Triangle.perpendicularBisector=function(t,e){var o,n,i,r;return o=e.x-t.x,n=e.y-t.y,i=new jsts.algorithm.HCoordinate(t.x+o/2,t.y+n/2,1),r=new jsts.algorithm.HCoordinate(t.x-n+o/2,t.y+o+n/2,1),new jsts.algorithm.HCoordinate(i,r)},jsts.geom.Triangle.circumcentre=function(t,e,o){var n,i,r,s,a,l,c,u,h,g,p;return n=o.x,i=o.y,r=t.x-n,s=t.y-i,a=e.x-n,l=e.y-i,c=2*jsts.geom.Triangle.det(r,s,a,l),u=jsts.geom.Triangle.det(s,r*r+s*s,l,a*a+l*l),h=jsts.geom.Triangle.det(r,r*r+s*s,a,a*a+l*l),g=n-u/c,p=i+h/c,new jsts.geom.Coordinate(g,p)},jsts.geom.Triangle.det=function(t,e,o,n){return t*n-e*o},jsts.geom.Triangle.inCentre=function(t,e,o){var n,i,r,s,a,l;return n=e.distance(o),i=t.distance(o),r=t.distance(e),s=n+i+r,a=(n*t.x+i*e.x+r*o.x)/s,l=(n*t.y+i*e.y+r*o.y)/s,new jsts.geom.Coordinate(a,l)},jsts.geom.Triangle.centroid=function(t,e,o){var n,i;return n=(t.x+e.x+o.x)/3,i=(t.y+e.y+o.y)/3,new jsts.geom.Coordinate(n,i)},jsts.geom.Triangle.longestSideLength=function(t,e,o){var n,i,r,s;return n=t.distance(e),i=e.distance(o),r=o.distance(t),s=n,i>s&&(s=i),r>s&&(s=r),s},jsts.geom.Triangle.angleBisector=function(t,e,o){var n,i,r,s,a;return n=e.distance(t),i=e.distance(o),r=n/(n+i),s=o.x-t.x,a=o.y-t.y,new jsts.geom.Coordinate(t.x+r*s,t.y+r*a)},jsts.geom.Triangle.area=function(t,e,o){return Math.abs(((o.x-t.x)*(e.y-t.y)-(e.x-t.x)*(o.y-t.y))/2)},jsts.geom.Triangle.signedArea=function(t,e,o){return((o.x-t.x)*(e.y-t.y)-(e.x-t.x)*(o.y-t.y))/2},jsts.geom.Triangle.prototype.inCentre=function(){return jsts.geom.Triangle.inCentre(this.p0,this.p1,this.p2)},jsts.algorithm.CentroidArea=function(){this.basePt=null,this.triangleCent3=new jsts.geom.Coordinate,this.centSum=new jsts.geom.Coordinate,this.cg3=new jsts.geom.Coordinate},jsts.algorithm.CentroidArea.prototype.basePt=null,jsts.algorithm.CentroidArea.prototype.triangleCent3=null,jsts.algorithm.CentroidArea.prototype.areasum2=0,jsts.algorithm.CentroidArea.prototype.cg3=null,jsts.algorithm.CentroidArea.prototype.centSum=null,jsts.algorithm.CentroidArea.prototype.totalLength=0,jsts.algorithm.CentroidArea.prototype.add=function(t){if(t instanceof jsts.geom.Polygon){var e=t;this.setBasePoint(e.getExteriorRing().getCoordinateN(0)),this.add3(e)}else if(t instanceof jsts.geom.GeometryCollection||t instanceof jsts.geom.MultiPolygon)for(var o=t,n=0;n<o.getNumGeometries();n++)this.add(o.getGeometryN(n));else t instanceof Array&&this.add2(t)},jsts.algorithm.CentroidArea.prototype.add2=function(t){this.setBasePoint(t[0]),this.addShell(t)},jsts.algorithm.CentroidArea.prototype.getCentroid=function(){var t=new jsts.geom.Coordinate;return Math.abs(this.areasum2)>0?(t.x=this.cg3.x/3/this.areasum2,t.y=this.cg3.y/3/this.areasum2):(t.x=this.centSum.x/this.totalLength,t.y=this.centSum.y/this.totalLength),t},jsts.algorithm.CentroidArea.prototype.setBasePoint=function(t){null==this.basePt&&(this.basePt=t)},jsts.algorithm.CentroidArea.prototype.add3=function(t){this.addShell(t.getExteriorRing().getCoordinates());for(var e=0;e<t.getNumInteriorRing();e++)this.addHole(t.getInteriorRingN(e).getCoordinates())},jsts.algorithm.CentroidArea.prototype.addShell=function(t){for(var e=!jsts.algorithm.CGAlgorithms.isCCW(t),o=0;o<t.length-1;o++)this.addTriangle(this.basePt,t[o],t[o+1],e);this.addLinearSegments(t)},jsts.algorithm.CentroidArea.prototype.addHole=function(t){for(var e=jsts.algorithm.CGAlgorithms.isCCW(t),o=0;o<t.length-1;o++)this.addTriangle(this.basePt,t[o],t[o+1],e);this.addLinearSegments(t)},jsts.algorithm.CentroidArea.prototype.addTriangle=function(t,e,o,n){var i=n?1:-1;jsts.algorithm.CentroidArea.centroid3(t,e,o,this.triangleCent3);var r=jsts.algorithm.CentroidArea.area2(t,e,o);this.cg3.x+=i*r*this.triangleCent3.x,this.cg3.y+=i*r*this.triangleCent3.y,this.areasum2+=i*r},jsts.algorithm.CentroidArea.centroid3=function(t,e,o,n){n.x=t.x+e.x+o.x,n.y=t.y+e.y+o.y},jsts.algorithm.CentroidArea.area2=function(t,e,o){return(e.x-t.x)*(o.y-t.y)-(o.x-t.x)*(e.y-t.y)},jsts.algorithm.CentroidArea.prototype.addLinearSegments=function(t){for(var e=0;e<t.length-1;e++){var o=t[e].distance(t[e+1]);this.totalLength+=o;var n=(t[e].x+t[e+1].x)/2;this.centSum.x+=o*n;var i=(t[e].y+t[e+1].y)/2;this.centSum.y+=o*i}},jsts.algorithm.CentralEndpointIntersector=function(t,e,o,n){this.pts=[t,e,o,n],this.compute()},jsts.algorithm.CentralEndpointIntersector.getIntersection=function(t,e,o,n){return new jsts.algorithm.CentralEndpointIntersector(t,e,o,n).getIntersection()},jsts.algorithm.CentralEndpointIntersector.prototype.pts=null,jsts.algorithm.CentralEndpointIntersector.prototype.intPt=null,jsts.algorithm.CentralEndpointIntersector.prototype.compute=function(){var t=jsts.algorithm.CentralEndpointIntersector.average(this.pts);this.intPt=this.findNearestPoint(t,this.pts)},jsts.algorithm.CentralEndpointIntersector.prototype.getIntersection=function(){return this.intPt},jsts.algorithm.CentralEndpointIntersector.average=function(t){var e,o=new jsts.geom.Coordinate,n=t.length;for(e=0;e<n;e++)o.x+=t[e].x,o.y+=t[e].y;return n>0&&(o.x/=n,o.y/=n),o},jsts.algorithm.CentralEndpointIntersector.prototype.findNearestPoint=function(t,e){var o,n,i=Number.MAX_VALUE,r=null;for(o=0;o<e.length;o++)(n=t.distance(e[o]))<i&&(i=n,r=e[o]);return r},function(){var t=javascript.util.ArrayList,e=jsts.geom.GeometryComponentFilter,o=jsts.geom.LineString,n=jsts.operation.polygonize.EdgeRing,i=jsts.operation.polygonize.PolygonizeGraph,r=function(){var n=this,i=function(){};i.prototype=new e,i.prototype.filter=function(t){t instanceof o&&n.add(t)},this.lineStringAdder=new i,this.dangles=new t,this.cutEdges=new t,this.invalidRingLines=new t};r.prototype.lineStringAdder=null,r.prototype.graph=null,r.prototype.dangles=null,r.prototype.cutEdges=null,r.prototype.invalidRingLines=null,r.prototype.holeList=null,r.prototype.shellList=null,r.prototype.polyList=null,r.prototype.add=function(t){if(t instanceof jsts.geom.LineString)return this.add3(t);if(t instanceof jsts.geom.Geometry)return this.add2(t);for(var e=t.iterator();e.hasNext();){var o=e.next();this.add2(o)}},r.prototype.add2=function(t){t.apply(this.lineStringAdder)},r.prototype.add3=function(t){null==this.graph&&(this.graph=new i(t.getFactory())),this.graph.addEdge(t)},r.prototype.getPolygons=function(){return this.polygonize(),this.polyList},r.prototype.getDangles=function(){return this.polygonize(),this.dangles},r.prototype.getCutEdges=function(){return this.polygonize(),this.cutEdges},r.prototype.getInvalidRingLines=function(){return this.polygonize(),this.invalidRingLines},r.prototype.polygonize=function(){if(null==this.polyList&&(this.polyList=new t,null!=this.graph)){this.dangles=this.graph.deleteDangles(),this.cutEdges=this.graph.deleteCutEdges();var e=this.graph.getEdgeRings(),o=new t;this.invalidRingLines=new t,this.findValidRings(e,o,this.invalidRingLines),this.findShellsAndHoles(o),r.assignHolesToShells(this.holeList,this.shellList),this.polyList=new t;for(var n=this.shellList.iterator();n.hasNext();){var i=n.next();this.polyList.add(i.getPolygon())}}},r.prototype.findValidRings=function(t,e,o){for(var n=t.iterator();n.hasNext();){var i=n.next();i.isValid()?e.add(i):o.add(i.getLineString())}},r.prototype.findShellsAndHoles=function(e){this.holeList=new t,this.shellList=new t;for(var o=e.iterator();o.hasNext();){var n=o.next();n.isHole()?this.holeList.add(n):this.shellList.add(n)}},r.assignHolesToShells=function(t,e){for(var o=t.iterator();o.hasNext();){var n=o.next();r.assignHoleToShell(n,e)}},r.assignHoleToShell=function(t,e){var o=n.findEdgeRingContaining(t,e);null!=o&&o.addHole(t.getRing())},jsts.operation.polygonize.Polygonizer=r}(),function(){var t=jsts.geom.Location,e=jsts.geomgraph.Position,o=jsts.util.Assert;jsts.geomgraph.GeometryGraph=function(t,e,o){jsts.geomgraph.PlanarGraph.call(this),this.lineEdgeMap=new javascript.util.HashMap,this.ptLocator=new jsts.algorithm.PointLocator,this.argIndex=t,this.parentGeom=e,this.boundaryNodeRule=o||jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE,null!==e&&this.add(e)},jsts.geomgraph.GeometryGraph.prototype=new jsts.geomgraph.PlanarGraph,jsts.geomgraph.GeometryGraph.constructor=jsts.geomgraph.GeometryGraph,jsts.geomgraph.GeometryGraph.prototype.createEdgeSetIntersector=function(){return new jsts.geomgraph.index.SimpleEdgeSetIntersector},jsts.geomgraph.GeometryGraph.determineBoundary=function(e,o){return e.isInBoundary(o)?t.BOUNDARY:t.INTERIOR},jsts.geomgraph.GeometryGraph.prototype.parentGeom=null,jsts.geomgraph.GeometryGraph.prototype.lineEdgeMap=null,jsts.geomgraph.GeometryGraph.prototype.boundaryNodeRule=null,jsts.geomgraph.GeometryGraph.prototype.useBoundaryDeterminationRule=!0,jsts.geomgraph.GeometryGraph.prototype.argIndex=null,jsts.geomgraph.GeometryGraph.prototype.boundaryNodes=null,jsts.geomgraph.GeometryGraph.prototype.hasTooFewPoints=!1,jsts.geomgraph.GeometryGraph.prototype.invalidPoint=null,jsts.geomgraph.GeometryGraph.prototype.areaPtLocator=null,jsts.geomgraph.GeometryGraph.prototype.ptLocator=null,jsts.geomgraph.GeometryGraph.prototype.getGeometry=function(){return this.parentGeom},jsts.geomgraph.GeometryGraph.prototype.getBoundaryNodes=function(){return null===this.boundaryNodes&&(this.boundaryNodes=this.nodes.getBoundaryNodes(this.argIndex)),this.boundaryNodes},jsts.geomgraph.GeometryGraph.prototype.getBoundaryNodeRule=function(){return this.boundaryNodeRule},jsts.geomgraph.GeometryGraph.prototype.findEdge=function(t){return this.lineEdgeMap.get(t)},jsts.geomgraph.GeometryGraph.prototype.computeSplitEdges=function(t){for(var e=this.edges.iterator();e.hasNext();){e.next().eiList.addSplitEdges(t)}},jsts.geomgraph.GeometryGraph.prototype.add=function(t){if(!t.isEmpty())if(t instanceof jsts.geom.MultiPolygon&&(this.useBoundaryDeterminationRule=!1),t instanceof jsts.geom.Polygon)this.addPolygon(t);else if(t instanceof jsts.geom.LineString)this.addLineString(t);else if(t instanceof jsts.geom.Point)this.addPoint(t);else if(t instanceof jsts.geom.MultiPoint)this.addCollection(t);else if(t instanceof jsts.geom.MultiLineString)this.addCollection(t);else if(t instanceof jsts.geom.MultiPolygon)this.addCollection(t);else{if(!(t instanceof jsts.geom.GeometryCollection))throw new jsts.error.IllegalArgumentError("Geometry type not supported.");this.addCollection(t)}},jsts.geomgraph.GeometryGraph.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var o=t.getGeometryN(e);this.add(o)}},jsts.geomgraph.GeometryGraph.prototype.addEdge=function(e){this.insertEdge(e);var o=e.getCoordinates();this.insertPoint(this.argIndex,o[0],t.BOUNDARY),this.insertPoint(this.argIndex,o[o.length-1],t.BOUNDARY)},jsts.geomgraph.GeometryGraph.prototype.addPoint=function(e){var o=e.getCoordinate();this.insertPoint(this.argIndex,o,t.INTERIOR)},jsts.geomgraph.GeometryGraph.prototype.addLineString=function(e){var n=jsts.geom.CoordinateArrays.removeRepeatedPoints(e.getCoordinates());if(n.length<2)return this.hasTooFewPoints=!0,void(this.invalidPoint=coords[0]);var i=new jsts.geomgraph.Edge(n,new jsts.geomgraph.Label(this.argIndex,t.INTERIOR));this.lineEdgeMap.put(e,i),this.insertEdge(i),o.isTrue(n.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this.argIndex,n[0]),this.insertBoundaryPoint(this.argIndex,n[n.length-1])},jsts.geomgraph.GeometryGraph.prototype.addPolygonRing=function(e,o,n){if(!e.isEmpty()){var i=jsts.geom.CoordinateArrays.removeRepeatedPoints(e.getCoordinates());if(i.length<4)return this.hasTooFewPoints=!0,void(this.invalidPoint=i[0]);var r=o,s=n;jsts.algorithm.CGAlgorithms.isCCW(i)&&(r=n,s=o);var a=new jsts.geomgraph.Edge(i,new jsts.geomgraph.Label(this.argIndex,t.BOUNDARY,r,s));this.lineEdgeMap.put(e,a),this.insertEdge(a),this.insertPoint(this.argIndex,i[0],t.BOUNDARY)}},jsts.geomgraph.GeometryGraph.prototype.addPolygon=function(e){this.addPolygonRing(e.getExteriorRing(),t.EXTERIOR,t.INTERIOR);for(var o=0;o<e.getNumInteriorRing();o++){var n=e.getInteriorRingN(o);this.addPolygonRing(n,t.INTERIOR,t.EXTERIOR)}},jsts.geomgraph.GeometryGraph.prototype.computeEdgeIntersections=function(t,e,o){var n=new jsts.geomgraph.index.SegmentIntersector(e,o,!0);return n.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this.edges,t.edges,n),n},jsts.geomgraph.GeometryGraph.prototype.computeSelfNodes=function(t,e){var o=new jsts.geomgraph.index.SegmentIntersector(t,!0,!1),n=this.createEdgeSetIntersector();return!e&&(this.parentGeom instanceof jsts.geom.LinearRing||this.parentGeom instanceof jsts.geom.Polygon||this.parentGeom instanceof jsts.geom.MultiPolygon)?n.computeIntersections(this.edges,o,!1):n.computeIntersections(this.edges,o,!0),this.addSelfIntersectionNodes(this.argIndex),o},jsts.geomgraph.GeometryGraph.prototype.insertPoint=function(t,e,o){var n=this.nodes.addNode(e),i=n.getLabel();null==i?n.label=new jsts.geomgraph.Label(t,o):i.setLocation(t,o)},jsts.geomgraph.GeometryGraph.prototype.insertBoundaryPoint=function(o,n){var i=this.nodes.addNode(n),r=i.getLabel(),s=1,a=t.NONE;null!==r&&(a=r.getLocation(o,e.ON)),a===t.BOUNDARY&&s++;var l=jsts.geomgraph.GeometryGraph.determineBoundary(this.boundaryNodeRule,s);r.setLocation(o,l)},jsts.geomgraph.GeometryGraph.prototype.addSelfIntersectionNodes=function(t){for(var e=this.edges.iterator();e.hasNext();)for(var o=e.next(),n=o.getLabel().getLocation(t),i=o.eiList.iterator();i.hasNext();){var r=i.next();this.addSelfIntersectionNode(t,r.coord,n)}},jsts.geomgraph.GeometryGraph.prototype.addSelfIntersectionNode=function(e,o,n){this.isBoundaryNode(e,o)||(n===t.BOUNDARY&&this.useBoundaryDeterminationRule?this.insertBoundaryPoint(e,o):this.insertPoint(e,o,n))},jsts.geomgraph.GeometryGraph.prototype.getInvalidPoint=function(){return this.invalidPoint}}(),jsts.operation.buffer.OffsetSegmentString=function(){this.ptList=[]},jsts.operation.buffer.OffsetSegmentString.prototype.ptList=null,jsts.operation.buffer.OffsetSegmentString.prototype.precisionModel=null,jsts.operation.buffer.OffsetSegmentString.prototype.minimimVertexDistance=0,jsts.operation.buffer.OffsetSegmentString.prototype.setPrecisionModel=function(t){this.precisionModel=t},jsts.operation.buffer.OffsetSegmentString.prototype.setMinimumVertexDistance=function(t){this.minimimVertexDistance=t},jsts.operation.buffer.OffsetSegmentString.prototype.addPt=function(t){var e=new jsts.geom.Coordinate(t);this.precisionModel.makePrecise(e),this.isRedundant(e)||this.ptList.push(e)},jsts.operation.buffer.OffsetSegmentString.prototype.addPts=function(t,e){if(e)for(var o=0;o<t.length;o++)this.addPt(t[o]);else for(var o=t.length-1;o>=0;o--)this.addPt(t[o])},jsts.operation.buffer.OffsetSegmentString.prototype.isRedundant=function(t){if(this.ptList.length<1)return!1;var e=this.ptList[this.ptList.length-1];return t.distance(e)<this.minimimVertexDistance},jsts.operation.buffer.OffsetSegmentString.prototype.closeRing=function(){if(!(this.ptList.length<1)){var t=new jsts.geom.Coordinate(this.ptList[0]),e=this.ptList[this.ptList.length-1];this.ptList.length>=2&&this.ptList[this.ptList.length-2],t.equals(e)||this.ptList.push(t)}},jsts.operation.buffer.OffsetSegmentString.prototype.reverse=function(){},jsts.operation.buffer.OffsetSegmentString.prototype.getCoordinates=function(){return this.ptList},function(){var t=javascript.util.ArrayList,e=javascript.util.TreeSet,o=jsts.geom.CoordinateFilter;jsts.util.UniqueCoordinateArrayFilter=function(){this.treeSet=new e,this.list=new t},jsts.util.UniqueCoordinateArrayFilter.prototype=new o,jsts.util.UniqueCoordinateArrayFilter.prototype.treeSet=null,jsts.util.UniqueCoordinateArrayFilter.prototype.list=null,jsts.util.UniqueCoordinateArrayFilter.prototype.getCoordinates=function(){return this.list.toArray()},jsts.util.UniqueCoordinateArrayFilter.prototype.filter=function(t){this.treeSet.contains(t)||(this.list.add(t),this.treeSet.add(t))}}(),function(){var t=jsts.algorithm.CGAlgorithms,e=jsts.util.UniqueCoordinateArrayFilter,o=jsts.util.Assert,n=javascript.util.Stack,i=javascript.util.ArrayList,r=javascript.util.Arrays,s=function(t){this.origin=t};s.prototype.origin=null,s.prototype.compare=function(t,e){var o=t,n=e;return s.polarCompare(this.origin,o,n)},s.polarCompare=function(e,o,n){var i=o.x-e.x,r=o.y-e.y,s=n.x-e.x,a=n.y-e.y,l=t.computeOrientation(e,o,n);if(l==t.COUNTERCLOCKWISE)return 1;if(l==t.CLOCKWISE)return-1;var c=i*i+r*r,u=s*s+a*a;return c<u?-1:c>u?1:0},jsts.algorithm.ConvexHull=function(){if(1===arguments.length){var t=arguments[0];this.inputPts=jsts.algorithm.ConvexHull.extractCoordinates(t),this.geomFactory=t.getFactory()}else this.pts=arguments[0],this.geomFactory=arguments[1]},jsts.algorithm.ConvexHull.prototype.geomFactory=null,jsts.algorithm.ConvexHull.prototype.inputPts=null,jsts.algorithm.ConvexHull.extractCoordinates=function(t){var o=new e;return t.apply(o),o.getCoordinates()},jsts.algorithm.ConvexHull.prototype.getConvexHull=function(){if(0==this.inputPts.length)return this.geomFactory.createGeometryCollection(null);if(1==this.inputPts.length)return this.geomFactory.createPoint(this.inputPts[0]);if(2==this.inputPts.length)return this.geomFactory.createLineString(this.inputPts);var t=this.inputPts;this.inputPts.length>50&&(t=this.reduce(this.inputPts));var e=this.preSort(t),o=this.grahamScan(e),n=o.toArray();return this.lineOrPolygon(n)},jsts.algorithm.ConvexHull.prototype.reduce=function(e){var o=this.computeOctRing(e);if(null==o)return this.inputPts;for(var n=new javascript.util.TreeSet,i=0;i<o.length;i++)n.add(o[i]);for(var i=0;i<e.length;i++)t.isPointInRing(e[i],o)||n.add(e[i]);var r=n.toArray();return r.length<3?this.padArray3(r):r},jsts.algorithm.ConvexHull.prototype.padArray3=function(t){for(var e=[],o=0;o<e.length;o++)o<t.length?e[o]=t[o]:e[o]=t[0];return e},jsts.algorithm.ConvexHull.prototype.preSort=function(t){for(var e,o=1;o<t.length;o++)(t[o].y<t[0].y||t[o].y==t[0].y&&t[o].x<t[0].x)&&(e=t[0],t[0]=t[o],t[o]=e);return r.sort(t,1,t.length,new s(t[0])),t},jsts.algorithm.ConvexHull.prototype.grahamScan=function(e){var o,i=new n;o=i.push(e[0]),o=i.push(e[1]),o=i.push(e[2]);for(var r=3;r<e.length;r++){for(o=i.pop();!i.empty()&&t.computeOrientation(i.peek(),o,e[r])>0;)o=i.pop();o=i.push(o),o=i.push(e[r])}return o=i.push(e[0]),i},jsts.algorithm.ConvexHull.prototype.isBetween=function(e,o,n){if(0!==t.computeOrientation(e,o,n))return!1;if(e.x!=n.x){if(e.x<=o.x&&o.x<=n.x)return!0;if(n.x<=o.x&&o.x<=e.x)return!0}if(e.y!=n.y){if(e.y<=o.y&&o.y<=n.y)return!0;if(n.y<=o.y&&o.y<=e.y)return!0}return!1},jsts.algorithm.ConvexHull.prototype.computeOctRing=function(t){var e=this.computeOctPts(t),o=new jsts.geom.CoordinateList;return o.add(e,!1),o.size()<3?null:(o.closeRing(),o.toCoordinateArray())},jsts.algorithm.ConvexHull.prototype.computeOctPts=function(t){for(var e=[],o=0;o<8;o++)e[o]=t[0];for(var n=1;n<t.length;n++)t[n].x<e[0].x&&(e[0]=t[n]),t[n].x-t[n].y<e[1].x-e[1].y&&(e[1]=t[n]),t[n].y>e[2].y&&(e[2]=t[n]),t[n].x+t[n].y>e[3].x+e[3].y&&(e[3]=t[n]),t[n].x>e[4].x&&(e[4]=t[n]),t[n].x-t[n].y>e[5].x-e[5].y&&(e[5]=t[n]),t[n].y<e[6].y&&(e[6]=t[n]),t[n].x+t[n].y<e[7].x+e[7].y&&(e[7]=t[n]);return e},jsts.algorithm.ConvexHull.prototype.lineOrPolygon=function(t){if(t=this.cleanRing(t),3==t.length)return this.geomFactory.createLineString([t[0],t[1]]);var e=this.geomFactory.createLinearRing(t);return this.geomFactory.createPolygon(e,null)},jsts.algorithm.ConvexHull.prototype.cleanRing=function(t){o.equals(t[0],t[t.length-1]);for(var e=new i,n=null,r=0;r<=t.length-2;r++){var s=t[r],a=t[r+1];s.equals(a)||(null!=n&&this.isBetween(n,s,a)||(e.add(s),n=s))}e.add(t[t.length-1]);var l=[];return e.toArray(l)}}(),function(){javascript.util.ArrayList;jsts.geomgraph.index.SegmentIntersector=function(t,e,o){this.li=t,this.includeProper=e,this.recordIsolated=o},jsts.geomgraph.index.SegmentIntersector.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)},jsts.geomgraph.index.SegmentIntersector.prototype._hasIntersection=!1,jsts.geomgraph.index.SegmentIntersector.prototype.hasProper=!1,jsts.geomgraph.index.SegmentIntersector.prototype.hasProperInterior=!1,jsts.geomgraph.index.SegmentIntersector.prototype.properIntersectionPoint=null,jsts.geomgraph.index.SegmentIntersector.prototype.li=null,jsts.geomgraph.index.SegmentIntersector.prototype.includeProper=null,jsts.geomgraph.index.SegmentIntersector.prototype.recordIsolated=null,jsts.geomgraph.index.SegmentIntersector.prototype.isSelfIntersection=null,jsts.geomgraph.index.SegmentIntersector.prototype.numIntersections=0,jsts.geomgraph.index.SegmentIntersector.prototype.numTests=0,jsts.geomgraph.index.SegmentIntersector.prototype.bdyNodes=null,jsts.geomgraph.index.SegmentIntersector.prototype.setBoundaryNodes=function(t,e){this.bdyNodes=[],this.bdyNodes[0]=t,this.bdyNodes[1]=e},jsts.geomgraph.index.SegmentIntersector.prototype.getProperIntersectionPoint=function(){return this.properIntersectionPoint},jsts.geomgraph.index.SegmentIntersector.prototype.hasIntersection=function(){return this._hasIntersection},jsts.geomgraph.index.SegmentIntersector.prototype.hasProperIntersection=function(){return this.hasProper},jsts.geomgraph.index.SegmentIntersector.prototype.hasProperInteriorIntersection=function(){return this.hasProperInterior},jsts.geomgraph.index.SegmentIntersector.prototype.isTrivialIntersection=function(t,e,o,n){if(t===o&&1===this.li.getIntersectionNum()){if(jsts.geomgraph.index.SegmentIntersector.isAdjacentSegments(e,n))return!0;if(t.isClosed()){var i=t.getNumPoints()-1;if(0===e&&n===i||0===n&&e===i)return!0}}return!1},jsts.geomgraph.index.SegmentIntersector.prototype.addIntersections=function(t,e,o,n){if(t!==o||e!==n){this.numTests++;var i=t.getCoordinates()[e],r=t.getCoordinates()[e+1],s=o.getCoordinates()[n],a=o.getCoordinates()[n+1];this.li.computeIntersection(i,r,s,a),this.li.hasIntersection()&&(this.recordIsolated&&(t.setIsolated(!1),o.setIsolated(!1)),this.numIntersections++,this.isTrivialIntersection(t,e,o,n)||(this._hasIntersection=!0,!this.includeProper&&this.li.isProper()||(t.addIntersections(this.li,e,0),o.addIntersections(this.li,n,1)),this.li.isProper()&&(this.properIntersectionPoint=this.li.getIntersection(0).clone(),this.hasProper=!0,this.isBoundaryPoint(this.li,this.bdyNodes)||(this.hasProperInterior=!0))))}},jsts.geomgraph.index.SegmentIntersector.prototype.isBoundaryPoint=function(t,e){if(null===e)return!1;if(e instanceof Array)return!!this.isBoundaryPoint(t,e[0])||!!this.isBoundaryPoint(t,e[1]);for(var o=e.iterator();o.hasNext();){var n=o.next(),i=n.getCoordinate();if(t.isIntersection(i))return!0}return!1}}()},function(t,e,o){/**
 * k-d Tree JavaScript - V 1.0
 *
 * https://github.com/ubilabs/kd-tree-javascript
 *
 * @author Mircea Pricop <pricop@ubilabs.net>, 2012
 * @author Martin Kleppe <kleppe@ubilabs.net>, 2012
 * @author Ubilabs http://ubilabs.net, 2012
 * @license MIT License <http://www.opensource.org/licenses/mit-license.php>
 */
!function(){function t(t,e,o){this.obj=t,this.left=null,this.right=null,this.parent=o,this.dimension=e}function o(e,o,i){function r(e,o,n){var s,a,l=o%i.length;return 0===e.length?null:1===e.length?new t(e[0],l,n):(e.sort(function(t,e){return t[i[l]]-e[i[l]]}),s=Math.floor(e.length/2),a=new t(e[s],l,n),a.left=r(e.slice(0,s),o+1,a),a.right=r(e.slice(s+1),o+1,a),a)}var s=this,a=0;Array.isArray(e)?this.root=r(e,0,null):function(t){function e(t){t.left&&(t.left.parent=t,e(t.left)),t.right&&(t.right.parent=t,e(t.right))}s.root=t,e(s.root)}(e),this.toJSON=function(e){e||(e=this.root);var o=new t(e.obj,e.dimension,null);return e.left&&(o.left=s.toJSON(e.left)),e.right&&(o.right=s.toJSON(e.right)),o},this.insert=function(e){function o(t,n){if(null===t)return n;var r=i[t.dimension];return e[r]<t.obj[r]?o(t.left,t):o(t.right,t)}a++;var n,r,s=o(this.root,null);if(null===s)return void(this.root=new t(e,0,null));n=new t(e,(s.dimension+1)%i.length,s),r=i[s.dimension],e[r]<s.obj[r]?s.left=n:s.right=n},this.remove=function(t){function e(o){if(null===o)return null;if(o.obj===t)return o;var n=i[o.dimension];return t[n]<o.obj[n]?e(o.left,o):e(o.right,o)}function o(t){function e(t,o){var n,r,s,a,l;return null===t?null:(n=i[o],t.dimension===o?null!==t.right?e(t.right,o):t:(r=t.obj[n],s=e(t.left,o),a=e(t.right,o),l=t,null!==s&&s.obj[n]>r&&(l=s),null!==a&&a.obj[n]>l.obj[n]&&(l=a),l))}function n(t,e){var o,r,s,a,l;return null===t?null:(o=i[e],t.dimension===e?null!==t.left?n(t.left,e):t:(r=t.obj[o],s=n(t.left,e),a=n(t.right,e),l=t,null!==s&&s.obj[o]<r&&(l=s),null!==a&&a.obj[o]<l.obj[o]&&(l=a),l))}a--;var r,l,c;if(null===t.left&&null===t.right)return null===t.parent?void(s.root=null):(c=i[t.parent.dimension],void(t.obj[c]<t.parent.obj[c]?t.parent.left=null:t.parent.right=null));r=null!==t.left?e(t.left,t.dimension):n(t.right,t.dimension),l=r.obj,o(r),t.obj=l}var n;null!==(n=e(s.root))&&o(n)},this.size=function(){return a},this.nearest=function(t,e,r){function a(n){function r(t,o){u.push([t,o]),u.size()>e&&u.pop()}var s,l,c,h,g=i[n.dimension],p=o(t,n.obj),d={};for(h=0;h<i.length;h+=1)h===n.dimension?d[i[h]]=t[i[h]]:d[i[h]]=n.obj[i[h]];if(l=o(d,n.obj),null===n.right&&null===n.left)return void((u.size()<e||p<u.peek()[1])&&r(n,p));s=null===n.right?n.left:null===n.left?n.right:t[g]<n.obj[g]?n.left:n.right,a(s),(u.size()<e||p<u.peek()[1])&&r(n,p),(u.size()<e||Math.abs(l)<u.peek()[1])&&null!==(c=s===n.left?n.right:n.left)&&a(c)}var l,c,u;if(u=new n(function(t){return-t[1]}),r)for(l=0;l<e;l+=1)u.push([null,r]);if(null==s.root)return null;for(a(s.root),c=[],l=0;l<e;l+=1)u.content[l][0]&&c.push([u.content[l][0].obj,u.content[l][1]]);return c},this.balanceFactor=function(){function t(e){return null===e?0:Math.max(t(e.left),t(e.right))+1}function e(t){return null===t?0:e(t.left)+e(t.right)+1}return t(s.root)/(Math.log(e(s.root))/Math.log(2))}}function n(t){this.content=[],this.scoreFunction=t}n.prototype={push:function(t){this.content.push(t),this.bubbleUp(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.sinkDown(0)),t},peek:function(){return this.content[0]},remove:function(t){for(var e=this.content.length,o=0;o<e;o++)if(this.content[o]==t){var n=this.content.pop();return void(o!=e-1&&(this.content[o]=n,this.scoreFunction(n)<this.scoreFunction(t)?this.bubbleUp(o):this.sinkDown(o)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(t){for(var e=this.content[t];t>0;){var o=Math.floor((t+1)/2)-1,n=this.content[o];if(!(this.scoreFunction(e)<this.scoreFunction(n)))break;this.content[o]=e,this.content[t]=n,t=o}},sinkDown:function(t){for(var e=this.content.length,o=this.content[t],n=this.scoreFunction(o);;){var i=2*(t+1),r=i-1,s=null;if(r<e){var a=this.content[r],l=this.scoreFunction(a);l<n&&(s=r)}if(i<e){var c=this.content[i];this.scoreFunction(c)<(null==s?n:l)&&(s=i)}if(null==s)break;this.content[t]=this.content[s],this.content[s]=o,t=s}}},this.kdTree=o,e.kdTree=o,e.BinaryHeap=n}()},function(module,exports,__webpack_require__){"use strict";(function(global){var numeric=exports;void 0!==global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(t,e){var o,n,i,r;for(void 0===e&&(e=15),i=.5,o=new Date;;){for(i*=2,r=i;r>3;r-=4)t(),t(),t(),t();for(;r>0;)t(),r--;if((n=new Date)-o>e)break}for(r=i;r>3;r-=4)t(),t(),t(),t();for(;r>0;)t(),r--;return n=new Date,1e3*(3*i-1)/(n-o)},numeric._myIndexOf=function(t){var e,o=this.length;for(e=0;e<o;++e)if(this[e]===t)return e;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(t){function e(t){if(0===t)return"0";if(isNaN(t))return"NaN";if(t<0)return"-"+e(-t);if(isFinite(t)){var o=Math.floor(Math.log(t)/Math.log(10)),n=t/Math.pow(10,o),i=n.toPrecision(numeric.precision);return 10===parseFloat(i)&&(o++,n=1,i=n.toPrecision(numeric.precision)),parseFloat(i).toString()+"e"+o.toString()}return"Infinity"}function o(t){var i;if(void 0===t)return n.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof t)return n.push('"'+t+'"'),!1;if("boolean"==typeof t)return n.push(t.toString()),!1;if("number"==typeof t){var r=e(t),s=t.toPrecision(numeric.precision),a=parseFloat(t.toString()).toString(),l=[r,s,a,parseFloat(s).toString(),parseFloat(a).toString()];for(i=1;i<l.length;i++)l[i].length<r.length&&(r=l[i]);return n.push(Array(numeric.precision+8-r.length).join(" ")+r),!1}if(null===t)return n.push("null"),!1;if("function"==typeof t){n.push(t.toString());var c=!1;for(i in t)t.hasOwnProperty(i)&&(c?n.push(",\n"):n.push("\n{"),c=!0,n.push(i),n.push(": \n"),o(t[i]));return c&&n.push("}\n"),!0}if(t instanceof Array){if(t.length>numeric.largeArray)return n.push("...Large Array..."),!0;var c=!1;for(n.push("["),i=0;i<t.length;i++)i>0&&(n.push(","),c&&n.push("\n ")),c=o(t[i]);return n.push("]"),!0}n.push("{");var c=!1;for(i in t)t.hasOwnProperty(i)&&(c&&n.push(",\n"),c=!0,n.push(i),n.push(": \n"),o(t[i]));return n.push("}"),!0}var n=[];return o(t),n.join("")},numeric.parseDate=function(t){function e(t){if("string"==typeof t)return Date.parse(t.replace(/-/g,"/"));if(t instanceof Array){var o,n=[];for(o=0;o<t.length;o++)n[o]=e(t[o]);return n}throw new Error("parseDate: parameter must be arrays of strings")}return e(t)},numeric.parseFloat=function(t){function e(t){if("string"==typeof t)return parseFloat(t);if(t instanceof Array){var o,n=[];for(o=0;o<t.length;o++)n[o]=e(t[o]);return n}throw new Error("parseFloat: parameter must be arrays of strings")}return e(t)},numeric.parseCSV=function(t){var e,o,n=t.split("\n"),i=[],r=/(([^'",]*)|('[^']*')|("[^"]*")),/g,s=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,a=0;for(o=0;o<n.length;o++){var l,c=(n[o]+",").match(r);if(c.length>0){for(i[a]=[],e=0;e<c.length;e++)l=function(t){return t.substr(0,t.length-1)}(c[e]),s.test(l)?i[a][e]=parseFloat(l):i[a][e]=l;a++}}return i},numeric.toCSV=function(t){var e,o,n,i,r,s=numeric.dim(t);for(n=s[0],s[1],r=[],e=0;e<n;e++){for(i=[],o=0;o<n;o++)i[o]=t[e][o].toString();r[e]=i.join(", ")}return r.join("\n")+"\n"},numeric.getURL=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(),e},numeric.imageURL=function(t){function e(t,e,o){void 0===e&&(e=0),void 0===o&&(o=t.length);var n,i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],r=-1,s=0;t.length;for(n=e;n<o;n++)s=255&(r^t[n]),r=r>>>8^i[s];return-1^r}var o,n,i,r,s,a,l,c,u,h,g=t[0].length,p=t[0][0].length,d=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,p>>24&255,p>>16&255,p>>8&255,255&p,g>>24&255,g>>16&255,g>>8&255,255&g,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(h=e(d,12,29),d[29]=h>>24&255,d[30]=h>>16&255,d[31]=h>>8&255,d[32]=255&h,o=1,n=0,l=0;l<g;l++){for(l<g-1?d.push(0):d.push(1),s=3*p+1+(0===l)&255,a=3*p+1+(0===l)>>8&255,d.push(s),d.push(a),d.push(255&~s),d.push(255&~a),0===l&&d.push(0),c=0;c<p;c++)for(i=0;i<3;i++)s=t[i][l][c],s=s>255?255:s<0?0:Math.round(s),o=(o+s)%65521,n=(n+o)%65521,d.push(s);d.push(0)}return u=(n<<16)+o,d.push(u>>24&255),d.push(u>>16&255),d.push(u>>8&255),d.push(255&u),r=d.length-41,d[33]=r>>24&255,d[34]=r>>16&255,d[35]=r>>8&255,d[36]=255&r,h=e(d,37),d.push(h>>24&255),d.push(h>>16&255),d.push(h>>8&255),d.push(255&h),d.push(0),d.push(0),d.push(0),d.push(0),d.push(73),d.push(69),d.push(78),d.push(68),d.push(174),d.push(66),d.push(96),d.push(130),"data:image/png;base64,"+function(t){var e,o,n,i,r,s,a,l,c=t.length,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h="";for(e=0;e<c;e+=3)o=t[e],n=t[e+1],i=t[e+2],r=o>>2,s=((3&o)<<4)+(n>>4),a=((15&n)<<2)+(i>>6),l=63&i,e+1>=c?a=l=64:e+2>=c&&(l=64),h+=u.charAt(r)+u.charAt(s)+u.charAt(a)+u.charAt(l);return h}(d)},numeric._dim=function(t){for(var e=[];"object"==typeof t;)e.push(t.length),t=t[0];return e},numeric.dim=function(t){var e,o;return"object"==typeof t?(e=t[0],"object"==typeof e?(o=e[0],"object"==typeof o?numeric._dim(t):[t.length,e.length]):[t.length]):[]},numeric.mapreduce=function(t,e){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+e+';\nif(typeof x === "number") { var xi = x; '+t+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+t+";\n    xi = x[i-1];\n    "+t+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+t+"\n}\nreturn accum;")},numeric.mapreduce2=function(t,e){return Function("x","var n = x.length;\nvar i,xi;\n"+e+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+t+";\n}\nreturn accum;")},numeric.same=function t(e,o){var n,i;if(e instanceof Array&&o instanceof Array){if((i=e.length)!==o.length)return!1;for(n=0;n<i;n++)if(e[n]!==o[n]){if("object"!=typeof e[n])return!1;if(!t(e[n],o[n]))return!1}return!0}return!1},numeric.rep=function(t,e,o){void 0===o&&(o=0);var n,i=t[o],r=Array(i);if(o===t.length-1){for(n=i-2;n>=0;n-=2)r[n+1]=e,r[n]=e;return-1===n&&(r[0]=e),r}for(n=i-1;n>=0;n--)r[n]=numeric.rep(t,e,o+1);return r},numeric.dotMMsmall=function(t,e){var o,n,i,r,s,a,l,c,u,h,g;for(r=t.length,s=e.length,a=e[0].length,l=Array(r),o=r-1;o>=0;o--){for(c=Array(a),u=t[o],i=a-1;i>=0;i--){for(h=u[s-1]*e[s-1][i],n=s-2;n>=1;n-=2)g=n-1,h+=u[n]*e[n][i]+u[g]*e[g][i];0===n&&(h+=u[0]*e[0][i]),c[i]=h}l[o]=c}return l},numeric._getCol=function(t,e,o){var n,i=t.length;for(n=i-1;n>0;--n)o[n]=t[n][e],--n,o[n]=t[n][e];0===n&&(o[0]=t[0][e])},numeric.dotMMbig=function(t,e){var o,n,i,r=numeric._getCol,s=e.length,a=Array(s),l=t.length,c=e[0].length,u=new Array(l),h=numeric.dotVV;for(--s,--l,n=l;-1!==n;--n)u[n]=Array(c);for(--c,n=c;-1!==n;--n)for(r(e,n,a),i=l;-1!==i;--i)0,o=t[i],u[i][n]=h(o,a);return u},numeric.dotMV=function(t,e){var o,n=t.length,i=(e.length,Array(n)),r=numeric.dotVV;for(o=n-1;o>=0;o--)i[o]=r(t[o],e);return i},numeric.dotVM=function(t,e){var o,n,i,r,s,a,l;for(i=t.length,r=e[0].length,s=Array(r),n=r-1;n>=0;n--){for(a=t[i-1]*e[i-1][n],o=i-2;o>=1;o-=2)l=o-1,a+=t[o]*e[o][n]+t[l]*e[l][n];0===o&&(a+=t[0]*e[0][n]),s[n]=a}return s},numeric.dotVV=function(t,e){var o,n,i=t.length,r=t[i-1]*e[i-1];for(o=i-2;o>=1;o-=2)n=o-1,r+=t[o]*e[o]+t[n]*e[n];return 0===o&&(r+=t[0]*e[0]),r},numeric.dot=function(t,e){var o=numeric.dim;switch(1e3*o(t).length+o(e).length){case 2002:return e.length<10?numeric.dotMMsmall(t,e):numeric.dotMMbig(t,e);case 2001:return numeric.dotMV(t,e);case 1002:return numeric.dotVM(t,e);case 1001:return numeric.dotVV(t,e);case 1e3:return numeric.mulVS(t,e);case 1:return numeric.mulSV(t,e);case 0:return t*e;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(t){var e,o,n,i,r=t.length,s=Array(r);for(e=r-1;e>=0;e--){for(i=Array(r),o=e+2,n=r-1;n>=o;n-=2)i[n]=0,i[n-1]=0;for(n>e&&(i[n]=0),i[e]=t[e],n=e-1;n>=1;n-=2)i[n]=0,i[n-1]=0;0===n&&(i[0]=0),s[e]=i}return s},numeric.getDiag=function(t){var e,o=Math.min(t.length,t[0].length),n=Array(o);for(e=o-1;e>=1;--e)n[e]=t[e][e],--e,n[e]=t[e][e];return 0===e&&(n[0]=t[0][0]),n},numeric.identity=function(t){return numeric.diag(numeric.rep([t],1))},numeric.pointwise=function(t,e,o){void 0===o&&(o="");var n,i,r=[],s=/\[i\]$/,a="",l=!1;for(n=0;n<t.length;n++)s.test(t[n])?(i=t[n].substring(0,t[n].length-3),a=i):i=t[n],"ret"===i&&(l=!0),r.push(i);return r[t.length]="_s",r[t.length+1]="_k",r[t.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+a+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(l?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+t.join(",")+",_s,_k+1);\n    return ret;\n}\n"+o+"\nfor(i=_n-1;i!==-1;--i) {\n    "+e+"\n}\nreturn ret;",Function.apply(null,r)},numeric.pointwise2=function(t,e,o){void 0===o&&(o="");var n,i,r=[],s=/\[i\]$/,a="",l=!1;for(n=0;n<t.length;n++)s.test(t[n])?(i=t[n].substring(0,t[n].length-3),a=i):i=t[n],"ret"===i&&(l=!0),r.push(i);return r[t.length]="var _n = "+a+".length;\nvar i"+(l?"":", ret = Array(_n)")+";\n"+o+"\nfor(i=_n-1;i!==-1;--i) {\n"+e+"\n}\nreturn ret;",Function.apply(null,r)},numeric._biforeach=function t(e,o,n,i,r){if(i===n.length-1)return void r(e,o);var s,a=n[i];for(s=a-1;s>=0;s--)t("object"==typeof e?e[s]:e,"object"==typeof o?o[s]:o,n,i+1,r)},numeric._biforeach2=function t(e,o,n,i,r){if(i===n.length-1)return r(e,o);var s,a=n[i],l=Array(a);for(s=a-1;s>=0;--s)l[s]=t("object"==typeof e?e[s]:e,"object"==typeof o?o[s]:o,n,i+1,r);return l},numeric._foreach=function t(e,o,n,i){if(n===o.length-1)return void i(e);var r,s=o[n];for(r=s-1;r>=0;r--)t(e[r],o,n+1,i)},numeric._foreach2=function t(e,o,n,i){if(n===o.length-1)return i(e);var r,s=o[n],a=Array(s);for(r=s-1;r>=0;r--)a[r]=t(e[r],o,n+1,i);return a},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var t,e;for(t=0;t<numeric.mathfuns2.length;++t)e=numeric.mathfuns2[t],numeric.ops2[e]=e;for(t in numeric.ops2)if(numeric.ops2.hasOwnProperty(t)){e=numeric.ops2[t];var o,n,i="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,t)?(i="var "+e+" = Math."+e+";\n",o=function(t,o,n){return t+" = "+e+"("+o+","+n+")"},n=function(t,o){return t+" = "+e+"("+t+","+o+")"}):(o=function(t,o,n){return t+" = "+o+" "+e+" "+n},n=numeric.opseq.hasOwnProperty(t+"eq")?function(t,o){return t+" "+e+"= "+o}:function(t,o){return t+" = "+t+" "+e+" "+o}),numeric[t+"VV"]=numeric.pointwise2(["x[i]","y[i]"],o("ret[i]","x[i]","y[i]"),i),numeric[t+"SV"]=numeric.pointwise2(["x","y[i]"],o("ret[i]","x","y[i]"),i),numeric[t+"VS"]=numeric.pointwise2(["x[i]","y"],o("ret[i]","x[i]","y"),i),numeric[t]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+t+"VV, VS = numeric."+t+"VS, SV = numeric."+t+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+n("x","y")+"\n}\nreturn x;\n"),numeric[e]=numeric[t],numeric[t+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],n("ret[i]","x[i]"),i),numeric[t+"eqS"]=numeric.pointwise2(["ret[i]","x"],n("ret[i]","x"),i),numeric[t+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+t+"eqV, S = numeric."+t+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(t=0;t<numeric.mathfuns2.length;++t)e=numeric.mathfuns2[t],delete numeric.ops2[e];for(t=0;t<numeric.mathfuns.length;++t)e=numeric.mathfuns[t],numeric.ops1[e]=e;for(t in numeric.ops1)numeric.ops1.hasOwnProperty(t)&&(i="",e=numeric.ops1[t],-1!==numeric.myIndexOf.call(numeric.mathfuns,t)&&Math.hasOwnProperty(e)&&(i="var "+e+" = Math."+e+";\n"),numeric[t+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+e+"(ret[i]);",i),numeric[t+"eq"]=Function("x",'if(typeof x !== "object") return '+e+"x\nvar i;\nvar V = numeric."+t+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[t+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+e+"(x[i]);",i),numeric[t]=Function("x",'if(typeof x !== "object") return '+e+"(x)\nvar i;\nvar V = numeric."+t+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(t=0;t<numeric.mathfuns.length;++t)e=numeric.mathfuns[t],delete numeric.ops1[e];for(t in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(t)&&(e=numeric.mapreducers[t],numeric[t+"V"]=numeric.mapreduce2(e[0],e[1]),numeric[t]=Function("x","s","k",e[1]+'if(typeof x !== "object") {    xi = x;\n'+e[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+t+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+e[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(t,e){return"object"==typeof t?"object"==typeof e?numeric.truncVV(t,e):numeric.truncVS(t,e):"object"==typeof e?numeric.truncSV(t,e):Math.round(t/e)*e},numeric.inv=function(t){var e,o,n,i,r,s,a,t,l=numeric.dim(t),c=Math.abs,u=l[0],h=l[1],g=numeric.clone(t),p=numeric.identity(u);for(s=0;s<h;++s){var d=-1,f=-1;for(r=s;r!==u;++r)(a=c(g[r][s]))>f&&(d=r,f=a);for(o=g[d],g[d]=g[s],g[s]=o,i=p[d],p[d]=p[s],p[s]=i,t=o[s],a=s;a!==h;++a)o[a]/=t;for(a=h-1;-1!==a;--a)i[a]/=t;for(r=u-1;-1!==r;--r)if(r!==s){for(e=g[r],n=p[r],t=e[s],a=s+1;a!==h;++a)e[a]-=o[a]*t;for(a=h-1;a>0;--a)n[a]-=i[a]*t,--a,n[a]-=i[a]*t;0===a&&(n[0]-=i[0]*t)}}return p},numeric.det=function(t){var e=numeric.dim(t);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: det() only works on square matrices");var o,n,i,r,s,a,l,c,u=e[0],h=1,g=numeric.clone(t);for(n=0;n<u-1;n++){for(i=n,o=n+1;o<u;o++)Math.abs(g[o][n])>Math.abs(g[i][n])&&(i=o);for(i!==n&&(l=g[i],g[i]=g[n],g[n]=l,h*=-1),r=g[n],o=n+1;o<u;o++){for(s=g[o],a=s[n]/r[n],i=n+1;i<u-1;i+=2)c=i+1,s[i]-=r[i]*a,s[c]-=r[c]*a;i!==u&&(s[i]-=r[i]*a)}if(0===r[n])return 0;h*=r[n]}return h*g[n][n]},numeric.transpose=function(t){var e,o,n,i,r,s=t.length,a=t[0].length,l=Array(a);for(o=0;o<a;o++)l[o]=Array(s);for(e=s-1;e>=1;e-=2){for(i=t[e],n=t[e-1],o=a-1;o>=1;--o)r=l[o],r[e]=i[o],r[e-1]=n[o],--o,r=l[o],r[e]=i[o],r[e-1]=n[o];0===o&&(r=l[0],r[e]=i[0],r[e-1]=n[0])}if(0===e){for(n=t[0],o=a-1;o>=1;--o)l[o][0]=n[o],--o,l[o][0]=n[o];0===o&&(l[0][0]=n[0])}return l},numeric.negtranspose=function(t){var e,o,n,i,r,s=t.length,a=t[0].length,l=Array(a);for(o=0;o<a;o++)l[o]=Array(s);for(e=s-1;e>=1;e-=2){for(i=t[e],n=t[e-1],o=a-1;o>=1;--o)r=l[o],r[e]=-i[o],r[e-1]=-n[o],--o,r=l[o],r[e]=-i[o],r[e-1]=-n[o];0===o&&(r=l[0],r[e]=-i[0],r[e-1]=-n[0])}if(0===e){for(n=t[0],o=a-1;o>=1;--o)l[o][0]=-n[o],--o,l[o][0]=-n[o];0===o&&(l[0][0]=-n[0])}return l},numeric._random=function t(e,o){var n,i,r=e[o],s=Array(r);if(o===e.length-1){for(i=Math.random,n=r-1;n>=1;n-=2)s[n]=i(),s[n-1]=i();return 0===n&&(s[0]=i()),s}for(n=r-1;n>=0;n--)s[n]=t(e,o+1);return s},numeric.random=function(t){return numeric._random(t,0)},numeric.norm2=function(t){return Math.sqrt(numeric.norm2Squared(t))},numeric.linspace=function(t,e,o){if(void 0===o&&(o=Math.max(Math.round(e-t)+1,1)),o<2)return 1===o?[t]:[];var n,i=Array(o);for(o--,n=o;n>=0;n--)i[n]=(n*e+(o-n)*t)/o;return i},numeric.getBlock=function(t,e,o){function n(t,r){var s,a=e[r],l=o[r]-a,c=Array(l);if(r===i.length-1){for(s=l;s>=0;s--)c[s]=t[s+a];return c}for(s=l;s>=0;s--)c[s]=n(t[s+a],r+1);return c}var i=numeric.dim(t);return n(t,0)},numeric.setBlock=function(t,e,o,n){function i(t,n,s){var a,l=e[s],c=o[s]-l;if(s===r.length-1)for(a=c;a>=0;a--)t[a+l]=n[a];for(a=c;a>=0;a--)i(t[a+l],n[a],s+1)}var r=numeric.dim(t);return i(t,n,0),t},numeric.getRange=function(t,e,o){var n,i,r,s,a=e.length,l=o.length,c=Array(a);for(n=a-1;-1!==n;--n)for(c[n]=Array(l),r=c[n],s=t[e[n]],i=l-1;-1!==i;--i)r[i]=s[o[i]];return c},numeric.blockMatrix=function(t){var e=numeric.dim(t);if(e.length<4)return numeric.blockMatrix([t]);var o,n,i,r,s,a=e[0],l=e[1];for(o=0,n=0,i=0;i<a;++i)o+=t[i][0].length;for(r=0;r<l;++r)n+=t[0][r][0].length;var c=Array(o);for(i=0;i<o;++i)c[i]=Array(n);var u,h,g,p,d,f=0;for(i=0;i<a;++i){for(u=n,r=l-1;-1!==r;--r)for(s=t[i][r],u-=s[0].length,g=s.length-1;-1!==g;--g)for(d=s[g],h=c[f+g],p=d.length-1;-1!==p;--p)h[u+p]=d[p];f+=t[i][0].length}return c},numeric.tensor=function(t,e){if("number"==typeof t||"number"==typeof e)return numeric.mul(t,e);var o=numeric.dim(t),n=numeric.dim(e);if(1!==o.length||1!==n.length)throw new Error("numeric: tensor product is only defined for vectors");var i,r,s,a,l=o[0],c=n[0],u=Array(l);for(r=l-1;r>=0;r--){for(i=Array(c),a=t[r],s=c-1;s>=3;--s)i[s]=a*e[s],--s,i[s]=a*e[s],--s,i[s]=a*e[s],--s,i[s]=a*e[s];for(;s>=0;)i[s]=a*e[s],--s;u[r]=i}return u},numeric.T=function(t,e){this.x=t,this.y=e},numeric.t=function(t,e){return new numeric.T(t,e)},numeric.Tbinop=function(t,e,o,n,i){numeric.indexOf;if("string"!=typeof i){var r;i="";for(r in numeric)numeric.hasOwnProperty(r)&&(t.indexOf(r)>=0||e.indexOf(r)>=0||o.indexOf(r)>=0||n.indexOf(r)>=0)&&r.length>1&&(i+="var "+r+" = numeric."+r+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+i+"\nif(x.y) {  if(y.y) {    return new numeric.T("+n+");\n  }\n  return new numeric.T("+o+");\n}\nif(y.y) {\n  return new numeric.T("+e+");\n}\nreturn new numeric.T("+t+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var t=numeric.mul,e=numeric.div;if(this.y){var o=numeric.add(t(this.x,this.x),t(this.y,this.y));return new numeric.T(e(this.x,o),e(numeric.neg(this.y),o))}return new T(e(1,this.x))},numeric.T.prototype.div=function(t){if(t instanceof numeric.T||(t=new numeric.T(t)),t.y)return this.mul(t.reciprocal());var e=numeric.div;return this.y?new numeric.T(e(this.x,t.x),e(this.y,t.x)):new numeric.T(e(this.x,t.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var t=numeric.transpose,e=this.x,o=this.y;return o?new numeric.T(t(e),t(o)):new numeric.T(t(e))},numeric.T.prototype.transjugate=function(){var t=numeric.transpose,e=this.x,o=this.y;return o?new numeric.T(t(e),numeric.negtranspose(o)):new numeric.T(t(e))},numeric.Tunop=function(t,e,o){return"string"!=typeof o&&(o=""),Function("var x = this;\n"+o+"\nif(x.y) {  "+e+";\n}\n"+t+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var t=this;if(void 0===t.y)return new numeric.T(numeric.inv(t.x));var e,o,n,i,r,s,a,l,c,u,h,e,o,n,g,p,d,f,m,y,v,_=t.x.length,b=numeric.identity(_),E=numeric.rep([_,_],0),x=numeric.clone(t.x),S=numeric.clone(t.y);for(e=0;e<_;e++){for(d=x[e][e],f=S[e][e],g=d*d+f*f,n=e,o=e+1;o<_;o++)d=x[o][e],f=S[o][e],(p=d*d+f*f)>g&&(n=o,g=p);for(n!==e&&(v=x[e],x[e]=x[n],x[n]=v,v=S[e],S[e]=S[n],S[n]=v,v=b[e],b[e]=b[n],b[n]=v,v=E[e],E[e]=E[n],E[n]=v),i=x[e],r=S[e],l=b[e],c=E[e],d=i[e],f=r[e],o=e+1;o<_;o++)m=i[o],y=r[o],i[o]=(m*d+y*f)/g,r[o]=(y*d-m*f)/g;for(o=0;o<_;o++)m=l[o],y=c[o],l[o]=(m*d+y*f)/g,c[o]=(y*d-m*f)/g;for(o=e+1;o<_;o++){for(s=x[o],a=S[o],u=b[o],h=E[o],d=s[e],f=a[e],n=e+1;n<_;n++)m=i[n],y=r[n],s[n]-=m*d-y*f,a[n]-=y*d+m*f;for(n=0;n<_;n++)m=l[n],y=c[n],u[n]-=m*d-y*f,h[n]-=y*d+m*f}}for(e=_-1;e>0;e--)for(l=b[e],c=E[e],o=e-1;o>=0;o--)for(u=b[o],h=E[o],d=x[o][e],f=S[o][e],n=_-1;n>=0;n--)m=l[n],y=c[n],u[n]-=d*m-f*y,h[n]-=d*y+f*m;return new numeric.T(b,E)},numeric.T.prototype.get=function(t){var e,o=this.x,n=this.y,i=0,r=t.length;if(n){for(;i<r;)e=t[i],o=o[e],n=n[e],i++;return new numeric.T(o,n)}for(;i<r;)e=t[i],o=o[e],i++;return new numeric.T(o)},numeric.T.prototype.set=function(t,e){var o,n=this.x,i=this.y,r=0,s=t.length,a=e.x,l=e.y;if(0===s)return l?this.y=l:i&&(this.y=void 0),this.x=n,this;if(l){for(i||(i=numeric.rep(numeric.dim(n),0),this.y=i);r<s-1;)o=t[r],n=n[o],i=i[o],r++;return o=t[r],n[o]=a,i[o]=l,this}if(i){for(;r<s-1;)o=t[r],n=n[o],i=i[o],r++;return o=t[r],n[o]=a,a instanceof Array?i[o]=numeric.rep(numeric.dim(a),0):i[o]=0,this}for(;r<s-1;)o=t[r],n=n[o],r++;return o=t[r],n[o]=a,this},numeric.T.prototype.getRows=function(t,e){var o,n,i=e-t+1,r=Array(i),s=this.x,a=this.y;for(o=t;o<=e;o++)r[o-t]=s[o];if(a){for(n=Array(i),o=t;o<=e;o++)n[o-t]=a[o];return new numeric.T(r,n)}return new numeric.T(r)},numeric.T.prototype.setRows=function(t,e,o){var n,i=this.x,r=this.y,s=o.x,a=o.y;for(n=t;n<=e;n++)i[n]=s[n-t];if(a)for(r||(r=numeric.rep(numeric.dim(i),0),this.y=r),n=t;n<=e;n++)r[n]=a[n-t];else if(r)for(n=t;n<=e;n++)r[n]=numeric.rep([s[n-t].length],0);return this},numeric.T.prototype.getRow=function(t){var e=this.x,o=this.y;return o?new numeric.T(e[t],o[t]):new numeric.T(e[t])},numeric.T.prototype.setRow=function(t,e){var o=this.x,n=this.y,i=e.x,r=e.y;return o[t]=i,r?(n||(n=numeric.rep(numeric.dim(o),0),this.y=n),n[t]=r):n&&(n=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(t,e){var o=this.x,n=this.y,i=numeric.getBlock;return n?new numeric.T(i(o,t,e),i(n,t,e)):new numeric.T(i(o,t,e))},numeric.T.prototype.setBlock=function(t,e,o){o instanceof numeric.T||(o=new numeric.T(o));var n=this.x,i=this.y,r=numeric.setBlock,s=o.x,a=o.y;if(a)return i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),r(n,t,e,s),r(i,t,e,a),this;r(n,t,e,s),i&&r(i,t,e,numeric.rep(numeric.dim(s),0))},numeric.T.rep=function(t,e){var o=numeric.T;e instanceof o||(e=new o(e));var n=e.x,i=e.y,r=numeric.rep;return i?new o(r(t,n),r(t,i)):new o(r(t,n))},numeric.T.diag=function(t){t instanceof numeric.T||(t=new numeric.T(t));var e=t.x,o=t.y,n=numeric.diag;return o?new numeric.T(n(e),n(o)):new numeric.T(n(e))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(t){return new numeric.T(numeric.identity(t))},numeric.T.prototype.getDiag=function(){var t=numeric,e=this.x,o=this.y;return o?new t.T(t.getDiag(e),t.getDiag(o)):new t.T(t.getDiag(e))},numeric.house=function(t){var e=numeric.clone(t),o=t[0]>=0?1:-1,n=o*numeric.norm2(t);e[0]+=n;var i=numeric.norm2(e);if(0===i)throw new Error("eig: internal error");return numeric.div(e,i)},numeric.toUpperHessenberg=function(t){var e=numeric.dim(t);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var o,n,i,r,s,a,l,c,u,h,g=e[0],p=numeric.clone(t),d=numeric.identity(g);for(n=0;n<g-2;n++){for(r=Array(g-n-1),o=n+1;o<g;o++)r[o-n-1]=p[o][n];if(numeric.norm2(r)>0){for(s=numeric.house(r),a=numeric.getBlock(p,[n+1,n],[g-1,g-1]),l=numeric.tensor(s,numeric.dot(s,a)),o=n+1;o<g;o++)for(c=p[o],u=l[o-n-1],i=n;i<g;i++)c[i]-=2*u[i-n];for(a=numeric.getBlock(p,[0,n+1],[g-1,g-1]),l=numeric.tensor(numeric.dot(a,s),s),o=0;o<g;o++)for(c=p[o],u=l[o],i=n+1;i<g;i++)c[i]-=2*u[i-n-1];for(a=Array(g-n-1),o=n+1;o<g;o++)a[o-n-1]=d[o];for(l=numeric.tensor(s,numeric.dot(s,a)),o=n+1;o<g;o++)for(h=d[o],u=l[o-n-1],i=0;i<g;i++)h[i]-=2*u[i]}}return{H:p,Q:d}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(t,e){void 0===e&&(e=1e4),t=numeric.clone(t);var o,n,i,r,s,a,l,c,u,h,g,p,d,f,m,y,v,_,b=(numeric.clone(t),numeric.dim(t)),E=b[0],x=numeric.identity(E);if(E<3)return{Q:x,B:[[0,E-1]]};var S=numeric.epsilon;for(_=0;_<e;_++){for(y=0;y<E-1;y++)if(Math.abs(t[y+1][y])<S*(Math.abs(t[y][y])+Math.abs(t[y+1][y+1]))){var T=numeric.QRFrancis(numeric.getBlock(t,[0,0],[y,y]),e),w=numeric.QRFrancis(numeric.getBlock(t,[y+1,y+1],[E-1,E-1]),e);for(p=Array(y+1),m=0;m<=y;m++)p[m]=x[m];for(d=numeric.dot(T.Q,p),m=0;m<=y;m++)x[m]=d[m];for(p=Array(E-y-1),m=y+1;m<E;m++)p[m-y-1]=x[m];for(d=numeric.dot(w.Q,p),m=y+1;m<E;m++)x[m]=d[m-y-1];return{Q:x,B:T.B.concat(numeric.add(w.B,y+1))}}if(i=t[E-2][E-2],r=t[E-2][E-1],s=t[E-1][E-2],a=t[E-1][E-1],c=i+a,l=i*a-r*s,u=numeric.getBlock(t,[0,0],[2,2]),c*c>=4*l){var C,k;C=.5*(c+Math.sqrt(c*c-4*l)),k=.5*(c-Math.sqrt(c*c-4*l)),u=numeric.add(numeric.sub(numeric.dot(u,u),numeric.mul(u,C+k)),numeric.diag(numeric.rep([3],C*k)))}else u=numeric.add(numeric.sub(numeric.dot(u,u),numeric.mul(u,c)),numeric.diag(numeric.rep([3],l)));for(o=[u[0][0],u[1][0],u[2][0]],n=numeric.house(o),p=[t[0],t[1],t[2]],d=numeric.tensor(n,numeric.dot(n,p)),m=0;m<3;m++)for(g=t[m],f=d[m],v=0;v<E;v++)g[v]-=2*f[v];for(p=numeric.getBlock(t,[0,0],[E-1,2]),d=numeric.tensor(numeric.dot(p,n),n),m=0;m<E;m++)for(g=t[m],f=d[m],v=0;v<3;v++)g[v]-=2*f[v];for(p=[x[0],x[1],x[2]],d=numeric.tensor(n,numeric.dot(n,p)),m=0;m<3;m++)for(h=x[m],f=d[m],v=0;v<E;v++)h[v]-=2*f[v];var A;for(y=0;y<E-2;y++){for(v=y;v<=y+1;v++)if(Math.abs(t[v+1][v])<S*(Math.abs(t[v][v])+Math.abs(t[v+1][v+1]))){var T=numeric.QRFrancis(numeric.getBlock(t,[0,0],[v,v]),e),w=numeric.QRFrancis(numeric.getBlock(t,[v+1,v+1],[E-1,E-1]),e);for(p=Array(v+1),m=0;m<=v;m++)p[m]=x[m];for(d=numeric.dot(T.Q,p),m=0;m<=v;m++)x[m]=d[m];for(p=Array(E-v-1),m=v+1;m<E;m++)p[m-v-1]=x[m];for(d=numeric.dot(w.Q,p),m=v+1;m<E;m++)x[m]=d[m-v-1];return{Q:x,B:T.B.concat(numeric.add(w.B,v+1))}}for(A=Math.min(E-1,y+3),o=Array(A-y),m=y+1;m<=A;m++)o[m-y-1]=t[m][y];for(n=numeric.house(o),p=numeric.getBlock(t,[y+1,y],[A,E-1]),d=numeric.tensor(n,numeric.dot(n,p)),m=y+1;m<=A;m++)for(g=t[m],f=d[m-y-1],v=y;v<E;v++)g[v]-=2*f[v-y];for(p=numeric.getBlock(t,[0,y+1],[E-1,A]),d=numeric.tensor(numeric.dot(p,n),n),m=0;m<E;m++)for(g=t[m],f=d[m],v=y+1;v<=A;v++)g[v]-=2*f[v-y-1];for(p=Array(A-y),m=y+1;m<=A;m++)p[m-y-1]=x[m];for(d=numeric.tensor(n,numeric.dot(n,p)),m=y+1;m<=A;m++)for(h=x[m],f=d[m-y-1],v=0;v<E;v++)h[v]-=2*f[v]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(t,e){var o,n,i,r,s,a,l,c,u,h,g,p,d,f,m,y,v,_=numeric.toUpperHessenberg(t),b=numeric.QRFrancis(_.H,e),E=numeric.T,x=t.length,S=b.B,T=numeric.dot(b.Q,numeric.dot(_.H,numeric.transpose(b.Q))),w=new E(numeric.dot(b.Q,_.Q)),C=S.length,k=Math.sqrt;for(n=0;n<C;n++)if((o=S[n][0])!==S[n][1]){if(r=o+1,s=T[o][o],a=T[o][r],l=T[r][o],c=T[r][r],0===a&&0===l)continue;u=-s-c,h=s*c-a*l,g=u*u-4*h,g>=0?(p=u<0?-.5*(u-k(g)):-.5*(u+k(g)),y=(s-p)*(s-p)+a*a,v=l*l+(c-p)*(c-p),y>v?(y=k(y),f=(s-p)/y,m=a/y):(v=k(v),f=l/v,m=(c-p)/v),i=new E([[m,-f],[f,m]]),w.setRows(o,r,i.dot(w.getRows(o,r)))):(p=-.5*u,d=.5*k(-g),y=(s-p)*(s-p)+a*a,v=l*l+(c-p)*(c-p),y>v?(y=k(y+d*d),f=(s-p)/y,m=a/y,p=0,d/=y):(v=k(v+d*d),f=l/v,m=(c-p)/v,p=d/v,d=0),i=new E([[m,-f],[f,m]],[[p,d],[d,-p]]),w.setRows(o,r,i.dot(w.getRows(o,r))))}var A=w.dot(t).dot(w.transjugate()),x=t.length,I=numeric.T.identity(x);for(r=0;r<x;r++)if(r>0)for(n=r-1;n>=0;n--){var B=A.get([n,n]),M=A.get([r,r]);numeric.neq(B.x,M.x)||numeric.neq(B.y,M.y)?(p=A.getRow(n).getBlock([n],[r-1]),d=I.getRow(r).getBlock([n],[r-1]),I.set([r,n],A.get([n,r]).neg().sub(p.dot(d)).div(B.sub(M)))):I.setRow(r,I.getRow(n))}for(r=0;r<x;r++)p=I.getRow(r),I.setRow(r,p.div(p.norm2()));return I=I.transpose(),I=w.transjugate().dot(I),{lambda:A.getDiag(),E:I}},numeric.ccsSparse=function(t){var e,o,n,i,r=t.length,s=[];for(n=r-1;-1!==n;--n){o=t[n];for(i in o){for(i=parseInt(i);i>=s.length;)s[s.length]=0;0!==o[i]&&s[i]++}}var e=s.length,a=Array(e+1);for(a[0]=0,n=0;n<e;++n)a[n+1]=a[n]+s[n];var l=Array(a[e]),c=Array(a[e]);for(n=r-1;-1!==n;--n){o=t[n];for(i in o)0!==o[i]&&(s[i]--,l[a[i]+s[i]]=n,c[a[i]+s[i]]=o[i])}return[a,l,c]},numeric.ccsFull=function(t){var e,o,n,i,r=t[0],s=t[1],a=t[2],l=numeric.ccsDim(t),c=l[0],u=l[1],h=numeric.rep([c,u],0);for(e=0;e<u;e++)for(n=r[e],i=r[e+1],o=n;o<i;++o)h[s[o]][e]=a[o];return h},numeric.ccsTSolve=function(t,e,o,n,i){function r(t){var e;if(0===o[t]){for(o[t]=1,e=s[t];e<s[t+1];++e)r(a[e]);i[h]=t,++h}}var s=t[0],a=t[1],l=t[2],c=s.length-1,u=Math.max,h=0;void 0===n&&(o=numeric.rep([c],0)),void 0===n&&(n=numeric.linspace(0,o.length-1)),void 0===i&&(i=[]);var g,p,d,f,m,y,v;for(g=n.length-1;-1!==g;--g)r(n[g]);for(i.length=h,g=i.length-1;-1!==g;--g)o[i[g]]=0;for(g=n.length-1;-1!==g;--g)p=n[g],o[p]=e[p];for(g=i.length-1;-1!==g;--g){for(p=i[g],d=s[p],f=u(s[p+1],d),m=d;m!==f;++m)if(a[m]===p){o[p]/=l[m];break}for(v=o[p],m=d;m!==f;++m)(y=a[m])!==p&&(o[y]-=v*l[m])}return o},numeric.ccsDFS=function(t){this.k=Array(t),this.k1=Array(t),this.j=Array(t)},numeric.ccsDFS.prototype.dfs=function(t,e,o,n,i,r){var s,a,l,c=0,u=i.length,h=this.k,g=this.k1,p=this.j;if(0===n[t])for(n[t]=1,p[0]=t,h[0]=a=e[t],g[0]=l=e[t+1];;)if(a>=l){if(i[u]=p[c],0===c)return;++u,--c,a=h[c],l=g[c]}else s=r[o[a]],0===n[s]?(n[s]=1,h[c]=a,++c,p[c]=s,a=e[s],g[c]=l=e[s+1]):++a},numeric.ccsLPSolve=function(t,e,o,n,i,r,s){var a,l,c,u,h,g,p,d,f,m=t[0],y=t[1],v=t[2],_=(m.length,e[0]),b=e[1],E=e[2];for(l=_[i],c=_[i+1],n.length=0,a=l;a<c;++a)s.dfs(r[b[a]],m,y,o,n,r);for(a=n.length-1;-1!==a;--a)o[n[a]]=0;for(a=l;a!==c;++a)u=r[b[a]],o[u]=E[a];for(a=n.length-1;-1!==a;--a){for(u=n[a],h=m[u],g=m[u+1],p=h;p<g;++p)if(r[y[p]]===u){o[u]/=v[p];break}for(f=o[u],p=h;p<g;++p)(d=r[y[p]])!==u&&(o[d]-=f*v[p])}return o},numeric.ccsLUP1=function(t,e){var o,n,i,r,s,a,l,c=t[0].length-1,u=[numeric.rep([c+1],0),[],[]],h=[numeric.rep([c+1],0),[],[]],g=u[0],p=u[1],d=u[2],f=h[0],m=h[1],y=h[2],v=numeric.rep([c],0),_=numeric.rep([c],0),b=numeric.ccsLPSolve,E=(Math.max,Math.abs),x=numeric.linspace(0,c-1),S=numeric.linspace(0,c-1),T=new numeric.ccsDFS(c);for(void 0===e&&(e=1),o=0;o<c;++o){for(b(u,t,v,_,o,S,T),r=-1,s=-1,n=_.length-1;-1!==n;--n)(i=_[n])<=o||(a=E(v[i]))>r&&(s=i,r=a);for(E(v[o])<e*r&&(n=x[o],r=x[s],x[o]=r,S[r]=o,x[s]=n,S[n]=s,r=v[o],v[o]=v[s],v[s]=r),r=g[o],s=f[o],l=v[o],p[r]=x[o],d[r]=1,++r,n=_.length-1;-1!==n;--n)i=_[n],a=v[i],_[n]=0,v[i]=0,i<=o?(m[s]=i,y[s]=a,++s):(p[r]=x[i],d[r]=a/l,++r);g[o+1]=r,f[o+1]=s}for(n=p.length-1;-1!==n;--n)p[n]=S[p[n]];return{L:u,U:h,P:x,Pinv:S}},numeric.ccsDFS0=function(t){this.k=Array(t),this.k1=Array(t),this.j=Array(t)},numeric.ccsDFS0.prototype.dfs=function(t,e,o,n,i,r,s){var a,l,c,u=0,h=i.length,g=this.k,p=this.k1,d=this.j;if(0===n[t])for(n[t]=1,d[0]=t,g[0]=l=e[r[t]],p[0]=c=e[r[t]+1];;){if(isNaN(l))throw new Error("Ow!");if(l>=c){if(i[h]=r[d[u]],0===u)return;++h,--u,l=g[u],c=p[u]}else a=o[l],0===n[a]?(n[a]=1,g[u]=l,++u,d[u]=a,a=r[a],l=e[a],p[u]=c=e[a+1]):++l}},numeric.ccsLPSolve0=function(t,e,o,n,i,r,s,a){var l,c,u,h,g,p,d,f,m,y=t[0],v=t[1],_=t[2],b=(y.length,e[0]),E=e[1],x=e[2];for(c=b[i],u=b[i+1],n.length=0,l=c;l<u;++l)a.dfs(E[l],y,v,o,n,r,s);for(l=n.length-1;-1!==l;--l)h=n[l],o[s[h]]=0;for(l=c;l!==u;++l)h=E[l],o[h]=x[l];for(l=n.length-1;-1!==l;--l){for(h=n[l],f=s[h],g=y[h],p=y[h+1],d=g;d<p;++d)if(v[d]===f){o[f]/=_[d];break}for(m=o[f],d=g;d<p;++d)o[v[d]]-=m*_[d];o[f]=m}},numeric.ccsLUP0=function(t,e){var o,n,i,r,s,a,l,c=t[0].length-1,u=[numeric.rep([c+1],0),[],[]],h=[numeric.rep([c+1],0),[],[]],g=u[0],p=u[1],d=u[2],f=h[0],m=h[1],y=h[2],v=numeric.rep([c],0),_=numeric.rep([c],0),b=numeric.ccsLPSolve0,E=(Math.max,Math.abs),x=numeric.linspace(0,c-1),S=numeric.linspace(0,c-1),T=new numeric.ccsDFS0(c);for(void 0===e&&(e=1),o=0;o<c;++o){for(b(u,t,v,_,o,S,x,T),r=-1,s=-1,n=_.length-1;-1!==n;--n)(i=_[n])<=o||(a=E(v[x[i]]))>r&&(s=i,r=a);for(E(v[x[o]])<e*r&&(n=x[o],r=x[s],x[o]=r,S[r]=o,x[s]=n,S[n]=s),r=g[o],s=f[o],l=v[x[o]],p[r]=x[o],d[r]=1,++r,n=_.length-1;-1!==n;--n)i=_[n],a=v[x[i]],_[n]=0,v[x[i]]=0,i<=o?(m[s]=i,y[s]=a,++s):(p[r]=x[i],d[r]=a/l,++r);g[o+1]=r,f[o+1]=s}for(n=p.length-1;-1!==n;--n)p[n]=S[p[n]];return{L:u,U:h,P:x,Pinv:S}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(t){return[numeric.sup(t[1])+1,t[0].length-1]},numeric.ccsGetBlock=function(t,e,o){var n=numeric.ccsDim(t),i=n[0],r=n[1];void 0===e?e=numeric.linspace(0,i-1):"number"==typeof e&&(e=[e]),void 0===o?o=numeric.linspace(0,r-1):"number"==typeof o&&(o=[o]);var s,a,l,c,u,h=e.length,g=o.length,p=numeric.rep([r],0),d=[],f=[],m=[p,d,f],y=t[0],v=t[1],_=t[2],b=numeric.rep([i],0),E=0,x=numeric.rep([i],0);for(a=0;a<g;++a){c=o[a];var S=y[c],T=y[c+1];for(s=S;s<T;++s)l=v[s],x[l]=1,b[l]=_[s];for(s=0;s<h;++s)u=e[s],x[u]&&(d[E]=s,f[E]=b[e[s]],++E);for(s=S;s<T;++s)l=v[s],x[l]=0;p[a+1]=E}return m},numeric.ccsDot=function(t,e){var o,n,i,r,s,a,l,c,u,h,g,p=t[0],d=t[1],f=t[2],m=e[0],y=e[1],v=e[2],_=numeric.ccsDim(t),b=numeric.ccsDim(e),E=_[0],x=(_[1],b[1]),S=numeric.rep([E],0),T=numeric.rep([E],0),w=Array(E),C=numeric.rep([x],0),k=[],A=[],I=[C,k,A];for(i=0;i!==x;++i){for(r=m[i],s=m[i+1],u=0,n=r;n<s;++n)for(h=y[n],g=v[n],a=p[h],l=p[h+1],o=a;o<l;++o)c=d[o],0===T[c]&&(w[u]=c,T[c]=1,u+=1),S[c]=S[c]+f[o]*g;for(r=C[i],s=r+u,C[i+1]=s,n=u-1;-1!==n;--n)g=r+n,o=w[n],k[g]=o,A[g]=S[o],T[o]=0,S[o]=0;C[i+1]=C[i]+u}return I},numeric.ccsLUPSolve=function(t,e){var o=t.L,n=t.U,i=(t.P,e[0]),r=!1;"object"!=typeof i&&(e=[[0,e.length],numeric.linspace(0,e.length-1),e],i=e[0],r=!0);var s,a,l,c,u,h,g=e[1],p=e[2],d=o[0].length-1,f=i.length-1,m=numeric.rep([d],0),y=Array(d),v=numeric.rep([d],0),_=Array(d),b=numeric.rep([f+1],0),E=[],x=[],S=numeric.ccsTSolve,T=0;for(s=0;s<f;++s){for(u=0,l=i[s],c=i[s+1],a=l;a<c;++a)h=t.Pinv[g[a]],_[u]=h,v[h]=p[a],++u;for(_.length=u,S(o,v,m,_,y),a=_.length-1;-1!==a;--a)v[_[a]]=0;if(S(n,m,v,y,_),r)return v;for(a=y.length-1;-1!==a;--a)m[y[a]]=0;for(a=_.length-1;-1!==a;--a)h=_[a],E[T]=h,x[T]=v[h],v[h]=0,++T;b[s+1]=T}return[b,E,x]},numeric.ccsbinop=function(t,e){return void 0===e&&(e=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+e+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+t+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(t){var e,o=t[0],n=t[1],i=t[2],r=numeric.sup(n)+1,s=o.length,a=numeric.rep([r],0),l=Array(s),c=Array(s),u=numeric.rep([r],0);for(e=0;e<s;++e)u[n[e]]++;for(e=0;e<r;++e)a[e+1]=a[e]+u[e];var h,g,p=a.slice(0);for(e=0;e<s;++e)g=n[e],h=p[g],l[h]=o[e],c[h]=i[e],p[g]=p[g]+1;return[a,l,c]},numeric.ccsGather=function(t){var e,o,n,i,r,s=t[0],a=t[1],l=t[2],c=s.length-1,u=a.length,h=Array(u),g=Array(u),p=Array(u);for(r=0,e=0;e<c;++e)for(n=s[e],i=s[e+1],o=n;o!==i;++o)g[r]=e,h[r]=a[o],p[r]=l[o],++r;return[h,g,p]},numeric.sdim=function t(e,o,n){if(void 0===o&&(o=[]),"object"!=typeof e)return o;void 0===n&&(n=0),n in o||(o[n]=0),e.length>o[n]&&(o[n]=e.length);var i;for(i in e)e.hasOwnProperty(i)&&t(e[i],o,n+1);return o},numeric.sclone=function t(e,o,n){void 0===o&&(o=0),void 0===n&&(n=numeric.sdim(e).length);var i,r=Array(e.length);if(o===n-1){for(i in e)e.hasOwnProperty(i)&&(r[i]=e[i]);return r}for(i in e)e.hasOwnProperty(i)&&(r[i]=t(e[i],o+1,n));return r},numeric.sdiag=function(t){var e,o,n=t.length,i=Array(n);for(e=n-1;e>=1;e-=2)o=e-1,i[e]=[],i[e][e]=t[e],i[o]=[],i[o][o]=t[o];return 0===e&&(i[0]=[],i[0][0]=t[e]),i},numeric.sidentity=function(t){return numeric.sdiag(numeric.rep([t],1))},numeric.stranspose=function(t){var e,o,n,i=[];t.length;for(e in t)if(t.hasOwnProperty(e)){n=t[e];for(o in n)n.hasOwnProperty(o)&&("object"!=typeof i[o]&&(i[o]=[]),i[o][e]=n[o])}return i},numeric.sLUP=function(t,e){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(t,e){var o,n,i,r,s,a,l,c=t.length,u=(e.length,numeric.stranspose(e)),h=u.length,g=Array(c);for(i=c-1;i>=0;i--){for(l=[],o=t[i],s=h-1;s>=0;s--){a=0,n=u[s];for(r in o)o.hasOwnProperty(r)&&r in n&&(a+=o[r]*n[r]);a&&(l[s]=a)}g[i]=l}return g},numeric.sdotMV=function(t,e){var o,n,i,r,s=t.length,a=Array(s);for(n=s-1;n>=0;n--){o=t[n],r=0;for(i in o)o.hasOwnProperty(i)&&e[i]&&(r+=o[i]*e[i]);r&&(a[n]=r)}return a},numeric.sdotVM=function(t,e){var o,n,i,r,s=[];for(o in t)if(t.hasOwnProperty(o)){i=e[o],r=t[o];for(n in i)i.hasOwnProperty(n)&&(s[n]||(s[n]=0),s[n]+=r*i[n])}return s},numeric.sdotVV=function(t,e){var o,n=0;for(o in t)t[o]&&e[o]&&(n+=t[o]*e[o]);return n},numeric.sdot=function(t,e){var o=numeric.sdim(t).length,n=numeric.sdim(e).length;switch(1e3*o+n){case 0:return t*e;case 1001:return numeric.sdotVV(t,e);case 2001:return numeric.sdotMV(t,e);case 1002:return numeric.sdotVM(t,e);case 2002:return numeric.sdotMM(t,e);default:throw new Error("numeric.sdot not implemented for tensors of order "+o+" and "+n)}},numeric.sscatter=function(t){var e,o,n,i,r=t[0].length,s=t.length,a=[];for(o=r-1;o>=0;--o)if(t[s-1][o]){for(i=a,n=0;n<s-2;n++)e=t[n][o],i[e]||(i[e]=[]),i=i[e];i[t[n][o]]=t[n+1][o]}return a},numeric.sgather=function t(e,o,n){void 0===o&&(o=[]),void 0===n&&(n=[]);var i,r,s;i=n.length;for(r in e)if(e.hasOwnProperty(r))if(n[i]=parseInt(r),"number"==typeof(s=e[r])){if(s){if(0===o.length)for(r=i+1;r>=0;--r)o[r]=[];for(r=i;r>=0;--r)o[r].push(n[r]);o[i+1].push(s)}}else t(s,o,n);return n.length>i&&n.pop(),o},numeric.cLU=function(t){var e,o,n,i,r,s,a=t[0],l=t[1],c=t[2],u=a.length,h=0;for(e=0;e<u;e++)a[e]>h&&(h=a[e]);h++;var g,p,d,f=Array(h),m=Array(h),y=numeric.rep([h],1/0),v=numeric.rep([h],-1/0);for(n=0;n<u;n++)e=a[n],o=l[n],o<y[e]&&(y[e]=o),o>v[e]&&(v[e]=o);for(e=0;e<h-1;e++)v[e]>v[e+1]&&(v[e+1]=v[e]);for(e=h-1;e>=1;e--)y[e]<y[e-1]&&(y[e-1]=y[e]);var _=0,b=0;for(e=0;e<h;e++)m[e]=numeric.rep([v[e]-y[e]+1],0),f[e]=numeric.rep([e-y[e]],0),_+=e-y[e]+1,b+=v[e]-e+1;for(n=0;n<u;n++)e=a[n],m[e][l[n]-y[e]]=c[n];for(e=0;e<h-1;e++)for(i=e-y[e],g=m[e],o=e+1;y[o]<=e&&o<h;o++)if(r=e-y[o],s=v[e]-e,p=m[o],d=p[r]/g[i],d){for(n=1;n<=s;n++)p[n+r]-=d*g[n+i];f[o][e-y[o]]=d}var u,E,x,g=[],p=[],S=[],T=[],w=[],C=[];for(u=0,E=0,e=0;e<h;e++){for(i=y[e],r=v[e],x=m[e],o=e;o<=r;o++)x[o-i]&&(g[u]=e,p[u]=o,S[u]=x[o-i],u++);for(x=f[e],o=i;o<e;o++)x[o-i]&&(T[E]=e,w[E]=o,C[E]=x[o-i],E++);T[E]=e,w[E]=e,C[E]=1,E++}return{U:[g,p,S],L:[T,w,C]}},numeric.cLUsolve=function(t,e){var o,n,i=t.L,r=t.U,s=numeric.clone(e),a=i[0],l=i[1],c=i[2],u=r[0],h=r[1],g=r[2],p=u.length,d=(a.length,s.length);for(n=0,o=0;o<d;o++){for(;l[n]<o;)s[o]-=c[n]*s[l[n]],n++;n++}for(n=p-1,o=d-1;o>=0;o--){for(;h[n]>o;)s[o]-=g[n]*s[h[n]],n--;s[o]/=g[n],n--}return s},numeric.cgrid=function(t,e){"number"==typeof t&&(t=[t,t]);var o,n,i,r=numeric.rep(t,-1);if("function"!=typeof e)switch(e){case"L":e=function(e,o){return e>=t[0]/2||o<t[1]/2};break;default:e=function(t,e){return!0}}for(i=0,o=1;o<t[0]-1;o++)for(n=1;n<t[1]-1;n++)e(o,n)&&(r[o][n]=i,i++);return r},numeric.cdelsq=function(t){var e,o,n,i,r,s=[[-1,0],[0,-1],[0,1],[1,0]],a=numeric.dim(t),l=a[0],c=a[1],u=[],h=[],g=[];for(e=1;e<l-1;e++)for(o=1;o<c-1;o++)if(!(t[e][o]<0)){for(n=0;n<4;n++)i=e+s[n][0],r=o+s[n][1],t[i][r]<0||(u.push(t[e][o]),h.push(t[i][r]),g.push(-1));u.push(t[e][o]),h.push(t[e][o]),g.push(4)}return[u,h,g]},numeric.cdotMV=function(t,e){var o,n,i,r=t[0],s=t[1],a=t[2],l=r.length;for(i=0,n=0;n<l;n++)r[n]>i&&(i=r[n]);for(i++,o=numeric.rep([i],0),n=0;n<l;n++)o[r[n]]+=a[n]*e[s[n]];return o},numeric.Spline=function(t,e,o,n,i){this.x=t,this.yl=e,this.yr=o,this.kl=n,this.kr=i},numeric.Spline.prototype._at=function(t,e){var t,o,n,i,r=this.x,s=this.yl,a=this.yr,l=this.kl,c=this.kr,u=numeric.add,h=numeric.sub,g=numeric.mul;o=h(g(l[e],r[e+1]-r[e]),h(a[e+1],s[e])),n=u(g(c[e+1],r[e]-r[e+1]),h(a[e+1],s[e])),i=(t-r[e])/(r[e+1]-r[e]);var p=i*(1-i);return u(u(u(g(1-i,s[e]),g(i,a[e+1])),g(o,p*(1-i))),g(n,p*i))},numeric.Spline.prototype.at=function(t){if("number"==typeof t){var e,o,n,i=this.x,r=i.length,s=Math.floor;for(e=0,o=r-1;o-e>1;)n=s((e+o)/2),i[n]<=t?e=n:o=n;return this._at(t,e)}var a,r=t.length,l=Array(r);for(a=r-1;-1!==a;--a)l[a]=this.at(t[a]);return l},numeric.Spline.prototype.diff=function(){var t,e,o,n=this.x,i=this.yl,r=this.yr,s=this.kl,a=this.kr,l=i.length,c=s,u=a,h=Array(l),g=Array(l),p=numeric.add,d=numeric.mul,f=numeric.div,m=numeric.sub;for(t=l-1;-1!==t;--t)e=n[t+1]-n[t],o=m(r[t+1],i[t]),h[t]=f(p(d(o,6),d(s[t],-4*e),d(a[t+1],-2*e)),e*e),g[t+1]=f(p(d(o,-6),d(s[t],2*e),d(a[t+1],4*e)),e*e);return new numeric.Spline(n,c,u,h,g)},numeric.Spline.prototype.roots=function(){var t=[],e=this.x,o=this.yl,n=this.yr,i=this.kl,r=this.kr;"number"==typeof o[0]&&(o=[o],n=[n],i=[i],r=[r]);var s,a,l,c,u,h,g,p,d,f,m,y,v,_,b,E,x,S,T,w,C,k,A,I=o.length,B=e.length-1,t=Array(I),M=Math.sqrt;for(s=0;s!==I;++s){for(c=o[s],u=n[s],h=i[s],g=r[s],p=[],a=0;a!==B;a++){for(a>0&&u[a]*c[a]<0&&p.push(e[a]),E=e[a+1]-e[a],e[a],m=c[a],y=u[a+1],d=h[a]/E,f=g[a+1]/E,b=function(t){return t*t}(d-f+3*(m-y))+12*f*m,v=f+3*m+2*d-3*y,_=3*(f+d+2*(m-y)),b<=0?(S=v/_,x=S>e[a]&&S<e[a+1]?[e[a],S,e[a+1]]:[e[a],e[a+1]]):(S=(v-M(b))/_,T=(v+M(b))/_,x=[e[a]],S>e[a]&&S<e[a+1]&&x.push(S),T>e[a]&&T<e[a+1]&&x.push(T),x.push(e[a+1])),C=x[0],S=this._at(C,a),l=0;l<x.length-1;l++)if(k=x[l+1],T=this._at(k,a),0!==S)if(0===T||S*T>0)C=k,S=T;else{for(var L=0;!((A=(S*k-T*C)/(S-T))<=C||A>=k);)if((w=this._at(A,a))*T>0)k=A,T=w,-1===L&&(S*=.5),L=-1;else{if(!(w*S>0))break;C=A,S=w,1===L&&(T*=.5),L=1}p.push(A),C=x[l+1],S=this._at(C,a)}else p.push(C),C=k,S=T;0===T&&p.push(k)}t[s]=p}return"number"==typeof this.yl[0]?t[0]:t},numeric.spline=function(t,e,o,n){var i,r=t.length,s=[],a=[],l=[],c=numeric.sub,u=numeric.mul,h=numeric.add;for(i=r-2;i>=0;i--)a[i]=t[i+1]-t[i],l[i]=c(e[i+1],e[i]);"string"!=typeof o&&"string"!=typeof n||(o=n="periodic");var g=[[],[],[]];switch(typeof o){case"undefined":s[0]=u(3/(a[0]*a[0]),l[0]),g[0].push(0,0),g[1].push(0,1),g[2].push(2/a[0],1/a[0]);break;case"string":s[0]=h(u(3/(a[r-2]*a[r-2]),l[r-2]),u(3/(a[0]*a[0]),l[0])),g[0].push(0,0,0),g[1].push(r-2,0,1),g[2].push(1/a[r-2],2/a[r-2]+2/a[0],1/a[0]);break;default:s[0]=o,g[0].push(0),g[1].push(0),g[2].push(1)}for(i=1;i<r-1;i++)s[i]=h(u(3/(a[i-1]*a[i-1]),l[i-1]),u(3/(a[i]*a[i]),l[i])),g[0].push(i,i,i),g[1].push(i-1,i,i+1),g[2].push(1/a[i-1],2/a[i-1]+2/a[i],1/a[i]);switch(typeof n){case"undefined":s[r-1]=u(3/(a[r-2]*a[r-2]),l[r-2]),g[0].push(r-1,r-1),g[1].push(r-2,r-1),g[2].push(1/a[r-2],2/a[r-2]);break;case"string":g[1][g[1].length-1]=0;break;default:s[r-1]=n,g[0].push(r-1),g[1].push(r-1),g[2].push(1)}s="number"!=typeof s[0]?numeric.transpose(s):[s];var p=Array(s.length);if("string"==typeof o)for(i=p.length-1;-1!==i;--i)p[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(g)),s[i]),p[i][r-1]=p[i][0];else for(i=p.length-1;-1!==i;--i)p[i]=numeric.cLUsolve(numeric.cLU(g),s[i]);return p="number"==typeof e[0]?p[0]:numeric.transpose(p),new numeric.Spline(t,e,e,p,p)},numeric.fftpow2=function t(e,o){var n=e.length;if(1!==n){var i,r,s=Math.cos,a=Math.sin,l=Array(n/2),c=Array(n/2),u=Array(n/2),h=Array(n/2);for(r=n/2,i=n-1;-1!==i;--i)--r,u[r]=e[i],h[r]=o[i],--i,l[r]=e[i],c[r]=o[i];t(l,c),t(u,h),r=n/2;var g,p,d,f=-6.283185307179586/n;for(i=n-1;-1!==i;--i)--r,-1===r&&(r=n/2-1),g=f*i,p=s(g),d=a(g),e[i]=l[r]+p*u[r]-d*h[r],o[i]=c[r]+p*h[r]+d*u[r]}},numeric._ifftpow2=function t(e,o){var n=e.length;if(1!==n){var i,r,s=Math.cos,a=Math.sin,l=Array(n/2),c=Array(n/2),u=Array(n/2),h=Array(n/2);for(r=n/2,i=n-1;-1!==i;--i)--r,u[r]=e[i],h[r]=o[i],--i,l[r]=e[i],c[r]=o[i];t(l,c),t(u,h),r=n/2;var g,p,d,f=6.283185307179586/n;for(i=n-1;-1!==i;--i)--r,-1===r&&(r=n/2-1),g=f*i,p=s(g),d=a(g),e[i]=l[r]+p*u[r]-d*h[r],o[i]=c[r]+p*h[r]+d*u[r]}},numeric.ifftpow2=function(t,e){numeric._ifftpow2(t,e),numeric.diveq(t,t.length),numeric.diveq(e,e.length)},numeric.convpow2=function(t,e,o,n){numeric.fftpow2(t,e),numeric.fftpow2(o,n);var i,r,s,a,l,c=t.length;for(i=c-1;-1!==i;--i)r=t[i],a=e[i],s=o[i],l=n[i],t[i]=r*s-a*l,e[i]=r*l+a*s;numeric.ifftpow2(t,e)},numeric.T.prototype.fft=function(){var t,e,o=this.x,n=this.y,i=o.length,r=Math.log,s=r(2),a=Math.ceil(r(2*i-1)/s),l=Math.pow(2,a),c=numeric.rep([l],0),u=numeric.rep([l],0),h=Math.cos,g=Math.sin,p=-3.141592653589793/i,d=numeric.rep([l],0),f=numeric.rep([l],0);Math.floor(i/2);for(t=0;t<i;t++)d[t]=o[t];if(void 0!==n)for(t=0;t<i;t++)f[t]=n[t];for(c[0]=1,t=1;t<=l/2;t++)e=p*t*t,c[t]=h(e),u[t]=g(e),c[l-t]=h(e),u[l-t]=g(e);var m=new numeric.T(d,f),y=new numeric.T(c,u);return m=m.mul(y),numeric.convpow2(m.x,m.y,numeric.clone(y.x),numeric.neg(y.y)),m=m.mul(y),m.x.length=i,m.y.length=i,m},numeric.T.prototype.ifft=function(){var t,e,o=this.x,n=this.y,i=o.length,r=Math.log,s=r(2),a=Math.ceil(r(2*i-1)/s),l=Math.pow(2,a),c=numeric.rep([l],0),u=numeric.rep([l],0),h=Math.cos,g=Math.sin,p=3.141592653589793/i,d=numeric.rep([l],0),f=numeric.rep([l],0);Math.floor(i/2);for(t=0;t<i;t++)d[t]=o[t];if(void 0!==n)for(t=0;t<i;t++)f[t]=n[t];for(c[0]=1,t=1;t<=l/2;t++)e=p*t*t,c[t]=h(e),u[t]=g(e),c[l-t]=h(e),u[l-t]=g(e);var m=new numeric.T(d,f),y=new numeric.T(c,u);return m=m.mul(y),numeric.convpow2(m.x,m.y,numeric.clone(y.x),numeric.neg(y.y)),m=m.mul(y),m.x.length=i,m.y.length=i,m.div(i)},numeric.gradient=function(t,e){var o=e.length,n=t(e);if(isNaN(n))throw new Error("gradient: f(x) is a NaN!");var i,r,s,a,l,c,u,h,g,p,d=Math.max,f=numeric.clone(e),m=Array(o),d=(numeric.div,numeric.sub,Math.max),y=Math.abs,v=Math.min,_=0;for(i=0;i<o;i++)for(var b=d(1e-6*n,1e-8);;){if(++_>20)throw new Error("Numerical gradient fails");if(f[i]=e[i]+b,r=t(f),f[i]=e[i]-b,s=t(f),f[i]=e[i],isNaN(r)||isNaN(s))b/=16;else{if(m[i]=(r-s)/(2*b),l=e[i]-b,c=e[i],u=e[i]+b,h=(r-n)/b,g=(n-s)/b,p=d(y(m[i]),y(n),y(r),y(s),y(l),y(c),y(u),1e-8),a=v(d(y(h-m[i]),y(g-m[i]),y(h-g))/p,b/p),!(a>.001))break;b/=16}}return m},numeric.uncmin=function(t,e,o,n,i,r,s){var a=numeric.gradient;void 0===s&&(s={}),void 0===o&&(o=1e-8),void 0===n&&(n=function(e){return a(t,e)}),void 0===i&&(i=1e3),e=numeric.clone(e);var l,c,u=e.length,h=t(e);if(isNaN(h))throw new Error("uncmin: f(x0) is a NaN!");var g=Math.max,p=numeric.norm2;o=g(o,numeric.epsilon);var d,f,m,y,v,_,b,E,x,S,T=s.Hinv||numeric.identity(u),w=numeric.dot,C=(numeric.inv,numeric.sub),k=numeric.add,A=numeric.tensor,I=numeric.div,B=numeric.mul,M=numeric.all,L=numeric.isFinite,N=numeric.neg,R=0,D="";for(f=n(e);R<i;){if("function"==typeof r&&r(R,e,h,f,T)){D="Callback returned true";break}if(!M(L(f))){D="Gradient has Infinity or NaN";break}if(d=N(w(T,f)),!M(L(d))){D="Search direction has Infinity or NaN";break}if((S=p(d))<o){D="Newton step smaller than tol";break}for(x=1,c=w(f,d),v=e;R<i&&!(x*S<o)&&(y=B(d,x),v=k(e,y),(l=t(v))-h>=.1*x*c||isNaN(l));)x*=.5,++R;if(x*S<o){D="Line search step size smaller than tol";break}if(R===i){D="maxit reached during line search";break}m=n(v),_=C(m,f),E=w(_,y),b=w(T,_),T=C(k(T,B((E+w(_,b))/(E*E),A(y,y))),I(k(A(b,y),A(y,b)),E)),e=v,h=l,f=m,++R}return{solution:e,f:h,gradient:f,invHessian:T,iterations:R,message:D}},numeric.Dopri=function(t,e,o,n,i,r,s){this.x=t,this.y=e,this.f=o,this.ymid=n,this.iterations=i,this.events=s,this.message=r},numeric.Dopri.prototype._at=function(t,e){function o(t){return t*t}var n,i,r,s,a,l,t,c,u,h,g,p=this,d=p.x,f=p.y,m=p.f,y=p.ymid,v=(d.length,Math.floor,numeric.add),_=numeric.mul,b=numeric.sub;return n=d[e],i=d[e+1],s=f[e],a=f[e+1],c=i-n,r=n+.5*c,l=y[e],u=b(m[e],_(s,1/(n-r)+2/(n-i))),h=b(m[e+1],_(a,1/(i-r)+2/(i-n))),g=[o(t-i)*(t-r)/o(n-i)/(n-r),o(t-n)*o(t-i)/o(n-r)/o(i-r),o(t-n)*(t-r)/o(i-n)/(i-r),(t-n)*o(t-i)*(t-r)/o(n-i)/(n-r),(t-i)*o(t-n)*(t-r)/o(n-i)/(i-r)],v(v(v(v(_(s,g[0]),_(l,g[1])),_(a,g[2])),_(u,g[3])),_(h,g[4]))},numeric.Dopri.prototype.at=function(t){var e,o,n,i=Math.floor;if("number"!=typeof t){var r=t.length,s=Array(r);for(e=r-1;-1!==e;--e)s[e]=this.at(t[e]);return s}var a=this.x;for(e=0,o=a.length-1;o-e>1;)n=i(.5*(e+o)),a[n]<=t?e=n:o=n;return this._at(t,e)},numeric.dopri=function(t,e,o,n,i,r,s){void 0===i&&(i=1e-6),void 0===r&&(r=1e3);var a,l,c,u,h,g,p,d,f,m,y,v,_,b=[t],E=[o],x=[n(t,o)],S=[],T=[.075,.225],w=[44/45,-56/15,32/9],C=[19372/6561,-25360/2187,64448/6561,-212/729],k=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],A=[35/384,0,500/1113,125/192,-2187/6784,11/84],I=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],B=[.2,.3,.8,8/9,1,1],M=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],L=0,N=(e-t)/10,R=0,D=numeric.add,O=numeric.mul,P=(Math.max,Math.min),j=Math.abs,F=numeric.norminf,H=Math.pow,U=numeric.any,G=numeric.lt,V=numeric.and,W=(numeric.sub,new numeric.Dopri(b,E,x,S,-1,""));for("function"==typeof s&&(y=s(t,o));t<e&&R<r;)if(++R,t+N>e&&(N=e-t),a=n(t+B[0]*N,D(o,O(.2*N,x[L]))),l=n(t+B[1]*N,D(D(o,O(T[0]*N,x[L])),O(T[1]*N,a))),c=n(t+B[2]*N,D(D(D(o,O(w[0]*N,x[L])),O(w[1]*N,a)),O(w[2]*N,l))),u=n(t+B[3]*N,D(D(D(D(o,O(C[0]*N,x[L])),O(C[1]*N,a)),O(C[2]*N,l)),O(C[3]*N,c))),h=n(t+B[4]*N,D(D(D(D(D(o,O(k[0]*N,x[L])),O(k[1]*N,a)),O(k[2]*N,l)),O(k[3]*N,c)),O(k[4]*N,u))),f=D(D(D(D(D(o,O(x[L],N*A[0])),O(l,N*A[2])),O(c,N*A[3])),O(u,N*A[4])),O(h,N*A[5])),g=n(t+N,f),p=D(D(D(D(D(O(x[L],N*M[0]),O(l,N*M[2])),O(c,N*M[3])),O(u,N*M[4])),O(h,N*M[5])),O(g,N*M[6])),m="number"==typeof p?j(p):F(p),m>i){if(N=.2*N*H(i/m,.25),t+N===t){W.msg="Step size became too small";break}}else{if(S[L]=D(D(D(D(D(D(o,O(x[L],N*I[0])),O(l,N*I[2])),O(c,N*I[3])),O(u,N*I[4])),O(h,N*I[5])),O(g,N*I[6])),++L,b[L]=t+N,E[L]=f,x[L]=g,"function"==typeof s){var z,q,X=t,Y=t+.5*N;if(v=s(Y,S[L-1]),_=V(G(y,0),G(0,v)),U(_)||(X=Y,Y=t+N,y=v,v=s(Y,f),_=V(G(y,0),G(0,v))),U(_)){for(var K,$,Q=0,J=1,Z=1;;){if("number"==typeof y)q=(Z*v*X-J*y*Y)/(Z*v-J*y);else for(q=Y,d=y.length-1;-1!==d;--d)y[d]<0&&v[d]>0&&(q=P(q,(Z*v[d]*X-J*y[d]*Y)/(Z*v[d]-J*y[d])));if(q<=X||q>=Y)break;z=W._at(q,L-1),$=s(q,z),K=V(G(y,0),G(0,$)),U(K)?(Y=q,v=$,_=K,Z=1,-1===Q?J*=.5:J=1,Q=-1):(X=q,y=$,J=1,1===Q?Z*=.5:Z=1,Q=1)}return f=W._at(.5*(t+q),L-1),W.f[L]=n(q,z),W.x[L]=q,W.y[L]=z,W.ymid[L-1]=f,W.events=_,W.iterations=R,W}}t+=N,o=f,y=v,N=P(.8*N*H(i/m,.25),4*N)}return W.iterations=R,W},numeric.LU=function(t,e){e=e||!1;var o,n,i,r,s,a,l,c,u,h=Math.abs,g=t.length,p=g-1,d=new Array(g);for(e||(t=numeric.clone(t)),i=0;i<g;++i){for(l=i,a=t[i],u=h(a[i]),n=i+1;n<g;++n)r=h(t[n][i]),u<r&&(u=r,l=n);for(d[i]=l,l!=i&&(t[i]=t[l],t[l]=a,a=t[i]),s=a[i],o=i+1;o<g;++o)t[o][i]/=s;for(o=i+1;o<g;++o){for(c=t[o],n=i+1;n<p;++n)c[n]-=c[i]*a[n],++n,c[n]-=c[i]*a[n];n===p&&(c[n]-=c[i]*a[n])}}return{LU:t,P:d}},numeric.LUsolve=function(t,e){var o,n,i,r,s,a=t.LU,l=a.length,c=numeric.clone(e),u=t.P;for(o=l-1;-1!==o;--o)c[o]=e[o];for(o=0;o<l;++o)for(i=u[o],u[o]!==o&&(s=c[o],c[o]=c[i],c[i]=s),r=a[o],n=0;n<o;++n)c[o]-=c[n]*r[n];for(o=l-1;o>=0;--o){for(r=a[o],n=o+1;n<l;++n)c[o]-=c[n]*r[n];c[o]/=r[o]}return c},numeric.solve=function(t,e,o){return numeric.LUsolve(numeric.LU(t,o),e)},numeric.echelonize=function(t){var e,o,n,i,r,s,a,l,c=numeric.dim(t),u=c[0],h=c[1],g=numeric.identity(u),p=Array(u),d=Math.abs,f=numeric.diveq;for(t=numeric.clone(t),e=0;e<u;++e){for(n=0,r=t[e],s=g[e],o=1;o<h;++o)d(r[n])<d(r[o])&&(n=o);for(p[e]=n,f(s,r[n]),f(r,r[n]),o=0;o<u;++o)if(o!==e){for(a=t[o],l=a[n],i=h-1;-1!==i;--i)a[i]-=r[i]*l;for(a=g[o],i=u-1;-1!==i;--i)a[i]-=s[i]*l}}return{I:g,A:t,P:p}},numeric.__solveLP=function(t,e,o,n,i,r,s){var a,l,c,u,h=numeric.sum,g=(numeric.log,numeric.mul),p=numeric.sub,d=numeric.dot,f=numeric.div,m=numeric.add,y=t.length,v=o.length,_=!1,b=1,E=(numeric.transpose(e),numeric.svd,numeric.transpose),x=(numeric.leq,Math.sqrt),S=Math.abs,T=(numeric.muleq,numeric.norminf,numeric.any,Math.min),w=numeric.all,C=numeric.gt,k=Array(y),A=Array(v),I=(numeric.rep([v],1),numeric.solve),B=p(o,d(e,r)),M=d(t,t);for(c=0;c<i;++c){var L,N;for(L=v-1;-1!==L;--L)A[L]=f(e[L],B[L]);var R=E(A);for(L=y-1;-1!==L;--L)k[L]=h(R[L]);b=.25*S(M/d(t,k));var D=100*x(M/d(k,k));for((!isFinite(b)||b>D)&&(b=D),u=m(t,g(b,k)),l=d(R,A),L=y-1;-1!==L;--L)l[L][L]+=1;N=I(l,f(u,b),!0);var O=f(B,d(e,N)),P=1;for(L=v-1;-1!==L;--L)O[L]<0&&(P=T(P,-.999*O[L]));if(a=p(r,g(N,P)),B=p(o,d(e,a)),!w(C(B,0)))return{solution:r,message:"",iterations:c};if(r=a,b<n)return{solution:a,message:"",iterations:c};if(s){var j=d(t,u),F=d(e,u);for(_=!0,L=v-1;-1!==L;--L)if(j*F[L]<0){_=!1;break}}else _=!(r[y-1]>=0);if(_)return{solution:a,message:"Unbounded",iterations:c}}return{solution:r,message:"maximum iteration count exceeded",iterations:c}},numeric._solveLP=function(t,e,o,n,i){var r,s=t.length,a=o.length,l=(numeric.sum,numeric.log,numeric.mul,numeric.sub),c=numeric.dot,u=(numeric.div,numeric.add,numeric.rep([s],0).concat([1])),h=numeric.rep([a,1],-1),g=numeric.blockMatrix([[e,h]]),p=o,r=numeric.rep([s],0).concat(Math.max(0,numeric.sup(numeric.neg(o)))+1),d=numeric.__solveLP(u,g,p,n,i,r,!1),f=numeric.clone(d.solution);if(f.length=s,numeric.inf(l(o,c(e,f)))<0)return{solution:NaN,message:"Infeasible",iterations:d.iterations};var m=numeric.__solveLP(t,e,o,n,i-d.iterations,f,!0);return m.iterations+=d.iterations,m},numeric.solveLP=function(t,e,o,n,i,r,s){if(void 0===s&&(s=1e3),void 0===r&&(r=numeric.epsilon),void 0===n)return numeric._solveLP(t,e,o,r,s);var a,l=n.length,c=n[0].length,u=e.length,h=numeric.echelonize(n),g=numeric.rep([c],0),p=h.P,d=[];for(a=p.length-1;-1!==a;--a)g[p[a]]=1;for(a=c-1;-1!==a;--a)0===g[a]&&d.push(a);var f=numeric.getRange,m=numeric.linspace(0,l-1),y=numeric.linspace(0,u-1),v=f(n,m,d),_=f(e,y,p),b=f(e,y,d),E=numeric.dot,x=numeric.sub,S=E(_,h.I),T=x(b,E(S,v)),w=x(o,E(S,i)),C=Array(p.length),k=Array(d.length);for(a=p.length-1;-1!==a;--a)C[a]=t[p[a]];for(a=d.length-1;-1!==a;--a)k[a]=t[d[a]];var A=x(k,E(C,E(h.I,v))),I=numeric._solveLP(A,T,w,r,s),B=I.solution;if(B!==B)return I;var M=E(h.I,x(i,E(v,B))),L=Array(t.length);for(a=p.length-1;-1!==a;--a)L[p[a]]=M[a];for(a=d.length-1;-1!==a;--a)L[d[a]]=B[a];return{solution:L,message:I.message,iterations:I.iterations}},numeric.MPStoLP=function(t){function e(e){throw new Error("MPStoLP: "+e+"\nLine "+o+": "+t[o]+"\nCurrent state: "+a[s]+"\n")}t instanceof String&&t.split("\n");var o,n,i,r,s=0,a=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],l=t.length,c=0,u={},h=[],g=0,p={},d=0,f=[],m=[],y=[];for(o=0;o<l;++o){i=t[o];var v=i.match(/\S*/g),_=[];for(n=0;n<v.length;++n)""!==v[n]&&_.push(v[n]);if(0!==_.length){for(n=0;n<a.length&&i.substr(0,a[n].length)!==a[n];++n);if(n<a.length){if(s=n,1===n&&(r=_[1]),6===n)return{name:r,c:f,A:numeric.transpose(m),b:y,rows:u,vars:p}}else switch(s){case 0:case 1:e("Unexpected line");case 2:switch(_[0]){case"N":0===c?c=_[1]:e("Two or more N rows");break;case"L":u[_[1]]=g,h[g]=1,y[g]=0,++g;break;case"G":u[_[1]]=g,h[g]=-1,y[g]=0,++g;break;case"E":u[_[1]]=g,h[g]=0,y[g]=0,++g;break;default:e("Parse error "+numeric.prettyPrint(_))}break;case 3:p.hasOwnProperty(_[0])||(p[_[0]]=d,f[d]=0,m[d]=numeric.rep([g],0),++d);var b=p[_[0]];for(n=1;n<_.length;n+=2)if(_[n]!==c){var E=u[_[n]];m[b][E]=(h[E]<0?-1:1)*parseFloat(_[n+1])}else f[b]=parseFloat(_[n+1]);break;case 4:for(n=1;n<_.length;n+=2)y[u[_[n]]]=(h[u[_[n]]]<0?-1:1)*parseFloat(_[n+1]);break;case 5:break;case 6:e("Internal error")}}}e("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(t,e,o,n,i,r,s){function a(t){var e,n,i=this,r=t.length,s=0,a=i.i=i.j=i.m=0;for(i.S=[],i.c=[],r||(t=[r++]);s<o;)i.S[s]=s++;for(s=0;s<o;s++)e=i.S[s],a=u(a+e+t[s%r]),n=i.S[a],i.S[s]=n,i.S[a]=e;i.g=function(t){var e=i.S,n=u(i.i+1),r=e[n],s=u(i.j+r),a=e[s];e[n]=a,e[s]=r;for(var l=e[u(r+a)];--t;)n=u(n+1),r=e[n],s=u(s+r),a=e[s],e[n]=a,e[s]=r,l=l*o+e[u(r+a)];return i.i=n,i.j=s,l},i.g(o)}function l(t,e,o,n,i){if(o=[],i=typeof t,e&&"object"==i)for(n in t)if(n.indexOf("S")<5)try{o.push(l(t[n],e-1))}catch(t){}return o.length?o:t+("string"!=i?"\0":"")}function c(t,e,o,n){for(t+="",o=0,n=0;n<t.length;n++)e[u(n)]=u((o^=19*e[u(n)])+t.charCodeAt(n));t="";for(n in e)t+=String.fromCharCode(e[n]);return t}function u(t){return t&o-1}e.seedrandom=function(n,u){var h,g=[];return n=c(l(u?[n,t]:arguments.length?n:[(new Date).getTime(),t,window],3),g),h=new a(g),c(h.S,t),e.random=function(){for(var t=h.g(6),e=s,n=0;t<i;)t=(t+n)*o,e*=o,n=h.g(1);for(;t>=r;)t/=2,e/=2,n>>>=1;return(t+n)/e},n},s=e.pow(o,6),i=e.pow(2,i),r=2*i,c(e.random(),t)}([],numeric.seedrandom,256,0,52),function(t){function e(t){if("object"!=typeof t)return t;var o,n=[],i=t.length;for(o=0;o<i;o++)n[o+1]=e(t[o]);return n}function o(t){if("object"!=typeof t)return t;var e,n=[],i=t.length;for(e=1;e<i;e++)n[e-1]=o(t[e]);return n}function n(t,e,o){var n,i,r,s,a;for(r=1;r<=o;r+=1){for(t[r][r]=1/t[r][r],a=-t[r][r],n=1;n<r;n+=1)t[n][r]=a*t[n][r];if(s=r+1,o<s)break;for(i=s;i<=o;i+=1)for(a=t[r][i],t[r][i]=0,n=1;n<=r;n+=1)t[n][i]=t[n][i]+a*t[n][r]}}function i(t,e,o,n){var i,r,s,a;for(r=1;r<=o;r+=1){for(a=0,i=1;i<r;i+=1)a+=t[i][r]*n[i];n[r]=(n[r]-a)/t[r][r]}for(s=1;s<=o;s+=1)for(r=o+1-s,n[r]=n[r]/t[r][r],a=-n[r],i=1;i<r;i+=1)n[i]=n[i]+a*t[i][r]}function r(t,e,o,n){var i,r,s,a,l,c;for(r=1;r<=o;r+=1){if(n[1]=r,c=0,s=r-1,s<1){if((c=t[r][r]-c)<=0)break;t[r][r]=Math.sqrt(c)}else{for(a=1;a<=s;a+=1){for(l=t[a][r],i=1;i<a;i+=1)l-=t[i][r]*t[i][a];l/=t[a][a],t[a][r]=l,c+=l*l}if((c=t[r][r]-c)<=0)break;t[r][r]=Math.sqrt(c)}n[1]=0}}function s(t,e,o,s,a,l,c,u,h,g,p,d,f,m,y,v){function _(){return y[B+f]=y[B+f+1],y[B+f+1]=0,d[f]=0,f-=1,m[2]=m[2]+1,0}var b,E,x,S,T,w,C,k,A,I,B,M,L,N,R,D,O,P,j,F,H,U,G,V,W,z,q;L=Math.min(s,g),x=2*s+L*(L+5)/2+2*g+1,V=1e-60;do{V+=V,W=1+.1*V,z=1+.2*V}while(W<=1||z<=1);for(b=1;b<=s;b+=1)y[b]=e[b];for(b=s+1;b<=x;b+=1)y[b]=0;for(b=1;b<=g;b+=1)d[b]=0;if(T=[],0===v[1]){if(r(t,o,s,T),0!==T[1])return void(v[1]=2);i(t,o,s,e),n(t,o,s)}else{for(E=1;E<=s;E+=1)for(a[E]=0,b=1;b<=E;b+=1)a[E]=a[E]+t[b][E]*e[b];for(E=1;E<=s;E+=1)for(e[E]=0,b=E;b<=s;b+=1)e[E]=e[E]+t[E][b]*a[b]}for(l[1]=0,E=1;E<=s;E+=1)for(a[E]=e[E],l[1]=l[1]+y[E]*a[E],y[E]=0,b=E+1;b<=s;b+=1)t[b][E]=0;for(l[1]=-l[1]/2,v[1]=0,C=s,k=C+s,B=k+L,A=B+L+1,I=A+L*(L+1)/2,N=I+g,b=1;b<=g;b+=1){for(D=0,E=1;E<=s;E+=1)D+=c[E][b]*c[E][b];y[N+b]=Math.sqrt(D)}for(f=0,m[1]=0,m[2]=0,q=0;;){if(999===(q=function(){for(m[1]=m[1]+1,x=I,b=1;b<=g;b+=1){for(x+=1,D=-u[b],E=1;E<=s;E+=1)D+=c[E][b]*a[E];if(Math.abs(D)<V&&(D=0),b>p)y[x]=D;else if(y[x]=-Math.abs(D),D>0){for(E=1;E<=s;E+=1)c[E][b]=-c[E][b];u[b]=-u[b]}}for(b=1;b<=f;b+=1)y[I+d[b]]=0;for(M=0,R=0,b=1;b<=g;b+=1)y[I+b]<R*y[N+b]&&(M=b,R=y[I+b]/y[N+b]);return 0===M?999:0}()))return;for(;0!==(q=function(){for(b=1;b<=s;b+=1){for(D=0,E=1;E<=s;E+=1)D+=t[E][b]*c[E][M];y[b]=D}for(S=C,b=1;b<=s;b+=1)y[S+b]=0;for(E=f+1;E<=s;E+=1)for(b=1;b<=s;b+=1)y[S+b]=y[S+b]+t[b][E]*y[E];for(U=!0,b=f;b>=1;b-=1){for(D=y[b],x=A+b*(b+3)/2,S=x-b,E=b+1;E<=f;E+=1)D-=y[x]*y[k+E],x+=E;if(D/=y[S],y[k+b]=D,d[b]<p)break;if(D<0)break;U=!1,w=b}if(!U)for(O=y[B+w]/y[k+w],b=1;b<=f&&!(d[b]<p)&&!(y[k+b]<0);b+=1)(R=y[B+b]/y[k+b])<O&&(O=R,w=b);for(D=0,b=C+1;b<=C+s;b+=1)D+=y[b]*y[b];if(Math.abs(D)<=V){if(U)return v[1]=1,999;for(b=1;b<=f;b+=1)y[B+b]=y[B+b]-O*y[k+b];return y[B+f+1]=y[B+f+1]+O,700}for(D=0,b=1;b<=s;b+=1)D+=y[C+b]*c[b][M];for(P=-y[I+M]/D,G=!0,U||O<P&&(P=O,G=!1),b=1;b<=s;b+=1)a[b]=a[b]+P*y[C+b],Math.abs(a[b])<V&&(a[b]=0);for(l[1]=l[1]+P*D*(P/2+y[B+f+1]),b=1;b<=f;b+=1)y[B+b]=y[B+b]-P*y[k+b];if(y[B+f+1]=y[B+f+1]+P,!G){for(D=-u[M],E=1;E<=s;E+=1)D+=a[E]*c[E][M];if(M>p)y[I+M]=D;else if(y[I+M]=-Math.abs(D),D>0){for(E=1;E<=s;E+=1)c[E][M]=-c[E][M];u[M]=-u[M]}return 700}for(f+=1,d[f]=M,x=A+(f-1)*f/2+1,b=1;b<=f-1;b+=1)y[x]=y[b],x+=1;if(f===s)y[x]=y[s];else{for(b=s;b>=f+1&&0!==y[b]&&(j=Math.max(Math.abs(y[b-1]),Math.abs(y[b])),F=Math.min(Math.abs(y[b-1]),Math.abs(y[b])),R=y[b-1]>=0?Math.abs(j*Math.sqrt(1+F*F/(j*j))):-Math.abs(j*Math.sqrt(1+F*F/(j*j))),j=y[b-1]/R,F=y[b]/R,1!==j);b-=1)if(0===j)for(y[b-1]=F*R,E=1;E<=s;E+=1)R=t[E][b-1],t[E][b-1]=t[E][b],t[E][b]=R;else for(y[b-1]=R,H=F/(1+j),E=1;E<=s;E+=1)R=j*t[E][b-1]+F*t[E][b],t[E][b]=H*(t[E][b-1]+R)-t[E][b],t[E][b-1]=R;y[x]=y[f]}return 0}());){if(999===q)return;if(700===q)if(w===f)_();else{for(;function(){if(x=A+w*(w+1)/2+1,S=x+w,0===y[S])return 798;if(j=Math.max(Math.abs(y[S-1]),Math.abs(y[S])),F=Math.min(Math.abs(y[S-1]),Math.abs(y[S])),R=y[S-1]>=0?Math.abs(j*Math.sqrt(1+F*F/(j*j))):-Math.abs(j*Math.sqrt(1+F*F/(j*j))),j=y[S-1]/R,F=y[S]/R,1===j)return 798;if(0===j){for(b=w+1;b<=f;b+=1)R=y[S-1],y[S-1]=y[S],y[S]=R,S+=b;for(b=1;b<=s;b+=1)R=t[b][w],t[b][w]=t[b][w+1],t[b][w+1]=R}else{for(H=F/(1+j),b=w+1;b<=f;b+=1)R=j*y[S-1]+F*y[S],y[S]=H*(y[S-1]+R)-y[S],y[S-1]=R,S+=b;for(b=1;b<=s;b+=1)R=j*t[b][w]+F*t[b][w+1],t[b][w+1]=H*(t[b][w]+R)-t[b][w+1],t[b][w]=R}return 0}(),797===(q=function(){for(S=x-w,b=1;b<=w;b+=1)y[S]=y[x],x+=1,S+=1;return y[B+w]=y[B+w+1],d[w]=d[w+1],w+=1,w<f?797:0}()););_()}}}}function a(t,n,i,r,a,l){t=e(t),n=e(n),i=e(i);var c,u,h,g,p,d,f=[],m=[],y=[],v=[],_=[];if(a=a||0,l=l?e(l):[void 0,0],r=r?e(r):[],u=t.length-1,h=i[1].length-1,!r)for(c=1;c<=h;c+=1)r[c]=0;for(c=1;c<=h;c+=1)m[c]=0;for(g=0,p=Math.min(u,h),c=1;c<=u;c+=1)y[c]=0;for(f[1]=0,c=1;c<=2*u+p*(p+5)/2+2*h+1;c+=1)v[c]=0;for(c=1;c<=2;c+=1)_[c]=0;return s(t,n,u,u,y,f,i,r,u,h,a,m,g,_,v,l),d="",1===l[1]&&(d="constraints are inconsistent, no solution!"),2===l[1]&&(d="matrix D in quadratic function is not positive definite!"),{solution:o(y),value:o(f),unconstrained_solution:o(n),iterations:o(_),iact:o(m),message:d}}t.solveQP=a}(numeric),numeric.svd=function(t){function e(t,e){return t=Math.abs(t),e=Math.abs(e),t>e?t*Math.sqrt(1+e*e/t/t):0==e?t:e*Math.sqrt(1+t*t/e/e)}var o,n=numeric.epsilon,i=1e-64/n,r=0,s=0,a=0,l=0,c=0,u=numeric.clone(t),h=u.length,g=u[0].length;if(h<g)throw"Need more rows than columns";var p=new Array(g),d=new Array(g);for(s=0;s<g;s++)p[s]=d[s]=0;var f=numeric.rep([g,g],0),m=0,y=0,v=0,_=0,b=0,E=0,x=0;for(s=0;s<g;s++){for(p[s]=y,x=0,c=s+1,a=s;a<h;a++)x+=u[a][s]*u[a][s];if(x<=i)y=0;else for(m=u[s][s],y=Math.sqrt(x),m>=0&&(y=-y),v=m*y-x,u[s][s]=m-y,a=c;a<g;a++){for(x=0,l=s;l<h;l++)x+=u[l][s]*u[l][a];for(m=x/v,l=s;l<h;l++)u[l][a]+=m*u[l][s]}for(d[s]=y,x=0,a=c;a<g;a++)x+=u[s][a]*u[s][a];if(x<=i)y=0;else{for(m=u[s][s+1],y=Math.sqrt(x),m>=0&&(y=-y),v=m*y-x,u[s][s+1]=m-y,a=c;a<g;a++)p[a]=u[s][a]/v;for(a=c;a<h;a++){for(x=0,l=c;l<g;l++)x+=u[a][l]*u[s][l];for(l=c;l<g;l++)u[a][l]+=x*p[l]}}(b=Math.abs(d[s])+Math.abs(p[s]))>_&&(_=b)}for(s=g-1;-1!=s;s+=-1){if(0!=y){for(v=y*u[s][s+1],a=c;a<g;a++)f[a][s]=u[s][a]/v;for(a=c;a<g;a++){for(x=0,l=c;l<g;l++)x+=u[s][l]*f[l][a];for(l=c;l<g;l++)f[l][a]+=x*f[l][s]}}for(a=c;a<g;a++)f[s][a]=0,f[a][s]=0;f[s][s]=1,y=p[s],c=s}for(s=g-1;-1!=s;s+=-1){for(c=s+1,y=d[s],a=c;a<g;a++)u[s][a]=0;if(0!=y){for(v=u[s][s]*y,a=c;a<g;a++){for(x=0,l=c;l<h;l++)x+=u[l][s]*u[l][a];for(m=x/v,l=s;l<h;l++)u[l][a]+=m*u[l][s]}for(a=s;a<h;a++)u[a][s]=u[a][s]/y}else for(a=s;a<h;a++)u[a][s]=0;u[s][s]+=1}for(n*=_,l=g-1;-1!=l;l+=-1)for(var S=0;S<50;S++){var T=!1;for(c=l;-1!=c;c+=-1){if(Math.abs(p[c])<=n){T=!0;break}if(Math.abs(d[c-1])<=n)break}if(!T){r=0,x=1;var w=c-1;for(s=c;s<l+1&&(m=x*p[s],p[s]=r*p[s],!(Math.abs(m)<=n));s++)for(y=d[s],v=e(m,y),d[s]=v,r=y/v,x=-m/v,a=0;a<h;a++)b=u[a][w],E=u[a][s],u[a][w]=b*r+E*x,u[a][s]=-b*x+E*r}if(E=d[l],c==l){if(E<0)for(d[l]=-E,a=0;a<g;a++)f[a][l]=-f[a][l];break}if(S>=49)throw"Error: no convergence.";for(_=d[c],b=d[l-1],y=p[l-1],v=p[l],m=((b-E)*(b+E)+(y-v)*(y+v))/(2*v*b),y=e(m,1),m=m<0?((_-E)*(_+E)+v*(b/(m-y)-v))/_:((_-E)*(_+E)+v*(b/(m+y)-v))/_,r=1,x=1,s=c+1;s<l+1;s++){for(y=p[s],b=d[s],v=x*y,y*=r,E=e(m,v),p[s-1]=E,r=m/E,x=v/E,m=_*r+y*x,y=-_*x+y*r,v=b*x,b*=r,a=0;a<g;a++)_=f[a][s-1],E=f[a][s],f[a][s-1]=_*r+E*x,f[a][s]=-_*x+E*r;for(E=e(m,v),d[s-1]=E,r=m/E,x=v/E,m=r*y+x*b,_=-x*y+r*b,a=0;a<h;a++)b=u[a][s-1],E=u[a][s],u[a][s-1]=b*r+E*x,u[a][s]=-b*x+E*r}p[c]=0,p[l]=m,d[l]=_}for(s=0;s<d.length;s++)d[s]<n&&(d[s]=0);for(s=0;s<g;s++)for(a=s-1;a>=0;a--)if(d[a]<d[s]){for(r=d[a],d[a]=d[s],d[s]=r,l=0;l<u.length;l++)o=u[l][s],u[l][s]=u[l][a],u[l][a]=o;for(l=0;l<f.length;l++)o=f[l][s],f[l][s]=f[l][a],f[l][a]=o;s=a}return{U:u,S:d,V:f}}}).call(exports,__webpack_require__(2))},function(t,e,o){!function(t,o){o(e)}(0,function(t){function e(){}function o(t,e,n,i,r,s,a,l,c,u){Object.defineProperty(this,"id",{value:Cr++}),this.uuid=br.generateUUID(),this.name="",this.image=void 0!==t?t:o.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:o.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:1001,this.wrapT=void 0!==i?i:1001,this.magFilter=void 0!==r?r:1006,this.minFilter=void 0!==s?s:1008,this.anisotropy=void 0!==c?c:1,this.format=void 0!==a?a:1023,this.internalFormat=null,this.type=void 0!==l?l:1009,this.offset=new Er(0,0),this.repeat=new Er(1,1),this.center=new Er(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Sr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==u?u:3e3,this.version=0,this.onUpdate=null}function n(t,e,n){this.width=t,this.height=e,this.scissor=new kr(0,0,t,e),this.scissorTest=!1,this.viewport=new kr(0,0,t,e),n=n||{},this.texture=new o(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=e,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:1006,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function i(t,e,o){n.call(this,t,e,o),this.samples=4}function r(t,e,o,n,i){for(var r=0,s=t.length-3;r<=s;r+=3){Xr.fromArray(t,r);var a=i.x*Math.abs(Xr.x)+i.y*Math.abs(Xr.y)+i.z*Math.abs(Xr.z),l=e.dot(Xr),c=o.dot(Xr),u=n.dot(Xr);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}function s(){Object.defineProperty(this,"id",{value:ys++}),this.uuid=br.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=s.DefaultUp.clone();var t=new Mr,e=new gs,o=new Ir,n=new Mr(1,1,1);e._onChange(function(){o.setFromEuler(e,!1)}),o._onChange(function(){e.setFromQuaternion(o,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:o},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new is},normalMatrix:{value:new Sr}}),this.matrix=new is,this.matrixWorld=new is,this.matrixAutoUpdate=s.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new ms,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function a(t,e,o){return 0>o&&(o+=1),1<o&&--o,o<1/6?t+6*(e-t)*o:.5>o?e:o<2/3?t+6*(e-t)*(2/3-o):t}function l(t){return.04045>t?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function c(t){return.0031308>t?12.92*t:1.055*Math.pow(t,.41666)-.055}function u(){Object.defineProperty(this,"id",{value:$s++}),this.uuid=br.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=this.flatShading=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=3,this.depthWrite=this.depthTest=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilZPass=this.stencilZFail=this.stencilFail=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipShadows=this.clipIntersection=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.toneMapped=this.visible=!0,this.userData={},this.version=0}function h(t){u.call(this),this.type="MeshBasicMaterial",this.color=new Ys(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphTargets=this.skinning=!1,this.setValues(t)}function g(t,e,o){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===o,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function p(t,e,o){g.call(this,new Int8Array(t),e,o)}function d(t,e,o){g.call(this,new Uint8Array(t),e,o)}function f(t,e,o){g.call(this,new Uint8ClampedArray(t),e,o)}function m(t,e,o){g.call(this,new Int16Array(t),e,o)}function y(t,e,o){g.call(this,new Uint16Array(t),e,o)}function v(t,e,o){g.call(this,new Int32Array(t),e,o)}function _(t,e,o){g.call(this,new Uint32Array(t),e,o)}function b(t,e,o){g.call(this,new Float32Array(t),e,o)}function E(t,e,o){g.call(this,new Float64Array(t),e,o)}function x(t){if(0===t.length)return-1/0;for(var e=t[0],o=1,n=t.length;o<n;++o)t[o]>e&&(e=t[o]);return e}function S(){Object.defineProperty(this,"id",{value:ta+=2}),this.uuid=br.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:1/0},this.userData={}}function T(t,e){s.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new S,this.material=void 0!==e?e:new h,this.updateMorphTargets()}function w(t,e,o,n,i,r,s,a){return null===(1===e.side?n.intersectTriangle(s,r,i,!0,a):n.intersectTriangle(i,r,s,2!==e.side,a))?null:(Sa.copy(a),Sa.applyMatrix4(t.matrixWorld),e=o.ray.origin.distanceTo(Sa),e<o.near||e>o.far?null:{distance:e,point:Sa.clone(),object:t})}function C(t,e,o,n,i,r,s,a,l,c,u,h){if(ua.fromBufferAttribute(i,c),ha.fromBufferAttribute(i,u),ga.fromBufferAttribute(i,h),i=t.morphTargetInfluences,e.morphTargets&&r&&i){ma.set(0,0,0),ya.set(0,0,0),va.set(0,0,0);for(var g=0,p=r.length;g<p;g++){var d=i[g],f=r[g];0!==d&&(pa.fromBufferAttribute(f,c),da.fromBufferAttribute(f,u),fa.fromBufferAttribute(f,h),s?(ma.addScaledVector(pa,d),ya.addScaledVector(da,d),va.addScaledVector(fa,d)):(ma.addScaledVector(pa.sub(ua),d),ya.addScaledVector(da.sub(ha),d),va.addScaledVector(fa.sub(ga),d)))}ua.add(ma),ha.add(ya),ga.add(va)}return t.isSkinnedMesh&&(t.boneTransform(c,ua),t.boneTransform(u,ha),t.boneTransform(h,ga)),(t=w(t,e,o,n,ua,ha,ga,xa))&&(a&&(_a.fromBufferAttribute(a,c),ba.fromBufferAttribute(a,u),Ea.fromBufferAttribute(a,h),t.uv=Ws.getUV(xa,ua,ha,ga,_a,ba,Ea,new Er)),l&&(_a.fromBufferAttribute(l,c),ba.fromBufferAttribute(l,u),Ea.fromBufferAttribute(l,h),t.uv2=Ws.getUV(xa,ua,ha,ga,_a,ba,Ea,new Er)),a=new Ks(c,u,h),Ws.getNormal(ua,ha,ga,a.normal),t.face=a),t}function k(){Object.defineProperty(this,"id",{value:Ta+=2}),this.uuid=br.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function A(t,e,o,n,i,r){k.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:o,widthSegments:n,heightSegments:i,depthSegments:r},this.fromBufferGeometry(new I(t,e,o,n,i,r)),this.mergeVertices()}function I(t,e,o,n,i,r){function s(t,e,o,n,i,r,s,d,f,m,y){var v=r/f,_=s/m,b=r/2,E=s/2,x=d/2;s=f+1;for(var S=m+1,T=r=0,w=new Mr,C=0;C<S;C++)for(var k=C*_-E,A=0;A<s;A++)w[t]=(A*v-b)*n,w[e]=k*i,w[o]=x,c.push(w.x,w.y,w.z),w[t]=0,w[e]=0,w[o]=0<d?1:-1,u.push(w.x,w.y,w.z),h.push(A/f),h.push(1-C/m),r+=1;for(t=0;t<m;t++)for(e=0;e<f;e++)o=g+e+s*(t+1),n=g+(e+1)+s*(t+1),i=g+(e+1)+s*t,l.push(g+e+s*t,o,i),l.push(o,n,i),T+=6;a.addGroup(p,T,y),p+=T,g+=r}void 0===t&&(t=1),void 0===e&&(e=1),void 0===o&&(o=1),void 0===n&&(n=1),void 0===i&&(i=1),void 0===r&&(r=1),S.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:o,widthSegments:n,heightSegments:i,depthSegments:r};var a=this;n=Math.floor(n),i=Math.floor(i),r=Math.floor(r);var l=[],c=[],u=[],h=[],g=0,p=0;s("z","y","x",-1,-1,o,e,t,r,i,0),s("z","y","x",1,-1,o,e,-t,r,i,1),s("x","z","y",1,1,t,o,e,n,r,2),s("x","z","y",1,-1,t,o,-e,n,r,3),s("x","y","z",1,-1,t,e,o,n,i,4),s("x","y","z",-1,-1,t,e,-o,n,i,5),this.setIndex(l),this.setAttribute("position",new b(c,3)),this.setAttribute("normal",new b(u,3)),this.setAttribute("uv",new b(h,2))}function B(t){var e,o={};for(e in t){o[e]={};for(var n in t[e]){var i=t[e][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?o[e][n]=i.clone():Array.isArray(i)?o[e][n]=i.slice():o[e][n]=i}}return o}function M(t){for(var e={},o=0;o<t.length;o++){var n,i=B(t[o]);for(n in i)e[n]=i[n]}return e}function L(t){u.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function N(){s.call(this),this.type="Camera",this.matrixWorldInverse=new is,this.projectionMatrix=new is,this.projectionMatrixInverse=new is}function R(t,e,o,n){N.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==o?o:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function D(t,e,o){if(s.call(this),this.type="CubeCamera",!0!==o.isWebGLCubeRenderTarget)console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");else{this.renderTarget=o;var n=new R(90,1,t,e);n.layers=this.layers,n.up.set(0,-1,0),n.lookAt(new Mr(1,0,0)),this.add(n);var i=new R(90,1,t,e);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new Mr(-1,0,0)),this.add(i);var r=new R(90,1,t,e);r.layers=this.layers,r.up.set(0,0,1),r.lookAt(new Mr(0,1,0)),this.add(r);var a=new R(90,1,t,e);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new Mr(0,-1,0)),this.add(a);var l=new R(90,1,t,e);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new Mr(0,0,1)),this.add(l);var c=new R(90,1,t,e);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new Mr(0,0,-1)),this.add(c),this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var s=t.xr.enabled,u=t.getRenderTarget();t.xr.enabled=!1;var h=o.texture.generateMipmaps;o.texture.generateMipmaps=!1,t.setRenderTarget(o,0),t.render(e,n),t.setRenderTarget(o,1),t.render(e,i),t.setRenderTarget(o,2),t.render(e,r),t.setRenderTarget(o,3),t.render(e,a),t.setRenderTarget(o,4),t.render(e,l),o.texture.generateMipmaps=h,t.setRenderTarget(o,5),t.render(e,c),t.setRenderTarget(u),t.xr.enabled=s},this.clear=function(t,e,n,i){for(var r=t.getRenderTarget(),s=0;6>s;s++)t.setRenderTarget(o,s),t.clear(e,n,i);t.setRenderTarget(r)}}}function O(t,e,o){Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=o),n.call(this,t,t,e),this.texture.isWebGLCubeRenderTargetTexture=!0}function P(t,e,n,i,r,s,a,l,c,u,h,g){o.call(this,null,s,a,l,c,u,i,r,h,g),this.image={data:t||null,width:e||1,height:n||1},this.magFilter=void 0!==c?c:1003,this.minFilter=void 0!==u?u:1003,this.flipY=this.generateMipmaps=!1,this.unpackAlignment=1,this.needsUpdate=!0}function j(){function t(o,r){n(o,r),i=e.requestAnimationFrame(t)}var e=null,o=!1,n=null,i=null;return{start:function(){!0!==o&&null!==n&&(i=e.requestAnimationFrame(t),o=!0)},stop:function(){e.cancelAnimationFrame(i),o=!1},setAnimationLoop:function(t){n=t},setContext:function(t){e=t}}}function F(t,e){function o(e,o){var n=e.array,i=e.usage,r=t.createBuffer();return t.bindBuffer(o,r),t.bufferData(o,n,i),e.onUploadCallback(),o=5126,n instanceof Float32Array?o=5126:n instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):n instanceof Uint16Array?o=5123:n instanceof Int16Array?o=5122:n instanceof Uint32Array?o=5125:n instanceof Int32Array?o=5124:n instanceof Int8Array?o=5120:n instanceof Uint8Array&&(o=5121),{buffer:r,type:o,bytesPerElement:n.BYTES_PER_ELEMENT,version:e.version}}var n=e.isWebGL2,i=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),i.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);var o=i.get(e);o&&(t.deleteBuffer(o.buffer),i.delete(e))},update:function(e,r){if(e.isGLBufferAttribute)(!(r=i.get(e))||r.version<e.version)&&i.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version});else{e.isInterleavedBufferAttribute&&(e=e.data);var s=i.get(e);if(void 0===s)i.set(e,o(e,r));else if(s.version<e.version){var a=e.array,l=e.updateRange;t.bindBuffer(r,s.buffer),-1===l.count?t.bufferSubData(r,0,a):(n?t.bufferSubData(r,l.offset*a.BYTES_PER_ELEMENT,a,l.offset,l.count):t.bufferSubData(r,l.offset*a.BYTES_PER_ELEMENT,a.subarray(l.offset,l.offset+l.count)),l.count=-1),s.version=e.version}}}}}function H(t,e,o,n){k.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:o,heightSegments:n},this.fromBufferGeometry(new U(t,e,o,n)),this.mergeVertices()}function U(t,e,o,n){S.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:o,heightSegments:n},t=t||1,e=e||1;var i=t/2,r=e/2;o=Math.floor(o)||1,n=Math.floor(n)||1;var s=o+1,a=n+1,l=t/o,c=e/n;e=[],t=[];for(var u=[],h=[],g=0;g<a;g++)for(var p=g*c-r,d=0;d<s;d++)t.push(d*l-i,-p,0),u.push(0,0,1),h.push(d/o),h.push(1-g/n);for(i=0;i<n;i++)for(r=0;r<o;r++)a=r+s*(i+1),l=r+1+s*(i+1),c=r+1+s*i,e.push(r+s*i,a,c),e.push(a,l,c);this.setIndex(e),this.setAttribute("position",new b(t,3)),this.setAttribute("normal",new b(u,3)),this.setAttribute("uv",new b(h,2))}function G(t,e,o,n,i){function r(t,e){o.buffers.color.setClear(t.r,t.g,t.b,e,i)}var s,a,l=new Ys(0),c=0,u=null,h=0,g=null;return{getClearColor:function(){return l},setClearColor:function(t,e){l.set(t),c=void 0!==e?e:1,r(l,c)},getClearAlpha:function(){return c},setClearAlpha:function(t){c=t,r(l,c)},render:function(o,i,p,d){(i=!0===i.isScene?i.background:null)&&i.isTexture&&(i=e.get(i)),p=t.xr,(p=p.getSession&&p.getSession())&&"additive"===p.environmentBlendMode&&(i=null),null===i?r(l,c):i&&i.isColor&&(r(i,1),d=!0),(t.autoClear||d)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),i&&(i.isCubeTexture||i.isWebGLCubeRenderTarget||i.isWebGLCubeRenderTargetTexture||306===i.mapping)?(void 0===a&&(a=new T(new I(1,1,1),new L({name:"BackgroundCubeMaterial",uniforms:B(Ra.cube.uniforms),vertexShader:Ra.cube.vertexShader,fragmentShader:Ra.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(t,e,o){this.matrixWorld.copyPosition(o.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(a)),i.isWebGLCubeRenderTarget&&(i=i.texture),a.material.uniforms.envMap.value=i,a.material.uniforms.flipEnvMap.value=i.isCubeTexture?-1:1,u===i&&h===i.version&&g===t.toneMapping||(a.material.needsUpdate=!0,u=i,h=i.version,g=t.toneMapping),o.unshift(a,a.geometry,a.material,0,0,null)):i&&i.isTexture&&(void 0===s&&(s=new T(new U(2,2),new L({name:"BackgroundMaterial",uniforms:B(Ra.background.uniforms),vertexShader:Ra.background.vertexShader,fragmentShader:Ra.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),s.geometry.deleteAttribute("normal"),Object.defineProperty(s.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(s)),s.material.uniforms.t2D.value=i,!0===i.matrixAutoUpdate&&i.updateMatrix(),s.material.uniforms.uvTransform.value.copy(i.matrix),u===i&&h===i.version&&g===t.toneMapping||(s.material.needsUpdate=!0,u=i,h=i.version,g=t.toneMapping),o.unshift(s,s.geometry,s.material,0,0,null))}}}function V(t,e,o,n){function i(e){return n.isWebGL2?t.bindVertexArray(e):d.bindVertexArrayOES(e)}function r(e){return n.isWebGL2?t.deleteVertexArray(e):d.deleteVertexArrayOES(e)}function s(t){for(var e=[],o=[],n=[],i=0;i<p;i++)e[i]=0,o[i]=0,n[i]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:o,attributeDivisors:n,object:t,attributes:{},index:null}}function a(){for(var t=v.newAttributes,e=0,o=t.length;e<o;e++)t[e]=0}function l(t){c(t,0)}function c(o,i){var r=v.enabledAttributes,s=v.attributeDivisors;v.newAttributes[o]=1,0===r[o]&&(t.enableVertexAttribArray(o),r[o]=1),s[o]!==i&&((n.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](o,i),s[o]=i)}function u(){for(var e=v.newAttributes,o=v.enabledAttributes,n=0,i=o.length;n<i;n++)o[n]!==e[n]&&(t.disableVertexAttribArray(n),o[n]=0)}function h(){g(),v!==y&&(v=y,i(v.object))}function g(){y.geometry=null,y.program=null,y.wireframe=!1}var p=t.getParameter(34921),d=n.isWebGL2?null:e.get("OES_vertex_array_object"),f=n.isWebGL2||null!==d,m={},y=s(null),v=y;return{setup:function(r,h,g,p,y){var _=!1;if(f){_=!0===h.wireframe;var b=m[p.id];void 0===b&&(b={},m[p.id]=b);var E=b[g.id];void 0===E&&(E={},b[g.id]=E),b=E[_],void 0===b&&(b=s(n.isWebGL2?t.createVertexArray():d.createVertexArrayOES()),E[_]=b),_=b,v!==_&&(v=_,i(v.object));t:if(_=v.attributes,E=p.attributes,Object.keys(_).length!==Object.keys(E).length)_=!0;else{for(var x in E){b=_[x];var S=E[x];if(void 0===b||b.attribute!==S||b.data!==S.data){_=!0;break t}}_=v.index!==y}if(_){x={},E=p.attributes;for(var T in E)b=E[T],S={},S.attribute=b,b.data&&(S.data=b.data),x[T]=S;v.attributes=x,v.index=y}}else T=!0===h.wireframe,(v.geometry!==p.id||v.program!==g.id||v.wireframe!==T)&&(v.geometry=p.id,v.program=g.id,v.wireframe=T,_=!0);if(!0===r.isInstancedMesh&&(_=!0),null!==y&&o.update(y,34963),_){if(!1!==n.isWebGL2||!r.isInstancedMesh&&!p.isInstancedBufferGeometry||null!==e.get("ANGLE_instanced_arrays")){a(),T=p.attributes,g=g.getAttributes(),h=h.defaultAttributeValues;for(var w in g)if(0<=(_=g[w])){var C=T[w];if(void 0!==C){if(x=C.normalized,S=C.itemSize,void 0!==(b=o.get(C))){var k=b.buffer;if(E=b.type,b=b.bytesPerElement,C.isInterleavedBufferAttribute){var A=C.data,I=A.stride;C=C.offset,A&&A.isInstancedInterleavedBuffer?(c(_,A.meshPerAttribute),void 0===p._maxInstanceCount&&(p._maxInstanceCount=A.meshPerAttribute*A.count)):l(_),t.bindBuffer(34962,k),I*=b,b*=C,!0!==n.isWebGL2||5124!==E&&5125!==E?t.vertexAttribPointer(_,S,E,x,I,b):t.vertexAttribIPointer(_,S,E,I,b)}else C.isInstancedBufferAttribute?(c(_,C.meshPerAttribute),void 0===p._maxInstanceCount&&(p._maxInstanceCount=C.meshPerAttribute*C.count)):l(_),t.bindBuffer(34962,k),b=S,!0!==n.isWebGL2||5124!==E&&5125!==E?t.vertexAttribPointer(_,b,E,x,0,0):t.vertexAttribIPointer(_,b,E,0,0)}}else if("instanceMatrix"===w)void 0!==(E=o.get(r.instanceMatrix))&&(x=E.buffer,E=E.type,c(_+0,1),c(_+1,1),c(_+2,1),c(_+3,1),t.bindBuffer(34962,x),t.vertexAttribPointer(_+0,4,E,!1,64,0),t.vertexAttribPointer(_+1,4,E,!1,64,16),t.vertexAttribPointer(_+2,4,E,!1,64,32),t.vertexAttribPointer(_+3,4,E,!1,64,48));else if("instanceColor"===w)void 0!==(E=o.get(r.instanceColor))&&(x=E.buffer,E=E.type,c(_,1),t.bindBuffer(34962,x),t.vertexAttribPointer(_,3,E,!1,12,0));else if(void 0!==h&&void 0!==(x=h[w]))switch(x.length){case 2:t.vertexAttrib2fv(_,x);break;case 3:t.vertexAttrib3fv(_,x);break;case 4:t.vertexAttrib4fv(_,x);break;default:t.vertexAttrib1fv(_,x)}}u()}null!==y&&t.bindBuffer(34963,o.get(y).buffer)}},reset:h,resetDefaultState:g,dispose:function(){h();for(var t in m){var e,o=m[t];for(e in o){var n,i=o[e];for(n in i)r(i[n].object),delete i[n];delete o[e]}delete m[t]}},releaseStatesOfGeometry:function(t){if(void 0!==m[t.id]){var e,o=m[t.id];for(e in o){var n,i=o[e];for(n in i)r(i[n].object),delete i[n];delete o[e]}delete m[t.id]}},releaseStatesOfProgram:function(t){for(var e in m){var o=m[e];if(void 0!==o[t.id]){var n,i=o[t.id];for(n in i)r(i[n].object),delete i[n];delete o[t.id]}}},initAttributes:a,enableAttribute:l,disableUnusedAttributes:u}}function W(t,e,o,n){var i,r=n.isWebGL2;this.setMode=function(t){i=t},this.render=function(e,n){t.drawArrays(i,e,n),o.update(n,i,1)},this.renderInstances=function(n,s,a){if(0!==a){if(r)var l=t,c="drawArraysInstanced";else if(l=e.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](i,n,s,a),o.update(s,i,a)}}}function z(t,e,o){function n(e){if("highp"===e){if(0<t.getShaderPrecisionFormat(35633,36338).precision&&0<t.getShaderPrecisionFormat(35632,36338).precision)return"highp";e="mediump"}return"mediump"===e&&0<t.getShaderPrecisionFormat(35633,36337).precision&&0<t.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var i,r="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext,s=void 0!==o.precision?o.precision:"highp",a=n(s);a!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",a,"instead."),s=a),o=!0===o.logarithmicDepthBuffer,a=t.getParameter(34930);var l=t.getParameter(35660),c=t.getParameter(3379),u=t.getParameter(34076),h=t.getParameter(34921),g=t.getParameter(36347),p=t.getParameter(36348),d=t.getParameter(36349),f=0<l,m=r||!!e.get("OES_texture_float"),y=f&&m,v=r?t.getParameter(36183):0;return{isWebGL2:r,getMaxAnisotropy:function(){if(void 0!==i)return i;var o=e.get("EXT_texture_filter_anisotropic");return i=null!==o?t.getParameter(o.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:n,precision:s,logarithmicDepthBuffer:o,maxTextures:a,maxVertexTextures:l,maxTextureSize:c,maxCubemapSize:u,maxAttributes:h,maxVertexUniforms:g,maxVaryings:p,maxFragmentUniforms:d,vertexTextures:f,floatFragmentTextures:m,floatVertexTextures:y,maxSamples:v}}function q(t){function e(){u.value!==i&&(u.value=i,u.needsUpdate=0<r),n.numPlanes=r,n.numIntersection=0}function o(t,e,o,i){var r=null!==t?t.length:0,s=null;if(0!==r){if(s=u.value,!0!==i||null===s)for(i=o+4*r,e=e.matrixWorldInverse,c.getNormalMatrix(e),(null===s||s.length<i)&&(s=new Float32Array(i)),i=0;i!==r;++i,o+=4)l.copy(t[i]).applyMatrix4(e,c),l.normal.toArray(s,o),s[o+3]=l.constant;u.value=s,u.needsUpdate=!0}return n.numPlanes=r,n.numIntersection=0,s}var n=this,i=null,r=0,s=!1,a=!1,l=new Ns,c=new Sr,u={value:null,needsUpdate:!1};this.uniform=u,this.numIntersection=this.numPlanes=0,this.init=function(t,e,n){var a=0!==t.length||e||0!==r||s;return s=e,i=o(t,n,0),r=t.length,a},this.beginShadows=function(){a=!0,o(null)},this.endShadows=function(){a=!1,e()},this.setState=function(n,l,c){var h=n.clippingPlanes,g=n.clipIntersection,p=n.clipShadows;if(n=t.get(n),!s||null===h||0===h.length||a&&!p)a?o(null):e();else{p=a?0:r;var d=4*p,f=n.clippingState||null;for(u.value=f,f=o(h,l,d,c),l=0;l!==d;++l)f[l]=i[l];n.clippingState=f,this.numIntersection=g?this.numPlanes:0,this.numPlanes+=p}}}function X(t){function e(t,e){return 303===e?t.mapping=301:304===e&&(t.mapping=302),t}var o=new WeakMap;return{get:function(n){if(n&&n.isTexture){var i=n.mapping;if(303===i||304===i){if(o.has(n))return i=o.get(n).texture,e(i,n.mapping);var r=n.image;if(r&&0<r.height){i=t.getRenderList();var s=t.getRenderTarget(),a=t.getRenderState();return r=new O(r.height/2),r.fromEquirectangularTexture(t,n),o.set(n,r),t.setRenderTarget(s),t.setRenderList(i),t.setRenderState(a),e(r.texture,n.mapping)}return null}}return n},dispose:function(){o=new WeakMap}}}function Y(t){var e={};return{has:function(o){if(void 0!==e[o])return null!==e[o];switch(o){case"WEBGL_depth_texture":var n=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=t.getExtension(o)}return e[o]=n,null!==n},get:function(t){return this.has(t)||console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),e[t]}}}function K(t,e,o,n){function i(t){t=t.target;var r=s.get(t);null!==r.index&&e.remove(r.index);for(var l in r.attributes)e.remove(r.attributes[l]);t.removeEventListener("dispose",i),s.delete(t),(l=a.get(r))&&(e.remove(l),a.delete(r)),n.releaseStatesOfGeometry(t),!0===t.isInstancedBufferGeometry&&delete t._maxInstanceCount,o.memory.geometries--}function r(t){var o=[],n=t.index,i=t.attributes.position;if(null!==n){i=n.array,n=n.version;for(var r=0,s=i.length;r<s;r+=3){var l=i[r+0],c=i[r+1],u=i[r+2];o.push(l,c,c,u,u,l)}}else for(r=i.array,n=i.version,i=0,r=r.length/3-1;i<r;i+=3)s=i+0,l=i+1,c=i+2,o.push(s,l,l,c,c,s);o=new(65535<x(o)?_:y)(o,1),o.version=n,(n=a.get(t))&&e.remove(n),a.set(t,o)}var s=new WeakMap,a=new WeakMap;return{get:function(t,e){var n=s.get(e);return n||(e.addEventListener("dispose",i),e.isBufferGeometry?n=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new S).setFromObject(t)),n=e._bufferGeometry),s.set(e,n),o.memory.geometries++,n)},update:function(t){var o=t.attributes;for(i in o)e.update(o[i],34962);t=t.morphAttributes;for(var n in t){o=t[n];for(var i=0,r=o.length;i<r;i++)e.update(o[i],34962)}},getWireframeAttribute:function(t){var e=a.get(t);if(e){var o=t.index;null!==o&&e.version<o.version&&r(t)}else r(t);return a.get(t)}}}function $(t,e,o,n){var i,r,s,a=n.isWebGL2;this.setMode=function(t){i=t},this.setIndex=function(t){r=t.type,s=t.bytesPerElement},this.render=function(e,n){t.drawElements(i,n,r,e*s),o.update(n,i,1)},this.renderInstances=function(n,l,c){if(0!==c){if(a)var u=t,h="drawElementsInstanced";else if(u=e.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===u)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[h](i,l,r,n*s,c),o.update(l,i,c)}}}function Q(t){var e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,o,n){switch(e.calls++,o){case 4:e.triangles+=t/3*n;break;case 1:e.lines+=t/2*n;break;case 3:e.lines+=n*(t-1);break;case 2:e.lines+=n*t;break;case 0:e.points+=n*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function J(t,e){return t[0]-e[0]}function Z(t,e){return Math.abs(e[1])-Math.abs(t[1])}function tt(t){for(var e={},o=new Float32Array(8),n=[],i=0;8>i;i++)n[i]=[i,0];return{update:function(i,r,s,a){var l=i.morphTargetInfluences;i=void 0===l?0:l.length;var c=e[r.id];if(void 0===c){c=[];for(var u=0;u<i;u++)c[u]=[u,0];e[r.id]=c}for(u=0;u<i;u++){var h=c[u];h[0]=u,h[1]=l[u]}for(c.sort(Z),l=0;8>l;l++)l<i&&c[l][1]?(n[l][0]=c[l][0],n[l][1]=c[l][1]):(n[l][0]=Number.MAX_SAFE_INTEGER,n[l][1]=0);for(n.sort(J),i=s.morphTargets&&r.morphAttributes.position,s=s.morphNormals&&r.morphAttributes.normal,l=c=0;8>l;l++)h=n[l],u=h[0],h=h[1],u!==Number.MAX_SAFE_INTEGER&&h?(i&&r.getAttribute("morphTarget"+l)!==i[u]&&r.setAttribute("morphTarget"+l,i[u]),s&&r.getAttribute("morphNormal"+l)!==s[u]&&r.setAttribute("morphNormal"+l,s[u]),o[l]=h,c+=h):(i&&void 0!==r.getAttribute("morphTarget"+l)&&r.deleteAttribute("morphTarget"+l),s&&void 0!==r.getAttribute("morphNormal"+l)&&r.deleteAttribute("morphNormal"+l),o[l]=0);r=r.morphTargetsRelative?1:1-c,a.getUniforms().setValue(t,"morphTargetBaseInfluence",r),a.getUniforms().setValue(t,"morphTargetInfluences",o)}}}function et(t,e,o,n){var i=new WeakMap;return{update:function(t){var r=n.render.frame,s=t.geometry,a=e.get(t,s);return i.get(a)!==r&&(s.isGeometry&&a.updateFromObject(t),e.update(a),i.set(a,r)),t.isInstancedMesh&&(o.update(t.instanceMatrix,34962),null!==t.instanceColor&&o.update(t.instanceColor,34962)),a},dispose:function(){i=new WeakMap}}}function ot(t,e,n,i,r,s,a,l,c,u){t=void 0!==t?t:[],o.call(this,t,void 0!==e?e:301,n,i,r,s,void 0!==a?a:1022,l,c,u),this.flipY=!1}function nt(t,e,n,i){o.call(this,null),this.image={data:t||null,width:e||1,height:n||1,depth:i||1},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1,this.needsUpdate=!0}function it(t,e,n,i){o.call(this,null),this.image={data:t||null,width:e||1,height:n||1,depth:i||1},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1,this.needsUpdate=!0}function rt(t,e,o){var n=t[0];if(0>=n||0<n)return t;var i=e*o,r=Fa[i];if(void 0===r&&(r=new Float32Array(i),Fa[i]=r),0!==e)for(n.toArray(r,0),n=1,i=0;n!==e;++n)i+=o,t[n].toArray(r,i);return r}function st(t,e){if(t.length!==e.length)return!1;for(var o=0,n=t.length;o<n;o++)if(t[o]!==e[o])return!1;return!0}function at(t,e){for(var o=0,n=e.length;o<n;o++)t[o]=e[o]}function lt(t,e){var o=Ha[e];void 0===o&&(o=new Int32Array(e),Ha[e]=o);for(var n=0;n!==e;++n)o[n]=t.allocateTextureUnit();return o}function ct(t,e){var o=this.cache;o[0]!==e&&(t.uniform1f(this.addr,e),o[0]=e)}function ut(t,e){var o=this.cache;void 0!==e.x?o[0]===e.x&&o[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),o[0]=e.x,o[1]=e.y):st(o,e)||(t.uniform2fv(this.addr,e),at(o,e))}function ht(t,e){var o=this.cache;void 0!==e.x?o[0]===e.x&&o[1]===e.y&&o[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),o[0]=e.x,o[1]=e.y,o[2]=e.z):void 0!==e.r?o[0]===e.r&&o[1]===e.g&&o[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),o[0]=e.r,o[1]=e.g,o[2]=e.b):st(o,e)||(t.uniform3fv(this.addr,e),at(o,e))}function gt(t,e){var o=this.cache;void 0!==e.x?o[0]===e.x&&o[1]===e.y&&o[2]===e.z&&o[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),o[0]=e.x,o[1]=e.y,o[2]=e.z,o[3]=e.w):st(o,e)||(t.uniform4fv(this.addr,e),at(o,e))}function pt(t,e){var o=this.cache,n=e.elements;void 0===n?st(o,e)||(t.uniformMatrix2fv(this.addr,!1,e),at(o,e)):st(o,n)||(Va.set(n),t.uniformMatrix2fv(this.addr,!1,Va),at(o,n))}function dt(t,e){var o=this.cache,n=e.elements;void 0===n?st(o,e)||(t.uniformMatrix3fv(this.addr,!1,e),at(o,e)):st(o,n)||(Ga.set(n),t.uniformMatrix3fv(this.addr,!1,Ga),at(o,n))}function ft(t,e){var o=this.cache,n=e.elements;void 0===n?st(o,e)||(t.uniformMatrix4fv(this.addr,!1,e),at(o,e)):st(o,n)||(Ua.set(n),t.uniformMatrix4fv(this.addr,!1,Ua),at(o,n))}function mt(t,e,o){var n=this.cache,i=o.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),o.safeSetTexture2D(e||Da,i)}function yt(t,e,o){var n=this.cache,i=o.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),o.setTexture2DArray(e||Oa,i)}function vt(t,e,o){var n=this.cache,i=o.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),o.setTexture3D(e||Pa,i)}function _t(t,e,o){var n=this.cache,i=o.allocateTextureUnit();n[0]!==i&&(t.uniform1i(this.addr,i),n[0]=i),o.safeSetTextureCube(e||ja,i)}function bt(t,e){var o=this.cache;o[0]!==e&&(t.uniform1i(this.addr,e),o[0]=e)}function Et(t,e){var o=this.cache;st(o,e)||(t.uniform2iv(this.addr,e),at(o,e))}function xt(t,e){var o=this.cache;st(o,e)||(t.uniform3iv(this.addr,e),at(o,e))}function St(t,e){var o=this.cache;st(o,e)||(t.uniform4iv(this.addr,e),at(o,e))}function Tt(t,e){var o=this.cache;o[0]!==e&&(t.uniform1ui(this.addr,e),o[0]=e)}function wt(t){switch(t){case 5126:return ct;case 35664:return ut;case 35665:return ht;case 35666:return gt;case 35674:return pt;case 35675:return dt;case 35676:return ft;case 5124:case 35670:return bt;case 35667:case 35671:return Et;case 35668:case 35672:return xt;case 35669:case 35673:return St;case 5125:return Tt;case 35678:case 36198:case 36298:case 36306:case 35682:return mt;case 35679:case 36299:case 36307:return vt;case 35680:case 36300:case 36308:case 36293:return _t;case 36289:case 36303:case 36311:case 36292:return yt}}function Ct(t,e){t.uniform1fv(this.addr,e)}function kt(t,e){t.uniform1iv(this.addr,e)}function At(t,e){t.uniform2iv(this.addr,e)}function It(t,e){t.uniform3iv(this.addr,e)}function Bt(t,e){t.uniform4iv(this.addr,e)}function Mt(t,e){e=rt(e,this.size,2),t.uniform2fv(this.addr,e)}function Lt(t,e){e=rt(e,this.size,3),t.uniform3fv(this.addr,e)}function Nt(t,e){e=rt(e,this.size,4),t.uniform4fv(this.addr,e)}function Rt(t,e){e=rt(e,this.size,4),t.uniformMatrix2fv(this.addr,!1,e)}function Dt(t,e){e=rt(e,this.size,9),t.uniformMatrix3fv(this.addr,!1,e)}function Ot(t,e){e=rt(e,this.size,16),t.uniformMatrix4fv(this.addr,!1,e)}function Pt(t,e,o){var n=e.length,i=lt(o,n);for(t.uniform1iv(this.addr,i),t=0;t!==n;++t)o.safeSetTexture2D(e[t]||Da,i[t])}function jt(t,e,o){var n=e.length,i=lt(o,n);for(t.uniform1iv(this.addr,i),t=0;t!==n;++t)o.safeSetTextureCube(e[t]||ja,i[t])}function Ft(t){switch(t){case 5126:return Ct;case 35664:return Mt;case 35665:return Lt;case 35666:return Nt;case 35674:return Rt;case 35675:return Dt;case 35676:return Ot;case 5124:case 35670:return kt;case 35667:case 35671:return At;case 35668:case 35672:return It;case 35669:case 35673:return Bt;case 35678:case 36198:case 36298:case 36306:case 35682:return Pt;case 35680:case 36300:case 36308:case 36293:return jt}}function Ht(t,e,o){this.id=t,this.addr=o,this.cache=[],this.setValue=wt(e.type)}function Ut(t,e,o){this.id=t,this.addr=o,this.cache=[],this.size=e.size,this.setValue=Ft(e.type)}function Gt(t){this.id=t,this.seq=[],this.map={}}function Vt(t,e){this.seq=[],this.map={};for(var o=t.getProgramParameter(e,35718),n=0;n<o;++n){var i=t.getActiveUniform(e,n),r=t.getUniformLocation(e,i.name),s=this,a=i.name,l=a.length;for(Wa.lastIndex=0;;){var c=Wa.exec(a),u=Wa.lastIndex,h=c[1],g=c[3];if("]"===c[2]&&(h|=0),void 0===g||"["===g&&u+2===l){a=s,i=void 0===g?new Ht(h,i,r):new Ut(h,i,r),a.seq.push(i),a.map[i.id]=i;break}g=s.map[h],void 0===g&&(g=new Gt(h),h=s,s=g,h.seq.push(s),h.map[s.id]=s),s=g}}}function Wt(t,e,o){return e=t.createShader(e),t.shaderSource(e,o),t.compileShader(e),e}function zt(t){switch(t){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function qt(t,e,o){var n=t.getShaderParameter(e,35713),i=t.getShaderInfoLog(e).trim();if(n&&""===i)return"";for(t=t.getShaderSource(e).split("\n"),e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t=t.join("\n"),"THREE.WebGLShader: gl.getShaderInfoLog() "+o+"\n"+i+t}function Xt(t,e){return e=zt(e),"vec4 "+t+"( vec4 value ) { return "+e[0]+"ToLinear"+e[1]+"; }"}function Yt(t,e){return e=zt(e),"vec4 "+t+"( vec4 value ) { return LinearTo"+e[0]+e[1]+"; }"}function Kt(t,e){switch(e){case 1:e="Linear";break;case 2:e="Reinhard";break;case 3:e="OptimizedCineon";break;case 4:e="ACESFilmic";break;case 5:e="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),e="Linear"}return"vec3 "+t+"( vec3 color ) { return "+e+"ToneMapping( color ); }"}function $t(t){var e,o=[];for(e in t){var n=t[e];!1!==n&&o.push("#define "+e+" "+n)}return o.join("\n")}function Qt(t){return""!==t}function Jt(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Zt(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}function te(t,e){if(void 0===(t=La[e]))throw Error("Can not resolve #include <"+e+">");return t.replace(qa,te)}function ee(t,e,o,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),oe(t,e,o,n)}function oe(t,e,o,n){for(t="",e=parseInt(e);e<parseInt(o);e++)t+=n.replace(/\[\s*i\s*\]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return t}function ne(t){var e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function ie(t){var e="SHADOWMAP_TYPE_BASIC";return 1===t.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===t.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===t.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}function re(t){var e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:case 307:e="ENVMAP_TYPE_CUBE_UV"}return e}function se(t){var e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case 302:case 307:e="ENVMAP_MODE_REFRACTION"}return e}function ae(t){var e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}function le(t,e,o,n){var i=t.getContext(),r=o.defines,s=o.vertexShader,a=o.fragmentShader,l=ie(o),c=re(o),u=se(o),h=ae(o),g=0<t.gammaFactor?t.gammaFactor:1,p=o.isWebGL2?"":[o.extensionDerivatives||o.envMapCubeUV||o.bumpMap||o.tangentSpaceNormalMap||o.clearcoatNormalMap||o.flatShading||"physical"===o.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(o.extensionFragDepth||o.logarithmicDepthBuffer)&&o.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",o.extensionDrawBuffers&&o.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(o.extensionShaderTextureLOD||o.envMap)&&o.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Qt).join("\n"),d=$t(r),f=i.createProgram(),m=o.glslVersion?"#version "+o.glslVersion+"\n":"";o.isRawShaderMaterial?(r=[d].filter(Qt).join("\n"),0<r.length&&(r+="\n"),l=[p,d].filter(Qt).join("\n"),0<l.length&&(l+="\n")):(r=[ne(o),"#define SHADER_NAME "+o.shaderName,d,o.instancing?"#define USE_INSTANCING":"",o.instancingColor?"#define USE_INSTANCING_COLOR":"",o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+g,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp2?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+u:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.normalMap&&o.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",o.clearcoatMap?"#define USE_CLEARCOATMAP":"",o.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",o.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.transmissionMap?"#define USE_TRANSMISSIONMAP":"",o.vertexTangents?"#define USE_TANGENT":"",o.vertexColors?"#define USE_COLOR":"",o.vertexUvs?"#define USE_UV":"",o.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+l:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&o.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Qt).join("\n"),l=[p,ne(o),"#define SHADER_NAME "+o.shaderName,d,o.alphaTest?"#define ALPHATEST "+o.alphaTest+(o.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+g,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp2?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.matcap?"#define USE_MATCAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+c:"",o.envMap?"#define "+u:"",o.envMap?"#define "+h:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.normalMap&&o.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",o.clearcoatMap?"#define USE_CLEARCOATMAP":"",o.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",o.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.sheen?"#define USE_SHEEN":"",o.transmissionMap?"#define USE_TRANSMISSIONMAP":"",o.vertexTangents?"#define USE_TANGENT":"",o.vertexColors||o.instancingColor?"#define USE_COLOR":"",o.vertexUvs?"#define USE_UV":"",o.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+l:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&o.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(o.extensionShaderTextureLOD||o.envMap)&&o.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==o.toneMapping?"#define TONE_MAPPING":"",0!==o.toneMapping?La.tonemapping_pars_fragment:"",0!==o.toneMapping?Kt("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",La.encodings_pars_fragment,o.map?Xt("mapTexelToLinear",o.mapEncoding):"",o.matcap?Xt("matcapTexelToLinear",o.matcapEncoding):"",o.envMap?Xt("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMap?Xt("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.lightMap?Xt("lightMapTexelToLinear",o.lightMapEncoding):"",Yt("linearToOutputTexel",o.outputEncoding),o.depthPacking?"#define DEPTH_PACKING "+o.depthPacking:"","\n"].filter(Qt).join("\n")),s=s.replace(qa,te),s=Jt(s,o),s=Zt(s,o),a=a.replace(qa,te),a=Jt(a,o),a=Zt(a,o),s=s.replace(Ya,oe).replace(Xa,ee),a=a.replace(Ya,oe).replace(Xa,ee),o.isWebGL2&&!0!==o.isRawShaderMaterial&&(m="#version 300 es\n",r="#define attribute in\n#define varying out\n#define texture2D texture\n"+r,l=["#define varying in","300 es"===o.glslVersion?"":"out highp vec4 pc_fragColor;","300 es"===o.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth\n#define texture2D texture\n#define textureCube texture\n#define texture2DProj textureProj\n#define texture2DLodEXT textureLod\n#define texture2DProjLodEXT textureProjLod\n#define textureCubeLodEXT textureLod\n#define texture2DGradEXT textureGrad\n#define texture2DProjGradEXT textureProjGrad\n#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+l),a=m+l+a,s=Wt(i,35633,m+r+s),a=Wt(i,35632,a),i.attachShader(f,s),i.attachShader(f,a),void 0!==o.index0AttributeName?i.bindAttribLocation(f,0,o.index0AttributeName):!0===o.morphTargets&&i.bindAttribLocation(f,0,"position"),i.linkProgram(f),t.debug.checkShaderErrors&&(t=i.getProgramInfoLog(f).trim(),m=i.getShaderInfoLog(s).trim(),c=i.getShaderInfoLog(a).trim(),h=u=!0,!1===i.getProgramParameter(f,35714)?(u=!1,g=qt(i,s,"vertex"),p=qt(i,a,"fragment"),console.error("THREE.WebGLProgram: shader error: ",i.getError(),"35715",i.getProgramParameter(f,35715),"gl.getProgramInfoLog",t,g,p)):""!==t?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",t):""!==m&&""!==c||(h=!1),h&&(this.diagnostics={runnable:u,programLog:t,vertexShader:{log:m,prefix:r},fragmentShader:{log:c,prefix:l}})),i.deleteShader(s),i.deleteShader(a);var y;this.getUniforms=function(){return void 0===y&&(y=new Vt(i,f)),y};var v;return this.getAttributes=function(){if(void 0===v){for(var t={},e=i.getProgramParameter(f,35721),o=0;o<e;o++){var n=i.getActiveAttrib(f,o).name;t[n]=i.getAttribLocation(f,n)}v=t}return v},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(f),this.program=void 0},this.name=o.shaderName,this.id=za++,this.cacheKey=e,this.usedTimes=1,this.program=f,this.vertexShader=s,this.fragmentShader=a,this}function ce(t,e,o,n,i,r){function s(t){if(t)t.isTexture?e=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),e=t.texture.encoding);else var e=3e3;return e}var a=[],l=n.isWebGL2,c=n.logarithmicDepthBuffer,u=n.floatVertexTextures,h=n.maxVertexUniforms,g=n.vertexTextures,p=n.precision,d={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},f="precision isWebGL2 supportsVertexTextures outputEncoding instancing instancingColor map mapEncoding matcap matcapEncoding envMap envMapMode envMapEncoding envMapCubeUV lightMap lightMapEncoding aoMap emissiveMap emissiveMapEncoding bumpMap normalMap objectSpaceNormalMap tangentSpaceNormalMap clearcoatMap clearcoatRoughnessMap clearcoatNormalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors vertexTangents vertexUvs uvsVertexOnly fog useFog fogExp2 flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights numDirLightShadows numPointLightShadows numSpotLightShadows shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering sheen transmissionMap".split(" ");return{getParameters:function(i,a,f,m,y){var v=m.fog;m=i.isMeshStandardMaterial?m.environment:null,m=e.get(i.envMap||m);var _=d[i.type];if(y.isSkinnedMesh){var b=y.skeleton.bones;if(u)b=1024;else{var E=Math.min(Math.floor((h-20)/4),b.length);E<b.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+b.length+" bones. This GPU supports "+E+"."),b=0):b=E}}else b=0;if(null!==i.precision&&(p=n.getMaxPrecision(i.precision))!==i.precision&&console.warn("THREE.WebGLProgram.getParameters:",i.precision,"not supported, using",p,"instead."),_){var x=Ra[_];E=x.vertexShader,x=x.fragmentShader}else E=i.vertexShader,x=i.fragmentShader;var S=t.getRenderTarget();return{isWebGL2:l,shaderID:_,shaderName:i.type,vertexShader:E,fragmentShader:x,defines:i.defines,isRawShaderMaterial:!0===i.isRawShaderMaterial,glslVersion:i.glslVersion,precision:p,instancing:!0===y.isInstancedMesh,instancingColor:!0===y.isInstancedMesh&&null!==y.instanceColor,supportsVertexTextures:g,outputEncoding:null!==S?s(S.texture):t.outputEncoding,map:!!i.map,mapEncoding:s(i.map),matcap:!!i.matcap,matcapEncoding:s(i.matcap),envMap:!!m,envMapMode:m&&m.mapping,envMapEncoding:s(m),envMapCubeUV:!!m&&(306===m.mapping||307===m.mapping),lightMap:!!i.lightMap,lightMapEncoding:s(i.lightMap),aoMap:!!i.aoMap,emissiveMap:!!i.emissiveMap,emissiveMapEncoding:s(i.emissiveMap),bumpMap:!!i.bumpMap,normalMap:!!i.normalMap,objectSpaceNormalMap:1===i.normalMapType,tangentSpaceNormalMap:0===i.normalMapType,clearcoatMap:!!i.clearcoatMap,clearcoatRoughnessMap:!!i.clearcoatRoughnessMap,clearcoatNormalMap:!!i.clearcoatNormalMap,displacementMap:!!i.displacementMap,roughnessMap:!!i.roughnessMap,metalnessMap:!!i.metalnessMap,specularMap:!!i.specularMap,alphaMap:!!i.alphaMap,gradientMap:!!i.gradientMap,sheen:!!i.sheen,transmissionMap:!!i.transmissionMap,combine:i.combine,vertexTangents:i.normalMap&&i.vertexTangents,vertexColors:i.vertexColors,vertexUvs:!!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatMap||i.clearcoatRoughnessMap||i.clearcoatNormalMap||i.displacementMap||i.transmissionMap),uvsVertexOnly:!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatNormalMap||i.transmissionMap||!i.displacementMap),fog:!!v,useFog:i.fog,fogExp2:v&&v.isFogExp2,flatShading:i.flatShading,sizeAttenuation:i.sizeAttenuation,logarithmicDepthBuffer:c,skinning:i.skinning&&0<b,maxBones:b,useVertexTexture:u,morphTargets:i.morphTargets,morphNormals:i.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numDirLightShadows:a.directionalShadowMap.length,numPointLightShadows:a.pointShadowMap.length,numSpotLightShadows:a.spotShadowMap.length,numClippingPlanes:r.numPlanes,numClipIntersection:r.numIntersection,dithering:i.dithering,shadowMapEnabled:t.shadowMap.enabled&&0<f.length,shadowMapType:t.shadowMap.type,toneMapping:i.toneMapped?t.toneMapping:0,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:i.premultipliedAlpha,alphaTest:i.alphaTest,doubleSided:2===i.side,flipSided:1===i.side,depthPacking:void 0!==i.depthPacking&&i.depthPacking,index0AttributeName:i.index0AttributeName,extensionDerivatives:i.extensions&&i.extensions.derivatives,extensionFragDepth:i.extensions&&i.extensions.fragDepth,extensionDrawBuffers:i.extensions&&i.extensions.drawBuffers,extensionShaderTextureLOD:i.extensions&&i.extensions.shaderTextureLOD,rendererExtensionFragDepth:l||o.has("EXT_frag_depth"),rendererExtensionDrawBuffers:l||o.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:l||o.has("EXT_shader_texture_lod"),customProgramCacheKey:i.customProgramCacheKey()}},getProgramCacheKey:function(e){var o=[];if(e.shaderID?o.push(e.shaderID):(o.push(e.fragmentShader),o.push(e.vertexShader)),void 0!==e.defines)for(var n in e.defines)o.push(n),o.push(e.defines[n]);if(!1===e.isRawShaderMaterial){for(n=0;n<f.length;n++)o.push(e[f[n]]);o.push(t.outputEncoding),o.push(t.gammaFactor)}return o.push(e.customProgramCacheKey),o.join()},getUniforms:function(t){var e=d[t.type];return e?Aa.clone(Ra[e].uniforms):t.uniforms},acquireProgram:function(e,o){for(var n,r=0,s=a.length;r<s;r++){var l=a[r];if(l.cacheKey===o){n=l,++n.usedTimes;break}}return void 0===n&&(n=new le(t,o,e,i),a.push(n)),n},releaseProgram:function(t){if(0==--t.usedTimes){var e=a.indexOf(t);a[e]=a[a.length-1],a.pop(),t.destroy()}},programs:a}}function ue(){var t=new WeakMap;return{get:function(e){var o=t.get(e);return void 0===o&&(o={},t.set(e,o)),o},remove:function(e){t.delete(e)},update:function(e,o,n){t.get(e)[o]=n},dispose:function(){t=new WeakMap}}}function he(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function ge(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function pe(t){function e(e,i,r,a,l,c){var u=o[n],h=t.get(r);return void 0===u?(u={id:e.id,object:e,geometry:i,material:r,program:h.program||s,groupOrder:a,renderOrder:e.renderOrder,z:l,group:c},o[n]=u):(u.id=e.id,u.object=e,u.geometry=i,u.material=r,u.program=h.program||s,u.groupOrder=a,u.renderOrder=e.renderOrder,u.z=l,u.group=c),n++,u}var o=[],n=0,i=[],r=[],s={id:-1};return{opaque:i,transparent:r,init:function(){n=0,i.length=0,r.length=0},push:function(t,o,n,s,a,l){t=e(t,o,n,s,a,l),(!0===n.transparent?r:i).push(t)},unshift:function(t,o,n,s,a,l){t=e(t,o,n,s,a,l),(!0===n.transparent?r:i).unshift(t)},finish:function(){for(var t=n,e=o.length;t<e;t++){var i=o[t];if(null===i.id)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.program=null,i.group=null}},sort:function(t,e){1<i.length&&i.sort(t||he),1<r.length&&r.sort(e||ge)}}}function de(t){var e=new WeakMap;return{get:function(o,n){var i=e.get(o);if(void 0===i){var r=new pe(t);e.set(o,new WeakMap),e.get(o).set(n,r)}else void 0===(r=i.get(n))&&(r=new pe(t),i.set(n,r));return r},dispose:function(){e=new WeakMap}}}function fe(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];switch(e.type){case"DirectionalLight":var o={direction:new Mr,color:new Ys};break;case"SpotLight":o={position:new Mr,direction:new Mr,color:new Ys,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":o={position:new Mr,color:new Ys,distance:0,decay:0};break;case"HemisphereLight":o={direction:new Mr,skyColor:new Ys,groundColor:new Ys};break;case"RectAreaLight":o={color:new Ys,position:new Mr,halfWidth:new Mr,halfHeight:new Mr}}return t[e.id]=o}}}function me(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];switch(e.type){case"DirectionalLight":var o={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Er};break;case"SpotLight":o={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Er};break;case"PointLight":o={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Er,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=o}}}function ye(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function ve(){for(var t=new fe,e=me(),o={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},n=0;9>n;n++)o.probe.push(new Mr);var i=new Mr,r=new is,s=new is;return{setup:function(n,a,l){for(var c=a=0,u=0,h=0;9>h;h++)o.probe[h].set(0,0,0);var g=h=0,p=0,d=0,f=0,m=0,y=0,v=0;l=l.matrixWorldInverse,n.sort(ye);for(var _=0,b=n.length;_<b;_++){var E=n[_],x=E.color,S=E.intensity,T=E.distance,w=E.shadow&&E.shadow.map?E.shadow.map.texture:null;if(E.isAmbientLight)a+=x.r*S,c+=x.g*S,u+=x.b*S;else if(E.isLightProbe)for(w=0;9>w;w++)o.probe[w].addScaledVector(E.sh.coefficients[w],S);else if(E.isDirectionalLight){if(S=t.get(E),S.color.copy(E.color).multiplyScalar(E.intensity),S.direction.setFromMatrixPosition(E.matrixWorld),i.setFromMatrixPosition(E.target.matrixWorld),S.direction.sub(i),S.direction.transformDirection(l),E.castShadow){var C=E.shadow;x=e.get(E),x.shadowBias=C.bias,x.shadowNormalBias=C.normalBias,x.shadowRadius=C.radius,x.shadowMapSize=C.mapSize,o.directionalShadow[h]=x,o.directionalShadowMap[h]=w,o.directionalShadowMatrix[h]=E.shadow.matrix,m++}o.directional[h]=S,h++}else E.isSpotLight?(C=t.get(E),C.position.setFromMatrixPosition(E.matrixWorld),C.position.applyMatrix4(l),C.color.copy(x).multiplyScalar(S),C.distance=T,C.direction.setFromMatrixPosition(E.matrixWorld),i.setFromMatrixPosition(E.target.matrixWorld),C.direction.sub(i),C.direction.transformDirection(l),C.coneCos=Math.cos(E.angle),C.penumbraCos=Math.cos(E.angle*(1-E.penumbra)),C.decay=E.decay,E.castShadow&&(S=E.shadow,x=e.get(E),x.shadowBias=S.bias,x.shadowNormalBias=S.normalBias,x.shadowRadius=S.radius,x.shadowMapSize=S.mapSize,o.spotShadow[p]=x,o.spotShadowMap[p]=w,o.spotShadowMatrix[p]=E.shadow.matrix,v++),o.spot[p]=C,p++):E.isRectAreaLight?(w=t.get(E),w.color.copy(x).multiplyScalar(S),w.position.setFromMatrixPosition(E.matrixWorld),w.position.applyMatrix4(l),s.identity(),r.copy(E.matrixWorld),r.premultiply(l),s.extractRotation(r),w.halfWidth.set(.5*E.width,0,0),w.halfHeight.set(0,.5*E.height,0),w.halfWidth.applyMatrix4(s),w.halfHeight.applyMatrix4(s),o.rectArea[d]=w,d++):E.isPointLight?(S=t.get(E),S.position.setFromMatrixPosition(E.matrixWorld),S.position.applyMatrix4(l),S.color.copy(E.color).multiplyScalar(E.intensity),S.distance=E.distance,S.decay=E.decay,E.castShadow&&(C=E.shadow,x=e.get(E),x.shadowBias=C.bias,x.shadowNormalBias=C.normalBias,x.shadowRadius=C.radius,x.shadowMapSize=C.mapSize,x.shadowCameraNear=C.camera.near,x.shadowCameraFar=C.camera.far,o.pointShadow[g]=x,o.pointShadowMap[g]=w,o.pointShadowMatrix[g]=E.shadow.matrix,y++),o.point[g]=S,g++):E.isHemisphereLight&&(w=t.get(E),w.direction.setFromMatrixPosition(E.matrixWorld),w.direction.transformDirection(l),w.direction.normalize(),w.skyColor.copy(E.color).multiplyScalar(S),w.groundColor.copy(E.groundColor).multiplyScalar(S),o.hemi[f]=w,f++)}0<d&&(o.rectAreaLTC1=Na.LTC_1,o.rectAreaLTC2=Na.LTC_2),o.ambient[0]=a,o.ambient[1]=c,o.ambient[2]=u,n=o.hash,n.directionalLength===h&&n.pointLength===g&&n.spotLength===p&&n.rectAreaLength===d&&n.hemiLength===f&&n.numDirectionalShadows===m&&n.numPointShadows===y&&n.numSpotShadows===v||(o.directional.length=h,o.spot.length=p,o.rectArea.length=d,o.point.length=g,o.hemi.length=f,o.directionalShadow.length=m,o.directionalShadowMap.length=m,o.pointShadow.length=y,o.pointShadowMap.length=y,o.spotShadow.length=v,o.spotShadowMap.length=v,o.directionalShadowMatrix.length=m,o.pointShadowMatrix.length=y,o.spotShadowMatrix.length=v,n.directionalLength=h,n.pointLength=g,n.spotLength=p,n.rectAreaLength=d,n.hemiLength=f,n.numDirectionalShadows=m,n.numPointShadows=y,n.numSpotShadows=v,o.version=Ka++)},state:o}}function _e(){var t=new ve,e=[],o=[];return{init:function(){e.length=0,o.length=0},state:{lightsArray:e,shadowsArray:o,lights:t},setupLights:function(n){t.setup(e,o,n)},pushLight:function(t){e.push(t)},pushShadow:function(t){o.push(t)}}}function be(){var t=new WeakMap;return{get:function(e,o){if(!1===t.has(e)){var n=new _e;t.set(e,new WeakMap),t.get(e).set(o,n)}else!1===t.get(e).has(o)?(n=new _e,t.get(e).set(o,n)):n=t.get(e).get(o);return n},dispose:function(){t=new WeakMap}}}function Ee(t){u.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function xe(t){u.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Mr,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}function Se(t,e,o){function i(t,e,o){o=t<<0|e<<1|o<<2;var n=p[o];return void 0===n&&(n=new Ee({depthPacking:3201,morphTargets:t,skinning:e}),p[o]=n),n}function r(t,e,o){o=t<<0|e<<1|o<<2;var n=d[o];return void 0===n&&(n=new xe({morphTargets:t,skinning:e}),d[o]=n),n}function s(e,o,n,s,a,l,c){var u=i,h=e.customDepthMaterial;return!0===s.isPointLight&&(u=r,h=e.customDistanceMaterial),void 0===h?(h=!1,!0===n.morphTargets&&(h=o.morphAttributes&&o.morphAttributes.position&&0<o.morphAttributes.position.length),o=!1,!0===e.isSkinnedMesh&&(!0===n.skinning?o=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e)),e=u(h,o,!0===e.isInstancedMesh)):e=h,t.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length&&(h=e.uuid,u=n.uuid,o=f[h],void 0===o&&(o={},f[h]=o),h=o[u],void 0===h&&(h=e.clone(),o[u]=h),e=h),e.visible=n.visible,e.wireframe=n.wireframe,e.side=3===c?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:m[n.side],e.clipShadows=n.clipShadows,e.clippingPlanes=n.clippingPlanes,e.clipIntersection=n.clipIntersection,e.wireframeLinewidth=n.wireframeLinewidth,e.linewidth=n.linewidth,!0===s.isPointLight&&!0===e.isMeshDistanceMaterial&&(e.referencePosition.setFromMatrixPosition(s.matrixWorld),e.nearDistance=a,e.farDistance=l),e}function a(o,n,i,r,c){if(!1!==o.visible){if(o.layers.test(n.layers)&&(o.isMesh||o.isLine||o.isPoints)&&(o.castShadow||o.receiveShadow&&3===c)&&(!o.frustumCulled||l.intersectsObject(o))){o.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,o.matrixWorld);var u=e.update(o),h=o.material;if(Array.isArray(h))for(var g=u.groups,p=0,d=g.length;p<d;p++){var f=g[p],m=h[f.materialIndex];m&&m.visible&&(m=s(o,u,m,r,i.near,i.far,c),t.renderBufferDirect(i,null,u,m,o,f))}else h.visible&&(h=s(o,u,h,r,i.near,i.far,c),t.renderBufferDirect(i,null,u,h,o,null))}for(o=o.children,u=0,h=o.length;u<h;u++)a(o[u],n,i,r,c)}}var l=new Ma,c=new Er,u=new Er,h=new kr,p=[],d=[],f={},m={0:1,1:0,2:2},y=new L({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:.125},uniforms:{shadow_pass:{value:null},resolution:{value:new Er},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\t\t#ifdef HORIZONAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),v=y.clone();v.defines.HORIZONAL_PASS=1;var _=new S;_.setAttribute("position",new g(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var b=new T(_,y),E=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(i,r,s){if(!1!==E.enabled&&(!1!==E.autoUpdate||!1!==E.needsUpdate)&&0!==i.length){var g=t.getRenderTarget(),p=t.getActiveCubeFace(),d=t.getActiveMipmapLevel(),f=t.state;f.setBlending(0),f.buffers.color.setClear(1,1,1,1),f.buffers.depth.setTest(!0),f.setScissorTest(!1);for(var m=0,_=i.length;m<_;m++){var x=i[m],S=x.shadow;if(!1!==S.autoUpdate||!1!==S.needsUpdate)if(void 0===S)console.warn("THREE.WebGLShadowMap:",x,"has no shadow.");else{c.copy(S.mapSize);var T=S.getFrameExtents();c.multiply(T),u.copy(S.mapSize),(c.x>o||c.y>o)&&(c.x>o&&(u.x=Math.floor(o/T.x),c.x=u.x*T.x,S.mapSize.x=u.x),c.y>o&&(u.y=Math.floor(o/T.y),c.y=u.y*T.y,S.mapSize.y=u.y)),null!==S.map||S.isPointLightShadow||3!==this.type||(T={minFilter:1006,magFilter:1006,format:1023},S.map=new n(c.x,c.y,T),S.map.texture.name=x.name+".shadowMap",S.mapPass=new n(c.x,c.y,T),S.camera.updateProjectionMatrix()),null===S.map&&(S.map=new n(c.x,c.y,{minFilter:1003,magFilter:1003,format:1023}),S.map.texture.name=x.name+".shadowMap",S.camera.updateProjectionMatrix()),t.setRenderTarget(S.map),t.clear(),T=S.getViewportCount();for(var w=0;w<T;w++){var C=S.getViewport(w);h.set(u.x*C.x,u.y*C.y,u.x*C.z,u.y*C.w),f.viewport(h),S.updateMatrices(x,w),l=S.getFrustum(),a(r,s,S.camera,x,this.type)}S.isPointLightShadow||3!==this.type||(x=S,T=s,w=e.update(b),y.uniforms.shadow_pass.value=x.map.texture,y.uniforms.resolution.value=x.mapSize,y.uniforms.radius.value=x.radius,t.setRenderTarget(x.mapPass),t.clear(),t.renderBufferDirect(T,null,w,y,b,null),v.uniforms.shadow_pass.value=x.mapPass.texture,v.uniforms.resolution.value=x.mapSize,v.uniforms.radius.value=x.radius,t.setRenderTarget(x.map),t.clear(),t.renderBufferDirect(T,null,w,v,b,null)),S.needsUpdate=!1}}E.needsUpdate=!1,t.setRenderTarget(g,p,d)}}}function Te(t,e,o){function n(e,o,n){var i=new Uint8Array(4),r=t.createTexture();for(t.bindTexture(e,r),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728),e=0;e<n;e++)t.texImage2D(o+e,0,6408,1,1,0,6408,5121,i);return r}function i(e){!0!==d[e]&&(t.enable(e),d[e]=!0)}function r(e){!1!==d[e]&&(t.disable(e),d[e]=!1)}function s(e,o,n,s,a,l,c,u){if(0===e)m&&(r(3042),m=!1);else if(m||(i(3042),m=!0),5!==e){if(e!==y||u!==T){if(100===v&&100===E||(t.blendEquation(32774),E=v=100),u)switch(e){case 1:t.blendFuncSeparate(1,771,1,771);break;case 2:t.blendFunc(1,1);break;case 3:t.blendFuncSeparate(0,0,769,771);break;case 4:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case 1:t.blendFuncSeparate(770,771,1,771);break;case 2:t.blendFunc(770,1);break;case 3:t.blendFunc(0,769);break;case 4:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}S=x=b=_=null,y=e,T=u}}else a=a||o,l=l||n,c=c||s,o===v&&a===E||(t.blendEquationSeparate(j[o],j[a]),v=o,E=a),n===_&&s===b&&l===x&&c===S||(t.blendFuncSeparate(F[n],F[s],F[l],F[c]),_=n,b=s,x=l,S=c),y=e,T=null}function a(e){w!==e&&(e?t.frontFace(2304):t.frontFace(2305),w=e)}function l(e){0!==e?(i(2884),e!==C&&(1===e?t.cullFace(1029):2===e?t.cullFace(1028):t.cullFace(1032))):r(2884),C=e}function c(e,o,n){e?(i(32823),(A!==o||I!==n)&&(t.polygonOffset(o,n),A=o,I=n)):r(32823)}function u(e){void 0===e&&(e=33984+B-1),N!==e&&(t.activeTexture(e),N=e)}o=o.isWebGL2;var h=new function(){var e=!1,o=new kr,n=null,i=new kr(0,0,0,0);return{setMask:function(o){n===o||e||(t.colorMask(o,o,o,o),n=o)},setLocked:function(t){e=t},setClear:function(e,n,r,s,a){!0===a&&(e*=s,n*=s,r*=s),o.set(e,n,r,s),!1===i.equals(o)&&(t.clearColor(e,n,r,s),i.copy(o))},reset:function(){e=!1,n=null,i.set(-1,0,0,0)}}},g=new function(){var e=!1,o=null,n=null,s=null;return{setTest:function(t){t?i(2929):r(2929)},setMask:function(n){o===n||e||(t.depthMask(n),o=n)},setFunc:function(e){if(n!==e){if(e)switch(e){case 0:t.depthFunc(512);break;case 1:t.depthFunc(519);break;case 2:t.depthFunc(513);break;case 3:t.depthFunc(515);break;case 4:t.depthFunc(514);break;case 5:t.depthFunc(518);break;case 6:t.depthFunc(516);break;case 7:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);n=e}},setLocked:function(t){e=t},setClear:function(e){s!==e&&(t.clearDepth(e),s=e)},reset:function(){e=!1,s=n=o=null}}},p=new function(){var e=!1,o=null,n=null,s=null,a=null,l=null,c=null,u=null,h=null;return{setTest:function(t){e||(t?i(2960):r(2960))},setMask:function(n){o===n||e||(t.stencilMask(n),o=n)},setFunc:function(e,o,i){n===e&&s===o&&a===i||(t.stencilFunc(e,o,i),n=e,s=o,a=i)},setOp:function(e,o,n){l===e&&c===o&&u===n||(t.stencilOp(e,o,n),l=e,c=o,u=n)},setLocked:function(t){e=t},setClear:function(e){h!==e&&(t.clearStencil(e),h=e)},reset:function(){e=!1,h=u=c=l=a=s=n=o=null}}},d={},f=null,m=null,y=null,v=null,_=null,b=null,E=null,x=null,S=null,T=!1,w=null,C=null,k=null,A=null,I=null,B=t.getParameter(35661),M=!1,L=0;L=t.getParameter(7938),-1!==L.indexOf("WebGL")?(L=parseFloat(/^WebGL ([0-9])/.exec(L)[1]),M=1<=L):-1!==L.indexOf("OpenGL ES")&&(L=parseFloat(/^OpenGL ES ([0-9])/.exec(L)[1]),M=2<=L);var N=null,R={},D=new kr,O=new kr,P={};P[3553]=n(3553,3553,1),P[34067]=n(34067,34069,6),h.setClear(0,0,0,1),g.setClear(1),p.setClear(0),i(2929),g.setFunc(3),a(!1),l(1),i(2884),s(0);var j={100:32774,101:32778,102:32779};o?(j[103]=32775,j[104]=32776):null!==(e=e.get("EXT_blend_minmax"))&&(j[103]=e.MIN_EXT,j[104]=e.MAX_EXT);var F={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};return{buffers:{color:h,depth:g,stencil:p},enable:i,disable:r,useProgram:function(e){return f!==e&&(t.useProgram(e),f=e,!0)},setBlending:s,setMaterial:function(t,e){2===t.side?r(2884):i(2884);var o=1===t.side;e&&(o=!o),a(o),1===t.blending&&!1===t.transparent?s(0):s(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),g.setFunc(t.depthFunc),g.setTest(t.depthTest),g.setMask(t.depthWrite),h.setMask(t.colorWrite),e=t.stencilWrite,p.setTest(e),e&&(p.setMask(t.stencilWriteMask),p.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),p.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),c(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:a,setCullFace:l,setLineWidth:function(e){e!==k&&(M&&t.lineWidth(e),k=e)},setPolygonOffset:c,setScissorTest:function(t){t?i(3089):r(3089)},activeTexture:u,bindTexture:function(e,o){null===N&&u();var n=R[N];void 0===n&&(n={type:void 0,texture:void 0},R[N]=n),n.type===e&&n.texture===o||(t.bindTexture(e,o||P[e]),n.type=e,n.texture=o)},unbindTexture:function(){var e=R[N];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===D.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),D.copy(e))},viewport:function(e){!1===O.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),O.copy(e))},reset:function(){d={},N=null,R={},C=w=y=f=null,h.reset(),g.reset(),p.reset()}}}function we(t,e,o,n,i,r,s){function a(t,e){return L?new OffscreenCanvas(t,e):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function l(t,e,o,n){var i=1;if((t.width>n||t.height>n)&&(i=n/Math.max(t.width,t.height)),1>i||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap)return n=e?br.floorPowerOfTwo:Math.floor,e=n(i*t.width),i=n(i*t.height),void 0===w&&(w=a(e,i)),o=o?a(e,i):w,o.width=e,o.height=i,o.getContext("2d").drawImage(t,0,0,e,i),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+e+"x"+i+")."),o;"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+").")}return t}function c(t){return br.isPowerOfTwo(t.width)&&br.isPowerOfTwo(t.height)}function u(t,e){return t.generateMipmaps&&e&&1003!==t.minFilter&&1006!==t.minFilter}function h(e,o,i,r){t.generateMipmap(e),n.get(o).__maxMipLevel=Math.log(Math.max(i,r))*Math.LOG2E}function g(o,n,i){if(!1===C)return n;if(null!==o){if(void 0!==t[o])return t[o];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+o+"'")}return o=n,6403===n&&(5126===i&&(o=33326),5131===i&&(o=33325),5121===i&&(o=33321)),6407===n&&(5126===i&&(o=34837),5131===i&&(o=34843),5121===i&&(o=32849)),6408===n&&(5126===i&&(o=34836),5131===i&&(o=34842),5121===i&&(o=32856)),33325!==o&&33326!==o&&34842!==o&&34836!==o||e.get("EXT_color_buffer_float"),o}function p(t){return 1003===t||1004===t||1005===t?9728:9729}function d(e){e=e.target,e.removeEventListener("dispose",d);var o=n.get(e);void 0!==o.__webglInit&&(t.deleteTexture(o.__webglTexture),n.remove(e)),e.isVideoTexture&&M.delete(e),s.memory.textures--}function f(e){e=e.target,e.removeEventListener("dispose",f);var o=n.get(e),i=n.get(e.texture);if(e){if(void 0!==i.__webglTexture&&t.deleteTexture(i.__webglTexture),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLCubeRenderTarget)for(i=0;6>i;i++)t.deleteFramebuffer(o.__webglFramebuffer[i]),o.__webglDepthbuffer&&t.deleteRenderbuffer(o.__webglDepthbuffer[i]);else t.deleteFramebuffer(o.__webglFramebuffer),o.__webglDepthbuffer&&t.deleteRenderbuffer(o.__webglDepthbuffer),o.__webglMultisampledFramebuffer&&t.deleteFramebuffer(o.__webglMultisampledFramebuffer),o.__webglColorRenderbuffer&&t.deleteRenderbuffer(o.__webglColorRenderbuffer),o.__webglDepthRenderbuffer&&t.deleteRenderbuffer(o.__webglDepthRenderbuffer);n.remove(e.texture),n.remove(e)}s.memory.textures--}function m(t,e){var i=n.get(t);if(t.isVideoTexture){var r=s.render.frame;M.get(t)!==r&&(M.set(t,r),t.update())}if(0<t.version&&i.__version!==t.version)if(void 0===(r=t.image))console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==r.complete)return void E(i,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}o.activeTexture(33984+e),o.bindTexture(3553,i.__webglTexture)}function y(e,i){if(6===e.image.length){var s=n.get(e);if(0<e.version&&s.__version!==e.version){b(s,e),o.activeTexture(33984+i),o.bindTexture(34067,s.__webglTexture),t.pixelStorei(37440,e.flipY);var a=e&&(e.isCompressedTexture||e.image[0].isCompressedTexture),p=e.image[0]&&e.image[0].isDataTexture;i=[];for(var d=0;6>d;d++)i[d]=a||p?p?e.image[d].image:e.image[d]:l(e.image[d],!1,!0,A);d=i[0];var f=c(d)||C,m=r.convert(e.format),y=r.convert(e.type),v=g(e.internalFormat,m,y);if(_(34067,e,f),a){for(p=0;6>p;p++){var E=i[p].mipmaps;for(a=0;a<E.length;a++){var x=E[a];1023!==e.format&&1022!==e.format?null!==m?o.compressedTexImage2D(34069+p,a,v,x.width,x.height,0,x.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):o.texImage2D(34069+p,a,v,x.width,x.height,0,m,y,x.data)}}s.__maxMipLevel=E.length-1}else{for(E=e.mipmaps,a=0;6>a;a++)if(p)for(o.texImage2D(34069+a,0,v,i[a].width,i[a].height,0,m,y,i[a].data),x=0;x<E.length;x++){var S=E[x].image[a].image;o.texImage2D(34069+a,x+1,v,S.width,S.height,0,m,y,S.data)}else for(o.texImage2D(34069+a,0,v,m,y,i[a]),x=0;x<E.length;x++)o.texImage2D(34069+a,x+1,v,m,y,E[x].image[a]);s.__maxMipLevel=E.length}u(e,f)&&h(34067,e,d.width,d.height),s.__version=e.version,e.onUpdate&&e.onUpdate(e)}else o.activeTexture(33984+i),o.bindTexture(34067,s.__webglTexture)}}function v(t,e){o.activeTexture(33984+e),o.bindTexture(34067,n.get(t).__webglTexture)}function _(o,r,s){s?(t.texParameteri(o,10242,R[r.wrapS]),t.texParameteri(o,10243,R[r.wrapT]),32879!==o&&35866!==o||t.texParameteri(o,32882,R[r.wrapR]),t.texParameteri(o,10240,D[r.magFilter]),t.texParameteri(o,10241,D[r.minFilter])):(t.texParameteri(o,10242,33071),t.texParameteri(o,10243,33071),32879!==o&&35866!==o||t.texParameteri(o,32882,33071),1001===r.wrapS&&1001===r.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(o,10240,p(r.magFilter)),t.texParameteri(o,10241,p(r.minFilter)),1003!==r.minFilter&&1006!==r.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!(s=e.get("EXT_texture_filter_anisotropic"))||1015===r.type&&null===e.get("OES_texture_float_linear")||1016===r.type&&null===(C||e.get("OES_texture_half_float_linear"))||!(1<r.anisotropy||n.get(r).__currentAnisotropy)||(t.texParameterf(o,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(r.anisotropy,i.getMaxAnisotropy())),n.get(r).__currentAnisotropy=r.anisotropy)}function b(e,o){void 0===e.__webglInit&&(e.__webglInit=!0,o.addEventListener("dispose",d),e.__webglTexture=t.createTexture(),s.memory.textures++)}function E(e,n,i){var s=3553;n.isDataTexture2DArray&&(s=35866),n.isDataTexture3D&&(s=32879),b(e,n),o.activeTexture(33984+i),o.bindTexture(s,e.__webglTexture),t.pixelStorei(37440,n.flipY),t.pixelStorei(37441,n.premultiplyAlpha),t.pixelStorei(3317,n.unpackAlignment),i=!C&&(1001!==n.wrapS||1001!==n.wrapT||1003!==n.minFilter&&1006!==n.minFilter),i=i&&!1===c(n.image),i=l(n.image,i,!1,I);var a=c(i)||C,p=r.convert(n.format),d=r.convert(n.type),f=g(n.internalFormat,p,d);_(s,n,a);var m=n.mipmaps;if(n.isDepthTexture)f=6402,C?f=1015===n.type?36012:1014===n.type?33190:1020===n.type?35056:33189:1015===n.type&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),1026===n.format&&6402===f&&1012!==n.type&&1014!==n.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),n.type=1012,d=r.convert(n.type)),1027===n.format&&6402===f&&(f=34041,1020!==n.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),n.type=1020,d=r.convert(n.type))),o.texImage2D(3553,0,f,i.width,i.height,0,p,d,null);else if(n.isDataTexture)if(0<m.length&&a){for(var y=0,v=m.length;y<v;y++){var E=m[y];o.texImage2D(3553,y,f,E.width,E.height,0,p,d,E.data)}n.generateMipmaps=!1,e.__maxMipLevel=m.length-1}else o.texImage2D(3553,0,f,i.width,i.height,0,p,d,i.data),e.__maxMipLevel=0;else if(n.isCompressedTexture){for(y=0,v=m.length;y<v;y++)E=m[y],1023!==n.format&&1022!==n.format?null!==p?o.compressedTexImage2D(3553,y,f,E.width,E.height,0,E.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):o.texImage2D(3553,y,f,E.width,E.height,0,p,d,E.data);e.__maxMipLevel=m.length-1}else if(n.isDataTexture2DArray)o.texImage3D(35866,0,f,i.width,i.height,i.depth,0,p,d,i.data),e.__maxMipLevel=0;else if(n.isDataTexture3D)o.texImage3D(32879,0,f,i.width,i.height,i.depth,0,p,d,i.data),e.__maxMipLevel=0;else if(0<m.length&&a){for(y=0,v=m.length;y<v;y++)E=m[y],o.texImage2D(3553,y,f,p,d,E);n.generateMipmaps=!1,e.__maxMipLevel=m.length-1}else o.texImage2D(3553,0,f,p,d,i),e.__maxMipLevel=0;u(n,a)&&h(s,n,i.width,i.height),e.__version=n.version,n.onUpdate&&n.onUpdate(n)}function x(e,i,s,a){var l=r.convert(i.texture.format),c=r.convert(i.texture.type),u=g(i.texture.internalFormat,l,c);o.texImage2D(a,0,u,i.width,i.height,0,l,c,null),t.bindFramebuffer(36160,e),t.framebufferTexture2D(36160,s,a,n.get(i.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function S(e,o,n){if(t.bindRenderbuffer(36161,e),o.depthBuffer&&!o.stencilBuffer){var i=33189;n?((n=o.depthTexture)&&n.isDepthTexture&&(1015===n.type?i=36012:1014===n.type&&(i=33190)),n=T(o),t.renderbufferStorageMultisample(36161,n,i,o.width,o.height)):t.renderbufferStorage(36161,i,o.width,o.height),t.framebufferRenderbuffer(36160,36096,36161,e)}else o.depthBuffer&&o.stencilBuffer?(n?(n=T(o),t.renderbufferStorageMultisample(36161,n,35056,o.width,o.height)):t.renderbufferStorage(36161,34041,o.width,o.height),t.framebufferRenderbuffer(36160,33306,36161,e)):(e=r.convert(o.texture.format),i=r.convert(o.texture.type),e=g(o.texture.internalFormat,e,i),n?(n=T(o),t.renderbufferStorageMultisample(36161,n,e,o.width,o.height)):t.renderbufferStorage(36161,e,o.width,o.height));t.bindRenderbuffer(36161,null)}function T(t){return C&&t.isWebGLMultisampleRenderTarget?Math.min(B,t.samples):0}var w,C=i.isWebGL2,k=i.maxTextures,A=i.maxCubemapSize,I=i.maxTextureSize,B=i.maxSamples,M=new WeakMap,L=!1;try{L="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}var N=0,R={1e3:10497,1001:33071,1002:33648},D={1003:9728,1004:9984,1005:9986,1006:9729,1007:9985,1008:9987},O=!1,P=!1;this.allocateTextureUnit=function(){var t=N;return t>=k&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+k),N+=1,t},this.resetTextureUnits=function(){N=0},this.setTexture2D=m,this.setTexture2DArray=function(t,e){var i=n.get(t);0<t.version&&i.__version!==t.version?E(i,t,e):(o.activeTexture(33984+e),o.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(t,e){var i=n.get(t);0<t.version&&i.__version!==t.version?E(i,t,e):(o.activeTexture(33984+e),o.bindTexture(32879,i.__webglTexture))},this.setTextureCube=y,this.setTextureCubeDynamic=v,this.setupRenderTarget=function(e){var i=n.get(e),a=n.get(e.texture);e.addEventListener("dispose",f),a.__webglTexture=t.createTexture(),s.memory.textures++;var l=!0===e.isWebGLCubeRenderTarget,p=!0===e.isWebGLMultisampleRenderTarget,d=c(e)||C;if(!C||1022!==e.texture.format||1015!==e.texture.type&&1016!==e.texture.type||(e.texture.format=1023,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),l)for(i.__webglFramebuffer=[],p=0;6>p;p++)i.__webglFramebuffer[p]=t.createFramebuffer();else if(i.__webglFramebuffer=t.createFramebuffer(),p)if(C){i.__webglMultisampledFramebuffer=t.createFramebuffer(),i.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,i.__webglColorRenderbuffer),p=r.convert(e.texture.format);var y=r.convert(e.texture.type);p=g(e.texture.internalFormat,p,y),y=T(e),t.renderbufferStorageMultisample(36161,y,p,e.width,e.height),t.bindFramebuffer(36160,i.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,i.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),e.depthBuffer&&(i.__webglDepthRenderbuffer=t.createRenderbuffer(),S(i.__webglDepthRenderbuffer,e,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(l){for(o.bindTexture(34067,a.__webglTexture),_(34067,e.texture,d),a=0;6>a;a++)x(i.__webglFramebuffer[a],e,36064,34069+a);u(e.texture,d)&&h(34067,e.texture,e.width,e.height),o.bindTexture(34067,null)}else o.bindTexture(3553,a.__webglTexture),_(3553,e.texture,d),x(i.__webglFramebuffer,e,36064,3553),u(e.texture,d)&&h(3553,e.texture,e.width,e.height),o.bindTexture(3553,null);if(e.depthBuffer){if(i=n.get(e),d=!0===e.isWebGLCubeRenderTarget,e.depthTexture){if(d)throw Error("target.depthTexture not supported in Cube render targets");if(e&&e.isWebGLCubeRenderTarget)throw Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,i.__webglFramebuffer),!e.depthTexture||!e.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(n.get(e.depthTexture).__webglTexture&&e.depthTexture.image.width===e.width&&e.depthTexture.image.height===e.height||(e.depthTexture.image.width=e.width,e.depthTexture.image.height=e.height,e.depthTexture.needsUpdate=!0),m(e.depthTexture,0),i=n.get(e.depthTexture).__webglTexture,1026===e.depthTexture.format)t.framebufferTexture2D(36160,36096,3553,i,0);else{if(1027!==e.depthTexture.format)throw Error("Unknown depthTexture format");t.framebufferTexture2D(36160,33306,3553,i,0)}}else if(d)for(i.__webglDepthbuffer=[],d=0;6>d;d++)t.bindFramebuffer(36160,i.__webglFramebuffer[d]),i.__webglDepthbuffer[d]=t.createRenderbuffer(),S(i.__webglDepthbuffer[d],e,!1);else t.bindFramebuffer(36160,i.__webglFramebuffer),i.__webglDepthbuffer=t.createRenderbuffer(),S(i.__webglDepthbuffer,e,!1);t.bindFramebuffer(36160,null)}},this.updateRenderTargetMipmap=function(t){var e=t.texture,i=c(t)||C;if(u(e,i)){i=t.isWebGLCubeRenderTarget?34067:3553;var r=n.get(e).__webglTexture;o.bindTexture(i,r),h(i,e,t.width,t.height),o.bindTexture(i,null)}},this.updateMultisampleRenderTarget=function(e){if(e.isWebGLMultisampleRenderTarget)if(C){var o=n.get(e);t.bindFramebuffer(36008,o.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,o.__webglFramebuffer);var i=e.width,r=e.height,s=16384;e.depthBuffer&&(s|=256),e.stencilBuffer&&(s|=1024),t.blitFramebuffer(0,0,i,r,0,0,i,r,s,9728),t.bindFramebuffer(36160,o.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===O&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),O=!0),t=t.texture),m(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLCubeRenderTarget&&(!1===P&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),P=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?y(t,e):v(t,e)}}function Ce(t,e,o){var n=o.isWebGL2;return{convert:function(t){if(1009===t)return 5121;if(1017===t)return 32819;if(1018===t)return 32820;if(1019===t)return 33635;if(1010===t)return 5120;if(1011===t)return 5122;if(1012===t)return 5123;if(1013===t)return 5124;if(1014===t)return 5125;if(1015===t)return 5126;if(1016===t){if(n)return 5131;var o=e.get("OES_texture_half_float");return null!==o?o.HALF_FLOAT_OES:null}if(1021===t)return 6406;if(1022===t)return 6407;if(1023===t)return 6408;if(1024===t)return 6409;if(1025===t)return 6410;if(1026===t)return 6402;if(1027===t)return 34041;if(1028===t)return 6403;if(1029===t)return 36244;if(1030===t)return 33319;if(1031===t)return 33320;if(1032===t)return 36248;if(1033===t)return 36249;if(33776===t||33777===t||33778===t||33779===t){if(null===(o=e.get("WEBGL_compressed_texture_s3tc")))return null;if(33776===t)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===t)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===t)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===t)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===t||35841===t||35842===t||35843===t){if(null===(o=e.get("WEBGL_compressed_texture_pvrtc")))return null;if(35840===t)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===t)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===t)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===t)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===t)return o=e.get("WEBGL_compressed_texture_etc1"),null!==o?o.COMPRESSED_RGB_ETC1_WEBGL:null;if((37492===t||37496===t)&&null!==(o=e.get("WEBGL_compressed_texture_etc"))){if(37492===t)return o.COMPRESSED_RGB8_ETC2;if(37496===t)return o.COMPRESSED_RGBA8_ETC2_EAC}return 37808===t||37809===t||37810===t||37811===t||37812===t||37813===t||37814===t||37815===t||37816===t||37817===t||37818===t||37819===t||37820===t||37821===t||37840===t||37841===t||37842===t||37843===t||37844===t||37845===t||37846===t||37847===t||37848===t||37849===t||37850===t||37851===t||37852===t||37853===t?(o=e.get("WEBGL_compressed_texture_astc"),null!==o?t:null):36492===t?(o=e.get("EXT_texture_compression_bptc"),null!==o?t:null):1020===t?n?34042:(o=e.get("WEBGL_depth_texture"),null!==o?o.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}function ke(t){R.call(this),this.cameras=t||[]}function Ae(){s.call(this),this.type="Group"}function Ie(){this._hand=this._grip=this._targetRay=null}function Be(t,e){function o(t){var e=d.get(t.inputSource);e&&e.dispatchEvent({type:t.type})}function n(){d.forEach(function(t,e){t.disconnect(e)}),d.clear(),t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),T.stop(),a.isPresenting=!1,a.dispatchEvent({type:"sessionend"})}function i(t){u=t,T.setContext(l),T.start(),a.isPresenting=!0,a.dispatchEvent({type:"sessionstart"})}function r(t){for(var e=l.inputSources,o=0;o<p.length;o++)d.set(e[o],p[o]);for(e=0;e<t.removed.length;e++){o=t.removed[e];var n=d.get(o);n&&(n.dispatchEvent({type:"disconnected",data:o}),d.delete(o))}for(e=0;e<t.added.length;e++)o=t.added[e],(n=d.get(o))&&n.dispatchEvent({type:"connected",data:o})}function s(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.getInverse(t.matrixWorld)}var a=this,l=null,c=1,u=null,h="local-floor",g=null,p=[],d=new Map,f=new R;f.layers.enable(1),f.viewport=new kr;var m=new R;m.layers.enable(2),m.viewport=new kr;var y=[f,m],v=new ke;v.layers.enable(1),v.layers.enable(2);var _=null,b=null;this.isPresenting=this.enabled=!1,this.getController=function(t){var e=p[t];return void 0===e&&(e=new Ie,p[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){var e=p[t];return void 0===e&&(e=new Ie,p[t]=e),e.getGripSpace()},this.getHand=function(t){var e=p[t];return void 0===e&&(e=new Ie,p[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){c=t,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){h=t,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u},this.getSession=function(){return l},this.setSession=function(t){null!==(l=t)&&(l.addEventListener("select",o),l.addEventListener("selectstart",o),l.addEventListener("selectend",o),l.addEventListener("squeeze",o),l.addEventListener("squeezestart",o),l.addEventListener("squeezeend",o),l.addEventListener("end",n),t=e.getContextAttributes(),!0!==t.xrCompatible&&e.makeXRCompatible(),t=new XRWebGLLayer(l,e,{antialias:t.antialias,alpha:t.alpha,depth:t.depth,stencil:t.stencil,framebufferScaleFactor:c}),l.updateRenderState({baseLayer:t}),l.requestReferenceSpace(h).then(i),l.addEventListener("inputsourceschange",r))};var E=new Mr,x=new Mr;this.getCamera=function(t){v.near=m.near=f.near=t.near,v.far=m.far=f.far=t.far,_===v.near&&b===v.far||(l.updateRenderState({depthNear:v.near,depthFar:v.far}),_=v.near,b=v.far);var e=t.parent,o=v.cameras;s(v,e);for(var n=0;n<o.length;n++)s(o[n],e);for(t.matrixWorld.copy(v.matrixWorld),t=t.children,e=0,n=t.length;e<n;e++)t[e].updateMatrixWorld(!0);if(2===o.length){E.setFromMatrixPosition(f.matrixWorld),x.setFromMatrixPosition(m.matrixWorld),o=E.distanceTo(x);var i=f.projectionMatrix.elements,r=m.projectionMatrix.elements,a=i[14]/(i[10]-1);t=i[14]/(i[10]+1),e=(i[9]+1)/i[5],n=(i[9]-1)/i[5];var c=(i[8]-1)/i[0],u=(r[8]+1)/r[0];r=a*c,i=a*u,u=o/(-c+u),c=u*-c,f.matrixWorld.decompose(v.position,v.quaternion,v.scale),v.translateX(c),v.translateZ(u),v.matrixWorld.compose(v.position,v.quaternion,v.scale),v.matrixWorldInverse.getInverse(v.matrixWorld),a+=u,u=t+u,v.projectionMatrix.makePerspective(r-c,i+(o-c),e*t/u*a,n*t/u*a,a,u)}else v.projectionMatrix.copy(f.projectionMatrix);return v};var S=null,T=new j;T.setAnimationLoop(function(e,o){if(null!==(g=o.getViewerPose(u))){var n=g.views,i=l.renderState.baseLayer;t.setFramebuffer(i.framebuffer);var r=!1;n.length!==v.cameras.length&&(v.cameras.length=0,r=!0);for(var s=0;s<n.length;s++){var a=n[s],c=i.getViewport(a),h=y[s];h.matrix.fromArray(a.transform.matrix),h.projectionMatrix.fromArray(a.projectionMatrix),h.viewport.set(c.x,c.y,c.width,c.height),0===s&&v.matrix.copy(h.matrix),!0===r&&v.cameras.push(h)}}for(n=l.inputSources,i=0;i<p.length;i++)p[i].update(n[i],o,u);S&&S(e,o)}),this.setAnimationLoop=function(t){S=t},this.dispose=function(){}}function Me(t){function e(e,o){e.opacity.value=o.opacity,o.color&&e.diffuse.value.copy(o.color),o.emissive&&e.emissive.value.copy(o.emissive).multiplyScalar(o.emissiveIntensity),o.map&&(e.map.value=o.map),o.alphaMap&&(e.alphaMap.value=o.alphaMap),o.specularMap&&(e.specularMap.value=o.specularMap);var n=t.get(o).envMap;if(n&&(e.envMap.value=n,e.flipEnvMap.value=n.isCubeTexture?-1:1,e.reflectivity.value=o.reflectivity,e.refractionRatio.value=o.refractionRatio,void 0!==(n=t.get(n).__maxMipLevel)&&(e.maxMipLevel.value=n)),o.lightMap&&(e.lightMap.value=o.lightMap,e.lightMapIntensity.value=o.lightMapIntensity),o.aoMap&&(e.aoMap.value=o.aoMap,e.aoMapIntensity.value=o.aoMapIntensity),o.map)var i=o.map;else o.specularMap?i=o.specularMap:o.displacementMap?i=o.displacementMap:o.normalMap?i=o.normalMap:o.bumpMap?i=o.bumpMap:o.roughnessMap?i=o.roughnessMap:o.metalnessMap?i=o.metalnessMap:o.alphaMap?i=o.alphaMap:o.emissiveMap?i=o.emissiveMap:o.clearcoatMap?i=o.clearcoatMap:o.clearcoatNormalMap?i=o.clearcoatNormalMap:o.clearcoatRoughnessMap&&(i=o.clearcoatRoughnessMap);if(void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix)),o.aoMap)var r=o.aoMap;else o.lightMap&&(r=o.lightMap);void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uv2Transform.value.copy(r.matrix))}function o(e,o){e.roughness.value=o.roughness,e.metalness.value=o.metalness,o.roughnessMap&&(e.roughnessMap.value=o.roughnessMap),o.metalnessMap&&(e.metalnessMap.value=o.metalnessMap),o.emissiveMap&&(e.emissiveMap.value=o.emissiveMap),o.bumpMap&&(e.bumpMap.value=o.bumpMap,e.bumpScale.value=o.bumpScale,1===o.side&&(e.bumpScale.value*=-1)),o.normalMap&&(e.normalMap.value=o.normalMap,e.normalScale.value.copy(o.normalScale),1===o.side&&e.normalScale.value.negate()),o.displacementMap&&(e.displacementMap.value=o.displacementMap,e.displacementScale.value=o.displacementScale,e.displacementBias.value=o.displacementBias),t.get(o).envMap&&(e.envMapIntensity.value=o.envMapIntensity)}return{refreshFogUniforms:function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)},refreshMaterialUniforms:function(t,n,i,r){if(n.isMeshBasicMaterial)e(t,n);else if(n.isMeshLambertMaterial)e(t,n),n.emissiveMap&&(t.emissiveMap.value=n.emissiveMap);else if(n.isMeshToonMaterial)e(t,n),n.gradientMap&&(t.gradientMap.value=n.gradientMap),n.emissiveMap&&(t.emissiveMap.value=n.emissiveMap),n.bumpMap&&(t.bumpMap.value=n.bumpMap,t.bumpScale.value=n.bumpScale,1===n.side&&(t.bumpScale.value*=-1)),n.normalMap&&(t.normalMap.value=n.normalMap,t.normalScale.value.copy(n.normalScale),1===n.side&&t.normalScale.value.negate()),n.displacementMap&&(t.displacementMap.value=n.displacementMap,t.displacementScale.value=n.displacementScale,t.displacementBias.value=n.displacementBias);else if(n.isMeshPhongMaterial)e(t,n),t.specular.value.copy(n.specular),t.shininess.value=Math.max(n.shininess,1e-4),n.emissiveMap&&(t.emissiveMap.value=n.emissiveMap),n.bumpMap&&(t.bumpMap.value=n.bumpMap,t.bumpScale.value=n.bumpScale,1===n.side&&(t.bumpScale.value*=-1)),n.normalMap&&(t.normalMap.value=n.normalMap,t.normalScale.value.copy(n.normalScale),1===n.side&&t.normalScale.value.negate()),n.displacementMap&&(t.displacementMap.value=n.displacementMap,t.displacementScale.value=n.displacementScale,t.displacementBias.value=n.displacementBias);else if(n.isMeshStandardMaterial)e(t,n),n.isMeshPhysicalMaterial?(o(t,n),t.reflectivity.value=n.reflectivity,t.clearcoat.value=n.clearcoat,t.clearcoatRoughness.value=n.clearcoatRoughness,n.sheen&&t.sheen.value.copy(n.sheen),n.clearcoatMap&&(t.clearcoatMap.value=n.clearcoatMap),n.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=n.clearcoatRoughnessMap),n.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(n.clearcoatNormalScale),t.clearcoatNormalMap.value=n.clearcoatNormalMap,1===n.side&&t.clearcoatNormalScale.value.negate()),t.transmission.value=n.transmission,n.transmissionMap&&(t.transmissionMap.value=n.transmissionMap)):o(t,n);else if(n.isMeshMatcapMaterial)e(t,n),n.matcap&&(t.matcap.value=n.matcap),n.bumpMap&&(t.bumpMap.value=n.bumpMap,t.bumpScale.value=n.bumpScale,1===n.side&&(t.bumpScale.value*=-1)),n.normalMap&&(t.normalMap.value=n.normalMap,t.normalScale.value.copy(n.normalScale),1===n.side&&t.normalScale.value.negate()),n.displacementMap&&(t.displacementMap.value=n.displacementMap,t.displacementScale.value=n.displacementScale,t.displacementBias.value=n.displacementBias);else if(n.isMeshDepthMaterial)e(t,n),n.displacementMap&&(t.displacementMap.value=n.displacementMap,t.displacementScale.value=n.displacementScale,t.displacementBias.value=n.displacementBias);else if(n.isMeshDistanceMaterial)e(t,n),n.displacementMap&&(t.displacementMap.value=n.displacementMap,t.displacementScale.value=n.displacementScale,t.displacementBias.value=n.displacementBias),t.referencePosition.value.copy(n.referencePosition),t.nearDistance.value=n.nearDistance,t.farDistance.value=n.farDistance;else if(n.isMeshNormalMaterial)e(t,n),n.bumpMap&&(t.bumpMap.value=n.bumpMap,t.bumpScale.value=n.bumpScale,1===n.side&&(t.bumpScale.value*=-1)),n.normalMap&&(t.normalMap.value=n.normalMap,t.normalScale.value.copy(n.normalScale),1===n.side&&t.normalScale.value.negate()),n.displacementMap&&(t.displacementMap.value=n.displacementMap,t.displacementScale.value=n.displacementScale,t.displacementBias.value=n.displacementBias);else if(n.isLineBasicMaterial)t.diffuse.value.copy(n.color),t.opacity.value=n.opacity,n.isLineDashedMaterial&&(t.dashSize.value=n.dashSize,t.totalSize.value=n.dashSize+n.gapSize,t.scale.value=n.scale);else if(n.isPointsMaterial){if(t.diffuse.value.copy(n.color),t.opacity.value=n.opacity,t.size.value=n.size*i,t.scale.value=.5*r,n.map&&(t.map.value=n.map),n.alphaMap&&(t.alphaMap.value=n.alphaMap),n.map)var s=n.map;else n.alphaMap&&(s=n.alphaMap);void 0!==s&&(!0===s.matrixAutoUpdate&&s.updateMatrix(),t.uvTransform.value.copy(s.matrix))}else if(n.isSpriteMaterial){if(t.diffuse.value.copy(n.color),t.opacity.value=n.opacity,t.rotation.value=n.rotation,n.map&&(t.map.value=n.map),n.alphaMap&&(t.alphaMap.value=n.alphaMap),n.map)var a=n.map;else n.alphaMap&&(a=n.alphaMap);void 0!==a&&(!0===a.matrixAutoUpdate&&a.updateMatrix(),t.uvTransform.value.copy(a.matrix))}else n.isShadowMaterial?(t.color.value.copy(n.color),t.opacity.value=n.opacity):n.isShaderMaterial&&(n.uniformsNeedUpdate=!1)}}}function Le(t){function e(t,e){for(var o=0;o<t.length;o++){var n=p.getContext(t[o],e);if(null!==n)return n}return null}function o(){dt=new Y(pt),ft=new z(pt,dt,t),!1===ft.isWebGL2&&(dt.get("WEBGL_depth_texture"),dt.get("OES_texture_float"),dt.get("OES_texture_half_float"),dt.get("OES_texture_half_float_linear"),dt.get("OES_standard_derivatives"),dt.get("OES_element_index_uint"),dt.get("OES_vertex_array_object"),dt.get("ANGLE_instanced_arrays")),dt.get("OES_texture_float_linear"),Nt=new Ce(pt,dt,ft),mt=new Te(pt,dt,ft),mt.scissor(O.copy(rt).multiplyScalar(Z).floor()),mt.viewport(D.copy(it).multiplyScalar(Z).floor()),yt=new Q(pt),vt=new ue,_t=new we(pt,dt,mt,vt,ft,Nt,yt),bt=new X(w),Et=new F(pt,ft),Rt=new V(pt,dt,Et,ft),xt=new K(pt,Et,yt,Rt),St=new et(pt,xt,Et,yt),Bt=new tt(pt),At=new q(vt),Tt=new ce(w,bt,dt,ft,Rt,At),wt=new Me(vt),Ct=new de(vt),kt=new be,It=new G(w,bt,mt,St,_),Mt=new W(pt,dt,yt,ft),Lt=new $(pt,dt,yt,ft),yt.programs=Tt.programs,w.capabilities=ft,w.extensions=dt,w.properties=vt,w.renderLists=Ct,w.state=mt,w.info=yt}function n(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),C=!0}function i(){console.log("THREE.WebGLRenderer: Context Restored."),C=!1,o()}function r(t){t=t.target,t.removeEventListener("dispose",r),s(t),vt.remove(t)}function s(t){void 0!==(t=vt.get(t).program)&&Tt.releaseProgram(t)}function a(t,e){t.render(function(t){w.renderBufferImmediate(t,e)})}function l(t,e,o,n){if(!1!==t.visible){if(t.layers.test(e.layers))if(t.isGroup)o=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)T.pushLight(t),t.castShadow&&T.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||at.intersectsSprite(t)){n&&ht.setFromMatrixPosition(t.matrixWorld).applyMatrix4(ut);var i=St.update(t),r=t.material;r.visible&&S.push(t,i,r,o,ht.z,null)}}else if(t.isImmediateRenderObject)n&&ht.setFromMatrixPosition(t.matrixWorld).applyMatrix4(ut),S.push(t,null,t.material,o,ht.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==yt.render.frame&&(t.skeleton.update(),t.skeleton.frame=yt.render.frame),!t.frustumCulled||at.intersectsObject(t)))if(n&&ht.setFromMatrixPosition(t.matrixWorld).applyMatrix4(ut),i=St.update(t),r=t.material,Array.isArray(r))for(var s=i.groups,a=0,c=s.length;a<c;a++){var u=s[a],h=r[u.materialIndex];h&&h.visible&&S.push(t,i,h,o,ht.z,u)}else r.visible&&S.push(t,i,r,o,ht.z,null);for(t=t.children,i=0,r=t.length;i<r;i++)l(t[i],e,o,n)}}function c(t,e,o){for(var n=!0===e.isScene?e.overrideMaterial:null,i=0,r=t.length;i<r;i++){var s=t[i],a=s.object,l=s.geometry,c=null===n?s.material:n;if(s=s.group,o.isArrayCamera){R=o;for(var h=o.cameras,g=0,p=h.length;g<p;g++){var d=h[g];a.layers.test(d.layers)&&(mt.viewport(D.copy(d.viewport)),T.setupLights(d),u(a,e,d,l,c,s))}}else R=null,u(a,e,o,l,c,s)}}function u(t,e,o,n,i,r){if(t.onBeforeRender(w,e,o,n,i,r),T=kt.get(e,R||o),t.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){var s=g(o,e,i,t);mt.setMaterial(i),Rt.reset(),a(t,s)}else w.renderBufferDirect(o,e,n,i,t,r);t.onAfterRender(w,e,o,n,i,r),T=kt.get(e,R||o)}function h(t,e,o){!0!==e.isScene&&(e=gt);var n=vt.get(t),i=T.state.lights,a=i.state.version;o=Tt.getParameters(t,i.state,T.state.shadowsArray,e,o);var l=Tt.getProgramCacheKey(o),c=n.program,u=!0;if(void 0===c)t.addEventListener("dispose",r);else if(c.cacheKey!==l)s(t);else{if(n.lightsStateVersion===a&&void 0!==o.shaderID)return e=t.isMeshStandardMaterial?e.environment:null,void(n.envMap=bt.get(t.envMap||e));u=!1}u&&(o.uniforms=Tt.getUniforms(t),t.onBeforeCompile(o,w),c=Tt.acquireProgram(o,l),n.program=c,n.uniforms=o.uniforms,n.outputEncoding=o.outputEncoding),o=n.uniforms,(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(n.numClippingPlanes=At.numPlanes,n.numIntersection=At.numIntersection,o.clippingPlanes=At.uniform),n.environment=t.isMeshStandardMaterial?e.environment:null,n.fog=e.fog,n.envMap=bt.get(t.envMap||n.environment),n.needsLights=t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights,n.lightsStateVersion=a,n.needsLights&&(o.ambientLightColor.value=i.state.ambient,o.lightProbe.value=i.state.probe,o.directionalLights.value=i.state.directional,o.directionalLightShadows.value=i.state.directionalShadow,o.spotLights.value=i.state.spot,o.spotLightShadows.value=i.state.spotShadow,o.rectAreaLights.value=i.state.rectArea,o.ltc_1.value=i.state.rectAreaLTC1,o.ltc_2.value=i.state.rectAreaLTC2,o.pointLights.value=i.state.point,o.pointLightShadows.value=i.state.pointShadow,o.hemisphereLights.value=i.state.hemi,o.directionalShadowMap.value=i.state.directionalShadowMap,o.directionalShadowMatrix.value=i.state.directionalShadowMatrix,o.spotShadowMap.value=i.state.spotShadowMap,o.spotShadowMatrix.value=i.state.spotShadowMatrix,o.pointShadowMap.value=i.state.pointShadowMap,o.pointShadowMatrix.value=i.state.pointShadowMatrix),t=n.program.getUniforms(),t=Vt.seqWithValue(t.seq,o),n.uniformsList=t}function g(t,e,o,n){!0!==e.isScene&&(e=gt),_t.resetTextureUnits();var i=e.fog,r=o.isMeshStandardMaterial?e.environment:null,s=null===B?w.outputEncoding:B.texture.encoding,a=bt.get(o.envMap||r),l=vt.get(o),c=T.state.lights;!0!==lt||!0!==ct&&t===N||At.setState(o,t,t===N&&o.id===L),o.version===l.__version?o.fog&&l.fog!==i?h(o,e,n):l.environment!==r?h(o,e,n):l.needsLights&&l.lightsStateVersion!==c.state.version?h(o,e,n):void 0===l.numClippingPlanes||l.numClippingPlanes===At.numPlanes&&l.numIntersection===At.numIntersection?l.outputEncoding!==s?h(o,e,n):l.envMap!==a&&h(o,e,n):h(o,e,n):(h(o,e,n),l.__version=o.version);var u=!1;if(c=a=!1,e=l.program,r=e.getUniforms(),s=l.uniforms,mt.useProgram(e.program)&&(c=a=u=!0),o.id!==L&&(L=o.id,a=!0),(u||N!==t)&&(r.setValue(pt,"projectionMatrix",t.projectionMatrix),ft.logarithmicDepthBuffer&&r.setValue(pt,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),N!==t&&(N=t,c=a=!0),(o.isShaderMaterial||o.isMeshPhongMaterial||o.isMeshToonMaterial||o.isMeshStandardMaterial||o.envMap)&&void 0!==(u=r.map.cameraPosition)&&u.setValue(pt,ht.setFromMatrixPosition(t.matrixWorld)),(o.isMeshPhongMaterial||o.isMeshToonMaterial||o.isMeshLambertMaterial||o.isMeshBasicMaterial||o.isMeshStandardMaterial||o.isShaderMaterial)&&r.setValue(pt,"isOrthographic",!0===t.isOrthographicCamera),(o.isMeshPhongMaterial||o.isMeshToonMaterial||o.isMeshLambertMaterial||o.isMeshBasicMaterial||o.isMeshStandardMaterial||o.isShaderMaterial||o.isShadowMaterial||o.skinning)&&r.setValue(pt,"viewMatrix",t.matrixWorldInverse)),o.skinning&&(r.setOptional(pt,n,"bindMatrix"),r.setOptional(pt,n,"bindMatrixInverse"),t=n.skeleton))if(u=t.bones,ft.floatVertexTextures){if(void 0===t.boneTexture){u=Math.sqrt(4*u.length),u=br.ceilPowerOfTwo(u),u=Math.max(u,4);var g=new Float32Array(u*u*4);g.set(t.boneMatrices);var p=new P(g,u,u,1023,1015);t.boneMatrices=g,t.boneTexture=p,t.boneTextureSize=u}r.setValue(pt,"boneTexture",t.boneTexture,_t),r.setValue(pt,"boneTextureSize",t.boneTextureSize)}else r.setOptional(pt,t,"boneMatrices");return(a||l.receiveShadow!==n.receiveShadow)&&(l.receiveShadow=n.receiveShadow,r.setValue(pt,"receiveShadow",n.receiveShadow)),a&&(r.setValue(pt,"toneMappingExposure",w.toneMappingExposure),l.needsLights&&(t=c,s.ambientLightColor.needsUpdate=t,s.lightProbe.needsUpdate=t,s.directionalLights.needsUpdate=t,s.directionalLightShadows.needsUpdate=t,s.pointLights.needsUpdate=t,s.pointLightShadows.needsUpdate=t,s.spotLights.needsUpdate=t,s.spotLightShadows.needsUpdate=t,s.rectAreaLights.needsUpdate=t,s.hemisphereLights.needsUpdate=t),i&&o.fog&&wt.refreshFogUniforms(s,i),wt.refreshMaterialUniforms(s,o,Z,J),Vt.upload(pt,l.uniformsList,s,_t)),o.isShaderMaterial&&!0===o.uniformsNeedUpdate&&(Vt.upload(pt,l.uniformsList,s,_t),o.uniformsNeedUpdate=!1),o.isSpriteMaterial&&r.setValue(pt,"center",n.center),r.setValue(pt,"modelViewMatrix",n.modelViewMatrix),r.setValue(pt,"normalMatrix",n.normalMatrix),r.setValue(pt,"modelMatrix",n.matrixWorld),e}t=t||{};var p=void 0!==t.canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),d=void 0!==t.context?t.context:null,f=void 0!==t.alpha&&t.alpha,m=void 0===t.depth||t.depth,y=void 0===t.stencil||t.stencil,v=void 0!==t.antialias&&t.antialias,_=void 0===t.premultipliedAlpha||t.premultipliedAlpha,b=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,E=void 0!==t.powerPreference?t.powerPreference:"default",x=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat,S=null,T=null;this.domElement=p,this.debug={checkShaderErrors:!0},this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var w=this,C=!1,k=null,A=0,I=0,B=null,M=null,L=-1,N=null,R=null,D=new kr,O=new kr,H=null,U=p.width,J=p.height,Z=1,ot=null,nt=null,it=new kr(0,0,U,J),rt=new kr(0,0,U,J),st=!1,at=new Ma,lt=!1,ct=!1,ut=new is,ht=new Mr,gt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0},pt=d;try{if(d={alpha:f,depth:m,stencil:y,antialias:v,premultipliedAlpha:_,preserveDrawingBuffer:b,powerPreference:E,failIfMajorPerformanceCaveat:x},p.addEventListener("webglcontextlost",n,!1),p.addEventListener("webglcontextrestored",i,!1),null===pt&&(f=["webgl2","webgl","experimental-webgl"],!0===w.isWebGL1Renderer&&f.shift(),null===(pt=e(f,d)))){if(e(f))throw Error("Error creating WebGL context with your selected attributes.");throw Error("Error creating WebGL context.")}void 0===pt.getShaderPrecisionFormat&&(pt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}var dt,ft,mt,yt,vt,_t,bt,Et,xt,St,Tt,wt,Ct,kt,At,It,Bt,Mt,Lt,Nt,Rt;o();var Dt=new Be(w,pt);this.xr=Dt;var Ot=new Se(w,St,ft.maxTextureSize);this.shadowMap=Ot,this.getContext=function(){return pt},this.getContextAttributes=function(){return pt.getContextAttributes()},this.forceContextLoss=function(){var t=dt.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=dt.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return Z},this.setPixelRatio=function(t){void 0!==t&&(Z=t,this.setSize(U,J,!1))},this.getSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),t=new Er),t.set(U,J)},this.setSize=function(t,e,o){Dt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(U=t,J=e,p.width=Math.floor(t*Z),p.height=Math.floor(e*Z),!1!==o&&(p.style.width=t+"px",p.style.height=e+"px"),this.setViewport(0,0,t,e))},this.getDrawingBufferSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),t=new Er),t.set(U*Z,J*Z).floor()},this.setDrawingBufferSize=function(t,e,o){U=t,J=e,Z=o,p.width=Math.floor(t*o),p.height=Math.floor(e*o),this.setViewport(0,0,t,e)},this.getCurrentViewport=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),t=new kr),t.copy(D)},this.getViewport=function(t){return t.copy(it)},this.setViewport=function(t,e,o,n){t.isVector4?it.set(t.x,t.y,t.z,t.w):it.set(t,e,o,n),mt.viewport(D.copy(it).multiplyScalar(Z).floor())},this.getScissor=function(t){return t.copy(rt)},this.setScissor=function(t,e,o,n){t.isVector4?rt.set(t.x,t.y,t.z,t.w):rt.set(t,e,o,n),mt.scissor(O.copy(rt).multiplyScalar(Z).floor())},this.getScissorTest=function(){return st},this.setScissorTest=function(t){mt.setScissorTest(st=t)},this.setOpaqueSort=function(t){ot=t},this.setTransparentSort=function(t){nt=t},this.getClearColor=function(){return It.getClearColor()},this.setClearColor=function(){It.setClearColor.apply(It,arguments)},this.getClearAlpha=function(){return It.getClearAlpha()},this.setClearAlpha=function(){It.setClearAlpha.apply(It,arguments)},this.clear=function(t,e,o){var n=0;(void 0===t||t)&&(n|=16384),(void 0===e||e)&&(n|=256),(void 0===o||o)&&(n|=1024),pt.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){p.removeEventListener("webglcontextlost",n,!1),p.removeEventListener("webglcontextrestored",i,!1),Ct.dispose(),kt.dispose(),vt.dispose(),bt.dispose(),St.dispose(),Rt.dispose(),Dt.dispose(),jt.stop()},this.renderBufferImmediate=function(t,e){Rt.initAttributes();var o=vt.get(t);t.hasPositions&&!o.position&&(o.position=pt.createBuffer()),t.hasNormals&&!o.normal&&(o.normal=pt.createBuffer()),t.hasUvs&&!o.uv&&(o.uv=pt.createBuffer()),t.hasColors&&!o.color&&(o.color=pt.createBuffer()),e=e.getAttributes(),t.hasPositions&&(pt.bindBuffer(34962,o.position),pt.bufferData(34962,t.positionArray,35048),Rt.enableAttribute(e.position),pt.vertexAttribPointer(e.position,3,5126,!1,0,0)),t.hasNormals&&(pt.bindBuffer(34962,o.normal),pt.bufferData(34962,t.normalArray,35048),Rt.enableAttribute(e.normal),pt.vertexAttribPointer(e.normal,3,5126,!1,0,0)),t.hasUvs&&(pt.bindBuffer(34962,o.uv),pt.bufferData(34962,t.uvArray,35048),Rt.enableAttribute(e.uv),pt.vertexAttribPointer(e.uv,2,5126,!1,0,0)),t.hasColors&&(pt.bindBuffer(34962,o.color),pt.bufferData(34962,t.colorArray,35048),Rt.enableAttribute(e.color),pt.vertexAttribPointer(e.color,3,5126,!1,0,0)),Rt.disableUnusedAttributes(),pt.drawArrays(4,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,o,n,i,r){null===e&&(e=gt);var s=i.isMesh&&0>i.matrixWorld.determinant();if(t=g(t,e,n,i),mt.setMaterial(n,s),s=o.index,e=o.attributes.position,null===s){if(void 0===e||0===e.count)return}else if(0===s.count)return;var a=1;if(!0===n.wireframe&&(s=xt.getWireframeAttribute(o),a=2),(n.morphTargets||n.morphNormals)&&Bt.update(i,o,n,t),Rt.setup(i,n,t,o,s),t=Mt,null!==s){var l=Et.get(s);t=Lt,t.setIndex(l)}var c=o.drawRange.start*a,u=null!==r?r.start*a:0;l=Math.max(c,u),0!==(r=Math.max(0,Math.min(null!==s?s.count:e.count,c+o.drawRange.count*a,u+(null!==r?r.count*a:1/0))-1-l+1))&&(i.isMesh?!0===n.wireframe?(mt.setLineWidth(n.wireframeLinewidth*(null===B?Z:1)),t.setMode(1)):t.setMode(4):i.isLine?(n=n.linewidth,void 0===n&&(n=1),mt.setLineWidth(n*(null===B?Z:1)),i.isLineSegments?t.setMode(1):i.isLineLoop?t.setMode(2):t.setMode(3)):i.isPoints?t.setMode(0):i.isSprite&&t.setMode(4),i.isInstancedMesh?t.renderInstances(l,r,i.count):o.isInstancedBufferGeometry?t.renderInstances(l,r,Math.min(o.instanceCount,o._maxInstanceCount)):t.render(l,r))},this.compile=function(t,e){T=kt.get(t,e),T.init(),t.traverse(function(t){t.isLight&&(T.pushLight(t),t.castShadow&&T.pushShadow(t))}),T.setupLights(e);var o=new WeakMap;t.traverse(function(e){var n=e.material;if(n)if(Array.isArray(n))for(var i=0;i<n.length;i++){var r=n[i];!1===o.has(r)&&(h(r,t,e),o.set(r))}else!1===o.has(n)&&(h(n,t,e),o.set(n))})};var Pt=null,jt=new j;jt.setAnimationLoop(function(t){Dt.isPresenting||Pt&&Pt(t)}),"undefined"!=typeof window&&jt.setContext(window),this.setAnimationLoop=function(t){Pt=t,Dt.setAnimationLoop(t),null===t?jt.stop():jt.start()},this.render=function(t,e,o,n){if(void 0!==o){console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead.");var i=o}if(void 0!==n){console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead.");var r=n}void 0!==e&&!0!==e.isCamera?console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera."):!0!==C&&(Rt.resetDefaultState(),L=-1,N=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),!0===Dt.enabled&&!0===Dt.isPresenting&&(e=Dt.getCamera(e)),!0===t.isScene&&t.onBeforeRender(w,t,e,i||B),T=kt.get(t,e),T.init(),ut.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),at.setFromProjectionMatrix(ut),ct=this.localClippingEnabled,lt=At.init(this.clippingPlanes,ct,e),S=Ct.get(t,e),S.init(),l(t,e,0,w.sortObjects),S.finish(),!0===w.sortObjects&&S.sort(ot,nt),!0===lt&&At.beginShadows(),Ot.render(T.state.shadowsArray,t,e),T.setupLights(e),!0===lt&&At.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==i&&this.setRenderTarget(i),It.render(S,t,e,r),o=S.opaque,n=S.transparent,0<o.length&&c(o,t,e),0<n.length&&c(n,t,e),!0===t.isScene&&t.onAfterRender(w,t,e),null!==B&&(_t.updateRenderTargetMipmap(B),_t.updateMultisampleRenderTarget(B)),mt.buffers.depth.setTest(!0),mt.buffers.depth.setMask(!0),mt.buffers.color.setMask(!0),mt.setPolygonOffset(!1),T=S=null)},this.setFramebuffer=function(t){k!==t&&null===B&&pt.bindFramebuffer(36160,t),k=t},this.getActiveCubeFace=function(){return A},this.getActiveMipmapLevel=function(){return I},this.getRenderList=function(){return S},this.setRenderList=function(t){S=t},this.getRenderState=function(){return T},this.setRenderState=function(t){T=t},this.getRenderTarget=function(){return B},this.setRenderTarget=function(t,e,o){void 0===e&&(e=0),void 0===o&&(o=0),B=t,A=e,I=o,t&&void 0===vt.get(t).__webglFramebuffer&&_t.setupRenderTarget(t);var n=k,i=!1;t?(n=vt.get(t).__webglFramebuffer,t.isWebGLCubeRenderTarget?(n=n[e],i=!0):n=t.isWebGLMultisampleRenderTarget?vt.get(t).__webglMultisampledFramebuffer:n,D.copy(t.viewport),O.copy(t.scissor),H=t.scissorTest):(D.copy(it).multiplyScalar(Z).floor(),O.copy(rt).multiplyScalar(Z).floor(),H=st),M!==n&&(pt.bindFramebuffer(36160,n),M=n),mt.viewport(D),mt.scissor(O),mt.setScissorTest(H),i&&(t=vt.get(t.texture),pt.framebufferTexture2D(36160,36064,34069+e,t.__webglTexture,o))},this.readRenderTargetPixels=function(t,e,o,n,i,r,s){if(t&&t.isWebGLRenderTarget){var a=vt.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==s&&(a=a[s]),a){s=!1,a!==M&&(pt.bindFramebuffer(36160,a),s=!0);try{var l=t.texture,c=l.format,u=l.type;1023!==c&&Nt.convert(c)!==pt.getParameter(35739)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):1009===u||Nt.convert(u)===pt.getParameter(35738)||1015===u&&(ft.isWebGL2||dt.get("OES_texture_float")||dt.get("WEBGL_color_buffer_float"))||1016===u&&(ft.isWebGL2?dt.get("EXT_color_buffer_float"):dt.get("EXT_color_buffer_half_float"))?36053===pt.checkFramebufferStatus(36160)?0<=e&&e<=t.width-n&&0<=o&&o<=t.height-i&&pt.readPixels(e,o,n,i,Nt.convert(c),Nt.convert(u),r):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{s&&pt.bindFramebuffer(36160,M)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e,o){void 0===o&&(o=0);var n=Math.pow(2,-o),i=Math.floor(e.image.width*n);n=Math.floor(e.image.height*n);var r=Nt.convert(e.format);_t.setTexture2D(e,0),pt.copyTexImage2D(3553,o,r,t.x,t.y,i,n,0),mt.unbindTexture()},this.copyTextureToTexture=function(t,e,o,n){void 0===n&&(n=0);var i=e.image.width,r=e.image.height,s=Nt.convert(o.format),a=Nt.convert(o.type);_t.setTexture2D(o,0),pt.pixelStorei(37440,o.flipY),pt.pixelStorei(37441,o.premultiplyAlpha),pt.pixelStorei(3317,o.unpackAlignment),e.isDataTexture?pt.texSubImage2D(3553,n,t.x,t.y,i,r,s,a,e.image.data):e.isCompressedTexture?pt.compressedTexSubImage2D(3553,n,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,s,e.mipmaps[0].data):pt.texSubImage2D(3553,n,t.x,t.y,s,a,e.image),0===n&&o.generateMipmaps&&pt.generateMipmap(3553),mt.unbindTexture()},this.initTexture=function(t){_t.setTexture2D(t,0),mt.unbindTexture()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Ne(t){Le.call(this,t)}function Re(){s.call(this),Object.defineProperty(this,"isScene",{value:!0}),this.type="Scene",this.overrideMaterial=this.fog=this.environment=this.background=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function De(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=br.generateUUID()}function Oe(t,e,o,n){this.name="",this.data=t,this.itemSize=e,this.offset=o,this.normalized=!0===n}function Pe(t){u.call(this),this.type="SpriteMaterial",this.color=new Ys(16777215),this.alphaMap=this.map=null,this.rotation=0,this.transparent=this.sizeAttenuation=!0,this.setValues(t)}function je(t){if(s.call(this),this.type="Sprite",void 0===Za){Za=new S;var e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]);e=new De(e,5),Za.setIndex([0,1,2,0,2,3]),Za.setAttribute("position",new Oe(e,3,0,!1)),Za.setAttribute("uv",new Oe(e,2,3,!1))}this.geometry=Za,this.material=void 0!==t?t:new Pe,this.center=new Er(.5,.5)}function Fe(t,e,o,n,i,r){nl.subVectors(t,o).addScalar(.5).multiply(n),void 0!==i?(il.x=r*nl.x-i*nl.y,il.y=i*nl.x+r*nl.y):il.copy(nl),t.copy(e),t.x+=il.x,t.y+=il.y,t.applyMatrix4(rl)}function He(){s.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function Ue(t,e){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),T.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new is,this.bindMatrixInverse=new is}function Ge(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else for(console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[],t=0,e=this.bones.length;t<e;t++)this.boneInverses.push(new is)}function Ve(){s.call(this),this.type="Bone"}function We(t,e,o){T.call(this,t,e),this.instanceMatrix=new g(new Float32Array(16*o),16),this.instanceColor=null,this.count=o,this.frustumCulled=!1}function ze(t){u.call(this),this.type="LineBasicMaterial",this.color=new Ys(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.morphTargets=!1,this.setValues(t)}function qe(t,e,o){1===o&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),s.call(this),this.type="Line",this.geometry=void 0!==t?t:new S,this.material=void 0!==e?e:new ze,this.updateMorphTargets()}function Xe(t,e){qe.call(this,t,e),this.type="LineSegments"}function Ye(t,e){qe.call(this,t,e),this.type="LineLoop"}function Ke(t){u.call(this),this.type="PointsMaterial",this.color=new Ys(16777215),this.alphaMap=this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}function $e(t,e){s.call(this),this.type="Points",this.geometry=void 0!==t?t:new S,this.material=void 0!==e?e:new Ke,this.updateMorphTargets()}function Qe(t,e,o,n,i,r,s){var a=Al.distanceSqToPoint(t);a<o&&(o=new Mr,Al.closestPointToPoint(t,o),o.applyMatrix4(n),(t=i.ray.origin.distanceTo(o))<i.near||t>i.far||r.push({distance:t,distanceToRay:Math.sqrt(a),point:o,index:e,face:null,object:s}))}function Je(t,e,n,i,r,s,a,l,c){function u(){h.needsUpdate=!0,t.requestVideoFrameCallback(u)}o.call(this,t,e,n,i,r,s,a,l,c),this.format=void 0!==a?a:1022,this.minFilter=void 0!==s?s:1006,this.magFilter=void 0!==r?r:1006,this.generateMipmaps=!1;var h=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(u)}function Ze(t,e,n,i,r,s,a,l,c,u,h,g){o.call(this,null,s,a,l,c,u,i,r,h,g),this.image={width:e,height:n},this.mipmaps=t,this.generateMipmaps=this.flipY=!1}function to(t,e,n,i,r,s,a,l,c){o.call(this,t,e,n,i,r,s,a,l,c),this.needsUpdate=!0}function eo(t,e,n,i,r,s,a,l,c,u){if(1026!==(u=void 0!==u?u:1026)&&1027!==u)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&1026===u&&(n=1012),void 0===n&&1027===u&&(n=1020),o.call(this,null,i,r,s,a,l,u,n,c),this.image={width:t,height:e},this.magFilter=void 0!==a?a:1003,this.minFilter=void 0!==l?l:1003,this.generateMipmaps=this.flipY=!1}function oo(t){S.call(this),this.type="WireframeGeometry";var e=[],o=[0,0],n={},i=["a","b","c"];if(t&&t.isGeometry){for(var r=t.faces,s=0,a=r.length;s<a;s++)for(var l=r[s],c=0;3>c;c++){var u=l[i[c]],h=l[i[(c+1)%3]];o[0]=Math.min(u,h),o[1]=Math.max(u,h),u=o[0]+","+o[1],void 0===n[u]&&(n[u]={index1:o[0],index2:o[1]})}for(var g in n)o=n[g],r=t.vertices[o.index1],e.push(r.x,r.y,r.z),r=t.vertices[o.index2],e.push(r.x,r.y,r.z)}else if(t&&t.isBufferGeometry)if(g=new Mr,null!==t.index){for(i=t.attributes.position,s=t.index,t=t.groups,0===t.length&&(t=[{start:0,count:s.count,materialIndex:0}]),a=0,l=t.length;a<l;++a)for(u=t[a],c=h=u.start,u=h+u.count;c<u;c+=3)for(h=0;3>h;h++){var p=s.getX(c+h),d=s.getX(c+(h+1)%3);o[0]=Math.min(p,d),o[1]=Math.max(p,d),p=o[0]+","+o[1],void 0===n[p]&&(n[p]={index1:o[0],index2:o[1]})}for(r in n)o=n[r],g.fromBufferAttribute(i,o.index1),e.push(g.x,g.y,g.z),g.fromBufferAttribute(i,o.index2),e.push(g.x,g.y,g.z)}else for(n=t.attributes.position,o=0,r=n.count/3;o<r;o++)for(t=0;3>t;t++)g.fromBufferAttribute(n,3*o+t),e.push(g.x,g.y,g.z),g.fromBufferAttribute(n,3*o+(t+1)%3),e.push(g.x,g.y,g.z);this.setAttribute("position",new b(e,3))}function no(t,e,o){k.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:o},this.fromBufferGeometry(new io(t,e,o)),this.mergeVertices()}function io(t,e,o){S.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:o};var n=[],i=[],r=[],s=[],a=new Mr,l=new Mr,c=new Mr,u=new Mr,h=new Mr;3>t.length&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var g=e+1,p=0;p<=o;p++)for(var d=p/o,f=0;f<=e;f++){var m=f/e;t(m,d,l),i.push(l.x,l.y,l.z),0<=m-1e-5?(t(m-1e-5,d,c),u.subVectors(l,c)):(t(m+1e-5,d,c),u.subVectors(c,l)),0<=d-1e-5?(t(m,d-1e-5,c),h.subVectors(l,c)):(t(m,d+1e-5,c),h.subVectors(c,l)),a.crossVectors(u,h).normalize(),r.push(a.x,a.y,a.z),s.push(m,d)}for(t=0;t<o;t++)for(a=0;a<e;a++)l=t*g+a+1,c=(t+1)*g+a+1,u=(t+1)*g+a,n.push(t*g+a,l,u),n.push(l,c,u);this.setIndex(n),this.setAttribute("position",new b(i,3)),this.setAttribute("normal",new b(r,3)),this.setAttribute("uv",new b(s,2))}function ro(t,e,o,n){k.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:o,detail:n},this.fromBufferGeometry(new so(t,e,o,n)),this.mergeVertices()}function so(t,e,o,n){function i(t){a.push(t.x,t.y,t.z)}function r(e,o){e*=3,o.x=t[e+0],o.y=t[e+1],o.z=t[e+2]}function s(t,e,o,n){0>n&&1===t.x&&(l[e]=t.x-1),0===o.x&&0===o.z&&(l[e]=n/2/Math.PI+.5)}S.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:o,detail:n},o=o||1,n=n||0;var a=[],l=[];!function(t){for(var o=new Mr,n=new Mr,s=new Mr,a=0;a<e.length;a+=3){r(e[a+0],o),r(e[a+1],n),r(e[a+2],s);for(var l=o,c=n,u=s,h=Math.pow(2,t),g=[],p=0;p<=h;p++){g[p]=[];for(var d=l.clone().lerp(u,p/h),f=c.clone().lerp(u,p/h),m=h-p,y=0;y<=m;y++)g[p][y]=0===y&&p===h?d:d.clone().lerp(f,y/m)}for(l=0;l<h;l++)for(c=0;c<2*(h-l)-1;c++)u=Math.floor(c/2),0==c%2?(i(g[l][u+1]),i(g[l+1][u]),i(g[l][u])):(i(g[l][u+1]),i(g[l+1][u+1]),i(g[l+1][u]))}}(n),function(t){for(var e=new Mr,o=0;o<a.length;o+=3)e.x=a[o+0],e.y=a[o+1],e.z=a[o+2],e.normalize().multiplyScalar(t),a[o+0]=e.x,a[o+1]=e.y,a[o+2]=e.z}(o),function(){for(var t=new Mr,e=0;e<a.length;e+=3)t.x=a[e+0],t.y=a[e+1],t.z=a[e+2],l.push(Math.atan2(t.z,-t.x)/2/Math.PI+.5,1-(Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5));t=new Mr,e=new Mr;for(var o=new Mr,n=new Mr,i=new Er,r=new Er,c=new Er,u=0,h=0;u<a.length;u+=9,h+=6){t.set(a[u+0],a[u+1],a[u+2]),e.set(a[u+3],a[u+4],a[u+5]),o.set(a[u+6],a[u+7],a[u+8]),i.set(l[h+0],l[h+1]),r.set(l[h+2],l[h+3]),c.set(l[h+4],l[h+5]),n.copy(t).add(e).add(o).divideScalar(3);var g=Math.atan2(n.z,-n.x);s(i,h+0,t,g),s(r,h+2,e,g),s(c,h+4,o,g)}for(t=0;t<l.length;t+=6)e=l[t+0],o=l[t+2],n=l[t+4],i=Math.min(e,o,n),.9<Math.max(e,o,n)&&.1>i&&(.2>e&&(l[t+0]+=1),.2>o&&(l[t+2]+=1),.2>n&&(l[t+4]+=1))}(),this.setAttribute("position",new b(a,3)),this.setAttribute("normal",new b(a.slice(),3)),this.setAttribute("uv",new b(l,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}function ao(t,e){k.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new lo(t,e)),this.mergeVertices()}function lo(t,e){so.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function co(t,e){k.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new uo(t,e)),this.mergeVertices()}function uo(t,e){so.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function ho(t,e){k.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new go(t,e)),this.mergeVertices()}function go(t,e){var o=(1+Math.sqrt(5))/2;so.call(this,[-1,o,0,1,o,0,-1,-o,0,1,-o,0,0,-1,o,0,1,o,0,-1,-o,0,1,-o,o,0,-1,o,0,1,-o,0,-1,-o,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function po(t,e){k.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new fo(t,e)),this.mergeVertices()}function fo(t,e){var o=(1+Math.sqrt(5))/2,n=1/o;so.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-o,0,-n,o,0,n,-o,0,n,o,-n,-o,0,-n,o,0,n,-o,0,n,o,0,-o,0,-n,o,0,-n,-o,0,n,o,0,n],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function mo(t,e,o,n,i,r){k.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:o,radialSegments:n,closed:i},void 0!==r&&console.warn("THREE.TubeGeometry: taper has been removed."),t=new yo(t,e,o,n,i),this.tangents=t.tangents,this.normals=t.normals,this.binormals=t.binormals,this.fromBufferGeometry(t),this.mergeVertices()}function yo(t,e,o,n,i){function r(i){u=t.getPointAt(i/e,u);var r=s.normals[i];i=s.binormals[i];for(var c=0;c<=n;c++){var p=c/n*Math.PI*2,d=Math.sin(p);p=-Math.cos(p),l.x=p*r.x+d*i.x,l.y=p*r.y+d*i.y,l.z=p*r.z+d*i.z,l.normalize(),g.push(l.x,l.y,l.z),a.x=u.x+o*l.x,a.y=u.y+o*l.y,a.z=u.z+o*l.z,h.push(a.x,a.y,a.z)}}S.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:o,radialSegments:n,closed:i},e=e||64,o=o||1,n=n||8,i=i||!1;var s=t.computeFrenetFrames(e,i);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;var a=new Mr,l=new Mr,c=new Er,u=new Mr,h=[],g=[],p=[],d=[];!function(){for(var t=0;t<e;t++)r(t);for(r(!1===i?e:0),t=0;t<=e;t++)for(var o=0;o<=n;o++)c.x=t/e,c.y=o/n,p.push(c.x,c.y);for(t=1;t<=e;t++)for(o=1;o<=n;o++){var s=(n+1)*t+(o-1),a=(n+1)*t+o,l=(n+1)*(t-1)+o;d.push((n+1)*(t-1)+(o-1),s,l),d.push(s,a,l)}}(),this.setIndex(d),this.setAttribute("position",new b(h,3)),this.setAttribute("normal",new b(g,3)),this.setAttribute("uv",new b(p,2))}function vo(t,e,o,n,i,r,s){k.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:o,radialSegments:n,p:i,q:r},void 0!==s&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new _o(t,e,o,n,i,r)),this.mergeVertices()}function _o(t,e,o,n,i,r){function s(t,e,o,n,i){var r=Math.sin(t);e=o/e*t,o=Math.cos(e),i.x=n*(2+o)*.5*Math.cos(t),i.y=n*(2+o)*r*.5,i.z=n*Math.sin(e)*.5}S.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:o,radialSegments:n,p:i,q:r},t=t||1,e=e||.4,o=Math.floor(o)||64,n=Math.floor(n)||8,i=i||2,r=r||3;for(var a=[],l=[],c=[],u=[],h=new Mr,g=new Mr,p=new Mr,d=new Mr,f=new Mr,m=new Mr,y=new Mr,v=0;v<=o;++v){var _=v/o*i*Math.PI*2;for(s(_,i,r,t,p),s(_+.01,i,r,t,d),m.subVectors(d,p),y.addVectors(d,p),f.crossVectors(m,y),y.crossVectors(f,m),f.normalize(),y.normalize(),_=0;_<=n;++_){var E=_/n*Math.PI*2,x=-e*Math.cos(E);E=e*Math.sin(E),h.x=p.x+(x*y.x+E*f.x),h.y=p.y+(x*y.y+E*f.y),h.z=p.z+(x*y.z+E*f.z),l.push(h.x,h.y,h.z),g.subVectors(h,p).normalize(),c.push(g.x,g.y,g.z),u.push(v/o),u.push(_/n)}}for(t=1;t<=o;t++)for(e=1;e<=n;e++)i=(n+1)*t+(e-1),r=(n+1)*t+e,h=(n+1)*(t-1)+e,a.push((n+1)*(t-1)+(e-1),i,h),a.push(i,r,h);this.setIndex(a),this.setAttribute("position",new b(l,3)),this.setAttribute("normal",new b(c,3)),this.setAttribute("uv",new b(u,2))}function bo(t,e,o,n,i){k.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:o,tubularSegments:n,arc:i},this.fromBufferGeometry(new Eo(t,e,o,n,i)),this.mergeVertices()}function Eo(t,e,o,n,i){S.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:o,tubularSegments:n,arc:i},t=t||1,e=e||.4,o=Math.floor(o)||8,n=Math.floor(n)||6,i=i||2*Math.PI;for(var r=[],s=[],a=[],l=[],c=new Mr,u=new Mr,h=new Mr,g=0;g<=o;g++)for(var p=0;p<=n;p++){var d=p/n*i,f=g/o*Math.PI*2;u.x=(t+e*Math.cos(f))*Math.cos(d),u.y=(t+e*Math.cos(f))*Math.sin(d),u.z=e*Math.sin(f),s.push(u.x,u.y,u.z),c.x=t*Math.cos(d),c.y=t*Math.sin(d),h.subVectors(u,c).normalize(),a.push(h.x,h.y,h.z),l.push(p/n),l.push(g/o)}for(t=1;t<=o;t++)for(e=1;e<=n;e++)i=(n+1)*(t-1)+e-1,c=(n+1)*(t-1)+e,u=(n+1)*t+e,r.push((n+1)*t+e-1,i,u),r.push(i,c,u);this.setIndex(r),this.setAttribute("position",new b(s,3)),this.setAttribute("normal",new b(a,3)),this.setAttribute("uv",new b(l,2))}function xo(t,e,o,n,i){for(var r,s=0,a=e,l=o-n;a<o;a+=n)s+=(t[l]-t[a])*(t[a+1]+t[l+1]),l=a;if(i===0<s)for(i=e;i<o;i+=n)r=jo(i,t[i],t[i+1],r);else for(i=o-n;i>=e;i-=n)r=jo(i,t[i],t[i+1],r);return r&&Lo(r,r.next)&&(Fo(r),r=r.next),r}function So(t,e){if(!t)return t;e||(e=t);do{var o=!1;if(t.steiner||!Lo(t,t.next)&&0!==Mo(t.prev,t,t.next))t=t.next;else{if(Fo(t),(t=e=t.prev)===t.next)break;o=!0}}while(o||t!==e);return e}function To(t,e,o,n,i,r,s){if(t){if(!s&&r){var a=t,l=a;do{null===l.z&&(l.z=Ao(l.x,l.y,n,i,r)),l.prevZ=l.prev,l=l.nextZ=l.next}while(l!==a);l.prevZ.nextZ=null,l.prevZ=null,a=l;var c,u,h,g,p=1;do{l=a;var d=a=null;for(u=0;l;){u++;var f=l;for(c=h=0;c<p&&(h++,f=f.nextZ);c++);for(g=p;0<h||0<g&&f;)0!==h&&(0===g||!f||l.z<=f.z)?(c=l,l=l.nextZ,h--):(c=f,f=f.nextZ,g--),d?d.nextZ=c:a=c,c.prevZ=d,d=c;l=f}d.nextZ=null,p*=2}while(1<u)}for(a=t;t.prev!==t.next;){if(l=t.prev,f=t.next,r)d=wo(t,n,i,r);else t:if(d=t,u=d.prev,h=d,p=d.next,0<=Mo(u,h,p))d=!1;else{for(c=d.next.next;c!==d.prev;){if(Bo(u.x,u.y,h.x,h.y,p.x,p.y,c.x,c.y)&&0<=Mo(c.prev,c,c.next)){d=!1;break t}c=c.next}d=!0}if(d)e.push(l.i/o),e.push(t.i/o),e.push(f.i/o),Fo(t),a=t=f.next;else if((t=f)===a){if(s){if(1===s){t=So(t),s=e,a=o,l=t;do{f=l.prev,d=l.next.next,!Lo(f,d)&&No(f,l,l.next,d)&&Oo(f,d)&&Oo(d,f)&&(s.push(f.i/a),s.push(l.i/a),s.push(d.i/a),Fo(l),Fo(l.next),l=t=d),l=l.next}while(l!==t);t=So(l),To(t,e,o,n,i,r,2)}else if(2===s)t:{s=t;do{for(a=s.next.next;a!==s.prev;){if(l=s.i!==a.i){if(l=s,f=a,d=l.next.i!==f.i&&l.prev.i!==f.i){e:{d=l;do{if(d.i!==l.i&&d.next.i!==l.i&&d.i!==f.i&&d.next.i!==f.i&&No(d,d.next,l,f)){d=!0;break e}d=d.next}while(d!==l);d=!1}d=!d}if(d){if(d=Oo(l,f)&&Oo(f,l)){d=l,u=!1,h=(l.x+f.x)/2,p=(l.y+f.y)/2;do{d.y>p!=d.next.y>p&&d.next.y!==d.y&&h<(d.next.x-d.x)*(p-d.y)/(d.next.y-d.y)+d.x&&(u=!u),d=d.next}while(d!==l);d=u}d=d&&(Mo(l.prev,l,f.prev)||Mo(l,f.prev,f))||Lo(l,f)&&0<Mo(l.prev,l,l.next)&&0<Mo(f.prev,f,f.next)}l=d}if(l){t=Po(s,a),s=So(s,s.next),t=So(t,t.next),To(s,e,o,n,i,r),To(t,e,o,n,i,r);break t}a=a.next}s=s.next}while(s!==t)}}else To(So(t),e,o,n,i,r,1);break}}}}function wo(t,e,o,n){var i=t.prev,r=t.next;if(0<=Mo(i,t,r))return!1;var s=i.x>t.x?i.x>r.x?i.x:r.x:t.x>r.x?t.x:r.x,a=i.y>t.y?i.y>r.y?i.y:r.y:t.y>r.y?t.y:r.y,l=Ao(i.x<t.x?i.x<r.x?i.x:r.x:t.x<r.x?t.x:r.x,i.y<t.y?i.y<r.y?i.y:r.y:t.y<r.y?t.y:r.y,e,o,n);for(e=Ao(s,a,e,o,n),o=t.prevZ,n=t.nextZ;o&&o.z>=l&&n&&n.z<=e;){if(o!==t.prev&&o!==t.next&&Bo(i.x,i.y,t.x,t.y,r.x,r.y,o.x,o.y)&&0<=Mo(o.prev,o,o.next))return!1;if(o=o.prevZ,n!==t.prev&&n!==t.next&&Bo(i.x,i.y,t.x,t.y,r.x,r.y,n.x,n.y)&&0<=Mo(n.prev,n,n.next))return!1;n=n.nextZ}for(;o&&o.z>=l;){if(o!==t.prev&&o!==t.next&&Bo(i.x,i.y,t.x,t.y,r.x,r.y,o.x,o.y)&&0<=Mo(o.prev,o,o.next))return!1;o=o.prevZ}for(;n&&n.z<=e;){if(n!==t.prev&&n!==t.next&&Bo(i.x,i.y,t.x,t.y,r.x,r.y,n.x,n.y)&&0<=Mo(n.prev,n,n.next))return!1;n=n.nextZ}return!0}function Co(t,e){return t.x-e.x}function ko(t,e){var o=e,n=t.x,i=t.y,r=-1/0;do{if(i<=o.y&&i>=o.next.y&&o.next.y!==o.y){var s=o.x+(i-o.y)*(o.next.x-o.x)/(o.next.y-o.y);if(s<=n&&s>r){if(r=s,s===n){if(i===o.y)return o;if(i===o.next.y)return o.next}var a=o.x<o.next.x?o:o.next}}o=o.next}while(o!==e);if(!a)return null;if(n===r)return a;e=a,s=a.x;var l=a.y,c=1/0;o=a;do{if(n>=o.x&&o.x>=s&&n!==o.x&&Bo(i<l?n:r,i,s,l,i<l?r:n,i,o.x,o.y)){var u,h=Math.abs(i-o.y)/(n-o.x);if((u=Oo(o,t))&&!(u=h<c)&&(u=h===c)&&!(u=o.x>a.x)&&(u=o.x===a.x)){u=a;var g=o;u=0>Mo(u.prev,u,g.prev)&&0>Mo(g.next,u,u.next)}u&&(a=o,c=h)}o=o.next}while(o!==e);return a}function Ao(t,e,o,n,i){return t=32767*(t-o)*i,e=32767*(e-n)*i,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),1431655765&(t|t<<1)|(1431655765&(e|e<<1))<<1}function Io(t){var e=t,o=t;do{(e.x<o.x||e.x===o.x&&e.y<o.y)&&(o=e),e=e.next}while(e!==t);return o}function Bo(t,e,o,n,i,r,s,a){return 0<=(i-s)*(e-a)-(t-s)*(r-a)&&0<=(t-s)*(n-a)-(o-s)*(e-a)&&0<=(o-s)*(r-a)-(i-s)*(n-a)}function Mo(t,e,o){return(e.y-t.y)*(o.x-e.x)-(e.x-t.x)*(o.y-e.y)}function Lo(t,e){return t.x===e.x&&t.y===e.y}function No(t,e,o,n){var i=Do(Mo(t,e,o)),r=Do(Mo(t,e,n)),s=Do(Mo(o,n,t)),a=Do(Mo(o,n,e));return!!(i!==r&&s!==a||0===i&&Ro(t,o,e)||0===r&&Ro(t,n,e)||0===s&&Ro(o,t,n)||0===a&&Ro(o,e,n))}function Ro(t,e,o){return e.x<=Math.max(t.x,o.x)&&e.x>=Math.min(t.x,o.x)&&e.y<=Math.max(t.y,o.y)&&e.y>=Math.min(t.y,o.y)}function Do(t){return 0<t?1:0>t?-1:0}function Oo(t,e){return 0>Mo(t.prev,t,t.next)?0<=Mo(t,e,t.next)&&0<=Mo(t,t.prev,e):0>Mo(t,e,t.prev)||0>Mo(t,t.next,e)}function Po(t,e){var o=new Ho(t.i,t.x,t.y),n=new Ho(e.i,e.x,e.y),i=t.next,r=e.prev;return t.next=e,e.prev=t,o.next=i,i.prev=o,n.next=o,o.prev=n,r.next=n,n.prev=r,n}function jo(t,e,o,n){return t=new Ho(t,e,o),n?(t.next=n.next,t.prev=n,n.next.prev=t,n.next=t):(t.prev=t,t.next=t),t}function Fo(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ho(t,e,o){this.i=t,this.x=e,this.y=o,this.nextZ=this.prevZ=this.z=this.next=this.prev=null,this.steiner=!1}function Uo(t){var e=t.length;2<e&&t[e-1].equals(t[0])&&t.pop()}function Go(t,e){for(var o=0;o<e.length;o++)t.push(e[o].x),t.push(e[o].y)}function Vo(t,e){k.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new Wo(t,e)),this.mergeVertices()}function Wo(t,e){S.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];for(var o=this,n=[],i=[],r=0,s=t.length;r<s;r++)!function(t){function r(t,e,o){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(o).add(t)}function s(t,e,o){var n=t.x-e.x,i=t.y-e.y,r=o.x-t.x,s=o.y-t.y,a=n*n+i*i;if(Math.abs(n*s-i*r)>Number.EPSILON){var l=Math.sqrt(a),c=Math.sqrt(r*r+s*s);if(a=e.x-i/l,e=e.y+n/l,s=((o.x-s/c-a)*s-(o.y+r/c-e)*r)/(n*s-i*r),r=a+n*s-t.x,n=e+i*s-t.y,2>=(i=r*r+n*n))return new Er(r,n);i=Math.sqrt(i/2)}else t=!1,n>Number.EPSILON?r>Number.EPSILON&&(t=!0):n<-Number.EPSILON?r<-Number.EPSILON&&(t=!0):Math.sign(i)===Math.sign(s)&&(t=!0),t?(r=-i,i=Math.sqrt(a)):(r=n,n=i,i=Math.sqrt(a/2));return new Er(r/i,n/i)}function a(t,e){for(var i=t.length;0<=--i;){var r=i,s=i-1;0>s&&(s=t.length-1);for(var a=0,l=d+2*b;a<l;a++){var c=N*a,g=N*(a+1),p=e+s+c,f=e+s+g;g=e+r+g,u(e+r+c),u(p),u(g),u(p),u(f),u(g),c=n.length/3,c=x.generateSideWallUV(o,n,c-6,c-3,c-2,c-1),h(c[0]),h(c[1]),h(c[3]),h(c[1]),h(c[2]),h(c[3])}}}function l(t,e,o){g.push(t),g.push(e),g.push(o)}function c(t,e,i){u(t),u(e),u(i),t=n.length/3,t=x.generateTopUV(o,n,t-3,t-2,t-1),h(t[0]),h(t[1]),h(t[2])}function u(t){n.push(g[3*t]),n.push(g[3*t+1]),n.push(g[3*t+2])}function h(t){i.push(t.x),i.push(t.y)}var g=[],p=void 0!==e.curveSegments?e.curveSegments:12,d=void 0!==e.steps?e.steps:1,f=void 0!==e.depth?e.depth:100,m=void 0===e.bevelEnabled||e.bevelEnabled,y=void 0!==e.bevelThickness?e.bevelThickness:6,v=void 0!==e.bevelSize?e.bevelSize:y-2,_=void 0!==e.bevelOffset?e.bevelOffset:0,b=void 0!==e.bevelSegments?e.bevelSegments:3,E=e.extrudePath,x=void 0!==e.UVGenerator?e.UVGenerator:Nl;void 0!==e.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),f=e.amount);var S=!1;if(E){var T=E.getSpacedPoints(d);S=!0,m=!1;var w=E.computeFrenetFrames(d,!1),C=new Mr,k=new Mr,A=new Mr}m||(_=v=y=b=0),t=t.extractPoints(p),E=t.shape;var I=t.holes;if(!Ll.isClockWise(E))for(E=E.reverse(),t=0,p=I.length;t<p;t++){var B=I[t];Ll.isClockWise(B)&&(I[t]=B.reverse())}var M=Ll.triangulateShape(E,I),L=E;for(t=0,p=I.length;t<p;t++)E=E.concat(I[t]);var N=E.length,R=M.length;t=[],p=0,B=L.length;for(var D=B-1,O=p+1;p<B;p++,D++,O++)D===B&&(D=0),O===B&&(O=0),t[p]=s(L[p],L[D],L[O]);p=[],B=t.concat(),O=0;for(var P=I.length;O<P;O++){var j=I[O];D=[];for(var F=0,H=j.length,U=H-1,G=F+1;F<H;F++,U++,G++)U===H&&(U=0),G===H&&(G=0),D[F]=s(j[F],j[U],j[G]);p.push(D),B=B.concat(D)}for(O=0;O<b;O++){for(D=O/b,P=y*Math.cos(D*Math.PI/2),j=v*Math.sin(D*Math.PI/2)+_,D=0,F=L.length;D<F;D++)H=r(L[D],t[D],j),l(H.x,H.y,-P);for(F=0,H=I.length;F<H;F++){U=I[F],D=p[F],G=0;for(var V=U.length;G<V;G++){var W=r(U[G],D[G],j);l(W.x,W.y,-P)}}}for(D=v+_,O=0;O<N;O++)P=m?r(E[O],B[O],D):E[O],S?(k.copy(w.normals[0]).multiplyScalar(P.x),C.copy(w.binormals[0]).multiplyScalar(P.y),A.copy(T[0]).add(k).add(C),l(A.x,A.y,A.z)):l(P.x,P.y,0);for(O=1;O<=d;O++)for(P=0;P<N;P++)j=m?r(E[P],B[P],D):E[P],S?(k.copy(w.normals[O]).multiplyScalar(j.x),C.copy(w.binormals[O]).multiplyScalar(j.y),A.copy(T[O]).add(k).add(C),l(A.x,A.y,A.z)):l(j.x,j.y,f/d*O);for(w=b-1;0<=w;w--){for(k=w/b,C=y*Math.cos(k*Math.PI/2),k=v*Math.sin(k*Math.PI/2)+_,A=0,E=L.length;A<E;A++)B=r(L[A],t[A],k),l(B.x,B.y,f+C);for(A=0,E=I.length;A<E;A++)for(B=I[A],D=p[A],O=0,P=B.length;O<P;O++)j=r(B[O],D[O],k),S?l(j.x,j.y+T[d-1].y,T[d-1].x+C):l(j.x,j.y,f+C)}!function(){var t=n.length/3;if(m){for(var e=0*N,i=0;i<R;i++){var r=M[i];c(r[2]+e,r[1]+e,r[0]+e)}for(e=N*(d+2*b),i=0;i<R;i++)r=M[i],c(r[0]+e,r[1]+e,r[2]+e)}else{for(e=0;e<R;e++)i=M[e],c(i[2],i[1],i[0]);for(e=0;e<R;e++)i=M[e],c(i[0]+N*d,i[1]+N*d,i[2]+N*d)}o.addGroup(t,n.length/3-t,0)}(),function(){var t=n.length/3,e=0;a(L,e),e+=L.length;for(var i=0,r=I.length;i<r;i++){var s=I[i];a(s,e),e+=s.length}o.addGroup(t,n.length/3-t,1)}()}(t[r]);this.setAttribute("position",new b(n,3)),this.setAttribute("uv",new b(i,2)),this.computeVertexNormals()}function zo(t,e,o){if(o.shapes=[],Array.isArray(t))for(var n=0,i=t.length;n<i;n++)o.shapes.push(t[n].uuid);else o.shapes.push(t.uuid);return void 0!==e.extrudePath&&(o.options.extrudePath=e.extrudePath.toJSON()),o}function qo(t,e){k.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new Xo(t,e)),this.mergeVertices()}function Xo(t,e){e=e||{};var o=e.font;if(!o||!o.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new k;t=o.generateShapes(t,e.size),e.depth=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),Wo.call(this,t,e),this.type="TextBufferGeometry"}function Yo(t,e,o,n,i,r,s){k.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:o,phiStart:n,phiLength:i,thetaStart:r,thetaLength:s},this.fromBufferGeometry(new Ko(t,e,o,n,i,r,s)),this.mergeVertices()}function Ko(t,e,o,n,i,r,s){S.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:o,phiStart:n,phiLength:i,thetaStart:r,thetaLength:s},t=t||1,e=Math.max(3,Math.floor(e)||8),o=Math.max(2,Math.floor(o)||6),n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI,r=void 0!==r?r:0,s=void 0!==s?s:Math.PI;for(var a=Math.min(r+s,Math.PI),l=0,c=[],u=new Mr,h=new Mr,g=[],p=[],d=[],f=[],m=0;m<=o;m++){var y=[],v=m/o,_=0;0==m&&0==r?_=.5/e:m==o&&a==Math.PI&&(_=-.5/e);for(var E=0;E<=e;E++){var x=E/e;u.x=-t*Math.cos(n+x*i)*Math.sin(r+v*s),u.y=t*Math.cos(r+v*s),u.z=t*Math.sin(n+x*i)*Math.sin(r+v*s),p.push(u.x,u.y,u.z),h.copy(u).normalize(),d.push(h.x,h.y,h.z),f.push(x+_,1-v),y.push(l++)}c.push(y)}for(t=0;t<o;t++)for(n=0;n<e;n++)i=c[t][n+1],s=c[t][n],l=c[t+1][n],u=c[t+1][n+1],(0!==t||0<r)&&g.push(i,s,u),(t!==o-1||a<Math.PI)&&g.push(s,l,u);this.setIndex(g),this.setAttribute("position",new b(p,3)),this.setAttribute("normal",new b(d,3)),this.setAttribute("uv",new b(f,2))}function $o(t,e,o,n,i,r){k.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:o,phiSegments:n,thetaStart:i,thetaLength:r},this.fromBufferGeometry(new Qo(t,e,o,n,i,r)),this.mergeVertices()}function Qo(t,e,o,n,i,r){S.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:o,phiSegments:n,thetaStart:i,thetaLength:r},t=t||.5,e=e||1,i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI,o=void 0!==o?Math.max(3,o):8,n=void 0!==n?Math.max(1,n):1;var s=[],a=[],l=[],c=[],u=t;t=(e-t)/n;for(var h=new Mr,g=new Er,p=0;p<=n;p++){for(var d=0;d<=o;d++){var f=i+d/o*r;h.x=u*Math.cos(f),h.y=u*Math.sin(f),a.push(h.x,h.y,h.z),l.push(0,0,1),g.x=(h.x/e+1)/2,g.y=(h.y/e+1)/2,c.push(g.x,g.y)}u+=t}for(e=0;e<n;e++)for(i=e*(o+1),r=0;r<o;r++)u=r+i,t=u+o+1,h=u+o+2,g=u+1,s.push(u,t,g),s.push(t,h,g);this.setIndex(s),this.setAttribute("position",new b(a,3)),this.setAttribute("normal",new b(l,3)),this.setAttribute("uv",new b(c,2))}function Jo(t,e,o,n){k.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:o,phiLength:n},this.fromBufferGeometry(new Zo(t,e,o,n)),this.mergeVertices()}function Zo(t,e,o,n){S.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:o,phiLength:n},e=Math.floor(e)||12,o=o||0,n=n||2*Math.PI,n=br.clamp(n,0,2*Math.PI);for(var i=[],r=[],s=[],a=1/e,l=new Mr,c=new Er,u=0;u<=e;u++){var h=o+u*a*n,g=Math.sin(h);h=Math.cos(h);for(var p=0;p<=t.length-1;p++)l.x=t[p].x*g,l.y=t[p].y,l.z=t[p].x*h,r.push(l.x,l.y,l.z),c.x=u/e,c.y=p/(t.length-1),s.push(c.x,c.y)}for(o=0;o<e;o++)for(a=0;a<t.length-1;a++)l=a+o*t.length,c=l+t.length,u=l+t.length+1,g=l+1,i.push(l,c,g),i.push(c,u,g);if(this.setIndex(i),this.setAttribute("position",new b(r,3)),this.setAttribute("uv",new b(s,2)),this.computeVertexNormals(),n===2*Math.PI)for(n=this.attributes.normal.array,i=new Mr,r=new Mr,s=new Mr,e=e*t.length*3,a=o=0;o<t.length;o++,a+=3)i.x=n[a+0],i.y=n[a+1],i.z=n[a+2],r.x=n[e+a+0],r.y=n[e+a+1],r.z=n[e+a+2],s.addVectors(i,r).normalize(),n[a+0]=n[e+a+0]=s.x,n[a+1]=n[e+a+1]=s.y,n[a+2]=n[e+a+2]=s.z}function tn(t,e){k.call(this),this.type="ShapeGeometry","object"==typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new en(t,e)),this.mergeVertices()}function en(t,e){function o(t){var o=i.length/3,a=t.extractPoints(e);t=a.shape;var c=a.holes;!1===Ll.isClockWise(t)&&(t=t.reverse()),a=0;for(var u=c.length;a<u;a++){var h=c[a];!0===Ll.isClockWise(h)&&(c[a]=h.reverse())}for(a=Ll.triangulateShape(t,c),u=0,h=c.length;u<h;u++)t=t.concat(c[u]);for(c=0,u=t.length;c<u;c++)h=t[c],i.push(h.x,h.y,0),r.push(0,0,1),s.push(h.x,h.y);for(t=0,c=a.length;t<c;t++)u=a[t],n.push(u[0]+o,u[1]+o,u[2]+o),l+=3}S.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var n=[],i=[],r=[],s=[],a=0,l=0;if(!1===Array.isArray(t))o(t);else for(var c=0;c<t.length;c++)o(t[c]),this.addGroup(a,l,c),a+=l,l=0;this.setIndex(n),this.setAttribute("position",new b(i,3)),this.setAttribute("normal",new b(r,3)),this.setAttribute("uv",new b(s,2))}function on(t,e){if(e.shapes=[],Array.isArray(t))for(var o=0,n=t.length;o<n;o++)e.shapes.push(t[o].uuid);else e.shapes.push(t.uuid);return e}function nn(t,e){S.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e};var o=[];e=Math.cos(br.DEG2RAD*(void 0!==e?e:1));var n=[0,0],i={},r=["a","b","c"];if(t.isBufferGeometry){var s=new k;s.fromBufferGeometry(t)}else s=t.clone();s.mergeVertices(),s.computeFaceNormals(),t=s.vertices,s=s.faces;for(var a=0,l=s.length;a<l;a++)for(var c=s[a],u=0;3>u;u++){var h=c[r[u]],g=c[r[(u+1)%3]];n[0]=Math.min(h,g),n[1]=Math.max(h,g),h=n[0]+","+n[1],void 0===i[h]?i[h]={index1:n[0],index2:n[1],face1:a,face2:void 0}:i[h].face2=a}for(h in i)n=i[h],(void 0===n.face2||s[n.face1].normal.dot(s[n.face2].normal)<=e)&&(r=t[n.index1],o.push(r.x,r.y,r.z),r=t[n.index2],o.push(r.x,r.y,r.z));this.setAttribute("position",new b(o,3))}function rn(t,e,o,n,i,r,s,a){k.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:o,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:s,thetaLength:a},this.fromBufferGeometry(new sn(t,e,o,n,i,r,s,a)),this.mergeVertices()}function sn(t,e,o,n,i,r,s,a){function l(o){for(var i=d,r=new Er,l=new Mr,f=0,v=!0===o?t:e,_=!0===o?1:-1,b=1;b<=n;b++)h.push(0,m*_,0),g.push(0,_,0),p.push(.5,.5),d++;b=d;for(var E=0;E<=n;E++){var x=E/n*a+s,S=Math.cos(x);x=Math.sin(x),l.x=v*x,l.y=m*_,l.z=v*S,h.push(l.x,l.y,l.z),g.push(0,_,0),r.x=.5*S+.5,r.y=.5*x*_+.5,p.push(r.x,r.y),d++}for(r=0;r<n;r++)l=i+r,v=b+r,!0===o?u.push(v,v+1,l):u.push(v+1,v,l),f+=3;c.addGroup(y,f,!0===o?1:2),y+=f}S.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:o,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:s,thetaLength:a};var c=this;t=void 0!==t?t:1,e=void 0!==e?e:1,o=o||1,n=Math.floor(n)||8,i=Math.floor(i)||1,r=void 0!==r&&r,s=void 0!==s?s:0,a=void 0!==a?a:2*Math.PI;var u=[],h=[],g=[],p=[],d=0,f=[],m=o/2,y=0;!function(){for(var r=new Mr,l=new Mr,v=0,_=(e-t)/o,b=0;b<=i;b++){for(var E=[],x=b/i,S=x*(e-t)+t,T=0;T<=n;T++){var w=T/n,C=w*a+s,k=Math.sin(C);C=Math.cos(C),l.x=S*k,l.y=-x*o+m,l.z=S*C,h.push(l.x,l.y,l.z),r.set(k,_,C).normalize(),g.push(r.x,r.y,r.z),p.push(w,1-x),E.push(d++)}f.push(E)}for(r=0;r<n;r++)for(l=0;l<i;l++)_=f[l+1][r],b=f[l+1][r+1],E=f[l][r+1],u.push(f[l][r],_,E),u.push(_,b,E),v+=6;c.addGroup(y,v,0),y+=v}(),!1===r&&(0<t&&l(!0),0<e&&l(!1)),this.setIndex(u),this.setAttribute("position",new b(h,3)),this.setAttribute("normal",new b(g,3)),this.setAttribute("uv",new b(p,2))}function an(t,e,o,n,i,r,s){rn.call(this,0,t,e,o,n,i,r,s),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:o,heightSegments:n,openEnded:i,thetaStart:r,thetaLength:s}}function ln(t,e,o,n,i,r,s){sn.call(this,0,t,e,o,n,i,r,s),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:o,heightSegments:n,openEnded:i,thetaStart:r,thetaLength:s}}function cn(t,e,o,n){k.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:o,thetaLength:n},this.fromBufferGeometry(new un(t,e,o,n)),this.mergeVertices()}function un(t,e,o,n){S.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:o,thetaLength:n},t=t||1,e=void 0!==e?Math.max(3,e):8,o=void 0!==o?o:0,n=void 0!==n?n:2*Math.PI;var i=[],r=[],s=[],a=[],l=new Mr,c=new Er;r.push(0,0,0),s.push(0,0,1),a.push(.5,.5);for(var u=0,h=3;u<=e;u++,h+=3){var g=o+u/e*n;l.x=t*Math.cos(g),l.y=t*Math.sin(g),r.push(l.x,l.y,l.z),s.push(0,0,1),c.x=(r[h]/t+1)/2,c.y=(r[h+1]/t+1)/2,a.push(c.x,c.y)}for(t=1;t<=e;t++)i.push(t,t+1,0);this.setIndex(i),this.setAttribute("position",new b(r,3)),this.setAttribute("normal",new b(s,3)),this.setAttribute("uv",new b(a,2))}function hn(t){u.call(this),this.type="ShadowMaterial",this.color=new Ys(0),this.transparent=!0,this.setValues(t)}function gn(t){L.call(this,t),this.type="RawShaderMaterial"}function pn(t){u.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ys(16777215),this.roughness=1,this.metalness=0,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ys(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Er(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexTangents=this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function dn(t){pn.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Er(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(t)}function fn(t){u.call(this),this.type="MeshPhongMaterial",this.color=new Ys(16777215),this.specular=new Ys(1118481),this.shininess=30,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ys(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Er(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function mn(t){u.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ys(16777215),this.lightMap=this.gradientMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ys(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Er(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function yn(t){u.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Er(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.fog=!1,this.setValues(t)}function vn(t){u.call(this),this.type="MeshLambertMaterial",this.color=new Ys(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ys(0),this.emissiveIntensity=1,this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function _n(t){u.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ys(16777215),this.bumpMap=this.map=this.matcap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Er(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function bn(t){ze.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}function En(t,e,o,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new e.constructor(o),this.sampleValues=e,this.valueSize=o}function xn(t,e,o,n){En.call(this,t,e,o,n),this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function Sn(t,e,o,n){En.call(this,t,e,o,n)}function Tn(t,e,o,n){En.call(this,t,e,o,n)}function wn(t,e,o,n){if(void 0===t)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Ol.convertArray(e,this.TimeBufferType),this.values=Ol.convertArray(o,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}function Cn(t,e,o){wn.call(this,t,e,o)}function kn(t,e,o,n){wn.call(this,t,e,o,n)}function An(t,e,o,n){wn.call(this,t,e,o,n)}function In(t,e,o,n){En.call(this,t,e,o,n)}function Bn(t,e,o,n){wn.call(this,t,e,o,n)}function Mn(t,e,o,n){wn.call(this,t,e,o,n)}function Ln(t,e,o,n){wn.call(this,t,e,o,n)}function Nn(t,e,o,n){this.name=t,this.tracks=o,this.duration=void 0!==e?e:-1,this.blendMode=void 0!==n?n:2500,this.uuid=br.generateUUID(),0>this.duration&&this.resetDuration()}function Rn(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return An;case"vector":case"vector2":case"vector3":case"vector4":return Ln;case"color":return kn;case"quaternion":return Bn;case"bool":case"boolean":return Cn;case"string":return Mn}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function Dn(t){if(void 0===t.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=Rn(t.type);if(void 0===t.times){var o=[],n=[];Ol.flattenJSON(t.keys,o,n,"value"),t.times=o,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}function On(t,e,o){var n=this,i=!1,r=0,s=0,a=void 0,l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=o,this.itemStart=function(t){s++,!1===i&&void 0!==n.onStart&&n.onStart(t,r,s),i=!0},this.itemEnd=function(t){r++,void 0!==n.onProgress&&n.onProgress(t,r,s),r===s&&(i=!1,void 0!==n.onLoad)&&n.onLoad()},this.itemError=function(t){void 0!==n.onError&&n.onError(t)},this.resolveURL=function(t){return a?a(t):t},this.setURLModifier=function(t){return a=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){return t=l.indexOf(t),-1!==t&&l.splice(t,2),this},this.getHandler=function(t){for(var e=0,o=l.length;e<o;e+=2){var n=l[e],i=l[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return i}return null}}function Pn(t){this.manager=void 0!==t?t:jl,this.crossOrigin="anonymous",this.resourcePath=this.path="",this.requestHeader={}}function jn(t){Pn.call(this,t)}function Fn(t){Pn.call(this,t)}function Hn(t){Pn.call(this,t)}function Un(t){Pn.call(this,t)}function Gn(t){Pn.call(this,t)}function Vn(t){Pn.call(this,t)}function Wn(t){Pn.call(this,t)}function zn(){this.type="Curve",this.arcLengthDivisions=200}function qn(t,e,o,n,i,r,s,a){zn.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=o||1,this.yRadius=n||1,this.aStartAngle=i||0,this.aEndAngle=r||2*Math.PI,this.aClockwise=s||!1,this.aRotation=a||0}function Xn(t,e,o,n,i,r){qn.call(this,t,e,o,o,n,i,r),this.type="ArcCurve"}function Yn(){var t=0,e=0,o=0,n=0;return{initCatmullRom:function(i,r,s,a,l){i=l*(s-i),a=l*(a-r),t=r,e=i,o=-3*r+3*s-2*i-a,n=2*r-2*s+i+a},initNonuniformCatmullRom:function(i,r,s,a,l,c,u){i=((r-i)/l-(s-i)/(l+c)+(s-r)/c)*c,a=((s-r)/c-(a-r)/(c+u)+(a-s)/u)*c,t=r,e=i,o=-3*r+3*s-2*i-a,n=2*r-2*s+i+a},calc:function(i){var r=i*i;return t+e*i+o*r+n*r*i}}}function Kn(t,e,o,n){zn.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=o||"centripetal",this.tension=void 0!==n?n:.5}function $n(t,e,o,n,i){e=.5*(n-e),i=.5*(i-o);var r=t*t;return(2*o-2*n+e+i)*t*r+(-3*o+3*n-2*e-i)*r+e*t+o}function Qn(t,e,o,n){var i=1-t;return i*i*e+2*(1-t)*t*o+t*t*n}function Jn(t,e,o,n,i){var r=1-t,s=1-t;return r*r*r*e+3*s*s*t*o+3*(1-t)*t*t*n+t*t*t*i}function Zn(t,e,o,n){zn.call(this),this.type="CubicBezierCurve",this.v0=t||new Er,this.v1=e||new Er,this.v2=o||new Er,this.v3=n||new Er}function ti(t,e,o,n){zn.call(this),this.type="CubicBezierCurve3",this.v0=t||new Mr,this.v1=e||new Mr,this.v2=o||new Mr,this.v3=n||new Mr}function ei(t,e){zn.call(this),this.type="LineCurve",this.v1=t||new Er,this.v2=e||new Er}function oi(t,e){zn.call(this),this.type="LineCurve3",this.v1=t||new Mr,this.v2=e||new Mr}function ni(t,e,o){zn.call(this),this.type="QuadraticBezierCurve",this.v0=t||new Er,this.v1=e||new Er,this.v2=o||new Er}function ii(t,e,o){zn.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new Mr,this.v1=e||new Mr,this.v2=o||new Mr}function ri(t){zn.call(this),this.type="SplineCurve",this.points=t||[]}function si(){zn.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function ai(t){si.call(this),this.type="Path",this.currentPoint=new Er,t&&this.setFromPoints(t)}function li(t){ai.call(this,t),this.uuid=br.generateUUID(),this.type="Shape",this.holes=[]}function ci(t,e){s.call(this),this.type="Light",this.color=new Ys(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function ui(t,e,o){ci.call(this,t,o),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(s.DefaultUp),this.updateMatrix(),this.groundColor=new Ys(e)}function hi(t){this.camera=t,this.normalBias=this.bias=0,this.radius=1,this.mapSize=new Er(512,512),this.mapPass=this.map=null,this.matrix=new is,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ma,this._frameExtents=new Er(1,1),this._viewportCount=1,this._viewports=[new kr(0,0,1,1)]}function gi(){hi.call(this,new R(50,1,.5,500))}function pi(t,e,o,n,i,r){ci.call(this,t,e),this.type="SpotLight",this.position.copy(s.DefaultUp),this.updateMatrix(),this.target=new s,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==o?o:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==r?r:1,this.shadow=new gi}function di(){hi.call(this,new R(90,1,.5,500)),this._frameExtents=new Er(4,2),this._viewportCount=6,this._viewports=[new kr(2,1,1,1),new kr(0,1,1,1),new kr(3,1,1,1),new kr(1,1,1,1),new kr(3,0,1,1),new kr(1,0,1,1)],this._cubeDirections=[new Mr(1,0,0),new Mr(-1,0,0),new Mr(0,0,1),new Mr(0,0,-1),new Mr(0,1,0),new Mr(0,-1,0)],this._cubeUps=[new Mr(0,1,0),new Mr(0,1,0),new Mr(0,1,0),new Mr(0,1,0),new Mr(0,0,1),new Mr(0,0,-1)]}function fi(t,e,o,n){ci.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==o?o:0,this.decay=void 0!==n?n:1,this.shadow=new di}function mi(t,e,o,n,i,r){N.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==t?t:-1,this.right=void 0!==e?e:1,this.top=void 0!==o?o:1,this.bottom=void 0!==n?n:-1,this.near=void 0!==i?i:.1,this.far=void 0!==r?r:2e3,this.updateProjectionMatrix()}function yi(){hi.call(this,new mi(-5,5,5,-5,.5,500))}function vi(t,e){ci.call(this,t,e),this.type="DirectionalLight",this.position.copy(s.DefaultUp),this.updateMatrix(),this.target=new s,this.shadow=new yi}function _i(t,e){ci.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function bi(t,e,o,n){ci.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==o?o:10,this.height=void 0!==n?n:10}function Ei(t,e){ci.call(this,void 0,e),this.type="LightProbe",this.sh=void 0!==t?t:new zl}function xi(t){Pn.call(this,t),this.textures={}}function Si(){S.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function Ti(t,e,o,n){"number"==typeof o&&(n=o,o=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),g.call(this,t,e,o),this.meshPerAttribute=n||1}function wi(t){Pn.call(this,t)}function Ci(t){Pn.call(this,t)}function ki(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Pn.call(this,t),this.options={premultiplyAlpha:"none"}}function Ai(){this.type="ShapePath",this.color=new Ys,this.subPaths=[],this.currentPath=null}function Ii(t){this.type="Font",this.data=t}function Bi(t){Pn.call(this,t)}function Mi(t){Pn.call(this,t)}function Li(t,e,o){Ei.call(this,void 0,o),t=(new Ys).set(t),o=(new Ys).set(e),e=new Mr(t.r,t.g,t.b),t=new Mr(o.r,o.g,o.b),o=Math.sqrt(Math.PI);var n=o*Math.sqrt(.75);this.sh.coefficients[0].copy(e).add(t).multiplyScalar(o),this.sh.coefficients[1].copy(e).sub(t).multiplyScalar(n)}function Ni(t,e){Ei.call(this,void 0,e),t=(new Ys).set(t),this.sh.coefficients[0].set(t.r,t.g,t.b).multiplyScalar(2*Math.sqrt(Math.PI))}function Ri(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new R,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new R,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}function Di(){s.call(this),this.type="AudioListener",this.context=Jl.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new ec}function Oi(t){s.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.offset=this.loopEnd=this.loopStart=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._progress=this._startedAt=0,this._connected=!1,this.filters=[]}function Pi(t){Oi.call(this,t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function ji(t,e,o){switch(this.binding=t,this.valueSize=o,e){case"quaternion":t=this._slerp,e=this._slerpAdditive;var n=this._setAdditiveIdentityQuaternion;this.buffer=new Float64Array(6*o),this._workIndex=5;break;case"string":case"bool":e=t=this._select,n=this._setAdditiveIdentityOther,this.buffer=Array(5*o);break;default:t=this._lerp,e=this._lerpAdditive,n=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*o)}this._mixBufferRegion=t,this._mixBufferRegionAdditive=e,this._setIdentity=n,this._origIndex=3,this._addIndex=4,this.referenceCount=this.useCount=this.cumulativeWeightAdditive=this.cumulativeWeight=0}function Fi(t,e,o){o=o||Hi.parseTrackName(e),this._targetGroup=t,this._bindings=t.subscribe_(e,o)}function Hi(t,e,o){this.path=e,this.parsedPath=o||Hi.parseTrackName(e),this.node=Hi.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function Ui(){this.uuid=br.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,o=arguments.length;e!==o;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}function Gi(t){this._root=t,this._initMemoryManager(),this.time=this._accuIndex=0,this.timeScale=1}function Vi(t,e,o){De.call(this,t,e),this.meshPerAttribute=o||1}function Wi(t,e,o,n,i){this.buffer=t,this.type=e,this.itemSize=o,this.elementSize=n,this.count=i,this.version=0}function zi(t,e,o,n){this.ray=new ns(t,e),this.near=o||0,this.far=n||1/0,this.camera=null,this.layers=new ms,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function qi(t,e){return t.distance-e.distance}function Xi(t,e,o,n){if(t.layers.test(e.layers)&&t.raycast(e,o),!0===n){t=t.children,n=0;for(var i=t.length;n<i;n++)Xi(t[n],e,o,!0)}}function Yi(t){s.call(this),this.material=t,this.render=function(){},this.hasUvs=this.hasColors=this.hasNormals=this.hasPositions=!1,this.uvArray=this.colorArray=this.normalArray=this.positionArray=null,this.count=0}function Ki(t,e){s.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e,t=new S,e=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var o=0,n=1;32>o;o++,n++){var i=o/32*Math.PI*2,r=n/32*Math.PI*2;e.push(Math.cos(i),Math.sin(i),1,Math.cos(r),Math.sin(r),1)}t.setAttribute("position",new b(e,3)),e=new ze({fog:!1,toneMapped:!1}),this.cone=new Xe(t,e),this.add(this.cone),this.update()}function $i(t){for(var e=Qi(t),o=new S,n=[],i=[],r=new Ys(0,0,1),s=new Ys(0,1,0),a=0;a<e.length;a++){var l=e[a];l.parent&&l.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),i.push(r.r,r.g,r.b),i.push(s.r,s.g,s.b))}o.setAttribute("position",new b(n,3)),o.setAttribute("color",new b(i,3)),n=new ze({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0}),Xe.call(this,o,n),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function Qi(t){var e=[];t&&t.isBone&&e.push(t);for(var o=0;o<t.children.length;o++)e.push.apply(e,Qi(t.children[o]));return e}function Ji(t,e,o){e=new Ko(e,4,2);var n=new h({wireframe:!0,fog:!1,toneMapped:!1});T.call(this,e,n),this.light=t,this.light.updateMatrixWorld(),this.color=o,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Zi(t,e,o){s.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=o,t=new uo(e),t.rotateY(.5*Math.PI),this.material=new h({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0),e=t.getAttribute("position"),e=new Float32Array(3*e.count),t.setAttribute("color",new g(e,3)),this.add(new T(t,this.material)),this.update()}function tr(t,e,o,n){t=t||10,e=e||10,o=new Ys(void 0!==o?o:4473924),n=new Ys(void 0!==n?n:8947848);var i=e/2,r=t/e,s=t/2;t=[];for(var a=[],l=0,c=0,u=-s;l<=e;l++,u+=r){t.push(-s,0,u,s,0,u),t.push(u,0,-s,u,0,s);var h=l===i?o:n;h.toArray(a,c),c+=3,h.toArray(a,c),c+=3,h.toArray(a,c),c+=3,h.toArray(a,c),c+=3}e=new S,e.setAttribute("position",new b(t,3)),e.setAttribute("color",new b(a,3)),o=new ze({vertexColors:!0,toneMapped:!1}),Xe.call(this,e,o),this.type="GridHelper"}function er(t,e,o,n,i,r){t=t||10,e=e||16,o=o||8,n=n||64,i=new Ys(void 0!==i?i:4473924),r=new Ys(void 0!==r?r:8947848);for(var s=[],a=[],l=0;l<=e;l++){var c=l/e*2*Math.PI,u=Math.sin(c)*t;c=Math.cos(c)*t,s.push(0,0,0),s.push(u,0,c),u=1&l?i:r,a.push(u.r,u.g,u.b),a.push(u.r,u.g,u.b)}for(e=0;e<=o;e++)for(l=1&e?i:r,u=t-t/o*e,c=0;c<n;c++){var h=c/n*2*Math.PI,g=Math.sin(h)*u;h=Math.cos(h)*u,s.push(g,0,h),a.push(l.r,l.g,l.b),h=(c+1)/n*2*Math.PI,g=Math.sin(h)*u,h=Math.cos(h)*u,s.push(g,0,h),a.push(l.r,l.g,l.b)}t=new S,t.setAttribute("position",new b(s,3)),t.setAttribute("color",new b(a,3)),s=new ze({vertexColors:!0,toneMapped:!1}),Xe.call(this,t,s),this.type="PolarGridHelper"}function or(t,e,o){s.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=o,void 0===e&&(e=1),t=new S,t.setAttribute("position",new b([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3)),e=new ze({fog:!1,toneMapped:!1}),this.lightPlane=new qe(t,e),this.add(this.lightPlane),t=new S,t.setAttribute("position",new b([0,0,0,0,0,1],3)),this.targetLine=new qe(t,e),this.add(this.targetLine),this.update()}function nr(t){function e(t,e,n){o(t,n),o(e,n)}function o(t,e){r.push(0,0,0),s.push(e.r,e.g,e.b),void 0===a[t]&&(a[t]=[]),a[t].push(r.length/3-1)}var n=new S,i=new ze({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],a={},l=new Ys(16755200),c=new Ys(16711680),u=new Ys(43775),h=new Ys(16777215),g=new Ys(3355443);e("n1","n2",l),e("n2","n4",l),e("n4","n3",l),e("n3","n1",l),e("f1","f2",l),e("f2","f4",l),e("f4","f3",l),e("f3","f1",l),e("n1","f1",l),e("n2","f2",l),e("n3","f3",l),e("n4","f4",l),e("p","n1",c),e("p","n2",c),e("p","n3",c),e("p","n4",c),e("u1","u2",u),e("u2","u3",u),e("u3","u1",u),e("c","t",h),e("p","c",g),e("cn1","cn2",g),e("cn3","cn4",g),e("cf1","cf2",g),e("cf3","cf4",g),n.setAttribute("position",new b(r,3)),n.setAttribute("color",new b(s,3)),Xe.call(this,n,i),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}function ir(t,e,o,n,i,r,s){if(jc.set(i,r,s).unproject(n),void 0!==(t=e[t]))for(o=o.getAttribute("position"),e=0,n=t.length;e<n;e++)o.setXYZ(t[e],jc.x,jc.y,jc.z)}function rr(t,e){void 0===e&&(e=16776960);var o=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),i=new S;i.setIndex(new g(o,1)),i.setAttribute("position",new g(n,3)),Xe.call(this,i,new ze({color:e,toneMapped:!1})),this.object=t,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}function sr(t,e){void 0===e&&(e=16776960);var o=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new S;n.setIndex(new g(o,1)),n.setAttribute("position",new b([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Xe.call(this,n,new ze({color:e,toneMapped:!1})),this.box=t,this.type="Box3Helper",this.geometry.computeBoundingSphere()}function ar(t,e,o){o=void 0!==o?o:16776960;var n=new S;n.setAttribute("position",new b([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),n.computeBoundingSphere(),qe.call(this,n,new ze({color:o,toneMapped:!1})),this.type="PlaneHelper",this.plane=t,this.size=void 0===e?1:e,t=new S,t.setAttribute("position",new b([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),t.computeBoundingSphere(),this.add(new T(t,new h({color:o,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}function lr(t,e,o,n,i,r){s.call(this),this.type="ArrowHelper",void 0===t&&(t=new Mr(0,0,1)),void 0===e&&(e=new Mr(0,0,0)),void 0===o&&(o=1),void 0===n&&(n=16776960),void 0===i&&(i=.2*o),void 0===r&&(r=.2*i),void 0===Uc&&(Uc=new S,Uc.setAttribute("position",new b([0,0,0,0,1,0],3)),Gc=new sn(0,.5,1,5,1),Gc.translate(0,-.5,0)),this.position.copy(e),this.line=new qe(Uc,new ze({color:n,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new T(Gc,new h({color:n,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(o,i,r)}function cr(t){void 0===t&&(t=1);var e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t];t=new S,t.setAttribute("position",new b(e,3)),t.setAttribute("color",new b([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),e=new ze({vertexColors:!0,toneMapped:!1}),Xe.call(this,t,e),this.type="AxesHelper"}function ur(t){return t=new n(3*Wc,3*Wc,t),t.texture.mapping=306,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function hr(t,e,o,n,i){t.viewport.set(e,o,n,i),t.scissor.set(e,o,n,i)}function gr(){return new gn({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:new Er(1,1)},inputEncoding:{value:Xc[3e3]},outputEncoding:{value:Xc[3e3]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function pr(){return new gn({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:Xc[3e3]},outputEncoding:{value:Xc[3e3]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function dr(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Kn.call(this,t),this.type="catmullrom",this.closed=!0}function fr(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Kn.call(this,t),this.type="catmullrom"}function mr(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Kn.call(this,t),this.type="catmullrom"}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return 0>t?-1:0<t?1:+t}),!1=="name"in Function.prototype&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),o=1;o<arguments.length;o++){var n=arguments[o];if(void 0!==n&&null!==n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}),Object.assign(e.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var o=this._listeners;void 0===o[t]&&(o[t]=[]),-1===o[t].indexOf(e)&&o[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var o=this._listeners;return void 0!==o[t]&&-1!==o[t].indexOf(e)},removeEventListener:function(t,e){void 0!==this._listeners&&void 0!==(t=this._listeners[t])&&-1!==(e=t.indexOf(e))&&t.splice(e,1)},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this,e=e.slice(0);for(var o=0,n=e.length;o<n;o++)e[o].call(this,t)}}}});for(var yr=[],vr=0;256>vr;vr++)yr[vr]=(16>vr?"0":"")+vr.toString(16);var _r=1234567,br={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,o=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(yr[255&t]+yr[t>>8&255]+yr[t>>16&255]+yr[t>>24&255]+"-"+yr[255&e]+yr[e>>8&255]+"-"+yr[e>>16&15|64]+yr[e>>24&255]+"-"+yr[63&o|128]+yr[o>>8&255]+"-"+yr[o>>16&255]+yr[o>>24&255]+yr[255&n]+yr[n>>8&255]+yr[n>>16&255]+yr[n>>24&255]).toUpperCase()},clamp:function(t,e,o){return Math.max(e,Math.min(o,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,o,n,i){return n+(t-e)*(i-n)/(o-e)},lerp:function(t,e,o){return(1-o)*t+o*e},smoothstep:function(t,e,o){return t<=e?0:t>=o?1:(t=(t-e)/(o-e))*t*(3-2*t)},smootherstep:function(t,e,o){return t<=e?0:t>=o?1:(t=(t-e)/(o-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return void 0!==t&&(_r=t%2147483647),((_r=16807*_r%2147483647)-1)/2147483646},degToRad:function(t){return t*br.DEG2RAD},radToDeg:function(t){return t*br.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,o,n,i){var r=Math.cos,s=Math.sin,a=r(o/2);o=s(o/2);var l=r((e+n)/2),c=s((e+n)/2),u=r((e-n)/2),h=s((e-n)/2);switch(r=r((n-e)/2),e=s((n-e)/2),i){case"XYX":t.set(a*c,o*u,o*h,a*l);break;case"YZY":t.set(o*h,a*c,o*u,a*l);break;case"ZXZ":t.set(o*u,o*h,a*c,a*l);break;case"XZX":t.set(a*c,o*e,o*r,a*l);break;case"YXY":t.set(o*r,a*c,o*e,a*l);break;case"ZYZ":t.set(o*e,o*r,a*c,a*l);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}},Er=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),Object.defineProperty(this,"isVector2",{value:!0}),this.x=t,this.y=e},xr={width:{configurable:!0},height:{configurable:!0}};xr.width.get=function(){return this.x},xr.width.set=function(t){this.x=t},xr.height.get=function(){return this.y},xr.height.set=function(t){this.y=t},Er.prototype.set=function(t,e){return this.x=t,this.y=e,this},Er.prototype.setScalar=function(t){return this.y=this.x=t,this},Er.prototype.setX=function(t){return this.x=t,this},Er.prototype.setY=function(t){return this.y=t,this},Er.prototype.setComponent=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw Error("index is out of range: "+t)}return this},Er.prototype.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+t)}},Er.prototype.clone=function(){return new this.constructor(this.x,this.y)},Er.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},Er.prototype.add=function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},Er.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this},Er.prototype.addVectors=function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},Er.prototype.addScaledVector=function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},Er.prototype.sub=function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},Er.prototype.subScalar=function(t){return this.x-=t,this.y-=t,this},Er.prototype.subVectors=function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},Er.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},Er.prototype.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},Er.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this},Er.prototype.divideScalar=function(t){return this.multiplyScalar(1/t)},Er.prototype.applyMatrix3=function(t){var e=this.x,o=this.y;return t=t.elements,this.x=t[0]*e+t[3]*o+t[6],this.y=t[1]*e+t[4]*o+t[7],this},Er.prototype.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},Er.prototype.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},Er.prototype.clamp=function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},Er.prototype.clampScalar=function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},Er.prototype.clampLength=function(t,e){var o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(t,Math.min(e,o)))},Er.prototype.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},Er.prototype.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},Er.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},Er.prototype.roundToZero=function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},Er.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},Er.prototype.dot=function(t){return this.x*t.x+this.y*t.y},Er.prototype.cross=function(t){return this.x*t.y-this.y*t.x},Er.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Er.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Er.prototype.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)},Er.prototype.normalize=function(){return this.divideScalar(this.length()||1)},Er.prototype.angle=function(){return Math.atan2(-this.y,-this.x)+Math.PI},Er.prototype.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},Er.prototype.distanceToSquared=function(t){var e=this.x-t.x;return t=this.y-t.y,e*e+t*t},Er.prototype.manhattanDistanceTo=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},Er.prototype.setLength=function(t){return this.normalize().multiplyScalar(t)},Er.prototype.lerp=function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},Er.prototype.lerpVectors=function(t,e,o){return this.x=t.x+(e.x-t.x)*o,this.y=t.y+(e.y-t.y)*o,this},Er.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},Er.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},Er.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},Er.prototype.fromBufferAttribute=function(t,e,o){return void 0!==o&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},Er.prototype.rotateAround=function(t,e){var o=Math.cos(e);e=Math.sin(e);var n=this.x-t.x,i=this.y-t.y;return this.x=n*o-i*e+t.x,this.y=n*e+i*o+t.y,this},Er.prototype.random=function(){return this.x=Math.random(),this.y=Math.random(),this},Object.defineProperties(Er.prototype,xr);var Sr=function(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")};Sr.prototype.set=function(t,e,o,n,i,r,s,a,l){var c=this.elements;return c[0]=t,c[1]=n,c[2]=s,c[3]=e,c[4]=i,c[5]=a,c[6]=o,c[7]=r,c[8]=l,this},Sr.prototype.identity=function(){return this.set(1,0,0,0,1,0,0,0,1),this},Sr.prototype.clone=function(){return(new this.constructor).fromArray(this.elements)},Sr.prototype.copy=function(t){var e=this.elements;return t=t.elements,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},Sr.prototype.extractBasis=function(t,e,o){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),o.setFromMatrix3Column(this,2),this},Sr.prototype.setFromMatrix4=function(t){return t=t.elements,this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},Sr.prototype.multiply=function(t){return this.multiplyMatrices(this,t)},Sr.prototype.premultiply=function(t){return this.multiplyMatrices(t,this)},Sr.prototype.multiplyMatrices=function(t,e){var o=t.elements,n=e.elements;e=this.elements,t=o[0];var i=o[3],r=o[6],s=o[1],a=o[4],l=o[7],c=o[2],u=o[5];o=o[8];var h=n[0],g=n[3],p=n[6],d=n[1],f=n[4],m=n[7],y=n[2],v=n[5];return n=n[8],e[0]=t*h+i*d+r*y,e[3]=t*g+i*f+r*v,e[6]=t*p+i*m+r*n,e[1]=s*h+a*d+l*y,e[4]=s*g+a*f+l*v,e[7]=s*p+a*m+l*n,e[2]=c*h+u*d+o*y,e[5]=c*g+u*f+o*v,e[8]=c*p+u*m+o*n,this},Sr.prototype.multiplyScalar=function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},Sr.prototype.determinant=function(){var t=this.elements,e=t[0],o=t[1],n=t[2],i=t[3],r=t[4],s=t[5],a=t[6],l=t[7];return t=t[8],e*r*t-e*s*l-o*i*t+o*s*a+n*i*l-n*r*a},Sr.prototype.getInverse=function(t,e){void 0!==e&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var o=t.elements;t=this.elements,e=o[0];var n=o[1],i=o[2],r=o[3],s=o[4],a=o[5],l=o[6],c=o[7];o=o[8];var u=o*s-a*c,h=a*l-o*r,g=c*r-s*l,p=e*u+n*h+i*g;return 0===p?this.set(0,0,0,0,0,0,0,0,0):(p=1/p,t[0]=u*p,t[1]=(i*c-o*n)*p,t[2]=(a*n-i*s)*p,t[3]=h*p,t[4]=(o*e-i*l)*p,t[5]=(i*r-a*e)*p,t[6]=g*p,t[7]=(n*l-c*e)*p,t[8]=(s*e-n*r)*p,this)},Sr.prototype.transpose=function(){var t=this.elements,e=t[1];return t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},Sr.prototype.getNormalMatrix=function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},Sr.prototype.transposeIntoArray=function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},Sr.prototype.setUvTransform=function(t,e,o,n,i,r,s){var a=Math.cos(i);i=Math.sin(i),this.set(o*a,o*i,-o*(a*r+i*s)+r+t,-n*i,n*a,-n*(-i*r+a*s)+s+e,0,0,1)},Sr.prototype.scale=function(t,e){var o=this.elements;return o[0]*=t,o[3]*=t,o[6]*=t,o[1]*=e,o[4]*=e,o[7]*=e,this},Sr.prototype.rotate=function(t){var e=Math.cos(t);t=Math.sin(t);var o=this.elements,n=o[0],i=o[3],r=o[6],s=o[1],a=o[4],l=o[7];return o[0]=e*n+t*s,o[3]=e*i+t*a,o[6]=e*r+t*l,o[1]=-t*n+e*s,o[4]=-t*i+e*a,o[7]=-t*r+e*l,this},Sr.prototype.translate=function(t,e){var o=this.elements;return o[0]+=t*o[2],o[3]+=t*o[5],o[6]+=t*o[8],o[1]+=e*o[2],o[4]+=e*o[5],o[7]+=e*o[8],this},Sr.prototype.equals=function(t){var e=this.elements;t=t.elements;for(var o=0;9>o;o++)if(e[o]!==t[o])return!1;return!0},Sr.prototype.fromArray=function(t,e){void 0===e&&(e=0);for(var o=0;9>o;o++)this.elements[o]=t[o+e];return this},Sr.prototype.toArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var o=this.elements;return t[e]=o[0],t[e+1]=o[1],t[e+2]=o[2],t[e+3]=o[3],t[e+4]=o[4],t[e+5]=o[5],t[e+6]=o[6],t[e+7]=o[7],t[e+8]=o[8],t};var Tr,wr={getDataURL:function(t){if(/^data:/i.test(t.src)||"undefined"==typeof HTMLCanvasElement)return t.src;if(!(t instanceof HTMLCanvasElement)){void 0===Tr&&(Tr=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Tr.width=t.width,Tr.height=t.height;var e=Tr.getContext("2d");t instanceof ImageData?e.putImageData(t,0,0):e.drawImage(t,0,0,t.width,t.height),t=Tr}return 2048<t.width||2048<t.height?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},Cr=0;o.DEFAULT_IMAGE=void 0,o.DEFAULT_MAPPING=300,o.prototype=Object.assign(Object.create(e.prototype),{constructor:o,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var o={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var n=this.image;if(void 0===n.uuid&&(n.uuid=br.generateUUID()),!e&&void 0===t.images[n.uuid]){if(Array.isArray(n))for(var i=[],r=0,s=n.length;r<s;r++)i.push(wr.getDataURL(n[r]));else i=wr.getDataURL(n);t.images[n.uuid]={uuid:n.uuid,url:i}}o.image=n.uuid}return e||(t.textures[this.uuid]=o),o},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),0>t.x||1<t.x)switch(this.wrapS){case 1e3:t.x-=Math.floor(t.x);break;case 1001:t.x=0>t.x?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(0>t.y||1<t.y)switch(this.wrapT){case 1e3:t.y-=Math.floor(t.y);break;case 1001:t.y=0>t.y?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(o.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}});var kr=function(t,e,o,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===o&&(o=0),void 0===n&&(n=1),Object.defineProperty(this,"isVector4",{value:!0}),this.x=t,this.y=e,this.z=o,this.w=n},Ar={width:{configurable:!0},height:{configurable:!0}};Ar.width.get=function(){return this.z},Ar.width.set=function(t){this.z=t},Ar.height.get=function(){return this.w},Ar.height.set=function(t){this.w=t},kr.prototype.set=function(t,e,o,n){return this.x=t,this.y=e,this.z=o,this.w=n,this},kr.prototype.setScalar=function(t){return this.w=this.z=this.y=this.x=t,this},kr.prototype.setX=function(t){return this.x=t,this},kr.prototype.setY=function(t){return this.y=t,this},kr.prototype.setZ=function(t){return this.z=t,this},kr.prototype.setW=function(t){return this.w=t,this},kr.prototype.setComponent=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw Error("index is out of range: "+t)}return this},kr.prototype.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+t)}},kr.prototype.clone=function(){return new this.constructor(this.x,this.y,this.z,this.w)},kr.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},kr.prototype.add=function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},kr.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},kr.prototype.addVectors=function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},kr.prototype.addScaledVector=function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},kr.prototype.sub=function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},kr.prototype.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},kr.prototype.subVectors=function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},kr.prototype.multiplyScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},kr.prototype.applyMatrix4=function(t){var e=this.x,o=this.y,n=this.z,i=this.w;return t=t.elements,this.x=t[0]*e+t[4]*o+t[8]*n+t[12]*i,this.y=t[1]*e+t[5]*o+t[9]*n+t[13]*i,this.z=t[2]*e+t[6]*o+t[10]*n+t[14]*i,this.w=t[3]*e+t[7]*o+t[11]*n+t[15]*i,this},kr.prototype.divideScalar=function(t){return this.multiplyScalar(1/t)},kr.prototype.setAxisAngleFromQuaternion=function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return 1e-4>e?(this.x=1,this.z=this.y=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},kr.prototype.setAxisAngleFromRotationMatrix=function(t){t=t.elements;var e=t[0],o=t[4],n=t[8],i=t[1],r=t[5],s=t[9],a=t[2],l=t[6],c=t[10];return.01>Math.abs(o-i)&&.01>Math.abs(n-a)&&.01>Math.abs(s-l)?.1>Math.abs(o+i)&&.1>Math.abs(n+a)&&.1>Math.abs(s+l)&&.1>Math.abs(e+r+c-3)?(this.set(1,0,0,0),this):(t=Math.PI,e=(e+1)/2,r=(r+1)/2,c=(c+1)/2,o=(o+i)/4,n=(n+a)/4,s=(s+l)/4,e>r&&e>c?.01>e?(l=0,o=a=.707106781):(l=Math.sqrt(e),a=o/l,o=n/l):r>c?.01>r?(l=.707106781,a=0,o=.707106781):(a=Math.sqrt(r),l=o/a,o=s/a):.01>c?(a=l=.707106781,o=0):(o=Math.sqrt(c),l=n/o,a=s/o),this.set(l,a,o,t),this):(t=Math.sqrt((l-s)*(l-s)+(n-a)*(n-a)+(i-o)*(i-o)),.001>Math.abs(t)&&(t=1),this.x=(l-s)/t,this.y=(n-a)/t,this.z=(i-o)/t,this.w=Math.acos((e+r+c-1)/2),this)},kr.prototype.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},kr.prototype.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},kr.prototype.clamp=function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},kr.prototype.clampScalar=function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this},kr.prototype.clampLength=function(t,e){var o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(t,Math.min(e,o)))},kr.prototype.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},kr.prototype.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},kr.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},kr.prototype.roundToZero=function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},kr.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},kr.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},kr.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},kr.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},kr.prototype.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},kr.prototype.normalize=function(){return this.divideScalar(this.length()||1)},kr.prototype.setLength=function(t){return this.normalize().multiplyScalar(t)},kr.prototype.lerp=function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},kr.prototype.lerpVectors=function(t,e,o){return this.x=t.x+(e.x-t.x)*o,this.y=t.y+(e.y-t.y)*o,this.z=t.z+(e.z-t.z)*o,this.w=t.w+(e.w-t.w)*o,this},kr.prototype.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},kr.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},kr.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},kr.prototype.fromBufferAttribute=function(t,e,o){return void 0!==o&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this},kr.prototype.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this},Object.defineProperties(kr.prototype,Ar),n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.texture.image.width=t,this.texture.image.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),i.prototype=Object.assign(Object.create(n.prototype),{constructor:i,isWebGLMultisampleRenderTarget:!0,copy:function(t){return n.prototype.copy.call(this,t),this.samples=t.samples,this}});var Ir=function(t,e,o,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===o&&(o=0),void 0===n&&(n=1),Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=t,this._y=e,this._z=o,this._w=n},Br={x:{configurable:!0},y:{configurable:!0},z:{configurable:!0},w:{configurable:!0}};Ir.slerp=function(t,e,o,n){return o.copy(t).slerp(e,n)},Ir.slerpFlat=function(t,e,o,n,i,r,s){var a=o[n+0],l=o[n+1],c=o[n+2];o=o[n+3],n=i[r+0];var u=i[r+1],h=i[r+2];if(i=i[r+3],o!==i||a!==n||l!==u||c!==h){r=1-s;var g=a*n+l*u+c*h+o*i,p=0<=g?1:-1,d=1-g*g;d>Number.EPSILON&&(d=Math.sqrt(d),g=Math.atan2(d,g*p),r=Math.sin(r*g)/d,s=Math.sin(s*g)/d),p*=s,a=a*r+n*p,l=l*r+u*p,c=c*r+h*p,o=o*r+i*p,r===1-s&&(s=1/Math.sqrt(a*a+l*l+c*c+o*o),a*=s,l*=s,c*=s,o*=s)}t[e]=a,t[e+1]=l,t[e+2]=c,t[e+3]=o},Ir.multiplyQuaternionsFlat=function(t,e,o,n,i,r){var s=o[n],a=o[n+1],l=o[n+2];o=o[n+3],n=i[r];var c=i[r+1],u=i[r+2];return i=i[r+3],t[e]=s*i+o*n+a*u-l*c,t[e+1]=a*i+o*c+l*n-s*u,t[e+2]=l*i+o*u+s*c-a*n,t[e+3]=o*i-s*n-a*c-l*u,t},Br.x.get=function(){return this._x},Br.x.set=function(t){this._x=t,this._onChangeCallback()},Br.y.get=function(){return this._y},Br.y.set=function(t){this._y=t,this._onChangeCallback()},Br.z.get=function(){return this._z},Br.z.set=function(t){this._z=t,this._onChangeCallback()},Br.w.get=function(){return this._w},Br.w.set=function(t){this._w=t,this._onChangeCallback()},Ir.prototype.set=function(t,e,o,n){return this._x=t,this._y=e,this._z=o,this._w=n,this._onChangeCallback(),this},Ir.prototype.clone=function(){return new this.constructor(this._x,this._y,this._z,this._w)},Ir.prototype.copy=function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},Ir.prototype.setFromEuler=function(t,e){if(!t||!t.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var o=t._x,n=t._y,i=t._z;t=t._order;var r=Math.cos,s=Math.sin,a=r(o/2),l=r(n/2);switch(r=r(i/2),o=s(o/2),n=s(n/2),i=s(i/2),t){case"XYZ":this._x=o*l*r+a*n*i,this._y=a*n*r-o*l*i,this._z=a*l*i+o*n*r,this._w=a*l*r-o*n*i;break;case"YXZ":this._x=o*l*r+a*n*i,this._y=a*n*r-o*l*i,this._z=a*l*i-o*n*r,this._w=a*l*r+o*n*i;break;case"ZXY":this._x=o*l*r-a*n*i,this._y=a*n*r+o*l*i,this._z=a*l*i+o*n*r,this._w=a*l*r-o*n*i;break;case"ZYX":this._x=o*l*r-a*n*i,this._y=a*n*r+o*l*i,this._z=a*l*i-o*n*r,this._w=a*l*r+o*n*i;break;case"YZX":this._x=o*l*r+a*n*i,this._y=a*n*r+o*l*i,this._z=a*l*i-o*n*r,this._w=a*l*r-o*n*i;break;case"XZY":this._x=o*l*r-a*n*i,this._y=a*n*r-o*l*i,this._z=a*l*i+o*n*r,this._w=a*l*r+o*n*i;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+t)}return!1!==e&&this._onChangeCallback(),this},Ir.prototype.setFromAxisAngle=function(t,e){e/=2;var o=Math.sin(e);return this._x=t.x*o,this._y=t.y*o,this._z=t.z*o,this._w=Math.cos(e),this._onChangeCallback(),this},Ir.prototype.setFromRotationMatrix=function(t){var e=t.elements,o=e[0];t=e[4];var n=e[8],i=e[1],r=e[5],s=e[9],a=e[2],l=e[6];e=e[10];var c=o+r+e;return 0<c?(o=.5/Math.sqrt(c+1),this._w=.25/o,this._x=(l-s)*o,this._y=(n-a)*o,this._z=(i-t)*o):o>r&&o>e?(o=2*Math.sqrt(1+o-r-e),this._w=(l-s)/o,this._x=.25*o,this._y=(t+i)/o,this._z=(n+a)/o):r>e?(o=2*Math.sqrt(1+r-o-e),this._w=(n-a)/o,this._x=(t+i)/o,this._y=.25*o,this._z=(s+l)/o):(o=2*Math.sqrt(1+e-o-r),this._w=(i-t)/o,this._x=(n+a)/o,this._y=(s+l)/o,this._z=.25*o),this._onChangeCallback(),this},Ir.prototype.setFromUnitVectors=function(t,e){var o=t.dot(e)+1;return 1e-6>o?(o=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0):(this._x=0,this._y=-t.z,this._z=t.y)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x),this._w=o,this.normalize()},Ir.prototype.angleTo=function(t){return 2*Math.acos(Math.abs(br.clamp(this.dot(t),-1,1)))},Ir.prototype.rotateTowards=function(t,e){var o=this.angleTo(t);return 0===o?this:(this.slerp(t,Math.min(1,e/o)),this)},Ir.prototype.identity=function(){return this.set(0,0,0,1)},Ir.prototype.inverse=function(){return this.conjugate()},Ir.prototype.conjugate=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},Ir.prototype.dot=function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},Ir.prototype.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},Ir.prototype.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},Ir.prototype.normalize=function(){var t=this.length();return 0===t?(this._z=this._y=this._x=0,this._w=1):(t=1/t,this._x*=t,this._y*=t,this._z*=t,this._w*=t),this._onChangeCallback(),this},Ir.prototype.multiply=function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},Ir.prototype.premultiply=function(t){return this.multiplyQuaternions(t,this)},Ir.prototype.multiplyQuaternions=function(t,e){var o=t._x,n=t._y,i=t._z;t=t._w;var r=e._x,s=e._y,a=e._z;return e=e._w,this._x=o*e+t*r+n*a-i*s,this._y=n*e+t*s+i*r-o*a,this._z=i*e+t*a+o*s-n*r,this._w=t*e-o*r-n*s-i*a,this._onChangeCallback(),this},Ir.prototype.slerp=function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var o=this._x,n=this._y,i=this._z,r=this._w,s=r*t._w+o*t._x+n*t._y+i*t._z;if(0>s?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,s=-s):this.copy(t),1<=s)return this._w=r,this._x=o,this._y=n,this._z=i,this;if((t=1-s*s)<=Number.EPSILON)return s=1-e,this._w=s*r+e*this._w,this._x=s*o+e*this._x,this._y=s*n+e*this._y,this._z=s*i+e*this._z,this.normalize(),this._onChangeCallback(),this;t=Math.sqrt(t);var a=Math.atan2(t,s);return s=Math.sin((1-e)*a)/t,e=Math.sin(e*a)/t,this._w=r*s+this._w*e,this._x=o*s+this._x*e,this._y=n*s+this._y*e,this._z=i*s+this._z*e,this._onChangeCallback(),this},Ir.prototype.equals=function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},Ir.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},Ir.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},Ir.prototype.fromBufferAttribute=function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this},Ir.prototype._onChange=function(t){return this._onChangeCallback=t,this},Ir.prototype._onChangeCallback=function(){},Object.defineProperties(Ir.prototype,Br);var Mr=function(t,e,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===o&&(o=0),Object.defineProperty(this,"isVector3",{value:!0}),this.x=t,this.y=e,this.z=o};Mr.prototype.set=function(t,e,o){return void 0===o&&(o=this.z),this.x=t,this.y=e,this.z=o,this},Mr.prototype.setScalar=function(t){return this.z=this.y=this.x=t,this},Mr.prototype.setX=function(t){return this.x=t,this},Mr.prototype.setY=function(t){return this.y=t,this},Mr.prototype.setZ=function(t){return this.z=t,this},Mr.prototype.setComponent=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw Error("index is out of range: "+t)}return this},Mr.prototype.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+t)}},Mr.prototype.clone=function(){return new this.constructor(this.x,this.y,this.z)},Mr.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},Mr.prototype.add=function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},Mr.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this},Mr.prototype.addVectors=function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},Mr.prototype.addScaledVector=function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},Mr.prototype.sub=function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},Mr.prototype.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this},Mr.prototype.subVectors=function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},Mr.prototype.multiply=function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},Mr.prototype.multiplyScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this},Mr.prototype.multiplyVectors=function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},Mr.prototype.applyEuler=function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Nr.setFromEuler(t))},Mr.prototype.applyAxisAngle=function(t,e){return this.applyQuaternion(Nr.setFromAxisAngle(t,e))},Mr.prototype.applyMatrix3=function(t){var e=this.x,o=this.y,n=this.z;return t=t.elements,this.x=t[0]*e+t[3]*o+t[6]*n,this.y=t[1]*e+t[4]*o+t[7]*n,this.z=t[2]*e+t[5]*o+t[8]*n,this},Mr.prototype.applyNormalMatrix=function(t){return this.applyMatrix3(t).normalize()},Mr.prototype.applyMatrix4=function(t){var e=this.x,o=this.y,n=this.z;t=t.elements;var i=1/(t[3]*e+t[7]*o+t[11]*n+t[15]);return this.x=(t[0]*e+t[4]*o+t[8]*n+t[12])*i,this.y=(t[1]*e+t[5]*o+t[9]*n+t[13])*i,this.z=(t[2]*e+t[6]*o+t[10]*n+t[14])*i,this},Mr.prototype.applyQuaternion=function(t){var e=this.x,o=this.y,n=this.z,i=t.x,r=t.y,s=t.z;t=t.w;var a=t*e+r*n-s*o,l=t*o+s*e-i*n,c=t*n+i*o-r*e;return e=-i*e-r*o-s*n,this.x=a*t+e*-i+l*-s-c*-r,this.y=l*t+e*-r+c*-i-a*-s,this.z=c*t+e*-s+a*-r-l*-i,this},Mr.prototype.project=function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},Mr.prototype.unproject=function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},Mr.prototype.transformDirection=function(t){var e=this.x,o=this.y,n=this.z;return t=t.elements,this.x=t[0]*e+t[4]*o+t[8]*n,this.y=t[1]*e+t[5]*o+t[9]*n,this.z=t[2]*e+t[6]*o+t[10]*n,this.normalize()},Mr.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},Mr.prototype.divideScalar=function(t){return this.multiplyScalar(1/t)},Mr.prototype.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},Mr.prototype.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},Mr.prototype.clamp=function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},Mr.prototype.clampScalar=function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},Mr.prototype.clampLength=function(t,e){var o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(t,Math.min(e,o)))},Mr.prototype.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},Mr.prototype.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},Mr.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},Mr.prototype.roundToZero=function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},Mr.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},Mr.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},Mr.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z},Mr.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},Mr.prototype.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},Mr.prototype.normalize=function(){return this.divideScalar(this.length()||1)},Mr.prototype.setLength=function(t){return this.normalize().multiplyScalar(t)},Mr.prototype.lerp=function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},Mr.prototype.lerpVectors=function(t,e,o){return this.x=t.x+(e.x-t.x)*o,this.y=t.y+(e.y-t.y)*o,this.z=t.z+(e.z-t.z)*o,this},Mr.prototype.cross=function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},Mr.prototype.crossVectors=function(t,e){var o=t.x,n=t.y;t=t.z;var i=e.x,r=e.y;return e=e.z,this.x=n*e-t*r,this.y=t*i-o*e,this.z=o*r-n*i,this},Mr.prototype.projectOnVector=function(t){var e=t.lengthSq();return 0===e?this.set(0,0,0):(e=t.dot(this)/e,this.copy(t).multiplyScalar(e))},Mr.prototype.projectOnPlane=function(t){return Lr.copy(this).projectOnVector(t),this.sub(Lr)},Mr.prototype.reflect=function(t){return this.sub(Lr.copy(t).multiplyScalar(2*this.dot(t)))},Mr.prototype.angleTo=function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());return 0===e?Math.PI/2:(t=this.dot(t)/e,Math.acos(br.clamp(t,-1,1)))},Mr.prototype.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},Mr.prototype.distanceToSquared=function(t){var e=this.x-t.x,o=this.y-t.y;return t=this.z-t.z,e*e+o*o+t*t},Mr.prototype.manhattanDistanceTo=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},Mr.prototype.setFromSpherical=function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},Mr.prototype.setFromSphericalCoords=function(t,e,o){var n=Math.sin(e)*t;return this.x=n*Math.sin(o),this.y=Math.cos(e)*t,this.z=n*Math.cos(o),this},Mr.prototype.setFromCylindrical=function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},Mr.prototype.setFromCylindricalCoords=function(t,e,o){return this.x=t*Math.sin(e),this.y=o,this.z=t*Math.cos(e),this},Mr.prototype.setFromMatrixPosition=function(t){return t=t.elements,this.x=t[12],this.y=t[13],this.z=t[14],this},Mr.prototype.setFromMatrixScale=function(t){var e=this.setFromMatrixColumn(t,0).length(),o=this.setFromMatrixColumn(t,1).length();return t=this.setFromMatrixColumn(t,2).length(),this.x=e,this.y=o,this.z=t,this},Mr.prototype.setFromMatrixColumn=function(t,e){return this.fromArray(t.elements,4*e)},Mr.prototype.setFromMatrix3Column=function(t,e){return this.fromArray(t.elements,3*e)},Mr.prototype.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},Mr.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},Mr.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},Mr.prototype.fromBufferAttribute=function(t,e,o){return void 0!==o&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this},Mr.prototype.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this};var Lr=new Mr,Nr=new Ir,Rr=function(t,e){Object.defineProperty(this,"isBox3",{value:!0}),this.min=void 0!==t?t:new Mr(1/0,1/0,1/0),this.max=void 0!==e?e:new Mr(-1/0,-1/0,-1/0)};Rr.prototype.set=function(t,e){return this.min.copy(t),this.max.copy(e),this},Rr.prototype.setFromArray=function(t){for(var e=1/0,o=1/0,n=1/0,i=-1/0,r=-1/0,s=-1/0,a=0,l=t.length;a<l;a+=3){var c=t[a],u=t[a+1],h=t[a+2];c<e&&(e=c),u<o&&(o=u),h<n&&(n=h),c>i&&(i=c),u>r&&(r=u),h>s&&(s=h)}return this.min.set(e,o,n),this.max.set(i,r,s),this},Rr.prototype.setFromBufferAttribute=function(t){for(var e=1/0,o=1/0,n=1/0,i=-1/0,r=-1/0,s=-1/0,a=0,l=t.count;a<l;a++){var c=t.getX(a),u=t.getY(a),h=t.getZ(a);c<e&&(e=c),u<o&&(o=u),h<n&&(n=h),c>i&&(i=c),u>r&&(r=u),h>s&&(s=h)}return this.min.set(e,o,n),this.max.set(i,r,s),this},Rr.prototype.setFromPoints=function(t){this.makeEmpty();for(var e=0,o=t.length;e<o;e++)this.expandByPoint(t[e]);return this},Rr.prototype.setFromCenterAndSize=function(t,e){return e=Or.copy(e).multiplyScalar(.5),this.min.copy(t).sub(e),this.max.copy(t).add(e),this},Rr.prototype.setFromObject=function(t){return this.makeEmpty(),this.expandByObject(t)},Rr.prototype.clone=function(){return(new this.constructor).copy(this)},Rr.prototype.copy=function(t){return this.min.copy(t.min),this.max.copy(t.max),this},Rr.prototype.makeEmpty=function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},Rr.prototype.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},Rr.prototype.getCenter=function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new Mr),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},Rr.prototype.getSize=function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new Mr),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},Rr.prototype.expandByPoint=function(t){return this.min.min(t),this.max.max(t),this},Rr.prototype.expandByVector=function(t){return this.min.sub(t),this.max.add(t),this},Rr.prototype.expandByScalar=function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},Rr.prototype.expandByObject=function(t){t.updateWorldMatrix(!1,!1);var e=t.geometry;void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),Pr.copy(e.boundingBox),Pr.applyMatrix4(t.matrixWorld),this.union(Pr)),t=t.children,e=0;for(var o=t.length;e<o;e++)this.expandByObject(t[e]);return this},Rr.prototype.containsPoint=function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},Rr.prototype.containsBox=function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},Rr.prototype.getParameter=function(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new Mr),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},Rr.prototype.intersectsBox=function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},Rr.prototype.intersectsSphere=function(t){return this.clampPoint(t.center,Or),Or.distanceToSquared(t.center)<=t.radius*t.radius},Rr.prototype.intersectsPlane=function(t){if(0<t.normal.x)var e=t.normal.x*this.min.x,o=t.normal.x*this.max.x;else e=t.normal.x*this.max.x,o=t.normal.x*this.min.x;return 0<t.normal.y?(e+=t.normal.y*this.min.y,o+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,o+=t.normal.y*this.min.y),0<t.normal.z?(e+=t.normal.z*this.min.z,o+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,o+=t.normal.z*this.min.z),e<=-t.constant&&o>=-t.constant},Rr.prototype.intersectsTriangle=function(t){return!this.isEmpty()&&(this.getCenter(Wr),zr.subVectors(this.max,Wr),jr.subVectors(t.a,Wr),Fr.subVectors(t.b,Wr),Hr.subVectors(t.c,Wr),Ur.subVectors(Fr,jr),Gr.subVectors(Hr,Fr),Vr.subVectors(jr,Hr),t=[0,-Ur.z,Ur.y,0,-Gr.z,Gr.y,0,-Vr.z,Vr.y,Ur.z,0,-Ur.x,Gr.z,0,-Gr.x,Vr.z,0,-Vr.x,-Ur.y,Ur.x,0,-Gr.y,Gr.x,0,-Vr.y,Vr.x,0],!!r(t,jr,Fr,Hr,zr)&&(t=[1,0,0,0,1,0,0,0,1],!!r(t,jr,Fr,Hr,zr)&&(qr.crossVectors(Ur,Gr),t=[qr.x,qr.y,qr.z],r(t,jr,Fr,Hr,zr))))},Rr.prototype.clampPoint=function(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new Mr),e.copy(t).clamp(this.min,this.max)},Rr.prototype.distanceToPoint=function(t){return Or.copy(t).clamp(this.min,this.max).sub(t).length()},Rr.prototype.getBoundingSphere=function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(Or).length(),t},Rr.prototype.intersect=function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},Rr.prototype.union=function(t){return this.min.min(t.min),this.max.max(t.max),this},Rr.prototype.applyMatrix4=function(t){return this.isEmpty()?this:(Dr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Dr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Dr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Dr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Dr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Dr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Dr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Dr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Dr),this)},Rr.prototype.translate=function(t){return this.min.add(t),this.max.add(t),this},Rr.prototype.equals=function(t){return t.min.equals(this.min)&&t.max.equals(this.max)};var Dr=[new Mr,new Mr,new Mr,new Mr,new Mr,new Mr,new Mr,new Mr],Or=new Mr,Pr=new Rr,jr=new Mr,Fr=new Mr,Hr=new Mr,Ur=new Mr,Gr=new Mr,Vr=new Mr,Wr=new Mr,zr=new Mr,qr=new Mr,Xr=new Mr,Yr=new Rr,Kr=function(t,e){this.center=void 0!==t?t:new Mr,this.radius=void 0!==e?e:-1};Kr.prototype.set=function(t,e){return this.center.copy(t),this.radius=e,this},Kr.prototype.setFromPoints=function(t,e){var o=this.center;void 0!==e?o.copy(e):Yr.setFromPoints(t).getCenter(o);for(var n=e=0,i=t.length;n<i;n++)e=Math.max(e,o.distanceToSquared(t[n]));return this.radius=Math.sqrt(e),this},Kr.prototype.clone=function(){return(new this.constructor).copy(this)},Kr.prototype.copy=function(t){return this.center.copy(t.center),this.radius=t.radius,this},Kr.prototype.isEmpty=function(){return 0>this.radius},Kr.prototype.makeEmpty=function(){return this.center.set(0,0,0),this.radius=-1,this},Kr.prototype.containsPoint=function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},Kr.prototype.distanceToPoint=function(t){return t.distanceTo(this.center)-this.radius},Kr.prototype.intersectsSphere=function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},Kr.prototype.intersectsBox=function(t){return t.intersectsSphere(this)},Kr.prototype.intersectsPlane=function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},Kr.prototype.clampPoint=function(t,e){var o=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new Mr),e.copy(t),o>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},Kr.prototype.getBoundingBox=function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new Rr),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)},Kr.prototype.applyMatrix4=function(t){return this.center.applyMatrix4(t),this.radius*=t.getMaxScaleOnAxis(),this},Kr.prototype.translate=function(t){return this.center.add(t),this},Kr.prototype.equals=function(t){return t.center.equals(this.center)&&t.radius===this.radius};var $r=new Mr,Qr=new Mr,Jr=new Mr,Zr=new Mr,ts=new Mr,es=new Mr,os=new Mr,ns=function(t,e){this.origin=void 0!==t?t:new Mr,this.direction=void 0!==e?e:new Mr(0,0,-1)};ns.prototype.set=function(t,e){return this.origin.copy(t),this.direction.copy(e),this},ns.prototype.clone=function(){return(new this.constructor).copy(this)},ns.prototype.copy=function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},ns.prototype.at=function(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new Mr),e.copy(this.direction).multiplyScalar(t).add(this.origin)},ns.prototype.lookAt=function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},ns.prototype.recast=function(t){return this.origin.copy(this.at(t,$r)),this},ns.prototype.closestPointToPoint=function(t,e){return void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new Mr),e.subVectors(t,this.origin),t=e.dot(this.direction),0>t?e.copy(this.origin):e.copy(this.direction).multiplyScalar(t).add(this.origin)},ns.prototype.distanceToPoint=function(t){return Math.sqrt(this.distanceSqToPoint(t))},ns.prototype.distanceSqToPoint=function(t){var e=$r.subVectors(t,this.origin).dot(this.direction);return 0>e?this.origin.distanceToSquared(t):($r.copy(this.direction).multiplyScalar(e).add(this.origin),$r.distanceToSquared(t))},ns.prototype.distanceSqToSegment=function(t,e,o,n){Qr.copy(t).add(e).multiplyScalar(.5),Jr.copy(e).sub(t).normalize(),Zr.copy(this.origin).sub(Qr);var i=.5*t.distanceTo(e),r=-this.direction.dot(Jr),s=Zr.dot(this.direction),a=-Zr.dot(Jr),l=Zr.lengthSq(),c=Math.abs(1-r*r);if(0<c){t=r*a-s,e=r*s-a;var u=i*c;0<=t?e>=-u?e<=u?(i=1/c,t*=i,e*=i,r=t*(t+r*e+2*s)+e*(r*t+e+2*a)+l):(e=i,t=Math.max(0,-(r*e+s)),r=-t*t+e*(e+2*a)+l):(e=-i,t=Math.max(0,-(r*e+s)),r=-t*t+e*(e+2*a)+l):e<=-u?(t=Math.max(0,-(-r*i+s)),e=0<t?-i:Math.min(Math.max(-i,-a),i),r=-t*t+e*(e+2*a)+l):e<=u?(t=0,e=Math.min(Math.max(-i,-a),i),r=e*(e+2*a)+l):(t=Math.max(0,-(r*i+s)),e=0<t?i:Math.min(Math.max(-i,-a),i),r=-t*t+e*(e+2*a)+l)}else e=0<r?-i:i,t=Math.max(0,-(r*e+s)),r=-t*t+e*(e+2*a)+l;return o&&o.copy(this.direction).multiplyScalar(t).add(this.origin),n&&n.copy(Jr).multiplyScalar(e).add(Qr),r},ns.prototype.intersectSphere=function(t,e){$r.subVectors(t.center,this.origin);var o=$r.dot(this.direction),n=$r.dot($r)-o*o;return t=t.radius*t.radius,n>t?null:(t=Math.sqrt(t-n),n=o-t,o+=t,0>n&&0>o?null:0>n?this.at(o,e):this.at(n,e))},ns.prototype.intersectsSphere=function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},ns.prototype.distanceToPlane=function(t){var e=t.normal.dot(this.direction);return 0===e?0===t.distanceToPoint(this.origin)?0:null:(t=-(this.origin.dot(t.normal)+t.constant)/e,0<=t?t:null)},ns.prototype.intersectPlane=function(t,e){return t=this.distanceToPlane(t),null===t?null:this.at(t,e)},ns.prototype.intersectsPlane=function(t){var e=t.distanceToPoint(this.origin);return 0===e||0>t.normal.dot(this.direction)*e},ns.prototype.intersectBox=function(t,e){var o=1/this.direction.x,n=1/this.direction.y,i=1/this.direction.z,r=this.origin;if(0<=o){var s=(t.min.x-r.x)*o;o*=t.max.x-r.x}else s=(t.max.x-r.x)*o,o*=t.min.x-r.x;if(0<=n){var a=(t.min.y-r.y)*n;n*=t.max.y-r.y}else a=(t.max.y-r.y)*n,n*=t.min.y-r.y;return s>n||a>o?null:((a>s||s!==s)&&(s=a),(n<o||o!==o)&&(o=n),0<=i?(a=(t.min.z-r.z)*i,t=(t.max.z-r.z)*i):(a=(t.max.z-r.z)*i,t=(t.min.z-r.z)*i),s>t||a>o?null:((a>s||s!==s)&&(s=a),(t<o||o!==o)&&(o=t),0>o?null:this.at(0<=s?s:o,e)))},ns.prototype.intersectsBox=function(t){return null!==this.intersectBox(t,$r)},ns.prototype.intersectTriangle=function(t,e,o,n,i){if(ts.subVectors(e,t),es.subVectors(o,t),os.crossVectors(ts,es),0<(e=this.direction.dot(os))){if(n)return null;n=1}else{if(!(0>e))return null;n=-1,e=-e}return Zr.subVectors(this.origin,t),0>(t=n*this.direction.dot(es.crossVectors(Zr,es)))?null:0>(o=n*this.direction.dot(ts.cross(Zr)))||t+o>e?null:(t=-n*Zr.dot(os),0>t?null:this.at(t/e,i))},ns.prototype.applyMatrix4=function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},ns.prototype.equals=function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)};var is=function(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")};is.prototype.set=function(t,e,o,n,i,r,s,a,l,c,u,h,g,p,d,f){var m=this.elements;return m[0]=t,m[4]=e,m[8]=o,m[12]=n,m[1]=i,m[5]=r,m[9]=s,m[13]=a,m[2]=l,m[6]=c,m[10]=u,m[14]=h,m[3]=g,m[7]=p,m[11]=d,m[15]=f,this},is.prototype.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},is.prototype.clone=function(){return(new is).fromArray(this.elements)},is.prototype.copy=function(t){var e=this.elements;return t=t.elements,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],this},is.prototype.copyPosition=function(t){var e=this.elements;return t=t.elements,e[12]=t[12],e[13]=t[13],e[14]=t[14],this},is.prototype.extractBasis=function(t,e,o){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),o.setFromMatrixColumn(this,2),this},is.prototype.makeBasis=function(t,e,o){return this.set(t.x,e.x,o.x,0,t.y,e.y,o.y,0,t.z,e.z,o.z,0,0,0,0,1),this},is.prototype.extractRotation=function(t){var e=this.elements,o=t.elements,n=1/rs.setFromMatrixColumn(t,0).length(),i=1/rs.setFromMatrixColumn(t,1).length();return t=1/rs.setFromMatrixColumn(t,2).length(),e[0]=o[0]*n,e[1]=o[1]*n,e[2]=o[2]*n,e[3]=0,e[4]=o[4]*i,e[5]=o[5]*i,e[6]=o[6]*i,e[7]=0,e[8]=o[8]*t,e[9]=o[9]*t,e[10]=o[10]*t,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},is.prototype.makeRotationFromEuler=function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,o=t.x,n=t.y,i=t.z,r=Math.cos(o);o=Math.sin(o);var s=Math.cos(n);n=Math.sin(n);var a=Math.cos(i);if(i=Math.sin(i),"XYZ"===t.order){t=r*a;var l=r*i,c=o*a,u=o*i;e[0]=s*a,e[4]=-s*i,e[8]=n,e[1]=l+c*n,e[5]=t-u*n,e[9]=-o*s,e[2]=u-t*n,e[6]=c+l*n,e[10]=r*s}else"YXZ"===t.order?(t=s*a,l=s*i,c=n*a,u=n*i,e[0]=t+u*o,e[4]=c*o-l,e[8]=r*n,e[1]=r*i,e[5]=r*a,e[9]=-o,e[2]=l*o-c,e[6]=u+t*o,e[10]=r*s):"ZXY"===t.order?(t=s*a,l=s*i,c=n*a,u=n*i,e[0]=t-u*o,e[4]=-r*i,e[8]=c+l*o,e[1]=l+c*o,e[5]=r*a,e[9]=u-t*o,e[2]=-r*n,e[6]=o,e[10]=r*s):"ZYX"===t.order?(t=r*a,l=r*i,c=o*a,u=o*i,e[0]=s*a,e[4]=c*n-l,e[8]=t*n+u,e[1]=s*i,e[5]=u*n+t,e[9]=l*n-c,e[2]=-n,e[6]=o*s,e[10]=r*s):"YZX"===t.order?(t=r*s,l=r*n,c=o*s,u=o*n,e[0]=s*a,e[4]=u-t*i,e[8]=c*i+l,e[1]=i,e[5]=r*a,e[9]=-o*a,e[2]=-n*a,e[6]=l*i+c,e[10]=t-u*i):"XZY"===t.order&&(t=r*s,l=r*n,c=o*s,u=o*n,e[0]=s*a,e[4]=-i,e[8]=n*a,e[1]=t*i+u,e[5]=r*a,e[9]=l*i-c,e[2]=c*i-l,e[6]=o*a,e[10]=u*i+t);return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},is.prototype.makeRotationFromQuaternion=function(t){return this.compose(as,t,ls)},is.prototype.lookAt=function(t,e,o){var n=this.elements;return hs.subVectors(t,e),0===hs.lengthSq()&&(hs.z=1),hs.normalize(),cs.crossVectors(o,hs),0===cs.lengthSq()&&(1===Math.abs(o.z)?hs.x+=1e-4:hs.z+=1e-4,hs.normalize(),cs.crossVectors(o,hs)),cs.normalize(),us.crossVectors(hs,cs),n[0]=cs.x,n[4]=us.x,n[8]=hs.x,n[1]=cs.y,n[5]=us.y,n[9]=hs.y,n[2]=cs.z,n[6]=us.z,n[10]=hs.z,this},is.prototype.multiply=function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},is.prototype.premultiply=function(t){return this.multiplyMatrices(t,this)},is.prototype.multiplyMatrices=function(t,e){var o=t.elements,n=e.elements;e=this.elements,t=o[0];var i=o[4],r=o[8],s=o[12],a=o[1],l=o[5],c=o[9],u=o[13],h=o[2],g=o[6],p=o[10],d=o[14],f=o[3],m=o[7],y=o[11];o=o[15];var v=n[0],_=n[4],b=n[8],E=n[12],x=n[1],S=n[5],T=n[9],w=n[13],C=n[2],k=n[6],A=n[10],I=n[14],B=n[3],M=n[7],L=n[11];return n=n[15],e[0]=t*v+i*x+r*C+s*B,e[4]=t*_+i*S+r*k+s*M,e[8]=t*b+i*T+r*A+s*L,e[12]=t*E+i*w+r*I+s*n,e[1]=a*v+l*x+c*C+u*B,e[5]=a*_+l*S+c*k+u*M,e[9]=a*b+l*T+c*A+u*L,e[13]=a*E+l*w+c*I+u*n,e[2]=h*v+g*x+p*C+d*B,e[6]=h*_+g*S+p*k+d*M,e[10]=h*b+g*T+p*A+d*L,e[14]=h*E+g*w+p*I+d*n,e[3]=f*v+m*x+y*C+o*B,e[7]=f*_+m*S+y*k+o*M,e[11]=f*b+m*T+y*A+o*L,e[15]=f*E+m*w+y*I+o*n,this},is.prototype.multiplyScalar=function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},is.prototype.determinant=function(){var t=this.elements,e=t[0],o=t[4],n=t[8],i=t[12],r=t[1],s=t[5],a=t[9],l=t[13],c=t[2],u=t[6],h=t[10],g=t[14];return t[3]*(+i*a*u-n*l*u-i*s*h+o*l*h+n*s*g-o*a*g)+t[7]*(+e*a*g-e*l*h+i*r*h-n*r*g+n*l*c-i*a*c)+t[11]*(+e*l*u-e*s*g-i*r*u+o*r*g+i*s*c-o*l*c)+t[15]*(-n*s*c-e*a*u+e*s*h+n*r*u-o*r*h+o*a*c)},is.prototype.transpose=function(){var t=this.elements,e=t[1];return t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},is.prototype.setPosition=function(t,e,o){var n=this.elements;return t.isVector3?(n[12]=t.x,n[13]=t.y,n[14]=t.z):(n[12]=t,n[13]=e,n[14]=o),this},is.prototype.getInverse=function(t,e){void 0!==e&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate."),e=this.elements;var o=t.elements;t=o[0];var n=o[1],i=o[2],r=o[3],s=o[4],a=o[5],l=o[6],c=o[7],u=o[8],h=o[9],g=o[10],p=o[11],d=o[12],f=o[13],m=o[14];o=o[15];var y=h*m*c-f*g*c+f*l*p-a*m*p-h*l*o+a*g*o,v=d*g*c-u*m*c-d*l*p+s*m*p+u*l*o-s*g*o,_=u*f*c-d*h*c+d*a*p-s*f*p-u*a*o+s*h*o,b=d*h*l-u*f*l-d*a*g+s*f*g+u*a*m-s*h*m,E=t*y+n*v+i*_+r*b;return 0===E?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(E=1/E,e[0]=y*E,e[1]=(f*g*r-h*m*r-f*i*p+n*m*p+h*i*o-n*g*o)*E,e[2]=(a*m*r-f*l*r+f*i*c-n*m*c-a*i*o+n*l*o)*E,e[3]=(h*l*r-a*g*r-h*i*c+n*g*c+a*i*p-n*l*p)*E,e[4]=v*E,e[5]=(u*m*r-d*g*r+d*i*p-t*m*p-u*i*o+t*g*o)*E,e[6]=(d*l*r-s*m*r-d*i*c+t*m*c+s*i*o-t*l*o)*E,e[7]=(s*g*r-u*l*r+u*i*c-t*g*c-s*i*p+t*l*p)*E,e[8]=_*E,e[9]=(d*h*r-u*f*r-d*n*p+t*f*p+u*n*o-t*h*o)*E,e[10]=(s*f*r-d*a*r+d*n*c-t*f*c-s*n*o+t*a*o)*E,e[11]=(u*a*r-s*h*r-u*n*c+t*h*c+s*n*p-t*a*p)*E,e[12]=b*E,e[13]=(u*f*i-d*h*i+d*n*g-t*f*g-u*n*m+t*h*m)*E,e[14]=(d*a*i-s*f*i-d*n*l+t*f*l+s*n*m-t*a*m)*E,e[15]=(s*h*i-u*a*i+u*n*l-t*h*l-s*n*g+t*a*g)*E,this)},is.prototype.scale=function(t){var e=this.elements,o=t.x,n=t.y;return t=t.z,e[0]*=o,e[4]*=n,e[8]*=t,e[1]*=o,e[5]*=n,e[9]*=t,e[2]*=o,e[6]*=n,e[10]*=t,e[3]*=o,e[7]*=n,e[11]*=t,this},is.prototype.getMaxScaleOnAxis=function(){var t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))},is.prototype.makeTranslation=function(t,e,o){return this.set(1,0,0,t,0,1,0,e,0,0,1,o,0,0,0,1),this},is.prototype.makeRotationX=function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(1,0,0,0,0,e,-t,0,0,t,e,0,0,0,0,1),this},is.prototype.makeRotationY=function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,0,t,0,0,1,0,0,-t,0,e,0,0,0,0,1),this},is.prototype.makeRotationZ=function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,-t,0,0,t,e,0,0,0,0,1,0,0,0,0,1),this},is.prototype.makeRotationAxis=function(t,e){var o=Math.cos(e);e=Math.sin(e);var n=1-o,i=t.x,r=t.y;t=t.z;var s=n*i,a=n*r;return this.set(s*i+o,s*r-e*t,s*t+e*r,0,s*r+e*t,a*r+o,a*t-e*i,0,s*t-e*r,a*t+e*i,n*t*t+o,0,0,0,0,1),this},is.prototype.makeScale=function(t,e,o){return this.set(t,0,0,0,0,e,0,0,0,0,o,0,0,0,0,1),this},is.prototype.makeShear=function(t,e,o){return this.set(1,e,o,0,t,1,o,0,t,e,1,0,0,0,0,1),this},is.prototype.compose=function(t,e,o){var n=this.elements,i=e._x,r=e._y,s=e._z,a=e._w,l=i+i,c=r+r,u=s+s;e=i*l;var h=i*c;i*=u;var g=r*c;r*=u,s*=u,l*=a,c*=a,a*=u,u=o.x;var p=o.y;return o=o.z,n[0]=(1-(g+s))*u,n[1]=(h+a)*u,n[2]=(i-c)*u,n[3]=0,n[4]=(h-a)*p,n[5]=(1-(e+s))*p,n[6]=(r+l)*p,n[7]=0,n[8]=(i+c)*o,n[9]=(r-l)*o,n[10]=(1-(e+g))*o,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this},is.prototype.decompose=function(t,e,o){var n=this.elements,i=rs.set(n[0],n[1],n[2]).length(),r=rs.set(n[4],n[5],n[6]).length(),s=rs.set(n[8],n[9],n[10]).length();0>this.determinant()&&(i=-i),t.x=n[12],t.y=n[13],t.z=n[14],ss.copy(this),t=1/i,n=1/r;var a=1/s;return ss.elements[0]*=t,ss.elements[1]*=t,ss.elements[2]*=t,ss.elements[4]*=n,ss.elements[5]*=n,ss.elements[6]*=n,ss.elements[8]*=a,ss.elements[9]*=a,ss.elements[10]*=a,e.setFromRotationMatrix(ss),o.x=i,o.y=r,o.z=s,this},is.prototype.makePerspective=function(t,e,o,n,i,r){void 0===r&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var s=this.elements;return s[0]=2*i/(e-t),s[4]=0,s[8]=(e+t)/(e-t),s[12]=0,s[1]=0,s[5]=2*i/(o-n),s[9]=(o+n)/(o-n),s[13]=0,s[2]=0,s[6]=0,s[10]=-(r+i)/(r-i),s[14]=-2*r*i/(r-i),s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this},is.prototype.makeOrthographic=function(t,e,o,n,i,r){var s=this.elements,a=1/(e-t),l=1/(o-n),c=1/(r-i);return s[0]=2*a,s[4]=0,s[8]=0,s[12]=-(e+t)*a,s[1]=0,s[5]=2*l,s[9]=0,s[13]=-(o+n)*l,s[2]=0,s[6]=0,s[10]=-2*c,s[14]=-(r+i)*c,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this},is.prototype.equals=function(t){var e=this.elements;t=t.elements;for(var o=0;16>o;o++)if(e[o]!==t[o])return!1;return!0},is.prototype.fromArray=function(t,e){void 0===e&&(e=0);for(var o=0;16>o;o++)this.elements[o]=t[o+e];return this},is.prototype.toArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var o=this.elements;return t[e]=o[0],t[e+1]=o[1],t[e+2]=o[2],t[e+3]=o[3],t[e+4]=o[4],t[e+5]=o[5],t[e+6]=o[6],t[e+7]=o[7],t[e+8]=o[8],t[e+9]=o[9],t[e+10]=o[10],t[e+11]=o[11],t[e+12]=o[12],t[e+13]=o[13],t[e+14]=o[14],t[e+15]=o[15],t};var rs=new Mr,ss=new is,as=new Mr(0,0,0),ls=new Mr(1,1,1),cs=new Mr,us=new Mr,hs=new Mr,gs=function t(e,o,n,i){void 0===e&&(e=0),void 0===o&&(o=0),void 0===n&&(n=0),void 0===i&&(i=t.DefaultOrder),Object.defineProperty(this,"isEuler",{value:!0}),this._x=e,this._y=o,this._z=n,this._order=i},ps={x:{configurable:!0},y:{configurable:!0},z:{configurable:!0},order:{configurable:!0}};ps.x.get=function(){return this._x},ps.x.set=function(t){this._x=t,this._onChangeCallback()},ps.y.get=function(){return this._y},ps.y.set=function(t){this._y=t,this._onChangeCallback()},ps.z.get=function(){return this._z},ps.z.set=function(t){this._z=t,this._onChangeCallback()},ps.order.get=function(){return this._order},ps.order.set=function(t){this._order=t,this._onChangeCallback()},gs.prototype.set=function(t,e,o,n){return this._x=t,this._y=e,this._z=o,this._order=n||this._order,this._onChangeCallback(),this},gs.prototype.clone=function(){return new this.constructor(this._x,this._y,this._z,this._order)},gs.prototype.copy=function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},gs.prototype.setFromRotationMatrix=function(t,e,o){var n=br.clamp,i=t.elements;t=i[0];var r=i[4],s=i[8],a=i[1],l=i[5],c=i[9],u=i[2],h=i[6];switch(i=i[10],e=e||this._order){case"XYZ":this._y=Math.asin(n(s,-1,1)),.9999999>Math.abs(s)?(this._x=Math.atan2(-c,i),this._z=Math.atan2(-r,t)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-n(c,-1,1)),.9999999>Math.abs(c)?(this._y=Math.atan2(s,i),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-u,t),this._z=0);break;case"ZXY":this._x=Math.asin(n(h,-1,1)),.9999999>Math.abs(h)?(this._y=Math.atan2(-u,i),this._z=Math.atan2(-r,l)):(this._y=0,this._z=Math.atan2(a,t));break;case"ZYX":this._y=Math.asin(-n(u,-1,1)),.9999999>Math.abs(u)?(this._x=Math.atan2(h,i),this._z=Math.atan2(a,t)):(this._x=0,this._z=Math.atan2(-r,l));break;case"YZX":this._z=Math.asin(n(a,-1,1)),.9999999>Math.abs(a)?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,t)):(this._x=0,this._y=Math.atan2(s,i));break;case"XZY":this._z=Math.asin(-n(r,-1,1)),.9999999>Math.abs(r)?(this._x=Math.atan2(h,l),this._y=Math.atan2(s,t)):(this._x=Math.atan2(-c,i),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!1!==o&&this._onChangeCallback(),this},gs.prototype.setFromQuaternion=function(t,e,o){return ds.makeRotationFromQuaternion(t),this.setFromRotationMatrix(ds,e,o)},gs.prototype.setFromVector3=function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},gs.prototype.reorder=function(t){return fs.setFromEuler(this),this.setFromQuaternion(fs,t)},gs.prototype.equals=function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},gs.prototype.fromArray=function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},gs.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},gs.prototype.toVector3=function(t){return t?t.set(this._x,this._y,this._z):new Mr(this._x,this._y,this._z)},gs.prototype._onChange=function(t){return this._onChangeCallback=t,this},gs.prototype._onChangeCallback=function(){},Object.defineProperties(gs.prototype,ps),gs.DefaultOrder="XYZ",gs.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");var ds=new is,fs=new Ir,ms=function(){this.mask=1};ms.prototype.set=function(t){this.mask=1<<t|0},ms.prototype.enable=function(t){this.mask=this.mask|1<<t|0},ms.prototype.enableAll=function(){this.mask=-1},ms.prototype.toggle=function(t){this.mask^=1<<t|0},ms.prototype.disable=function(t){this.mask&=~(1<<t|0)},ms.prototype.disableAll=function(){this.mask=0},ms.prototype.test=function(t){return 0!=(this.mask&t.mask)};var ys=0,vs=new Mr,_s=new Ir,bs=new is,Es=new Mr,xs=new Mr,Ss=new Mr,Ts=new Ir,ws=new Mr(1,0,0),Cs=new Mr(0,1,0),ks=new Mr(0,0,1),As={type:"added"},Is={type:"removed"};s.DefaultUp=new Mr(0,1,0),s.DefaultMatrixAutoUpdate=!0,s.prototype=Object.assign(Object.create(e.prototype),{constructor:s,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return _s.setFromAxisAngle(t,e),this.quaternion.multiply(_s),this},rotateOnWorldAxis:function(t,e){return _s.setFromAxisAngle(t,e),this.quaternion.premultiply(_s),this},rotateX:function(t){return this.rotateOnAxis(ws,t)},rotateY:function(t){return this.rotateOnAxis(Cs,t)},rotateZ:function(t){return this.rotateOnAxis(ks,t)},translateOnAxis:function(t,e){return vs.copy(t).applyQuaternion(this.quaternion),this.position.add(vs.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(ws,t)},translateY:function(t){return this.translateOnAxis(Cs,t)},translateZ:function(t){return this.translateOnAxis(ks,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(bs.getInverse(this.matrixWorld))},lookAt:function(t,e,o){t.isVector3?Es.copy(t):Es.set(t,e,o),t=this.parent,this.updateWorldMatrix(!0,!1),xs.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?bs.lookAt(xs,Es,this.up):bs.lookAt(Es,xs,this.up),this.quaternion.setFromRotationMatrix(bs),t&&(bs.extractRotation(t.matrixWorld),_s.setFromRotationMatrix(bs),this.quaternion.premultiply(_s.inverse()))},add:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(As)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}return e=this.children.indexOf(t),-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(Is)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),bs.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),bs.multiply(t.parent.matrixWorld)),t.applyMatrix4(bs),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var o=0,n=this.children.length;o<n;o++){var i=this.children[o].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new Mr),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new Ir),this.updateMatrixWorld(!0),this.matrixWorld.decompose(xs,t,Ss),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new Mr),this.updateMatrixWorld(!0),this.matrixWorld.decompose(xs,Ts,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new Mr),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,o=0,n=e.length;o<n;o++)e[o].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,o=0,n=e.length;o<n;o++)e[o].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,o=0,n=e.length;o<n;o++)e[o].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var o=this.parent;if(!0===t&&null!==o&&o.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(t=this.children,e=0,o=t.length;e<o;e++)t[e].updateWorldMatrix(!1,!0)},toJSON:function(t){function e(e,o){return void 0===e[o.uuid]&&(e[o.uuid]=o.toJSON(t)),o.uuid}function o(t){var e,o=[];for(e in t){var n=t[e];delete n.metadata,o.push(n)}return o}var n=void 0===t||"string"==typeof t,i={};n&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){r.geometry=e(t.geometries,this.geometry);var s=this.geometry.parameters;if(void 0!==s&&void 0!==s.shapes)if(s=s.shapes,Array.isArray(s))for(var a=0,l=s.length;a<l;a++)e(t.shapes,s[a]);else e(t.shapes,s)}if(void 0!==this.material)if(Array.isArray(this.material)){for(s=[],a=0,l=this.material.length;a<l;a++)s.push(e(t.materials,this.material[a]));r.material=s}else r.material=e(t.materials,this.material);if(0<this.children.length)for(r.children=[],s=0;s<this.children.length;s++)r.children.push(this.children[s].toJSON(t).object);if(n){n=o(t.geometries),s=o(t.materials),a=o(t.textures),l=o(t.images);var c=o(t.shapes);0<n.length&&(i.geometries=n),0<s.length&&(i.materials=s),0<a.length&&(i.textures=a),0<l.length&&(i.images=l),0<c.length&&(i.shapes=c)}return i.object=r,i},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(e=0;e<t.children.length;e++)this.add(t.children[e].clone());return this}});var Bs=new Mr,Ms=new Mr,Ls=new Sr,Ns=function(t,e){Object.defineProperty(this,"isPlane",{value:!0}),this.normal=void 0!==t?t:new Mr(1,0,0),this.constant=void 0!==e?e:0};Ns.prototype.set=function(t,e){return this.normal.copy(t),this.constant=e,this},Ns.prototype.setComponents=function(t,e,o,n){return this.normal.set(t,e,o),this.constant=n,this},Ns.prototype.setFromNormalAndCoplanarPoint=function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},Ns.prototype.setFromCoplanarPoints=function(t,e,o){return e=Bs.subVectors(o,e).cross(Ms.subVectors(t,e)).normalize(),this.setFromNormalAndCoplanarPoint(e,t),this},Ns.prototype.clone=function(){return(new this.constructor).copy(this)},Ns.prototype.copy=function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},Ns.prototype.normalize=function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},Ns.prototype.negate=function(){return this.constant*=-1,this.normal.negate(),this},Ns.prototype.distanceToPoint=function(t){return this.normal.dot(t)+this.constant},Ns.prototype.distanceToSphere=function(t){return this.distanceToPoint(t.center)-t.radius},Ns.prototype.projectPoint=function(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new Mr),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},Ns.prototype.intersectLine=function(t,e){void 0===e&&(console.warn("THREE.Plane: .intersectLine() target is now required"),e=new Mr);var o=t.delta(Bs),n=this.normal.dot(o);if(0===n){if(0===this.distanceToPoint(t.start))return e.copy(t.start)}else if(!(0>(n=-(t.start.dot(this.normal)+this.constant)/n)||1<n))return e.copy(o).multiplyScalar(n).add(t.start)},Ns.prototype.intersectsLine=function(t){var e=this.distanceToPoint(t.start);return t=this.distanceToPoint(t.end),0>e&&0<t||0>t&&0<e},Ns.prototype.intersectsBox=function(t){return t.intersectsPlane(this)},Ns.prototype.intersectsSphere=function(t){return t.intersectsPlane(this)},Ns.prototype.coplanarPoint=function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new Mr),t.copy(this.normal).multiplyScalar(-this.constant)},Ns.prototype.applyMatrix4=function(t,e){return e=e||Ls.getNormalMatrix(t),t=this.coplanarPoint(Bs).applyMatrix4(t),e=this.normal.applyMatrix3(e).normalize(),this.constant=-t.dot(e),this},Ns.prototype.translate=function(t){return this.constant-=t.dot(this.normal),this},Ns.prototype.equals=function(t){return t.normal.equals(this.normal)&&t.constant===this.constant};var Rs=new Mr,Ds=new Mr,Os=new Mr,Ps=new Mr,js=new Mr,Fs=new Mr,Hs=new Mr,Us=new Mr,Gs=new Mr,Vs=new Mr,Ws=function(t,e,o){this.a=void 0!==t?t:new Mr,this.b=void 0!==e?e:new Mr,this.c=void 0!==o?o:new Mr};Ws.getNormal=function(t,e,o,n){return void 0===n&&(console.warn("THREE.Triangle: .getNormal() target is now required"),n=new Mr),n.subVectors(o,e),Rs.subVectors(t,e),n.cross(Rs),t=n.lengthSq(),0<t?n.multiplyScalar(1/Math.sqrt(t)):n.set(0,0,0)},Ws.getBarycoord=function(t,e,o,n,i){Rs.subVectors(n,e),Ds.subVectors(o,e),Os.subVectors(t,e),t=Rs.dot(Rs),e=Rs.dot(Ds),o=Rs.dot(Os);var r=Ds.dot(Ds);n=Ds.dot(Os);var s=t*r-e*e;return void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new Mr),0===s?i.set(-2,-1,-1):(s=1/s,r=(r*o-e*n)*s,t=(t*n-e*o)*s,i.set(1-r-t,t,r))},Ws.containsPoint=function(t,e,o,n){return this.getBarycoord(t,e,o,n,Ps),0<=Ps.x&&0<=Ps.y&&1>=Ps.x+Ps.y},Ws.getUV=function(t,e,o,n,i,r,s,a){return this.getBarycoord(t,e,o,n,Ps),a.set(0,0),a.addScaledVector(i,Ps.x),a.addScaledVector(r,Ps.y),a.addScaledVector(s,Ps.z),a},Ws.isFrontFacing=function(t,e,o,n){return Rs.subVectors(o,e),Ds.subVectors(t,e),0>Rs.cross(Ds).dot(n)},Ws.prototype.set=function(t,e,o){return this.a.copy(t),this.b.copy(e),this.c.copy(o),this},Ws.prototype.setFromPointsAndIndices=function(t,e,o,n){return this.a.copy(t[e]),this.b.copy(t[o]),this.c.copy(t[n]),this},Ws.prototype.clone=function(){return(new this.constructor).copy(this)},Ws.prototype.copy=function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},Ws.prototype.getArea=function(){return Rs.subVectors(this.c,this.b),Ds.subVectors(this.a,this.b),.5*Rs.cross(Ds).length()},Ws.prototype.getMidpoint=function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new Mr),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},Ws.prototype.getNormal=function(t){return Ws.getNormal(this.a,this.b,this.c,t)},Ws.prototype.getPlane=function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new Ns),t.setFromCoplanarPoints(this.a,this.b,this.c)},Ws.prototype.getBarycoord=function(t,e){return Ws.getBarycoord(t,this.a,this.b,this.c,e)},Ws.prototype.getUV=function(t,e,o,n,i){return Ws.getUV(t,this.a,this.b,this.c,e,o,n,i)},Ws.prototype.containsPoint=function(t){return Ws.containsPoint(t,this.a,this.b,this.c)},Ws.prototype.isFrontFacing=function(t){return Ws.isFrontFacing(this.a,this.b,this.c,t)},Ws.prototype.intersectsBox=function(t){return t.intersectsTriangle(this)},Ws.prototype.closestPointToPoint=function(t,e){void 0===e&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),e=new Mr);var o=this.a,n=this.b,i=this.c;js.subVectors(n,o),Fs.subVectors(i,o),Us.subVectors(t,o);var r=js.dot(Us),s=Fs.dot(Us);if(0>=r&&0>=s)return e.copy(o);Gs.subVectors(t,n);var a=js.dot(Gs),l=Fs.dot(Gs);if(0<=a&&l<=a)return e.copy(n);var c=r*l-a*s;if(0>=c&&0<=r&&0>=a)return n=r/(r-a),e.copy(o).addScaledVector(js,n);Vs.subVectors(t,i),t=js.dot(Vs);var u=Fs.dot(Vs);return 0<=u&&t<=u?e.copy(i):0>=(r=t*s-r*u)&&0<=s&&0>=u?(c=s/(s-u),e.copy(o).addScaledVector(Fs,c)):0>=(s=a*u-t*l)&&0<=l-a&&0<=t-u?(Hs.subVectors(i,n),c=(l-a)/(l-a+(t-u)),e.copy(n).addScaledVector(Hs,c)):(i=1/(s+r+c),n=r*i,c*=i,e.copy(o).addScaledVector(js,n).addScaledVector(Fs,c))},Ws.prototype.equals=function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)};var zs={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},qs={h:0,s:0,l:0},Xs={h:0,s:0,l:0},Ys=function(t,e,o){return Object.defineProperty(this,"isColor",{value:!0}),void 0===e&&void 0===o?this.set(t):this.setRGB(t,e,o)};Ys.prototype.set=function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},Ys.prototype.setScalar=function(t){return this.b=this.g=this.r=t,this},Ys.prototype.setHex=function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},Ys.prototype.setRGB=function(t,e,o){return this.r=t,this.g=e,this.b=o,this},Ys.prototype.setHSL=function(t,e,o){return t=br.euclideanModulo(t,1),e=br.clamp(e,0,1),o=br.clamp(o,0,1),0===e?this.r=this.g=this.b=o:(e=.5>=o?o*(1+e):o+e-o*e,o=2*o-e,this.r=a(o,e,t+1/3),this.g=a(o,e,t),this.b=a(o,e,t-1/3)),this},Ys.prototype.setStyle=function(t){function e(e){void 0!==e&&1>parseFloat(e)&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var o;if(o=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var n=o[2];switch(o[1]){case"rgb":case"rgba":if(o=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n))return this.r=Math.min(255,parseInt(o[1],10))/255,this.g=Math.min(255,parseInt(o[2],10))/255,this.b=Math.min(255,parseInt(o[3],10))/255,e(o[5]),this;if(o=/^(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n))return this.r=Math.min(100,parseInt(o[1],10))/100,this.g=Math.min(100,parseInt(o[2],10))/100,this.b=Math.min(100,parseInt(o[3],10))/100,e(o[5]),this;break;case"hsl":case"hsla":if(o=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n)){n=parseFloat(o[1])/360;var i=parseInt(o[2],10)/100,r=parseInt(o[3],10)/100;return e(o[5]),this.setHSL(n,i,r)}}}else if(o=/^#([A-Fa-f0-9]+)$/.exec(t)){if(o=o[1],3===(n=o.length))return this.r=parseInt(o.charAt(0)+o.charAt(0),16)/255,this.g=parseInt(o.charAt(1)+o.charAt(1),16)/255,this.b=parseInt(o.charAt(2)+o.charAt(2),16)/255,this;if(6===n)return this.r=parseInt(o.charAt(0)+o.charAt(1),16)/255,this.g=parseInt(o.charAt(2)+o.charAt(3),16)/255,this.b=parseInt(o.charAt(4)+o.charAt(5),16)/255,this}return t&&0<t.length?this.setColorName(t):this},Ys.prototype.setColorName=function(t){var e=zs[t];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this},Ys.prototype.clone=function(){return new this.constructor(this.r,this.g,this.b)},Ys.prototype.copy=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},Ys.prototype.copyGammaToLinear=function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},Ys.prototype.copyLinearToGamma=function(t,e){return void 0===e&&(e=2),e=0<e?1/e:1,this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},Ys.prototype.convertGammaToLinear=function(t){return this.copyGammaToLinear(this,t),this},Ys.prototype.convertLinearToGamma=function(t){return this.copyLinearToGamma(this,t),this},Ys.prototype.copySRGBToLinear=function(t){return this.r=l(t.r),this.g=l(t.g),this.b=l(t.b),this},Ys.prototype.copyLinearToSRGB=function(t){return this.r=c(t.r),this.g=c(t.g),this.b=c(t.b),this},Ys.prototype.convertSRGBToLinear=function(){return this.copySRGBToLinear(this),this},Ys.prototype.convertLinearToSRGB=function(){return this.copyLinearToSRGB(this),this},Ys.prototype.getHex=function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},Ys.prototype.getHexString=function(){return("000000"+this.getHex().toString(16)).slice(-6)},Ys.prototype.getHSL=function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var e,o=this.r,n=this.g,i=this.b,r=Math.max(o,n,i),s=Math.min(o,n,i),a=(s+r)/2;if(s===r)s=e=0;else{var l=r-s;switch(s=.5>=a?l/(r+s):l/(2-r-s),r){case o:e=(n-i)/l+(n<i?6:0);break;case n:e=(i-o)/l+2;break;case i:e=(o-n)/l+4}e/=6}return t.h=e,t.s=s,t.l=a,t},Ys.prototype.getStyle=function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},Ys.prototype.offsetHSL=function(t,e,o){return this.getHSL(qs),qs.h+=t,qs.s+=e,qs.l+=o,this.setHSL(qs.h,qs.s,qs.l),this},Ys.prototype.add=function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},Ys.prototype.addColors=function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},Ys.prototype.addScalar=function(t){return this.r+=t,this.g+=t,this.b+=t,this},Ys.prototype.sub=function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},Ys.prototype.multiply=function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},Ys.prototype.multiplyScalar=function(t){return this.r*=t,this.g*=t,this.b*=t,this},Ys.prototype.lerp=function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},Ys.prototype.lerpHSL=function(t,e){this.getHSL(qs),t.getHSL(Xs),t=br.lerp(qs.h,Xs.h,e);var o=br.lerp(qs.s,Xs.s,e);return e=br.lerp(qs.l,Xs.l,e),this.setHSL(t,o,e),this},Ys.prototype.equals=function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},Ys.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},Ys.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},Ys.prototype.fromBufferAttribute=function(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this},Ys.prototype.toJSON=function(){return this.getHex()},Ys.NAMES=zs,Ys.prototype.r=1,Ys.prototype.g=1,Ys.prototype.b=1;var Ks=function(t,e,o,n,i,r){this.a=t,this.b=e,this.c=o,this.normal=n&&n.isVector3?n:new Mr,this.vertexNormals=Array.isArray(n)?n:[],this.color=i&&i.isColor?i:new Ys,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==r?r:0};Ks.prototype.clone=function(){return(new this.constructor).copy(this)},Ks.prototype.copy=function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,o=t.vertexNormals.length;e<o;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,o=t.vertexColors.length;e<o;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this};var $s=0;u.prototype=Object.assign(Object.create(e.prototype),{constructor:u,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(t){if(void 0!==t)for(var e in t){var o=t[e];if(void 0===o)console.warn("THREE.Material: '"+e+"' parameter is undefined.");else if("shading"===e)console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===o;else{var n=this[e];void 0===n?console.warn("THREE."+this.type+": '"+e+"' is not a property of this material."):n&&n.isColor?n.set(o):n&&n.isVector3&&o&&o.isVector3?n.copy(o):this[e]=o}}},toJSON:function(t){function e(t){var e,o=[];for(e in t){var n=t[e];delete n.metadata,o.push(n)}return o}var o=void 0===t||"string"==typeof t;o&&(t={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};return n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),1>this.opacity&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),0<this.alphaTest&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),1<this.wireframeLinewidth&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),o&&(o=e(t.textures),t=e(t.images),0<o.length&&(n.textures=o),0<t.length&&(n.images=t)),n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var e=t.clippingPlanes,o=null;if(null!==e){var n=e.length;o=Array(n);for(var i=0;i!==n;++i)o[i]=e[i].clone()}return this.clippingPlanes=o,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(u.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),h.prototype=Object.create(u.prototype),h.prototype.constructor=h,h.prototype.isMeshBasicMaterial=!0,h.prototype.copy=function(t){return u.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};var Qs=new Mr,Js=new Er;Object.defineProperty(g.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(g.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,o){t*=this.itemSize,o*=e.itemSize;for(var n=0,i=this.itemSize;n<i;n++)this.array[t+n]=e.array[o+n];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,o=0,n=0,i=t.length;n<i;n++){var r=t[n];void 0===r&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),r=new Ys),e[o++]=r.r,e[o++]=r.g,e[o++]=r.b}return this},copyVector2sArray:function(t){for(var e=this.array,o=0,n=0,i=t.length;n<i;n++){var r=t[n];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),r=new Er),e[o++]=r.x,e[o++]=r.y}return this},copyVector3sArray:function(t){for(var e=this.array,o=0,n=0,i=t.length;n<i;n++){var r=t[n];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),r=new Mr),e[o++]=r.x,e[o++]=r.y,e[o++]=r.z}return this},copyVector4sArray:function(t){for(var e=this.array,o=0,n=0,i=t.length;n<i;n++){var r=t[n];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),r=new kr),e[o++]=r.x,e[o++]=r.y,e[o++]=r.z,e[o++]=r.w}return this},applyMatrix3:function(t){if(2===this.itemSize)for(var e=0,o=this.count;e<o;e++)Js.fromBufferAttribute(this,e),Js.applyMatrix3(t),this.setXY(e,Js.x,Js.y);else if(3===this.itemSize)for(e=0,o=this.count;e<o;e++)Qs.fromBufferAttribute(this,e),Qs.applyMatrix3(t),this.setXYZ(e,Qs.x,Qs.y,Qs.z);return this},applyMatrix4:function(t){for(var e=0,o=this.count;e<o;e++)Qs.x=this.getX(e),Qs.y=this.getY(e),Qs.z=this.getZ(e),Qs.applyMatrix4(t),this.setXYZ(e,Qs.x,Qs.y,Qs.z);return this},applyNormalMatrix:function(t){for(var e=0,o=this.count;e<o;e++)Qs.x=this.getX(e),Qs.y=this.getY(e),Qs.z=this.getZ(e),Qs.applyNormalMatrix(t),this.setXYZ(e,Qs.x,Qs.y,Qs.z);return this},transformDirection:function(t){for(var e=0,o=this.count;e<o;e++)Qs.x=this.getX(e),Qs.y=this.getY(e),Qs.z=this.getZ(e),Qs.transformDirection(t),this.setXYZ(e,Qs.x,Qs.y,Qs.z);return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,o){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=o,this},setXYZ:function(t,e,o,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=o,this.array[t+2]=n,this},setXYZW:function(t,e,o,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=o,this.array[t+2]=n,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),p.prototype=Object.create(g.prototype),p.prototype.constructor=p,d.prototype=Object.create(g.prototype),d.prototype.constructor=d,f.prototype=Object.create(g.prototype),f.prototype.constructor=f,m.prototype=Object.create(g.prototype),m.prototype.constructor=m,y.prototype=Object.create(g.prototype),y.prototype.constructor=y,v.prototype=Object.create(g.prototype),v.prototype.constructor=v,_.prototype=Object.create(g.prototype),_.prototype.constructor=_,b.prototype=Object.create(g.prototype),b.prototype.constructor=b,E.prototype=Object.create(g.prototype),E.prototype.constructor=E;var Zs=function(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1};Zs.prototype.computeGroups=function(t){var e=[],o=void 0,n=t.faces;for(t=0;t<n.length;t++){var i=n[t];if(i.materialIndex!==o){o=i.materialIndex,void 0!==r&&(r.count=3*t-r.start,e.push(r));var r={start:3*t,materialIndex:o}}}void 0!==r&&(r.count=3*t-r.start,e.push(r)),this.groups=e},Zs.prototype.fromGeometry=function(t){var e=t.faces,o=t.vertices,n=t.faceVertexUvs,i=n[0]&&0<n[0].length,r=n[1]&&0<n[1].length,s=t.morphTargets,a=s.length;if(0<a){for(var l=[],c=0;c<a;c++)l[c]={name:s[c].name,data:[]};this.morphTargets.position=l}c=t.morphNormals;var u=c.length;if(0<u){for(var h=[],g=0;g<u;g++)h[g]={name:c[g].name,data:[]};this.morphTargets.normal=h}g=t.skinIndices;var p=t.skinWeights,d=g.length===o.length,f=p.length===o.length;0<o.length&&0===e.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(var m=0;m<e.length;m++){var y=e[m];this.vertices.push(o[y.a],o[y.b],o[y.c]);var v=y.vertexNormals;for(3===v.length?this.normals.push(v[0],v[1],v[2]):(v=y.normal,this.normals.push(v,v,v)),v=y.vertexColors,3===v.length?this.colors.push(v[0],v[1],v[2]):(v=y.color,this.colors.push(v,v,v)),!0===i&&(v=n[0][m],void 0!==v?this.uvs.push(v[0],v[1],v[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",m),this.uvs.push(new Er,new Er,new Er))),!0===r&&(v=n[1][m],void 0!==v?this.uvs2.push(v[0],v[1],v[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",m),this.uvs2.push(new Er,new Er,new Er))),v=0;v<a;v++){var _=s[v].vertices;l[v].data.push(_[y.a],_[y.b],_[y.c])}for(v=0;v<u;v++)_=c[v].vertexNormals[m],h[v].data.push(_.a,_.b,_.c);d&&this.skinIndices.push(g[y.a],g[y.b],g[y.c]),f&&this.skinWeights.push(p[y.a],p[y.b],p[y.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this};var ta=1,ea=new is,oa=new s,na=new Mr,ia=new Rr,ra=new Rr,sa=new Mr;S.prototype=Object.assign(Object.create(e.prototype),{constructor:S,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(65535<x(t)?_:y)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,o){this.groups.push({start:t,count:e,materialIndex:void 0!==o?o:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix4:function(t){var e=this.attributes.position;if(void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0),void 0!==(e=this.attributes.normal)){var o=(new Sr).getNormalMatrix(t);e.applyNormalMatrix(o),e.needsUpdate=!0}return e=this.attributes.tangent,void 0!==e&&(e.transformDirection(t),e.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return ea.makeRotationX(t),this.applyMatrix4(ea),this},rotateY:function(t){return ea.makeRotationY(t),this.applyMatrix4(ea),this},rotateZ:function(t){return ea.makeRotationZ(t),this.applyMatrix4(ea),this},translate:function(t,e,o){return ea.makeTranslation(t,e,o),this.applyMatrix4(ea),this},scale:function(t,e,o){return ea.makeScale(t,e,o),this.applyMatrix4(ea),this},lookAt:function(t){return oa.lookAt(t),oa.updateMatrix(),this.applyMatrix4(oa.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(na).negate(),this.translate(na.x,na.y,na.z),this},setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){t=new b(3*e.vertices.length,3);var o=new b(3*e.colors.length,3);this.setAttribute("position",t.copyVector3sArray(e.vertices)),this.setAttribute("color",o.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length&&(t=new b(e.lineDistances.length,1),this.setAttribute("lineDistance",t.copyArray(e.lineDistances))),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){for(var e=[],o=0,n=t.length;o<n;o++){var i=t[o];e.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new b(e,3)),this},updateFromObject:function(t){var e=t.geometry;if(t.isMesh){var o=e.__directGeometry;if(!0===e.elementsNeedUpdate&&(o=void 0,e.elementsNeedUpdate=!1),void 0===o)return this.fromGeometry(e);o.verticesNeedUpdate=e.verticesNeedUpdate,o.normalsNeedUpdate=e.normalsNeedUpdate,o.colorsNeedUpdate=e.colorsNeedUpdate,o.uvsNeedUpdate=e.uvsNeedUpdate,o.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=o}return!0===e.verticesNeedUpdate&&(o=this.attributes.position,void 0!==o&&(o.copyVector3sArray(e.vertices),o.needsUpdate=!0),e.verticesNeedUpdate=!1),!0===e.normalsNeedUpdate&&(o=this.attributes.normal,void 0!==o&&(o.copyVector3sArray(e.normals),o.needsUpdate=!0),e.normalsNeedUpdate=!1),!0===e.colorsNeedUpdate&&(o=this.attributes.color,void 0!==o&&(o.copyColorsArray(e.colors),o.needsUpdate=!0),e.colorsNeedUpdate=!1),e.uvsNeedUpdate&&(o=this.attributes.uv,void 0!==o&&(o.copyVector2sArray(e.uvs),o.needsUpdate=!0),e.uvsNeedUpdate=!1),e.lineDistancesNeedUpdate&&(o=this.attributes.lineDistance,void 0!==o&&(o.copyArray(e.lineDistances),o.needsUpdate=!0),e.lineDistancesNeedUpdate=!1),e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new Zs).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);this.setAttribute("position",new g(e,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(e=new Float32Array(3*t.normals.length),this.setAttribute("normal",new g(e,3).copyVector3sArray(t.normals))),0<t.colors.length&&(e=new Float32Array(3*t.colors.length),this.setAttribute("color",new g(e,3).copyColorsArray(t.colors))),0<t.uvs.length&&(e=new Float32Array(2*t.uvs.length),this.setAttribute("uv",new g(e,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(e=new Float32Array(2*t.uvs2.length),this.setAttribute("uv2",new g(e,2).copyVector2sArray(t.uvs2))),this.groups=t.groups;for(var o in t.morphTargets){e=[];for(var n=t.morphTargets[o],i=0,r=n.length;i<r;i++){var s=n[i],a=new b(3*s.data.length,3);a.name=s.name,e.push(a.copyVector3sArray(s.data))}this.morphAttributes[o]=e}return 0<t.skinIndices.length&&(o=new b(4*t.skinIndices.length,4),this.setAttribute("skinIndex",o.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(o=new b(4*t.skinWeights.length,4),this.setAttribute("skinWeight",o.copyVector4sArray(t.skinWeights))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Rr);var t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Mr(-1/0,-1/0,-1/0),new Mr(1/0,1/0,1/0));else{if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e){t=0;for(var o=e.length;t<o;t++)ia.setFromBufferAttribute(e[t]),this.morphTargetsRelative?(sa.addVectors(this.boundingBox.min,ia.min),this.boundingBox.expandByPoint(sa),sa.addVectors(this.boundingBox.max,ia.max),this.boundingBox.expandByPoint(sa)):(this.boundingBox.expandByPoint(ia.min),this.boundingBox.expandByPoint(ia.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Kr);var t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Mr,1/0);else if(t){var o=this.boundingSphere.center;if(ia.setFromBufferAttribute(t),e)for(var n=0,i=e.length;n<i;n++)ra.setFromBufferAttribute(e[n]),this.morphTargetsRelative?(sa.addVectors(ia.min,ra.min),ia.expandByPoint(sa),sa.addVectors(ia.max,ra.max),ia.expandByPoint(sa)):(ia.expandByPoint(ra.min),ia.expandByPoint(ra.max));ia.getCenter(o),i=n=0;for(var r=t.count;i<r;i++)sa.fromBufferAttribute(t,i),n=Math.max(n,o.distanceToSquared(sa));if(e)for(i=0,r=e.length;i<r;i++)for(var s=e[i],a=this.morphTargetsRelative,l=0,c=s.count;l<c;l++)sa.fromBufferAttribute(s,l),a&&(na.fromBufferAttribute(t,l),sa.add(na)),n=Math.max(n,o.distanceToSquared(sa));this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.getAttribute("position");if(void 0!==e){var o=this.getAttribute("normal");if(void 0===o)o=new g(new Float32Array(3*e.count),3),this.setAttribute("normal",o);else for(var n=0,i=o.count;n<i;n++)o.setXYZ(n,0,0,0);n=new Mr,i=new Mr;var r=new Mr,s=new Mr,a=new Mr,l=new Mr,c=new Mr,u=new Mr;if(t)for(var h=0,p=t.count;h<p;h+=3){var d=t.getX(h+0),f=t.getX(h+1),m=t.getX(h+2);n.fromBufferAttribute(e,d),i.fromBufferAttribute(e,f),r.fromBufferAttribute(e,m),c.subVectors(r,i),u.subVectors(n,i),c.cross(u),s.fromBufferAttribute(o,d),a.fromBufferAttribute(o,f),l.fromBufferAttribute(o,m),s.add(c),a.add(c),l.add(c),o.setXYZ(d,s.x,s.y,s.z),o.setXYZ(f,a.x,a.y,a.z),o.setXYZ(m,l.x,l.y,l.z)}else for(t=0,s=e.count;t<s;t+=3)n.fromBufferAttribute(e,t+0),i.fromBufferAttribute(e,t+1),r.fromBufferAttribute(e,t+2),c.subVectors(r,i),u.subVectors(n,i),c.cross(u),o.setXYZ(t+0,c.x,c.y,c.z),o.setXYZ(t+1,c.x,c.y,c.z),o.setXYZ(t+2,c.x,c.y,c.z);this.normalizeNormals(),o.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var o,n=this.attributes;for(o in n)if(void 0!==t.attributes[o]){var i=n[o].array,r=t.attributes[o],s=r.array,a=r.itemSize*e;r=Math.min(s.length,i.length-a);for(var l=0;l<r;l++,a++)i[a]=s[l]}return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t=this.attributes.normal,e=0,o=t.count;e<o;e++)sa.fromBufferAttribute(t,e),sa.normalize(),t.setXYZ(e,sa.x,sa.y,sa.z)},toNonIndexed:function(){function t(t,e){var o=t.array,n=t.itemSize;t=t.normalized;for(var i,r=new o.constructor(e.length*n),s=0,a=0,l=e.length;a<l;a++){i=e[a]*n;for(var c=0;c<n;c++)r[s++]=o[i++]}return new g(r,n,t)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new S,o=this.index.array,n=this.attributes;for(s in n){var i=t(n[s],o);e.setAttribute(s,i)}n=this.morphAttributes;for(var r in n){var s=[];i=n[r];for(var a=0,l=i.length;a<l;a++){var c=t(i[a],o);s.push(c)}e.morphAttributes[r]=s}for(e.morphTargetsRelative=this.morphTargetsRelative,o=this.groups,r=0,n=o.length;r<n;r++)s=o[r],e.addGroup(s.start,s.count,s.materialIndex);return e},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),0<Object.keys(this.userData).length&&(t.userData=this.userData),void 0!==this.parameters){var e=this.parameters;for(o in e)void 0!==e[o]&&(t[o]=e[o]);return t}t.data={attributes:{}};var o=this.index;null!==o&&(t.data.index={type:o.array.constructor.name,array:Array.prototype.slice.call(o.array)}),o=this.attributes;for(var n in o){var i=o[n],r=i.toJSON(t.data);""!==i.name&&(r.name=i.name),t.data.attributes[n]=r}n={},o=!1;for(e in this.morphAttributes){i=this.morphAttributes[e],r=[];for(var s=0,a=i.length;s<a;s++){var l=i[s],c=l.toJSON(t.data);""!==l.name&&(c.name=l.name),r.push(c)}0<r.length&&(n[e]=r,o=!0)}return o&&(t.data.morphAttributes=n,t.data.morphTargetsRelative=this.morphTargetsRelative),e=this.groups,0<e.length&&(t.data.groups=JSON.parse(JSON.stringify(e))),e=this.boundingSphere,null!==e&&(t.data.boundingSphere={center:e.center.toArray(),radius:e.radius}),t},clone:function(){return(new S).copy(this)},copy:function(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null;var e={};this.name=t.name;var o=t.index;null!==o&&this.setIndex(o.clone(e)),o=t.attributes;for(var n in o)this.setAttribute(n,o[n].clone(e));n=t.morphAttributes;for(var i in n){o=[];for(var r=n[i],s=0,a=r.length;s<a;s++)o.push(r[s].clone(e));this.morphAttributes[i]=o}for(this.morphTargetsRelative=t.morphTargetsRelative,e=t.groups,i=0,n=e.length;i<n;i++)o=e[i],this.addGroup(o.start,o.count,o.materialIndex);return e=t.boundingBox,null!==e&&(this.boundingBox=e.clone()),e=t.boundingSphere,null!==e&&(this.boundingSphere=e.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var aa=new is,la=new ns,ca=new Kr,ua=new Mr,ha=new Mr,ga=new Mr,pa=new Mr,da=new Mr,fa=new Mr,ma=new Mr,ya=new Mr,va=new Mr,_a=new Er,ba=new Er,Ea=new Er,xa=new Mr,Sa=new Mr;T.prototype=Object.assign(Object.create(s.prototype),{constructor:T,isMesh:!0,copy:function(t){return s.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){t=t.morphAttributes;var e=Object.keys(t);if(0<e.length&&void 0!==(t=t[e[0]])){this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0;for(var o=t.length;e<o;e++){var n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}else void 0!==(t=t.morphTargets)&&0<t.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},raycast:function(t,e){var o=this.geometry,n=this.material,i=this.matrixWorld;if(void 0!==n&&(null===o.boundingSphere&&o.computeBoundingSphere(),ca.copy(o.boundingSphere),ca.applyMatrix4(i),!1!==t.ray.intersectsSphere(ca)&&(aa.getInverse(i),la.copy(t.ray).applyMatrix4(aa),null===o.boundingBox||!1!==la.intersectsBox(o.boundingBox))))if(o.isBufferGeometry){var r=o.index,s=o.attributes.position;i=o.morphAttributes.position;var a=o.morphTargetsRelative,l=o.attributes.uv,c=o.attributes.uv2,u=o.groups,h=o.drawRange;if(null!==r)if(Array.isArray(n))for(var g=0,p=u.length;g<p;g++)for(var d=u[g],f=n[d.materialIndex],m=Math.max(d.start,h.start),y=Math.min(d.start+d.count,h.start+h.count);m<y;m+=3){o=r.getX(m);var v=r.getX(m+1),_=r.getX(m+2);(o=C(this,f,t,la,s,i,a,l,c,o,v,_))&&(o.faceIndex=Math.floor(m/3),o.face.materialIndex=d.materialIndex,e.push(o))}else for(u=Math.max(0,h.start),h=Math.min(r.count,h.start+h.count);u<h;u+=3)o=r.getX(u),g=r.getX(u+1),p=r.getX(u+2),(o=C(this,n,t,la,s,i,a,l,c,o,g,p))&&(o.faceIndex=Math.floor(u/3),e.push(o));else if(void 0!==s)if(Array.isArray(n))for(r=0,g=u.length;r<g;r++)for(p=u[r],d=n[p.materialIndex],f=Math.max(p.start,h.start),m=Math.min(p.start+p.count,h.start+h.count);f<m;f+=3)(o=C(this,d,t,la,s,i,a,l,c,f,f+1,f+2))&&(o.faceIndex=Math.floor(f/3),o.face.materialIndex=p.materialIndex,e.push(o));else for(u=Math.max(0,h.start),h=Math.min(s.count,h.start+h.count);u<h;u+=3)(o=C(this,n,t,la,s,i,a,l,c,u,u+1,u+2))&&(o.faceIndex=Math.floor(u/3),e.push(o))}else if(o.isGeometry)for(i=Array.isArray(n),a=o.vertices,l=o.faces,o=o.faceVertexUvs[0],0<o.length&&(s=o),c=0,h=l.length;c<h;c++)u=l[c],void 0!==(o=i?n[u.materialIndex]:n)&&(r=a[u.a],g=a[u.b],p=a[u.c],o=w(this,o,t,la,r,g,p,xa))&&(s&&s[c]&&(d=s[c],_a.copy(d[0]),ba.copy(d[1]),Ea.copy(d[2]),o.uv=Ws.getUV(xa,r,g,p,_a,ba,Ea,new Er)),o.face=u,o.faceIndex=c,e.push(o))}});var Ta=0,wa=new is,Ca=new s,ka=new Mr;k.prototype=Object.assign(Object.create(e.prototype),{constructor:k,isGeometry:!0,applyMatrix4:function(t){for(var e=(new Sr).getNormalMatrix(t),o=0,n=this.vertices.length;o<n;o++)this.vertices[o].applyMatrix4(t);for(t=0,o=this.faces.length;t<o;t++){n=this.faces[t],n.normal.applyMatrix3(e).normalize();for(var i=0,r=n.vertexNormals.length;i<r;i++)n.vertexNormals[i].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0,this},rotateX:function(t){return wa.makeRotationX(t),this.applyMatrix4(wa),this},rotateY:function(t){return wa.makeRotationY(t),this.applyMatrix4(wa),this},rotateZ:function(t){return wa.makeRotationZ(t),this.applyMatrix4(wa),this},translate:function(t,e,o){return wa.makeTranslation(t,e,o),this.applyMatrix4(wa),this},scale:function(t,e,o){return wa.makeScale(t,e,o),this.applyMatrix4(wa),this},lookAt:function(t){return Ca.lookAt(t),Ca.updateMatrix(),this.applyMatrix4(Ca.matrix),this},fromBufferGeometry:function(t){function e(t,e,n,i){var r=void 0===a?[]:[o.colors[t].clone(),o.colors[e].clone(),o.colors[n].clone()],u=void 0===s?[]:[(new Mr).fromBufferAttribute(s,t),(new Mr).fromBufferAttribute(s,e),(new Mr).fromBufferAttribute(s,n)];i=new Ks(t,e,n,u,r,i),o.faces.push(i),void 0!==l&&o.faceVertexUvs[0].push([(new Er).fromBufferAttribute(l,t),(new Er).fromBufferAttribute(l,e),(new Er).fromBufferAttribute(l,n)]),void 0!==c&&o.faceVertexUvs[1].push([(new Er).fromBufferAttribute(c,t),(new Er).fromBufferAttribute(c,e),(new Er).fromBufferAttribute(c,n)])}var o=this,n=null!==t.index?t.index:void 0,i=t.attributes;if(void 0===i.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var r=i.position,s=i.normal,a=i.color,l=i.uv,c=i.uv2;for(void 0!==c&&(this.faceVertexUvs[1]=[]),i=0;i<r.count;i++)o.vertices.push((new Mr).fromBufferAttribute(r,i)),void 0!==a&&o.colors.push((new Ys).fromBufferAttribute(a,i));if(i=t.groups,0<i.length)for(r=0;r<i.length;r++){var u=i[r],h=u.start,g=h;for(h+=u.count;g<h;g+=3)void 0!==n?e(n.getX(g),n.getX(g+1),n.getX(g+2),u.materialIndex):e(g,g+1,g+2,u.materialIndex)}else if(void 0!==n)for(i=0;i<n.count;i+=3)e(n.getX(i),n.getX(i+1),n.getX(i+2));else for(n=0;n<r.count;n+=3)e(n,n+1,n+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(ka).negate(),this.translate(ka.x,ka.y,ka.z),this},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius;e=0===e?1:1/e;var o=new is;return o.set(e,0,0,-e*t.x,0,e,0,-e*t.y,0,0,e,-e*t.z,0,0,0,1),this.applyMatrix4(o),this},computeFaceNormals:function(){for(var t=new Mr,e=new Mr,o=0,n=this.faces.length;o<n;o++){var i=this.faces[o],r=this.vertices[i.a],s=this.vertices[i.b];t.subVectors(this.vertices[i.c],s),e.subVectors(r,s),t.cross(e),t.normalize(),i.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);for(var e=Array(this.vertices.length),o=0,n=this.vertices.length;o<n;o++)e[o]=new Mr;if(t){t=new Mr,o=new Mr,n=0;for(var i=this.faces.length;n<i;n++){var r=this.faces[n],s=this.vertices[r.a],a=this.vertices[r.b];t.subVectors(this.vertices[r.c],a),o.subVectors(s,a),t.cross(o),e[r.a].add(t),e[r.b].add(t),e[r.c].add(t)}}else for(this.computeFaceNormals(),t=0,o=this.faces.length;t<o;t++)n=this.faces[t],e[n.a].add(n.normal),e[n.b].add(n.normal),e[n.c].add(n.normal);for(t=0,o=this.vertices.length;t<o;t++)e[t].normalize();for(t=0,o=this.faces.length;t<o;t++)n=this.faces[t],i=n.vertexNormals,3===i.length?(i[0].copy(e[n.a]),i[1].copy(e[n.b]),i[2].copy(e[n.c])):(i[0]=e[n.a].clone(),i[1]=e[n.b].clone(),i[2]=e[n.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(var t=0,e=this.faces.length;t<e;t++){var o=this.faces[t],n=o.vertexNormals;3===n.length?(n[0].copy(o.normal),n[1].copy(o.normal),n[2].copy(o.normal)):(n[0]=o.normal.clone(),n[1]=o.normal.clone(),n[2]=o.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(var t=0,e=this.faces.length;t<e;t++){var o=this.faces[t];o.__originalFaceNormal?o.__originalFaceNormal.copy(o.normal):o.__originalFaceNormal=o.normal.clone(),o.__originalVertexNormals||(o.__originalVertexNormals=[]);for(var n=0,i=o.vertexNormals.length;n<i;n++)o.__originalVertexNormals[n]?o.__originalVertexNormals[n].copy(o.vertexNormals[n]):o.__originalVertexNormals[n]=o.vertexNormals[n].clone()}for(t=new k,t.faces=this.faces,e=0,o=this.morphTargets.length;e<o;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[],n=this.morphNormals[e].faceNormals,i=this.morphNormals[e].vertexNormals;for(var r=0,s=this.faces.length;r<s;r++){var a=new Mr,l={a:new Mr,b:new Mr,c:new Mr};n.push(a),i.push(l)}}for(n=this.morphNormals[e],t.vertices=this.morphTargets[e].vertices,t.computeFaceNormals(),t.computeVertexNormals(),i=0,r=this.faces.length;i<r;i++)s=this.faces[i],a=n.vertexNormals[i],n.faceNormals[i].copy(s.normal),a.a.copy(s.vertexNormals[0]),a.b.copy(s.vertexNormals[1]),a.c.copy(s.vertexNormals[2])}for(t=0,e=this.faces.length;t<e;t++)o=this.faces[t],o.normal=o.__originalFaceNormal,o.vertexNormals=o.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Rr),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Kr),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,o){if(t&&t.isGeometry){var n,i=this.vertices.length,r=this.vertices,s=t.vertices,a=this.faces,l=t.faces,c=this.colors,u=t.colors;void 0===o&&(o=0),void 0!==e&&(n=(new Sr).getNormalMatrix(e));for(var h=0,g=s.length;h<g;h++){var p=s[h].clone();void 0!==e&&p.applyMatrix4(e),r.push(p)}for(e=0,r=u.length;e<r;e++)c.push(u[e].clone());for(c=0,u=l.length;c<u;c++){e=l[c],g=e.vertexNormals,r=e.vertexColors,s=new Ks(e.a+i,e.b+i,e.c+i),s.normal.copy(e.normal),void 0!==n&&s.normal.applyMatrix3(n).normalize(),p=0;for(var d=g.length;p<d;p++)h=g[p].clone(),void 0!==n&&h.applyMatrix3(n).normalize(),s.vertexNormals.push(h);for(s.color.copy(e.color),g=0,p=r.length;g<p;g++)h=r[g],s.vertexColors.push(h.clone());s.materialIndex=e.materialIndex+o,a.push(s)}for(o=0,n=t.faceVertexUvs.length;o<n;o++)for(i=t.faceVertexUvs[o],void 0===this.faceVertexUvs[o]&&(this.faceVertexUvs[o]=[]),a=0,l=i.length;a<l;a++){for(c=i[a],u=[],e=0,r=c.length;e<r;e++)u.push(c[e].clone());this.faceVertexUvs[o].push(u)}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){for(var t={},e=[],o=[],n=Math.pow(10,4),i=0,r=this.vertices.length;i<r;i++){var s=this.vertices[i];s=Math.round(s.x*n)+"_"+Math.round(s.y*n)+"_"+Math.round(s.z*n),void 0===t[s]?(t[s]=i,e.push(this.vertices[i]),o[i]=e.length-1):o[i]=o[t[s]]}for(t=[],n=0,i=this.faces.length;n<i;n++)for(r=this.faces[n],r.a=o[r.a],r.b=o[r.b],r.c=o[r.c],r=[r.a,r.b,r.c],s=0;3>s;s++)if(r[s]===r[(s+1)%3]){t.push(n);break}for(o=t.length-1;0<=o;o--)for(n=t[o],this.faces.splice(n,1),i=0,r=this.faceVertexUvs.length;i<r;i++)this.faceVertexUvs[i].splice(n,1);return o=this.vertices.length-e.length,this.vertices=e,o},setFromPoints:function(t){this.vertices=[];for(var e=0,o=t.length;e<o;e++){var n=t[e];this.vertices.push(new Mr(n.x,n.y,n.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,o=0;o<e;o++)t[o]._id=o;t.sort(function(t,e){return t.materialIndex-e.materialIndex}),o=this.faceVertexUvs[0];var n,i,r=this.faceVertexUvs[1];o&&o.length===e&&(n=[]),r&&r.length===e&&(i=[]);for(var s=0;s<e;s++){var a=t[s]._id;n&&n.push(o[a]),i&&i.push(r[a])}n&&(this.faceVertexUvs[0]=n),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){function t(t,e,o){return o?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==c[e]?c[e]:(c[e]=l.length/3,l.push(t.x,t.y,t.z),c[e])}function o(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==h[e]?h[e]:(h[e]=u.length,u.push(t.getHex()),h[e])}function n(t){var e=t.x.toString()+t.y.toString();return void 0!==p[e]?p[e]:(p[e]=g.length/2,g.push(t.x,t.y),p[e])}var i={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),void 0!==this.parameters){var r,s=this.parameters;for(r in s)void 0!==s[r]&&(i[r]=s[r]);return i}for(s=[],r=0;r<this.vertices.length;r++){var a=this.vertices[r];s.push(a.x,a.y,a.z)}r=[];var l=[],c={},u=[],h={},g=[],p={};for(a=0;a<this.faces.length;a++){var d=this.faces[a],f=void 0!==this.faceVertexUvs[0][a],m=0<d.normal.length(),y=0<d.vertexNormals.length,v=1!==d.color.r||1!==d.color.g||1!==d.color.b,_=0<d.vertexColors.length,b=0;b=t(b,0,0),b=t(b,1,!0),b=t(b,2,!1),b=t(b,3,f),b=t(b,4,m),b=t(b,5,y),b=t(b,6,v),b=t(b,7,_),r.push(b),r.push(d.a,d.b,d.c),r.push(d.materialIndex),f&&(f=this.faceVertexUvs[0][a],r.push(n(f[0]),n(f[1]),n(f[2]))),m&&r.push(e(d.normal)),y&&(m=d.vertexNormals,r.push(e(m[0]),e(m[1]),e(m[2]))),v&&r.push(o(d.color)),_&&(d=d.vertexColors,r.push(o(d[0]),o(d[1]),o(d[2])))}return i.data={},i.data.vertices=s,i.data.normals=l,0<u.length&&(i.data.colors=u),0<g.length&&(i.data.uvs=[g]),i.data.faces=r,i},clone:function(){return(new k).copy(this)},copy:function(t){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.name=t.name;for(var e=t.vertices,o=0,n=e.length;o<n;o++)this.vertices.push(e[o].clone());for(e=t.colors,o=0,n=e.length;o<n;o++)this.colors.push(e[o].clone());for(e=t.faces,o=0,n=e.length;o<n;o++)this.faces.push(e[o].clone());for(e=0,o=t.faceVertexUvs.length;e<o;e++){n=t.faceVertexUvs[e],void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]);for(var i=0,r=n.length;i<r;i++){for(var s=n[i],a=[],l=0,c=s.length;l<c;l++)a.push(s[l].clone());this.faceVertexUvs[e].push(a)}}for(e=t.morphTargets,o=0,n=e.length;o<n;o++){if(i={},i.name=e[o].name,void 0!==e[o].vertices)for(i.vertices=[],r=0,s=e[o].vertices.length;r<s;r++)i.vertices.push(e[o].vertices[r].clone());if(void 0!==e[o].normals)for(i.normals=[],r=0,s=e[o].normals.length;r<s;r++)i.normals.push(e[o].normals[r].clone());this.morphTargets.push(i)}for(e=t.morphNormals,o=0,n=e.length;o<n;o++){if(i={},void 0!==e[o].vertexNormals)for(i.vertexNormals=[],r=0,s=e[o].vertexNormals.length;r<s;r++)a=e[o].vertexNormals[r],l={},l.a=a.a.clone(),l.b=a.b.clone(),l.c=a.c.clone(),i.vertexNormals.push(l);if(void 0!==e[o].faceNormals)for(i.faceNormals=[],r=0,s=e[o].faceNormals.length;r<s;r++)i.faceNormals.push(e[o].faceNormals[r].clone());this.morphNormals.push(i)}for(e=t.skinWeights,o=0,n=e.length;o<n;o++)this.skinWeights.push(e[o].clone());for(e=t.skinIndices,o=0,n=e.length;o<n;o++)this.skinIndices.push(e[o].clone());for(e=t.lineDistances,o=0,n=e.length;o<n;o++)this.lineDistances.push(e[o]);return e=t.boundingBox,null!==e&&(this.boundingBox=e.clone()),e=t.boundingSphere,null!==e&&(this.boundingSphere=e.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),A.prototype=Object.create(k.prototype),A.prototype.constructor=A,I.prototype=Object.create(S.prototype),I.prototype.constructor=I;var Aa={clone:B,merge:M};L.prototype=Object.create(u.prototype),L.prototype.constructor=L,L.prototype.isShaderMaterial=!0,L.prototype.copy=function(t){return u.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=B(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this},L.prototype.toJSON=function(t){var e=u.prototype.toJSON.call(this,t);e.glslVersion=this.glslVersion,e.uniforms={};for(var o in this.uniforms){var n=this.uniforms[o].value;e.uniforms[o]=n&&n.isTexture?{type:"t",value:n.toJSON(t).uuid}:n&&n.isColor?{type:"c",value:n.getHex()}:n&&n.isVector2?{type:"v2",value:n.toArray()}:n&&n.isVector3?{type:"v3",value:n.toArray()}:n&&n.isVector4?{type:"v4",value:n.toArray()}:n&&n.isMatrix3?{type:"m3",value:n.toArray()}:n&&n.isMatrix4?{type:"m4",value:n.toArray()}:{value:n}}0<Object.keys(this.defines).length&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,t={};for(var i in this.extensions)!0===this.extensions[i]&&(t[i]=!0);return 0<Object.keys(t).length&&(e.extensions=t),e},N.prototype=Object.assign(Object.create(s.prototype),{constructor:N,isCamera:!0,copy:function(t,e){return s.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new Mr),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){s.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,e){s.prototype.updateWorldMatrix.call(this,t,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),R.prototype=Object.assign(Object.create(N.prototype),{constructor:R,isPerspectiveCamera:!0,copy:function(t,e){return N.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){t=.5*this.getFilmHeight()/t,this.fov=2*br.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*br.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*br.RAD2DEG*Math.atan(Math.tan(.5*br.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,o,n,i,r){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=o,this.view.offsetY=n,this.view.width=i,this.view.height=r,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*br.DEG2RAD*this.fov)/this.zoom,o=2*e,n=this.aspect*o,i=-.5*n,r=this.view;if(null!==this.view&&this.view.enabled){var s=r.fullWidth,a=r.fullHeight;i+=r.offsetX*n/s,e-=r.offsetY*o/a,n*=r.width/s,o*=r.height/a}r=this.filmOffset,0!==r&&(i+=t*r/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+n,e,e-o,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){return t=s.prototype.toJSON.call(this,t),t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),D.prototype=Object.create(s.prototype),D.prototype.constructor=D,O.prototype=Object.create(n.prototype),O.prototype.constructor=O,O.prototype.isWebGLCubeRenderTarget=!0,O.prototype.fromEquirectangularTexture=function(t,e){this.texture.type=e.type,this.texture.format=1023,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;var o=new I(5,5,5),n=new L({name:"CubemapFromEquirect",uniforms:B({tEquirect:{value:null}}),vertexShader:"\n\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t#include <begin_vertex>\n\t\t\t\t#include <project_vertex>\n\n\t\t\t}\n\t\t",fragmentShader:"\n\n\t\t\tuniform sampler2D tEquirect;\n\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t}\n\t\t",side:1,blending:0});return n.uniforms.tEquirect.value=e,o=new T(o,n),n=e.minFilter,1008===e.minFilter&&(e.minFilter=1006),new D(1,10,this).update(t,o),e.minFilter=n,o.geometry.dispose(),o.material.dispose(),this},P.prototype=Object.create(o.prototype),P.prototype.constructor=P,P.prototype.isDataTexture=!0;var Ia=new Kr,Ba=new Mr,Ma=function(t,e,o,n,i,r){this.planes=[void 0!==t?t:new Ns,void 0!==e?e:new Ns,void 0!==o?o:new Ns,void 0!==n?n:new Ns,void 0!==i?i:new Ns,void 0!==r?r:new Ns]};Ma.prototype.set=function(t,e,o,n,i,r){var s=this.planes;return s[0].copy(t),s[1].copy(e),s[2].copy(o),s[3].copy(n),s[4].copy(i),s[5].copy(r),this},Ma.prototype.clone=function(){return(new this.constructor).copy(this)},Ma.prototype.copy=function(t){for(var e=this.planes,o=0;6>o;o++)e[o].copy(t.planes[o]);return this},Ma.prototype.setFromProjectionMatrix=function(t){var e=this.planes,o=t.elements;t=o[0];var n=o[1],i=o[2],r=o[3],s=o[4],a=o[5],l=o[6],c=o[7],u=o[8],h=o[9],g=o[10],p=o[11],d=o[12],f=o[13],m=o[14];return o=o[15],e[0].setComponents(r-t,c-s,p-u,o-d).normalize(),e[1].setComponents(r+t,c+s,p+u,o+d).normalize(),e[2].setComponents(r+n,c+a,p+h,o+f).normalize(),e[3].setComponents(r-n,c-a,p-h,o-f).normalize(),e[4].setComponents(r-i,c-l,p-g,o-m).normalize(),e[5].setComponents(r+i,c+l,p+g,o+m).normalize(),this},Ma.prototype.intersectsObject=function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Ia.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Ia)},Ma.prototype.intersectsSprite=function(t){return Ia.center.set(0,0,0),Ia.radius=.7071067811865476,Ia.applyMatrix4(t.matrixWorld),this.intersectsSphere(Ia)},Ma.prototype.intersectsSphere=function(t){var e=this.planes,o=t.center;t=-t.radius;for(var n=0;6>n;n++)if(e[n].distanceToPoint(o)<t)return!1;return!0},Ma.prototype.intersectsBox=function(t){for(var e=this.planes,o=0;6>o;o++){var n=e[o];if(Ba.x=0<n.normal.x?t.max.x:t.min.x,Ba.y=0<n.normal.y?t.max.y:t.min.y,Ba.z=0<n.normal.z?t.max.z:t.min.z,0>n.distanceToPoint(Ba))return!1}return!0},Ma.prototype.containsPoint=function(t){for(var e=this.planes,o=0;6>o;o++)if(0>e[o].distanceToPoint(t))return!1;return!0},H.prototype=Object.create(k.prototype),H.prototype.constructor=H,U.prototype=Object.create(S.prototype),U.prototype.constructor=U;var La={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor.xyz *= color.xyz;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n\tuniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},Na={common:{diffuse:{value:new Ys(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Sr},uv2Transform:{value:new Sr},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Er(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ys(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ys(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Sr}},sprite:{diffuse:{value:new Ys(15658734)},opacity:{value:1},center:{value:new Er(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Sr}}},Ra={basic:{uniforms:M([Na.common,Na.specularmap,Na.envmap,Na.aomap,Na.lightmap,Na.fog]),vertexShader:La.meshbasic_vert,fragmentShader:La.meshbasic_frag},lambert:{uniforms:M([Na.common,Na.specularmap,Na.envmap,Na.aomap,Na.lightmap,Na.emissivemap,Na.fog,Na.lights,{emissive:{value:new Ys(0)}}]),vertexShader:La.meshlambert_vert,fragmentShader:La.meshlambert_frag},phong:{uniforms:M([Na.common,Na.specularmap,Na.envmap,Na.aomap,Na.lightmap,Na.emissivemap,Na.bumpmap,Na.normalmap,Na.displacementmap,Na.fog,Na.lights,{emissive:{value:new Ys(0)},specular:{value:new Ys(1118481)},shininess:{value:30}}]),vertexShader:La.meshphong_vert,fragmentShader:La.meshphong_frag},standard:{uniforms:M([Na.common,Na.envmap,Na.aomap,Na.lightmap,Na.emissivemap,Na.bumpmap,Na.normalmap,Na.displacementmap,Na.roughnessmap,Na.metalnessmap,Na.fog,Na.lights,{emissive:{value:new Ys(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:La.meshphysical_vert,fragmentShader:La.meshphysical_frag},toon:{uniforms:M([Na.common,Na.aomap,Na.lightmap,Na.emissivemap,Na.bumpmap,Na.normalmap,Na.displacementmap,Na.gradientmap,Na.fog,Na.lights,{emissive:{value:new Ys(0)}}]),vertexShader:La.meshtoon_vert,fragmentShader:La.meshtoon_frag},matcap:{uniforms:M([Na.common,Na.bumpmap,Na.normalmap,Na.displacementmap,Na.fog,{matcap:{value:null}}]),vertexShader:La.meshmatcap_vert,fragmentShader:La.meshmatcap_frag},points:{uniforms:M([Na.points,Na.fog]),vertexShader:La.points_vert,fragmentShader:La.points_frag},dashed:{uniforms:M([Na.common,Na.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:La.linedashed_vert,fragmentShader:La.linedashed_frag},depth:{uniforms:M([Na.common,Na.displacementmap]),vertexShader:La.depth_vert,fragmentShader:La.depth_frag},normal:{uniforms:M([Na.common,Na.bumpmap,Na.normalmap,Na.displacementmap,{opacity:{value:1}}]),vertexShader:La.normal_vert,fragmentShader:La.normal_frag},sprite:{uniforms:M([Na.sprite,Na.fog]),vertexShader:La.sprite_vert,fragmentShader:La.sprite_frag},background:{uniforms:{uvTransform:{value:new Sr},t2D:{value:null}},vertexShader:La.background_vert,fragmentShader:La.background_frag},cube:{uniforms:M([Na.envmap,{opacity:{value:1}}]),vertexShader:La.cube_vert,fragmentShader:La.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:La.equirect_vert,fragmentShader:La.equirect_frag},distanceRGBA:{uniforms:M([Na.common,Na.displacementmap,{referencePosition:{value:new Mr},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:La.distanceRGBA_vert,fragmentShader:La.distanceRGBA_frag},shadow:{uniforms:M([Na.lights,Na.fog,{color:{value:new Ys(0)},opacity:{value:1}}]),vertexShader:La.shadow_vert,fragmentShader:La.shadow_frag}};Ra.physical={uniforms:M([Ra.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Er(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Ys(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:La.meshphysical_vert,fragmentShader:La.meshphysical_frag},ot.prototype=Object.create(o.prototype),ot.prototype.constructor=ot,ot.prototype.isCubeTexture=!0,Object.defineProperty(ot.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),nt.prototype=Object.create(o.prototype),nt.prototype.constructor=nt,nt.prototype.isDataTexture2DArray=!0,it.prototype=Object.create(o.prototype),it.prototype.constructor=it,it.prototype.isDataTexture3D=!0;var Da=new o,Oa=new nt,Pa=new it,ja=new ot,Fa=[],Ha=[],Ua=new Float32Array(16),Ga=new Float32Array(9),Va=new Float32Array(4);Ut.prototype.updateCache=function(t){var e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),at(e,t)},Gt.prototype.setValue=function(t,e,o){for(var n=this.seq,i=0,r=n.length;i!==r;++i){var s=n[i];s.setValue(t,e[s.id],o)}};var Wa=/([\w\d_]+)(\])?(\[|\.)?/g;Vt.prototype.setValue=function(t,e,o,n){void 0!==(e=this.map[e])&&e.setValue(t,o,n)},Vt.prototype.setOptional=function(t,e,o){void 0!==(e=e[o])&&this.setValue(t,o,e)},Vt.upload=function(t,e,o,n){for(var i=0,r=e.length;i!==r;++i){var s=e[i],a=o[s.id];!1!==a.needsUpdate&&s.setValue(t,a.value,n)}},Vt.seqWithValue=function(t,e){for(var o=[],n=0,i=t.length;n!==i;++n){var r=t[n];r.id in e&&o.push(r)}return o};var za=0,qa=/^[ \t]*#include +<([\w\d.\/]+)>/gm,Xa=/#pragma unroll_loop[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Ya=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g,Ka=0;Ee.prototype=Object.create(u.prototype),Ee.prototype.constructor=Ee,Ee.prototype.isMeshDepthMaterial=!0,Ee.prototype.copy=function(t){return u.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},xe.prototype=Object.create(u.prototype),xe.prototype.constructor=xe,xe.prototype.isMeshDistanceMaterial=!0,xe.prototype.copy=function(t){return u.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},ke.prototype=Object.assign(Object.create(R.prototype),{constructor:ke,isArrayCamera:!0}),Ae.prototype=Object.assign(Object.create(s.prototype),{constructor:Ae,isGroup:!0}),Object.assign(Ie.prototype,{constructor:Ie,getHandSpace:function(){if(null===this._hand&&(this._hand=new Ae,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints=[],this._hand.inputState={pinching:!1},window.XRHand))for(var t=0;t<=window.XRHand.LITTLE_PHALANX_TIP;t++){var e=new Ae;e.matrixAutoUpdate=!1,e.visible=!1,this._hand.joints.push(e),this._hand.add(e)}return this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new Ae,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new Ae,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this},disconnect:function(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(t,e,o){var n=null,i=null,r=null,s=this._targetRay,a=this._grip,l=this._hand;if(t)if(l&&t.hand){r=!0;for(var c=0;c<=window.XRHand.LITTLE_PHALANX_TIP;c++)if(t.hand[c]){var u=e.getJointPose(t.hand[c],o),h=l.joints[c];null!==u&&(h.matrix.fromArray(u.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.jointRadius=u.radius),h.visible=null!==u,u=l.joints[window.XRHand.INDEX_PHALANX_TIP].position.distanceTo(l.joints[window.XRHand.THUMB_PHALANX_TIP].position),l.inputState.pinching&&.025<u?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&.015>=u&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}}else null!==s&&null!==(n=e.getPose(t.targetRaySpace,o))&&(s.matrix.fromArray(n.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale)),null!==a&&t.gripSpace&&null!==(i=e.getPose(t.gripSpace,o))&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale));return null!==s&&(s.visible=null!==n),null!==a&&(a.visible=null!==i),null!==l&&(l.visible=null!==r),this}}),Object.assign(Be.prototype,e.prototype),Ne.prototype=Object.assign(Object.create(Le.prototype),{constructor:Ne,isWebGL1Renderer:!0});var $a=function(t,e){Object.defineProperty(this,"isFogExp2",{value:!0}),this.name="",this.color=new Ys(t),this.density=void 0!==e?e:25e-5};$a.prototype.clone=function(){return new $a(this.color,this.density)},$a.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}};var Qa=function(t,e,o){Object.defineProperty(this,"isFog",{value:!0}),this.name="",this.color=new Ys(t),this.near=void 0!==e?e:1,this.far=void 0!==o?o:1e3};Qa.prototype.clone=function(){return new Qa(this.color,this.near,this.far)},Qa.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},Re.prototype=Object.create(s.prototype),Re.prototype.constructor=Re,Re.prototype.copy=function(t,e){return s.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},Re.prototype.toJSON=function(t){var e=s.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.environment&&(e.object.environment=this.environment.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},Object.defineProperty(De.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(De.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,e,o){t*=this.stride,o*=e.stride;for(var n=0,i=this.stride;n<i;n++)this.array[t+n]=e.array[o+n];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=br.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer),t=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),t=new De(t,this.stride),t.setUsage(this.usage),t},onUpload:function(t){return this.onUploadCallback=t,this},toJSON:function(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=br.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});var Ja=new Mr;Object.defineProperties(Oe.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(t){this.data.needsUpdate=t}}}),Object.assign(Oe.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(var e=0,o=this.data.count;e<o;e++)Ja.x=this.getX(e),Ja.y=this.getY(e),Ja.z=this.getZ(e),Ja.applyMatrix4(t),this.setXYZ(e,Ja.x,Ja.y,Ja.z);return this},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,o){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=o,this},setXYZ:function(t,e,o,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=o,this.data.array[t+2]=n,this},setXYZW:function(t,e,o,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=o,this.data.array[t+2]=n,this.data.array[t+3]=i,this},clone:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data."),t=[];for(var e=0;e<this.count;e++)for(var o=e*this.data.stride+this.offset,n=0;n<this.itemSize;n++)t.push(this.data.array[o+n]);return new g(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new Oe(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data."),t=[];for(var e=0;e<this.count;e++)for(var o=e*this.data.stride+this.offset,n=0;n<this.itemSize;n++)t.push(this.data.array[o+n]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}),Pe.prototype=Object.create(u.prototype),Pe.prototype.constructor=Pe,Pe.prototype.isSpriteMaterial=!0,Pe.prototype.copy=function(t){return u.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};var Za,tl=new Mr,el=new Mr,ol=new Mr,nl=new Er,il=new Er,rl=new is,sl=new Mr,al=new Mr,ll=new Mr,cl=new Er,ul=new Er,hl=new Er;je.prototype=Object.assign(Object.create(s.prototype),{constructor:je,isSprite:!0,raycast:function(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),el.setFromMatrixScale(this.matrixWorld),rl.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),ol.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&el.multiplyScalar(-ol.z);var o=this.material.rotation;if(0!==o)var n=Math.cos(o),i=Math.sin(o);o=this.center,Fe(sl.set(-.5,-.5,0),ol,o,el,i,n),Fe(al.set(.5,-.5,0),ol,o,el,i,n),Fe(ll.set(.5,.5,0),ol,o,el,i,n),cl.set(0,0),ul.set(1,0),hl.set(1,1);var r=t.ray.intersectTriangle(sl,al,ll,!1,tl);null===r&&(Fe(al.set(-.5,.5,0),ol,o,el,i,n),ul.set(0,1),null===(r=t.ray.intersectTriangle(sl,ll,al,!1,tl)))||(i=t.ray.origin.distanceTo(tl))<t.near||i>t.far||e.push({distance:i,point:tl.clone(),uv:Ws.getUV(tl,sl,al,ll,cl,ul,hl,new Er),face:null,object:this})},copy:function(t){return s.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}});var gl=new Mr,pl=new Mr;He.prototype=Object.assign(Object.create(s.prototype),{constructor:He,isLOD:!0,copy:function(t){s.prototype.copy.call(this,t,!1);for(var e=t.levels,o=0,n=e.length;o<n;o++){var i=e[o];this.addLevel(i.object.clone(),i.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);var o,n=this.levels;for(o=0;o<n.length&&!(e<n[o].distance);o++);return n.splice(o,0,{distance:e,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){var e=this.levels;if(0<e.length){var o,n=1;for(o=e.length;n<o&&!(t<e[n].distance);n++);return e[n-1].object}return null},raycast:function(t,e){if(0<this.levels.length){gl.setFromMatrixPosition(this.matrixWorld);var o=t.ray.origin.distanceTo(gl);this.getObjectForDistance(o).raycast(t,e)}},update:function(t){var e=this.levels;if(1<e.length){gl.setFromMatrixPosition(t.matrixWorld),pl.setFromMatrixPosition(this.matrixWorld),t=gl.distanceTo(pl)/t.zoom,e[0].object.visible=!0;var o,n=1;for(o=e.length;n<o&&t>=e[n].distance;n++)e[n-1].object.visible=!1,e[n].object.visible=!0;for(this._currentLevel=n-1;n<o;n++)e[n].object.visible=!1}},toJSON:function(t){t=s.prototype.toJSON.call(this,t),!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];for(var e=this.levels,o=0,n=e.length;o<n;o++){var i=e[o];t.object.levels.push({object:i.object.uuid,distance:i.distance})}return t}}),Ue.prototype=Object.assign(Object.create(T.prototype),{constructor:Ue,isSkinnedMesh:!0,copy:function(t){return T.prototype.copy.call(this,t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this},bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new kr,e=this.geometry.attributes.skinWeight,o=0,n=e.count;o<n;o++){t.x=e.getX(o),t.y=e.getY(o),t.z=e.getZ(o),t.w=e.getW(o);var i=1/t.manhattanLength();1/0!==i?t.multiplyScalar(i):t.set(1,0,0,0),e.setXYZW(o,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){T.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(){var t=new Mr,e=new kr,o=new kr,n=new Mr,i=new is;return function(r,s){var a=this.skeleton,l=this.geometry;for(e.fromBufferAttribute(l.attributes.skinIndex,r),o.fromBufferAttribute(l.attributes.skinWeight,r),t.fromBufferAttribute(l.attributes.position,r).applyMatrix4(this.bindMatrix),s.set(0,0,0),r=0;4>r;r++)if(0!==(l=o.getComponent(r))){var c=e.getComponent(r);i.multiplyMatrices(a.bones[c].matrixWorld,a.boneInverses[c]),s.addScaledVector(n.copy(t).applyMatrix4(i),l)}return s.applyMatrix4(this.bindMatrixInverse)}}()});var dl=new is,fl=new is;Object.assign(Ge.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var o=new is;this.bones[t]&&o.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(o)}},pose:function(){for(var t=0,e=this.bones.length;t<e;t++){var o=this.bones[t];o&&o.matrixWorld.getInverse(this.boneInverses[t])}for(t=0,e=this.bones.length;t<e;t++)(o=this.bones[t])&&(o.parent&&o.parent.isBone?(o.matrix.getInverse(o.parent.matrixWorld),o.matrix.multiply(o.matrixWorld)):o.matrix.copy(o.matrixWorld),o.matrix.decompose(o.position,o.quaternion,o.scale))},update:function(){for(var t=this.bones,e=this.boneInverses,o=this.boneMatrices,n=this.boneTexture,i=0,r=t.length;i<r;i++)dl.multiplyMatrices(t[i]?t[i].matrixWorld:fl,e[i]),dl.toArray(o,16*i);void 0!==n&&(n.needsUpdate=!0)},clone:function(){return new Ge(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,o=this.bones.length;e<o;e++){var n=this.bones[e];if(n.name===t)return n}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),Ve.prototype=Object.assign(Object.create(s.prototype),{constructor:Ve,isBone:!0});var ml=new is,yl=new is,vl=[],_l=new T;We.prototype=Object.assign(Object.create(T.prototype),{constructor:We,isInstancedMesh:!0,copy:function(t){return T.prototype.copy.call(this,t),this.instanceMatrix.copy(t.instanceMatrix),this.count=t.count,this},setColorAt:function(t,e){null===this.instanceColor&&(this.instanceColor=new g(new Float32Array(3*this.count),3)),e.toArray(this.instanceColor.array,3*t)},getMatrixAt:function(t,e){e.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,e){var o=this.matrixWorld,n=this.count;if(_l.geometry=this.geometry,_l.material=this.material,void 0!==_l.material)for(var i=0;i<n;i++){this.getMatrixAt(i,ml),yl.multiplyMatrices(o,ml),_l.matrixWorld=yl,_l.raycast(t,vl);for(var r=0,s=vl.length;r<s;r++){var a=vl[r];a.instanceId=i,a.object=this,e.push(a)}vl.length=0}},setMatrixAt:function(t,e){e.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){}}),ze.prototype=Object.create(u.prototype),ze.prototype.constructor=ze,ze.prototype.isLineBasicMaterial=!0,ze.prototype.copy=function(t){return u.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this};var bl=new Mr,El=new Mr,xl=new is,Sl=new ns,Tl=new Kr;qe.prototype=Object.assign(Object.create(s.prototype),{constructor:qe,isLine:!0,copy:function(t){return s.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,o=[0],n=1,i=e.count;n<i;n++)bl.fromBufferAttribute(e,n-1),El.fromBufferAttribute(e,n),o[n]=o[n-1],o[n]+=bl.distanceTo(El);t.setAttribute("lineDistance",new b(o,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry)for(e=t.vertices,t=t.lineDistances,t[0]=0,o=1,n=e.length;o<n;o++)t[o]=t[o-1],t[o]+=e[o-1].distanceTo(e[o]);return this},raycast:function(t,e){var o=this.geometry,n=this.matrixWorld,i=t.params.Line.threshold;if(null===o.boundingSphere&&o.computeBoundingSphere(),Tl.copy(o.boundingSphere),Tl.applyMatrix4(n),Tl.radius+=i,!1!==t.ray.intersectsSphere(Tl)){xl.getInverse(n),Sl.copy(t.ray).applyMatrix4(xl),n=i/((this.scale.x+this.scale.y+this.scale.z)/3),n*=n;var r=new Mr,s=new Mr;i=new Mr;var a=new Mr,l=this&&this.isLineSegments?2:1;if(o.isBufferGeometry){var c=o.index;if(o=o.attributes.position.array,null!==c){c=c.array;for(var u=0,h=c.length-1;u<h;u+=l){var g=c[u+1];r.fromArray(o,3*c[u]),s.fromArray(o,3*g),Sl.distanceSqToSegment(r,s,a,i)>n||(a.applyMatrix4(this.matrixWorld),(g=t.ray.origin.distanceTo(a))<t.near||g>t.far||e.push({distance:g,point:i.clone().applyMatrix4(this.matrixWorld),index:u,face:null,faceIndex:null,object:this}))}}else for(c=0,u=o.length/3-1;c<u;c+=l)r.fromArray(o,3*c),s.fromArray(o,3*c+3),Sl.distanceSqToSegment(r,s,a,i)>n||(a.applyMatrix4(this.matrixWorld),(h=t.ray.origin.distanceTo(a))<t.near||h>t.far||e.push({distance:h,point:i.clone().applyMatrix4(this.matrixWorld),index:c,face:null,faceIndex:null,object:this}))}else if(o.isGeometry)for(r=o.vertices,s=r.length,o=0;o<s-1;o+=l)Sl.distanceSqToSegment(r[o],r[o+1],a,i)>n||(a.applyMatrix4(this.matrixWorld),(c=t.ray.origin.distanceTo(a))<t.near||c>t.far||e.push({distance:c,point:i.clone().applyMatrix4(this.matrixWorld),index:o,face:null,faceIndex:null,object:this}))}},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){t=t.morphAttributes;var e=Object.keys(t);if(0<e.length&&void 0!==(t=t[e[0]])){this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0;for(var o=t.length;e<o;e++){var n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}else void 0!==(t=t.morphTargets)&&0<t.length&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}});var wl=new Mr,Cl=new Mr;Xe.prototype=Object.assign(Object.create(qe.prototype),{constructor:Xe,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(null===t.index){for(var e=t.attributes.position,o=[],n=0,i=e.count;n<i;n+=2)wl.fromBufferAttribute(e,n),Cl.fromBufferAttribute(e,n+1),o[n]=0===n?0:o[n-1],o[n+1]=o[n]+wl.distanceTo(Cl);t.setAttribute("lineDistance",new b(o,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry)for(e=t.vertices,t=t.lineDistances,o=0,n=e.length;o<n;o+=2)wl.copy(e[o]),Cl.copy(e[o+1]),t[o]=0===o?0:t[o-1],t[o+1]=t[o]+wl.distanceTo(Cl);return this}}),Ye.prototype=Object.assign(Object.create(qe.prototype),{constructor:Ye,isLineLoop:!0}),Ke.prototype=Object.create(u.prototype),Ke.prototype.constructor=Ke,Ke.prototype.isPointsMaterial=!0,Ke.prototype.copy=function(t){return u.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};var kl=new is,Al=new ns,Il=new Kr,Bl=new Mr;$e.prototype=Object.assign(Object.create(s.prototype),{constructor:$e,isPoints:!0,copy:function(t){return s.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},raycast:function(t,e){var o=this.geometry,n=this.matrixWorld,i=t.params.Points.threshold;if(null===o.boundingSphere&&o.computeBoundingSphere(),Il.copy(o.boundingSphere),Il.applyMatrix4(n),Il.radius+=i,!1!==t.ray.intersectsSphere(Il))if(kl.getInverse(n),Al.copy(t.ray).applyMatrix4(kl),i/=(this.scale.x+this.scale.y+this.scale.z)/3,i*=i,o.isBufferGeometry){var r=o.index;if(o=o.attributes.position.array,null!==r){r=r.array;for(var s=0,a=r.length;s<a;s++){var l=r[s];Bl.fromArray(o,3*l),Qe(Bl,l,i,n,t,e,this)}}else for(r=0,s=o.length/3;r<s;r++)Bl.fromArray(o,3*r),Qe(Bl,r,i,n,t,e,this)}else for(o=o.vertices,r=0,s=o.length;r<s;r++)Qe(o[r],r,i,n,t,e,this)},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){t=t.morphAttributes;var e=Object.keys(t);if(0<e.length&&void 0!==(t=t[e[0]])){this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0;for(var o=t.length;e<o;e++){var n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}else void 0!==(t=t.morphTargets)&&0<t.length&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}),Je.prototype=Object.assign(Object.create(o.prototype),{constructor:Je,isVideoTexture:!0,update:function(){var t=this.image;!1=="requestVideoFrameCallback"in t&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Ze.prototype=Object.create(o.prototype),Ze.prototype.constructor=Ze,Ze.prototype.isCompressedTexture=!0,to.prototype=Object.create(o.prototype),to.prototype.constructor=to,to.prototype.isCanvasTexture=!0,eo.prototype=Object.create(o.prototype),eo.prototype.constructor=eo,eo.prototype.isDepthTexture=!0,oo.prototype=Object.create(S.prototype),oo.prototype.constructor=oo,no.prototype=Object.create(k.prototype),no.prototype.constructor=no,io.prototype=Object.create(S.prototype),io.prototype.constructor=io,ro.prototype=Object.create(k.prototype),ro.prototype.constructor=ro,so.prototype=Object.create(S.prototype),so.prototype.constructor=so,ao.prototype=Object.create(k.prototype),ao.prototype.constructor=ao,lo.prototype=Object.create(so.prototype),lo.prototype.constructor=lo,co.prototype=Object.create(k.prototype),co.prototype.constructor=co,uo.prototype=Object.create(so.prototype),uo.prototype.constructor=uo,ho.prototype=Object.create(k.prototype),ho.prototype.constructor=ho,go.prototype=Object.create(so.prototype),go.prototype.constructor=go,po.prototype=Object.create(k.prototype),po.prototype.constructor=po,fo.prototype=Object.create(so.prototype),fo.prototype.constructor=fo,mo.prototype=Object.create(k.prototype),mo.prototype.constructor=mo,yo.prototype=Object.create(S.prototype),yo.prototype.constructor=yo,yo.prototype.toJSON=function(){var t=S.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},vo.prototype=Object.create(k.prototype),vo.prototype.constructor=vo,_o.prototype=Object.create(S.prototype),_o.prototype.constructor=_o,bo.prototype=Object.create(k.prototype),bo.prototype.constructor=bo,Eo.prototype=Object.create(S.prototype),Eo.prototype.constructor=Eo;var Ml={triangulate:function(t,e,o){o=o||2;var n=e&&e.length,i=n?e[0]*o:t.length,r=xo(t,0,i,o,!0),s=[];if(!r||r.next===r.prev)return s;var a;if(n){var l=o;n=[];var c,u=0;for(c=e.length;u<c;u++){var h=e[u]*l;h=xo(t,h,u<c-1?e[u+1]*l:t.length,l,!1),h===h.next&&(h.steiner=!0),n.push(Io(h))}for(n.sort(Co),u=0;u<n.length;u++)l=n[u],e=r,(e=ko(l,e))&&(l=Po(e,l),So(e,e.next),So(l,l.next)),r=So(r,r.next)}if(t.length>80*o){var g=a=t[0],p=n=t[1];for(l=o;l<i;l+=o)u=t[l],e=t[l+1],u<g&&(g=u),e<p&&(p=e),u>a&&(a=u),e>n&&(n=e);a=Math.max(a-g,n-p),a=0!==a?1/a:0}return To(r,s,o,g,p,a),s}},Ll={area:function(t){for(var e=t.length,o=0,n=e-1,i=0;i<e;n=i++)o+=t[n].x*t[i].y-t[i].x*t[n].y;return.5*o},isClockWise:function(t){return 0>Ll.area(t)},triangulateShape:function(t,e){var o=[],n=[],i=[];Uo(t),Go(o,t),t=t.length,e.forEach(Uo);for(var r=0;r<e.length;r++)n.push(t),t+=e[r].length,Go(o,e[r]);for(e=Ml.triangulate(o,n),o=0;o<e.length;o+=3)i.push(e.slice(o,o+3));return i}};Vo.prototype=Object.create(k.prototype),Vo.prototype.constructor=Vo,Vo.prototype.toJSON=function(){var t=k.prototype.toJSON.call(this);return zo(this.parameters.shapes,this.parameters.options,t)},Wo.prototype=Object.create(S.prototype),Wo.prototype.constructor=Wo,Wo.prototype.toJSON=function(){var t=S.prototype.toJSON.call(this);return zo(this.parameters.shapes,this.parameters.options,t)};var Nl={generateTopUV:function(t,e,o,n,i){t=e[3*n],n=e[3*n+1];var r=e[3*i];return i=e[3*i+1],[new Er(e[3*o],e[3*o+1]),new Er(t,n),new Er(r,i)]},generateSideWallUV:function(t,e,o,n,i,r){t=e[3*o];var s=e[3*o+1];o=e[3*o+2];var a=e[3*n],l=e[3*n+1];n=e[3*n+2];var c=e[3*i],u=e[3*i+1];i=e[3*i+2];var h=e[3*r],g=e[3*r+1];return e=e[3*r+2],.01>Math.abs(s-l)?[new Er(t,1-o),new Er(a,1-n),new Er(c,1-i),new Er(h,1-e)]:[new Er(s,1-o),new Er(l,1-n),new Er(u,1-i),new Er(g,1-e)]}};qo.prototype=Object.create(k.prototype),qo.prototype.constructor=qo,Xo.prototype=Object.create(Wo.prototype),Xo.prototype.constructor=Xo,Yo.prototype=Object.create(k.prototype),Yo.prototype.constructor=Yo,Ko.prototype=Object.create(S.prototype),Ko.prototype.constructor=Ko,$o.prototype=Object.create(k.prototype),$o.prototype.constructor=$o,Qo.prototype=Object.create(S.prototype),Qo.prototype.constructor=Qo,Jo.prototype=Object.create(k.prototype),Jo.prototype.constructor=Jo,Zo.prototype=Object.create(S.prototype),Zo.prototype.constructor=Zo,tn.prototype=Object.create(k.prototype),tn.prototype.constructor=tn,tn.prototype.toJSON=function(){var t=k.prototype.toJSON.call(this);return on(this.parameters.shapes,t)},en.prototype=Object.create(S.prototype),en.prototype.constructor=en,en.prototype.toJSON=function(){var t=S.prototype.toJSON.call(this);return on(this.parameters.shapes,t)},nn.prototype=Object.create(S.prototype),nn.prototype.constructor=nn,rn.prototype=Object.create(k.prototype),rn.prototype.constructor=rn,sn.prototype=Object.create(S.prototype),sn.prototype.constructor=sn,an.prototype=Object.create(rn.prototype),an.prototype.constructor=an,ln.prototype=Object.create(sn.prototype),ln.prototype.constructor=ln,cn.prototype=Object.create(k.prototype),cn.prototype.constructor=cn,un.prototype=Object.create(S.prototype),un.prototype.constructor=un;var Rl=Object.freeze({__proto__:null,WireframeGeometry:oo,ParametricGeometry:no,ParametricBufferGeometry:io,TetrahedronGeometry:ao,TetrahedronBufferGeometry:lo,OctahedronGeometry:co,OctahedronBufferGeometry:uo,IcosahedronGeometry:ho,IcosahedronBufferGeometry:go,DodecahedronGeometry:po,DodecahedronBufferGeometry:fo,PolyhedronGeometry:ro,PolyhedronBufferGeometry:so,TubeGeometry:mo,TubeBufferGeometry:yo,TorusKnotGeometry:vo,TorusKnotBufferGeometry:_o,TorusGeometry:bo,TorusBufferGeometry:Eo,TextGeometry:qo,TextBufferGeometry:Xo,SphereGeometry:Yo,SphereBufferGeometry:Ko,RingGeometry:$o,RingBufferGeometry:Qo,PlaneGeometry:H,PlaneBufferGeometry:U,LatheGeometry:Jo,LatheBufferGeometry:Zo,ShapeGeometry:tn,ShapeBufferGeometry:en,ExtrudeGeometry:Vo,ExtrudeBufferGeometry:Wo,EdgesGeometry:nn,ConeGeometry:an,ConeBufferGeometry:ln,CylinderGeometry:rn,CylinderBufferGeometry:sn,CircleGeometry:cn,CircleBufferGeometry:un,BoxGeometry:A,BoxBufferGeometry:I});hn.prototype=Object.create(u.prototype),hn.prototype.constructor=hn,hn.prototype.isShadowMaterial=!0,hn.prototype.copy=function(t){return u.prototype.copy.call(this,t),this.color.copy(t.color),this},gn.prototype=Object.create(L.prototype),gn.prototype.constructor=gn,gn.prototype.isRawShaderMaterial=!0,pn.prototype=Object.create(u.prototype),pn.prototype.constructor=pn,pn.prototype.isMeshStandardMaterial=!0,pn.prototype.copy=function(t){return u.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},dn.prototype=Object.create(pn.prototype),dn.prototype.constructor=dn,dn.prototype.isMeshPhysicalMaterial=!0,dn.prototype.copy=function(t){return pn.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,this.sheen=t.sheen?(this.sheen||new Ys).copy(t.sheen):null,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this},fn.prototype=Object.create(u.prototype),fn.prototype.constructor=fn,fn.prototype.isMeshPhongMaterial=!0,fn.prototype.copy=function(t){return u.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},mn.prototype=Object.create(u.prototype),mn.prototype.constructor=mn,mn.prototype.isMeshToonMaterial=!0,mn.prototype.copy=function(t){return u.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},yn.prototype=Object.create(u.prototype),yn.prototype.constructor=yn,yn.prototype.isMeshNormalMaterial=!0,yn.prototype.copy=function(t){return u.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},vn.prototype=Object.create(u.prototype),vn.prototype.constructor=vn,vn.prototype.isMeshLambertMaterial=!0,vn.prototype.copy=function(t){return u.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},_n.prototype=Object.create(u.prototype),_n.prototype.constructor=_n,_n.prototype.isMeshMatcapMaterial=!0,_n.prototype.copy=function(t){return u.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},bn.prototype=Object.create(ze.prototype),bn.prototype.constructor=bn,bn.prototype.isLineDashedMaterial=!0,bn.prototype.copy=function(t){return ze.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Dl=Object.freeze({__proto__:null,ShadowMaterial:hn,SpriteMaterial:Pe,RawShaderMaterial:gn,ShaderMaterial:L,PointsMaterial:Ke,MeshPhysicalMaterial:dn,MeshStandardMaterial:pn,MeshPhongMaterial:fn,MeshToonMaterial:mn,MeshNormalMaterial:yn,MeshLambertMaterial:vn,MeshDepthMaterial:Ee,MeshDistanceMaterial:xe,MeshBasicMaterial:h,MeshMatcapMaterial:_n,LineDashedMaterial:bn,LineBasicMaterial:ze,Material:u}),Ol={arraySlice:function(t,e,o){return Ol.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==o?o:t.length)):t.slice(e,o)},convertArray:function(t,e,o){return!t||!o&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,o=Array(e),n=0;n!==e;++n)o[n]=n;return o.sort(function(e,o){return t[e]-t[o]}),o},sortedArray:function(t,e,o){for(var n=t.length,i=new t.constructor(n),r=0,s=0;s!==n;++r)for(var a=o[r]*e,l=0;l!==e;++l)i[s++]=t[a+l];return i},flattenJSON:function(t,e,o,n){for(var i=1,r=t[0];void 0!==r&&void 0===r[n];)r=t[i++];if(void 0!==r){var s=r[n];if(void 0!==s)if(Array.isArray(s))do{s=r[n],void 0!==s&&(e.push(r.time),o.push.apply(o,s)),r=t[i++]}while(void 0!==r);else if(void 0!==s.toArray)do{s=r[n],void 0!==s&&(e.push(r.time),s.toArray(o,o.length)),r=t[i++]}while(void 0!==r);else do{s=r[n],void 0!==s&&(e.push(r.time),o.push(s)),r=t[i++]}while(void 0!==r)}},subclip:function(t,e,o,n,i){i=i||30,t=t.clone(),t.name=e,e=[];for(var r=0;r<t.tracks.length;++r){for(var s=t.tracks[r],a=s.getValueSize(),l=[],c=[],u=0;u<s.times.length;++u){var h=s.times[u]*i;if(!(h<o||h>=n))for(l.push(s.times[u]),h=0;h<a;++h)c.push(s.values[u*a+h])}0!==l.length&&(s.times=Ol.convertArray(l,s.times.constructor),s.values=Ol.convertArray(c,s.values.constructor),e.push(s))}for(t.tracks=e,o=1/0,n=0;n<t.tracks.length;++n)o>t.tracks[n].times[0]&&(o=t.tracks[n].times[0]);for(n=0;n<t.tracks.length;++n)t.tracks[n].shift(-1*o);return t.resetDuration(),t},makeClipAdditive:function(t,e,o,n){void 0===e&&(e=0),void 0===o&&(o=t),(void 0===n||0>=n)&&(n=30);var i=t.tracks.length,r=e/n;for(e=function(e){var n=o.tracks[e],i=n.ValueTypeName;if("bool"!==i&&"string"!==i&&void 0!==(e=t.tracks.find(function(t){return t.name===n.name&&t.ValueTypeName===i}))){var s=0,a=n.getValueSize();n.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(s=a/3);var l=0,c=e.getValueSize();e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(l=c/3);var u=n.times.length-1,h=void 0;for(r<=n.times[0]?h=Ol.arraySlice(n.values,s,a-s):r>=n.times[u]?(h=u*a+s,h=Ol.arraySlice(n.values,h,h+a-s)):(h=n.createInterpolant(),u=s,s=a-s,h.evaluate(r),h=Ol.arraySlice(h.resultBuffer,u,s)),"quaternion"===i&&(new Ir).fromArray(h).normalize().conjugate().toArray(h),s=e.times.length,a=0;a<s;++a)if(u=a*c+l,"quaternion"===i)Ir.multiplyQuaternionsFlat(e.values,u,h,0,e.values,u);else for(var g=c-2*l,p=0;p<g;++p)e.values[u+p]-=h[p]}},n=0;n<i;++n)e(n);return t.blendMode=2501,t}};Object.assign(En.prototype,{evaluate:function(t){var e=this.parameterPositions,o=this._cachedIndex,n=e[o],i=e[o-1];t:{e:{o:{n:if(!(t<n)){for(var r=o+2;;){if(void 0===n){if(t<i)break n;return this._cachedIndex=o=e.length,this.afterEnd_(o-1,t,i)}if(o===r)break;if(i=n,n=e[++o],t<n)break e}n=e.length;break o}if(t>=i)break t;for(r=e[1],t<r&&(o=2,i=r),r=o-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(o===r)break;if(n=i,i=e[--o-1],t>=i)break e}n=o,o=0}for(;o<n;)i=o+n>>>1,t<e[i]?n=i:o=i+1;if(n=e[o],void 0===(i=e[o-1]))return this._cachedIndex=0,this.beforeStart_(0,t,n);if(void 0===n)return this._cachedIndex=o=e.length,this.afterEnd_(o-1,i,t)}this._cachedIndex=o,this.intervalChanged_(o,i,n)}return this.interpolate_(o,i,t,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){var e=this.resultBuffer,o=this.sampleValues,n=this.valueSize;t*=n;for(var i=0;i!==n;++i)e[i]=o[t+i];return e},interpolate_:function(){throw Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(En.prototype,{beforeStart_:En.prototype.copySampleValue_,afterEnd_:En.prototype.copySampleValue_}),xn.prototype=Object.assign(Object.create(En.prototype),{constructor:xn,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,e,o){var n=this.parameterPositions,i=t-2,r=t+1,s=n[i],a=n[r];if(void 0===s)switch(this.getSettings_().endingStart){case 2401:i=t,s=2*e-o;break;case 2402:i=n.length-2,s=e+n[i]-n[i+1];break;default:i=t,s=o}if(void 0===a)switch(this.getSettings_().endingEnd){case 2401:r=t,a=2*o-e;break;case 2402:r=1,a=o+n[1]-n[0];break;default:r=t-1,a=e}t=.5*(o-e),n=this.valueSize,this._weightPrev=t/(e-s),this._weightNext=t/(a-o),this._offsetPrev=i*n,this._offsetNext=r*n},interpolate_:function(t,e,o,n){var i=this.resultBuffer,r=this.sampleValues,s=this.valueSize;t*=s;var a=t-s,l=this._offsetPrev,c=this._offsetNext,u=this._weightPrev,h=this._weightNext,g=(o-e)/(n-e);for(o=g*g,n=o*g,e=-u*n+2*u*o-u*g,u=(1+u)*n+(-1.5-2*u)*o+(-.5+u)*g+1,g=(-1-h)*n+(1.5+h)*o+.5*g,h=h*n-h*o,o=0;o!==s;++o)i[o]=e*r[l+o]+u*r[a+o]+g*r[t+o]+h*r[c+o];return i}}),Sn.prototype=Object.assign(Object.create(En.prototype),{constructor:Sn,interpolate_:function(t,e,o,n){var i=this.resultBuffer,r=this.sampleValues,s=this.valueSize;t*=s;var a=t-s;for(e=(o-e)/(n-e),o=1-e,n=0;n!==s;++n)i[n]=r[a+n]*o+r[t+n]*e;return i}}),Tn.prototype=Object.assign(Object.create(En.prototype),{constructor:Tn,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Object.assign(wn,{toJSON:function(t){var e=t.constructor;if(void 0!==e.toJSON)e=e.toJSON(t);else{e={name:t.name,times:Ol.convertArray(t.times,Array),values:Ol.convertArray(t.values,Array)};var o=t.getInterpolation();o!==t.DefaultInterpolation&&(e.interpolation=o)}return e.type=t.ValueTypeName,e}}),Object.assign(wn.prototype,{constructor:wn,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new Tn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new Sn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new xn(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){switch(t){case 2300:var e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){if(e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw Error(e);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",e),this}return this.createInterpolant=e,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,o=0,n=e.length;o!==n;++o)e[o]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,o=0,n=e.length;o!==n;++o)e[o]*=t;return this},trim:function(t,e){for(var o=this.times,n=o.length,i=0,r=n-1;i!==n&&o[i]<t;)++i;for(;-1!==r&&o[r]>e;)--r;return++r,0===i&&r===n||(i>=r&&(r=Math.max(r,1),i=r-1),t=this.getValueSize(),this.times=Ol.arraySlice(o,i,r),this.values=Ol.arraySlice(this.values,i*t,r*t)),this},validate:function(){var t=!0,e=this.getValueSize();0!=e-Math.floor(e)&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var o=this.times;e=this.values;var n=o.length;0===n&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var i=null,r=0;r!==n;r++){var s=o[r];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,r,s),t=!1;break}if(null!==i&&i>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,r,s,i),t=!1;break}i=s}if(void 0!==e&&Ol.isTypedArray(e))for(o=0,n=e.length;o!==n;++o)if(i=e[o],isNaN(i)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,i),t=!1;break}return t},optimize:function(){for(var t=Ol.arraySlice(this.times),e=Ol.arraySlice(this.values),o=this.getValueSize(),n=2302===this.getInterpolation(),i=t.length-1,r=1,s=1;s<i;++s){var a=!1,l=t[s];if(l!==t[s+1]&&(1!==s||l!==l[0]))if(n)a=!0;else{l=s*o;for(var c=l-o,u=l+o,h=0;h!==o;++h){var g=e[l+h];if(g!==e[c+h]||g!==e[u+h]){a=!0;break}}}if(a){if(s!==r)for(t[r]=t[s],a=s*o,l=r*o,c=0;c!==o;++c)e[l+c]=e[a+c];++r}}if(0<i){for(t[r]=t[i],n=i*o,i=r*o,s=0;s!==o;++s)e[i+s]=e[n+s];++r}return r!==t.length?(this.times=Ol.arraySlice(t,0,r),this.values=Ol.arraySlice(e,0,r*o)):(this.times=t,this.values=e),this},clone:function(){var t=Ol.arraySlice(this.times,0),e=Ol.arraySlice(this.values,0);return t=new this.constructor(this.name,t,e),t.createInterpolant=this.createInterpolant,t}}),Cn.prototype=Object.assign(Object.create(wn.prototype),{constructor:Cn,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),kn.prototype=Object.assign(Object.create(wn.prototype),{constructor:kn,ValueTypeName:"color"}),An.prototype=Object.assign(Object.create(wn.prototype),{constructor:An,ValueTypeName:"number"}),In.prototype=Object.assign(Object.create(En.prototype),{constructor:In,interpolate_:function(t,e,o,n){var i=this.resultBuffer,r=this.sampleValues,s=this.valueSize;for(e=(o-e)/(n-e),t*=s,o=t+s;t!==o;t+=4)Ir.slerpFlat(i,0,r,t-s,r,t,e);return i}}),Bn.prototype=Object.assign(Object.create(wn.prototype),{constructor:Bn,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new In(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),Mn.prototype=Object.assign(Object.create(wn.prototype),{constructor:Mn,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Ln.prototype=Object.assign(Object.create(wn.prototype),{constructor:Ln,ValueTypeName:"vector"}),Object.assign(Nn,{parse:function(t){for(var e=[],o=t.tracks,n=1/(t.fps||1),i=0,r=o.length;i!==r;++i)e.push(Dn(o[i]).scale(n));return new Nn(t.name,t.duration,e,t.blendMode)},toJSON:function(t){var e=[],o=t.tracks;t={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(var n=0,i=o.length;n!==i;++n)e.push(wn.toJSON(o[n]));return t},CreateFromMorphTargetSequence:function(t,e,o,n){for(var i=e.length,r=[],s=0;s<i;s++){var a=[],l=[];a.push((s+i-1)%i,s,(s+1)%i),l.push(0,1,0);var c=Ol.getKeyframeOrder(a);a=Ol.sortedArray(a,1,c),l=Ol.sortedArray(l,1,c),n||0!==a[0]||(a.push(i),l.push(l[0])),r.push(new An(".morphTargetInfluences["+e[s].name+"]",a,l).scale(1/o))}return new Nn(t,-1,r)},findByName:function(t,e){var o=t;for(Array.isArray(t)||(o=t.geometry&&t.geometry.animations||t.animations),t=0;t<o.length;t++)if(o[t].name===e)return o[t];return null},CreateClipsFromMorphTargetSequences:function(t,e,o){for(var n={},i=/^([\w-]*?)([\d]+)$/,r=0,s=t.length;r<s;r++){var a=t[r],l=a.name.match(i);if(l&&1<l.length){l=l[1];var c=n[l];c||(n[l]=c=[]),c.push(a)}}t=[];for(var u in n)t.push(Nn.CreateFromMorphTargetSequence(u,n[u],e,o));return t},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;var o=function(t,e,o,n,i){if(0!==o.length){var r=[],s=[];Ol.flattenJSON(o,r,s,n),0!==r.length&&i.push(new t(e,r,s))}},n=[],i=t.name||"default",r=t.fps||30,s=t.blendMode,a=t.length||-1;t=t.hierarchy||[];for(var l=0;l<t.length;l++){var c=t[l].keys;if(c&&0!==c.length)if(c[0].morphTargets){a={};var u=void 0;for(u=0;u<c.length;u++)if(c[u].morphTargets)for(var h=0;h<c[u].morphTargets.length;h++)a[c[u].morphTargets[h]]=-1;for(var g in a){h=[];for(var p=[],d=0;d!==c[u].morphTargets.length;++d){var f=c[u];h.push(f.time),p.push(f.morphTarget===g?1:0)}n.push(new An(".morphTargetInfluence["+g+"]",h,p))}a=a.length*(r||1)}else u=".bones["+e[l].name+"]",o(Ln,u+".position",c,"pos",n),o(Bn,u+".quaternion",c,"rot",n),o(Ln,u+".scale",c,"scl",n)}return 0===n.length?null:new Nn(i,a,n,s)}}),Object.assign(Nn.prototype,{resetDuration:function(){for(var t=0,e=0,o=this.tracks.length;e!==o;++e){var n=this.tracks[e];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new Nn(this.name,this.duration,t,this.blendMode)}});var Pl={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},jl=new On;Object.assign(Pn.prototype,{load:function(){},loadAsync:function(t,e){var o=this;return new Promise(function(n,i){o.load(t,n,e,i)})},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});var Fl={};jn.prototype=Object.assign(Object.create(Pn.prototype),{constructor:jn,load:function(t,e,o,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,r=Pl.get(t);if(void 0!==r)return i.manager.itemStart(t),setTimeout(function(){e&&e(r),i.manager.itemEnd(t)},0),r;if(void 0===Fl[t]){var s=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(s){o=s[1];var a=!!s[2];s=s[3],s=decodeURIComponent(s),a&&(s=atob(s));try{var l=(this.responseType||"").toLowerCase();switch(l){case"arraybuffer":case"blob":var c=new Uint8Array(s.length);for(a=0;a<s.length;a++)c[a]=s.charCodeAt(a);var u="blob"===l?new Blob([c.buffer],{type:o}):c.buffer;break;case"document":u=(new DOMParser).parseFromString(s,o);break;case"json":u=JSON.parse(s);break;default:u=s}setTimeout(function(){e&&e(u),i.manager.itemEnd(t)},0)}catch(e){setTimeout(function(){n&&n(e),i.manager.itemError(t),i.manager.itemEnd(t)},0)}}else{Fl[t]=[],Fl[t].push({onLoad:e,onProgress:o,onError:n});var h=new XMLHttpRequest;h.open("GET",t,!0),h.addEventListener("load",function(e){var o=this.response,n=Fl[t];if(delete Fl[t],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Pl.add(t,o),e=0;for(var r=n.length;e<r;e++){var s=n[e];s.onLoad&&s.onLoad(o)}}else{for(o=0,r=n.length;o<r;o++)s=n[o],s.onError&&s.onError(e);i.manager.itemError(t)}i.manager.itemEnd(t)},!1),h.addEventListener("progress",function(e){for(var o=Fl[t],n=0,i=o.length;n<i;n++){var r=o[n];r.onProgress&&r.onProgress(e)}},!1),h.addEventListener("error",function(e){var o=Fl[t];delete Fl[t];for(var n=0,r=o.length;n<r;n++){var s=o[n];s.onError&&s.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)},!1),h.addEventListener("abort",function(e){var o=Fl[t];delete Fl[t];for(var n=0,r=o.length;n<r;n++){var s=o[n];s.onError&&s.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)},!1),void 0!==this.responseType&&(h.responseType=this.responseType),void 0!==this.withCredentials&&(h.withCredentials=this.withCredentials),h.overrideMimeType&&h.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(a in this.requestHeader)h.setRequestHeader(a,this.requestHeader[a]);h.send(null)}return i.manager.itemStart(t),h}Fl[t].push({onLoad:e,onProgress:o,onError:n})},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this}}),Fn.prototype=Object.assign(Object.create(Pn.prototype),{constructor:Fn,load:function(t,e,o,n){var i=this,r=new jn(i.manager);r.setPath(i.path),r.setRequestHeader(i.requestHeader),r.load(t,function(o){try{e(i.parse(JSON.parse(o)))}catch(e){n?n(e):console.error(e),i.manager.itemError(t)}},o,n)},parse:function(t){for(var e=[],o=0;o<t.length;o++){var n=Nn.parse(t[o]);e.push(n)}return e}}),Hn.prototype=Object.assign(Object.create(Pn.prototype),{constructor:Hn,load:function(t,e,o,n){var i=this,r=[],s=new Ze;s.image=r;var a=new jn(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader);var l=0;if(Array.isArray(t))for(var c=0,u=t.length;c<u;++c)!function(c){a.load(t[c],function(t){t=i.parse(t,!0),r[c]={width:t.width,height:t.height,format:t.format,mipmaps:t.mipmaps},6===(l+=1)&&(1===t.mipmapCount&&(s.minFilter=1006),s.format=t.format,s.needsUpdate=!0,e&&e(s))},o,n)}(c);else a.load(t,function(t){if(t=i.parse(t,!0),t.isCubemap)for(var o=t.mipmaps.length/t.mipmapCount,n=0;n<o;n++){r[n]={mipmaps:[]};for(var a=0;a<t.mipmapCount;a++)r[n].mipmaps.push(t.mipmaps[n*t.mipmapCount+a]),r[n].format=t.format,r[n].width=t.width,r[n].height=t.height}else s.image.width=t.width,s.image.height=t.height,s.mipmaps=t.mipmaps;1===t.mipmapCount&&(s.minFilter=1006),s.format=t.format,s.needsUpdate=!0,e&&e(s)},o,n);return s}}),Un.prototype=Object.assign(Object.create(Pn.prototype),{constructor:Un,load:function(t,e,o,n){function i(){l.removeEventListener("load",i,!1),l.removeEventListener("error",r,!1),Pl.add(t,this),e&&e(this),s.manager.itemEnd(t)}function r(e){l.removeEventListener("load",i,!1),l.removeEventListener("error",r,!1),n&&n(e),s.manager.itemError(t),s.manager.itemEnd(t)}void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var s=this,a=Pl.get(t);if(void 0!==a)return s.manager.itemStart(t),setTimeout(function(){e&&e(a),s.manager.itemEnd(t)},0),a;var l=document.createElementNS("http://www.w3.org/1999/xhtml","img");return l.addEventListener("load",i,!1),l.addEventListener("error",r,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(l.crossOrigin=this.crossOrigin),s.manager.itemStart(t),l.src=t,l}}),Gn.prototype=Object.assign(Object.create(Pn.prototype),{constructor:Gn,load:function(t,e,o,n){var i=new ot,r=new Un(this.manager);r.setCrossOrigin(this.crossOrigin),r.setPath(this.path);var s=0;for(o=0;o<t.length;++o)!function(o){r.load(t[o],function(t){i.images[o]=t,6==++s&&(i.needsUpdate=!0,e&&e(i))},void 0,n)}(o);return i}}),Vn.prototype=Object.assign(Object.create(Pn.prototype),{constructor:Vn,load:function(t,e,o,n){var i=this,r=new P,s=new jn(this.manager);return s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setPath(this.path),s.load(t,function(t){(t=i.parse(t))&&(void 0!==t.image?r.image=t.image:void 0!==t.data&&(r.image.width=t.width,r.image.height=t.height,r.image.data=t.data),r.wrapS=void 0!==t.wrapS?t.wrapS:1001,r.wrapT=void 0!==t.wrapT?t.wrapT:1001,r.magFilter=void 0!==t.magFilter?t.magFilter:1006,r.minFilter=void 0!==t.minFilter?t.minFilter:1006,r.anisotropy=void 0!==t.anisotropy?t.anisotropy:1,void 0!==t.format&&(r.format=t.format),void 0!==t.type&&(r.type=t.type),void 0!==t.mipmaps&&(r.mipmaps=t.mipmaps,r.minFilter=1008),1===t.mipmapCount&&(r.minFilter=1006),r.needsUpdate=!0,e&&e(r,t))},o,n),r}}),Wn.prototype=Object.assign(Object.create(Pn.prototype),{constructor:Wn,load:function(t,e,n,i){var r=new o,s=new Un(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(t,function(o){r.image=o,o=0<t.search(/\.jpe?g($|\?)/i)||0===t.search(/^data:image\/jpeg/),r.format=o?1022:1023,r.needsUpdate=!0,void 0!==e&&e(r)},n,i),r}}),Object.assign(zn.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){return t=this.getUtoTmapping(t),this.getPoint(t,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],o=0;o<=t;o++)e.push(this.getPoint(o/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],o=0;o<=t;o++)e.push(this.getPointAt(o/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e=[],o=this.getPoint(0),n=0;e.push(0);for(var i=1;i<=t;i++){var r=this.getPoint(i/t);n+=r.distanceTo(o),e.push(n),o=r}return this.cacheArcLengths=e},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var o=this.getLengths(),n=o.length;e=e||t*o[n-1];for(var i,r=0,s=n-1;r<=s;)if(t=Math.floor(r+(s-r)/2),0>(i=o[t]-e))r=t+1;else{if(!(0<i)){s=t;break}s=t-1}return t=s,o[t]===e?t/(n-1):(r=o[t],(t+(e-r)/(o[t+1]-r))/(n-1))},getTangent:function(t,e){var o=t-1e-4;return t+=1e-4,0>o&&(o=0),1<t&&(t=1),o=this.getPoint(o),t=this.getPoint(t),e=e||(o.isVector2?new Er:new Mr),e.copy(t).sub(o).normalize(),e},getTangentAt:function(t,e){return t=this.getUtoTmapping(t),this.getTangent(t,e)},computeFrenetFrames:function(t,e){for(var o=new Mr,n=[],i=[],r=[],s=new Mr,a=new is,l=0;l<=t;l++)n[l]=this.getTangentAt(l/t,new Mr),n[l].normalize();i[0]=new Mr,r[0]=new Mr,l=Number.MAX_VALUE;var c=Math.abs(n[0].x),u=Math.abs(n[0].y),h=Math.abs(n[0].z);for(c<=l&&(l=c,o.set(1,0,0)),u<=l&&(l=u,o.set(0,1,0)),h<=l&&o.set(0,0,1),s.crossVectors(n[0],o).normalize(),i[0].crossVectors(n[0],s),r[0].crossVectors(n[0],i[0]),o=1;o<=t;o++)i[o]=i[o-1].clone(),r[o]=r[o-1].clone(),s.crossVectors(n[o-1],n[o]),s.length()>Number.EPSILON&&(s.normalize(),l=Math.acos(br.clamp(n[o-1].dot(n[o]),-1,1)),i[o].applyMatrix4(a.makeRotationAxis(s,l))),r[o].crossVectors(n[o],i[o]);if(!0===e)for(e=Math.acos(br.clamp(i[0].dot(i[t]),-1,1)),e/=t,0<n[0].dot(s.crossVectors(i[0],i[t]))&&(e=-e),s=1;s<=t;s++)i[s].applyMatrix4(a.makeRotationAxis(n[s],e*s)),r[s].crossVectors(n[s],i[s]);return{tangents:n,normals:i,binormals:r}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),qn.prototype=Object.create(zn.prototype),qn.prototype.constructor=qn,qn.prototype.isEllipseCurve=!0,qn.prototype.getPoint=function(t,e){e=e||new Er;for(var o=2*Math.PI,n=this.aEndAngle-this.aStartAngle,i=Math.abs(n)<Number.EPSILON;0>n;)n+=o;for(;n>o;)n-=o;n<Number.EPSILON&&(n=i?0:o),!0!==this.aClockwise||i||(n=n===o?-o:n-o),o=this.aStartAngle+t*n,t=this.aX+this.xRadius*Math.cos(o);var r=this.aY+this.yRadius*Math.sin(o);return 0!==this.aRotation&&(o=Math.cos(this.aRotation),n=Math.sin(this.aRotation),i=t-this.aX,r-=this.aY,t=i*o-r*n+this.aX,r=i*n+r*o+this.aY),e.set(t,r)},qn.prototype.copy=function(t){return zn.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},qn.prototype.toJSON=function(){var t=zn.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},qn.prototype.fromJSON=function(t){return zn.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Xn.prototype=Object.create(qn.prototype),Xn.prototype.constructor=Xn,Xn.prototype.isArcCurve=!0;var Hl=new Mr,Ul=new Yn,Gl=new Yn,Vl=new Yn;Kn.prototype=Object.create(zn.prototype),Kn.prototype.constructor=Kn,Kn.prototype.isCatmullRomCurve3=!0,Kn.prototype.getPoint=function(t,e){e=e||new Mr;var o=this.points,n=o.length;t*=n-(this.closed?0:1);var i=Math.floor(t);if(t-=i,this.closed?i+=0<i?0:(Math.floor(Math.abs(i)/n)+1)*n:0===t&&i===n-1&&(i=n-2,t=1),this.closed||0<i)var r=o[(i-1)%n];else Hl.subVectors(o[0],o[1]).add(o[0]),r=Hl;var s=o[i%n],a=o[(i+1)%n];if(this.closed||i+2<n?o=o[(i+2)%n]:(Hl.subVectors(o[n-1],o[n-2]).add(o[n-1]),o=Hl),"centripetal"===this.curveType||"chordal"===this.curveType){var l="chordal"===this.curveType?.5:.25;n=Math.pow(r.distanceToSquared(s),l),i=Math.pow(s.distanceToSquared(a),l),l=Math.pow(a.distanceToSquared(o),l),1e-4>i&&(i=1),1e-4>n&&(n=i),1e-4>l&&(l=i),Ul.initNonuniformCatmullRom(r.x,s.x,a.x,o.x,n,i,l),Gl.initNonuniformCatmullRom(r.y,s.y,a.y,o.y,n,i,l),Vl.initNonuniformCatmullRom(r.z,s.z,a.z,o.z,n,i,l)}else"catmullrom"===this.curveType&&(Ul.initCatmullRom(r.x,s.x,a.x,o.x,this.tension),Gl.initCatmullRom(r.y,s.y,a.y,o.y,this.tension),Vl.initCatmullRom(r.z,s.z,a.z,o.z,this.tension));return e.set(Ul.calc(t),Gl.calc(t),Vl.calc(t)),e},Kn.prototype.copy=function(t){zn.prototype.copy.call(this,t),this.points=[];for(var e=0,o=t.points.length;e<o;e++)this.points.push(t.points[e].clone());return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Kn.prototype.toJSON=function(){var t=zn.prototype.toJSON.call(this);t.points=[];for(var e=0,o=this.points.length;e<o;e++)t.points.push(this.points[e].toArray());return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Kn.prototype.fromJSON=function(t){zn.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,o=t.points.length;e<o;e++){var n=t.points[e];this.points.push((new Mr).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Zn.prototype=Object.create(zn.prototype),Zn.prototype.constructor=Zn,Zn.prototype.isCubicBezierCurve=!0,Zn.prototype.getPoint=function(t,e){e=e||new Er;var o=this.v0,n=this.v1,i=this.v2,r=this.v3;return e.set(Jn(t,o.x,n.x,i.x,r.x),Jn(t,o.y,n.y,i.y,r.y)),e},Zn.prototype.copy=function(t){return zn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Zn.prototype.toJSON=function(){var t=zn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Zn.prototype.fromJSON=function(t){return zn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},ti.prototype=Object.create(zn.prototype),ti.prototype.constructor=ti,ti.prototype.isCubicBezierCurve3=!0,ti.prototype.getPoint=function(t,e){e=e||new Mr;var o=this.v0,n=this.v1,i=this.v2,r=this.v3;return e.set(Jn(t,o.x,n.x,i.x,r.x),Jn(t,o.y,n.y,i.y,r.y),Jn(t,o.z,n.z,i.z,r.z)),e},ti.prototype.copy=function(t){return zn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},ti.prototype.toJSON=function(){var t=zn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},ti.prototype.fromJSON=function(t){return zn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},ei.prototype=Object.create(zn.prototype),ei.prototype.constructor=ei,ei.prototype.isLineCurve=!0,ei.prototype.getPoint=function(t,e){return e=e||new Er,1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},ei.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},ei.prototype.getTangent=function(t,e){return t=e||new Er,t.copy(this.v2).sub(this.v1).normalize(),t},ei.prototype.copy=function(t){return zn.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ei.prototype.toJSON=function(){var t=zn.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ei.prototype.fromJSON=function(t){return zn.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},oi.prototype=Object.create(zn.prototype),oi.prototype.constructor=oi,oi.prototype.isLineCurve3=!0,oi.prototype.getPoint=function(t,e){return e=e||new Mr,1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},oi.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},oi.prototype.copy=function(t){return zn.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},oi.prototype.toJSON=function(){var t=zn.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},oi.prototype.fromJSON=function(t){return zn.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},ni.prototype=Object.create(zn.prototype),ni.prototype.constructor=ni,ni.prototype.isQuadraticBezierCurve=!0,ni.prototype.getPoint=function(t,e){e=e||new Er;var o=this.v0,n=this.v1,i=this.v2;return e.set(Qn(t,o.x,n.x,i.x),Qn(t,o.y,n.y,i.y)),e},ni.prototype.copy=function(t){return zn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ni.prototype.toJSON=function(){var t=zn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ni.prototype.fromJSON=function(t){return zn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},ii.prototype=Object.create(zn.prototype),ii.prototype.constructor=ii,ii.prototype.isQuadraticBezierCurve3=!0,ii.prototype.getPoint=function(t,e){e=e||new Mr;var o=this.v0,n=this.v1,i=this.v2;return e.set(Qn(t,o.x,n.x,i.x),Qn(t,o.y,n.y,i.y),Qn(t,o.z,n.z,i.z)),e},ii.prototype.copy=function(t){return zn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ii.prototype.toJSON=function(){var t=zn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ii.prototype.fromJSON=function(t){return zn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},ri.prototype=Object.create(zn.prototype),ri.prototype.constructor=ri,ri.prototype.isSplineCurve=!0,ri.prototype.getPoint=function(t,e){e=e||new Er;var o=this.points,n=(o.length-1)*t;t=Math.floor(n),n-=t;var i=o[0===t?t:t-1],r=o[t],s=o[t>o.length-2?o.length-1:t+1];return o=o[t>o.length-3?o.length-1:t+2],e.set($n(n,i.x,r.x,s.x,o.x),$n(n,i.y,r.y,s.y,o.y)),e},ri.prototype.copy=function(t){zn.prototype.copy.call(this,t),this.points=[];for(var e=0,o=t.points.length;e<o;e++)this.points.push(t.points[e].clone());return this},ri.prototype.toJSON=function(){var t=zn.prototype.toJSON.call(this);t.points=[];for(var e=0,o=this.points.length;e<o;e++)t.points.push(this.points[e].toArray());return t},ri.prototype.fromJSON=function(t){zn.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,o=t.points.length;e<o;e++){var n=t.points[e];this.points.push((new Er).fromArray(n))}return this};var Wl=Object.freeze({__proto__:null,ArcCurve:Xn,CatmullRomCurve3:Kn,CubicBezierCurve:Zn,CubicBezierCurve3:ti,EllipseCurve:qn,LineCurve:ei,LineCurve3:oi,QuadraticBezierCurve:ni,QuadraticBezierCurve3:ii,SplineCurve:ri});si.prototype=Object.assign(Object.create(zn.prototype),{constructor:si,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new ei(e,t))},getPoint:function(t){var e=t*this.getLength(),o=this.getCurveLengths();for(t=0;t<o.length;){if(o[t]>=e)return e=o[t]-e,t=this.curves[t],o=t.getLength(),t.getPointAt(0===o?0:1-e/o);t++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,o=0,n=this.curves.length;o<n;o++)e+=this.curves[o].getLength(),t.push(e);return this.cacheLengths=t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],o=0;o<=t;o++)e.push(this.getPoint(o/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,o=[],n=0,i=this.curves;n<i.length;n++){var r=i[n];r=r.getPoints(r&&r.isEllipseCurve?2*t:r&&(r.isLineCurve||r.isLineCurve3)?1:r&&r.isSplineCurve?t*r.points.length:t);for(var s=0;s<r.length;s++){var a=r[s];e&&e.equals(a)||(o.push(a),e=a)}}return this.autoClose&&1<o.length&&!o[o.length-1].equals(o[0])&&o.push(o[0]),o},copy:function(t){zn.prototype.copy.call(this,t),this.curves=[];for(var e=0,o=t.curves.length;e<o;e++)this.curves.push(t.curves[e].clone());return this.autoClose=t.autoClose,this},toJSON:function(){var t=zn.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,o=this.curves.length;e<o;e++)t.curves.push(this.curves[e].toJSON());return t},fromJSON:function(t){zn.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,o=t.curves.length;e<o;e++){var n=t.curves[e];this.curves.push((new Wl[n.type]).fromJSON(n))}return this}}),ai.prototype=Object.assign(Object.create(si.prototype),{constructor:ai,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,o=t.length;e<o;e++)this.lineTo(t[e].x,t[e].y);return this},moveTo:function(t,e){return this.currentPoint.set(t,e),this},lineTo:function(t,e){var o=new ei(this.currentPoint.clone(),new Er(t,e));return this.curves.push(o),this.currentPoint.set(t,e),this},quadraticCurveTo:function(t,e,o,n){return t=new ni(this.currentPoint.clone(),new Er(t,e),new Er(o,n)),this.curves.push(t),this.currentPoint.set(o,n),this},bezierCurveTo:function(t,e,o,n,i,r){return t=new Zn(this.currentPoint.clone(),new Er(t,e),new Er(o,n),new Er(i,r)),this.curves.push(t),this.currentPoint.set(i,r),this},splineThru:function(t){var e=[this.currentPoint.clone()].concat(t);return e=new ri(e),this.curves.push(e),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,e,o,n,i,r){return this.absarc(t+this.currentPoint.x,e+this.currentPoint.y,o,n,i,r),this},absarc:function(t,e,o,n,i,r){return this.absellipse(t,e,o,o,n,i,r),this},ellipse:function(t,e,o,n,i,r,s,a){return this.absellipse(t+this.currentPoint.x,e+this.currentPoint.y,o,n,i,r,s,a),this},absellipse:function(t,e,o,n,i,r,s,a){return t=new qn(t,e,o,n,i,r,s,a),0<this.curves.length&&(e=t.getPoint(0),e.equals(this.currentPoint)||this.lineTo(e.x,e.y)),this.curves.push(t),t=t.getPoint(1),this.currentPoint.copy(t),this},copy:function(t){return si.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=si.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return si.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),li.prototype=Object.assign(Object.create(ai.prototype),{constructor:li,getPointsHoles:function(t){for(var e=[],o=0,n=this.holes.length;o<n;o++)e[o]=this.holes[o].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){ai.prototype.copy.call(this,t),this.holes=[];for(var e=0,o=t.holes.length;e<o;e++)this.holes.push(t.holes[e].clone());return this},toJSON:function(){var t=ai.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,o=this.holes.length;e<o;e++)t.holes.push(this.holes[e].toJSON());return t},fromJSON:function(t){ai.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,o=t.holes.length;e<o;e++){var n=t.holes[e];this.holes.push((new ai).fromJSON(n))}return this}}),ci.prototype=Object.assign(Object.create(s.prototype),{constructor:ci,isLight:!0,copy:function(t){return s.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){return t=s.prototype.toJSON.call(this,t),t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),ui.prototype=Object.assign(Object.create(ci.prototype),{constructor:ui,isHemisphereLight:!0,copy:function(t){return ci.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(hi.prototype,{_projScreenMatrix:new is,_lightPositionWorld:new Mr,_lookTarget:new Mr,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){var e=this.camera,o=this.matrix,n=this._projScreenMatrix,i=this._lookTarget,r=this._lightPositionWorld;r.setFromMatrixPosition(t.matrixWorld),e.position.copy(r),i.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(i),e.updateMatrixWorld(),n.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(n),o.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),o.multiply(e.projectionMatrix),o.multiply(e.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),gi.prototype=Object.assign(Object.create(hi.prototype),{constructor:gi,isSpotLightShadow:!0,updateMatrices:function(t){var e=this.camera,o=2*br.RAD2DEG*t.angle,n=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;o===e.fov&&n===e.aspect&&i===e.far||(e.fov=o,e.aspect=n,e.far=i,e.updateProjectionMatrix()),hi.prototype.updateMatrices.call(this,t)}}),pi.prototype=Object.assign(Object.create(ci.prototype),{constructor:pi,isSpotLight:!0,copy:function(t){return ci.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),di.prototype=Object.assign(Object.create(hi.prototype),{constructor:di,isPointLightShadow:!0,updateMatrices:function(t,e){void 0===e&&(e=0);var o=this.camera,n=this.matrix,i=this._lightPositionWorld,r=this._lookTarget,s=this._projScreenMatrix;i.setFromMatrixPosition(t.matrixWorld),o.position.copy(i),r.copy(o.position),r.add(this._cubeDirections[e]),o.up.copy(this._cubeUps[e]),o.lookAt(r),o.updateMatrixWorld(),n.makeTranslation(-i.x,-i.y,-i.z),s.multiplyMatrices(o.projectionMatrix,o.matrixWorldInverse),this._frustum.setFromProjectionMatrix(s)}}),fi.prototype=Object.assign(Object.create(ci.prototype),{constructor:fi,isPointLight:!0,copy:function(t){return ci.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),mi.prototype=Object.assign(Object.create(N.prototype),{constructor:mi,isOrthographicCamera:!0,copy:function(t,e){return N.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,o,n,i,r){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=o,this.view.offsetY=n,this.view.width=i,this.view.height=r,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),o=(this.right+this.left)/2,n=(this.top+this.bottom)/2,i=o-t;o+=t,t=n+e,e=n-e,null!==this.view&&this.view.enabled&&(n=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom,i+=n*this.view.offsetX,o=i+n*this.view.width,t-=e*this.view.offsetY,e=t-e*this.view.height),this.projectionMatrix.makeOrthographic(i,o,t,e,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){return t=s.prototype.toJSON.call(this,t),t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),yi.prototype=Object.assign(Object.create(hi.prototype),{constructor:yi,isDirectionalLightShadow:!0,updateMatrices:function(t){hi.prototype.updateMatrices.call(this,t)}}),vi.prototype=Object.assign(Object.create(ci.prototype),{constructor:vi,isDirectionalLight:!0,copy:function(t){return ci.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),_i.prototype=Object.assign(Object.create(ci.prototype),{constructor:_i,isAmbientLight:!0}),bi.prototype=Object.assign(Object.create(ci.prototype),{constructor:bi,isRectAreaLight:!0,copy:function(t){return ci.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){return t=ci.prototype.toJSON.call(this,t),t.object.width=this.width,t.object.height=this.height,t}});var zl=function(){Object.defineProperty(this,"isSphericalHarmonics3",{value:!0}),this.coefficients=[];for(var t=0;9>t;t++)this.coefficients.push(new Mr)};zl.prototype.set=function(t){for(var e=0;9>e;e++)this.coefficients[e].copy(t[e]);return this},zl.prototype.zero=function(){for(var t=0;9>t;t++)this.coefficients[t].set(0,0,0);return this},zl.prototype.getAt=function(t,e){var o=t.x,n=t.y;t=t.z;var i=this.coefficients;return e.copy(i[0]).multiplyScalar(.282095),e.addScaledVector(i[1],.488603*n),e.addScaledVector(i[2],.488603*t),e.addScaledVector(i[3],.488603*o),e.addScaledVector(i[4],1.092548*o*n),e.addScaledVector(i[5],1.092548*n*t),e.addScaledVector(i[6],.315392*(3*t*t-1)),e.addScaledVector(i[7],1.092548*o*t),e.addScaledVector(i[8],.546274*(o*o-n*n)),e},zl.prototype.getIrradianceAt=function(t,e){var o=t.x,n=t.y;t=t.z;var i=this.coefficients;return e.copy(i[0]).multiplyScalar(.886227),e.addScaledVector(i[1],1.023328*n),e.addScaledVector(i[2],1.023328*t),e.addScaledVector(i[3],1.023328*o),e.addScaledVector(i[4],.858086*o*n),e.addScaledVector(i[5],.858086*n*t),e.addScaledVector(i[6],.743125*t*t-.247708),e.addScaledVector(i[7],.858086*o*t),e.addScaledVector(i[8],.429043*(o*o-n*n)),e},zl.prototype.add=function(t){for(var e=0;9>e;e++)this.coefficients[e].add(t.coefficients[e]);return this},zl.prototype.addScaledSH=function(t,e){for(var o=0;9>o;o++)this.coefficients[o].addScaledVector(t.coefficients[o],e);return this},zl.prototype.scale=function(t){for(var e=0;9>e;e++)this.coefficients[e].multiplyScalar(t);return this},zl.prototype.lerp=function(t,e){for(var o=0;9>o;o++)this.coefficients[o].lerp(t.coefficients[o],e);return this},zl.prototype.equals=function(t){for(var e=0;9>e;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0},zl.prototype.copy=function(t){return this.set(t.coefficients)},zl.prototype.clone=function(){return(new this.constructor).copy(this)},zl.prototype.fromArray=function(t,e){void 0===e&&(e=0);for(var o=this.coefficients,n=0;9>n;n++)o[n].fromArray(t,e+3*n);return this},zl.prototype.toArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);for(var o=this.coefficients,n=0;9>n;n++)o[n].toArray(t,e+3*n);return t},zl.getBasisAt=function(t,e){var o=t.x,n=t.y;t=t.z,e[0]=.282095,e[1]=.488603*n,e[2]=.488603*t,e[3]=.488603*o,e[4]=1.092548*o*n,e[5]=1.092548*n*t,e[6]=.315392*(3*t*t-1),e[7]=1.092548*o*t,e[8]=.546274*(o*o-n*n)},Ei.prototype=Object.assign(Object.create(ci.prototype),{constructor:Ei,isLightProbe:!0,copy:function(t){return ci.prototype.copy.call(this,t),this.sh.copy(t.sh),this},fromJSON:function(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this},toJSON:function(t){return t=ci.prototype.toJSON.call(this,t),t.object.sh=this.sh.toArray(),t}}),xi.prototype=Object.assign(Object.create(Pn.prototype),{constructor:xi,load:function(t,e,o,n){var i=this,r=new jn(i.manager);r.setPath(i.path),r.setRequestHeader(i.requestHeader),r.load(t,function(o){try{e(i.parse(JSON.parse(o)))}catch(e){n?n(e):console.error(e),i.manager.itemError(t)}},o,n)},parse:function(t){function e(t){return void 0===o[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),o[t]}var o=this.textures,n=new Dl[t.type];if(void 0!==t.uuid&&(n.uuid=t.uuid),void 0!==t.name&&(n.name=t.name),void 0!==t.color&&n.color.setHex(t.color),void 0!==t.roughness&&(n.roughness=t.roughness),void 0!==t.metalness&&(n.metalness=t.metalness),void 0!==t.sheen&&(n.sheen=(new Ys).setHex(t.sheen)),void 0!==t.emissive&&n.emissive.setHex(t.emissive),void 0!==t.specular&&n.specular.setHex(t.specular),void 0!==t.shininess&&(n.shininess=t.shininess),void 0!==t.clearcoat&&(n.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(n.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.fog&&(n.fog=t.fog),void 0!==t.flatShading&&(n.flatShading=t.flatShading),void 0!==t.blending&&(n.blending=t.blending),void 0!==t.combine&&(n.combine=t.combine),void 0!==t.side&&(n.side=t.side),void 0!==t.opacity&&(n.opacity=t.opacity),void 0!==t.transparent&&(n.transparent=t.transparent),void 0!==t.alphaTest&&(n.alphaTest=t.alphaTest),void 0!==t.depthTest&&(n.depthTest=t.depthTest),void 0!==t.depthWrite&&(n.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(n.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(n.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(n.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(n.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(n.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(n.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(n.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(n.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(n.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(n.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(n.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(n.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(n.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(n.rotation=t.rotation),1!==t.linewidth&&(n.linewidth=t.linewidth),void 0!==t.dashSize&&(n.dashSize=t.dashSize),void 0!==t.gapSize&&(n.gapSize=t.gapSize),void 0!==t.scale&&(n.scale=t.scale),void 0!==t.polygonOffset&&(n.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(n.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(n.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(n.skinning=t.skinning),void 0!==t.morphTargets&&(n.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(n.morphNormals=t.morphNormals),void 0!==t.dithering&&(n.dithering=t.dithering),void 0!==t.vertexTangents&&(n.vertexTangents=t.vertexTangents),void 0!==t.visible&&(n.visible=t.visible),void 0!==t.toneMapped&&(n.toneMapped=t.toneMapped),void 0!==t.userData&&(n.userData=t.userData),void 0!==t.vertexColors&&(n.vertexColors="number"==typeof t.vertexColors?0<t.vertexColors:t.vertexColors),void 0!==t.uniforms)for(var i in t.uniforms){var r=t.uniforms[i];switch(n.uniforms[i]={},r.type){case"t":n.uniforms[i].value=e(r.value);break;case"c":n.uniforms[i].value=(new Ys).setHex(r.value);break;case"v2":n.uniforms[i].value=(new Er).fromArray(r.value);break;case"v3":n.uniforms[i].value=(new Mr).fromArray(r.value);break;case"v4":n.uniforms[i].value=(new kr).fromArray(r.value);break;case"m3":n.uniforms[i].value=(new Sr).fromArray(r.value);break;case"m4":n.uniforms[i].value=(new is).fromArray(r.value);break;default:n.uniforms[i].value=r.value}}if(void 0!==t.defines&&(n.defines=t.defines),void 0!==t.vertexShader&&(n.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(n.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(var s in t.extensions)n.extensions[s]=t.extensions[s];return void 0!==t.shading&&(n.flatShading=1===t.shading),void 0!==t.size&&(n.size=t.size),void 0!==t.sizeAttenuation&&(n.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(n.map=e(t.map)),void 0!==t.matcap&&(n.matcap=e(t.matcap)),void 0!==t.alphaMap&&(n.alphaMap=e(t.alphaMap)),void 0!==t.bumpMap&&(n.bumpMap=e(t.bumpMap)),void 0!==t.bumpScale&&(n.bumpScale=t.bumpScale),void 0!==t.normalMap&&(n.normalMap=e(t.normalMap)),void 0!==t.normalMapType&&(n.normalMapType=t.normalMapType),void 0!==t.normalScale&&(i=t.normalScale,!1===Array.isArray(i)&&(i=[i,i]),n.normalScale=(new Er).fromArray(i)),void 0!==t.displacementMap&&(n.displacementMap=e(t.displacementMap)),void 0!==t.displacementScale&&(n.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(n.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(n.roughnessMap=e(t.roughnessMap)),void 0!==t.metalnessMap&&(n.metalnessMap=e(t.metalnessMap)),void 0!==t.emissiveMap&&(n.emissiveMap=e(t.emissiveMap)),void 0!==t.emissiveIntensity&&(n.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(n.specularMap=e(t.specularMap)),void 0!==t.envMap&&(n.envMap=e(t.envMap)),void 0!==t.envMapIntensity&&(n.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(n.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(n.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(n.lightMap=e(t.lightMap)),void 0!==t.lightMapIntensity&&(n.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(n.aoMap=e(t.aoMap)),void 0!==t.aoMapIntensity&&(n.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(n.gradientMap=e(t.gradientMap)),void 0!==t.clearcoatMap&&(n.clearcoatMap=e(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(n.clearcoatRoughnessMap=e(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(n.clearcoatNormalMap=e(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(n.clearcoatNormalScale=(new Er).fromArray(t.clearcoatNormalScale)),void 0!==t.transmission&&(n.transmission=t.transmission),void 0!==t.transmissionMap&&(n.transmissionMap=e(t.transmissionMap)),n},setTextures:function(t){return this.textures=t,this}});var ql={decodeText:function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",o=0,n=t.length;o<n;o++)e+=String.fromCharCode(t[o]);try{return decodeURIComponent(escape(e))}catch(t){return e}},extractUrlBase:function(t){var e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}};Si.prototype=Object.assign(Object.create(S.prototype),{constructor:Si,isInstancedBufferGeometry:!0,copy:function(t){return S.prototype.copy.call(this,t),this.instanceCount=t.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t=S.prototype.toJSON.call(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}),Ti.prototype=Object.assign(Object.create(g.prototype),{constructor:Ti,isInstancedBufferAttribute:!0,copy:function(t){return g.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){var t=g.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),wi.prototype=Object.assign(Object.create(Pn.prototype),{constructor:wi,load:function(t,e,o,n){var i=this,r=new jn(i.manager);r.setPath(i.path),r.setRequestHeader(i.requestHeader),r.load(t,function(o){try{e(i.parse(JSON.parse(o)))}catch(e){n?n(e):console.error(e),i.manager.itemError(t)}},o,n)},parse:function(t){function e(t,e){if(void 0!==o[e])return o[e];var i=t.interleavedBuffers[e],r=i.buffer;return void 0!==n[r]?r=n[r]:(t=new Uint32Array(t.arrayBuffers[r]).buffer,r=n[r]=t),r=new Xl[i.type](r),r=new De(r,i.stride),r.uuid=i.uuid,o[e]=r}var o={},n={},i=t.isInstancedBufferGeometry?new Si:new S,r=t.data.index;void 0!==r&&(r=new Xl[r.type](r.array),i.setIndex(new g(r,1))),r=t.data.attributes;for(var s in r){var a=r[s],l=void 0;a.isInterleavedBufferAttribute?(l=e(t.data,a.data),l=new Oe(l,a.itemSize,a.offset,a.normalized)):(l=new Xl[a.type](a.array),l=new(a.isInstancedBufferAttribute?Ti:g)(l,a.itemSize,a.normalized)),void 0!==a.name&&(l.name=a.name),i.setAttribute(s,l)}if(s=t.data.morphAttributes)for(var c in s){r=s[c],a=[],l=0;for(var u=r.length;l<u;l++){var h=r[l],p=void 0;h.isInterleavedBufferAttribute?(p=e(t.data,h.data),p=new Oe(p,h.itemSize,h.offset,h.normalized)):(p=new Xl[h.type](h.array),p=new g(p,h.itemSize,h.normalized)),void 0!==h.name&&(p.name=h.name),a.push(p)}i.morphAttributes[c]=a}if(t.data.morphTargetsRelative&&(i.morphTargetsRelative=!0),void 0!==(c=t.data.groups||t.data.drawcalls||t.data.offsets))for(s=0,r=c.length;s!==r;++s)a=c[s],i.addGroup(a.start,a.count,a.materialIndex);return c=t.data.boundingSphere,void 0!==c&&(s=new Mr,void 0!==c.center&&s.fromArray(c.center),i.boundingSphere=new Kr(s,c.radius)),t.name&&(i.name=t.name),t.userData&&(i.userData=t.userData),i}});var Xl={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};Ci.prototype=Object.assign(Object.create(Pn.prototype),{constructor:Ci,load:function(t,e,o,n){var i=this,r=""===this.path?ql.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||r,r=new jn(i.manager),r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.load(t,function(o){var r=null;try{r=JSON.parse(o)}catch(e){return void 0!==n&&n(e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}o=r.metadata,void 0===o||void 0===o.type||"geometry"===o.type.toLowerCase()?console.error("THREE.ObjectLoader: Can't load "+t):i.parse(r,e)},o,n)},parse:function(t,e){var o=this.parseShape(t.shapes);o=this.parseGeometries(t.geometries,o);var n=this.parseImages(t.images,function(){void 0!==e&&e(i)});n=this.parseTextures(t.textures,n),n=this.parseMaterials(t.materials,n);var i=this.parseObject(t.object,o,n);return t.animations&&(i.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0===e||e(i),i},parseShape:function(t){var e={};if(void 0!==t)for(var o=0,n=t.length;o<n;o++){var i=(new li).fromJSON(t[o]);e[i.uuid]=i}return e},parseGeometries:function(t,e){var o={};if(void 0!==t)for(var n=new wi,i=0,r=t.length;i<r;i++){var s=void 0,a=t[i];switch(a.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new Rl[a.type](a.width,a.height,a.widthSegments,a.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new Rl[a.type](a.width,a.height,a.depth,a.widthSegments,a.heightSegments,a.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new Rl[a.type](a.radius,a.segments,a.thetaStart,a.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new Rl[a.type](a.radiusTop,a.radiusBottom,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new Rl[a.type](a.radius,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new Rl[a.type](a.radius,a.widthSegments,a.heightSegments,a.phiStart,a.phiLength,a.thetaStart,a.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new Rl[a.type](a.radius,a.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new Rl[a.type](a.innerRadius,a.outerRadius,a.thetaSegments,a.phiSegments,a.thetaStart,a.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new Rl[a.type](a.radius,a.tube,a.radialSegments,a.tubularSegments,a.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new Rl[a.type](a.radius,a.tube,a.tubularSegments,a.radialSegments,a.p,a.q);break;case"TubeGeometry":case"TubeBufferGeometry":s=new Rl[a.type]((new Wl[a.path.type]).fromJSON(a.path),a.tubularSegments,a.radius,a.radialSegments,a.closed);break;case"LatheGeometry":case"LatheBufferGeometry":s=new Rl[a.type](a.points,a.segments,a.phiStart,a.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new Rl[a.type](a.vertices,a.indices,a.radius,a.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":s=[];for(var l=0,c=a.shapes.length;l<c;l++)s.push(e[a.shapes[l]]);s=new Rl[a.type](s,a.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(s=[],l=0,c=a.shapes.length;l<c;l++)s.push(e[a.shapes[l]]);l=a.options.extrudePath,void 0!==l&&(a.options.extrudePath=(new Wl[l.type]).fromJSON(l)),s=new Rl[a.type](s,a.options);break;case"BufferGeometry":case"InstancedBufferGeometry":s=n.parse(a);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+a.type+'"');continue}s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),!0===s.isBufferGeometry&&void 0!==a.userData&&(s.userData=a.userData),o[a.uuid]=s}return o},parseMaterials:function(t,e){var o={},n={};if(void 0!==t){var i=new xi;i.setTextures(e),e=0;for(var r=t.length;e<r;e++){var s=t[e];if("MultiMaterial"===s.type){for(var a=[],l=0;l<s.materials.length;l++){var c=s.materials[l];void 0===o[c.uuid]&&(o[c.uuid]=i.parse(c)),a.push(o[c.uuid])}n[s.uuid]=a}else void 0===o[s.uuid]&&(o[s.uuid]=i.parse(s)),n[s.uuid]=o[s.uuid]}}return n},parseAnimations:function(t){for(var e=[],o=0;o<t.length;o++){var n=t[o],i=Nn.parse(n);void 0!==n.uuid&&(i.uuid=n.uuid),e.push(i)}return e},parseImages:function(t,e){function o(t){return n.manager.itemStart(t),r.load(t,function(){n.manager.itemEnd(t)},void 0,function(){n.manager.itemError(t),n.manager.itemEnd(t)})}var n=this,i={};if(void 0!==t&&0<t.length){e=new On(e);var r=new Un(e);r.setCrossOrigin(this.crossOrigin),e=0;for(var s=t.length;e<s;e++){var a=t[e],l=a.url;if(Array.isArray(l)){i[a.uuid]=[];for(var c=0,u=l.length;c<u;c++){var h=l[c];h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:n.resourcePath+h,i[a.uuid].push(o(h))}}else l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a.url)?a.url:n.resourcePath+a.url,i[a.uuid]=o(l)}}return i},parseTextures:function(t,e){function n(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var i={};if(void 0!==t)for(var r=0,s=t.length;r<s;r++){var a=t[r];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===e[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);var l=void 0;l=Array.isArray(e[a.image])?new ot(e[a.image]):new o(e[a.image]),l.needsUpdate=!0,l.uuid=a.uuid,void 0!==a.name&&(l.name=a.name),void 0!==a.mapping&&(l.mapping=n(a.mapping,Yl)),void 0!==a.offset&&l.offset.fromArray(a.offset),void 0!==a.repeat&&l.repeat.fromArray(a.repeat),void 0!==a.center&&l.center.fromArray(a.center),void 0!==a.rotation&&(l.rotation=a.rotation),void 0!==a.wrap&&(l.wrapS=n(a.wrap[0],Kl),l.wrapT=n(a.wrap[1],Kl)),void 0!==a.format&&(l.format=a.format),void 0!==a.type&&(l.type=a.type),void 0!==a.encoding&&(l.encoding=a.encoding),void 0!==a.minFilter&&(l.minFilter=n(a.minFilter,$l)),void 0!==a.magFilter&&(l.magFilter=n(a.magFilter,$l)),void 0!==a.anisotropy&&(l.anisotropy=a.anisotropy),void 0!==a.flipY&&(l.flipY=a.flipY),void 0!==a.premultiplyAlpha&&(l.premultiplyAlpha=a.premultiplyAlpha),void 0!==a.unpackAlignment&&(l.unpackAlignment=a.unpackAlignment),i[a.uuid]=l}return i},parseObject:function(t,e,o){function n(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function i(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n];void 0===o[r]&&console.warn("THREE.ObjectLoader: Undefined material",r),e.push(o[r])}return e}return void 0===o[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),o[t]}}switch(t.type){case"Scene":var r=new Re;void 0!==t.background&&Number.isInteger(t.background)&&(r.background=new Ys(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?r.fog=new Qa(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(r.fog=new $a(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":r=new R(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(r.focus=t.focus),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.filmGauge&&(r.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(r.filmOffset=t.filmOffset),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"OrthographicCamera":r=new mi(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"AmbientLight":r=new _i(t.color,t.intensity);break;case"DirectionalLight":r=new vi(t.color,t.intensity);break;case"PointLight":r=new fi(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":r=new bi(t.color,t.intensity,t.width,t.height);break;case"SpotLight":r=new pi(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":r=new ui(t.color,t.groundColor,t.intensity);break;case"LightProbe":r=(new Ei).fromJSON(t);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":r=n(t.geometry);var a=i(t.material);r=new T(r,a);break;case"InstancedMesh":r=n(t.geometry),a=i(t.material);var l=t.instanceMatrix;r=new We(r,a,t.count),r.instanceMatrix=new g(new Float32Array(l.array),16);break;case"LOD":r=new He;break;case"Line":r=new qe(n(t.geometry),i(t.material),t.mode);break;case"LineLoop":r=new Ye(n(t.geometry),i(t.material));break;case"LineSegments":r=new Xe(n(t.geometry),i(t.material));break;case"PointCloud":case"Points":r=new $e(n(t.geometry),i(t.material));break;case"Sprite":r=new je(i(t.material));break;case"Group":r=new Ae;break;default:r=new s}if(r.uuid=t.uuid,void 0!==t.name&&(r.name=t.name),void 0!==t.matrix?(r.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(r.matrixAutoUpdate=t.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==t.position&&r.position.fromArray(t.position),void 0!==t.rotation&&r.rotation.fromArray(t.rotation),void 0!==t.quaternion&&r.quaternion.fromArray(t.quaternion),void 0!==t.scale&&r.scale.fromArray(t.scale)),void 0!==t.castShadow&&(r.castShadow=t.castShadow),void 0!==t.receiveShadow&&(r.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(r.shadow.bias=t.shadow.bias),void 0!==t.shadow.normalBias&&(r.shadow.normalBias=t.shadow.normalBias),void 0!==t.shadow.radius&&(r.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&r.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(r.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.frustumCulled&&(r.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(r.renderOrder=t.renderOrder),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.layers&&(r.layers.mask=t.layers),void 0!==t.children)for(l=t.children,a=0;a<l.length;a++)r.add(this.parseObject(l[a],e,o));if("LOD"===t.type)for(void 0!==t.autoUpdate&&(r.autoUpdate=t.autoUpdate),t=t.levels,l=0;l<t.length;l++){a=t[l];var c=r.getObjectByProperty("uuid",a.object);void 0!==c&&r.addLevel(c,a.distance)}return r}});var Yl={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},Kl={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},$l={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:1006,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:1008};ki.prototype=Object.assign(Object.create(Pn.prototype),{constructor:ki,isImageBitmapLoader:!0,setOptions:function(t){return this.options=t,this},load:function(t,e,o,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,r=Pl.get(t);if(void 0!==r)return i.manager.itemStart(t),setTimeout(function(){e&&e(r),i.manager.itemEnd(t)},0),r;fetch(t).then(function(t){return t.blob()}).then(function(t){return createImageBitmap(t,i.options)}).then(function(o){Pl.add(t,o),e&&e(o),i.manager.itemEnd(t)}).catch(function(e){n&&n(e),i.manager.itemError(t),i.manager.itemEnd(t)}),i.manager.itemStart(t)}}),Object.assign(Ai.prototype,{moveTo:function(t,e){return this.currentPath=new ai,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this},lineTo:function(t,e){return this.currentPath.lineTo(t,e),this},quadraticCurveTo:function(t,e,o,n){return this.currentPath.quadraticCurveTo(t,e,o,n),this},bezierCurveTo:function(t,e,o,n,i,r){return this.currentPath.bezierCurveTo(t,e,o,n,i,r),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,e){function o(t){for(var e=[],o=0,n=t.length;o<n;o++){var i=t[o],r=new li;r.curves=i.curves,e.push(r)}return e}var n=Ll.isClockWise,i=this.subPaths;if(0===i.length)return[];if(!0===e)return o(i);if(e=[],1===i.length){var r=i[0],s=new li;return s.curves=r.curves,e.push(s),e}var a=!n(i[0].getPoints());a=t?!a:a,s=[];var l=[],c=[],u=0;l[u]=void 0,c[u]=[];for(var h=0,g=i.length;h<g;h++){r=i[h];var p=r.getPoints(),d=n(p);(d=t?!d:d)?(!a&&l[u]&&u++,l[u]={s:new li,p:p},l[u].s.curves=r.curves,a&&u++,c[u]=[]):c[u].push({h:r,p:p[0]})}if(!l[0])return o(i);if(1<l.length){for(t=!1,n=[],i=0,r=l.length;i<r;i++)s[i]=[];for(i=0,r=l.length;i<r;i++)for(d=c[i],a=0;a<d.length;a++){for(u=d[a],p=!0,h=0;h<l.length;h++)(function(t,e){for(var o=e.length,n=!1,i=o-1,r=0;r<o;i=r++){var s=e[i],a=e[r],l=a.x-s.x,c=a.y-s.y;if(Math.abs(c)>Number.EPSILON){if(0>c&&(s=e[r],l=-l,a=e[i],c=-c),!(t.y<s.y||t.y>a.y))if(t.y===s.y){if(t.x===s.x)return!0}else{if(0===(i=c*(t.x-s.x)-l*(t.y-s.y)))return!0;0>i||(n=!n)}}else if(t.y===s.y&&(a.x<=t.x&&t.x<=s.x||s.x<=t.x&&t.x<=a.x))return!0}return n})(u.p,l[h].p)&&(i!==h&&n.push({froms:i,tos:h,hole:a}),p?(p=!1,s[h].push(u)):t=!0);p&&s[i].push(u)}0<n.length&&(t||(c=s))}for(n=0,i=l.length;n<i;n++)for(s=l[n].s,e.push(s),t=c[n],r=0,d=t.length;r<d;r++)s.holes.push(t[r].h);return e}}),Object.assign(Ii.prototype,{isFont:!0,generateShapes:function(t,e){void 0===e&&(e=100);var o=[],n=e;e=this.data;var i=Array.from?Array.from(t):String(t).split("");n/=e.resolution;var r=(e.boundingBox.yMax-e.boundingBox.yMin+e.underlineThickness)*n;t=[];for(var s=0,a=0,l=0;l<i.length;l++){var c=i[l];if("\n"===c)s=0,a-=r;else{var u=c;c=n;var h=s,g=a,p=e,d=p.glyphs[u]||p.glyphs["?"];if(d){if(u=new Ai,d.o){p=d._cachedOutline||(d._cachedOutline=d.o.split(" "));for(var f=0,m=p.length;f<m;)switch(p[f++]){case"m":var y=p[f++]*c+h,v=p[f++]*c+g;u.moveTo(y,v);break;case"l":y=p[f++]*c+h,v=p[f++]*c+g,u.lineTo(y,v);break;case"q":var _=p[f++]*c+h,b=p[f++]*c+g,E=p[f++]*c+h,x=p[f++]*c+g;u.quadraticCurveTo(E,x,_,b);break;case"b":_=p[f++]*c+h,b=p[f++]*c+g,E=p[f++]*c+h,x=p[f++]*c+g,y=p[f++]*c+h,v=p[f++]*c+g,u.bezierCurveTo(E,x,y,v,_,b)}}c={offsetX:d.ha*c,path:u}}else console.error('THREE.Font: character "'+u+'" does not exists in font family '+p.familyName+"."),c=void 0;s+=c.offsetX,t.push(c.path)}}for(e=0,i=t.length;e<i;e++)Array.prototype.push.apply(o,t[e].toShapes());return o}}),Bi.prototype=Object.assign(Object.create(Pn.prototype),{constructor:Bi,load:function(t,e,o,n){var i=this,r=new jn(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.load(t,function(t){try{var o=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),o=JSON.parse(t.substring(65,t.length-2))}t=i.parse(o),e&&e(t)},o,n)},parse:function(t){return new Ii(t)}});var Ql,Jl={getContext:function(){return void 0===Ql&&(Ql=new(window.AudioContext||window.webkitAudioContext)),Ql},setContext:function(t){Ql=t}};Mi.prototype=Object.assign(Object.create(Pn.prototype),{constructor:Mi,load:function(t,e,o,n){var i=this,r=new jn(i.manager);r.setResponseType("arraybuffer"),r.setPath(i.path),r.setRequestHeader(i.requestHeader),r.load(t,function(o){try{var r=o.slice(0);Jl.getContext().decodeAudioData(r,function(t){e(t)})}catch(e){n?n(e):console.error(e),i.manager.itemError(t)}},o,n)}}),Li.prototype=Object.assign(Object.create(Ei.prototype),{constructor:Li,isHemisphereLightProbe:!0,copy:function(t){return Ei.prototype.copy.call(this,t),this},toJSON:function(t){return Ei.prototype.toJSON.call(this,t)}}),Ni.prototype=Object.assign(Object.create(Ei.prototype),{constructor:Ni,isAmbientLightProbe:!0,copy:function(t){return Ei.prototype.copy.call(this,t),this},toJSON:function(t){return Ei.prototype.toJSON.call(this,t)}});var Zl=new is,tc=new is;Object.assign(Ri.prototype,{update:function(t){var e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep;var o=t.projectionMatrix.clone(),n=e.eyeSep/2,i=n*e.near/e.focus,r=e.near*Math.tan(br.DEG2RAD*e.fov*.5)/e.zoom;tc.elements[12]=-n,Zl.elements[12]=n,n=-r*e.aspect+i;var s=r*e.aspect+i;o.elements[0]=2*e.near/(s-n),o.elements[8]=(s+n)/(s-n),this.cameraL.projectionMatrix.copy(o),n=-r*e.aspect-i,s=r*e.aspect-i,o.elements[0]=2*e.near/(s-n),o.elements[8]=(s+n)/(s-n),this.cameraR.projectionMatrix.copy(o)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(tc),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(Zl)}});var ec=function(t){this.autoStart=void 0===t||t,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1};ec.prototype.start=function(){this.oldTime=this.startTime=("undefined"==typeof performance?Date:performance).now(),this.elapsedTime=0,this.running=!0},ec.prototype.stop=function(){this.getElapsedTime(),this.autoStart=this.running=!1},ec.prototype.getElapsedTime=function(){return this.getDelta(),this.elapsedTime},ec.prototype.getDelta=function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"==typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t};var oc=new Mr,nc=new Ir,ic=new Mr,rc=new Mr;Di.prototype=Object.create(s.prototype),Di.prototype.constructor=Di,Di.prototype.getInput=function(){return this.gain},Di.prototype.removeFilter=function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},Di.prototype.getFilter=function(){return this.filter},Di.prototype.setFilter=function(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},Di.prototype.getMasterVolume=function(){return this.gain.gain.value},Di.prototype.setMasterVolume=function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},Di.prototype.updateMatrixWorld=function(t){s.prototype.updateMatrixWorld.call(this,t),t=this.context.listener;var e=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(oc,nc,ic),rc.set(0,0,-1).applyQuaternion(nc),t.positionX){var o=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(oc.x,o),t.positionY.linearRampToValueAtTime(oc.y,o),t.positionZ.linearRampToValueAtTime(oc.z,o),t.forwardX.linearRampToValueAtTime(rc.x,o),t.forwardY.linearRampToValueAtTime(rc.y,o),t.forwardZ.linearRampToValueAtTime(rc.z,o),t.upX.linearRampToValueAtTime(e.x,o),t.upY.linearRampToValueAtTime(e.y,o),t.upZ.linearRampToValueAtTime(e.z,o)}else t.setPosition(oc.x,oc.y,oc.z),t.setOrientation(rc.x,rc.y,rc.z,e.x,e.y,e.z)},Oi.prototype=Object.create(s.prototype),Oi.prototype.constructor=Oi,Oi.prototype.getOutput=function(){return this.gain},Oi.prototype.setNodeSource=function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},Oi.prototype.setMediaElementSource=function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},Oi.prototype.setMediaStreamSource=function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},Oi.prototype.setBuffer=function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},Oi.prototype.play=function(t){if(void 0===t&&(t=0),!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else{if(!1!==this.hasPlaybackControl)return this._startedAt=this.context.currentTime+t,t=this.context.createBufferSource(),t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect();console.warn("THREE.Audio: this Audio has no playback control.")}},Oi.prototype.pause=function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress%=this.duration||this.buffer.duration),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},Oi.prototype.stop=function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},Oi.prototype.connect=function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this},Oi.prototype.disconnect=function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this},Oi.prototype.getFilters=function(){return this.filters},Oi.prototype.setFilters=function(t){return t||(t=[]),!0===this._connected?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},Oi.prototype.setDetune=function(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},Oi.prototype.getDetune=function(){return this.detune},Oi.prototype.getFilter=function(){return this.getFilters()[0]},Oi.prototype.setFilter=function(t){return this.setFilters(t?[t]:[])},Oi.prototype.setPlaybackRate=function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},Oi.prototype.getPlaybackRate=function(){return this.playbackRate},Oi.prototype.onEnded=function(){this.isPlaying=!1},Oi.prototype.getLoop=function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},Oi.prototype.setLoop=function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},Oi.prototype.setLoopStart=function(t){return this.loopStart=t,this},Oi.prototype.setLoopEnd=function(t){return this.loopEnd=t,this},Oi.prototype.getVolume=function(){return this.gain.gain.value},Oi.prototype.setVolume=function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this};var sc=new Mr,ac=new Ir,lc=new Mr,cc=new Mr;Pi.prototype=Object.create(Oi.prototype),Pi.prototype.constructor=Pi,Pi.prototype.getOutput=function(){return this.panner},Pi.prototype.getRefDistance=function(){return this.panner.refDistance},Pi.prototype.setRefDistance=function(t){return this.panner.refDistance=t,this},Pi.prototype.getRolloffFactor=function(){return this.panner.rolloffFactor},Pi.prototype.setRolloffFactor=function(t){return this.panner.rolloffFactor=t,this},Pi.prototype.getDistanceModel=function(){return this.panner.distanceModel},Pi.prototype.setDistanceModel=function(t){return this.panner.distanceModel=t,this},Pi.prototype.getMaxDistance=function(){return this.panner.maxDistance},Pi.prototype.setMaxDistance=function(t){return this.panner.maxDistance=t,this},Pi.prototype.setDirectionalCone=function(t,e,o){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=o,this},Pi.prototype.updateMatrixWorld=function(t){if(Oi.prototype.updateMatrixWorld.call(this,t),!0!==this.hasPlaybackControl||!1!==this.isPlaying)if(this.matrixWorld.decompose(sc,ac,lc),cc.set(0,0,1).applyQuaternion(ac),t=this.panner,t.positionX){var e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(sc.x,e),t.positionY.linearRampToValueAtTime(sc.y,e),t.positionZ.linearRampToValueAtTime(sc.z,e),t.orientationX.linearRampToValueAtTime(cc.x,e),t.orientationY.linearRampToValueAtTime(cc.y,e),t.orientationZ.linearRampToValueAtTime(cc.z,e)}else t.setPosition(sc.x,sc.y,sc.z),t.setOrientation(cc.x,cc.y,cc.z)};var uc=function(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)};uc.prototype.getFrequencyData=function(){return this.analyser.getByteFrequencyData(this.data),this.data},uc.prototype.getAverageFrequency=function(){for(var t=0,e=this.getFrequencyData(),o=0;o<e.length;o++)t+=e[o];return t/e.length},Object.assign(ji.prototype,{accumulate:function(t,e){var o=this.buffer,n=this.valueSize;t=t*n+n;var i=this.cumulativeWeight;if(0===i){for(i=0;i!==n;++i)o[t+i]=o[i];i=e}else i+=e,this._mixBufferRegion(o,t,0,e/i,n);this.cumulativeWeight=i},accumulateAdditive:function(t){var e=this.buffer,o=this.valueSize,n=o*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,n,0,t,o),this.cumulativeWeightAdditive+=t},apply:function(t){var e=this.valueSize,o=this.buffer;t=t*e+e;var n=this.cumulativeWeight,i=this.cumulativeWeightAdditive,r=this.binding;for(this.cumulativeWeightAdditive=this.cumulativeWeight=0,1>n&&this._mixBufferRegion(o,t,e*this._origIndex,1-n,e),0<i&&this._mixBufferRegionAdditive(o,t,this._addIndex*e,1,e),n=e,i=e+e;n!==i;++n)if(o[n]!==o[n+e]){r.setValue(o,t);break}},saveOriginalState:function(){var t=this.buffer,e=this.valueSize,o=e*this._origIndex;this.binding.getValue(t,o);for(var n=e;n!==o;++n)t[n]=t[o+n%e];this._setIdentity(),this.cumulativeWeightAdditive=this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_setAdditiveIdentityNumeric:function(){for(var t=this._addIndex*this.valueSize,e=t+this.valueSize;t<e;t++)this.buffer[t]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){for(var t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize,o=0;o<this.valueSize;o++)this.buffer[e+o]=this.buffer[t+o]},_select:function(t,e,o,n,i){if(.5<=n)for(n=0;n!==i;++n)t[e+n]=t[o+n]},_slerp:function(t,e,o,n){Ir.slerpFlat(t,e,t,e,t,o,n)},_slerpAdditive:function(t,e,o,n,i){i*=this._workIndex,Ir.multiplyQuaternionsFlat(t,i,t,e,t,o),Ir.slerpFlat(t,e,t,e,t,i,n)},_lerp:function(t,e,o,n,i){for(var r=1-n,s=0;s!==i;++s){var a=e+s;t[a]=t[a]*r+t[o+s]*n}},_lerpAdditive:function(t,e,o,n,i){for(var r=0;r!==i;++r){t[e+r]+=t[o+r]*n}}});var hc=/[\[\]\.:\/]/g,gc="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",pc=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),dc=/(WCOD+)?/.source.replace("WCOD",gc),fc=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),mc=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),yc=new RegExp("^"+pc+dc+fc+mc+"$"),vc=["material","materials","bones"];Object.assign(Fi.prototype,{getValue:function(t,e){this.bind();var o=this._bindings[this._targetGroup.nCachedObjects_];void 0!==o&&o.getValue(t,e)},setValue:function(t,e){for(var o=this._bindings,n=this._targetGroup.nCachedObjects_,i=o.length;n!==i;++n)o[n].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,o=t.length;e!==o;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,o=t.length;e!==o;++e)t[e].unbind()}}),Object.assign(Hi,{Composite:Fi,create:function(t,e,o){return t&&t.isAnimationObjectGroup?new Hi.Composite(t,e,o):new Hi(t,e,o)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(hc,"")},parseTrackName:function(t){var e=yc.exec(t);if(!e)throw Error("PropertyBinding: Cannot parse trackName: "+t);e={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]};var o=e.nodeName&&e.nodeName.lastIndexOf(".");if(void 0!==o&&-1!==o){var n=e.nodeName.substring(o+1);-1!==vc.indexOf(n)&&(e.nodeName=e.nodeName.substring(0,o),e.objectName=n)}if(null===e.propertyName||0===e.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+t);return e},findNode:function(t,e){if(!e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var o=t.skeleton.getBoneByName(e);if(void 0!==o)return o}if(t.children){var n=function(t){for(var o=0;o<t.length;o++){var i=t[o];if(i.name===e||i.uuid===e||(i=n(i.children)))return i}return null};if(t=n(t.children))return t}return null}}),Object.assign(Hi.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var o=this.resolvedProperty,n=0,i=o.length;n!==i;++n)t[e++]=o[n]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var o=this.resolvedProperty,n=0,i=o.length;n!==i;++n)o[n]=t[e++]},function(t,e){for(var o=this.resolvedProperty,n=0,i=o.length;n!==i;++n)o[n]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var o=this.resolvedProperty,n=0,i=o.length;n!==i;++n)o[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,o=e.objectName,n=e.propertyName,i=e.propertyIndex;if(t||(this.node=t=Hi.findNode(this.rootNode,e.nodeName)||this.rootNode),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(o){var r=e.objectIndex;switch(o){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);for(t=t.skeleton.bones,o=0;o<t.length;o++)if(t[o].name===r){r=o;break}break;default:if(void 0===t[o])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[o]}if(void 0!==r){if(void 0===t[r])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[r]}}if(void 0===(r=t[n]))console.error("THREE.PropertyBinding: Trying to update property for track: "+e.nodeName+"."+n+" but it wasn't found.",t);else{if(e=this.Versioning.None,this.targetObject=t,void 0!==t.needsUpdate?e=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(e=this.Versioning.MatrixWorldNeedsUpdate),o=this.BindingType.Direct,void 0!==i){if("morphTargetInfluences"===n){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[i]&&(i=t.morphTargetDictionary[i])}o=this.BindingType.ArrayElement,this.resolvedProperty=r,this.propertyIndex=i}else void 0!==r.fromArray&&void 0!==r.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=r):Array.isArray(r)?(o=this.BindingType.EntireArray,this.resolvedProperty=r):this.propertyName=n;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][e]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Hi.prototype,{_getValue_unbound:Hi.prototype.getValue,_setValue_unbound:Hi.prototype.setValue}),Object.assign(Ui.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=this._indicesByUUID,o=this._paths,n=this._parsedPaths,i=this._bindings,r=i.length,s=void 0,a=t.length,l=this.nCachedObjects_,c=0,u=arguments.length;c!==u;++c){var h=arguments[c],g=h.uuid,p=e[g];if(void 0===p){p=a++,e[g]=p,t.push(h),p=0;for(var d=r;p!==d;++p)i[p].push(new Hi(h,o[p],n[p]))}else if(p<l){s=t[p],d=--l;var f=t[d];for(e[f.uuid]=p,t[p]=f,e[g]=d,t[d]=h,g=0,f=r;g!==f;++g){var m=i[g],y=m[p];m[p]=m[d],void 0===y&&(y=new Hi(h,o[g],n[g])),m[d]=y}}else t[p]!==s&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l},remove:function(){for(var t=this._objects,e=this._indicesByUUID,o=this._bindings,n=o.length,i=this.nCachedObjects_,r=0,s=arguments.length;r!==s;++r){var a=arguments[r],l=a.uuid,c=e[l];if(void 0!==c&&c>=i){var u=i++,h=t[u];for(e[h.uuid]=c,t[c]=h,e[l]=u,t[u]=a,a=0,l=n;a!==l;++a){h=o[a];var g=h[c];h[c]=h[u],h[u]=g}}}this.nCachedObjects_=i},uncache:function(){for(var t=this._objects,e=this._indicesByUUID,o=this._bindings,n=o.length,i=this.nCachedObjects_,r=t.length,s=0,a=arguments.length;s!==a;++s){var l=arguments[s].uuid,c=e[l];if(void 0!==c)if(delete e[l],c<i){l=--i;var u=t[l],h=--r,g=t[h];for(e[u.uuid]=c,t[c]=u,e[g.uuid]=l,t[l]=g,t.pop(),u=0,g=n;u!==g;++u){var p=o[u],d=p[h];p[c]=p[l],p[l]=d,p.pop()}}else for(l=--r,h=t[l],e[h.uuid]=c,t[c]=h,t.pop(),h=0,u=n;h!==u;++h)g=o[h],g[c]=g[l],g.pop()}this.nCachedObjects_=i},subscribe_:function(t,e){var o=this._bindingsIndicesByPath,n=o[t],i=this._bindings;if(void 0!==n)return i[n];var r=this._paths,s=this._parsedPaths,a=this._objects,l=this.nCachedObjects_,c=Array(a.length);for(n=i.length,o[t]=n,r.push(t),s.push(e),i.push(c),o=l,n=a.length;o!==n;++o)c[o]=new Hi(a[o],t,e);return c},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,o=e[t];if(void 0!==o){var n=this._paths,i=this._parsedPaths,r=this._bindings,s=r.length-1,a=r[s];e[t[s]]=o,r[o]=a,r.pop(),i[o]=i[s],i.pop(),n[o]=n[s],n.pop()}}});var _c=function(t,e,o,n){this._mixer=t,this._clip=e,this._localRoot=o||null,this.blendMode=n||e.blendMode,t=e.tracks,e=t.length,o=Array(e),n={endingStart:2400,endingEnd:2400};for(var i=0;i!==e;++i){var r=t[i].createInterpolant(null);o[i]=r,r.settings=n}this._interpolantSettings=n,this._interpolants=o,this._propertyBindings=Array(e),this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0};_c.prototype.play=function(){return this._mixer._activateAction(this),this},_c.prototype.stop=function(){return this._mixer._deactivateAction(this),this.reset()},_c.prototype.reset=function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},_c.prototype.isRunning=function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},_c.prototype.isScheduled=function(){return this._mixer._isActiveAction(this)},_c.prototype.startAt=function(t){return this._startTime=t,this},_c.prototype.setLoop=function(t,e){return this.loop=t,this.repetitions=e,this},_c.prototype.setEffectiveWeight=function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},_c.prototype.getEffectiveWeight=function(){return this._effectiveWeight},_c.prototype.fadeIn=function(t){return this._scheduleFading(t,0,1)},_c.prototype.fadeOut=function(t){return this._scheduleFading(t,1,0)},_c.prototype.crossFadeFrom=function(t,e,o){if(t.fadeOut(e),this.fadeIn(e),o){o=this._clip.duration;var n=t._clip.duration,i=o/n;t.warp(1,n/o,e),this.warp(i,1,e)}return this},_c.prototype.crossFadeTo=function(t,e,o){return t.crossFadeFrom(this,e,o)},_c.prototype.stopFading=function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},_c.prototype.setEffectiveTimeScale=function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},_c.prototype.getEffectiveTimeScale=function(){return this._effectiveTimeScale},_c.prototype.setDuration=function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},_c.prototype.syncWith=function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},_c.prototype.halt=function(t){return this.warp(this._effectiveTimeScale,0,t)},_c.prototype.warp=function(t,e,o){var n=this._mixer,i=n.time,r=this.timeScale,s=this._timeScaleInterpolant;return null===s&&(this._timeScaleInterpolant=s=n._lendControlInterpolant()),n=s.parameterPositions,s=s.sampleValues,n[0]=i,n[1]=i+o,s[0]=t/r,s[1]=e/r,this},_c.prototype.stopWarping=function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},_c.prototype.getMixer=function(){return this._mixer},_c.prototype.getClip=function(){return this._clip},_c.prototype.getRoot=function(){return this._localRoot||this._mixer._root},_c.prototype._update=function(t,e,o,n){if(this.enabled){var i=this._startTime;if(null!==i){if(0>(e=(t-i)*o)||0===o)return;this._startTime=null,e*=o}if(e*=this._updateTimeScale(t),o=this._updateTime(e),0<(t=this._updateWeight(t)))switch(e=this._interpolants,i=this._propertyBindings,this.blendMode){case 2501:n=0;for(var r=e.length;n!==r;++n)e[n].evaluate(o),i[n].accumulateAdditive(t);break;default:r=0;for(var s=e.length;r!==s;++r)e[r].evaluate(o),i[r].accumulate(n,t)}}else this._updateWeight(t)},_c.prototype._updateWeight=function(t){var e=0;if(this.enabled){e=this.weight;var o=this._weightInterpolant;if(null!==o){var n=o.evaluate(t)[0];e*=n,t>o.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=e},_c.prototype._updateTimeScale=function(t){var e=0;if(!this.paused){e=this.timeScale;var o=this._timeScaleInterpolant;if(null!==o){e*=o.evaluate(t)[0],t>o.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e},_c.prototype._updateTime=function(t){var e=this._clip.duration,o=this.loop,n=this.time+t,i=this._loopCount,r=2202===o;if(0===t)return-1===i?n:r&&1==(1&i)?e-n:n;if(2200===o)t:{if(-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1)),n>=e)n=e;else{if(!(0>n)){this.time=n;break t}n=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>t?-1:1})}else{if(-1===i&&(0<=t?(i=0,this._setEndings(!0,0===this.repetitions,r)):this._setEndings(0===this.repetitions,!0,r)),n>=e||0>n){o=Math.floor(n/e),n-=e*o,i+=Math.abs(o);var s=this.repetitions-i;0>=s?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n=0<t?e:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<t?1:-1})):(1===s?(t=0>t,this._setEndings(t,!t,r)):this._setEndings(!1,!1,r),this._loopCount=i,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o}))}else this.time=n;if(r&&1==(1&i))return e-n}return n},_c.prototype._setEndings=function(t,e,o){var n=this._interpolantSettings;o?(n.endingStart=2401,n.endingEnd=2401):(n.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,n.endingEnd=e?this.zeroSlopeAtEnd?2401:2400:2402)},_c.prototype._scheduleFading=function(t,e,o){var n=this._mixer,i=n.time,r=this._weightInterpolant;return null===r&&(this._weightInterpolant=r=n._lendControlInterpolant()),n=r.parameterPositions,r=r.sampleValues,n[0]=i,r[0]=e,n[1]=i+t,r[1]=o,this},Gi.prototype=Object.assign(Object.create(e.prototype),{constructor:Gi,_bindAction:function(t,e){var o=t._localRoot||this._root,n=t._clip.tracks,i=n.length,r=t._propertyBindings;t=t._interpolants;var s=o.uuid,a=this._bindingsByRootAndName,l=a[s];for(void 0===l&&(l={},a[s]=l),a=0;a!==i;++a){var c=n[a],u=c.name,h=l[u];if(void 0===h){if(void 0!==(h=r[a])){null===h._cacheIndex&&(++h.referenceCount,this._addInactiveBinding(h,s,u));continue}h=new ji(Hi.create(o,u,e&&e._propertyBindings[a].binding.parsedPath),c.ValueTypeName,c.getValueSize()),++h.referenceCount,this._addInactiveBinding(h,s,u)}r[a]=h,t[a].resultBuffer=h.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,o=t._clip.uuid,n=this._actionsByClip[o];this._bindAction(t,n&&n.knownActions[0]),this._addInactiveAction(t,o,e)}for(e=t._propertyBindings,o=0,n=e.length;o!==n;++o){var i=e[o];0==i.useCount++&&(this._lendBinding(i),i.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,o=0,n=e.length;o!==n;++o){var i=e[o];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){return null!==(t=t._cacheIndex)&&t<this._nActiveActions},_addInactiveAction:function(t,e,o){var n=this._actions,i=this._actionsByClip,r=i[e];void 0===r?(r={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=r):(e=r.knownActions,t._byClipCacheIndex=e.length,e.push(t)),t._cacheIndex=n.length,n.push(t),r.actionByRoot[o]=t},_removeInactiveAction:function(t){var e=this._actions,o=e[e.length-1],n=t._cacheIndex;o._cacheIndex=n,e[n]=o,e.pop(),t._cacheIndex=null,e=t._clip.uuid,o=this._actionsByClip,n=o[e];var i=n.knownActions,r=i[i.length-1],s=t._byClipCacheIndex;r._byClipCacheIndex=s,i[s]=r,i.pop(),t._byClipCacheIndex=null,delete n.actionByRoot[(t._localRoot||this._root).uuid],0===i.length&&delete o[e],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){t=t._propertyBindings;for(var e=0,o=t.length;e!==o;++e){var n=t[e];0==--n.referenceCount&&this._removeInactiveBinding(n)}},_lendAction:function(t){var e=this._actions,o=t._cacheIndex,n=this._nActiveActions++,i=e[n];t._cacheIndex=n,e[n]=t,i._cacheIndex=o,e[o]=i},_takeBackAction:function(t){var e=this._actions,o=t._cacheIndex,n=--this._nActiveActions,i=e[n];t._cacheIndex=n,e[n]=t,i._cacheIndex=o,e[o]=i},_addInactiveBinding:function(t,e,o){var n=this._bindingsByRootAndName,i=this._bindings,r=n[e];void 0===r&&(r={},n[e]=r),r[o]=t,t._cacheIndex=i.length,i.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,o=t.binding,n=o.rootNode.uuid;o=o.path;var i=this._bindingsByRootAndName,r=i[n],s=e[e.length-1];t=t._cacheIndex,s._cacheIndex=t,e[t]=s,e.pop(),delete r[o],0===Object.keys(r).length&&delete i[n]},_lendBinding:function(t){var e=this._bindings,o=t._cacheIndex,n=this._nActiveBindings++,i=e[n];t._cacheIndex=n,e[n]=t,i._cacheIndex=o,e[o]=i},_takeBackBinding:function(t){var e=this._bindings,o=t._cacheIndex,n=--this._nActiveBindings,i=e[n];t._cacheIndex=n,e[n]=t,i._cacheIndex=o,e[o]=i},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,o=t[e];return void 0===o&&(o=new Sn(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),o.__cacheIndex=e,t[e]=o),o},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,o=t.__cacheIndex,n=--this._nActiveControlInterpolants,i=e[n];t.__cacheIndex=n,e[n]=t,i.__cacheIndex=o,e[o]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e,o){var n=e||this._root,i=n.uuid;n="string"==typeof t?Nn.findByName(n,t):t,t=null!==n?n.uuid:t;var r=this._actionsByClip[t],s=null;if(void 0===o&&(o=null!==n?n.blendMode:2500),void 0!==r){if(void 0!==(s=r.actionByRoot[i])&&s.blendMode===o)return s;s=r.knownActions[0],null===n&&(n=s._clip)}return null===n?null:(e=new _c(this,n,e,o),this._bindAction(e,s),this._addInactiveAction(e,t,i),e)},existingAction:function(t,e){var o=e||this._root;return e=o.uuid,o="string"==typeof t?Nn.findByName(o,t):t,t=this._actionsByClip[o?o.uuid:t],void 0!==t?t.actionByRoot[e]||null:null},stopAllAction:function(){for(var t=this._actions,e=this._nActiveActions-1;0<=e;--e)t[e].stop();return this},update:function(t){t*=this.timeScale;for(var e=this._actions,o=this._nActiveActions,n=this.time+=t,i=Math.sign(t),r=this._accuIndex^=1,s=0;s!==o;++s)e[s]._update(n,t,i,r);for(t=this._bindings,e=this._nActiveBindings,o=0;o!==e;++o)t[o].apply(r);return this},setTime:function(t){for(var e=this.time=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions;t=t.uuid;var o=this._actionsByClip,n=o[t];if(void 0!==n){n=n.knownActions;for(var i=0,r=n.length;i!==r;++i){var s=n[i];this._deactivateAction(s);var a=s._cacheIndex,l=e[e.length-1];s._cacheIndex=null,s._byClipCacheIndex=null,l._cacheIndex=a,e[a]=l,e.pop(),this._removeInactiveBindingsForAction(s)}delete o[t]}},uncacheRoot:function(t){t=t.uuid;var e=this._actionsByClip;for(n in e){var o=e[n].actionByRoot[t];void 0!==o&&(this._deactivateAction(o),this._removeInactiveAction(o))}var n=this._bindingsByRootAndName[t];if(void 0!==n)for(var i in n)t=n[i],t.restoreOriginalState(),this._removeInactiveBinding(t)},uncacheAction:function(t,e){null!==(t=this.existingAction(t,e))&&(this._deactivateAction(t),this._removeInactiveAction(t))}});var bc=function(t,e){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=e),this.value=t};bc.prototype.clone=function(){return new bc(void 0===this.value.clone?this.value:this.value.clone())},Vi.prototype=Object.assign(Object.create(De.prototype),{constructor:Vi,isInstancedInterleavedBuffer:!0,copy:function(t){return De.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},clone:function(t){return t=De.prototype.clone.call(this,t),t.meshPerAttribute=this.meshPerAttribute,t},toJSON:function(t){return t=De.prototype.toJSON.call(this,t),t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}),Object.defineProperty(Wi.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Wi.prototype,{isGLBufferAttribute:!0,setBuffer:function(t){return this.buffer=t,this},setType:function(t,e){return this.type=t,this.elementSize=e,this},setItemSize:function(t){return this.itemSize=t,this},setCount:function(t){return this.count=t,this}}),Object.assign(zi.prototype,{set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e,o){return o=o||[],Xi(t,this,o,e),o.sort(qi),o},intersectObjects:function(t,e,o){if(o=o||[],!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),o;for(var n=0,i=t.length;n<i;n++)Xi(t[n],this,o,e);return o.sort(qi),o}});var Ec=function(t,e,o){return void 0===t&&(t=1),void 0===e&&(e=0),void 0===o&&(o=0),this.radius=t,this.phi=e,this.theta=o,this};Ec.prototype.set=function(t,e,o){return this.radius=t,this.phi=e,this.theta=o,this},Ec.prototype.clone=function(){return(new this.constructor).copy(this)},Ec.prototype.copy=function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},Ec.prototype.makeSafe=function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},Ec.prototype.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},Ec.prototype.setFromCartesianCoords=function(t,e,o){return this.radius=Math.sqrt(t*t+e*e+o*o),0===this.radius?this.phi=this.theta=0:(this.theta=Math.atan2(t,o),this.phi=Math.acos(br.clamp(e/this.radius,-1,1))),this};var xc=function(t,e,o){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==o?o:0,this};xc.prototype.set=function(t,e,o){return this.radius=t,this.theta=e,this.y=o,this},xc.prototype.clone=function(){return(new this.constructor).copy(this)},xc.prototype.copy=function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},xc.prototype.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},xc.prototype.setFromCartesianCoords=function(t,e,o){return this.radius=Math.sqrt(t*t+o*o),this.theta=Math.atan2(t,o),this.y=e,this};var Sc=new Er,Tc=function(t,e){Object.defineProperty(this,"isBox2",{value:!0}),this.min=void 0!==t?t:new Er(1/0,1/0),this.max=void 0!==e?e:new Er(-1/0,-1/0)};Tc.prototype.set=function(t,e){return this.min.copy(t),this.max.copy(e),this},Tc.prototype.setFromPoints=function(t){this.makeEmpty();for(var e=0,o=t.length;e<o;e++)this.expandByPoint(t[e]);return this},Tc.prototype.setFromCenterAndSize=function(t,e){return e=Sc.copy(e).multiplyScalar(.5),this.min.copy(t).sub(e),this.max.copy(t).add(e),this},Tc.prototype.clone=function(){return(new this.constructor).copy(this)},Tc.prototype.copy=function(t){return this.min.copy(t.min),this.max.copy(t.max),this},Tc.prototype.makeEmpty=function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},Tc.prototype.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y},Tc.prototype.getCenter=function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new Er),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},Tc.prototype.getSize=function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new Er),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},Tc.prototype.expandByPoint=function(t){return this.min.min(t),this.max.max(t),this},Tc.prototype.expandByVector=function(t){return this.min.sub(t),this.max.add(t),this},Tc.prototype.expandByScalar=function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},Tc.prototype.containsPoint=function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},Tc.prototype.containsBox=function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},Tc.prototype.getParameter=function(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new Er),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},Tc.prototype.intersectsBox=function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},Tc.prototype.clampPoint=function(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new Er),e.copy(t).clamp(this.min,this.max)},Tc.prototype.distanceToPoint=function(t){return Sc.copy(t).clamp(this.min,this.max).sub(t).length()},Tc.prototype.intersect=function(t){return this.min.max(t.min),this.max.min(t.max),this},Tc.prototype.union=function(t){return this.min.min(t.min),this.max.max(t.max),this},Tc.prototype.translate=function(t){return this.min.add(t),this.max.add(t),this},Tc.prototype.equals=function(t){return t.min.equals(this.min)&&t.max.equals(this.max)};var wc=new Mr,Cc=new Mr,kc=function(t,e){this.start=void 0!==t?t:new Mr,this.end=void 0!==e?e:new Mr};kc.prototype.set=function(t,e){return this.start.copy(t),this.end.copy(e),this},kc.prototype.clone=function(){return(new this.constructor).copy(this)},kc.prototype.copy=function(t){return this.start.copy(t.start),this.end.copy(t.end),this},kc.prototype.getCenter=function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new Mr),t.addVectors(this.start,this.end).multiplyScalar(.5)},kc.prototype.delta=function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new Mr),t.subVectors(this.end,this.start)},kc.prototype.distanceSq=function(){return this.start.distanceToSquared(this.end)},kc.prototype.distance=function(){return this.start.distanceTo(this.end)},kc.prototype.at=function(t,e){return void 0===e&&(console.warn("THREE.Line3: .at() target is now required"),e=new Mr),this.delta(e).multiplyScalar(t).add(this.start)},kc.prototype.closestPointToPointParameter=function(t,e){return wc.subVectors(t,this.start),Cc.subVectors(this.end,this.start),t=Cc.dot(Cc),t=Cc.dot(wc)/t,e&&(t=br.clamp(t,0,1)),t},kc.prototype.closestPointToPoint=function(t,e,o){return t=this.closestPointToPointParameter(t,e),void 0===o&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),o=new Mr),this.delta(o).multiplyScalar(t).add(this.start)},kc.prototype.applyMatrix4=function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},kc.prototype.equals=function(t){return t.start.equals(this.start)&&t.end.equals(this.end)},Yi.prototype=Object.create(s.prototype),Yi.prototype.constructor=Yi,Yi.prototype.isImmediateRenderObject=!0;var Ac=new Mr;Ki.prototype=Object.create(s.prototype),Ki.prototype.constructor=Ki,Ki.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Ki.prototype.update=function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),Ac.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Ac),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var Ic=new Mr,Bc=new is,Mc=new is;$i.prototype=Object.create(Xe.prototype),$i.prototype.constructor=$i,$i.prototype.updateMatrixWorld=function(t){var e=this.bones,o=this.geometry,n=o.getAttribute("position");Mc.getInverse(this.root.matrixWorld);for(var i=0,r=0;i<e.length;i++){var s=e[i];s.parent&&s.parent.isBone&&(Bc.multiplyMatrices(Mc,s.matrixWorld),Ic.setFromMatrixPosition(Bc),n.setXYZ(r,Ic.x,Ic.y,Ic.z),Bc.multiplyMatrices(Mc,s.parent.matrixWorld),Ic.setFromMatrixPosition(Bc),n.setXYZ(r+1,Ic.x,Ic.y,Ic.z),r+=2)}o.getAttribute("position").needsUpdate=!0,Xe.prototype.updateMatrixWorld.call(this,t)},Ji.prototype=Object.create(T.prototype),Ji.prototype.constructor=Ji,Ji.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Ji.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var Lc=new Mr,Nc=new Ys,Rc=new Ys;Zi.prototype=Object.create(s.prototype),Zi.prototype.constructor=Zi,Zi.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Zi.prototype.update=function(){var t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var e=t.geometry.getAttribute("color");Nc.copy(this.light.color),Rc.copy(this.light.groundColor);for(var o=0,n=e.count;o<n;o++){var i=o<n/2?Nc:Rc;e.setXYZ(o,i.r,i.g,i.b)}e.needsUpdate=!0}t.lookAt(Lc.setFromMatrixPosition(this.light.matrixWorld).negate())},tr.prototype=Object.create(Xe.prototype),tr.prototype.constructor=tr,er.prototype=Object.create(Xe.prototype),er.prototype.constructor=er;var Dc=new Mr,Oc=new Mr,Pc=new Mr;or.prototype=Object.create(s.prototype),or.prototype.constructor=or,or.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},or.prototype.update=function(){Dc.setFromMatrixPosition(this.light.matrixWorld),Oc.setFromMatrixPosition(this.light.target.matrixWorld),Pc.subVectors(Oc,Dc),this.lightPlane.lookAt(Oc),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Oc),this.targetLine.scale.z=Pc.length()};var jc=new Mr,Fc=new N;nr.prototype=Object.create(Xe.prototype),nr.prototype.constructor=nr,nr.prototype.update=function(){var t=this.geometry,e=this.pointMap;Fc.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),ir("c",e,t,Fc,0,0,-1),ir("t",e,t,Fc,0,0,1),ir("n1",e,t,Fc,-1,-1,-1),ir("n2",e,t,Fc,1,-1,-1),ir("n3",e,t,Fc,-1,1,-1),ir("n4",e,t,Fc,1,1,-1),ir("f1",e,t,Fc,-1,-1,1),ir("f2",e,t,Fc,1,-1,1),ir("f3",e,t,Fc,-1,1,1),ir("f4",e,t,Fc,1,1,1),ir("u1",e,t,Fc,.7,1.1,-1),ir("u2",e,t,Fc,-.7,1.1,-1),ir("u3",e,t,Fc,0,2,-1),ir("cf1",e,t,Fc,-1,0,1),ir("cf2",e,t,Fc,1,0,1),ir("cf3",e,t,Fc,0,-1,1),ir("cf4",e,t,Fc,0,1,1),ir("cn1",e,t,Fc,-1,0,-1),ir("cn2",e,t,Fc,1,0,-1),ir("cn3",e,t,Fc,0,-1,-1),ir("cn4",e,t,Fc,0,1,-1),t.getAttribute("position").needsUpdate=!0};var Hc=new Rr;rr.prototype=Object.create(Xe.prototype),rr.prototype.constructor=rr,rr.prototype.update=function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Hc.setFromObject(this.object),!Hc.isEmpty()){t=Hc.min;var e=Hc.max,o=this.geometry.attributes.position,n=o.array;n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=t.x,n[4]=e.y,n[5]=e.z,n[6]=t.x,n[7]=t.y,n[8]=e.z,n[9]=e.x,n[10]=t.y,n[11]=e.z,n[12]=e.x,n[13]=e.y,n[14]=t.z,n[15]=t.x,n[16]=e.y,n[17]=t.z,n[18]=t.x,n[19]=t.y,n[20]=t.z,n[21]=e.x,n[22]=t.y,n[23]=t.z,o.needsUpdate=!0,this.geometry.computeBoundingSphere()}},rr.prototype.setFromObject=function(t){return this.object=t,this.update(),this},rr.prototype.copy=function(t){return Xe.prototype.copy.call(this,t),this.object=t.object,this},sr.prototype=Object.create(Xe.prototype),sr.prototype.constructor=sr,sr.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),Xe.prototype.updateMatrixWorld.call(this,t))},ar.prototype=Object.create(qe.prototype),ar.prototype.constructor=ar,ar.prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;1e-8>Math.abs(e)&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=0>e?1:0,this.lookAt(this.plane.normal),qe.prototype.updateMatrixWorld.call(this,t)};var Uc,Gc,Vc=new Mr;lr.prototype=Object.create(s.prototype),lr.prototype.constructor=lr,lr.prototype.setDirection=function(t){.99999<t.y?this.quaternion.set(0,0,0,1):-.99999>t.y?this.quaternion.set(1,0,0,0):(Vc.set(t.z,0,-t.x).normalize(),this.quaternion.setFromAxisAngle(Vc,Math.acos(t.y)))},lr.prototype.setLength=function(t,e,o){void 0===e&&(e=.2*t),void 0===o&&(o=.2*e),this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(o,e,o),this.cone.position.y=t,this.cone.updateMatrix()},lr.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},lr.prototype.copy=function(t){return s.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},cr.prototype=Object.create(Xe.prototype),cr.prototype.constructor=cr;var Wc=Math.pow(2,8),zc=[.125,.215,.35,.446,.526,.582],qc=5+zc.length,Xc={3e3:0,3001:1,3002:2,3004:3,3005:4,3006:5,3007:6},Yc=new mi,Kc=function(){for(var t=[],e=[],o=[],n=8,i=0;i<qc;i++){var r=Math.pow(2,n);e.push(r);var s=1/r;4<i?s=zc[i-8+4-1]:0==i&&(s=0),o.push(s),s=1/(r-1),r=-s/2,s=1+s/2;var a=[r,r,s,r,s,s,r,r,s,s,r,s];r=new Float32Array(108),s=new Float32Array(72);for(var l=new Float32Array(36),c=0;6>c;c++){var u=c%3*2/3-1,h=2<c?0:-1;r.set([u,h,0,u+2/3,h,0,u+2/3,h+1,0,u,h,0,u+2/3,h+1,0,u,h+1,0],18*c),s.set(a,12*c),l.set([c,c,c,c,c,c],6*c)}a=new S,a.setAttribute("position",new g(r,3)),a.setAttribute("uv",new g(s,2)),a.setAttribute("faceIndex",new g(l,1)),t.push(a),4<n&&n--}return{_lodPlanes:t,_sizeLods:e,_sigmas:o}}(),$c=Kc._lodPlanes,Qc=Kc._sizeLods,Jc=Kc._sigmas,Zc=null,tu=(1+Math.sqrt(5))/2,eu=1/tu,ou=[new Mr(1,1,1),new Mr(-1,1,1),new Mr(1,1,-1),new Mr(-1,1,-1),new Mr(0,tu,eu),new Mr(0,tu,-eu),new Mr(eu,0,tu),new Mr(-eu,0,tu),new Mr(tu,eu,0),new Mr(-tu,eu,0)],nu=function(t){this._renderer=t,this._pingPongRenderTarget=null,t=new Float32Array(20);var e=new Mr(0,1,0);this._blurMaterial=new gn({name:"SphericalGaussianBlur",defines:{n:20},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:t},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:e},inputEncoding:{value:Xc[3e3]},outputEncoding:{value:Xc[3e3]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1}),this._cubemapShader=this._equirectShader=null,this._compileMaterial(this._blurMaterial)};nu.prototype.fromScene=function(t,e,o,n){void 0===e&&(e=0),void 0===o&&(o=.1),void 0===n&&(n=100),Zc=this._renderer.getRenderTarget();var i=this._allocateTargets();return this._sceneToCubeUV(t,o,n,i),0<e&&this._blur(i,0,0,e),this._applyPMREM(i),this._cleanup(i),i},nu.prototype.fromEquirectangular=function(t){return this._fromTexture(t)},nu.prototype.fromCubemap=function(t){return this._fromTexture(t)},nu.prototype.compileCubemapShader=function(){null===this._cubemapShader&&(this._cubemapShader=pr(),this._compileMaterial(this._cubemapShader))},nu.prototype.compileEquirectangularShader=function(){null===this._equirectShader&&(this._equirectShader=gr(),this._compileMaterial(this._equirectShader))},nu.prototype.dispose=function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(var t=0;t<$c.length;t++)$c[t].dispose()},nu.prototype._cleanup=function(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Zc),t.scissorTest=!1,hr(t,0,0,t.width,t.height)},nu.prototype._fromTexture=function(t){Zc=this._renderer.getRenderTarget();var e=this._allocateTargets(t);return this._textureToCubeUV(t,e),this._applyPMREM(e),this._cleanup(e),e},nu.prototype._allocateTargets=function(t){var e=void 0!==t&&1009===t.type&&(3e3===t.encoding||3001===t.encoding||3007===t.encoding);e={magFilter:1003,minFilter:1003,generateMipmaps:!1,type:1009,format:1023,encoding:e?t.encoding:3002,depthBuffer:!1};var o=ur(e);return o.depthBuffer=!t,this._pingPongRenderTarget=ur(e),o},nu.prototype._compileMaterial=function(t){t=new T($c[0],t),this._renderer.compile(t,Yc)},nu.prototype._sceneToCubeUV=function(t,e,o,n){e=new R(90,1,e,o),o=[1,-1,1,1,1,1];var i=[1,1,1,-1,-1,-1],r=this._renderer,s=r.outputEncoding,a=r.toneMapping,l=r.getClearColor(),c=r.getClearAlpha();r.toneMapping=0,r.outputEncoding=3e3;var u=t.background;if(u&&u.isColor){u.convertSRGBToLinear();var h=Math.min(Math.max(Math.ceil(Math.log2(Math.max(u.r,u.g,u.b))),-128),127);u=u.multiplyScalar(Math.pow(2,-h)),r.setClearColor(u,(h+128)/255),t.background=null}for(u=0;6>u;u++)h=u%3,0==h?(e.up.set(0,o[u],0),e.lookAt(i[u],0,0)):1==h?(e.up.set(0,0,o[u]),e.lookAt(0,i[u],0)):(e.up.set(0,o[u],0),e.lookAt(0,0,i[u])),hr(n,h*Wc,2<u?Wc:0,Wc,Wc),r.setRenderTarget(n),r.render(t,e);r.toneMapping=a,r.outputEncoding=s,r.setClearColor(l,c)},nu.prototype._textureToCubeUV=function(t,e){var o=this._renderer;t.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=pr()):null==this._equirectShader&&(this._equirectShader=gr());var n=t.isCubeTexture?this._cubemapShader:this._equirectShader,i=new T($c[0],n);n=n.uniforms,n.envMap.value=t,t.isCubeTexture||n.texelSize.value.set(1/t.image.width,1/t.image.height),n.inputEncoding.value=Xc[t.encoding],n.outputEncoding.value=Xc[e.texture.encoding],hr(e,0,0,3*Wc,2*Wc),o.setRenderTarget(e),o.render(i,Yc)},nu.prototype._applyPMREM=function(t){var e=this._renderer,o=e.autoClear;e.autoClear=!1;for(var n=1;n<qc;n++)this._blur(t,n-1,n,Math.sqrt(Jc[n]*Jc[n]-Jc[n-1]*Jc[n-1]),ou[(n-1)%ou.length]);e.autoClear=o},nu.prototype._blur=function(t,e,o,n,i){var r=this._pingPongRenderTarget;this._halfBlur(t,r,e,o,n,"latitudinal",i),this._halfBlur(r,t,o,o,n,"longitudinal",i)},nu.prototype._halfBlur=function(t,e,o,n,i,r,s){var a=this._renderer,l=this._blurMaterial;"latitudinal"!==r&&"longitudinal"!==r&&console.error("blur direction must be either latitudinal or longitudinal!");var c=new T($c[n],l);l=l.uniforms;var u=Qc[o]-1;u=isFinite(i)?Math.PI/(2*u):2*Math.PI/39;var h=i/u,g=isFinite(i)?1+Math.floor(3*h):20;20<g&&console.warn("sigmaRadians, "+i+", is too large and will clip, as it requested "+g+" samples when the maximum is set to 20"),i=[];for(var p=0,d=0;20>d;++d){var f=d/h;f=Math.exp(-f*f/2),i.push(f),0==d?p+=f:d<g&&(p+=2*f)}for(h=0;h<i.length;h++)i[h]/=p;l.envMap.value=t.texture,l.samples.value=g,l.weights.value=i,l.latitudinal.value="latitudinal"===r,s&&(l.poleAxis.value=s),l.dTheta.value=u,l.mipInt.value=8-o,l.inputEncoding.value=Xc[t.texture.encoding],l.outputEncoding.value=Xc[t.texture.encoding],t=Qc[n],hr(e,3*Math.max(0,Wc-2*t),(0===n?0:2*Wc)+2*t*(4<n?n-8+4:0),3*t,2*t),a.setRenderTarget(e),a.render(c,Yc)},zn.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(zn.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(si.prototype,{createPointsGeometry:function(t){return console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),t=this.getPoints(t),this.createGeometry(t)},createSpacedPointsGeometry:function(t){return console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),t=this.getSpacedPoints(t),this.createGeometry(t)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var e=new k,o=0,n=t.length;o<n;o++){var i=t[o];e.vertices.push(new Mr(i.x,i.y,i.z||0))}return e}}),Object.assign(ai.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),dr.prototype=Object.create(Kn.prototype),fr.prototype=Object.create(Kn.prototype),mr.prototype=Object.create(Kn.prototype),Object.assign(mr.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),tr.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},$i.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Pn.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),ql.extractUrlBase(t)}}),Pn.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(Ci.prototype,{setTexturePath:function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}),Object.assign(Tc.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(Rr.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(Kr.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),Ma.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},kc.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(br,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),br.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),br.ceilPowerOfTwo(t)}}),Object.assign(Sr.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(is.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Mr).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,o,n,i,r){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,n,o,i,r)}}),Ns.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},Ir.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(ns.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(Ws.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(Ws,{barycoordFromPoint:function(t,e,o,n,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Ws.getBarycoord(t,e,o,n,i)},normal:function(t,e,o,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Ws.getNormal(t,e,o,n)}}),Object.assign(li.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Vo(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new tn(this,t)}}),Object.assign(Er.prototype,{fromAttribute:function(t,e,o){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,o)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Mr.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,o){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,o)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(kr.prototype,{fromAttribute:function(t,e,o){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,o)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(k.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.assign(s.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(s.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(T.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(T.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(He.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Ge.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Ue.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(zn.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),R.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(ci.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(g.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),35048===this.usage},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(35048)}}}),Object.assign(g.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?35048:35044),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(S.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,e,o){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new g(e,o)))},addDrawCall:function(t,e,o){void 0!==o&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(S.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Si.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(t){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=t}}}),Object.defineProperties(zi.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}}),Object.defineProperties(De.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),35048===this.usage},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),Object.assign(De.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?35048:35044),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Wo.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.assign(Re.prototype,{dispose:function(){console.error("THREE.Scene: .dispose() has been removed.")}}),Object.defineProperties(bc.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(u.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Ys}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(fn.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(dn.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(t){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=t}}}),Object.defineProperties(L.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(Le.prototype,{clearTarget:function(t,e,o,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,o,n)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(Le.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?3001:3e3}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Se.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(n.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(Oi.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new Mi).load(t,function(t){e.setBuffer(t)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),uc.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},D.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)},wr.crossOrigin=void 0,wr.loadTexture=function(t,e,o,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new Wn;return i.setCrossOrigin(this.crossOrigin),t=i.load(t,o,void 0,n),e&&(t.mapping=e),t},wr.loadTextureCube=function(t,e,o,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new Gn;return i.setCrossOrigin(this.crossOrigin),t=i.load(t,o,void 0,n),e&&(t.mapping=e),t},wr.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},wr.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"120"}})),t.ACESFilmicToneMapping=4,t.AddEquation=100,t.AddOperation=2,t.AdditiveAnimationBlendMode=2501,t.AdditiveBlending=2,t.AlphaFormat=1021,t.AlwaysDepth=1,t.AlwaysStencilFunc=519,t.AmbientLight=_i,t.AmbientLightProbe=Ni,t.AnimationClip=Nn,t.AnimationLoader=Fn,t.AnimationMixer=Gi,t.AnimationObjectGroup=Ui,t.AnimationUtils=Ol,t.ArcCurve=Xn,t.ArrayCamera=ke,t.ArrowHelper=lr,t.Audio=Oi,t.AudioAnalyser=uc,t.AudioContext=Jl,t.AudioListener=Di,t.AudioLoader=Mi,t.AxesHelper=cr,t.AxisHelper=function(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new cr(t)},t.BackSide=1,t.BasicDepthPacking=3200,t.BasicShadowMap=0,t.BinaryTextureLoader=function(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Vn(t)},t.Bone=Ve,t.BooleanKeyframeTrack=Cn,t.BoundingBoxHelper=function(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new rr(t,e)},t.Box2=Tc,t.Box3=Rr,t.Box3Helper=sr,t.BoxBufferGeometry=I,t.BoxGeometry=A,t.BoxHelper=rr,t.BufferAttribute=g,t.BufferGeometry=S,t.BufferGeometryLoader=wi,t.ByteType=1010,t.Cache=Pl,t.Camera=N,t.CameraHelper=nr,t.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},t.CanvasTexture=to,t.CatmullRomCurve3=Kn,t.CineonToneMapping=3,t.CircleBufferGeometry=un,t.CircleGeometry=cn,t.ClampToEdgeWrapping=1001,t.Clock=ec,t.ClosedSplineCurve3=dr,t.Color=Ys,t.ColorKeyframeTrack=kn,t.CompressedTexture=Ze,t.CompressedTextureLoader=Hn,t.ConeBufferGeometry=ln,t.ConeGeometry=an,t.CubeCamera=D,t.CubeGeometry=A,t.CubeReflectionMapping=301,t.CubeRefractionMapping=302,t.CubeTexture=ot,t.CubeTextureLoader=Gn,t.CubeUVReflectionMapping=306,t.CubeUVRefractionMapping=307,t.CubicBezierCurve=Zn,t.CubicBezierCurve3=ti,t.CubicInterpolant=xn,t.CullFaceBack=1,t.CullFaceFront=2,t.CullFaceFrontBack=3,t.CullFaceNone=0,t.Curve=zn,t.CurvePath=si,t.CustomBlending=5,t.CustomToneMapping=5,t.CylinderBufferGeometry=sn,t.CylinderGeometry=rn,t.Cylindrical=xc,t.DataTexture=P,t.DataTexture2DArray=nt,t.DataTexture3D=it,t.DataTextureLoader=Vn,t.DecrementStencilOp=7683,t.DecrementWrapStencilOp=34056,t.DefaultLoadingManager=jl,t.DepthFormat=1026,t.DepthStencilFormat=1027,t.DepthTexture=eo,t.DirectionalLight=vi,t.DirectionalLightHelper=or,t.DiscreteInterpolant=Tn,t.DodecahedronBufferGeometry=fo,t.DodecahedronGeometry=po,t.DoubleSide=2,t.DstAlphaFactor=206,t.DstColorFactor=208,t.DynamicBufferAttribute=function(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new g(t,e).setUsage(35048)},t.DynamicCopyUsage=35050,t.DynamicDrawUsage=35048,t.DynamicReadUsage=35049,t.EdgesGeometry=nn,t.EdgesHelper=function(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Xe(new nn(t.geometry),new ze({color:void 0!==e?e:16777215}))},t.EllipseCurve=qn,t.EqualDepth=4,t.EqualStencilFunc=514,t.EquirectangularReflectionMapping=303,t.EquirectangularRefractionMapping=304,t.Euler=gs,t.EventDispatcher=e,t.ExtrudeBufferGeometry=Wo,t.ExtrudeGeometry=Vo,t.Face3=Ks,t.Face4=function(t,e,o,n,i,r,s){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new Ks(t,e,o,i,r,s)};t.FaceColors=1,t.FileLoader=jn,t.FlatShading=1,t.Float32Attribute=function(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new b(t,e)},t.Float32BufferAttribute=b,t.Float64Attribute=function(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new E(t,e)},t.Float64BufferAttribute=E,t.FloatType=1015,t.Fog=Qa,t.FogExp2=$a,t.Font=Ii,t.FontLoader=Bi,t.FrontSide=0,t.Frustum=Ma,t.GLBufferAttribute=Wi,t.GLSL1="100",t.GLSL3="300 es",t.GammaEncoding=3007,t.Geometry=k,t.GeometryUtils={merge:function(t,e,o){if(console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),e.isMesh){e.matrixAutoUpdate&&e.updateMatrix();var n=e.matrix;e=e.geometry}t.merge(e,n,o)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},t.GreaterDepth=6,t.GreaterEqualDepth=5,t.GreaterEqualStencilFunc=518,t.GreaterStencilFunc=516,t.GridHelper=tr,t.Group=Ae,t.HalfFloatType=1016,t.HemisphereLight=ui,t.HemisphereLightHelper=Zi,t.HemisphereLightProbe=Li,t.IcosahedronBufferGeometry=go,t.IcosahedronGeometry=ho,t.ImageBitmapLoader=ki,t.ImageLoader=Un,t.ImageUtils=wr,t.ImmediateRenderObject=Yi,t.IncrementStencilOp=7682,t.IncrementWrapStencilOp=34055,t.InstancedBufferAttribute=Ti,t.InstancedBufferGeometry=Si,t.InstancedInterleavedBuffer=Vi,t.InstancedMesh=We,t.Int16Attribute=function(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new m(t,e)},t.Int16BufferAttribute=m,t.Int32Attribute=function(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new v(t,e)},t.Int32BufferAttribute=v,t.Int8Attribute=function(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new p(t,e)},t.Int8BufferAttribute=p,t.IntType=1013,t.InterleavedBuffer=De,t.InterleavedBufferAttribute=Oe,t.Interpolant=En,t.InterpolateDiscrete=2300,t.InterpolateLinear=2301,t.InterpolateSmooth=2302,t.InvertStencilOp=5386,t.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},t.KeepStencilOp=7680,t.KeyframeTrack=wn,t.LOD=He,t.LatheBufferGeometry=Zo,t.LatheGeometry=Jo,t.Layers=ms,t.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")},t.LessDepth=2,t.LessEqualDepth=3,t.LessEqualStencilFunc=515,t.LessStencilFunc=513,t.Light=ci,t.LightProbe=Ei,t.LightShadow=hi,t.Line=qe,t.Line3=kc,t.LineBasicMaterial=ze,t.LineCurve=ei,t.LineCurve3=oi,t.LineDashedMaterial=bn,t.LineLoop=Ye,t.LinePieces=1,t.LineSegments=Xe,t.LineStrip=0,t.LinearEncoding=3e3,t.LinearFilter=1006,t.LinearInterpolant=Sn,t.LinearMipMapLinearFilter=1008,t.LinearMipMapNearestFilter=1007,t.LinearMipmapLinearFilter=1008,t.LinearMipmapNearestFilter=1007,t.LinearToneMapping=1,t.Loader=Pn,t.LoaderUtils=ql,t.LoadingManager=On,t.LogLuvEncoding=3003,t.LoopOnce=2200,t.LoopPingPong=2202,t.LoopRepeat=2201,t.LuminanceAlphaFormat=1025,t.LuminanceFormat=1024,t.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},t.Material=u,t.MaterialLoader=xi,t.Math=br,t.MathUtils=br,t.Matrix3=Sr,t.Matrix4=is,t.MaxEquation=104,t.Mesh=T,t.MeshBasicMaterial=h,t.MeshDepthMaterial=Ee,t.MeshDistanceMaterial=xe,t.MeshFaceMaterial=function(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t},t.MeshLambertMaterial=vn,t.MeshMatcapMaterial=_n,t.MeshNormalMaterial=yn,t.MeshPhongMaterial=fn,t.MeshPhysicalMaterial=dn,t.MeshStandardMaterial=pn,t.MeshToonMaterial=mn,t.MinEquation=103,t.MirroredRepeatWrapping=1002,t.MixOperation=1,t.MultiMaterial=function(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t},t.MultiplyBlending=4,t.MultiplyOperation=0,t.NearestFilter=1003,t.NearestMipMapLinearFilter=1005,t.NearestMipMapNearestFilter=1004,t.NearestMipmapLinearFilter=1005,t.NearestMipmapNearestFilter=1004,t.NeverDepth=0,t.NeverStencilFunc=512,t.NoBlending=0,t.NoColors=0,t.NoToneMapping=0,t.NormalAnimationBlendMode=2500,t.NormalBlending=1,t.NotEqualDepth=7,t.NotEqualStencilFunc=517,t.NumberKeyframeTrack=An,t.Object3D=s,t.ObjectLoader=Ci,t.ObjectSpaceNormalMap=1,t.OctahedronBufferGeometry=uo,t.OctahedronGeometry=co,t.OneFactor=201,t.OneMinusDstAlphaFactor=207,t.OneMinusDstColorFactor=209,t.OneMinusSrcAlphaFactor=205,t.OneMinusSrcColorFactor=203,t.OrthographicCamera=mi,t.PCFShadowMap=1,t.PCFSoftShadowMap=2,t.PMREMGenerator=nu,t.ParametricBufferGeometry=io,t.ParametricGeometry=no,t.Particle=function(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new je(t)},t.ParticleBasicMaterial=function(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Ke(t)},t.ParticleSystem=function(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new $e(t,e)},t.ParticleSystemMaterial=function(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Ke(t)},t.Path=ai,t.PerspectiveCamera=R,t.Plane=Ns,t.PlaneBufferGeometry=U,t.PlaneGeometry=H,t.PlaneHelper=ar,t.PointCloud=function(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new $e(t,e)},t.PointCloudMaterial=function(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Ke(t)},t.PointLight=fi,t.PointLightHelper=Ji,t.Points=$e,t.PointsMaterial=Ke,t.PolarGridHelper=er,t.PolyhedronBufferGeometry=so,t.PolyhedronGeometry=ro,t.PositionalAudio=Pi,t.PropertyBinding=Hi,t.PropertyMixer=ji,t.QuadraticBezierCurve=ni,t.QuadraticBezierCurve3=ii,t.Quaternion=Ir,t.QuaternionKeyframeTrack=Bn,t.QuaternionLinearInterpolant=In,t.REVISION="120",t.RGBADepthPacking=3201,t.RGBAFormat=1023,t.RGBAIntegerFormat=1033,t.RGBA_ASTC_10x10_Format=37819,t.RGBA_ASTC_10x5_Format=37816,t.RGBA_ASTC_10x6_Format=37817,t.RGBA_ASTC_10x8_Format=37818,t.RGBA_ASTC_12x10_Format=37820,t.RGBA_ASTC_12x12_Format=37821,t.RGBA_ASTC_4x4_Format=37808,t.RGBA_ASTC_5x4_Format=37809,t.RGBA_ASTC_5x5_Format=37810,t.RGBA_ASTC_6x5_Format=37811,t.RGBA_ASTC_6x6_Format=37812,t.RGBA_ASTC_8x5_Format=37813,t.RGBA_ASTC_8x6_Format=37814,t.RGBA_ASTC_8x8_Format=37815;t.RGBA_BPTC_Format=36492,t.RGBA_ETC2_EAC_Format=37496,t.RGBA_PVRTC_2BPPV1_Format=35843,t.RGBA_PVRTC_4BPPV1_Format=35842,t.RGBA_S3TC_DXT1_Format=33777,t.RGBA_S3TC_DXT3_Format=33778,t.RGBA_S3TC_DXT5_Format=33779,t.RGBDEncoding=3006,t.RGBEEncoding=3002,t.RGBEFormat=1023,t.RGBFormat=1022,t.RGBIntegerFormat=1032,t.RGBM16Encoding=3005,t.RGBM7Encoding=3004,t.RGB_ETC1_Format=36196,t.RGB_ETC2_Format=37492,t.RGB_PVRTC_2BPPV1_Format=35841,t.RGB_PVRTC_4BPPV1_Format=35840,t.RGB_S3TC_DXT1_Format=33776,t.RGFormat=1030,t.RGIntegerFormat=1031,t.RawShaderMaterial=gn,t.Ray=ns,t.Raycaster=zi,t.RectAreaLight=bi,t.RedFormat=1028,t.RedIntegerFormat=1029,t.ReinhardToneMapping=2,t.RepeatWrapping=1e3,t.ReplaceStencilOp=7681,t.ReverseSubtractEquation=102,t.RingBufferGeometry=Qo,t.RingGeometry=$o,t.SRGB8_ALPHA8_ASTC_10x10_Format=37851,t.SRGB8_ALPHA8_ASTC_10x5_Format=37848,t.SRGB8_ALPHA8_ASTC_10x6_Format=37849,t.SRGB8_ALPHA8_ASTC_10x8_Format=37850,t.SRGB8_ALPHA8_ASTC_12x10_Format=37852,t.SRGB8_ALPHA8_ASTC_12x12_Format=37853,t.SRGB8_ALPHA8_ASTC_4x4_Format=37840,t.SRGB8_ALPHA8_ASTC_5x4_Format=37841,t.SRGB8_ALPHA8_ASTC_5x5_Format=37842,t.SRGB8_ALPHA8_ASTC_6x5_Format=37843,t.SRGB8_ALPHA8_ASTC_6x6_Format=37844,t.SRGB8_ALPHA8_ASTC_8x5_Format=37845,t.SRGB8_ALPHA8_ASTC_8x6_Format=37846,t.SRGB8_ALPHA8_ASTC_8x8_Format=37847,t.Scene=Re,t.SceneUtils={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}},t.ShaderChunk=La,t.ShaderLib=Ra,t.ShaderMaterial=L,t.ShadowMaterial=hn,t.Shape=li,t.ShapeBufferGeometry=en,t.ShapeGeometry=tn,t.ShapePath=Ai,t.ShapeUtils=Ll,t.ShortType=1011,t.Skeleton=Ge,t.SkeletonHelper=$i,t.SkinnedMesh=Ue,t.SmoothShading=2,t.Sphere=Kr,t.SphereBufferGeometry=Ko,t.SphereGeometry=Yo,t.Spherical=Ec,t.SphericalHarmonics3=zl,t.Spline=mr,t.SplineCurve=ri,t.SplineCurve3=fr,t.SpotLight=pi,t.SpotLightHelper=Ki,t.Sprite=je,t.SpriteMaterial=Pe,t.SrcAlphaFactor=204,t.SrcAlphaSaturateFactor=210,t.SrcColorFactor=202,t.StaticCopyUsage=35046,t.StaticDrawUsage=35044,t.StaticReadUsage=35045,t.StereoCamera=Ri,t.StreamCopyUsage=35042,t.StreamDrawUsage=35040,t.StreamReadUsage=35041,t.StringKeyframeTrack=Mn,t.SubtractEquation=101,t.SubtractiveBlending=3,t.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},t.TangentSpaceNormalMap=0,t.TetrahedronBufferGeometry=lo,t.TetrahedronGeometry=ao,t.TextBufferGeometry=Xo,t.TextGeometry=qo,t.Texture=o,t.TextureLoader=Wn,t.TorusBufferGeometry=Eo,t.TorusGeometry=bo,t.TorusKnotBufferGeometry=_o,t.TorusKnotGeometry=vo,t.Triangle=Ws,t.TriangleFanDrawMode=2,t.TriangleStripDrawMode=1,t.TrianglesDrawMode=0,t.TubeBufferGeometry=yo,t.TubeGeometry=mo,t.UVMapping=300,t.Uint16Attribute=function(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new y(t,e)},t.Uint16BufferAttribute=y,t.Uint32Attribute=function(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new _(t,e)},t.Uint32BufferAttribute=_,t.Uint8Attribute=function(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new d(t,e)},t.Uint8BufferAttribute=d,t.Uint8ClampedAttribute=function(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new f(t,e)},t.Uint8ClampedBufferAttribute=f,t.Uniform=bc,t.UniformsLib=Na,t.UniformsUtils=Aa,t.UnsignedByteType=1009,t.UnsignedInt248Type=1020,t.UnsignedIntType=1014,t.UnsignedShort4444Type=1017,t.UnsignedShort5551Type=1018,t.UnsignedShort565Type=1019,t.UnsignedShortType=1012,t.VSMShadowMap=3,t.Vector2=Er,t.Vector3=Mr,t.Vector4=kr,t.VectorKeyframeTrack=Ln,t.Vertex=function(t,e,o){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Mr(t,e,o)},t.VertexColors=2,t.VideoTexture=Je,t.WebGL1Renderer=Ne,t.WebGLCubeRenderTarget=O,t.WebGLMultisampleRenderTarget=i,t.WebGLRenderTarget=n,t.WebGLRenderTargetCube=function(t,e,o){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new O(t,o)},t.WebGLRenderer=Le,t.WebGLUtils=Ce,t.WireframeGeometry=oo,t.WireframeHelper=function(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Xe(new oo(t.geometry),new ze({color:void 0!==e?e:16777215}))},t.WrapAroundEnding=2402,t.XHRLoader=function(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new jn(t)},t.ZeroCurvatureEnding=2400,t.ZeroFactor=200,t.ZeroSlopeEnding=2401,t.ZeroStencilOp=0,t.sRGBEncoding=3001,Object.defineProperty(t,"__esModule",{value:!0})})},function(t,e,o){(function(e){var o=function(){};o.getCSRFTokenCookie=function(){var t=e('meta[name="csrf-token"]').attr("content");return t||document.cookie.split("; ").map(function(e){var o=e.split("=");"csrf-token"===o[0]&&(t=o[1])}),t},t.exports=o}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.instant_search=function(){e(".search-query-dashboard").keyup(function(){var t=e(this).val(),o=0;e(".dashboard-list li").each(function(){e(this).text().search(new RegExp(t,"i"))<0?e(this).hide():(e(this).show(),o++)}),e(".dashboard-list").each(function(){0===e(this).find("li:visible").length?e(this).prev("h4").hide():e(this).prev("h4").show()}),0===o?e(".no_matches_found").show():e(".no_matches_found").hide()})}}(window.siteGui=window.siteGui||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.pageless=function(){if(e(".load_more").length){var t=e(".load_more").first().data("urlconstructor");e(".load_more").pagination({dataSelector:"ref",urlConstructor:t,startPage:1,loadingText:"<div class='load_more_loading'>Loading</div>",loadingImage:"https://s3-us-west-1.amazonaws.com/123d-circuits-assets/spinner_standard_white.gif"})}}}(window.siteGui=window.siteGui||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.tags=function(){e(".tagsinput").importTags(""),e(".tagsinput").tagsInput({autocomplete_url:e(".tagsinput").data("autocomplete"),defaultText:"+",height:"20px",width:"686px"})}}(window.siteGui=window.siteGui||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.analytics=function(){window&&(t.analytics.ga=window.googleGA||function(t,e,o,n,i){i?console.log("GA: "+n+", "+i):console.log("GA: "+n)},t.analytics.ga&&e("body").on("click touch",".js-analytics",function(e){t.analytics.clickTouch(this)}))},t.analytics.clickTouch=function(o){$element=e(o),data=$element.data()||{},properties={},Object.keys(data).forEach(function(t){"event"==t&&(event=data[t])}),event&&t.analytics.log(event)},t.analytics.log=function(e,o){t.analytics.ga&&(o?t.analytics.ga("send","event","cir-ops",e,o):t.analytics.ga("send","event","cir-ops",e))}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e){},function(t,e,o){(function(t){!function(t,e,o){t.card=function(){var t=this;e("body").on("mouseenter",".js-circuit_card__info",function(){t.show_actions(e(this))}),e("body").on("mouseleave",".js-circuit_card__info",function(){t.hide_actions(e(this))})},t.card.prototype.show_actions=function(t){e(".circuit_card__info",t).velocity("stop",!0),e(".circuit_card__info",t).velocity({height:120},{easing:[200,40],delay:150})},t.card.prototype.hide_actions=function(t){e(".circuit_card__info",t).velocity("stop",!0),e(".circuit_card__info",t).velocity({height:64},{easing:[200,40],delay:150})}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.cart_overview=function(){var o=this;o.address_flag=!1,o.coupon_flag=!1,o.spinner=new Spinner({width:2,length:3,radius:5,lines:9}).spin(),e(".js-cart__loading-container").html(o.spinner.el),this.cartControl=new t.canjsCart.CartControl(".js-cart-container",{ui_view:o})},t.cart_overview.prototype.refresh_page=function(){location.reload()},t.cart_overview.prototype.reset_ui=function(){e(".js-cart__empty").hide(),e(".js-cart__content").show(),this.show_loading()},t.cart_overview.prototype.show_loading=function(){e(".js-cart__loading-container").show(),e(".js-cart__recommondations").hide()},t.cart_overview.prototype.hide_loading=function(){e(".js-cart__loading-container").hide(),e(".js-cart__recommondations").show()},t.cart_overview.prototype.empty_cart=function(){e(".js-cart").empty(),e(".js-cart__summary").empty(),e(".js-cart__content").hide(),e(".js-cart__empty").show()},t.cart_overview.prototype.reset_address=function(t){e(".js-no-address-yet").hide(),e(".js-shipping-address--view").hide(),e(".js-shipping-address--edit").hide(),t||(this.address_flag?e(".js-shipping-address--view").show():e(".js-no-address-yet").show())},t.cart_overview.prototype.edit_address=function(){this.reset_address(!0),e(".js-shipping-address--edit").show()},t.cart_overview.prototype.show_coupons=function(t){e(".js-cart-coupons__add__btn").hide(),e(".js-cart-coupons__add__field").hide(),e(".js-cart-show-coupons").hide(),e(".js-cart-coupons").show(),!this.coupon_flag||t?e(".js-cart-coupons__add__field").show():e(".js-cart-coupons__add__btn").show()},t.cart_overview.prototype.hide_coupons=function(){this.coupon_flag?(e(".js-cart-coupons__add__btn").show(),e(".js-cart-coupons__add__field").hide()):(e(".js-cart-coupons").hide(),e(".js-cart-show-coupons").show())},t.cart_overview.prototype.check_valid_ascii=function(){var t=!1;return e(".js-ascii-message").each(function(){e(this).remove()}),e(".cart__required--field").each(function(){e(this).removeClass("cart__required--field")}),e(".js-valid-ascii-required").each(function(){var o=this;e(this).find("input").each(function(){var n=e(this).val();new RegExp(/[^\x00-\xFF]/g).test(n)&&(e(o).find(".js-required-append").append("<div class='right cart__required js-ascii-message'>Invalid characters</div>"),e(this).addClass("cart__required--field"),t=!0)})}),!t},t.cart_overview.prototype.check_required_fields=function(t){var o=!1,n="<div class='right cart__required js-required-message'>Required field</div>";return e(".js-required-message").each(function(){e(this).remove()}),e(".cart__required--field").each(function(){e(this).removeClass("cart__required--field")}),e(".js-required").each(function(i,r){var s=e(this).data("required-type");"string"==s?""==e(this).find("input:first").val()&&(t||(e(this).find(".js-required-append").append(n),e(this).find("input:first").addClass("cart__required--field"),e(this).find("select").each(function(){e(this).addClass("cart__required--field")})),o=!0):"dropdown"==s&&""==e(this).find("select:first").val()&&(t||(e(this).find(".js-required-append").append(n),e(this).find("select:first").addClass("cart__required--field")),o=!0)}),!o},t.cart_overview.prototype.check_if_first_time=function(){var t=0,o=0;return e(".js-required").each(function(n,i){t+=1,""!=e(this).find("input:first").val()&&""!=e(this).find("select:first").val()||(o+=1)}),t==o}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.canjsCart={},t.canjsCart.CartControl=can.Control({init:function(t,o){var n=this;n.ui_view=o.ui_view,n.template_cart="cart-template__cart--grouped",n.template_summary="cart-template__summary",n.template_cart__holder=e(".js-cart"),n.template_summary__holder=e(".js-cart__summary"),n.reload()},reload:function(){var e=this;e.ui_view.reset_ui(),t.canjsCart.CartModel.get(function(t){window.CART_DEBUG&&console.log(t),e.options.cart=t,e.refresh(!0)}).fail(function(e){t.error("Cart Error","We're very sorry, something went wrong.",["contact_support","clear_cart"],e)})},refresh:function(o){var n=this;if(window.cart_menu&&(window.cart_menu.total_items=n.options.cart.TOTAL_NUMBER,window.cart_menu.updateTotal()),0==n.options.cart.LINE_ITEMS.length)return n.ui_view.empty_cart(),void n.ui_view.hide_loading();n.ui_view.reset_ui(),n.template_cart__holder.html(can.view(n.template_cart,n.options.cart)),console.log(n.options.cart),n.template_summary__holder.html(can.view(n.template_summary,n.options.cart)),n.options.cart.COUPONS&&n.options.cart.COUPONS.length?n.ui_view.coupon_flag=!0:n.ui_view.coupon_flag=!1,o?n.options.shipping?n.options.shipping.reload():n.options.shipping=new t.canjsCart.ShippingAddressControl(".js-cart-container",{parent:n,ui_view:n.ui_view,finish:n.ui_view.hide_loading}):n.options.shipping.refresh({finish:function(){n.ui_view.hide_loading()}}),e(".js-enable-tooltip").length&&e(".js-enable-tooltip").tipsy()},".js-remove-item click":function(e,o){var n=this,i=e.data("id");n.ui_view.show_loading(),this.options.cart.remove_item({line_item_id:i},function(t){n.options.cart=t,n.reload()}).fail(function(e){t.error("Cart Error","We're very sorry, something went wrong.",["contact_support","clear_cart"],e),n.refresh()})},".js-edit-shipping-address click":function(o,n){var i=this;if(t.analytics){(new t.analytics).track("add shipping address button",{})}e(".js-user-is-logged-in").length>0&&i.ui_view.edit_address()},".js-cancel-shipping-address click":function(t,e){this.ui_view.reset_address()},".js-shipping-option change":function(e,o){var n=this,i=e.data("id"),r=e.val();n.ui_view.show_loading(),this.options.cart.change_shipping({line_item_id:i,option:r},function(t){n.options.cart=t,n.refresh(!0)}).fail(function(e){t.error("Cart Error","We're very sorry, something went wrong.",["contact_support","clear_cart"],e),n.refresh()})},".js-cart-show-coupons click":function(t,e){this.ui_view.show_coupons()},".js-cart-coupons__add__btn--action click":function(t,e){this.ui_view.show_coupons(!0)},".js-cancel-adding-coupon click":function(t,e){this.ui_view.hide_coupons()},".js-add-coupon click":function(o,n){var i=this,r=e(".js-coupon-code").val();i.ui_view.show_loading(),this.options.cart.add_coupon({coupon_code:r},function(t){i.options.cart=t,i.refresh()}).fail(function(e){t.warning("Invalid coupon","Sorry invalid coupon, please try again",!1,e),i.refresh()})},".js-remove-coupon click":function(e,o){var n=this,i=e.data("code");n.ui_view.show_loading(),this.options.cart.remove_coupon({coupon_code:i},function(t){n.options.cart=t,n.refresh()}).fail(function(e){t.error("Cart Error","We're very sorry, something went wrong.",["contact_support","clear_cart"],e),n.refresh()})},".js-cart__basket__item__quantity__input focusin":function(t,e){t.parent().parent().find(".js-cart__basket__item__update-btn").show(),t.parent().parent().find(".js-cart__basket__item__price").hide()},".js-cart__basket__item__quantity__input blur":function(t,e){console.log(e),t.parent().parent().find(".js-cart__basket__item__update-btn").hide(),t.parent().parent().find(".js-cart__basket__item__price").show()},".js-update-cart mousedown":function(o,n){var i=this,r=0,s=0;i.ui_view.show_loading(),e(".js-cart__basket__item__quantity__input").each(function(){var o=e(this).data("lineid"),n=e(this).data("product_id"),a=e(this).data("original_q"),l=parseInt(e(this).val());l&&l!=a&&(r+=1,e.ajax({type:"PUT",url:"/cart/update_quantity",data:{line_item_id:o,product_id:n,quantity:l},error:function(e){t.error("Cart Error","We're very sorry, something went wrong.",["contact_support","clear_cart"],!1)},success:function(t){s+=1,r==s&&i.reload()}}))}),0==r&&i.reload()},".js-cart__checkoutbtn click":function(o,n){var i=this;if(t.analytics){(new t.analytics).track("checkout button",{})}if(0==i.options.cart.LINE_ITEMS.length)return void i.ui_view.empty_cart();i.secure_session_window=openSessionPopup("signin","/cart/checkout"),i.secure_session_window.location.href="/cart/processing",e(i.secure_session_window.document.body).html("Processing..."),i.ui_view.show_loading(),e.ajax({url:window.location.origin+"/users/logged_in_secure/",type:"GET",complete:function(){i.ui_view.hide_loading()},error:function(e){t.error("Cart Error","We're very sorry, something went wrong.",["contact_support","clear_cart"],err)},success:function(t){window.CART_DEBUG&&console.log(t),"YES"==t?(i.secure_session_window.close(),window.location.href="/cart/checkout"):i.secure_session_window.location.href="/users/auth/adsk"}})},".js-cart__minimize_shipping change":function(e,o){var n=this;this.ui_view.show_loading(),!e.is(":checked")?this.options.cart.set_fastest_shipping({},function(t){n.reload()}).fail(function(e){t.error("Cart Error","We're very sorry, something went wrong.",["contact_support","clear_cart"],e),n.refresh()}):this.options.cart.set_minimized_shipping({},function(t){n.reload()}).fail(function(e){t.error("Cart Error","We're very sorry, something went wrong.",["contact_support","clear_cart"],e),n.refresh()})}})}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.shoppingcart_menu=function(){var t=this;t.total_items=0,t.queue=0,e(".js-shoppingcart-model-total").length&&(t.total_items=parseInt(e(".js-shoppingcart-model-total").html())),t.updateTotal(),e("body").on("click",".js-add-to-cart",function(){$this=e(this),t.addItemToCart($this.data("sku"),$this.data("origin"),$this.data("recommend"))})},t.shoppingcart_menu.prototype.updateTotal=function(){var t=this;e(".js-shoppingcart-total").html(t.total_items),t.total_items<=0&&e(".js-shoppingcart-menu").hide()},t.shoppingcart_menu.prototype.addItemToCart=function(o,n,i){var r=this;ga("send","event","addItemToCart","click",o),window.cart_overview&&window.cart_overview.show_loading(),r.queue+=1,e(".js-shoppingcart-menu").is(":visible")||e(".js-shoppingcart-menu").show(),r.animate_loading(),e.ajax({type:"POST",url:"/cart/add_item?method=get",data:{id:o,origin:n,recommend:i},error:function(e){r.queue-=1,r.animate_loading_hide(),r.updateTotal(),t.warning("No longer in stock","We're sorry, this item is no longer in stock.",!1),window.cart_overview&&window.cart_overview.hide_loading()},success:function(t){console.log(t),r.queue-=1;for(var e=0,o=0;o<t.CART.LINE_ITEMS.length;o++){var n=t.CART.LINE_ITEMS[o];"SHIPPING"!==n.PRODUCT_TYPE&&(e+=n.QUANTITY)}r.total_items=e,r.total_items_server=e,r.updateTotal(),r.animate_tada(),window.cart_overview&&window.cart_overview.cartControl.reload()}})},t.shoppingcart_menu.prototype.animate_loading=function(){e(".js-shoppingcart-menu__loading").show(),t.spinner(e(".js-shoppingcart-menu__loading")),e(".js-shoppingcart-menu__svgimage").hide(),e(".js-shoppingcart-total").hide(),e(".js-shoppingcart-menu__animation").removeClass("mediumAnimation tada")},t.shoppingcart_menu.prototype.animate_loading_hide=function(){e(".js-shoppingcart-menu__loading").hide(),e(".js-shoppingcart-menu__loading").empty(),e(".js-shoppingcart-menu__svgimage").show(),e(".js-shoppingcart-total").show()},t.shoppingcart_menu.prototype.animate_tada=function(){0==this.queue&&(this.animate_loading_hide(),e(".js-shoppingcart-menu__animation").addClass("mediumAnimation tada"))}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.canjsCart.CartModel=can.Model({get:function(o){return e.ajax({url:"/cart/get.json",type:"get",dataType:"json",success:function(e){var n=t.canjsCart.CartModel.preprocess(e);return o(new t.canjsCart.CartModel(n))},error:function(t){return t}})},preprocess:function(t){if(t&&t.LINE_ITEMS&&""!==t.LINE_ITEMS){for(var e=0,o={},n=0;n<t.LINE_ITEMS.length;n++){var i=t.LINE_ITEMS[n];if(i.DATA){i.DATA=JSON.parse(i.DATA);var r=i.DATA.name;r&&(i.NAME="PCB - "+r+" (x3)")}if("SHIPPING"!==i.PRODUCT_TYPE&&(i.not_shipping=!0,e+=i.QUANTITY),"SHIPPING"!==i.PRODUCT_TYPE){var s=new Date,a=s.toISOString(),l=new Date(i.DATA.back_in_stock),c=l.toISOString();i.IS_ITEM_IN_STOCK=a>=c?"In stock":'<span class="cart__notinstock">Not in stock</span>'}i.DOLLAR_PRICE=t.currencySymbol+(i.PRICE/i.QUANTITY).toFixed(2)}if(t.TOTAL_NUMBER=e,t.TOTAL_PRICE_EXCL_SHIPPING=t.currencySymbol+t.LINEITEM_SUBTOTAL.toFixed(2),t.TOTAL_PRICE_SHIPPING=t.currencySymbol+t.SHIPPING_PRICE.toFixed(2),t.DOLLAR_SUBTOTAL=t.currencySymbol+t.SUBTOTAL.toFixed(2),""!==t.SHIPPING_ADDRESS_ID?t.READY_TO_CHECKOUT=!0:t.READY_TO_CHECKOUT=!1,t.COUPONS.length>0)for(var n=0;n<t.COUPONS.length;n++){var u=t.COUPONS[n];u.PRICE="- "+t.currencySymbol+t.DISCOUNT}for(var n=0;n<t.LINE_ITEMS.length;n++){var i=t.LINE_ITEMS[n];if("SHIPPING"==i.PRODUCT_TYPE){var h=i.VENDOR_DISPLAY_NAME.toLowerCase().indexOf("oshpark")>-1?"123D Circuits":i.VENDOR_DISPLAY_NAME;group={shipping_item:i,shop:h,SHIPPING_DATE:function(t){var e=new Date,o=new Date;o.setDate(e.getDate()+t);var n=o.getDate();return o.getMonth()+1+"/"+n+"/"+o.getFullYear()}(i.LEAD_DATE),line_items:[]};for(var g=0;g<t.LINE_ITEMS.length;g++){var p=t.LINE_ITEMS[g];-1!==i.PARENT_IDS.indexOf(p.ID)&&group.line_items.push(p)}o[n]=group}}t.grouped_line_items=[];for(var n in o)t.grouped_line_items.push(o[n]);t.grouped_line_items.sort(function(t,e){return t.SHIPPING_DATE>e.SHIPPING_DATE?1:t.SHIPPING_DATE<e.SHIPPING_DATE?-1:0}),"MINIMUM_SHIPMENTS"==t.SHIPMENT_GROUPING_METHOD?t.MINIMIZED_SHIPPING="checked":t.MINIMIZED_SHIPPING="",t.grouped_line_items.length>1||"checked"==t.MINIMIZED_SHIPPING&&t.LINE_ITEMS.length>2?t.SHOW_MINIMIZED_SHIPPING=!0:t.SHOW_MINIMIZED_SHIPPING=!1}return t}},{remove_item:function(o,n){return e.ajax({url:"/cart/remove_item.json",type:"delete",dataType:"json",data:o,success:function(e){var o=t.canjsCart.CartModel.preprocess(e);return n(new t.canjsCart.CartModel(o))},error:function(t){return t}})},change_shipping:function(o,n){return e.ajax({url:"/cart/change_shipping.json",type:"put",dataType:"json",data:o,success:function(e){var o=t.canjsCart.CartModel.preprocess(e);return n(new t.canjsCart.CartModel(o))},error:function(t){return t}})},set_minimized_shipping:function(t,o){return e.ajax({url:"/cart/minimize_shipping",type:"put",dataType:"json",data:t,success:function(t){return o(t)},error:function(t){return t}})},set_fastest_shipping:function(t,o){return e.ajax({url:"/cart/fastest_shipping",type:"put",dataType:"json",data:t,success:function(t){return o(t)},error:function(t){return t}})},add_coupon:function(o,n){return e.ajax({url:"/cart/add_coupon.json",type:"put",dataType:"json",data:o,success:function(e){var o=t.canjsCart.CartModel.preprocess(e);return n(new t.canjsCart.CartModel(o))},error:function(t){return t}})},remove_coupon:function(o,n){return e.ajax({url:"/cart/remove_coupon.json",type:"delete",dataType:"json",data:o,success:function(e){var o=t.canjsCart.CartModel.preprocess(e);return n(new t.canjsCart.CartModel(o))},error:function(t){return t}})}})}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e){},function(t,e,o){(function(t){!function(t,e,o){t.canjsCart.ShippingAddressControl=can.Control({init:function(t,e){var o=this;o.parent=e.parent,o.ui_view=e.ui_view,o.finish=e.finish,o.prevCountryCode=!1,o.reload()},reload:function(e){var o=this;t.canjsCart.ShippingAddress.get(function(t){window.CART_DEBUG&&console.log(t),o.options.shipping_address=t,o.refresh(),o.ui_view.check_required_fields(!0)||(o.parent.options.cart.attr({READY_TO_CHECKOUT:!1}),o.parent.refresh(),o.ui_view.check_if_first_time()||(o.ui_view.check_required_fields(),o.ui_view.edit_address()))}).fail(function(e){t.error("Cart Error","We're very sorry, something went wrong.",["clear_cart","contact_support"],e),o.refresh()})},refresh:function(t){var o=this;o.options.shipping_address.ADDRESS_TYPE?o.parent.ui_view.address_flag=!0:o.parent.ui_view.address_flag=!1,o.parent.ui_view.reset_address(),e(".js-shipping-address--view__address").html(can.view("shipping_address_view_template",o.options.shipping_address)),e(".js-shipping-address--edit").html(can.view("shipping_address_edit_template",o.options.shipping_address)),e(".js-shipping-address-country-code").val(o.options.shipping_address.COUNTRY_CODE),e(".js-shipping-address-states-canada").val(o.options.shipping_address.STATE),e(".js-shipping-address-states-usa").val(o.options.shipping_address.STATE),e(".js-shipping-address-country-code").change(),t&&t.finish&&(o.finish=t.finish),o.finish&&o.finish(),window.location.href.indexOf("edit_address")>-1&&o.parent.ui_view.edit_address()},".js-shipping-address-country-code change":function(t,o){e(".js-shipping-address-states-usa").hide(),e(".js-shipping-address-states-canada").hide(),e(".js-shipping-address-state").show(),self.prevCountryCodeDirty&&(e(".js-shipping-address-state").val(""),self.prevCountryCodeDirty=!1),"US"!=t.val()&&"CA"!=t.val()||(self.prevCountryCodeDirty=!0,e(".js-shipping-address-state").hide(),"US"==t.val()&&(e(".js-shipping-address-states-usa").show(),e(".js-shipping-address-states-usa").change()),"CA"==t.val()&&(e(".js-shipping-address-states-canada").show(),e(".js-shipping-address-states-canada").change()))},".js-shipping-address-states-usa change":function(t,o){e(".js-shipping-address-state").val(t.val())},".js-shipping-address-states-canada change":function(t,o){e(".js-shipping-address-state").val(t.val())},".js-save-shipping-address click":function(o,n){var i=this,r=o.closest(".js-shipping-address"),s={name:e(".js-shipping-address-name",r).val(),address1:e(".js-shipping-address-address1",r).val(),address2:e(".js-shipping-address-address2",r).val(),city:e(".js-shipping-address-city",r).val(),postalCode:e(".js-shipping-address-postal-code",r).val(),telephone:e(".js-shipping-address-telephone",r).val(),state:e(".js-shipping-address-state",r).val(),countryCode:e(".js-shipping-address-country-code",r).val()};i.ui_view.check_required_fields()&&i.ui_view.check_valid_ascii()&&(i.ui_view.show_loading(),i.options.shipping_address.set(s,function(t){i.options.shipping_address=t,i.parent.reload()}).fail(function(e){t.error("Cart Error","We're very sorry, something went wrong.",["clear_cart","contact_support"],e),i.refresh()}))}})}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.canjsCart.ShippingAddress=can.Model({get:function(o){return e.ajax({url:"/cart/shipping_address.json",type:"GET",dataType:"json",success:function(e){return o(new t.canjsCart.ShippingAddress(e))},error:function(t){return t}})}},{set:function(o,n){var i={shipping_address:o};return e.ajax({url:"/cart/shipping_address.json",type:"PUT",dataType:"json",data:i,success:function(e){return n(new t.canjsCart.ShippingAddress(e))},error:function(t){return t}})}})}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.confirm=function(){var t=this;e("body").on("click",".js-are-you-sure",function(e){t.are_you_sure(e)})},t.confirm.prototype.are_you_sure=function(t){if(!window.confirm("Are you sure?"))return t.preventDefault(),!1}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.eagle=function(){var t=this;e("body").on("click",".js-eagleimport__btn",function(){t.sendData()}),e("body").on("change input",".js-upload__data--board",function(){JSON.parse(e(this).val()).length>0?(e(".js-eagleimport__btn--enabled",".js-eagleimport").show(),e(".js-eagleimport__btn--disabled",".js-eagleimport").hide()):(e(".js-eagleimport__btn--enabled",".js-eagleimport").hide(),e(".js-eagleimport__btn--disabled",".js-eagleimport").show())})},t.eagle.prototype.sendData=function(){var t=e(".js-upload__data--schematic",".js-eagleimport").val(),o=e(".js-upload__data--board",".js-eagleimport").val();e.ajax({type:"POST",dataType:"json",url:"/eagle/receive",data:{schematic:t,board:o}}).success(function(t){window.location.href="/eagle/crunch/?job="+t.job}).error(function(t){alert("Something went wrong, please try again!"),location.reload()})}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.eagleBoardExport=function(){var t=this;e("body").on("click",".js-eagle-board-export",function(){t.sendData()})},t.eagleBoardExport.prototype.sendData=function(){var o=this,n=window.location.pathname.replace(/\/$/,""),i=n.substring(n.lastIndexOf("/")+1);if(i.indexOf("-")>-1)var r=i.substring(0,i.indexOf("-"));else var r=i;e.ajax({type:"POST",dataType:"json",url:"/eagle_board_export",data:{id:r}}).done(function(e){new t.cruncher(e.command,"/eagle_board_export",o.completed)})},t.eagleBoardExport.prototype.completed=function(t,e){e.hideLoading(),window.location.href=t.result}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.error=function(t,o,n,i,r){e(".js-error-message").length&&e(".js-error-message").remove();var s=e("<div class='circuits_error js-error-message hide'><div class='circuits_error__top clearfix'><div class='left'><div class='circuits_error__title js-error-message__title'>Sorry, something went wrong</div></div><div class='right'><a class='icon__close_error js-close-error'><?xml version='1.0' encoding='utf-8'?><!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'><svg xmlns='http://www.w3.org/2000/svg' width='30' height='30'><g class='svg_icon' enable-background='new 0 0 30 30'><path d='M14.978 6.935c4.442 0 8.044 3.602 8.044 8.046 0 4.442-3.602 8.045-8.044 8.045-4.444 0-8.045-3.603-8.045-8.045 0-4.445 3.602-8.046 8.045-8.046m.001-1.935c-5.503 0-9.979 4.479-9.979 9.98s4.476 9.979 9.979 9.979c5.502 0 9.979-4.477 9.979-9.979s-4.478-9.98-9.979-9.98zM18.757 17.272l-2.292-2.295 2.301-2.297-1.482-1.484-2.299 2.299-2.291-2.292-1.497 1.469 2.306 2.305-2.3 2.302 1.478 1.478 2.303-2.3 2.295 2.295z'/></g></svg></a></div></div>    <div class='circuits_error__body js-error-message__body'>We have encountered a serious error, very sorry about that, our engineers have been notified, try to refresh the page to see if that solves the problem.</div></div>");return s.appendTo("body"),t&&e(".js-error-message__title",s).html(t),o&&e(".js-error-message__body",s).html(o),n&&"[object Array]"===Object.prototype.toString.call(n)&&n.forEach(function(t){if("contact_support"==t){i&&(""!=i.responseText?i.responseText:i.statusText&&i.statusText),e(".js-error-message__body",s).append("<div class='vertical-spacing--top'><a class='circ_btn circ_btn--m circ_btn--error_white_error js-cSite-error-contact-support'>Click here to contact support</a></div>"),e(".js-cSite-error-contact-support").click(function(){window.Zenbox.show()})}else"clear_cart"==t&&(e(".js-error-message__body",s).append("<div class='vertical-spacing--top'><a class='circ_btn circ_btn--m circ_btn--error_white_error js-clear-cart-btn'>Remove all the items from your cart</a></div>"),e(".js-clear-cart-btn").click(function(){window.location="/cart/clear"}))}),e(".js-close-error",s).on("click",function(){s.remove()}),r||s.show(),s},t.warning=function(e,o,n){t.error(e,o,!1,n).addClass("circuits_error--warning")}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.favorite=function(){var t=this;e("body").on("click",".js-circuit__show__favorite",function(o){o.preventDefault(),e(this).hasClass("js-circuit__show__favorite--unstar")?t.unstar(this):t.star(this)})},t.favorite.prototype.star=function(t){e(".js-circuit__show__favorite--star svg").velocity({rotateZ:"360",scale:"1.5"},{easing:"spring"}),e(".js-circuit__show__favorite--star svg").velocity({scale:"0"},{easing:"spring",complete:function(){e(".js-circuit__show__favorite--star").hide(),e(".js-circuit__show__favorite--star svg").css("transform","scale(1) rotateZ(-360deg)"),e(".js-circuit__show__favorite--unstar").velocity("fadeIn",{duration:300,easing:"easeInOutCirc"})}}),e.ajax({url:e(t).attr("href")+"?ajax=true"});var o=parseInt(e(".js-sitemenusub__stats__count__starrers").html());e(".js-sitemenusub__stats__count__starrers").html(o+1)},t.favorite.prototype.unstar=function(t){e(".js-circuit__show__favorite--unstar svg").velocity({rotateZ:"360",scale:"1.5"},{easing:"spring"}),e(".js-circuit__show__favorite--unstar svg").velocity({scale:"0"},{easing:"spring",complete:function(){e(".js-circuit__show__favorite--unstar").hide(),e(".js-circuit__show__favorite--unstar svg").css("transform","scale(1) rotateZ(-360deg)"),e(".js-circuit__show__favorite--star").velocity("fadeIn",{duration:300,easing:"easeInOutCirc"})}}),e.ajax({url:e(t).attr("href")+"?ajax=true"});var o=parseInt(e(".js-sitemenusub__stats__count__starrers").html());e(".js-sitemenusub__stats__count__starrers").html(o-1)}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.flash=function(){var t=this;e("body").on("click",".js-flash-message-close",function(e){e.preventDefault(),t.remove_message(e)})},t.flash.prototype.remove_message=function(t){t.target.closest(".js-flash_message").remove()}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.gerber=function(){var t=this;e("body").on("click",".js-download-gerber",function(){t.sendData()})},t.gerber.prototype.sendData=function(){var o=this,n=window.location.pathname.replace(/\/$/,""),i=n.substring(n.lastIndexOf("/")+1);if(i.indexOf("-")>-1)var r=i.substring(0,i.indexOf("-"));else var r=i;e.ajax({type:"POST",dataType:"json",url:"/gerber",data:{id:r}}).done(function(e){new t.cruncher(e.command,"/gerber",o.completed)})},t.gerber.prototype.completed=function(t,e){e.hideLoading(),window.location.href=t.result}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.cjax=function(){var t=this;t.loading=!1,e("body").on("click",".js-cjax-link",function(o){t.fetch(e(this)),o.preventDefault()})},t.cjax.prototype.fetch=function(t){var o=this,n=t.data("cjaxlink");o.add_loading(),o.remove_all_active(),o.set_active(n),e.ajax({url:n}).done(function(t){o.loading=!1,e(".js-cjax-target").html(t),e("html, body").scrollTop(e(".js-cjax-target").offset().top)})},t.cjax.prototype.add_loading=function(){var o=this;o.loading=!0,window.setTimeout(function(){o.loading&&t.spinner(e(".js-cjax-target"))},250)},t.cjax.prototype.remove_all_active=function(){e.each(e(".js-cjax-link"),function(t,o){e(".js-sitemenu_sub__center__item__link",this).removeClass("active")})},t.cjax.prototype.set_active=function(t){e.each(e(".js-cjax-link"),function(o,n){var i=e(n).data("cjaxlink");t==i&&e(".js-sitemenu_sub__center__item__link",this).addClass("active")})}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.pjaxc=function(o){var n=this;n.pjaxloading=!1,e.pjax.defaults.scrollTo=0,e.pjax.defaults.timeout=2e3,e(document).pjax(".js-pjax-link",".js-pjax-container"),e(document).on("pjax:send",function(i,r){n.pjaxloading=!0,window.setTimeout(function(){n.pjaxloading&&(o.side_close(),t.spinner(e(".js-pjax-container")))},750)}),e(document).on("pjax:complete",function(t,e){n.pjaxloading=!1}),e(document).on("pjax:end",function(t,e){ga&&(ga("set","location",window.location.href),ga("send","pageview"))})}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.iframeresize=function(){var t=this;e(document).on("pjax:end",function(e,o){t.checkForIframeResize()}),t.checkForIframeResize()},t.iframeresize.prototype.checkForIframeResize=function(){e(".js-iframe-resize").length>0&&e(".js-iframe-resize").iFrameResize({log:!0})}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.thumbs=function(){var t=this;this.interval=!1,this.interval_time=3e3,this.interval_timeout=20,e(document).on("pjax:end",function(e,o){t.check()}),e(document).on("pagination:success",function(e,o){t.check()}),this.check()},t.thumbs.prototype.clear_all=function(){clearInterval(this.interval),this.interval_counter=0,this.pulling=!1,this.check_array=[],this.check_array_ids=[],this.generate_hash={},this.generate_array_ids=[]},t.thumbs.prototype.add_queued=function(t,o){var n=this;if(t.indexOf("queued")>=0){var i=parseInt(t.split("queued")[1]);if(!isNaN(i))return-1===e.inArray(i,n.check_array_ids)&&n.check_array_ids.push(i),n.check_array.push({id:i,ref:o}),!0}return!1},t.thumbs.prototype.check=function(){var t=this;t.clear_all(),$thumb=e(".js-circuit-thumb"),$thumb.length&&$thumb.each(function(o,n){var i=e(this).data("status");if(i&&!t.add_queued(i,e(this))&&i.indexOf("expired")>=0){var r=parseInt(e(this).data("id"));isNaN(r)||(-1===e.inArray(r,t.generate_array_ids)&&t.generate_array_ids.push(r),t.generate_hash[r]=e(this))}}),t.generate_array_ids.length&&t.do_generate(),(t.check_array_ids.length||t.generate_array_ids.length)&&(t.interval=setInterval(function(){t.interval_counter+=1,(t.check_array_ids.length||t.generate_array_ids.length)&&t.interval_counter<t.interval_timeout?t.pulling||t.do_check():t.clear_all()},t.interval_time))},t.thumbs.prototype.do_generate=function(){var t=this;e.ajax({type:"GET",dataType:"json",url:"/command/bulk_generate?ids="+t.generate_array_ids.join()}).done(function(o){e.each(o,function(e,o){var n=t.generate_hash[o.id];n&&t.add_queued(""+o.status+o.cmd_id,n)}),t.generate_array_ids=[]})},t.thumbs.prototype.do_check=function(){var t=this;t.pulling=!0,e.ajax({type:"GET",dataType:"json",url:"/command/bulk_status?ids="+t.check_array_ids.join()}).done(function(o){e.each(o,function(e,o){"rendered"==o.status?t.replace_img("rendered",o.id,o.result):"error"==o.status&&t.replace_img("error",o.id,o.result)}),t.pulling=!1})},t.thumbs.prototype.replace_img=function(t,o,n){var i=this;e.each(i.check_array,function(i,r){r.id==o&&("rendered"==t?e(r.ref).attr("src",n):e(r.ref).attr("src","https://s3-us-west-1.amazonaws.com/123d-circuits-assets/circuit_thumb_failed.gif"))});for(var r=i.check_array.length-1;r>=0;r--)i.check_array[r].id==o&&i.check_array.splice(r,1);for(var r=i.check_array_ids.length-1;r>=0;r--)i.check_array_ids[r]==o&&i.check_array_ids.splice(r,1)}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.jumper=function(t){e("body").on("click",".js-jumper",function(){var t=e(this).data("target");e(document).scrollTop(e("."+t).offset().top-20)})}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.marketplace=function(){var o=this,n=e('meta[name="session"]').attr("content"),i=e('meta[name="secure-session"]').attr("content");i="false"!=i&&i;var r=e('meta[name="user"]').attr("content");o.user="false"!=r&&r;var s=e('meta[name="env"]').attr("content"),a=e('meta[name="coppa"]').attr("content");a="true"==a;var l=e('meta[name="member"]').attr("content");o.cart=new Spark.marketplace(e('meta[name="afc"]').attr("content"),"circuits",o.user,n,i,a,"/shop",s,l),o.number_of_cart_items=0,o.redirect_flag=!1,o.cart.on("spark:marketplace:loaded",function(){o.check_for_iframe()}),o.cart.on("spark:marketplace:updated",function(t){t.count>0?o.show_cart():o.hide_cart(),o.number_of_cart_items=t.count,o.update_all_mini_carts()}),o.cart.on("spark:marketplace:error",function(e){o.cartmenu_animate_loading_hide();var n=JSON.parse(e.err.responseText);return t.error("Marketplace error",n.message),!1}),e(document).on("pjax:end",function(t,e){o.check_for_iframe(),o.check_for_buttons(),o.update_all_mini_carts()}),e("body").on("click",".js-marketplace-add-to-cart",function(){o.add_to_cart(e(this))}),e("body").on("click",".js-marketplace-add-to-cart--pcb",function(){o.add_to_cart_pcb(e(this))}),o.cart.on("spark:marketplace:loading",function(){return o.cartmenu_animate_loading(),!1}),o.cart.on("spark:marketplace:new",function(){return o.animate_tada(),o.redirect_flag&&(window.location="/cart",o.redirect_flag=!1),!1}),this.check_for_buttons()},t.marketplace.prototype.check_for_iframe=function(){e(".js-marketplace-iframe").length&&this.cart.showCart(e(".js-marketplace-iframe"))},t.marketplace.prototype.show_cart=function(){e(".js-marketplace-cart").show()},t.marketplace.prototype.hide_cart=function(){e(".js-marketplace-cart").hide()},t.marketplace.prototype.update_all_mini_carts=function(){e(".js-marketplace-cart__count").html(this.number_of_cart_items)},t.marketplace.prototype.cartmenu_animate_loading=function(){this.show_cart(),e(".js-shoppingcart-menu__loading").show(),t.spinner(e(".js-shoppingcart-menu__loading")),e(".js-shoppingcart-menu__svgimage").hide(),e(".js-marketplace-cart__count").hide(),e(".js-shoppingcart-menu__animation").removeClass("mediumAnimation tada")},t.marketplace.prototype.cartmenu_animate_loading_hide=function(){e(".js-shoppingcart-menu__loading").hide(),e(".js-shoppingcart-menu__loading").empty(),e(".js-shoppingcart-menu__svgimage").show(),e(".js-marketplace-cart__count").show()},t.marketplace.prototype.animate_tada=function(){this.cartmenu_animate_loading_hide(),e(".js-shoppingcart-menu__animation").addClass("mediumAnimation tada")},t.marketplace.prototype.check_for_buttons=function(){var t=this;e(".js-marketplace-get-pcb-price").each(function(e,o){t.get_price_pcb(o)}),e(".js-marketplace-get-price").each(function(e,o){t.get_price(o)})},t.marketplace.prototype.get_price=function(t){this.cart.getPrice(e(t).data("sku"),e(t),this.set_price)},t.marketplace.prototype.get_price_pcb=function(t){this.cart.getPCBPrice(e(t).data("sqin"),e(t).data("boardtypeid"),e(t),this.set_price)},t.marketplace.prototype.add_to_cart=function(t){var o=0;e(".js-marketplace-get-price").each(function(n,i){e(i).data("sku")==e(t).data("sku")&&(o=e(i).html().replace("$",""))}),window.analytics.track("add to cart",{"item id":e(t).data("sku"),"item name":e(t).data("name"),"item price":o,"item type":e(t).data("analytics-designtype"),"add to cart origin":e(t).data("analytics-origin")}),e(t).data("redirect")&&1==e(t).data("redirect")&&(this.redirect_flag=!0),this.cart.addToCart(e(t).data("sku"),1,"PHYSICAL",this.analytics_obj(t))},t.marketplace.prototype.add_to_cart_pcb=function(t){this.cart.addToCartPCB(e(t).data("boardid"),e(t).data("name"),1,e(t).data("thumburl"),e(t).data("sqin"),e(t).data("boardtypeid"),e(t).data("check"),this.analytics_obj(t))},t.marketplace.prototype.analytics_obj=function(t){var o=0!=this.user,n={"item type":e(t).data("analytics-designtype"),"add to cart origin":e(t).data("analytics-origin"),platform:"Web","product name":"123d.circuits.io","login status":o,url:window.location.href,path:window.location.pathname},i=e(t).data("analytics-designtype");return"circuit scribe"!==i&&"arduino"!==i&&(n.designer=e(t).data("analytics-designer"),n["design type"]=i),o&&(n.userId=e('meta[name="member"]').attr("content")),n},t.marketplace.prototype.set_price=function(t,o){o.product_info&&0==o.product_info.is_available?e(".js-marketplace-out-of-stock[data-sku="+o.asset_id+"]").removeClass("hide"):e(".js-marketplace-add-to-cart[data-sku="+o.asset_id+"]").removeClass("hide"),e(t).html("$"+o.total_price)}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.sitemenu=function(){var t=this;e(document).on("pjax:end",function(e,o){t.check_if_sticky()}),t.check_if_sticky()},t.sitemenu.prototype.check_if_sticky=function(){e(".js-main-sitemenu-is-sticky").length?e(".js-sitemenu").first().addClass("sitemenu--sticky"):e(".js-sitemenu").removeClass("sitemenu--sticky")}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.sitemenu_search=function(){var t=this;e("body").on("click",".js-sitemenu__search__trigger",function(){t.do_search()}),e("body").on("focusin",".js-sitemenu__search__input",function(){e(".js-sitemenu__search").addClass("active")}),e("body").on("focusout",".js-sitemenu__search__input",function(){0==e(this).val().length&&e(".js-sitemenu__search").removeClass("active")}),e("body").on("keyup",".js-sitemenu__search__input",function(e){13==e.keyCode&&t.do_search()})},t.sitemenu_search.prototype.do_search=function(){var t=e(".js-sitemenu__search__input").val();window.location.href="/search/?q="+t}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.sitemenu_sub=function(){var t=this;t.open=!1,t.moved_submenu=!1,e("body").on("click",".js-toggle-submenu",function(e){t.toggle_dropdown(),e.preventDefault()}),e(document).on("pjax:end",function(e,o){t.check_for_submenu()}),t.check_for_submenu()},t.sitemenu_sub.prototype.check_for_submenu=function(){this.moved_submenu&&(this.moved_submenu.remove(),this.moved_submenu=!1),e(".js-sitemenu_sub").length&&(this.moved_submenu=e(".js-sitemenu_collapsed").detach().prependTo("body"),this.moved_submenu.addClass("js-sitemenu_collapsed--moved"),this.add_sticky_listeners())},t.sitemenu_sub.prototype.add_sticky_listeners=function(){var t=this;Waypoint.destroyAll(),t.waypoint=new Waypoint({element:e(".js-sitemenu_sub"),handler:function(e){"up"==e?t.hide_collapsed():t.show_collapsed()}})},t.sitemenu_sub.prototype.show_collapsed=function(){e(".js-sitemenu_collapsed").show()},t.sitemenu_sub.prototype.hide_collapsed=function(){e(".js-sitemenu_collapsed").hide()},t.sitemenu_sub.prototype.toggle_dropdown=function(){e(".sitemenu_sub__center__list--mobile").is(":hidden")?this.show_dropdown():this.hide_dropdown()},t.sitemenu_sub.prototype.show_dropdown=function(){var t=this;e(".sitemenu_sub__center__list--mobile").show(),e("body").on("click",".js-container-site",function(){t.hide_dropdown()})},t.sitemenu_sub.prototype.hide_dropdown=function(){e(".sitemenu_sub__center__list--mobile").hide(),e("body").off("click",".js-container-site")}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.pagination=function(){var t=this;t.loading_div='<div class="grid__item pagination__loading js-pagination__loading"></div>',e(document).on("pjax:end",function(e,o){t.check()}),t.check()},t.pagination.prototype.reset=function(){e(".js-pagination").data("ref",this),e(".js-pagination").data("busy",!1),e(".js-pagination").data("end",!1),e(".js-pagination").data("currentPage",1)},t.pagination.prototype.check=function(){e(document).off("scroll",this.scrollcheck),this.reset(),e(".js-pagination").length&&e(document).on("scroll",this.scrollcheck)},t.pagination.prototype.get=function(){var t=this;t.showLoading(),e(".js-pagination").data("currentPage",e(".js-pagination").data("currentPage")+1),e.ajax({url:e(".js-pagination").data("url"),type:"GET",data:{page:e(".js-pagination").data("currentPage")},beforeSend:function(t){t.setRequestHeader("X-PAGINATION",!0)},error:function(t){e(".js-pagination").data("end",!0)},success:function(t,o){e(".js-pagination").before(t),e(".js-pagination").data("busy",!1),e(document).triggerHandler("pagination:success")},complete:function(){t.hideLoading()}})},t.pagination.prototype.scrollcheck=function(){var t=e(document).height()-e(window).scrollTop()-e(window).height();!e(".js-pagination").data("end")&&!e(".js-pagination").data("busy")&&t<450&&(e(".js-pagination").data("busy",!0),e(".js-pagination").data("ref").get())},t.pagination.prototype.showLoading=function(){e(".js-pagination").before(this.loading_div),t.spinner(e(".js-pagination__loading"))},t.pagination.prototype.hideLoading=function(){e(".js-pagination__loading").remove()}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.shadowbox=function(t,o,n){var i=this;o=void 0!==o?o:320,n=void 0!==n?n:500,this.boxhtml='<div class="shadowbox js-shadowbox hide"><div class="shadowbox__inner js-shadowbox__inner"><iframe class="shadowbox__iframe js-shadowbox__iframe"></div><div class="shadowbox__close js-shadowbox__close"></div></div>',this.box_width=o,this.box_height=n,this.original_box_width=o,this.original_box_height=n,this.aspect_ratio=o/n,this.trigger=t,this.target=e(t),e("body").on("click touch",t,function(t){i.construct_box(t)})},t.shadowbox.prototype.construct_box=function(o){var n=this;e(".js-shadowbox").length&&this.remove_box(),e("body").append(this.boxhtml),n.resize_box(),$trigger=e(this.target),e(".js-shadowbox__iframe").attr("src",$trigger.data("link")+"&redirect_path="+window.location.pathname),$shadowBox=e(".js-shadowbox"),$shadowBox.velocity("stop",!0),$shadowBox.velocity("fadeIn",{duration:800,easing:"easeInOutCirc"}),e("body").on("click",".js-shadowbox__close",function(){n.remove_box()}),e("body").on("click",".js-shadowbox",function(){n.remove_box()}),e(window).on("resize",function(){n.resize_box()});var i=$trigger.data("analytics");if(i&&t.analytics){(new t.analytics).track(i.event||"",i.properties||{})}},t.shadowbox.prototype.resize_box=function(){var t=this,o=e(window).width(),n=e(window).height();o<t.box_width||t.box_width<t.original_box_width?(t.box_width=o,t.box_width>400&&(t.box_width-=20),t.box_height=t.box_width/t.aspect_ratio):(n<t.box_height||t.box_height<t.original_box_height)&&(t.box_height=n,t.box_height>400&&(t.box_height-=20),t.box_width=t.box_height/t.aspect_ratio),e(".js-shadowbox__inner").css("width",this.box_width),e(".js-shadowbox__inner").css("margin-left",-this.box_width/2),e(".js-shadowbox__inner").css("height",this.box_height)},t.shadowbox.prototype.remove_box=function(){var t=this;e(".js-shadowbox").velocity("stop",!0),e(".js-shadowbox").velocity("fadeOut",{duration:800,easing:"easeInOutCirc",complete:function(){e(".js-shadowbox").remove()}}),e(window).off("resize",function(){t.resize_box()})}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.sidebar=function(t,o){var n=this;n.hide_all(),e("body").on("click",".js-sidebar--left__trigger",function(t){$this=e(this),n.side_open("left")}),e("body").on("click",".js-sidebar--right__trigger",function(){n.side_open("right")}),e(document).on("pjax:end",function(t,e){n.clearActiveItems("left"),n.setActiveItems("left")}),e(document).on("pjax:complete",function(t,e){n.side_close()})},t.sidebar.prototype.hide_all=function(t){e(".js-sidebar--left").hide(),e(".js-sidebar--right").hide()},t.sidebar.prototype.side_open=function(t){var o=this,n="left"==t?"272px":"-272px";"left"==t?e(".js-sidebar--left").show().scrollTop(0):e(".js-sidebar--right").show().scrollTop(0),e(".js-sidebar-slide").velocity("stop",!0),e(".js-sidebar-slide").velocity({translateX:n},{easing:[200,40],complete:function(t){o.set_close_listeners()}})},t.sidebar.prototype.side_close=function(){var t=this;e("body").off("mousemove click touchstart",".js-container-site"),e(".js-sidebar-slide").velocity("stop",!0),e(".js-sidebar-slide").velocity({translateX:"0px"},{easing:[200,40],complete:function(){t.hide_all(),e(".js-sidebar-slide").css("transform","translateX(0)")}})},t.sidebar.prototype.set_close_listeners=function(){var t=this;e("body").click(),e("body").on("mousemove click touchstart",".js-container-site",function(){t.side_close()})},t.sidebar.prototype.clearActiveItems=function(t){"left"==t&&e("a .active",".js-sidebar--left").removeClass("active")},t.sidebar.prototype.setActiveItems=function(t){if("left"==t){var o=window.location.pathname.replace(/\/$/,"");e("a",".js-sidebar--left").each(function(){o==e(this).attr("href").replace(/\/$/,"")&&e(".js-sidebar--left__item",this).addClass("active")})}}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.sortabletable=function(){var t=this;e(document).on("pjax:end",function(e,o){t.init()}),t.init()},t.sortabletable.prototype.init=function(){var t=this;e(".js-sortable").length&&(e(".js-sortable").sortable(),e(".js-sortable").disableSelection(),e(".js-sortable-model").length&&(e(".js-sortable").on("sortupdate",function(e,o){t.updateSortModel()}),t.updateSortModel()))},t.sortabletable.prototype.updateSortModel=function(){var t=[],o=e(".js-sort-item").length;e(".js-sort-item").each(function(){var n={},i=e(".js-sort-id",this).html(),r=o;e(".js-sort-weight",this).html(o),n.id=i,n.w=r,t.push(n),o-=1}),e(".js-sortable-model").val(JSON.stringify(t))}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.fn.tipsy=function(e){function o(e,o){if(o.text)var n=o.text;else{t(e).attr("title")&&(t(e).attr("original-title",t(e).attr("title")),t(e).attr("title",""));var n=t(e).attr("original-title")}t(".tipsy").find(".tipsy-inner").html(n);var i=t.extend({},t(e).offset());t(e).parents("svg").size()>0?(i=t.extend(i,t(e)[0].getBBox()),o.zoom_stuff&&(i.width=i.width*o.zoom_stuff.viewS,i.height=i.height*o.zoom_stuff.viewS)):i=t.extend(i,{width:t(e)[0].offsetWidth||0,height:t(e)[0].offsetHeight||0});var r,s=t(".tipsy")[0].offsetWidth,a=t(".tipsy")[0].offsetHeight;switch(o.gravity.charAt(0)){case"n":r={top:i.top+i.height+o.offset,left:i.left+i.width/2-s/2};break;case"s":r={top:i.top-a-o.offset,left:i.left+i.width/2-s/2};break;case"e":r={top:i.top+i.height/2-a/2,left:i.left-s-o.offset};break;case"w":r={top:i.top+i.height/2-a/2,left:i.left+i.width+o.offset}}return t(".tipsy").css(r).removeClass("tipsy-n tipsy-s tipsy-e tipsy-w").addClass("tipsy-"+o.gravity),t(".tipsy").find(".tipsy-arrow")[0].className="tipsy-arrow tipsy-arrow-"+o.gravity.charAt(0),t(".tipsy")}function n(){o(this,e).show()}function i(){t(".tipsy").hide()}return e=t.extend({},t.fn.tipsy.defaults,e),t(".tipsy").length||t("body").append('<div class="tipsy circ_hide" role="tooltip"><div class="tipsy-arrow"></div><div class="tipsy-inner"></div></div>'),t(this).data("tipsy_active",!0),t(this).on("mouseenter mouseover",!1,n),t(this).on("mouseleave mouseout remove",!1,i),this},t.fn.tipsy.defaults={gravity:"n",offset:0,text:!1,zoom_stuff:!1},t.fn.removeTipsy=function(){t(this).data("tipsy_active")&&(t(".tipsy").hide(),t(this).unbind("mouseenter mouseover"),t(this).unbind("mouseleave mouseout remove"),t(this).attr("title",t(this).attr("original-title")),t(this).attr("original-title",""),t(this).data("tipsy_active",!1))}}(t,window)}).call(e,o(0))},function(t,e,o){(function(t){!function(t,e,o){t.cruncher=function(t,o,n){var i=this;return i.loaderDiv=e('<div class="cruncherloader"><div class="cruncherloader__spinner"></div><div class="cruncherloader__txt">Crunching... Hold on!<br>Status: <span class="cruncherloader__status">Initialize!</span></div></div>'),i.responseFunction=n,i.timeOutMax=1800,i.timeOutCounter=0,i.endpoint=o,i.interval=setInterval(function(){i.timeOutCounter<=i.timeOutMax&&i.check(t),i.timeOutCounter+=1},2e3),i.showLoading(),i},t.cruncher.prototype.showLoading=function(){this.loaderDiv=this.loaderDiv.prependTo(e("body")),t.spinner(e(".cruncherloader__spinner",this.loaderDiv))},t.cruncher.prototype.hideLoading=function(){this.loaderDiv.remove(),clearInterval(this.interval)},t.cruncher.prototype.check=function(t){var o=this;e.ajax({type:"GET",dataType:"json",url:o.endpoint+"/"+t}).done(function(t){101==t.status?e(".cruncherloader__status",this.loaderDiv).html("In Queue..."):102==t.status?e(".cruncherloader__status",this.loaderDiv).html("Crunching..."):200==t.status?(e(".cruncherloader__status",this.loaderDiv).html("Success!"),o.showSucces(t)):500==t.status&&o.showError(t)})},t.cruncher.prototype.showSucces=function(t){clearInterval(this.interval),this.responseFunction(t,this)},t.cruncher.prototype.showError=function(e){clearInterval(this.interval),this.hideLoading(),t.error("Crunch Error","We're sorry, we're currently unable to crunch your file.")}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){(function(t){var e=o(44);!function(t,o,n){t.upload=function(t){var e=this;o(document).on("pjax:complete",function(t,o){e.init()}),e.init()},t.upload.prototype.init=function(){o(".js-upload").each(function(){new t.uploader(this)})},t.uploader=function(t){var n=this;n.container=o(t),n.fileList=[];var i=e.getCSRFTokenCookie();o(".js-upload__input",n.container).fileupload({dataType:"json",maxFileSize:375e4,acceptFileTypes:"/(.|/)(sch)$/i",formData:[{name:"authenticity_token",value:i}],add:function(t,e){o(".js-upload__btn",n.container).hide(),o(".js-upload__progress",n.container).show(),e.submit()},done:function(t,e){o(".js-upload__progress",n.container).hide(),n.fileList=n.fileList.concat(e.result),n.buildList()},progressall:function(t,e){var i=parseInt(e.loaded/e.total*100,10);o(".js-upload__progress__bar",n.container).css("width",i+"%"),100==i?o(".js-upload__progress__bar",n.container).html("crunching..."):o(".js-upload__progress__bar",n.container).html(i+"%")}}),o(".js-upload__btn",n.container).on("click",function(){o(".js-upload__input",n.container).click()})},t.uploader.prototype.buildList=function(){var t=this;t.resetList();for(var e=0;e<t.fileList.length;e++){var n=t.fileList[e],i=o(".js-upload__item--template",t.container).clone();o(".js-upload__item__title",i).html(n.name),o(".js-upload__item__info__size",i).html(t.bytesToSize(n.size)),o(".js-upload__list",t.container).append(i),t.setRemovalListeners(i,e,n.id)}o(".js-upload__data",t.container).val(JSON.stringify(t.fileList)).change()},t.uploader.prototype.resetList=function(){0==this.fileList?o(".js-upload__btn",this.container).show():o(".js-upload__btn",this.container).hide(),o(".js-upload__progress",this.container).hide(),o(".js-upload__list",this.container).html()},t.uploader.prototype.removeFromArray=function(t){this.fileList.splice(t,1)},t.uploader.prototype.removeFromServer=function(t){o.ajax({type:"DELETE",url:"/document/"+t+"/delete"}).done(function(t){})},t.uploader.prototype.setRemovalListeners=function(t,e,n){var i=this;o(".js-upload__item__info__delete",t).click(function(){o(t).remove(),i.removeFromArray(e),i.removeFromServer(n),i.buildList()})},t.uploader.prototype.bytesToSize=function(t){var e=["Bytes","KB","MB","GB","TB"];if(0==t)return"0 Byte";var o=parseInt(Math.floor(Math.log(t)/Math.log(1024)));return Math.round(t/Math.pow(1024,o),2)+" "+e[o]}}(window.cSite=window.cSite||{},t)}).call(e,o(0))},function(t,e,o){o(6),t.exports=o(7)}]);